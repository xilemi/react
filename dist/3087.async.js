(self.webpackChunk=self.webpackChunk||[]).push([[3087],{66996:function(er,Yt,Dt){function ie(Pt,ee,zt){for(var It=ee.length,ue=new Uint8Array(3*It/4-(ee[It-2]=="="?2:ee[It-1]=="="?1:0)),se=new Uint8Array(130),vt=0;64>vt;vt++)se["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(vt)]=vt;for(var Ot=vt=0;vt<It;vt+=4){var Lt=se[ee.charCodeAt(vt+1)],_t=se[ee.charCodeAt(vt+2)];ue[Ot++]=se[ee.charCodeAt(vt)]<<2|Lt>>4,ue[Ot++]=(Lt&15)<<4|_t>>2,ue[Ot++]=(_t&3)<<6|se[ee.charCodeAt(vt+3)]&63}return zt&&!Pt?WebAssembly.instantiate(ue,zt):zt||Pt?(Pt=new WebAssembly.Module(ue),zt?new WebAssembly.Instance(Pt,zt):Pt):WebAssembly.compile(ue)}(function(Pt,ee){ee(Yt)})(this,function(Pt){function ee(a){this.options=a||{},this.paneName=this.options.paneName||"labelPane",this.zIndex=this.options.zIndex||1,this._map=a.map,this._lastDrawTime=null,this.show()}function zt(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}function It(a,u){return u={exports:{}},a(u,u.exports),u.exports}function ue(a,u){return function(n){return u(a(n))}}function se(a){var u=function(n){return n==null?n:(1<arguments.length&&(n=Array.prototype.slice.call(arguments)),a(n))};return"conversion"in a&&(u.conversion=a.conversion),u}function vt(a){var u=function(n){if(n==null)return n;1<arguments.length&&(n=Array.prototype.slice.call(arguments));var l=a(n);if((typeof l=="undefined"?"undefined":Qr(l))==="object")for(var v=l.length,d=0;d<v;d++)l[d]=Math.round(l[d]);return l};return"conversion"in a&&(u.conversion=a.conversion),u}function Ot(a,u){if(!(this instanceof Ot))return new Ot(a,u);if(u&&u in qg&&(u=null),u&&!(u in jo))throw Error("Unknown model: "+u);if(typeof a=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(a instanceof Ot)this.model=a.model,this.color=a.color.slice(),this.valpha=a.valpha;else if(typeof a=="string"){if(u=Fh.get(a),u===null)throw Error("Unable to parse color from string: "+a);this.model=u.model;var n=jo[this.model].channels;this.color=u.value.slice(0,n),this.valpha=typeof u.value[n]=="number"?u.value[n]:1}else if(a.length)this.model=u||"rgb",n=jo[this.model].channels,u=kp.call(a,0,n),this.color=$t(u,n),this.valpha=typeof a[n]=="number"?a[n]:1;else if(typeof a=="number")a&=16777215,this.model="rgb",this.color=[a>>16&255,a>>8&255,a&255],this.valpha=1;else{if(this.valpha=1,u=dn(a),"alpha"in a&&(u.splice(u.indexOf("alpha"),1),this.valpha=typeof a.alpha=="number"?a.alpha:0),u=u.sort().join(""),!(u in Gp))throw Error("Unable to parse color from object: "+Dl(a));this.model=Gp[u],n=jo[this.model].labels;var l=[];for(u=0;u<n.length;u++)l.push(a[n[u]]);this.color=$t(l)}if(Wn[this.model])for(n=jo[this.model].channels,u=0;u<n;u++)(a=Wn[this.model][u])&&(this.color[u]=a(this.color[u]));this.valpha=Math.max(0,Math.min(1,this.valpha)),Rs&&Rs(this)}function Lt(a){return function(u){return Number(u.toFixed(a))}}function _t(a,u,n){return a=Array.isArray(a)?a:[a],a.forEach(function(l){(Wn[l]||(Wn[l]=[]))[u]=n}),a=a[0],function(l){if(arguments.length){n&&(l=n(l));var v=this[a]();return v.color[u]=l,v}return v=this[a]().color[u],n&&(v=n(v)),v}}function Ft(a){return function(u){return Math.max(0,Math.min(a,u))}}function $t(a,u){for(var n=0;n<u;n++)typeof a[n]!="number"&&(a[n]=0);return a}function jt(a){return a*Math.PI/180}function ot(a){return a/Math.PI*180}function Ie(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function Mr(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function Lr(a,u){return 1e-8>Math.abs(a-u)}function Ee(a){var u=a[0],n=a[a.length-1];return Math.sqrt(Math.pow(u[0]-n[0],2)+Math.pow(u[1]-n[1],2)+Math.pow((u[2]||0)-(n[2]||0),2))<(1<arguments.length&&arguments[1]!==void 0?arguments[1]:2e-7)}function Yr(){}function li(a,u){for(var n in u)a[n]=u[n]}function hi(a,u){this.lng=a,this.lat=u}function Bi(a,u){this.x=a,this.y=u}function fn(a,u){var n=document.createElement("canvas");return a&&(n.width=a),u&&(n.height=u),n}function _i(a){a=a||{},this.gradient=a.gradient||{"0.25":"rgba(0, 0, 255, 1)","0.55":"rgba(0, 255, 0, 1)","0.85":"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=a.maxSize===void 0?35:a.maxSize,this.minSize=a.minSize||0,this.max=a.max||100,this.min=a.min||0,this.initPalette()}function Ci(a){this.options=a||{},this._initialize()}function Vt(a,u,n,l,v){var d=1-a,x=1-a;return d*d*d*u+3*x*x*a*n+3*(1-a)*a*a*l+a*a*a*v}function Re(a){this.WORLD_SIZE_MC_HALF=20037726372307256e-9,this.WORLD_SIZE_MC=2*this.WORLD_SIZE_MC_HALF,this.options=a||{},this._initialize()}function _e(a,u){return a&&u?Math.round(Math.sqrt(Math.pow(a.lng-u.lng,2)+Math.pow(a.lat-u.lat,2))):0}function ze(a){return a=a.split("|"),a[0]=a[0].split(","),{lng:parseFloat(a[0][0]),lat:parseFloat(a[0][1])}}function nr(a){for(var u=a.length;0<=--u;)a[u]=0}function de(a,u,n,l,v){this.static_tree=a,this.extra_bits=u,this.extra_base=n,this.elems=l,this.max_length=v,this.has_stree=a&&a.length}function Rr(a,u){this.dyn_tree=a,this.max_code=0,this.stat_desc=u}function He(a,u,n,l,v){this.good_length=a,this.max_lazy=u,this.nice_length=n,this.max_chain=l,this.func=v}function Di(){this.strm=null,this.status=0,this.pending_buf=null,this.wrap=this.pending=this.pending_out=this.pending_buf_size=0,this.gzhead=null,this.gzindex=0,this.method=jn,this.last_flush=-1,this.w_mask=this.w_bits=this.w_size=0,this.window=null,this.window_size=0,this.head=this.prev=null,this.nice_match=this.good_match=this.strategy=this.level=this.max_lazy_match=this.max_chain_length=this.prev_length=this.lookahead=this.match_start=this.strstart=this.match_available=this.prev_match=this.match_length=this.block_start=this.hash_shift=this.hash_mask=this.hash_bits=this.hash_size=this.ins_h=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Nu(this.dyn_ltree),Nu(this.dyn_dtree),Nu(this.bl_tree),this.bl_desc=this.d_desc=this.l_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Nu(this.heap),this.heap_max=this.heap_len=0,this.depth=new Uint16Array(573),Nu(this.depth),this.bi_valid=this.bi_buf=this.insert=this.matches=this.static_len=this.opt_len=this.d_buf=this.last_lit=this.lit_bufsize=this.l_buf=0}function Cr(a){a=this.options=zh.assign({level:$x,method:Y0,chunkSize:16384,windowBits:15,memLevel:8,strategy:tA},a||{}),a.raw&&0<a.windowBits?a.windowBits=-a.windowBits:a.gzip&&0<a.windowBits&&16>a.windowBits&&(a.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ul,this.strm.avail_out=0;var u=Nh.deflateInit2(this.strm,a.level,a.method,a.windowBits,a.memLevel,a.strategy);if(u!==Hl)throw Error(An[u]);if(a.header&&Nh.deflateSetHeader(this.strm,a.header),a.dictionary){if(a=typeof a.dictionary=="string"?zu.string2buf(a.dictionary):nm.call(a.dictionary)==="[object ArrayBuffer]"?new Uint8Array(a.dictionary):a.dictionary,u=Nh.deflateSetDictionary(this.strm,a),u!==Hl)throw Error(An[u]);this._dict_set=!0}}function Oi(a,u){if(u=new Cr(u),u.push(a,!0),u.err)throw u.msg||An[u.err];return u.result}function As(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.total=this.check=this.dmax=this.flags=0,this.head=null,this.wnext=this.whave=this.wsize=this.wbits=0,this.window=null,this.extra=this.offset=this.length=this.bits=this.hold=0,this.distcode=this.lencode=null,this.have=this.ndist=this.nlen=this.ncode=this.distbits=this.lenbits=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.distdyn=this.lendyn=null,this.was=this.back=this.sane=0}function Vi(a){var u=this.options=zh.assign({chunkSize:65536,windowBits:15,to:""},a||{});if(u.raw&&0<=u.windowBits&&16>u.windowBits&&(u.windowBits=-u.windowBits,u.windowBits===0&&(u.windowBits=-15)),!(0<=u.windowBits&&16>u.windowBits)||a&&a.windowBits||(u.windowBits+=32),15<u.windowBits&&48>u.windowBits&&!(u.windowBits&15)&&(u.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ul,this.strm.avail_out=0,a=Ya.inflateInit2(this.strm,u.windowBits),a!==cf||(this.header=new $0,Ya.inflateGetHeader(this.strm,this.header),u.dictionary&&(typeof u.dictionary=="string"?u.dictionary=zu.string2buf(u.dictionary):fm.call(u.dictionary)==="[object ArrayBuffer]"&&(u.dictionary=new Uint8Array(u.dictionary)),u.raw&&(a=Ya.inflateSetDictionary(this.strm,u.dictionary),a!==cf))))throw Error(An[a])}function Ln(a,u){if(u=new Vi(u),u.push(a),u.err)throw u.msg||An[u.err];return u.result}function _s(a,u){for(var n=["webgl2","experimental-webgl2","webgl","experimental-webgl"],l=void 0,v=0;v<n.length;v++)try{if(l=a.getContext(n[v],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:u.antialias||!0,preserveDrawingBuffer:u.preserveDrawingBuffer||!1}))break}catch(d){}return l}function Ge(a,u,n){var l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:{};n=Nr({TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"REPEAT",TEXTURE_WRAP_T:"REPEAT"},n);var v=a.createTexture();if(a.bindTexture(a.TEXTURE_2D,v),a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,l.flipY||!0),l.format&&l.width){var d=a.LUMINANCE;l.format&&(d=a[l.format]),l.format!=="RGBA"&&l.format!=="RGB"?(u=new Float32Array(u),a.texImage2D(a.TEXTURE_2D,0,a.R32F,l.width,l.height,0,a.RED,a[l.type]||a.FLOAT,u)):a.texImage2D(a.TEXTURE_2D,0,d,l.width,l.height,0,d,a[l.type]||a.FLOAT,u)}else a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,u);for(var x in n)a.texParameteri(a.TEXTURE_2D,a[x],a[n[x]]);return a.bindTexture(a.TEXTURE_2D,null),{texture:v,data:{width:l.width,height:l.height,data:u,type:l.type}}}function sn(a,u,n,l,v){if((typeof u=="undefined"?"undefined":Qr(u))==="object")u=Ge(a,u,l,v),n(u.texture,null,u.data);else{var d=new Image;d.crossOrigin="anonymous",d.onload=function(){var x=Mr(d.width),y=Mr(d.height),M=document.createElement("canvas");M.width=x,M.height=y;var D=M.getContext("2d");D.drawImage(d,0,0,x,y),d=M,M=Ge(a,d,l,v).texture,n(M,d,{width:x,height:y,data:D.getImageData(0,0,x,y),type:"RGBA"})},d.src=u}}function so(a,u){if(u instanceof Array){var n={zero:a.ZERO,one:a.ONE,src_color:a.SRC_COLOR,one_minus_src_color:a.ONE_MINUS_SRC_COLOR,dst_color:a.DST_COLOR,one_minus_dst_color:a.ONE_MINUS_DST_COLOR,src_alpha:a.SRC_ALPHA,one_minus_src_alpha:a.ONE_MINUS_SRC_ALPHA,dst_alpha:a.DST_ALPHA,one_minus_dst_alpha:a.ONE_MINUS_DST_ALPHA,constant_color:a.CONSTANT_COLOR,one_minus_constant_color:a.ONE_MINUS_CONSTANT_COLOR,constant_alpha:a.CONSTANT_ALPHA,one_minus_constant_alpha:a.ONE_MINUS_CONSTANT_ALPHA,src_alpha_saturate:a.SRC_ALPHA_SATURATE};return u.map(function(l){return n[l]})}switch(u){case"default":return Qg?[a.SRC_ALPHA,a.ZERO,a.ONE,a.ZERO]:[a.ONE,a.ZERO];case"deeper":return[a.ONE,a.ONE_MINUS_SRC_ALPHA];case"normal":return[a.SRC_ALPHA,a.ONE];case"lighter":return[a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA];default:return[a.ONE,a.ZERO]}}function xh(a,u){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:[],l=3<arguments.length&&arguments[3]!==void 0?arguments[3]:"#ccc",v=4<arguments.length&&arguments[4]!==void 0?arguments[4]:1,d=document.createElement("canvas"),x=d.getContext("2d");d.width=256,d.height=v,d=u[0];var y=u[u.length-1];if(a.length===u.length){for(var M=x.createLinearGradient(0,0,256,1),D=0;D<a.length;++D)M.addColorStop((u[D]-d)/(y-d),a[D]);x.fillStyle=M,x.fillRect(0,0,256,v)}else if(a.length-u.length===-1){M=0,D=1;for(var U=0;U<a.length;++U){var C=Math.floor((u[D]-d)/(y-d)*256);x.fillStyle=a[U],x.fillRect(M,0,C,v),M=C,D++}}else x.fillStyle=l||"#ccc",x.fillRect(0,0,256,v);return-1>=a.length-u.length&&n.length===2&&(x.fillStyle=l||"#ccc",l=(n[0]-d)/(y-d),l=Math.floor(256*l),x.fillRect(0,0,l,v),l=(n[1]-d)/(y-d),l=Math.floor(256*l),x.fillRect(l,0,255,v)),{data:new Uint8Array(new Uint8ClampedArray(x.getImageData(0,0,256,v).data)),width:256,height:v}}function We(a,u,n){n=n||2;var l=u&&u.length,v=l?u[0]*n:a.length,d=Wi(a,0,v,n,!0),x=[];if(!d||d.next===d.prev)return x;var y;if(l){var M=n;l=[];var D,U=0;for(D=u.length;U<D;U++){var C=u[U]*M,E=U<D-1?u[U+1]*M:a.length;C=Wi(a,C,E,M,!1),C===C.next&&(C.steiner=!0),l.push(Da(C))}for(l.sort(Pa),U=0;U<l.length;U++)M=l[U],u=d,(u=Bn(M,u))&&(M=Lc(u,M),So(u,u.next),So(M,M.next)),d=So(d,d.next)}if(a.length>80*n){var B=y=a[0],O=l=a[1];for(M=n;M<v;M+=n)U=a[M],u=a[M+1],U<B&&(B=U),u<O&&(O=u),U>y&&(y=U),u>l&&(l=u);y=Math.max(y-B,l-O),y=y!==0?1/y:0}return ws(d,x,n,B,O,y),x}function Wi(a,u,n,l,v){if(v===0<Bg(a,u,n,l))for(v=u;v<n;v+=l)var d=Oa(v,a[v],a[v+1],d);else for(v=n-l;v>=u;v-=l)d=Oa(v,a[v],a[v+1],d);return d&&vu(d,d.next)&&(Rc(d),d=d.next),d}function So(a,u){if(!a)return a;u||(u=a);do{var n=!1;if(a.steiner||!vu(a,a.next)&&Qi(a.prev,a,a.next)!==0)a=a.next;else{if(Rc(a),a=u=a.prev,a===a.next)break;n=!0}}while(n||a!==u);return u}function ws(a,u,n,l,v,d,x){if(a){if(!x&&d){var y=a,M=y;do M.z===null&&(M.z=ki(M.x,M.y,l,v,d)),M.prevZ=M.prev,M=M.nextZ=M.next;while(M!==y);M.prevZ.nextZ=null,M.prevZ=null,y=M;var D,U,C,E,B=1;do{M=y;var O=y=null;for(U=0;M;){U++;var H=M;for(D=C=0;D<B&&(C++,H=H.nextZ,H);D++);for(E=B;0<C||0<E&&H;)C!==0&&(E===0||!H||M.z<=H.z)?(D=M,M=M.nextZ,C--):(D=H,H=H.nextZ,E--),O?O.nextZ=D:y=D,D.prevZ=O,O=D;M=H}O.nextZ=null,B*=2}while(1<U)}for(y=a;a.prev!==a.next;){if(M=a.prev,H=a.next,d)O=Fr(a,l,v,d);else t:if(O=a,U=O.prev,C=O,B=O.next,0<=Qi(U,C,B))O=!1;else{for(D=O.next.next;D!==O.prev;){if(un(U.x,U.y,C.x,C.y,B.x,B.y,D.x,D.y)&&0<=Qi(D.prev,D,D.next)){O=!1;break t}D=D.next}O=!0}if(O)u.push(M.i/n),u.push(a.i/n),u.push(H.i/n),Rc(a),y=a=H.next;else if(a=H,a===y){if(!x)ws(So(a),u,n,l,v,d,1);else if(x===1){a=So(a),x=u,y=n,M=a;do H=M.prev,O=M.next.next,!vu(H,O)&&dl(H,M,M.next,O)&&Ec(H,O)&&Ec(O,H)&&(x.push(H.i/y),x.push(M.i/y),x.push(O.i/y),Rc(M),Rc(M.next),M=a=O),M=M.next;while(M!==a);a=So(M),ws(a,u,n,l,v,d,2)}else if(x===2)t:{x=a;do{for(y=x.next.next;y!==x.prev;){if(M=x.i!==y.i){if(M=x,H=y,O=M.next.i!==H.i&&M.prev.i!==H.i){e:{O=M;do{if(O.i!==M.i&&O.next.i!==M.i&&O.i!==H.i&&O.next.i!==H.i&&dl(O,O.next,M,H)){O=!0;break e}O=O.next}while(O!==M);O=!1}O=!O}if(O){if(O=Ec(M,H)&&Ec(H,M)){O=M,U=!1,C=(M.x+H.x)/2,B=(M.y+H.y)/2;do O.y>B!=O.next.y>B&&O.next.y!==O.y&&C<(O.next.x-O.x)*(B-O.y)/(O.next.y-O.y)+O.x&&(U=!U),O=O.next;while(O!==M);O=U}O=O&&(Qi(M.prev,M,H.prev)||Qi(M,H.prev,H))||vu(M,H)&&0<Qi(M.prev,M,M.next)&&0<Qi(H.prev,H,H.next)}M=O}if(M){a=Lc(x,y),x=So(x,x.next),a=So(a,a.next),ws(x,u,n,l,v,d),ws(a,u,n,l,v,d);break t}y=y.next}x=x.next}while(x!==a)}break}}}}function Fr(a,u,n,l){var v=a.prev,d=a.next;if(0<=Qi(v,a,d))return!1;var x=v.x>a.x?v.x>d.x?v.x:d.x:a.x>d.x?a.x:d.x,y=v.y>a.y?v.y>d.y?v.y:d.y:a.y>d.y?a.y:d.y,M=ki(v.x<a.x?v.x<d.x?v.x:d.x:a.x<d.x?a.x:d.x,v.y<a.y?v.y<d.y?v.y:d.y:a.y<d.y?a.y:d.y,u,n,l);for(u=ki(x,y,u,n,l),n=a.prevZ,l=a.nextZ;n&&n.z>=M&&l&&l.z<=u;){if(n!==a.prev&&n!==a.next&&un(v.x,v.y,a.x,a.y,d.x,d.y,n.x,n.y)&&0<=Qi(n.prev,n,n.next)||(n=n.prevZ,l!==a.prev&&l!==a.next&&un(v.x,v.y,a.x,a.y,d.x,d.y,l.x,l.y)&&0<=Qi(l.prev,l,l.next)))return!1;l=l.nextZ}for(;n&&n.z>=M;){if(n!==a.prev&&n!==a.next&&un(v.x,v.y,a.x,a.y,d.x,d.y,n.x,n.y)&&0<=Qi(n.prev,n,n.next))return!1;n=n.prevZ}for(;l&&l.z<=u;){if(l!==a.prev&&l!==a.next&&un(v.x,v.y,a.x,a.y,d.x,d.y,l.x,l.y)&&0<=Qi(l.prev,l,l.next))return!1;l=l.nextZ}return!0}function Pa(a,u){return a.x-u.x}function Bn(a,u){var n=u,l=a.x,v=a.y,d=-1/0;do{if(v<=n.y&&v>=n.next.y&&n.next.y!==n.y){var x=n.x+(v-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(x<=l&&x>d){if(d=x,x===l){if(v===n.y)return n;if(v===n.next.y)return n.next}var y=n.x<n.next.x?n:n.next}}n=n.next}while(n!==u);if(!y)return null;if(l===d)return y;u=y,x=y.x;var M=y.y,D=1/0;n=y;do{if(l>=n.x&&n.x>=x&&l!==n.x&&un(v<M?l:d,v,x,M,v<M?d:l,v,n.x,n.y)){var U=Math.abs(v-n.y)/(l-n.x),C;if((C=Ec(n,a))&&!(C=U<D)&&(C=U===D)&&!(C=n.x>y.x)&&(C=n.x===y.x)){C=y;var E=n;C=0>Qi(C.prev,C,E.prev)&&0>Qi(E.next,C,C.next)}C&&(y=n,D=U)}n=n.next}while(n!==u);return y}function ki(a,u,n,l,v){return a=32767*(a-n)*v,u=32767*(u-l)*v,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,u=(u|u<<8)&16711935,u=(u|u<<4)&252645135,u=(u|u<<2)&858993459,(a|a<<1)&1431655765|((u|u<<1)&1431655765)<<1}function Da(a){var u=a,n=a;do(u.x<n.x||u.x===n.x&&u.y<n.y)&&(n=u),u=u.next;while(u!==a);return n}function un(a,u,n,l,v,d,x,y){return 0<=(v-x)*(u-y)-(a-x)*(d-y)&&0<=(a-x)*(l-y)-(n-x)*(u-y)&&0<=(n-x)*(d-y)-(v-x)*(l-y)}function Qi(a,u,n){return(u.y-a.y)*(n.x-u.x)-(u.x-a.x)*(n.y-u.y)}function vu(a,u){return a.x===u.x&&a.y===u.y}function dl(a,u,n,l){var v=Ic(Qi(a,u,n)),d=Ic(Qi(a,u,l)),x=Ic(Qi(n,l,a)),y=Ic(Qi(n,l,u));return!!(v!==d&&x!==y||v===0&&yu(a,n,u)||d===0&&yu(a,l,u)||x===0&&yu(n,a,l)||y===0&&yu(n,u,l))}function yu(a,u,n){return u.x<=Math.max(a.x,n.x)&&u.x>=Math.min(a.x,n.x)&&u.y<=Math.max(a.y,n.y)&&u.y>=Math.min(a.y,n.y)}function Ic(a){return 0<a?1:0>a?-1:0}function Ec(a,u){return 0>Qi(a.prev,a,a.next)?0<=Qi(a,u,a.next)&&0<=Qi(a,a.prev,u):0>Qi(a,u,a.prev)||0>Qi(a,a.next,u)}function Lc(a,u){var n=new Fg(a.i,a.x,a.y),l=new Fg(u.i,u.x,u.y),v=a.next,d=u.prev;return a.next=u,u.prev=a,n.next=v,v.prev=n,l.next=n,n.prev=l,d.next=l,l.prev=d,l}function Oa(a,u,n,l){return a=new Fg(a,u,n),l?(a.next=l.next,a.prev=l,l.next.prev=a,l.next=a):(a.prev=a,a.next=a),a}function Rc(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Fg(a,u,n){this.i=a,this.x=u,this.y=n,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Bg(a,u,n,l){for(var v=0,d=n-l;u<n;u+=l)v+=(a[d]-a[u])*(a[u+1]+a[d+1]),d=u;return v}function qv(a){try{return Za.createObjectURL(new Blob([a],{type:"application/javascript"}))}catch(n){var u=new sA;return u.append(a),Za.createObjectURL(u.getBlob(type))}}function gl(a,u){this.shapeLayer=a,this.gl=u,this.initData()}function Kv(a,u,n,l){var v=[];return l=l*Math.PI/180,v[0]=(a-n[0])*Math.cos(l)-(u-n[1])*Math.sin(l)+n[0],v[1]=(a-n[0])*Math.sin(l)+(u-n[1])*Math.cos(l)+n[1],v}function xu(a){var u=0,n=0,l=!0,v=!1,d=void 0;try{for(var x=Po(a),y;!(l=(y=x.next()).done);l=!0){var M=y.value;u+=M.w*M.h,n=Math.max(n,M.w)}}catch(H){v=!0,d=H}finally{try{!l&&x.return&&x.return()}finally{if(v)throw d}}a.sort(function(H,V){return V.h-H.h}),n=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(u/.95)),n),h:1/0}],v=l=0,d=!0,x=!1,y=void 0;try{for(var D=Po(a),U;!(d=(U=D.next()).done);d=!0)for(var C=U.value,E=n.length-1;0<=E;E--){var B=n[E];if(!(C.w>B.w||C.h>B.h)){if(C.x=B.x,C.y=B.y,v=Math.max(v,C.y+C.h),l=Math.max(l,C.x+C.w),C.w===B.w&&C.h===B.h){var O=n.pop();E<n.length&&(n[E]=O)}else C.h===B.h?(B.x+=C.w,B.w-=C.w):(C.w!==B.w&&n.push({x:B.x+C.w,y:B.y,w:B.w-C.w,h:C.h}),B.y+=C.h,B.h-=C.h);break}}}catch(H){x=!0,y=H}finally{try{!d&&D.return&&D.return()}finally{if(x)throw y}}return{w:l,h:v,fill:u/(l*v)||0}}function Qv(){fd=!0;for(var a=0;64>a;++a)Fs[a]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[a],Jo["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(a)]=a;Jo[45]=62,Jo[95]=63}function Dx(a,u,n){for(var l=[],v=u;v<n;v+=3)u=(a[v]<<16)+(a[v+1]<<8)+a[v+2],l.push(Fs[u>>18&63]+Fs[u>>12&63]+Fs[u>>6&63]+Fs[u&63]);return l.join("")}function $v(a){fd||Qv();for(var u=a.length,n=u%3,l="",v=[],d=0,x=u-n;d<x;d+=16383)v.push(Dx(a,d,d+16383>x?x:d+16383));return n===1?(a=a[u-1],l+=Fs[a>>2],l+=Fs[a<<4&63],l+="=="):n===2&&(a=(a[u-2]<<8)+a[u-1],l+=Fs[a>>10],l+=Fs[a>>4&63],l+=Fs[a<<2&63],l+="="),v.push(l),v.join("")}function pp(a,u,n,l,v){var d=8*v-l-1,x=(1<<d)-1,y=x>>1,M=-7;v=n?v-1:0;var D=n?-1:1,U=a[u+v];for(v+=D,n=U&(1<<-M)-1,U>>=-M,M+=d;0<M;n=256*n+a[u+v],v+=D,M-=8);for(d=n&(1<<-M)-1,n>>=-M,M+=l;0<M;d=256*d+a[u+v],v+=D,M-=8);if(n===0)n=1-y;else{if(n===x)return d?NaN:1/0*(U?-1:1);d+=Math.pow(2,l),n-=y}return(U?-1:1)*d*Math.pow(2,n-l)}function Fa(a,u,n,l,v,d){var x,y=8*d-v-1,M=(1<<y)-1,D=M>>1,U=v===23?Math.pow(2,-24)-Math.pow(2,-77):0;d=l?0:d-1;var C=l?1:-1,E=0>u||u===0&&0>1/u?1:0;for(u=Math.abs(u),isNaN(u)||u===1/0?(u=isNaN(u)?1:0,l=M):(l=Math.floor(Math.log(u)/Math.LN2),1>u*(x=Math.pow(2,-l))&&(l--,x*=2),u=1<=l+D?u+U/x:u+U*Math.pow(2,1-D),2<=u*x&&(l++,x/=2),l+D>=M?(u=0,l=M):1<=l+D?(u=(u*x-1)*Math.pow(2,v),l+=D):(u=u*Math.pow(2,D-1)*Math.pow(2,v),l=0));8<=v;a[n+d]=u&255,d+=C,u/=256,v-=8);for(l=l<<v|u,y+=v;0<y;a[n+d]=l&255,d+=C,l/=256,y-=8);a[n+d-C]|=128*E}function os(a,u){if((Be.TYPED_ARRAY_SUPPORT?2147483647:1073741823)<u)throw new RangeError("Invalid typed array length");return Be.TYPED_ARRAY_SUPPORT?(a=new Uint8Array(u),a.__proto__=Be.prototype):(a===null&&(a=new Be(u)),a.length=u),a}function Be(a,u,n){if(!(Be.TYPED_ARRAY_SUPPORT||this instanceof Be))return new Be(a,u,n);if(typeof a=="number"){if(typeof u=="string")throw Error("If encoding is specified then the first argument must be a string");return Io(this,a)}return ml(this,a,u,n)}function ml(a,u,n,l){if(typeof u=="number")throw new TypeError('"value" argument must not be a number');if(typeof ArrayBuffer!="undefined"&&u instanceof ArrayBuffer){if(u.byteLength,0>n||u.byteLength<n)throw new RangeError("'offset' is out of bounds");if(u.byteLength<n+(l||0))throw new RangeError("'length' is out of bounds");return u=n===void 0&&l===void 0?new Uint8Array(u):l===void 0?new Uint8Array(u,n):new Uint8Array(u,n,l),Be.TYPED_ARRAY_SUPPORT?(a=u,a.__proto__=Be.prototype):a=dp(a,u),a}if(typeof u=="string"){if(l=a,a=n,(typeof a!="string"||a==="")&&(a="utf8"),!Be.isEncoding(a))throw new TypeError('"encoding" must be a valid string encoding');return n=t0(u,a)|0,l=os(l,n),u=l.write(u,a),u!==n&&(l=l.slice(0,u)),l}return Ox(a,u)}function ss(a){if(typeof a!="number")throw new TypeError('"size" argument must be a number');if(0>a)throw new RangeError('"size" argument must not be negative')}function Io(a,u){if(ss(u),a=os(a,0>u?0:Ng(u)|0),!Be.TYPED_ARRAY_SUPPORT)for(var n=0;n<u;++n)a[n]=0;return a}function dp(a,u){var n=0>u.length?0:Ng(u.length)|0;a=os(a,n);for(var l=0;l<n;l+=1)a[l]=u[l]&255;return a}function Ox(a,u){if(sa(u)){var n=Ng(u.length)|0;return a=os(a,n),a.length===0||u.copy(a,0,0,n),a}if(u){if(typeof ArrayBuffer!="undefined"&&u.buffer instanceof ArrayBuffer||"length"in u)return(n=typeof u.length!="number")||(n=u.length,n=n!==n),n?os(a,0):dp(a,u);if(u.type==="Buffer"&&A1(u.data))return dp(a,u.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function Ng(a){if(a>=(Be.TYPED_ARRAY_SUPPORT?2147483647:1073741823))throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+(Be.TYPED_ARRAY_SUPPORT?2147483647:1073741823).toString(16)+" bytes");return a|0}function sa(a){return!(a==null||!a._isBuffer)}function t0(a,u){if(sa(a))return a.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(a)||a instanceof ArrayBuffer))return a.byteLength;typeof a!="string"&&(a=""+a);var n=a.length;if(n===0)return 0;for(var l=!1;;)switch(u){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return vp(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return u0(a).length;default:if(l)return vp(a).length;u=(""+u).toLowerCase(),l=!0}}function Fx(a,u,n){var l=!1;if((u===void 0||0>u)&&(u=0),u>this.length||((n===void 0||n>this.length)&&(n=this.length),0>=n)||(n>>>=0,u>>>=0,n<=u))return"";for(a||(a="utf8");;)switch(a){case"hex":for(a=u,u=n,n=this.length,(!a||0>a)&&(a=0),(!u||0>u||u>n)&&(u=n),l="",n=a;n<u;++n)a=l,l=this[n],l=16>l?"0"+l.toString(16):l.toString(16),l=a+l;return l;case"utf8":case"utf-8":return i0(this,u,n);case"ascii":for(a="",n=Math.min(this.length,n);u<n;++u)a+=String.fromCharCode(this[u]&127);return a;case"latin1":case"binary":for(a="",n=Math.min(this.length,n);u<n;++u)a+=String.fromCharCode(this[u]);return a;case"base64":return u=u===0&&n===this.length?$v(this):$v(this.slice(u,n)),u;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":for(u=this.slice(u,n),n="",a=0;a<u.length;a+=2)n+=String.fromCharCode(u[a]+256*u[a+1]);return n;default:if(l)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),l=!0}}function vl(a,u,n){var l=a[u];a[u]=a[n],a[n]=l}function e0(a,u,n,l,v){if(a.length===0)return-1;if(typeof n=="string"?(l=n,n=0):2147483647<n?n=2147483647:-2147483648>n&&(n=-2147483648),n=+n,isNaN(n)&&(n=v?0:a.length-1),0>n&&(n=a.length+n),n>=a.length){if(v)return-1;n=a.length-1}else if(0>n)if(v)n=0;else return-1;if(typeof u=="string"&&(u=Be.from(u,l)),sa(u))return u.length===0?-1:r0(a,u,n,l,v);if(typeof u=="number")return u&=255,Be.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?v?Uint8Array.prototype.indexOf.call(a,u,n):Uint8Array.prototype.lastIndexOf.call(a,u,n):r0(a,[u],n,l,v);throw new TypeError("val must be string, number or Buffer")}function r0(a,u,n,l,v){function d(D,U){return x===1?D[U]:D.readUInt16BE(U*x)}var x=1,y=a.length,M=u.length;if(l!==void 0&&(l=String(l).toLowerCase(),l==="ucs2"||l==="ucs-2"||l==="utf16le"||l==="utf-16le")){if(2>a.length||2>u.length)return-1;x=2,y/=2,M/=2,n/=2}if(v)for(l=-1;n<y;n++)if(d(a,n)===d(u,l===-1?0:n-l)){if(l===-1&&(l=n),n-l+1===M)return l*x}else l!==-1&&(n-=n-l),l=-1;else for(n+M>y&&(n=y-M);0<=n;n--){for(y=!0,l=0;l<M;l++)if(d(a,n+l)!==d(u,l)){y=!1;break}if(y)return n}return-1}function i0(a,u,n){n=Math.min(a.length,n);for(var l=[];u<n;){var v=a[u],d=null,x=239<v?4:223<v?3:191<v?2:1;if(u+x<=n)switch(x){case 1:128>v&&(d=v);break;case 2:var y=a[u+1];(y&192)===128&&(v=(v&31)<<6|y&63,127<v&&(d=v));break;case 3:y=a[u+1];var M=a[u+2];(y&192)===128&&(M&192)===128&&(v=(v&15)<<12|(y&63)<<6|M&63,2047<v&&(55296>v||57343<v)&&(d=v));break;case 4:y=a[u+1],M=a[u+2];var D=a[u+3];(y&192)===128&&(M&192)===128&&(D&192)===128&&(v=(v&15)<<18|(y&63)<<12|(M&63)<<6|D&63,65535<v&&1114112>v&&(d=v))}d===null?(d=65533,x=1):65535<d&&(d-=65536,l.push(d>>>10&1023|55296),d=56320|d&1023),l.push(d),u+=x}if(a=l.length,a<=Cm)l=String.fromCharCode.apply(String,l);else{for(n="",u=0;u<a;)n+=String.fromCharCode.apply(String,l.slice(u,u+=Cm));l=n}return l}function qn(a,u,n){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+u>n)throw new RangeError("Trying to access beyond buffer length")}function Uo(a,u,n,l,v,d){if(!sa(a))throw new TypeError('"buffer" argument must be a Buffer instance');if(u>v||u<d)throw new RangeError('"value" argument is out of bounds');if(n+l>a.length)throw new RangeError("Index out of range")}function gp(a,u,n,l){0>u&&(u=65535+u+1);for(var v=0,d=Math.min(a.length-n,2);v<d;++v)a[n+v]=(u&255<<8*(l?v:1-v))>>>8*(l?v:1-v)}function mp(a,u,n,l){0>u&&(u=4294967295+u+1);for(var v=0,d=Math.min(a.length-n,4);v<d;++v)a[n+v]=u>>>8*(l?v:3-v)&255}function n0(a,u,n,l,v,d){if(n+l>a.length)throw new RangeError("Index out of range");if(0>n)throw new RangeError("Index out of range")}function o0(a,u,n,l,v){return v||n0(a,u,n,4,34028234663852886e22,-34028234663852886e22),Fa(a,u,n,l,23,4),n+4}function s0(a,u,n,l,v){return v||n0(a,u,n,8,17976931348623157e292,-17976931348623157e292),Fa(a,u,n,l,52,8),n+8}function vp(a,u){u=u||1/0;for(var n,l=a.length,v=null,d=[],x=0;x<l;++x){if(n=a.charCodeAt(x),55295<n&&57344>n){if(!v){if(56319<n){-1<(u-=3)&&d.push(239,191,189);continue}else if(x+1===l){-1<(u-=3)&&d.push(239,191,189);continue}v=n;continue}if(56320>n){-1<(u-=3)&&d.push(239,191,189),v=n;continue}n=(v-55296<<10|n-56320)+65536}else v&&-1<(u-=3)&&d.push(239,191,189);if(v=null,128>n){if(0>--u)break;d.push(n)}else if(2048>n){if(0>(u-=2))break;d.push(n>>6|192,n&63|128)}else if(65536>n){if(0>(u-=3))break;d.push(n>>12|224,n>>6&63|128,n&63|128)}else if(1114112>n){if(0>(u-=4))break;d.push(n>>18|240,n>>12&63|128,n>>6&63|128,n&63|128)}else throw Error("Invalid code point")}return d}function a0(a){for(var u=[],n=0;n<a.length;++n)u.push(a.charCodeAt(n)&255);return u}function u0(a){if(a=(a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")).replace(_1,""),2>a.length)a="";else for(;a.length%4!==0;)a+="=";fd||Qv();var u=a.length;if(0<u%4)throw Error("Invalid string. Length must be a multiple of 4");var n=a[u-2]==="="?2:a[u-1]==="="?1:0,l=new hA(3*u/4-n),v=0<n?u-4:u,d=0;for(u=0;u<v;u+=4){var x=Jo[a.charCodeAt(u)]<<18|Jo[a.charCodeAt(u+1)]<<12|Jo[a.charCodeAt(u+2)]<<6|Jo[a.charCodeAt(u+3)];l[d++]=x>>16&255,l[d++]=x>>8&255,l[d++]=x&255}return n===2?(x=Jo[a.charCodeAt(u)]<<2|Jo[a.charCodeAt(u+1)]>>4,l[d++]=x&255):n===1&&(x=Jo[a.charCodeAt(u)]<<10|Jo[a.charCodeAt(u+1)]<<4|Jo[a.charCodeAt(u+2)]>>2,l[d++]=x>>8&255,l[d++]=x&255),l}function Pc(a,u,n,l){for(var v=0;v<l&&!(v+n>=u.length||v>=a.length);++v)u[v+n]=a[v];return v}function l0(a){return!!a.constructor&&typeof a.constructor.isBuffer=="function"&&a.constructor.isBuffer(a)}function Ms(a,u){var n=[];return a.forEach(function(l){n.push(u?-l:l,l)}),n}function h0(a){for(var u=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,n=[],l=0;l<a-1;l++){var v=2*(l+u);n.push(v,v+1,v+2),n.push(v+2,v+1,v+3)}return n}function yp(a){return function(u,n,l){return u=n+a,n=l.length-1,l[0<n?0>u?0:u>n?n:u:u<n?n:0<u?0:u]}}function aa(a){if(!a[0]||!a[0].length)return a;for(var u=a[0].length,n=[],l=0,v=0;v<a.length;v++)for(var d=0;d<u;d++)n[l++]=a[v][d];return n}function c0(){for(var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:[],u=[],n=0,l=0;l<a.length;l++){var v=a[l];if(0<l){var d=a[l-1];n+=Math.sqrt(Math.pow(v[0]-d[0],2)+Math.pow(v[1]-d[1],2))}u.push(n)}return{arr:u,total:n}}function f0(){var a=document.createElement("canvas");a.width=a.height=32;var u=a.getContext("2d");return{canvas:a,ctx:u}}function p0(){var a=(0<arguments.length&&arguments[0]!==void 0?arguments[0]:{}).color,u=f0(),n=u.canvas;return u=u.ctx,u.save(),u.moveTo(0,0),u.lineTo(20,0),u.lineTo(32,16),u.lineTo(20,32),u.lineTo(0,32),u.lineTo(10,16),u.fillStyle=a||"#fff",u.fill(),u.restore(),n}function xp(a,u){return ii.set(a,-u[1],u[0])}function d0(a,u,n){return ii.sub(a,u,n),ii.normalize(a,a),a}function Bx(a){var u,n;this.promise=new a(function(l,v){if(u!==void 0||n!==void 0)throw TypeError("Bad Promise constructor");u=l,n=v}),this.resolve=ca(u),this.reject=ca(n)}function Nx(a,u,n){return n=Math.PI/180*(60*n+30),[a.x+u*Math.cos(n),a.y+u*Math.sin(n)]}function g0(a,u,n){for(var l={},v=[],d=a.length,x=u/2/Math.sin(Math.PI/3),y=1.5*x,M=1,D=0;D<d;++D){var U=a[D].geometry.coordinates;n&&(U=n(U));var C=+U[0],E=+U[1];if(!isNaN(C)&&!isNaN(E)){U=Math.round(E/=y);var B=Math.round(C=C/u-(U&1)/2),O=E-U;if(1<3*Math.abs(O)){var H=C-B,V=B+(C<B?-1:1)/2,G=U+(E<U?-1:1);C-=V,E-=G,H*H+O*O>C*C+E*E&&(B=V+(U&1?1:-1)/2,U=G)}O=B+"-"+U,(H=l[O])?(H.count+=a[D].count||1,M=Math.max(M,H.count)):(l[O]={center:{x:(B+(U&1)/2)*u,y:U*y},count:a[D].count||1},v.push(l[O]))}}return v.max=M,v.r=x,v}function m0(a,u,n,l){switch(l){case 5122:return new Int16Array(a,u,n);case 5123:return new Uint16Array(a,u,n);case 5124:return new Int32Array(a,u,n);case 5125:return new Uint32Array(a,u,n);case 5126:return new Float32Array(a,u,n);default:return null}}function ks(a){return m0(a.bufferView.data,a.byteOffset,a.count*ql[a.type],a.componentType)}function v0(a){var u="",n=a.lastIndexOf("/");return n!==-1&&(u=a.substring(0,n+1)),u}function y0(a,u){var n=new XMLHttpRequest;n.overrideMimeType("application/json"),n.open("GET",a,!0),n.onreadystatechange=function(){n.readyState==4&&n.status=="200"&&u(n.responseText,this)},n.send(null)}function x0(a,u){var n=new XMLHttpRequest;n.responseType="arraybuffer",n.open("GET",a,!0),n.onreadystatechange=function(){if(n.readyState==4&&n.status=="200"){var l=n.response;l&&u&&u(l)}},n.send(null)}function Dc(a,u,n){var l=new Image;l.crossOrigin="Anonymous",l.src=a,l.onload=function(){n(l,u)}}function zx(a){function u(he,Ue){n.uniform1i(he,Ue.index),n.activeTexture(n.TEXTURE0+Ue.index),he=nt.glTF.textures[Ue.index],n.bindTexture(n.TEXTURE_2D,he.texture),n.bindSampler(Ue.index,he.sampler?he.sampler.sampler:x)}var n=a.gl,l=0,v=[];a=n.canvas;var d=function(he,Ue,Sr){for(this.glTFScene=he,this.glTF=Ue,this.id=Sr,this.rootTransform=or.create(),this.nodeMatrix=Array(Ue.nodes.length),he=0,Ue=this.nodeMatrix.length;he<Ue;he++)this.nodeMatrix[he]=or.create()},x=n.createSampler();n.samplerParameteri(x,n.TEXTURE_MIN_FILTER,n.NEAREST_MIPMAP_LINEAR),n.samplerParameteri(x,n.TEXTURE_MAG_FILTER,n.LINEAR),n.samplerParameteri(x,n.TEXTURE_WRAP_S,n.REPEAT),n.samplerParameteri(x,n.TEXTURE_WRAP_T,n.REPEAT),n.bindVertexArray(null),n.bindVertexArray(null);var y={HAS_SKIN:1,SKIN_VEC8:2,HAS_BASECOLORMAP:4,HAS_NORMALMAP:8,HAS_METALROUGHNESSMAP:16,HAS_OCCLUSIONMAP:32,HAS_EMISSIVEMAP:64},M={},D=function(){this.flags=0,this.programObject=null};D.prototype.hasSkin=function(){return this.flags&y.HAS_SKIN},D.prototype.hasBaseColorMap=function(){return this.flags&y.HAS_BASECOLORMAP},D.prototype.hasNormalMap=function(){return this.flags&y.HAS_NORMALMAP},D.prototype.hasMetalRoughnessMap=function(){return this.flags&y.HAS_METALROUGHNESSMAP},D.prototype.hasOcclusionMap=function(){return this.flags&y.HAS_OCCLUSIONMAP},D.prototype.hasEmissiveMap=function(){return this.flags&y.HAS_EMISSIVEMAP},D.prototype.defineMacro=function(he){y[he]!==void 0&&(this.flags|=y[he])},D.prototype.compile=function(){var he=M[this.flags];if(he)this.programObject=he;else{var Ue=he="";this.flags&y.HAS_SKIN&&(he+=`#define HAS_SKIN
`),this.flags&y.SKIN_VEC8&&(he+=`#define SKIN_VEC8
`),this.flags&y.HAS_BASECOLORMAP&&(Ue+=`#define HAS_BASECOLORMAP
`),this.flags&y.HAS_NORMALMAP&&(Ue+=`#define HAS_NORMALMAP
`),this.flags&y.HAS_METALROUGHNESSMAP&&(Ue+=`#define HAS_METALROUGHNESSMAP
`),this.flags&y.HAS_OCCLUSIONMAP&&(Ue+=`#define HAS_OCCLUSIONMAP
`),this.flags&y.HAS_EMISSIVEMAP&&(Ue+=`#define HAS_EMISSIVEMAP
`),he=Qs.createProgram(n,`#version 300 es
`+he+`#define POSITION_LOCATION 0
#define NORMAL_LOCATION 1
#define TEXCOORD_0_LOCATION 2
#define JOINTS_0_LOCATION 3
#define JOINTS_1_LOCATION 5
#define WEIGHTS_0_LOCATION 4
#define WEIGHTS_1_LOCATION 6
#define TANGENT_LOCATION 7
precision highp float;precision highp int;uniform mat4 u_MVP;uniform mat4 u_MV;uniform mat4 u_MVNormal;
#ifdef HAS_SKIN
uniform JointMatrix{mat4 matrix[65];}u_jointMatrix;
#endif
layout(location=POSITION_LOCATION)in vec3 position;layout(location=NORMAL_LOCATION)in vec3 normal;layout(location=TEXCOORD_0_LOCATION)in vec2 uv;
#ifdef HAS_SKIN
layout(location=JOINTS_0_LOCATION)in vec4 joint0;layout(location=WEIGHTS_0_LOCATION)in vec4 weight0;
#ifdef SKIN_VEC8
layout(location=JOINTS_1_LOCATION)in vec4 joint1;layout(location=WEIGHTS_1_LOCATION)in vec4 weight1;
#endif
#endif
out vec3 v_position;out vec3 v_normal;out vec2 v_uv;void main(){
#ifdef HAS_SKIN
mat4 skinMatrix=weight0.x*u_jointMatrix.matrix[int(joint0.x)]+weight0.y*u_jointMatrix.matrix[int(joint0.y)]+weight0.z*u_jointMatrix.matrix[int(joint0.z)]+weight0.w*u_jointMatrix.matrix[int(joint0.w)];
#ifdef SKIN_VEC8
skinMatrix+=weight1.x*u_jointMatrix.matrix[int(joint1.x)]+weight1.y*u_jointMatrix.matrix[int(joint1.y)]+weight1.z*u_jointMatrix.matrix[int(joint1.z)]+weight1.w*u_jointMatrix.matrix[int(joint1.w)];
#endif
#endif
v_uv=uv;
#ifdef HAS_SKIN
v_normal=normalize((u_MVNormal*transpose(inverse(skinMatrix))*vec4(normal,0)).xyz);vec4 pos=u_MV*skinMatrix*vec4(position,1.0);gl_Position=u_MVP*skinMatrix*vec4(position,1.0);
#else
v_normal=normalize((u_MVNormal*vec4(normal,0)).xyz);vec4 pos=u_MV*vec4(position,1.0);gl_Position=u_MVP*vec4(position,1.0);
#endif
v_position=vec3(pos.xyz)/pos.w;}`,`#version 300 es
`+Ue+`#define FRAG_COLOR_LOCATION 0
precision highp float;precision highp int;uniform sampler2D u_brdfLUT;uniform vec4 u_baseColorFactor;
#ifdef HAS_BASECOLORMAP
uniform sampler2D u_baseColorTexture;
#endif
#ifdef HAS_NORMALMAP
uniform sampler2D u_normalTexture;uniform float u_normalTextureScale;
#endif
#ifdef HAS_EMISSIVEMAP
uniform sampler2D u_emissiveTexture;uniform vec3 u_emissiveFactor;
#endif
#ifdef HAS_METALROUGHNESSMAP
uniform sampler2D u_metallicRoughnessTexture;
#endif
uniform float u_metallicFactor;uniform float u_roughnessFactor;
#ifdef HAS_OCCLUSIONMAP
uniform sampler2D u_occlusionTexture;uniform float u_occlusionStrength;
#endif
in vec3 v_position;in vec3 v_normal;in vec2 v_uv;layout(location=FRAG_COLOR_LOCATION)out vec4 frag_color;struct PBRInfo{float NdotL;float NdotV;float NdotH;float LdotH;float VdotH;float perceptualRoughness;float metalness;vec3 reflectance0;vec3 reflectance90;float alphaRoughness;vec3 diffuseColor;vec3 specularColor;};const float M_PI=3.141592653589793;const float c_MinRoughness=0.04;vec3 getNormal(){vec3 pos_dx=dFdx(v_position);vec3 pos_dy=dFdy(v_position);vec3 tex_dx=dFdx(vec3(v_uv,0.0));vec3 tex_dy=dFdy(vec3(v_uv,0.0));vec3 t=(tex_dy.t*pos_dx-tex_dx.t*pos_dy)/(tex_dx.s*tex_dy.t-tex_dy.s*tex_dx.t);vec3 ng=v_normal;t=normalize(t-ng*dot(ng,t));vec3 b=normalize(cross(ng,t));mat3 tbn=mat3(t,b,ng);
#ifdef HAS_NORMALMAP
vec3 n=texture(u_normalTexture,v_uv).rgb;n=normalize(tbn*((2.0*n-1.0)*vec3(u_normalTextureScale,u_normalTextureScale,1.0)));
#else
vec3 n=tbn[2].xyz;
#endif
return n;}vec3 getIBLContribution(PBRInfo pbrInputs,vec3 n,vec3 reflection){float mipCount=10.0;float lod=(pbrInputs.perceptualRoughness*mipCount);vec3 brdf=texture(u_brdfLUT,vec2(pbrInputs.NdotV,1.0-pbrInputs.perceptualRoughness)).rgb;vec3 diffuseLight=vec3(0.6,0.6,0.6);vec3 specularLight=vec3(0.6,0.6,0.6);vec3 diffuse=diffuseLight*pbrInputs.diffuseColor;vec3 specular=specularLight*(pbrInputs.specularColor*brdf.x+brdf.y);return diffuse+specular;}vec3 diffuse(PBRInfo pbrInputs){return pbrInputs.diffuseColor/M_PI;}vec3 specularReflection(PBRInfo pbrInputs){return pbrInputs.reflectance0+(pbrInputs.reflectance90-pbrInputs.reflectance0)*pow(clamp(1.0-pbrInputs.VdotH,0.0,1.0),5.0);}float geometricOcclusion(PBRInfo pbrInputs){float NdotL=pbrInputs.NdotL;float NdotV=pbrInputs.NdotV;float r=pbrInputs.alphaRoughness;float attenuationL=2.0*NdotL/(NdotL+sqrt(r*r+(1.0-r*r)*(NdotL*NdotL)));float attenuationV=2.0*NdotV/(NdotV+sqrt(r*r+(1.0-r*r)*(NdotV*NdotV)));return attenuationL*attenuationV;}float microfacetDistribution(PBRInfo pbrInputs){float roughnessSq=pbrInputs.alphaRoughness*pbrInputs.alphaRoughness;float f=(pbrInputs.NdotH*roughnessSq-pbrInputs.NdotH)*pbrInputs.NdotH+1.0;return roughnessSq/(M_PI*f*f);}void main(){float perceptualRoughness=u_roughnessFactor;float metallic=u_metallicFactor;
#ifdef HAS_METALROUGHNESSMAP
vec4 mrSample=texture(u_metallicRoughnessTexture,v_uv);perceptualRoughness=mrSample.g*perceptualRoughness;metallic=mrSample.b*metallic;
#endif
perceptualRoughness=clamp(perceptualRoughness,c_MinRoughness,1.0);metallic=clamp(metallic,0.0,1.0);float alphaRoughness=perceptualRoughness*perceptualRoughness;
#ifdef HAS_BASECOLORMAP
vec4 baseColor=texture(u_baseColorTexture,v_uv)*u_baseColorFactor;
#else
vec4 baseColor=u_baseColorFactor;
#endif
vec3 f0=vec3(0.04);vec3 diffuseColor=baseColor.rgb*(vec3(1.0)-f0);diffuseColor*=1.0-metallic;vec3 specularColor=mix(f0,baseColor.rgb,metallic);float reflectance=max(max(specularColor.r,specularColor.g),specularColor.b);float reflectance90=clamp(reflectance*25.0,0.0,1.0);vec3 specularEnvironmentR0=specularColor.rgb;vec3 specularEnvironmentR90=vec3(1.0,1.0,1.0)*reflectance90;vec3 n=getNormal();vec3 v=normalize(-v_position);vec3 l=normalize(vec3(1.0,1.0,1.0));vec3 h=normalize(l+v);vec3 reflection=-normalize(reflect(v,n));float NdotL=clamp(dot(n,l),0.001,1.0);float NdotV=abs(dot(n,v))+0.001;float NdotH=clamp(dot(n,h),0.0,1.0);float LdotH=clamp(dot(l,h),0.0,1.0);float VdotH=clamp(dot(v,h),0.0,1.0);PBRInfo pbrInputs=PBRInfo(NdotL,NdotV,NdotH,LdotH,VdotH,perceptualRoughness,metallic,specularEnvironmentR0,specularEnvironmentR90,alphaRoughness,diffuseColor,specularColor);vec3 F=specularReflection(pbrInputs);float G=geometricOcclusion(pbrInputs);float D=microfacetDistribution(pbrInputs);vec3 diffuseContrib=(1.0-F)*diffuse(pbrInputs);vec3 specContrib=max(vec3(0.0),F*G*D/(4.0*NdotL*NdotV));vec3 color=NdotL*(diffuseContrib+specContrib);color+=getIBLContribution(pbrInputs,n,reflection);
#ifdef HAS_OCCLUSIONMAP
float ao=texture(u_occlusionTexture,v_uv).r;color=mix(color,color*ao,u_occlusionStrength);
#endif
#ifdef HAS_EMISSIVEMAP
vec3 emissive=texture(u_emissiveTexture,v_uv).rgb*u_emissiveFactor;color+=emissive;
#endif
frag_color=vec4(color,baseColor.a);}`),this.programObject={program:he,uniformLocations:{},uniformBlockIndices:{}},this.flags&y.HAS_SKIN&&(this.programObject.uniformBlockIndices.JointMatrix=n.getUniformBlockIndex(he,"JointMatrix")),Ue=this.programObject.uniformLocations,Ue.MVP=n.getUniformLocation(he,"u_MVP"),Ue.MVNormal=n.getUniformLocation(he,"u_MVNormal"),Ue.MV=n.getUniformLocation(he,"u_MV"),Ue.baseColorFactor=n.getUniformLocation(he,"u_baseColorFactor"),Ue.metallicFactor=n.getUniformLocation(he,"u_metallicFactor"),Ue.roughnessFactor=n.getUniformLocation(he,"u_roughnessFactor"),this.flags&y.HAS_BASECOLORMAP&&(Ue.baseColorTexture=n.getUniformLocation(he,"u_baseColorTexture")),this.flags&y.HAS_NORMALMAP&&(Ue.normalTexture=n.getUniformLocation(he,"u_normalTexture"),Ue.normalTextureScale=n.getUniformLocation(he,"u_normalTextureScale")),this.flags&y.HAS_METALROUGHNESSMAP&&(Ue.metallicRoughnessTexture=n.getUniformLocation(he,"u_metallicRoughnessTexture")),this.flags&y.HAS_OCCLUSIONMAP&&(Ue.occlusionTexture=n.getUniformLocation(he,"u_occlusionTexture"),Ue.occlusionStrength=n.getUniformLocation(he,"u_occlusionStrength")),this.flags&y.HAS_EMISSIVEMAP&&(Ue.emissiveTexture=n.getUniformLocation(he,"u_emissiveTexture"),Ue.emissiveFactor=n.getUniformLocation(he,"u_emissiveFactor")),n.useProgram(null),M[this.flags]=this.programObject}};var U=1,C=Or.create(),E=or.create();gf.create();var B=[];n.enable(n.CULL_FACE),n.cullFace(n.BACK),n.frontFace(n.CCW);var O=!0;n.enable(n.DEPTH_TEST),n.depthFunc(n.LEQUAL);var H=H||{},V=null;Or.create();var G=or.create();or.perspective(G,.785,a.width/a.height,.01,100),or.create();var j=or.create(),Y=or.create(),$=or.create();or.create();var it,nt,pt=[1,1,1,1],Rt=H.drawPrimitive=function(he,Ue){if(_r){Y=j=_r.matrix,or.invert($,j),or.transpose($,$),Ue=pt;var Sr=he.shader,Ir=he.material;if(Ir!==null){var je=Ir.pbrMetallicRoughness;Ue=je.baseColorFactor,he.material.doubleSided===O&&((O=!he.material.doubleSided)?n.enable(n.CULL_FACE):n.disable(n.CULL_FACE))}V!=he.shader.programObject&&(V=he.shader.programObject,n.useProgram(V.program)),Ir&&(Sr.hasBaseColorMap()&&u(V.uniformLocations.baseColorTexture,je.baseColorTexture),Sr.hasNormalMap()&&(u(V.uniformLocations.normalTexture,Ir.normalTexture),n.uniform1f(V.uniformLocations.normalTextureScale,Ir.normalTexture.scale)),Sr.hasMetalRoughnessMap()&&u(V.uniformLocations.metallicRoughnessTexture,je.metallicRoughnessTexture),n.uniform1f(V.uniformLocations.metallicFactor,je.metallicFactor),n.uniform1f(V.uniformLocations.roughnessFactor,je.roughnessFactor),Sr.hasOcclusionMap()&&(u(V.uniformLocations.occlusionTexture,Ir.occlusionTexture),n.uniform1f(V.uniformLocations.occlusionStrength,Ir.occlusionTexture.strength)),Sr.hasEmissiveMap()&&(u(V.uniformLocations.emissiveTexture,Ir.emissiveTexture),n.uniform3fv(V.uniformLocations.emissiveFactor,Ir.emissiveFactor))),Sr.hasSkin()&&n.uniformBlockBinding(V.program,V.uniformBlockIndices.JointMatrix,it),n.activeTexture(n.TEXTURE0+29),n.bindTexture(n.TEXTURE_2D,null),n.uniform4fv(V.uniformLocations.baseColorFactor,Ue),n.uniformMatrix4fv(V.uniformLocations.MV,!1,j),n.uniformMatrix4fv(V.uniformLocations.MVP,!1,Y),n.uniformMatrix4fv(V.uniformLocations.MVNormal,!1,$),n.bindVertexArray(he.vertexArray),he.indices!==null?n.drawElements(he.mode,he.indicesLength,he.indicesComponentType,he.indicesOffset):n.drawArrays(he.mode,he.drawArraysOffset,he.drawArraysCount),n.bindVertexArray(null)}},Et=or.create(),Jt=or.create(),oe=H.drawNode=function(he,Ue,Sr,Ir){if(Ue=Sr[Ue],Ir!==void 0?or.mul(Ue,Ir,he.matrix):or.copy(Ue,he.matrix),he.skin!==null){var je=he.skin;it=je.uniformBlockID;var ts=he.skin.joints;for(or.invert(Jt,Ue),Ir=0,qi=ts.length;Ir<qi;Ir++){var Ji=ts[Ir];or.mul(Et,Sr[Ji.nodeID],je.inverseBindMatrix[Ir]),or.mul(Et,Jt,Et),je.jointMatrixUnidormBufferData.set(Et,16*Ir)}n.bindBuffer(n.UNIFORM_BUFFER,je.jointMatrixUniformBuffer),n.bufferSubData(n.UNIFORM_BUFFER,0,je.jointMatrixUnidormBufferData,0,je.jointMatrixUnidormBufferData.length)}var qi;if(he.mesh!==null)for(je=he.mesh,Ir=0,qi=je.primitives.length;Ir<qi;Ir++)Rt(je.primitives[Ir],Ue);for(he.skin!==null&&n.bindBuffer(n.UNIFORM_BUFFER,null),Ir=0,qi=he.children.length;Ir<qi;Ir++)oe(he.children[Ir],he.children[Ir].nodeID,Sr,Ue)},Se=H.drawScene=function(he){var Ue=he.glTF;if(Ue.animations){var Sr=Ue.animations[l],Ir,je=0;for(Ir=Sr.samplers.length;je<Ir;je++)Sr.samplers[je].getValue(Xe);for(je=0,Ir=Sr.channels.length;je<Ir;je++){var ts=Sr.channels[je],Ji=ts.sampler,qi=Ue.nodes[ts.target.nodeID];switch(ts.target.path){case"rotation":Ni.copy(qi.rotation,Ji.curValue);break;case"translation":Or.copy(qi.translation,Ji.curValue);break;case"scale":Or.copy(qi.scale,Ji.curValue)}qi.updateMatrixFromTRS()}}for(Sr=0,Ue=he.glTFScene.nodes.length;Sr<Ue;Sr++)oe(he.glTFScene.nodes[Sr],he.glTFScene.nodes[Sr].nodeID,he.nodeMatrix,he.rootTransform)},ge=performance.now(),Xe=0,_r;return{setupScene:function(he,Ue){function Sr($u,ec){if($u!==void 0){var Ma=$u.bufferView;return Ma.target===null?(n.bindBuffer(n.ARRAY_BUFFER,Ma.buffer),n.bufferData(n.ARRAY_BUFFER,Ma.data,n.STATIC_DRAW)):n.bindBuffer(Ma.target,Ma.buffer),$u.prepareVertexAttrib(ec,n),!0}return!1}var Ir;if(he.animations){var je=0;for(Ir=he.animations.length;je<Ir;je++)v.add(he.animations[je].name||je)}l=0,je=he.scenes[he.defaultScene],Or.fromValues(1.2*je.boundingBox.transform[0],0,0),Or.create(),Ue?Ue=B[Ue.id]=new d(je,he,Ue.id):(Ue=new d(je,he,B.length),B.push(Ue)),B.length===1&&(or.identity(E),U=1/Math.max(je.boundingBox.transform[0],Math.max(je.boundingBox.transform[5],je.boundingBox.transform[10])),or.getTranslation(C,je.boundingBox.transform),Or.scale(C,C,-1),C[0]+=-.5*je.boundingBox.transform[0],C[1]+=-.5*je.boundingBox.transform[5],C[2]+=-.5*je.boundingBox.transform[10],U*=.5,E[0]=U,E[5]=U,E[10]=U,or.translate(E,E,C),Or.set(C,0,0,-1.5),U=1);var ts;for(je=0,Ir=he.bufferViews.length;je<Ir;je++){var Ji=he.bufferViews[je];Ji.createBuffer(n),Ji.bindData(n)}if(he.textures)for(je=0,Ir=he.textures.length;je<Ir;je++){var qi=he.textures[je];qi.createTexture(n)}if(he.samplers)for(je=0,Ir=he.samplers.length;je<Ir;je++)qi=he.samplers[je],qi.createSampler(n);if(he.skins)for(je=0,Ir=he.skins.length;je<Ir;je++)qi=he.skins[je],qi.jointMatrixUniformBuffer=n.createBuffer(),n.bindBufferBase(n.UNIFORM_BUFFER,qi.uniformBlockID,qi.jointMatrixUniformBuffer),n.bindBuffer(n.UNIFORM_BUFFER,qi.jointMatrixUniformBuffer),n.bufferData(n.UNIFORM_BUFFER,qi.jointMatrixUnidormBufferData,n.DYNAMIC_DRAW),n.bufferSubData(n.UNIFORM_BUFFER,0,qi.jointMatrixUnidormBufferData),n.bindBuffer(n.UNIFORM_BUFFER,null);var tc=0;for(ts=he.meshes.length;tc<ts;tc++)for(qi=he.meshes[tc],je=0,Ir=qi.primitives.length;je<Ir;++je){var wn=qi.primitives[je];wn.shader=new D,wn.vertexArray=Ji=n.createVertexArray(),n.bindVertexArray(Ji),Sr(wn.attributes.POSITION,0),Sr(wn.attributes.NORMAL,1),Sr(wn.attributes.TEXCOORD_0,2),Sr(wn.attributes.JOINTS_0,3)&&Sr(wn.attributes.WEIGHTS_0,4)&&wn.shader.defineMacro("HAS_SKIN"),Sr(wn.attributes.JOINTS_1,5)&&Sr(wn.attributes.WEIGHTS_1,6)&&wn.shader.defineMacro("SKIN_VEC8"),wn.indices!==null&&(Ji=he.accessors[wn.indices],Ji=Ji.bufferView,Ji.target===null?(n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,Ji.buffer),n.bufferData(n.ELEMENT_ARRAY_BUFFER,Ji.data,n.STATIC_DRAW)):n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,Ji.buffer)),n.bindVertexArray(null),n.bindBuffer(n.ARRAY_BUFFER,null),n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,null),(Ji=wn.material)&&(Ji.pbrMetallicRoughness.baseColorTexture&&wn.shader.defineMacro("HAS_BASECOLORMAP"),Ji.pbrMetallicRoughness.metallicRoughnessTexture&&wn.shader.defineMacro("HAS_METALROUGHNESSMAP"),Ji.normalTexture&&wn.shader.defineMacro("HAS_NORMALMAP"),Ji.occlusionTexture&&wn.shader.defineMacro("HAS_OCCLUSIONMAP"),Ji.emissiveTexture&&wn.shader.defineMacro("HAS_EMISSIVEMAP")),wn.shader.compile()}return Ue},render:H.render=function(he){_r=he,he=new Date().getTime();var Ue,Sr=0;for(Ue=B.length;Sr<Ue;Sr++)nt=B[Sr],Se(B[Sr]);V=null,Xe=.001*(he-ge)}}}function Ux(a,u,n,l,v,d){if(typeof u=="string"&&typeof n=="number"&&typeof l=="number")for(u=u.split(d),d=0;d<u.length;d++)a.fillText(u[d],n,l),l+=v}function Rn(a){this.options=a=a||{},a.colors=a.colors||["rgba(0,192,73,0.99609375)","rgba(242,48,48,0.99609375)","rgba(255,159,25,0.99609375)"];var u=a.colors;this.drawTogether=!0,this.parseColors(u),this.tileSize=256,this.ratio=window.devicePixelRatio,this.cache={},a.getTileUrl&&(this.getTileUrl=a.getTileUrl),this._loadCount={}}function Oc(a){var u=a/2,n=a+u,l=new fn(2*n,2*n),v=l.getContext("2d");return v.shadowBlur=u,v.shadowColor="black",v.shadowOffsetX=v.shadowOffsetY=1e4,v.beginPath(),v.arc(n-1e4,n-1e4,a,0,2*Math.PI,!0),v.closePath(),v.fill(),l}var Ap=window.BMapGL||window.BMap;Ap&&Ap.Overlay&&(ee.prototype=new Ap.Overlay),ee.prototype.initialize=function(a){this._map=a;var u=this.canvas=document.createElement("canvas"),n=this.ctx=this.canvas.getContext("2d");u.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";",this.adjustSize(),this.adjustRatio(n),a.getContainer().appendChild(u);var l=this;return a.addEventListener("resize",function(){l.adjustSize(),l._draw()}),this.canvas},ee.prototype.adjustSize=function(){var a=this._map.getSize(),u=this.canvas;u.width=a.width,u.height=a.height,u.style.width=u.width+"px",u.style.height=u.height+"px"},ee.prototype.adjustRatio=function(a){var u=(window.devicePixelRatio||1)/(a.backingStorePixelRatio||a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1),n=a.canvas.width,l=a.canvas.height;a.canvas.width=n*u,a.canvas.height=l*u,a.canvas.style.width=n+"px",a.canvas.style.height=l+"px",a.scale(u,u)},ee.prototype.draw=function(){this._draw.apply(this,arguments)},ee.prototype._draw=function(){this.dispatchEvent("draw"),this.options.update&&this.options.update.apply(this,arguments)},ee.prototype.getContainer=function(){return this.canvas},ee.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},ee.prototype.hide=function(){this.canvas.style.display="none"},ee.prototype.setZIndex=function(a){this.canvas.style.zIndex=a},ee.prototype.getZIndex=function(){return this.zIndex};var zg=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:{},Ug=It(function(a,u){u.__esModule=!0,u.default=function(n,l){if(!(n instanceof l))throw new TypeError("Cannot call a class as a function")}}),Ke=zt(Ug),ua=function(a){if(a==null)throw TypeError("Can't call method on  "+a);return a},A0={}.hasOwnProperty,$i=function(a,u){return A0.call(a,u)},Hx={}.toString,yl=function(a){return Hx.call(a).slice(8,-1)},Hg=Object("z").propertyIsEnumerable(0)?Object:function(a){return yl(a)=="String"?a.split(""):Object(a)},la=function(a){return Hg(ua(a))},kx=Math.ceil,Gx=Math.floor,kg=function(a){return isNaN(a=+a)?0:(0<a?Gx:kx)(a)},bx=Math.min,Fc=function(a){return 0<a?bx(kg(a),9007199254740991):0},Vx=Math.max,Wx=Math.min,ji=It(function(a){a=a.exports={version:"2.6.5"},typeof __e=="number"&&(__e=a)}),si=It(function(a){a=a.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=a)}),Bc=It(function(a){var u=si["__core-js_shared__"]||(si["__core-js_shared__"]={});(a.exports=function(n,l){return u[n]||(u[n]=l!==void 0?l:{})})("versions",[]).push({version:ji.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),_0=0,jx=Math.random(),ha=function(a){return"Symbol(".concat(a===void 0?"":a,")_",(++_0+jx).toString(36))},Au=Bc("keys"),_p=function(a){return Au[a]||(Au[a]=ha(a))},Xx=function(a){return function(u,n,l){u=la(u);var v=Fc(u.length);if(l=kg(l),l=0>l?Vx(l+v,0):Wx(l,v),a&&n!=n){for(;v>l;)if(n=u[l++],n!=n)return!0}else for(;v>l;l++)if((a||l in u)&&u[l]===n)return a||l||0;return!a&&-1}}(!1),Yx=_p("IE_PROTO"),w0=function(a,u){a=la(a);var n=0,l=[],v;for(v in a)v!=Yx&&$i(a,v)&&l.push(v);for(;u.length>n;)$i(a,v=u[n++])&&(~Xx(l,v)||l.push(v));return l},Ah="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ho=Object.keys||function(a){return w0(a,Ah)},ca=function(a){if(typeof a!="function")throw TypeError(a+" is not a function!");return a},Vn=function(a,u,n){if(ca(a),u===void 0)return a;switch(n){case 1:return function(l){return a.call(u,l)};case 2:return function(l,v){return a.call(u,l,v)};case 3:return function(l,v,d){return a.call(u,l,v,d)}}return function(){return a.apply(u,arguments)}},mo=function(a){return typeof a=="object"?a!==null:typeof a=="function"},vo=function(a){if(!mo(a))throw TypeError(a+" is not an object!");return a},fa=function(a){try{return!!a()}catch(u){return!0}},ko=!fa(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),Go=si.document,_u=mo(Go)&&mo(Go.createElement),wu=!ko&&!fa(function(){return Object.defineProperty(_u?Go.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),xl=function(a,u){if(!mo(a))return a;var n,l;if(u&&typeof(n=a.toString)=="function"&&!mo(l=n.call(a))||typeof(n=a.valueOf)=="function"&&!mo(l=n.call(a))||!u&&typeof(n=a.toString)=="function"&&!mo(l=n.call(a)))return l;throw TypeError("Can't convert object to primitive value")},wp=Object.defineProperty,yo={f:ko?Object.defineProperty:function(a,u,n){if(vo(a),u=xl(u,!0),vo(n),wu)try{return wp(a,u,n)}catch(l){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(a[u]=n.value),a}},Gs=function(a,u){return{enumerable:!(a&1),configurable:!(a&2),writable:!(a&4),value:u}},Cs=ko?function(a,u,n){return yo.f(a,u,Gs(1,n))}:function(a,u,n){return a[u]=n,a},Kn=function(a,u,n){var l=a&Kn.F,v=a&Kn.G,d=a&Kn.S,x=a&Kn.P,y=a&Kn.B,M=a&Kn.W,D=v?ji:ji[u]||(ji[u]={}),U=D.prototype;d=v?si:d?si[u]:(si[u]||{}).prototype;var C;v&&(n=u);for(C in n)if(u=!l&&d&&d[C]!==void 0,!u||!$i(D,C)){var E=u?d[C]:n[C];D[C]=v&&typeof d[C]!="function"?n[C]:y&&u?Vn(E,si):M&&d[C]==E?function(B){var O=function(H,V,G){if(this instanceof B){switch(arguments.length){case 0:return new B;case 1:return new B(H);case 2:return new B(H,V)}return new B(H,V,G)}return B.apply(this,arguments)};return O.prototype=B.prototype,O}(E):x&&typeof E=="function"?Vn(Function.call,E):E,x&&((D.virtual||(D.virtual={}))[C]=E,a&Kn.R&&U&&!U[C]&&Cs(U,C,E))}};Kn.F=1,Kn.G=2,Kn.S=4,Kn.P=8,Kn.B=16,Kn.W=32,Kn.U=64,Kn.R=128;var Er=Kn,Xi=function(a,u){var n=(ji.Object||{})[a]||Object[a],l={};l[a]=u(n),Er(Er.S+Er.F*fa(function(){n(1)}),"Object",l)};Xi("keys",function(){return function(a){return Ho(Object(ua(a)))}});var as=ji.Object.keys,pn=It(function(a){a.exports={default:as,__esModule:!0}}),dn=zt(pn),us=Object.getOwnPropertySymbols,Ba={}.propertyIsEnumerable,_h=Object.assign,M0=!_h||fa(function(){var a={},u={},n=Symbol();return a[n]=7,"abcdefghijklmnopqrst".split("").forEach(function(l){u[l]=l}),_h({},a)[n]!=7||Object.keys(_h({},u)).join("")!="abcdefghijklmnopqrst"})?function(a,u){for(var n=Object(ua(a)),l=arguments.length,v=1,d=us,x=Ba;l>v;)for(var y=Hg(arguments[v++]),M=d?Ho(y).concat(d(y)):Ho(y),D=M.length,U=0,C;D>U;)x.call(y,C=M[U++])&&(n[C]=y[C]);return n}:_h;Er(Er.S+Er.F,"Object",{assign:M0});var Nc=ji.Object.assign,Mp=It(function(a){a.exports={default:Nc,__esModule:!0}}),Nr=zt(Mp),zc=_p("IE_PROTO"),Cp=Object.prototype,wh=Object.getPrototypeOf||function(a){return a=Object(ua(a)),$i(a,zc)?a[zc]:typeof a.constructor=="function"&&a instanceof a.constructor?a.constructor.prototype:a instanceof Object?Cp:null};Xi("getPrototypeOf",function(){return function(a){return wh(Object(ua(a)))}});var Tp=ji.Object.getPrototypeOf,ao=It(function(a){a.exports={default:Tp,__esModule:!0}}),fr=zt(ao);Er(Er.S+Er.F*!ko,"Object",{defineProperty:yo.f});var Uc=ji.Object,Sp=function(a,u,n){return Uc.defineProperty(a,u,n)},bo=It(function(a){a.exports={default:Sp,__esModule:!0}}),gn=zt(bo),Hc=It(function(a,u){u.__esModule=!0;var n=bo&&bo.__esModule?bo:{default:bo};u.default=function(){function l(v,d){for(var x=0;x<d.length;x++){var y=d[x];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),(0,n.default)(v,y.key,y)}}return function(v,d,x){return d&&l(v.prototype,d),x&&l(v,x),v}}()}),Qe=zt(Hc),Vo={},Ip=ko?Object.defineProperties:function(a,u){vo(a);for(var n=Ho(u),l=n.length,v=0,d;l>v;)yo.f(a,d=n[v++],u[d]);return a},Al=si.document,Mh=Al&&Al.documentElement,kc=_p("IE_PROTO"),Ch=function(){},Mu=function(){var a=_u?Go.createElement("iframe"):{},u=Ah.length;for(a.style.display="none",Mh.appendChild(a),a.src="javascript:",a=a.contentWindow.document,a.open(),a.write("<script>document.F=Object<\/script>"),a.close(),Mu=a.F;u--;)delete Mu.prototype[Ah[u]];return Mu()},Na=Object.create||function(a,u){if(a!==null){Ch.prototype=vo(a);var n=new Ch;Ch.prototype=null,n[kc]=a}else n=Mu();return u===void 0?n:Ip(n,u)},rn=It(function(a){var u=Bc("wks"),n=si.Symbol,l=typeof n=="function";(a.exports=function(v){return u[v]||(u[v]=l&&n[v]||(l?n:ha)("Symbol."+v))}).store=u}),Gc=yo.f,C0=rn("toStringTag"),_l=function(a,u,n){a&&!$i(a=n?a:a.prototype,C0)&&Gc(a,C0,{configurable:!0,value:u})},T0={};Cs(T0,rn("iterator"),function(){return this});var Gg=function(a,u,n){a.prototype=Na(T0,{next:Gs(1,n)}),_l(a,u+" Iterator")},bg=rn("iterator"),Cu=!([].keys&&"next"in[].keys()),mn=function(){return this},Th=function(a,u,n,l,v,d,x){Gg(n,u,l),l=function(G){return!Cu&&G in U?U[G]:function(){return new n(this,G)}};var y=u+" Iterator",M=v=="values",D=!1,U=a.prototype,C=U[bg]||U["@@iterator"]||v&&U[v],E=C||l(v),B=v?M?l("entries"):E:void 0,O=u=="Array"&&U.entries||C,H;if(O&&(a=wh(O.call(new a)),a!==Object.prototype&&a.next&&_l(a,y,!0)),M&&C&&C.name!=="values"&&(D=!0,E=function(){return C.call(this)}),x&&(Cu||D||!U[bg])&&Cs(U,bg,E),Vo[u]=E,Vo[y]=mn,v){var V={values:M?E:l("values"),keys:d?E:l("keys"),entries:B};if(x)for(H in V)H in U||Cs(U,H,V[H]);else Er(Er.P+Er.F*(Cu||D),u,V)}return V},S0=function(a){return function(u,n){u=String(ua(u)),n=kg(n);var l=u.length,v;if(0>n||n>=l)return a?"":void 0;var d=u.charCodeAt(n);return 55296>d||56319<d||n+1===l||56320>(v=u.charCodeAt(n+1))||57343<v?a?u.charAt(n):d:a?u.slice(n,n+2):(d-55296<<10)+(v-56320)+65536}}(!0);Th(String,"String",function(a){this._t=String(a),this._i=0},function(){var a=this._t,u=this._i;return u>=a.length?{value:void 0,done:!0}:(a=S0(a,u),this._i+=a.length,{value:a,done:!1})});var bs=function(a,u){return{value:u,done:!!a}};Th(Array,"Array",function(a,u){this._t=la(a),this._i=0,this._k=u},function(){var a=this._t,u=this._k,n=this._i++;return!a||n>=a.length?(this._t=void 0,bs(1)):u=="keys"?bs(0,n):u=="values"?bs(0,a[n]):bs(0,[n,a[n]])},"values"),Vo.Arguments=Vo.Array;for(var bc=rn("toStringTag"),Sh="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),Ep=0;Ep<Sh.length;Ep++){var Lp=Sh[Ep],Ih=si[Lp],Vc=Ih&&Ih.prototype;Vc&&!Vc[bc]&&Cs(Vc,bc,Lp),Vo[Lp]=Vo.Array}var Wc={f:rn},I0=Wc.f("iterator"),pa=It(function(a){a.exports={default:I0,__esModule:!0}});zt(pa);var Ts=It(function(a){var u=ha("meta"),n=yo.f,l=0,v=Object.isExtensible||function(){return!0},d=!fa(function(){return v(Object.preventExtensions({}))}),x=function(M){n(M,u,{value:{i:"O"+ ++l,w:{}}})},y=a.exports={KEY:u,NEED:!1,fastKey:function(M,D){if(!mo(M))return typeof M=="symbol"?M:(typeof M=="string"?"S":"P")+M;if(!$i(M,u)){if(!v(M))return"F";if(!D)return"E";x(M)}return M[u].i},getWeak:function(M,D){if(!$i(M,u)){if(!v(M))return!0;if(!D)return!1;x(M)}return M[u].w},onFreeze:function(M){return d&&y.NEED&&v(M)&&!$i(M,u)&&x(M),M}}}),E0=yo.f,Eh=function(a){var u=ji.Symbol||(ji.Symbol={});a.charAt(0)=="_"||a in u||E0(u,a,{value:Wc.f(a)})},wl=Array.isArray||function(a){return yl(a)=="Array"},Rp=Ah.concat("length","prototype"),Ml=Object.getOwnPropertyNames||function(a){return w0(a,Rp)},jc=Ml,Xc={}.toString,Yc=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Lh=function(a){if(Yc&&Xc.call(a)=="[object Window]")try{var u=jc(a)}catch(n){u=Yc.slice()}else u=jc(la(a));return u},Cl=Object.getOwnPropertyDescriptor,za={f:ko?Cl:function(a,u){if(a=la(a),u=xl(u,!0),wu)try{return Cl(a,u)}catch(n){}if($i(a,u))return Gs(!Ba.call(a,u),a[u])}},L0=Ts.KEY,Zc=za.f,Ss=yo.f,Ua=Lh,uo=si.Symbol,Tl=si.JSON,Sl=Tl&&Tl.stringify,Qn=rn("_hidden"),Il=rn("toPrimitive"),Jc={}.propertyIsEnumerable,$n=Bc("symbol-registry"),Eo=Bc("symbols"),ls=Bc("op-symbols"),xo=Object.prototype,Vs=typeof uo=="function",Tu=si.QObject,Su=!Tu||!Tu.prototype||!Tu.prototype.findChild,Iu=ko&&fa(function(){return Na(Ss({},"a",{get:function(){return Ss(this,"a",{value:7}).a}})).a!=7})?function(a,u,n){var l=Zc(xo,u);l&&delete xo[u],Ss(a,u,n),l&&a!==xo&&Ss(xo,u,l)}:Ss,Lo=function(a){var u=Eo[a]=Na(uo.prototype);return u._k=a,u},qc=Vs&&typeof uo.iterator=="symbol"?function(a){return typeof a=="symbol"}:function(a){return a instanceof uo},El=function(a,u,n){return a===xo&&El(ls,u,n),vo(a),u=xl(u,!0),vo(n),$i(Eo,u)?(n.enumerable?($i(a,Qn)&&a[Qn][u]&&(a[Qn][u]=!1),n=Na(n,{enumerable:Gs(0,!1)})):($i(a,Qn)||Ss(a,Qn,Gs(1,{})),a[Qn][u]=!0),Iu(a,u,n)):Ss(a,u,n)},Pp=function(a,u){vo(a);var n=u=la(u),l=Ho(n),v=us;if(v){v=v(n);for(var d=Ba,x=0,y;v.length>x;)d.call(n,y=v[x++])&&l.push(y)}n=0,y=l.length;for(var M;y>n;)El(a,M=l[n++],u[M]);return a},Ao=function(a){var u=Jc.call(this,a=xl(a,!0));return this===xo&&$i(Eo,a)&&!$i(ls,a)?!1:u||!$i(this,a)||!$i(Eo,a)||$i(this,Qn)&&this[Qn][a]?u:!0},Dp=function(a,u){if(a=la(a),u=xl(u,!0),a!==xo||!$i(Eo,u)||$i(ls,u)){var n=Zc(a,u);return!n||!$i(Eo,u)||$i(a,Qn)&&a[Qn][u]||(n.enumerable=!0),n}},Op=function(a){a=Ua(la(a));for(var u=[],n=0,l;a.length>n;)$i(Eo,l=a[n++])||l==Qn||l==L0||u.push(l);return u},Ll=function(a){var u=a===xo;a=Ua(u?ls:la(a));for(var n=[],l=0,v;a.length>l;)$i(Eo,v=a[l++])&&(!u||$i(xo,v))&&n.push(Eo[v]);return n};Vs||(uo=function(){if(this instanceof uo)throw TypeError("Symbol is not a constructor!");var a=ha(0<arguments.length?arguments[0]:void 0),u=function(n){this===xo&&u.call(ls,n),$i(this,Qn)&&$i(this[Qn],a)&&(this[Qn][a]=!1),Iu(this,a,Gs(1,n))};return ko&&Su&&Iu(xo,a,{configurable:!0,set:u}),Lo(a)},Cs(uo.prototype,"toString",function(){return this._k}),za.f=Dp,yo.f=El,Ml=Lh=Op,Ba=Ao,us=Ll,Wc.f=function(a){return Lo(rn(a))}),Er(Er.G+Er.W+Er.F*!Vs,{Symbol:uo});for(var Fp="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),Rh=0;Fp.length>Rh;)rn(Fp[Rh++]);for(var Bp=Ho(rn.store),Rl=0;Bp.length>Rl;)Eh(Bp[Rl++]);Er(Er.S+Er.F*!Vs,"Symbol",{for:function(a){return $i($n,a+="")?$n[a]:$n[a]=uo(a)},keyFor:function(a){if(!qc(a))throw TypeError(a+" is not a symbol!");for(var u in $n)if($n[u]===a)return u},useSetter:function(){Su=!0},useSimple:function(){Su=!1}}),Er(Er.S+Er.F*!Vs,"Object",{create:function(a,u){return u===void 0?Na(a):Pp(Na(a),u)},defineProperty:El,defineProperties:Pp,getOwnPropertyDescriptor:Dp,getOwnPropertyNames:Op,getOwnPropertySymbols:Ll}),Tl&&Er(Er.S+Er.F*(!Vs||fa(function(){var a=uo();return Sl([a])!="[null]"||Sl({a})!="{}"||Sl(Object(a))!="{}"})),"JSON",{stringify:function(a){for(var u=[a],n=1,l;arguments.length>n;)u.push(arguments[n++]);if(l=n=u[1],(mo(n)||a!==void 0)&&!qc(a))return wl(n)||(n=function(v,d){if(typeof l=="function"&&(d=l.call(this,v,d)),!qc(d))return d}),u[1]=n,Sl.apply(Tl,u)}}),uo.prototype[Il]||Cs(uo.prototype,Il,uo.prototype.valueOf),_l(uo,"Symbol"),_l(Math,"Math",!0),_l(si.JSON,"JSON",!0),Eh("asyncIterator"),Eh("observable");var Is=ji.Symbol,Kc=It(function(a){a.exports={default:Is,__esModule:!0}}),R0=zt(Kc),Pl=It(function(a,u){u.__esModule=!0,a=pa&&pa.__esModule?pa:{default:pa};var n=Kc&&Kc.__esModule?Kc:{default:Kc},l=typeof n.default=="function"&&typeof a.default=="symbol"?function(v){return typeof v}:function(v){return v&&typeof n.default=="function"&&v.constructor===n.default&&v!==n.default.prototype?"symbol":typeof v};u.default=typeof n.default=="function"&&l(a.default)==="symbol"?function(v){return typeof v=="undefined"?"undefined":l(v)}:function(v){return v&&typeof n.default=="function"&&v.constructor===n.default&&v!==n.default.prototype?"symbol":typeof v=="undefined"?"undefined":l(v)}}),Qr=zt(Pl),Wo=It(function(a,u){u.__esModule=!0;var n=Pl&&Pl.__esModule?Pl:{default:Pl};u.default=function(l,v){if(!l)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!v||(typeof v=="undefined"?"undefined":(0,n.default)(v))!=="object"&&typeof v!="function"?l:v}}),Dr=zt(Wo),P0=Object.setPrototypeOf||("__proto__"in{}?function(a,u,n){try{n=Vn(Function.call,za.f(Object.prototype,"__proto__").set,2),n(a,[]),u=!(a instanceof Array)}catch(l){u=!0}return function(l,v){if(vo(l),!mo(v)&&v!==null)throw TypeError(v+": can't set as prototype!");return u?l.__proto__=v:n(l,v),l}}({},!1):void 0);Er(Er.S,"Object",{setPrototypeOf:P0});var D0=ji.Object.setPrototypeOf,Ph=It(function(a){a.exports={default:D0,__esModule:!0}});zt(Ph),Er(Er.S,"Object",{create:Na});var Vg=ji.Object,Qc=function(a,u){return Vg.create(a,u)},Ur=It(function(a){a.exports={default:Qc,__esModule:!0}}),Es=zt(Ur),$c=It(function(a,u){function n(x){return x&&x.__esModule?x:{default:x}}u.__esModule=!0;var l=n(Ph),v=n(Ur),d=n(Pl);u.default=function(x,y){if(typeof y!="function"&&y!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof y=="undefined"?"undefined":(0,d.default)(y)));x.prototype=(0,v.default)(y&&y.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),y&&(l.default?(0,l.default)(x,y):x.__proto__=y)}}),Pr=zt($c),Ro=rn("toStringTag"),O0=yl(function(){return arguments}())=="Arguments",Eu=function(a){var u;if(a===void 0)var n="Undefined";else{if(a===null)var l="Null";else{t:{var v=a=Object(a);try{l=v[Ro];break t}catch(d){}l=void 0}l=typeof(n=l)=="string"?n:O0?yl(a):(u=yl(a))=="Object"&&typeof a.callee=="function"?"Arguments":u}n=l}return n},tf=rn("iterator"),da=ji.isIterable=function(a){return a=Object(a),a[tf]!==void 0||"@@iterator"in a||Vo.hasOwnProperty(Eu(a))},hs=It(function(a){a.exports={default:da,__esModule:!0}});zt(hs);var cs=rn("iterator"),Ls=ji.getIteratorMethod=function(a){if(a!=null)return a[cs]||a["@@iterator"]||Vo[Eu(a)]},ga=ji.getIterator=function(a){var u=Ls(a);if(typeof u!="function")throw TypeError(a+" is not iterable!");return vo(u.call(a))},fs=It(function(a){a.exports={default:ga,__esModule:!0}}),Po=zt(fs),Lu=It(function(a,u){u.__esModule=!0;var n=hs&&hs.__esModule?hs:{default:hs},l=fs&&fs.__esModule?fs:{default:fs};u.default=function(){return function(v,d){if(Array.isArray(v))return v;if((0,n.default)(Object(v))){var x=[],y=!0,M=!1,D=void 0;try{for(var U=(0,l.default)(v),C;!(y=(C=U.next()).done)&&(x.push(C.value),!d||x.length!==d);y=!0);}catch(E){M=!0,D=E}finally{try{!y&&U.return&&U.return()}finally{if(M)throw D}}return x}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),yi=zt(Lu),Ru=function(a,u,n,l){try{return l?u(vo(n)[0],n[1]):u(n)}catch(v){throw u=a.return,u!==void 0&&vo(u.call(a)),v}},nn=rn("iterator"),Np=Array.prototype,Ws=rn("iterator"),zp=!1;try{[7][Ws]().return=function(){zp=!0}}catch(a){}var ef=function(a,u){if(!u&&!zp)return!1;var n=!1;try{u=[7];var l=u[Ws]();l.next=function(){return{done:n=!0}},u[Ws]=function(){return l},a(u)}catch(v){}return n};Er(Er.S+Er.F*!ef(function(a){}),"Array",{from:function(a){var u=Object(ua(a)),n=typeof this=="function"?this:Array,l=arguments.length,v=1<l?arguments[1]:void 0,d=v!==void 0,x=0,y=Ls(u),M;if(d&&(v=Vn(v,2<l?arguments[2]:void 0,2)),y!=null&&(n!=Array||y===void 0||Vo.Array!==y&&Np[nn]!==y))for(u=y.call(u),n=new n;!(M=u.next()).done;x++)l=n,y=x,M=d?Ru(u,v,[M.value,x],!0):M.value,y in l?yo.f(l,y,Gs(0,M)):l[y]=M;else for(l=Fc(u.length),n=new n(l);l>x;x++){y=n,M=x;var D=d?v(u[x],x):u[x];M in y?yo.f(y,M,Gs(0,D)):y[M]=D}return n.length=x,n}});var Wg=ji.Array.from,Pu=It(function(a){a.exports={default:Wg,__esModule:!0}}),js=zt(Pu),jg=It(function(a,u){u.__esModule=!0;var n=Pu&&Pu.__esModule?Pu:{default:Pu};u.default=function(l){if(Array.isArray(l)){for(var v=0,d=Array(l.length);v<l.length;v++)d[v]=l[v];return d}return(0,n.default)(l)}}),Jr=zt(jg),Xg=Ts.onFreeze;Xi("freeze",function(a){return function(u){return a&&mo(u)?a(Xg(u)):u}});var Yg=ji.Object.freeze,Zg=It(function(a){a.exports={default:Yg,__esModule:!0}}),Rs=zt(Zg),Up=ji.JSON||(ji.JSON={stringify:JSON.stringify}),Hp=function(a){return Up.stringify.apply(Up,arguments)},Jg=It(function(a){a.exports={default:Hp,__esModule:!0}}),Dl=zt(Jg),ps={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},F0=za.f;Xi("getOwnPropertyDescriptor",function(){return function(a,u){return F0(la(a),u)}});var B0=ji.Object,N0=function(a,u){return B0.getOwnPropertyDescriptor(a,u)},Dh=It(function(a){a.exports={default:N0,__esModule:!0}}),vn=zt(Dh),Oh=It(function(a){var u=Array.prototype.concat,n=Array.prototype.slice,l=a.exports=function(v){for(var d=[],x=0,y=v.length;x<y;x++){var M=v[x],D=(D=M)&&typeof D!="string"?D instanceof Array||Array.isArray(D)||0<=D.length&&(D.splice instanceof Function||vn(D,D.length-1)&&D.constructor.name!=="String"):!1;D?d=u.call(d,n.call(M)):d.push(M)}return d};l.wrap=function(v){return function(){return v(l(arguments))}}}),Fh=It(function(a){function u(x,y,M){return Math.min(Math.max(y,x),M)}function n(x){return x=x.toString(16).toUpperCase(),2>x.length?"0"+x:x}var l={},v;for(v in ps)ps.hasOwnProperty(v)&&(l[ps[v]]=v);var d=a.exports={to:{},get:{}};d.get=function(x){switch(x.substring(0,3).toLowerCase()){case"hsl":x=d.get.hsl(x);var y="hsl";break;case"hwb":x=d.get.hwb(x),y="hwb";break;default:x=d.get.rgb(x),y="rgb"}return x?{model:y,value:x}:null},d.get.rgb=function(x){if(!x)return null;var y=/^#([a-f0-9]{3,4})$/i,M=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,D=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,U=/(\D+)/,C=[0,0,0,1],E;if(E=x.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(y=E[2],E=E[1],x=0;3>x;x++)M=2*x,C[x]=parseInt(E.slice(M,M+2),16);y&&(C[3]=Math.round(parseInt(y,16)/255*100)/100)}else if(E=x.match(y)){for(E=E[1],y=E[3],x=0;3>x;x++)C[x]=parseInt(E[x]+E[x],16);y&&(C[3]=Math.round(parseInt(y+y,16)/255*100)/100)}else if(E=x.match(M)){for(x=0;3>x;x++)C[x]=parseInt(E[x+1],0);E[4]&&(C[3]=parseFloat(E[4]))}else if(E=x.match(D)){for(x=0;3>x;x++)C[x]=Math.round(2.55*parseFloat(E[x+1]));E[4]&&(C[3]=parseFloat(E[4]))}else return(E=x.match(U))?E[1]==="transparent"?[0,0,0,0]:(C=ps[E[1]],C?(C[3]=1,C):null):null;for(x=0;3>x;x++)C[x]=u(C[x],0,255);return C[3]=u(C[3],0,1),C},d.get.hsl=function(x){if(!x)return null;var y=x.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(y){var M=parseFloat(y[4]);x=(parseFloat(y[1])+360)%360;var D=u(parseFloat(y[2]),0,100);return y=u(parseFloat(y[3]),0,100),M=u(isNaN(M)?1:M,0,1),[x,D,y,M]}return null},d.get.hwb=function(x){if(!x)return null;var y=x.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(y){var M=parseFloat(y[4]);x=(parseFloat(y[1])%360+360)%360;var D=u(parseFloat(y[2]),0,100);return y=u(parseFloat(y[3]),0,100),M=u(isNaN(M)?1:M,0,1),[x,D,y,M]}return null},d.to.hex=function(){var x=Oh(arguments);return"#"+n(x[0])+n(x[1])+n(x[2])+(1>x[3]?n(Math.round(255*x[3])):"")},d.to.rgb=function(){var x=Oh(arguments);return 4>x.length||x[3]===1?"rgb("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+")":"rgba("+Math.round(x[0])+", "+Math.round(x[1])+", "+Math.round(x[2])+", "+x[3]+")"},d.to.rgb.percent=function(){var x=Oh(arguments),y=Math.round(x[0]/255*100),M=Math.round(x[1]/255*100),D=Math.round(x[2]/255*100);return 4>x.length||x[3]===1?"rgb("+y+"%, "+M+"%, "+D+"%)":"rgba("+y+"%, "+M+"%, "+D+"%, "+x[3]+")"},d.to.hsl=function(){var x=Oh(arguments);return 4>x.length||x[3]===1?"hsl("+x[0]+", "+x[1]+"%, "+x[2]+"%)":"hsla("+x[0]+", "+x[1]+"%, "+x[2]+"%, "+x[3]+")"},d.to.hwb=function(){var x=Oh(arguments),y="";return 4<=x.length&&x[3]!==1&&(y=", "+x[3]),"hwb("+x[0]+", "+x[1]+"%, "+x[2]+"%"+y+")"},d.to.keyword=function(x){return l[x.slice(0,3)]}}),Ha=It(function(a){var u={};for(v in ps)ps.hasOwnProperty(v)&&(u[ps[v]]=v);var n=a.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},l;for(l in n)if(n.hasOwnProperty(l)){if(!("channels"in n[l]))throw Error("missing channels property: "+l);if(!("labels"in n[l]))throw Error("missing channel labels property: "+l);if(n[l].labels.length!==n[l].channels)throw Error("channel and label counts mismatch: "+l);a=n[l].channels;var v=n[l].labels;delete n[l].channels,delete n[l].labels,Object.defineProperty(n[l],"channels",{value:a}),Object.defineProperty(n[l],"labels",{value:v})}n.rgb.hsl=function(d){var x=d[0]/255,y=d[1]/255,M=d[2]/255;d=Math.min(x,y,M);var D=Math.max(x,y,M),U=D-d,C;return D===d?C=0:x===D?C=(y-M)/U:y===D?C=2+(M-x)/U:M===D&&(C=4+(x-y)/U),C=Math.min(60*C,360),0>C&&(C+=360),x=(d+D)/2,[C,100*(D===d?0:.5>=x?U/(D+d):U/(2-D-d)),100*x]},n.rgb.hsv=function(d){var x,y=d[0]/255,M=d[1]/255,D=d[2]/255,U=Math.max(y,M,D),C=U-Math.min(y,M,D);if(C===0)var E=x=0;else{x=C/U,d=(U-y)/6/C+.5;var B=(U-M)/6/C+.5;C=(U-D)/6/C+.5,y===U?E=C-B:M===U?E=1/3+d-C:D===U&&(E=2/3+B-d),0>E?E+=1:1<E&&--E}return[360*E,100*x,100*U]},n.rgb.hwb=function(d){var x=d[0],y=d[1],M=d[2];d=n.rgb.hsl(d)[0];var D=1/255*Math.min(x,Math.min(y,M));return M=1-1/255*Math.max(x,Math.max(y,M)),[d,100*D,100*M]},n.rgb.cmyk=function(d){var x=d[0]/255,y=d[1]/255;d=d[2]/255;var M=Math.min(1-x,1-y,1-d);return[100*((1-x-M)/(1-M)||0),100*((1-y-M)/(1-M)||0),100*((1-d-M)/(1-M)||0),100*M]},n.rgb.keyword=function(d){var x=u[d];if(x)return x;x=1/0;var y;for(y in ps)if(ps.hasOwnProperty(y)){var M=ps[y];if(M=Math.pow(d[0]-M[0],2)+Math.pow(d[1]-M[1],2)+Math.pow(d[2]-M[2],2),M<x){x=M;var D=y}}return D},n.keyword.rgb=function(d){return ps[d]},n.rgb.xyz=function(d){var x=d[0]/255,y=d[1]/255;return d=d[2]/255,x=.04045<x?Math.pow((x+.055)/1.055,2.4):x/12.92,y=.04045<y?Math.pow((y+.055)/1.055,2.4):y/12.92,d=.04045<d?Math.pow((d+.055)/1.055,2.4):d/12.92,[100*(.4124*x+.3576*y+.1805*d),100*(.2126*x+.7152*y+.0722*d),100*(.0193*x+.1192*y+.9505*d)]},n.rgb.lab=function(d){var x=n.rgb.xyz(d);d=x[0];var y=x[1];return x=x[2],d/=95.047,y/=100,x/=108.883,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,y=.008856<y?Math.pow(y,1/3):7.787*y+16/116,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,[116*y-16,500*(d-y),200*(y-x)]},n.hsl.rgb=function(d){var x=d[0]/360,y=d[1]/100;if(d=d[2]/100,y===0){var M=255*d;return[M,M,M]}y=.5>d?d*(1+y):d+y-d*y,d=2*d-y;for(var D=[0,0,0],U=0;3>U;U++)M=x+1/3*-(U-1),0>M&&M++,1<M&&M--,M=1>6*M?d+6*(y-d)*M:1>2*M?y:2>3*M?d+(y-d)*(2/3-M)*6:d,D[U]=255*M;return D},n.hsl.hsv=function(d){var x=d[0],y=d[1]/100;d=d[2]/100;var M=y,D=Math.max(d,.01);return d*=2,y*=1>=d?d:2-d,M*=1>=D?D:2-D,[x,100*(d===0?2*M/(D+M):2*y/(d+y)),(d+y)/2*100]},n.hsv.rgb=function(d){var x=d[0]/60,y=d[1]/100;d=d[2]/100;var M=Math.floor(x)%6,D=x-Math.floor(x);x=255*d*(1-y);var U=255*d*(1-y*D);switch(y=255*d*(1-y*(1-D)),d*=255,M){case 0:return[d,y,x];case 1:return[U,d,x];case 2:return[x,d,y];case 3:return[x,U,d];case 4:return[y,x,d];case 5:return[d,x,U]}},n.hsv.hsl=function(d){var x=d[0],y=d[1]/100;d=d[2]/100;var M=Math.max(d,.01),D=(2-y)*M;return M=y*M/(1>=D?D:2-D)||0,[x,100*M,(2-y)*d/2*100]},n.hwb.rgb=function(d){var x=d[0]/360,y=d[1]/100;d=d[2]/100;var M=y+d;switch(1<M&&(y/=M,d/=M),M=Math.floor(6*x),d=1-d,x=6*x-M,M&1&&(x=1-x),x=y+x*(d-y),M){default:case 6:case 0:M=d;var D=x;break;case 1:M=x,D=d;break;case 2:M=y,D=d,y=x;break;case 3:M=y,D=x,y=d;break;case 4:M=x,D=y,y=d;break;case 5:M=d,D=y,y=x}return[255*M,255*D,255*y]},n.cmyk.rgb=function(d){var x=d[3]/100;return[255*(1-Math.min(1,d[0]/100*(1-x)+x)),255*(1-Math.min(1,d[1]/100*(1-x)+x)),255*(1-Math.min(1,d[2]/100*(1-x)+x))]},n.xyz.rgb=function(d){var x=d[0]/100,y=d[1]/100,M=d[2]/100;d=3.2406*x+-1.5372*y+-.4986*M;var D=-.9689*x+1.8758*y+.0415*M;return x=.0557*x+-.204*y+1.057*M,d=.0031308<d?1.055*Math.pow(d,1/2.4)-.055:12.92*d,D=.0031308<D?1.055*Math.pow(D,1/2.4)-.055:12.92*D,x=.0031308<x?1.055*Math.pow(x,1/2.4)-.055:12.92*x,d=Math.min(Math.max(0,d),1),D=Math.min(Math.max(0,D),1),x=Math.min(Math.max(0,x),1),[255*d,255*D,255*x]},n.xyz.lab=function(d){var x=d[0],y=d[1];return d=d[2],x/=95.047,y/=100,d/=108.883,x=.008856<x?Math.pow(x,1/3):7.787*x+16/116,y=.008856<y?Math.pow(y,1/3):7.787*y+16/116,d=.008856<d?Math.pow(d,1/3):7.787*d+16/116,[116*y-16,500*(x-y),200*(y-d)]},n.lab.xyz=function(d){var x=d[1],y=d[2];d=(d[0]+16)/116,x=x/500+d,y=d-y/200;var M=Math.pow(d,3),D=Math.pow(x,3),U=Math.pow(y,3);return[95.047*(.008856<D?D:(x-16/116)/7.787),100*(.008856<M?M:(d-16/116)/7.787),108.883*(.008856<U?U:(y-16/116)/7.787)]},n.lab.lch=function(d){var x=d[0],y=d[1];d=d[2];var M=360*Math.atan2(d,y)/2/Math.PI;return 0>M&&(M+=360),[x,Math.sqrt(y*y+d*d),M]},n.lch.lab=function(d){var x=d[0],y=d[1];return d=d[2]/360*2*Math.PI,[x,y*Math.cos(d),y*Math.sin(d)]},n.rgb.ansi16=function(d){var x=d[0],y=d[1],M=d[2],D=1 in arguments?arguments[1]:n.rgb.hsv(d)[2];return D=Math.round(D/50),D===0?30:(x=30+(Math.round(M/255)<<2|Math.round(y/255)<<1|Math.round(x/255)),D===2&&(x+=60),x)},n.hsv.ansi16=function(d){return n.rgb.ansi16(n.hsv.rgb(d),d[2])},n.rgb.ansi256=function(d){var x=d[0],y=d[1];return d=d[2],x===y&&y===d?8>x?16:248<x?231:Math.round((x-8)/247*24)+232:16+36*Math.round(x/255*5)+6*Math.round(y/255*5)+Math.round(d/255*5)},n.ansi16.rgb=function(d){var x=d%10;return x===0||x===7?(50<d&&(x+=3.5),x=x/10.5*255,[x,x,x]):(d=.5*(~~(50<d)+1),[(x&1)*d*255,(x>>1&1)*d*255,(x>>2&1)*d*255])},n.ansi256.rgb=function(d){if(232<=d){var x=10*(d-232)+8;return[x,x,x]}d-=16,x=Math.floor(d/36)/5*255;var y=Math.floor((d%=36)/6)/5*255;return[x,y,d%6/5*255]},n.rgb.hex=function(d){return d=(((Math.round(d[0])&255)<<16)+((Math.round(d[1])&255)<<8)+(Math.round(d[2])&255)).toString(16).toUpperCase(),"000000".substring(d.length)+d},n.hex.rgb=function(d){if(d=d.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!d)return[0,0,0];var x=d[0];return d[0].length===3&&(x=x.split("").map(function(y){return y+y}).join("")),d=parseInt(x,16),[d>>16&255,d>>8&255,d&255]},n.rgb.hcg=function(d){var x=d[0]/255,y=d[1]/255;d=d[2]/255;var M=Math.max(Math.max(x,y),d),D=Math.min(Math.min(x,y),d),U=M-D;return[(0>=U?0:M===x?(y-d)/U%6:M===y?2+(d-x)/U:(x-y)/U+8)/6%1*360,100*U,100*(1>U?D/(1-U):0)]},n.hsl.hcg=function(d){var x=d[1]/100,y=d[2]/100,M=0;return x=.5>y?2*x*y:2*x*(1-y),1>x&&(M=(y-.5*x)/(1-x)),[d[0],100*x,100*M]},n.hsv.hcg=function(d){var x=d[2]/100,y=d[1]/100*x,M=0;return 1>y&&(M=(x-y)/(1-y)),[d[0],100*y,100*M]},n.hcg.rgb=function(d){var x=d[1]/100,y=d[2]/100;if(x===0)return[255*y,255*y,255*y];var M=[0,0,0];d=d[0]/360%1*6;var D=d%1,U=1-D;switch(Math.floor(d)){case 0:M[0]=1,M[1]=D,M[2]=0;break;case 1:M[0]=U,M[1]=1,M[2]=0;break;case 2:M[0]=0,M[1]=1,M[2]=D;break;case 3:M[0]=0,M[1]=U,M[2]=1;break;case 4:M[0]=D,M[1]=0,M[2]=1;break;default:M[0]=1,M[1]=0,M[2]=U}return y*=1-x,[255*(x*M[0]+y),255*(x*M[1]+y),255*(x*M[2]+y)]},n.hcg.hsv=function(d){var x=d[1]/100,y=x+d[2]/100*(1-x),M=0;return 0<y&&(M=x/y),[d[0],100*M,100*y]},n.hcg.hsl=function(d){var x=d[1]/100,y=d[2]/100*(1-x)+.5*x,M=0;return 0<y&&.5>y?M=x/(2*y):.5<=y&&1>y&&(M=x/(2*(1-y))),[d[0],100*M,100*y]},n.hcg.hwb=function(d){var x=d[1]/100,y=x+d[2]/100*(1-x);return[d[0],100*(y-x),100*(1-y)]},n.hwb.hcg=function(d){var x=1-d[2]/100,y=x-d[1]/100,M=0;return 1>y&&(M=(x-y)/(1-y)),[d[0],100*y,100*M]},n.apple.rgb=function(d){return[d[0]/65535*255,d[1]/65535*255,d[2]/65535*255]},n.rgb.apple=function(d){return[d[0]/255*65535,d[1]/255*65535,d[2]/255*65535]},n.gray.rgb=function(d){return[d[0]/100*255,d[0]/100*255,d[0]/100*255]},n.gray.hsl=n.gray.hsv=function(d){return[0,0,d[0]]},n.gray.hwb=function(d){return[0,100,d[0]]},n.gray.cmyk=function(d){return[0,0,0,d[0]]},n.gray.lab=function(d){return[d[0],0,0]},n.gray.hex=function(d){return d=Math.round(d[0]/100*255)&255,d=((d<<16)+(d<<8)+d).toString(16).toUpperCase(),"000000".substring(d.length)+d},n.rgb.gray=function(d){return[(d[0]+d[1]+d[2])/3/255*100]}}),z0=function(a){for(var u={},n=dn(Ha),l=n.length,v=0;v<l;v++)u[n[v]]={distance:-1,parent:null};for(n=[a],u[a].distance=0;n.length;){a=n.pop(),l=dn(Ha[a]),v=l.length;for(var d=0;d<v;d++){var x=l[d],y=u[x];y.distance===-1&&(y.distance=u[a].distance+1,y.parent=a,n.unshift(x))}}for(n={},a=dn(u),l=a.length,v=0;v<l;v++){var M=a[v];if(u[M].parent!==null){d=M,x=u,y=[x[M].parent,M];var D=Ha[x[M].parent][M];for(M=x[M].parent;x[M].parent;)y.unshift(x[M].parent),D=ue(Ha[x[M].parent][M],D),M=x[M].parent;D.conversion=y,n[d]=D}}return n},ma={};dn(Ha).forEach(function(a){ma[a]={},Object.defineProperty(ma[a],"channels",{value:Ha[a].channels}),Object.defineProperty(ma[a],"labels",{value:Ha[a].labels});var u=z0(a);dn(u).forEach(function(n){var l=u[n];ma[a][n]=vt(l),ma[a][n].raw=se(l)})});var jo=ma,kp=[].slice,qg=["keyword","gray","hex"],Gp={};dn(jo).forEach(function(a){Gp[kp.call(jo[a].labels).sort().join("")]=a});var Wn={};Ot.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(a){var u=this.model in Fh.to?this:this.rgb();return u=u.round(typeof a=="number"?a:1),a=u.valpha===1?u.color:u.color.concat(this.valpha),Fh.to[u.model](a)},percentString:function(a){return a=this.rgb().round(typeof a=="number"?a:1),a=a.valpha===1?a.color:a.color.concat(this.valpha),Fh.to.rgb.percent(a)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var a={},u=jo[this.model].channels,n=jo[this.model].labels,l=0;l<u;l++)a[n[l]]=this.color[l];return this.valpha!==1&&(a.alpha=this.valpha),a},unitArray:function(){var a=this.rgb().color;return a[0]/=255,a[1]/=255,a[2]/=255,this.valpha!==1&&a.push(this.valpha),a},unitObject:function(){var a=this.rgb().object();return a.r/=255,a.g/=255,a.b/=255,this.valpha!==1&&(a.alpha=this.valpha),a},round:function(a){return a=Math.max(a||0,0),new Ot(this.color.map(Lt(a)).concat(this.valpha),this.model)},alpha:function(a){return arguments.length?new Ot(this.color.concat(Math.max(0,Math.min(1,a))),this.model):this.valpha},red:_t("rgb",0,Ft(255)),green:_t("rgb",1,Ft(255)),blue:_t("rgb",2,Ft(255)),hue:_t(["hsl","hsv","hsl","hwb","hcg"],0,function(a){return(a%360+360)%360}),saturationl:_t("hsl",1,Ft(100)),lightness:_t("hsl",2,Ft(100)),saturationv:_t("hsv",1,Ft(100)),value:_t("hsv",2,Ft(100)),chroma:_t("hcg",1,Ft(100)),gray:_t("hcg",2,Ft(100)),white:_t("hwb",1,Ft(100)),wblack:_t("hwb",2,Ft(100)),cyan:_t("cmyk",0,Ft(100)),magenta:_t("cmyk",1,Ft(100)),yellow:_t("cmyk",2,Ft(100)),black:_t("cmyk",3,Ft(100)),x:_t("xyz",0,Ft(100)),y:_t("xyz",1,Ft(100)),z:_t("xyz",2,Ft(100)),l:_t("lab",0,Ft(100)),a:_t("lab",1),b:_t("lab",2),keyword:function(a){return arguments.length?new Ot(a):jo[this.model].keyword(this.color)},hex:function(a){return arguments.length?new Ot(a):Fh.to.hex(this.rgb().round().color)},rgbNumber:function(){var a=this.rgb().color;return(a[0]&255)<<16|(a[1]&255)<<8|a[2]&255},luminosity:function(){for(var a=this.rgb().color,u=[],n=0;n<a.length;n++){var l=a[n]/255;u[n]=.03928>=l?l/12.92:Math.pow((l+.055)/1.055,2.4)}return .2126*u[0]+.7152*u[1]+.0722*u[2]},contrast:function(a){var u=this.luminosity();return a=a.luminosity(),u>a?(u+.05)/(a+.05):(a+.05)/(u+.05)},level:function(a){return a=this.contrast(a),7.1<=a?"AAA":4.5<=a?"AA":""},isDark:function(){var a=this.rgb().color;return 128>(299*a[0]+587*a[1]+114*a[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var a=this.rgb(),u=0;3>u;u++)a.color[u]=255-a.color[u];return a},lighten:function(a){var u=this.hsl();return u.color[2]+=u.color[2]*a,u},darken:function(a){var u=this.hsl();return u.color[2]-=u.color[2]*a,u},saturate:function(a){var u=this.hsl();return u.color[1]+=u.color[1]*a,u},desaturate:function(a){var u=this.hsl();return u.color[1]-=u.color[1]*a,u},whiten:function(a){var u=this.hwb();return u.color[1]+=u.color[1]*a,u},blacken:function(a){var u=this.hwb();return u.color[2]+=u.color[2]*a,u},grayscale:function(){var a=this.rgb().color;return a=.3*a[0]+.59*a[1]+.11*a[2],Ot.rgb(a,a,a)},fade:function(a){return this.alpha(this.valpha-this.valpha*a)},opaquer:function(a){return this.alpha(this.valpha+this.valpha*a)},rotate:function(a){var u=this.hsl(),n=u.color[0];return n=(n+a)%360,u.color[0]=0>n?360+n:n,u},mix:function(a,u){if(!a||!a.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof a=="undefined"?"undefined":Qr(a)));a=a.rgb();var n=this.rgb();u=u===void 0?.5:u;var l=2*u-1,v=a.alpha()-n.alpha();return l=((l*v===-1?l:(l+v)/(1+l*v))+1)/2,v=1-l,Ot.rgb(l*a.red()+v*n.red(),l*a.green()+v*n.green(),l*a.blue()+v*n.blue(),a.alpha()*u+n.alpha()*(1-u))}},dn(jo).forEach(function(a){if(qg.indexOf(a)===-1){var u=jo[a].channels;Ot.prototype[a]=function(){if(this.model===a)return new Ot(this);if(arguments.length)return new Ot(arguments,a);var n=typeof arguments[u]=="number"?u:this.valpha,l=jo[this.model][a].raw(this.color);return l=Array.isArray(l)?l:[l],new Ot(l.concat(n),a)},Ot[a]=function(n){return typeof n=="number"&&(n=$t(kp.call(arguments),u)),new Ot(n,a)}}}),li(hi.prototype,{equals:function(a){return this.lat===a.lat&&this.lng===a.lng},clone:function(){return new hi(this.lat,this.lng)},getLngSpan:function(a){return a=Math.abs(a-this.lng),180<a&&(a=360-a),a},sub:function(a){return new hi(this.lat-a.lat,this.lng-a.lng)},toString:function(){return"Point"}}),li(Yr,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(a,u){if(!a||!u||(a=this.convertMC2LL(a),!a))return 0;var n=this.toRadians(a.lng);if(a=this.toRadians(a.lat),u=this.convertMC2LL(u),!u)return 0;var l=this.toRadians(u.lng);return u=this.toRadians(u.lat),this.getDistance(n,l,a,u)},getDistanceByLL:function(a,u){if(!a||!u)return 0;a.lng=this.getLoop(a.lng,-180,180),a.lat=this.getRange(a.lat,-74,74),u.lng=this.getLoop(u.lng,-180,180),u.lat=this.getRange(u.lat,-74,74);var n=this.toRadians(a.lng),l=this.toRadians(a.lat);return a=this.toRadians(u.lng),u=this.toRadians(u.lat),this.getDistance(n,a,l,u)},convertMC2LL:function(a){if(a==null)return new hi(0,0);if(180>a.lng&&-180<a.lng&&90>a.lat&&-90<a.lat)return a;if(window.BMAPGL_84)return new hi(180/Math.PI*(2*Math.atan(Math.exp(a.lat/2003750834e-2*180*Math.PI/180))-Math.PI/2),a.lng/2003750834e-2*180);for(var u=new hi(Math.abs(a.lng),Math.abs(a.lat)),n=0;n<this.MCBAND.length;n++)if(u.lat>=this.MCBAND[n]){var l=this.MC2LL[n];break}return a=this.convertor(a,l),a=new hi(a.lng.toFixed(6),a.lat.toFixed(6))},convertLL2MC:function(a){if(a==null)return new hi(0,0);if(180<a.lng||-180>a.lng||90<a.lat||-90>a.lat)return a;if(window.BMAPGL_84){var u=a.lat*Math.PI/180;return new hi(a.lng*Math.PI/180*6378137,31890685e-1*Math.log((1+Math.sin(u))/(1-Math.sin(u))))}a.lng=this.getLoop(a.lng,-180,180),a.lat=this.getRange(a.lat,-74,74),u=new hi(a.lng,a.lat);for(var n=0;n<this.LLBAND.length;n++)if(u.lat>=this.LLBAND[n]){var l=this.LL2MC[n];break}if(!l){for(n=0;n<this.LLBAND.length;n++)if(u.lat<=-this.LLBAND[n]){l=this.LL2MC[n];break}}return a=this.convertor(a,l),a=new hi(Number(a.lng.toFixed(2)),Number(a.lat.toFixed(2)))},convertor:function(a,u){if(a&&u){var n=u[0]+u[1]*Math.abs(a.lng),l=Math.abs(a.lat)/u[9];return u=u[2]+u[3]*l+u[4]*l*l+u[5]*l*l*l+u[6]*l*l*l*l+u[7]*l*l*l*l*l+u[8]*l*l*l*l*l*l,n*=0>a.lng?-1:1,u*=0>a.lat?-1:1,new hi(n,u)}},getDistance:function(a,u,n,l){return this.EARTHRADIUS*Math.acos(Math.sin(n)*Math.sin(l)+Math.cos(n)*Math.cos(l)*Math.cos(u-a))},toRadians:function(a){return Math.PI*a/180},toDegrees:function(a){return 180*a/Math.PI},getRange:function(a,u,n){return u!=null&&(a=Math.max(a,u)),n!=null&&(a=Math.min(a,n)),a},getLoop:function(a,u,n){for(;a>n;)a-=n-u;for(;a<u;)a+=n-u;return a}}),li(Yr.prototype,{lngLatToMercator:function(a){return Yr.convertLL2MC(a)},lngLatToPoint:function(a){return a=Yr.convertLL2MC(a),new Bi(a.lng,a.lat)},mercatorToLngLat:function(a){return Yr.convertMC2LL(a)},pointToLngLat:function(a){return a=new hi(a.x,a.y),Yr.convertMC2LL(a)},pointToPixel:function(a,u,n,l,v){if(a)return a=this.lngLatToMercator(a,v),u=this.getZoomUnits(u),new Bi(Math.round((a.lng-n.lng)/u+l.width/2),Math.round((n.lat-a.lat)/u+l.height/2))},pixelToPoint:function(a,u,n,l,v){if(a)return u=this.getZoomUnits(u),a=new hi(n.lng+u*(a.x-l.width/2),n.lat-u*(a.y-l.height/2)),this.mercatorToLngLat(a,v)},getZoomUnits:function(a){return Math.pow(2,18-a)}}),_i.prototype.setMax=function(a){this.max=a||100},_i.prototype.setMin=function(a){this.min=a||0},_i.prototype.setMaxSize=function(a){this.maxSize=a||35},_i.prototype.setMinSize=function(a){this.minSize=a||0},_i.prototype.initPalette=function(){var a=this.gradient,u=this.paletteCtx=new fn(256,1).getContext("2d"),n=u.createLinearGradient(0,0,256,1);dn(a).forEach(function(l){n.addColorStop(parseFloat(l),a[l])}),u.fillStyle=n,u.fillRect(0,0,256,1),u.imageData=u.getImageData(0,0,256,1).data},_i.prototype.getColor=function(a){return a=this.getImageData(a),"rgba("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]/256+")"},_i.prototype.getImageData=function(a){var u=this.paletteCtx.imageData;if(a===void 0)return u;var n=this.max,l=this.min;return a>n&&(a=n),a<l&&(a=l),a=4*Math.floor((a-l)/(n-l)*255),[u[a],u[a+1],u[a+2],u[a+3]]},_i.prototype.getSize=function(a){var u=this.max,n=this.min,l=this.maxSize,v=this.minSize;return a>u&&(a=u),a<n&&(a=n),v+(a-n)/(u-n)*(l-v)},Ci.prototype._initialize=function(){this.v0=this._normalizaCoord(this.options.start),this.v3=this._normalizaCoord(this.options.end),this.v1=this._getControlPoint(this.v0,this.v3,4),this.v2=this._getControlPoint(this.v3,this.v0,5),this.v0[2]||(this.v0[2]=0),this.v3[2]||(this.v3[2]=0)},Ci.prototype.setOptions=function(a){this.options=a||{},this._initialize()},Ci.prototype.getPoints=function(a){a===void 0&&(a=20);for(var u=[],n=0;n<=a;n++)u.push(this._getPoint(n/a));return u},Ci.prototype._normalizaCoord=function(a){return a?(a=Yr.convertLL2MC({lng:Number(a[0]),lat:Number(a[1])}),[a.lng,a.lat]):[]},Ci.prototype._getControlPoint=function(a,u){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:1;return[].concat(Jr(this._getQuarter(a,u)),[this._getDistance(a,u)/n])},Ci.prototype._getQuarter=function(a,u){return[(3*a[0]+u[0])/4,(3*a[1]+u[1])/4]},Ci.prototype._getDistance=function(a,u){return Math.sqrt(Math.pow(a[0]-u[0],2)+Math.pow(a[1]-u[1],2))},Ci.prototype._getPoint=function(a){var u=[],n=this.v0,l=this.v1,v=this.v2,d=this.v3;return u.push(Vt(a,n[0],l[0],v[0],d[0]),Vt(a,n[1],l[1],v[1],d[1]),Vt(a,n[2],l[2],v[2],d[2])),u},Re.prototype._initialize=function(){this.points=this.options.points||this.options.point||[],this.greatCirclePoints=[];for(var a=[],u=0;u<this.points.length;u++){var n=this._normalizaCoord(this.points[u]);n&&a.push(n)}this.points=a},Re.prototype.setOptions=function(a){this.options=a||{},this._initialize()},Re.prototype.getPoints=function(){if(this.greatCirclePoints.length===0)for(var a=0;a<this.points.length-1;a++)this._calcGreatCirclePoints(this.points[a],this.points[a+1]);return this.greatCirclePoints},Re.prototype._normalizaCoord=function(a){if(!a)return null;a instanceof Array&&(a={lng:Number(a[0]),lat:Number(a[1])});var u=Yr.convertLL2MC(a);return a=Yr.convertMC2LL(a),u.latLng=a,u},Re.prototype._calcGreatCirclePoints=function(a,u){var n=a.latLng,l=u.latLng;if(!Lr(n.lng,l.lng)||!Lr(n.lat,l.lat)){var v=Yr.getDistance(jt(n.lng),jt(n.lat),jt(l.lng),jt(l.lat));if(!(25e4>v)){v=Math.round(v/15e4);var d=this._calcAngularDistance(n,l);this.greatCirclePoints.push([a.lng,a.lat]);for(var x=0;x<v;x++){var y=this._calcMiddlePoint(n,l,x/v,d);y=Yr.convertLL2MC(y);var M=_e(y,a);30037726<M&&(y.lng=y.lng<a.lng?y.lng+this.WORLD_SIZE_MC:y.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([y.lng,y.lat]),a=y}M=_e(u,a),30037726<M&&(u.lng=u.lng<a.lng?u.lng+this.WORLD_SIZE_MC:u.lng-this.WORLD_SIZE_MC),this.greatCirclePoints.push([u.lng,u.lat])}}},Re.prototype._calcAngularDistance=function(a,u){var n=jt(a.lat),l=jt(u.lat);return a=jt(a.lng),u=jt(u.lng),Math.acos(Math.sin(n)*Math.sin(l)+Math.cos(n)*Math.cos(l)*Math.cos(Math.abs(u-a)))},Re.prototype._calcMiddlePoint=function(a,u,n,l){var v=u.lat,d=a.lng;u=u.lng,a=jt(a.lat),v=jt(v),d=jt(d);var x=jt(u);return u=Math.sin((1-n)*l)/Math.sin(l),l=Math.sin(n*l)/Math.sin(l),n=u*Math.cos(a)*Math.cos(d)+l*Math.cos(v)*Math.cos(x),d=u*Math.cos(a)*Math.sin(d)+l*Math.cos(v)*Math.sin(x),a=Math.atan2(u*Math.sin(a)+l*Math.sin(v),Math.sqrt(Math.pow(n,2)+Math.pow(d,2))),new hi(ot(Math.atan2(d,n)),ot(a))};var U0=function(){function a(){var u=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Ke(this,a),this.options=u,this._initialize()}return Qe(a,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(u){return u?(u instanceof Array&&(u={lng:Number(u[0]),lat:Number(u[1])}),Yr.convertLL2MC(u)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(u){for(var n=[],l=this.points,v=0;v<l.length-1;v++){var d=this.getCurveByTwoPoints(this._normalizaCoord(l[v]),this._normalizaCoord(l[v+1]),u);d&&0<d.length&&(n=n.concat(d))}return n}},{key:"getCurveByTwoPoints",value:function(u,n){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!u||!n)return null;var v=[],d=0;if((typeof n=="undefined"?"undefined":Qr(n))===void 0)typeof v=="undefined"||Qr(v);else{var x=parseFloat(u.lat),y=parseFloat(n.lat),M=parseFloat(u.lng),D=parseFloat(n.lng);D>M&&180<parseFloat(D-M)&&0>M&&(M=parseFloat(360+M),D=parseFloat(360+D));var U=0;if(y===x)var C=0,E=M-D;else D===M?(C=Math.PI/2,E=x-y):(C=Math.atan((y-x)/(D-M)),E=(y-x)/Math.sin(C));for(U===0&&(U=C+Math.PI/5),E/=2,C=E*Math.cos(U)+M,U=E*Math.sin(U)+x,E=0;E<l+1;E++){var B=M*(1-2*d+d*d)+C*(2*d-2*d*d)+D*d*d,O=n.lng;v.push([0>u.lng&&0<O?B-360:B,x*(1-2*d+d*d)+U*(2*d-2*d*d)+y*d*d]),d+=1/l}return v}}}]),a}(),bp=[{n:"\u5317\u4EAC",g:"116.395645,39.929986|12"},{n:"\u4E0A\u6D77",g:"121.487899,31.249162|12"},{n:"\u5929\u6D25",g:"117.210813,39.14393|12"},{n:"\u91CD\u5E86",g:"106.530635,29.544606|12"}],ka=[{n:"\u5B89\u5FBD",g:"117.216005,31.859252|8",cities:[{n:"\u5408\u80A5",g:"117.282699,31.866942|12"},{n:"\u5B89\u5E86",g:"117.058739,30.537898|13"},{n:"\u868C\u57E0",g:"117.35708,32.929499|13"},{n:"\u4EB3\u5DDE",g:"115.787928,33.871211|13"},{n:"\u5DE2\u6E56",g:"117.88049,31.608733|13"},{n:"\u6C60\u5DDE",g:"117.494477,30.660019|14"},{n:"\u6EC1\u5DDE",g:"118.32457,32.317351|13"},{n:"\u961C\u9633",g:"115.820932,32.901211|13"},{n:"\u6DEE\u5317",g:"116.791447,33.960023|13"},{n:"\u6DEE\u5357",g:"117.018639,32.642812|13"},{n:"\u9EC4\u5C71",g:"118.29357,29.734435|13"},{n:"\u516D\u5B89",g:"116.505253,31.755558|13"},{n:"\u9A6C\u978D\u5C71",g:"118.515882,31.688528|13"},{n:"\u5BBF\u5DDE",g:"116.988692,33.636772|13"},{n:"\u94DC\u9675",g:"117.819429,30.94093|14"},{n:"\u829C\u6E56",g:"118.384108,31.36602|12"},{n:"\u5BA3\u57CE",g:"118.752096,30.951642|13"}]},{n:"\u798F\u5EFA",g:"117.984943,26.050118|8",cities:[{n:"\u798F\u5DDE",g:"119.330221,26.047125|12"},{n:"\u9F99\u5CA9",g:"117.017997,25.078685|13"},{n:"\u5357\u5E73",g:"118.181883,26.643626|13"},{n:"\u5B81\u5FB7",g:"119.542082,26.656527|14"},{n:"\u8386\u7530",g:"119.077731,25.44845|13"},{n:"\u6CC9\u5DDE",g:"118.600362,24.901652|12"},{n:"\u4E09\u660E",g:"117.642194,26.270835|14"},{n:"\u53A6\u95E8",g:"118.103886,24.489231|12"},{n:"\u6F33\u5DDE",g:"117.676205,24.517065|12"}]},{n:"\u7518\u8083",g:"102.457625,38.103267|6",cities:[{n:"\u5170\u5DDE",g:"103.823305,36.064226|12"},{n:"\u767D\u94F6",g:"104.171241,36.546682|13"},{n:"\u5B9A\u897F",g:"104.626638,35.586056|13"},{n:"\u7518\u5357\u5DDE",g:"102.917442,34.992211|14"},{n:"\u5609\u5CEA\u5173",g:"98.281635,39.802397|13"},{n:"\u91D1\u660C",g:"102.208126,38.516072|13"},{n:"\u9152\u6CC9",g:"98.508415,39.741474|13"},{n:"\u4E34\u590F\u5DDE",g:"103.215249,35.598514|13"},{n:"\u9647\u5357",g:"104.934573,33.39448|14"},{n:"\u5E73\u51C9",g:"106.688911,35.55011|13"},{n:"\u5E86\u9633",g:"107.644227,35.726801|13"},{n:"\u5929\u6C34",g:"105.736932,34.584319|13"},{n:"\u6B66\u5A01",g:"102.640147,37.933172|13"},{n:"\u5F20\u6396",g:"100.459892,38.93932|13"}]},{n:"\u5E7F\u4E1C",g:"113.394818,23.408004|8",cities:[{n:"\u5E7F\u5DDE",g:"113.30765,23.120049|12"},{n:"\u6F6E\u5DDE",g:"116.630076,23.661812|13"},{n:"\u4E1C\u839E",g:"113.763434,23.043024|12"},{n:"\u4F5B\u5C71",g:"113.134026,23.035095|13"},{n:"\u6CB3\u6E90",g:"114.713721,23.757251|12"},{n:"\u60E0\u5DDE",g:"114.410658,23.11354|12"},{n:"\u6C5F\u95E8",g:"113.078125,22.575117|13"},{n:"\u63ED\u9633",g:"116.379501,23.547999|13"},{n:"\u8302\u540D",g:"110.931245,21.668226|13"},{n:"\u6885\u5DDE",g:"116.126403,24.304571|13"},{n:"\u6E05\u8FDC",g:"113.040773,23.698469|13"},{n:"\u6C55\u5934",g:"116.72865,23.383908|13"},{n:"\u6C55\u5C3E",g:"115.372924,22.778731|14"},{n:"\u97F6\u5173",g:"113.594461,24.80296|13"},{n:"\u6DF1\u5733",g:"114.025974,22.546054|12"},{n:"\u9633\u6C5F",g:"111.97701,21.871517|14"},{n:"\u4E91\u6D6E",g:"112.050946,22.937976|13"},{n:"\u6E5B\u6C5F",g:"110.365067,21.257463|13"},{n:"\u8087\u5E86",g:"112.479653,23.078663|13"},{n:"\u4E2D\u5C71",g:"113.42206,22.545178|12"},{n:"\u73E0\u6D77",g:"113.562447,22.256915|13"}]},{n:"\u5E7F\u897F",g:"108.924274,23.552255|7",cities:[{n:"\u5357\u5B81",g:"108.297234,22.806493|12"},{n:"\u767E\u8272",g:"106.631821,23.901512|13"},{n:"\u5317\u6D77",g:"109.122628,21.472718|13"},{n:"\u5D07\u5DE6",g:"107.357322,22.415455|14"},{n:"\u9632\u57CE\u6E2F",g:"108.351791,21.617398|15"},{n:"\u6842\u6797",g:"110.26092,25.262901|12"},{n:"\u8D35\u6E2F",g:"109.613708,23.103373|13"},{n:"\u6CB3\u6C60",g:"108.069948,24.699521|14"},{n:"\u8D3A\u5DDE",g:"111.552594,24.411054|14"},{n:"\u6765\u5BBE",g:"109.231817,23.741166|14"},{n:"\u67F3\u5DDE",g:"109.422402,24.329053|12"},{n:"\u94A6\u5DDE",g:"108.638798,21.97335|13"},{n:"\u68A7\u5DDE",g:"111.305472,23.485395|13"},{n:"\u7389\u6797",g:"110.151676,22.643974|14"}]},{n:"\u8D35\u5DDE",g:"106.734996,26.902826|8",cities:[{n:"\u8D35\u9633",g:"106.709177,26.629907|12"},{n:"\u5B89\u987A",g:"105.92827,26.228595|13"},{n:"\u6BD5\u8282\u5730\u533A",g:"105.300492,27.302612|14"},{n:"\u516D\u76D8\u6C34",g:"104.852087,26.591866|13"},{n:"\u94DC\u4EC1\u5730\u533A",g:"109.196161,27.726271|14"},{n:"\u9075\u4E49",g:"106.93126,27.699961|13"},{n:"\u9ED4\u897F\u5357\u5DDE",g:"104.900558,25.095148|11"},{n:"\u9ED4\u4E1C\u5357\u5DDE",g:"107.985353,26.583992|11"},{n:"\u9ED4\u5357\u5DDE",g:"107.523205,26.264536|11"}]},{n:"\u6D77\u5357",g:"109.733755,19.180501|9",cities:[{n:"\u6D77\u53E3",g:"110.330802,20.022071|13"},{n:"\u767D\u6C99",g:"109.358586,19.216056|12"},{n:"\u4FDD\u4EAD",g:"109.656113,18.597592|12"},{n:"\u660C\u6C5F",g:"109.0113,19.222483|12"},{n:"\u510B\u5DDE",g:"109.413973,19.571153|13"},{n:"\u6F84\u8FC8",g:"109.996736,19.693135|13"},{n:"\u4E1C\u65B9",g:"108.85101,18.998161|13"},{n:"\u5B9A\u5B89",g:"110.32009,19.490991|13"},{n:"\u743C\u6D77",g:"110.414359,19.21483|13"},{n:"\u743C\u4E2D",g:"109.861849,19.039771|12"},{n:"\u4E50\u4E1C",g:"109.062698,18.658614|12"},{n:"\u4E34\u9AD8",g:"109.724101,19.805922|13"},{n:"\u9675\u6C34",g:"109.948661,18.575985|12"},{n:"\u4E09\u4E9A",g:"109.522771,18.257776|12"},{n:"\u5C6F\u660C",g:"110.063364,19.347749|13"},{n:"\u4E07\u5B81",g:"110.292505,18.839886|13"},{n:"\u6587\u660C",g:"110.780909,19.750947|13"},{n:"\u4E94\u6307\u5C71",g:"109.51775,18.831306|13"}]},{n:"\u6CB3\u5317",g:"115.661434,38.61384|7",cities:[{n:"\u77F3\u5BB6\u5E84",g:"114.522082,38.048958|12"},{n:"\u4FDD\u5B9A",g:"115.49481,38.886565|13"},{n:"\u6CA7\u5DDE",g:"116.863806,38.297615|13"},{n:"\u627F\u5FB7",g:"117.933822,40.992521|14"},{n:"\u90AF\u90F8",g:"114.482694,36.609308|13"},{n:"\u8861\u6C34",g:"115.686229,37.746929|13"},{n:"\u5ECA\u574A",g:"116.703602,39.518611|13"},{n:"\u79E6\u7687\u5C9B",g:"119.604368,39.945462|12"},{n:"\u5510\u5C71",g:"118.183451,39.650531|13"},{n:"\u90A2\u53F0",g:"114.520487,37.069531|13"},{n:"\u5F20\u5BB6\u53E3",g:"114.893782,40.811188|13"}]},{n:"\u6CB3\u5357",g:"113.486804,34.157184|7",cities:[{n:"\u90D1\u5DDE",g:"113.649644,34.75661|12"},{n:"\u5B89\u9633",g:"114.351807,36.110267|12"},{n:"\u9E64\u58C1",g:"114.29777,35.755426|13"},{n:"\u7126\u4F5C",g:"113.211836,35.234608|13"},{n:"\u5F00\u5C01",g:"114.351642,34.801854|13"},{n:"\u6D1B\u9633",g:"112.447525,34.657368|12"},{n:"\u6F2F\u6CB3",g:"114.046061,33.576279|13"},{n:"\u5357\u9633",g:"112.542842,33.01142|13"},{n:"\u5E73\u9876\u5C71",g:"113.300849,33.745301|13"},{n:"\u6FEE\u9633",g:"115.026627,35.753298|12"},{n:"\u4E09\u95E8\u5CE1",g:"111.181262,34.78332|13"},{n:"\u5546\u4E18",g:"115.641886,34.438589|13"},{n:"\u65B0\u4E61",g:"113.91269,35.307258|13"},{n:"\u4FE1\u9633",g:"114.085491,32.128582|13"},{n:"\u8BB8\u660C",g:"113.835312,34.02674|13"},{n:"\u5468\u53E3",g:"114.654102,33.623741|13"},{n:"\u9A7B\u9A6C\u5E97",g:"114.049154,32.983158|13"}]},{n:"\u9ED1\u9F99\u6C5F",g:"128.047414,47.356592|6",cities:[{n:"\u54C8\u5C14\u6EE8",g:"126.657717,45.773225|12"},{n:"\u5927\u5E86",g:"125.02184,46.596709|12"},{n:"\u5927\u5174\u5B89\u5CAD\u5730\u533A",g:"124.196104,51.991789|10"},{n:"\u9E64\u5C97",g:"130.292472,47.338666|13"},{n:"\u9ED1\u6CB3",g:"127.50083,50.25069|14"},{n:"\u9E21\u897F",g:"130.941767,45.32154|13"},{n:"\u4F73\u6728\u65AF",g:"130.284735,46.81378|12"},{n:"\u7261\u4E39\u6C5F",g:"129.608035,44.588521|13"},{n:"\u4E03\u53F0\u6CB3",g:"131.019048,45.775005|14"},{n:"\u9F50\u9F50\u54C8\u5C14",g:"123.987289,47.3477|13"},{n:"\u53CC\u9E2D\u5C71",g:"131.171402,46.655102|13"},{n:"\u7EE5\u5316",g:"126.989095,46.646064|13"},{n:"\u4F0A\u6625",g:"128.910766,47.734685|14"}]},{n:"\u6E56\u5317",g:"112.410562,31.209316|8",cities:[{n:"\u6B66\u6C49",g:"114.3162,30.581084|12"},{n:"\u9102\u5DDE",g:"114.895594,30.384439|14"},{n:"\u6069\u65BD",g:"109.517433,30.308978|14"},{n:"\u9EC4\u5188",g:"114.906618,30.446109|14"},{n:"\u9EC4\u77F3",g:"115.050683,30.216127|13"},{n:"\u8346\u95E8",g:"112.21733,31.042611|13"},{n:"\u8346\u5DDE",g:"112.241866,30.332591|12"},{n:"\u6F5C\u6C5F",g:"112.768768,30.343116|13"},{n:"\u795E\u519C\u67B6\u6797\u533A",g:"110.487231,31.595768|13"},{n:"\u5341\u5830",g:"110.801229,32.636994|13"},{n:"\u968F\u5DDE",g:"113.379358,31.717858|13"},{n:"\u5929\u95E8",g:"113.12623,30.649047|13"},{n:"\u4ED9\u6843",g:"113.387448,30.293966|13"},{n:"\u54B8\u5B81",g:"114.300061,29.880657|13"},{n:"\u8944\u9633",g:"112.176326,32.094934|12"},{n:"\u5B5D\u611F",g:"113.935734,30.927955|13"},{n:"\u5B9C\u660C",g:"111.310981,30.732758|13"}]},{n:"\u6E56\u5357",g:"111.720664,27.695864|7",cities:[{n:"\u957F\u6C99",g:"112.979353,28.213478|12"},{n:"\u5E38\u5FB7",g:"111.653718,29.012149|12"},{n:"\u90F4\u5DDE",g:"113.037704,25.782264|13"},{n:"\u8861\u9633",g:"112.583819,26.898164|13"},{n:"\u6000\u5316",g:"109.986959,27.557483|13"},{n:"\u5A04\u5E95",g:"111.996396,27.741073|13"},{n:"\u90B5\u9633",g:"111.461525,27.236811|13"},{n:"\u6E58\u6F6D",g:"112.935556,27.835095|13"},{n:"\u6E58\u897F\u5DDE",g:"109.745746,28.317951|14"},{n:"\u76CA\u9633",g:"112.366547,28.588088|13"},{n:"\u6C38\u5DDE",g:"111.614648,26.435972|13"},{n:"\u5CB3\u9633",g:"113.146196,29.378007|13"},{n:"\u5F20\u5BB6\u754C",g:"110.48162,29.124889|13"},{n:"\u682A\u6D32",g:"113.131695,27.827433|13"}]},{n:"\u6C5F\u82CF",g:"119.368489,33.013797|8",cities:[{n:"\u5357\u4EAC",g:"118.778074,32.057236|12"},{n:"\u5E38\u5DDE",g:"119.981861,31.771397|12"},{n:"\u6DEE\u5B89",g:"119.030186,33.606513|12"},{n:"\u8FDE\u4E91\u6E2F",g:"119.173872,34.601549|12"},{n:"\u5357\u901A",g:"120.873801,32.014665|12"},{n:"\u82CF\u5DDE",g:"120.619907,31.317987|12"},{n:"\u5BBF\u8FC1",g:"118.296893,33.95205|13"},{n:"\u6CF0\u5DDE",g:"119.919606,32.476053|13"},{n:"\u65E0\u9521",g:"120.305456,31.570037|12"},{n:"\u5F90\u5DDE",g:"117.188107,34.271553|12"},{n:"\u76D0\u57CE",g:"120.148872,33.379862|12"},{n:"\u626C\u5DDE",g:"119.427778,32.408505|13"},{n:"\u9547\u6C5F",g:"119.455835,32.204409|13"}]},{n:"\u6C5F\u897F",g:"115.676082,27.757258|7",cities:[{n:"\u5357\u660C",g:"115.893528,28.689578|12"},{n:"\u629A\u5DDE",g:"116.360919,27.954545|13"},{n:"\u8D63\u5DDE",g:"114.935909,25.845296|13"},{n:"\u5409\u5B89",g:"114.992039,27.113848|13"},{n:"\u666F\u5FB7\u9547",g:"117.186523,29.303563|12"},{n:"\u4E5D\u6C5F",g:"115.999848,29.71964|13"},{n:"\u840D\u4E61",g:"113.859917,27.639544|13"},{n:"\u4E0A\u9976",g:"117.955464,28.457623|13"},{n:"\u65B0\u4F59",g:"114.947117,27.822322|13"},{n:"\u5B9C\u6625",g:"114.400039,27.81113|13"},{n:"\u9E70\u6F6D",g:"117.03545,28.24131|13"}]},{n:"\u5409\u6797",g:"126.262876,43.678846|7",cities:[{n:"\u957F\u6625",g:"125.313642,43.898338|12"},{n:"\u767D\u57CE",g:"122.840777,45.621086|13"},{n:"\u767D\u5C71",g:"126.435798,41.945859|13"},{n:"\u5409\u6797",g:"126.564544,43.871988|12"},{n:"\u8FBD\u6E90",g:"125.133686,42.923303|13"},{n:"\u56DB\u5E73",g:"124.391382,43.175525|12"},{n:"\u677E\u539F",g:"124.832995,45.136049|13"},{n:"\u901A\u5316",g:"125.94265,41.736397|13"},{n:"\u5EF6\u8FB9",g:"129.485902,42.896414|13"}]},{n:"\u8FBD\u5B81",g:"122.753592,41.6216|8",cities:[{n:"\u6C88\u9633",g:"123.432791,41.808645|12"},{n:"\u978D\u5C71",g:"123.007763,41.118744|13"},{n:"\u672C\u6EAA",g:"123.778062,41.325838|12"},{n:"\u671D\u9633",g:"120.446163,41.571828|13"},{n:"\u5927\u8FDE",g:"121.593478,38.94871|12"},{n:"\u4E39\u4E1C",g:"124.338543,40.129023|12"},{n:"\u629A\u987A",g:"123.92982,41.877304|12"},{n:"\u961C\u65B0",g:"121.660822,42.01925|14"},{n:"\u846B\u82A6\u5C9B",g:"120.860758,40.74303|13"},{n:"\u9526\u5DDE",g:"121.147749,41.130879|13"},{n:"\u8FBD\u9633",g:"123.172451,41.273339|14"},{n:"\u76D8\u9526",g:"122.073228,41.141248|13"},{n:"\u94C1\u5CAD",g:"123.85485,42.299757|13"},{n:"\u8425\u53E3",g:"122.233391,40.668651|13"}]},{n:"\u5185\u8499\u53E4",g:"114.415868,43.468238|5",cities:[{n:"\u547C\u548C\u6D69\u7279",g:"111.660351,40.828319|12"},{n:"\u963F\u62C9\u5584\u76DF",g:"105.695683,38.843075|14"},{n:"\u5305\u5934",g:"109.846239,40.647119|12"},{n:"\u5DF4\u5F66\u6DD6\u5C14",g:"107.423807,40.76918|12"},{n:"\u8D64\u5CF0",g:"118.930761,42.297112|12"},{n:"\u9102\u5C14\u591A\u65AF",g:"109.993706,39.81649|12"},{n:"\u547C\u4F26\u8D1D\u5C14",g:"119.760822,49.201636|12"},{n:"\u901A\u8FBD",g:"122.260363,43.633756|12"},{n:"\u4E4C\u6D77",g:"106.831999,39.683177|13"},{n:"\u4E4C\u5170\u5BDF\u5E03",g:"113.112846,41.022363|12"},{n:"\u9521\u6797\u90ED\u52D2\u76DF",g:"116.02734,43.939705|11"},{n:"\u5174\u5B89\u76DF",g:"122.048167,46.083757|11"}]},{n:"\u5B81\u590F",g:"106.155481,37.321323|8",cities:[{n:"\u94F6\u5DDD",g:"106.206479,38.502621|12"},{n:"\u56FA\u539F",g:"106.285268,36.021523|13"},{n:"\u77F3\u5634\u5C71",g:"106.379337,39.020223|13"},{n:"\u5434\u5FE0",g:"106.208254,37.993561|14"},{n:"\u4E2D\u536B",g:"105.196754,37.521124|14"}]},{n:"\u9752\u6D77",g:"96.202544,35.499761|7",cities:[{n:"\u897F\u5B81",g:"101.767921,36.640739|12"},{n:"\u679C\u6D1B\u5DDE",g:"100.223723,34.480485|11"},{n:"\u6D77\u4E1C\u5730\u533A",g:"102.085207,36.51761|11"},{n:"\u6D77\u5317\u5DDE",g:"100.879802,36.960654|11"},{n:"\u6D77\u5357\u5DDE",g:"100.624066,36.284364|11"},{n:"\u6D77\u897F\u5DDE",g:"97.342625,37.373799|11"},{n:"\u9EC4\u5357\u5DDE",g:"102.0076,35.522852|11"},{n:"\u7389\u6811\u5DDE",g:"97.013316,33.00624|14"}]},{n:"\u5C71\u4E1C",g:"118.527663,36.09929|8",cities:[{n:"\u6D4E\u5357",g:"117.024967,36.682785|12"},{n:"\u6EE8\u5DDE",g:"117.968292,37.405314|12"},{n:"\u4E1C\u8425",g:"118.583926,37.487121|12"},{n:"\u5FB7\u5DDE",g:"116.328161,37.460826|12"},{n:"\u83CF\u6CFD",g:"115.46336,35.26244|13"},{n:"\u6D4E\u5B81",g:"116.600798,35.402122|13"},{n:"\u83B1\u829C",g:"117.684667,36.233654|13"},{n:"\u804A\u57CE",g:"115.986869,36.455829|12"},{n:"\u4E34\u6C82",g:"118.340768,35.072409|12"},{n:"\u9752\u5C9B",g:"120.384428,36.105215|12"},{n:"\u65E5\u7167",g:"119.50718,35.420225|12"},{n:"\u6CF0\u5B89",g:"117.089415,36.188078|13"},{n:"\u5A01\u6D77",g:"122.093958,37.528787|13"},{n:"\u6F4D\u574A",g:"119.142634,36.716115|12"},{n:"\u70DF\u53F0",g:"121.309555,37.536562|12"},{n:"\u67A3\u5E84",g:"117.279305,34.807883|13"},{n:"\u6DC4\u535A",g:"118.059134,36.804685|12"}]},{n:"\u5C71\u897F",g:"112.515496,37.866566|7",cities:[{n:"\u592A\u539F",g:"112.550864,37.890277|12"},{n:"\u957F\u6CBB",g:"113.120292,36.201664|12"},{n:"\u5927\u540C",g:"113.290509,40.113744|12"},{n:"\u664B\u57CE",g:"112.867333,35.499834|13"},{n:"\u664B\u4E2D",g:"112.738514,37.693362|13"},{n:"\u4E34\u6C7E",g:"111.538788,36.099745|13"},{n:"\u5415\u6881",g:"111.143157,37.527316|14"},{n:"\u6714\u5DDE",g:"112.479928,39.337672|13"},{n:"\u5FFB\u5DDE",g:"112.727939,38.461031|12"},{n:"\u9633\u6CC9",g:"113.569238,37.869529|13"},{n:"\u8FD0\u57CE",g:"111.006854,35.038859|13"}]},{n:"\u9655\u897F",g:"109.503789,35.860026|7",cities:[{n:"\u897F\u5B89",g:"108.953098,34.2778|12"},{n:"\u5B89\u5EB7",g:"109.038045,32.70437|13"},{n:"\u5B9D\u9E21",g:"107.170645,34.364081|12"},{n:"\u6C49\u4E2D",g:"107.045478,33.081569|13"},{n:"\u5546\u6D1B",g:"109.934208,33.873907|13"},{n:"\u94DC\u5DDD",g:"108.968067,34.908368|13"},{n:"\u6E2D\u5357",g:"109.483933,34.502358|13"},{n:"\u54B8\u9633",g:"108.707509,34.345373|13"},{n:"\u5EF6\u5B89",g:"109.50051,36.60332|13"},{n:"\u6986\u6797",g:"109.745926,38.279439|12"}]},{n:"\u56DB\u5DDD",g:"102.89916,30.367481|7",cities:[{n:"\u6210\u90FD",g:"104.067923,30.679943|12"},{n:"\u963F\u575D\u5DDE",g:"102.228565,31.905763|15"},{n:"\u5DF4\u4E2D",g:"106.757916,31.869189|14"},{n:"\u8FBE\u5DDE",g:"107.494973,31.214199|14"},{n:"\u5FB7\u9633",g:"104.402398,31.13114|13"},{n:"\u7518\u5B5C\u5DDE",g:"101.969232,30.055144|15"},{n:"\u5E7F\u5B89",g:"106.63572,30.463984|13"},{n:"\u5E7F\u5143",g:"105.819687,32.44104|13"},{n:"\u4E50\u5C71",g:"103.760824,29.600958|13"},{n:"\u51C9\u5C71\u5DDE",g:"102.259591,27.892393|14"},{n:"\u6CF8\u5DDE",g:"105.44397,28.89593|14"},{n:"\u5357\u5145",g:"106.105554,30.800965|13"},{n:"\u7709\u5C71",g:"103.84143,30.061115|13"},{n:"\u7EF5\u9633",g:"104.705519,31.504701|12"},{n:"\u5185\u6C5F",g:"105.073056,29.599462|13"},{n:"\u6500\u679D\u82B1",g:"101.722423,26.587571|14"},{n:"\u9042\u5B81",g:"105.564888,30.557491|12"},{n:"\u96C5\u5B89",g:"103.009356,29.999716|13"},{n:"\u5B9C\u5BBE",g:"104.633019,28.769675|13"},{n:"\u8D44\u9633",g:"104.63593,30.132191|13"},{n:"\u81EA\u8D21",g:"104.776071,29.359157|13"}]},{n:"\u897F\u85CF",g:"89.137982,31.367315|6",cities:[{n:"\u62C9\u8428",g:"91.111891,29.662557|13"},{n:"\u963F\u91CC\u5730\u533A",g:"81.107669,30.404557|11"},{n:"\u660C\u90FD\u5730\u533A",g:"97.185582,31.140576|15"},{n:"\u6797\u829D\u5730\u533A",g:"94.349985,29.666941|11"},{n:"\u90A3\u66F2\u5730\u533A",g:"92.067018,31.48068|14"},{n:"\u65E5\u5580\u5219\u5730\u533A",g:"88.891486,29.269023|14"},{n:"\u5C71\u5357\u5730\u533A",g:"91.750644,29.229027|11"}]},{n:"\u65B0\u7586",g:"85.614899,42.127001|6",cities:[{n:"\u4E4C\u9C81\u6728\u9F50",g:"87.564988,43.84038|12"},{n:"\u963F\u62C9\u5C14",g:"81.291737,40.61568|13"},{n:"\u963F\u514B\u82CF\u5730\u533A",g:"80.269846,41.171731|12"},{n:"\u963F\u52D2\u6CF0\u5730\u533A",g:"88.137915,47.839744|13"},{n:"\u5DF4\u97F3\u90ED\u695E",g:"86.121688,41.771362|12"},{n:"\u535A\u5C14\u5854\u62C9\u5DDE",g:"82.052436,44.913651|11"},{n:"\u660C\u5409\u5DDE",g:"87.296038,44.007058|13"},{n:"\u54C8\u5BC6\u5730\u533A",g:"93.528355,42.858596|13"},{n:"\u548C\u7530\u5730\u533A",g:"79.930239,37.116774|13"},{n:"\u5580\u4EC0\u5730\u533A",g:"75.992973,39.470627|12"},{n:"\u514B\u62C9\u739B\u4F9D",g:"84.88118,45.594331|13"},{n:"\u514B\u5B5C\u52D2\u82CF\u5DDE",g:"76.137564,39.750346|11"},{n:"\u77F3\u6CB3\u5B50",g:"86.041865,44.308259|13"},{n:"\u5854\u57CE\u5730\u533A",g:"82.974881,46.758684|12"},{n:"\u56FE\u6728\u8212\u514B",g:"79.198155,39.889223|13"},{n:"\u5410\u9C81\u756A\u5730\u533A",g:"89.181595,42.96047|13"},{n:"\u4E94\u5BB6\u6E20",g:"87.565449,44.368899|13"},{n:"\u4F0A\u7281\u5DDE",g:"81.297854,43.922248|11"}]},{n:"\u4E91\u5357",g:"101.592952,24.864213|7",cities:[{n:"\u6606\u660E",g:"102.714601,25.049153|12"},{n:"\u4FDD\u5C71",g:"99.177996,25.120489|13"},{n:"\u695A\u96C4\u5DDE",g:"101.529382,25.066356|13"},{n:"\u5927\u7406\u5DDE",g:"100.223675,25.5969|14"},{n:"\u5FB7\u5B8F\u5DDE",g:"98.589434,24.44124|14"},{n:"\u8FEA\u5E86\u5DDE",g:"99.713682,27.831029|14"},{n:"\u7EA2\u6CB3\u5DDE",g:"103.384065,23.367718|11"},{n:"\u4E3D\u6C5F",g:"100.229628,26.875351|13"},{n:"\u4E34\u6CA7",g:"100.092613,23.887806|14"},{n:"\u6012\u6C5F\u5DDE",g:"98.859932,25.860677|14"},{n:"\u666E\u6D31",g:"100.980058,22.788778|14"},{n:"\u66F2\u9756",g:"103.782539,25.520758|12"},{n:"\u662D\u901A",g:"103.725021,27.340633|13"},{n:"\u6587\u5C71",g:"104.089112,23.401781|14"},{n:"\u897F\u53CC\u7248\u7EB3",g:"100.803038,22.009433|13"},{n:"\u7389\u6EAA",g:"102.545068,24.370447|13"}]},{n:"\u6D59\u6C5F",g:"119.957202,29.159494|8",cities:[{n:"\u676D\u5DDE",g:"120.219375,30.259244|12"},{n:"\u6E56\u5DDE",g:"120.137243,30.877925|12"},{n:"\u5609\u5174",g:"120.760428,30.773992|13"},{n:"\u91D1\u534E",g:"119.652576,29.102899|12"},{n:"\u4E3D\u6C34",g:"119.929576,28.4563|13"},{n:"\u5B81\u6CE2",g:"121.579006,29.885259|12"},{n:"\u8862\u5DDE",g:"118.875842,28.95691|12"},{n:"\u7ECD\u5174",g:"120.592467,30.002365|13"},{n:"\u53F0\u5DDE",g:"121.440613,28.668283|13"},{n:"\u6E29\u5DDE",g:"120.690635,28.002838|12"},{n:"\u821F\u5C71",g:"122.169872,30.03601|13"}]}],Vp=[{n:"\u9999\u6E2F",g:"114.186124,22.293586|11"},{n:"\u6FB3\u95E8",g:"113.557519,22.204118|13"},{n:"\u53F0\u6E7E",g:"120.961454,23.80406|8"}],Bh=void 0,Kg=function(){if(Bh!==void 0)return Bh;var a=navigator.userAgent,u="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Bh=!1;for(var n=0;n<u.length;n++)if(0<a.indexOf(u[n])){Bh=!0;break}return Bh}(),Ol=void 0,Qg=function(){if(Ol!==void 0)return Ol;var a=navigator.userAgent,u=["iPhone","iPad","iPod"];Ol=!1;for(var n=0;n<u.length;n++)if(0<a.indexOf(u[n])){Ol=!0;break}return Ol}(),Wp=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Fl=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),rf=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),$g=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Xo=Array(576);nr(Xo);var Ga=Array(60);nr(Ga);var Xs=Array(512);nr(Xs);var Bl=Array(256);nr(Bl);var nf=Array(29);nr(nf);var Du=Array(30);nr(Du);var of=void 0,Tn=void 0,Ou=void 0,Fu=function(a,u){a.pending_buf[a.pending++]=u&255,a.pending_buf[a.pending++]=u>>>8&255},lo=function(a,u,n){a.bi_valid>16-n?(a.bi_buf|=u<<a.bi_valid&65535,Fu(a,a.bi_buf),a.bi_buf=u>>16-a.bi_valid,a.bi_valid+=n-16):(a.bi_buf|=u<<a.bi_valid&65535,a.bi_valid+=n)},ho=function(a,u,n){lo(a,n[2*u],n[2*u+1])},jp=function(a,u){var n=0;do n|=a&1,a>>>=1,n<<=1;while(0<--u);return n>>>1},tm=function(a,u,n){var l=Array(16),v=0,d;for(d=1;15>=d;d++)l[d]=v=v+n[d-1]<<1;for(n=0;n<=u;n++)v=a[2*n+1],v!==0&&(a[2*n]=jp(l[v]++,v))},ba=function(a){var u;for(u=0;286>u;u++)a.dyn_ltree[2*u]=0;for(u=0;30>u;u++)a.dyn_dtree[2*u]=0;for(u=0;19>u;u++)a.bl_tree[2*u]=0;a.dyn_ltree[512]=1,a.opt_len=a.static_len=0,a.last_lit=a.matches=0},Xp=function(a){8<a.bi_valid?Fu(a,a.bi_buf):0<a.bi_valid&&(a.pending_buf[a.pending++]=a.bi_buf),a.bi_buf=0,a.bi_valid=0},Do=function(a,u,n,l){var v=2*u,d=2*n;return a[v]<a[d]||a[v]===a[d]&&l[u]<=l[n]},Yp=function(a,u,n){for(var l=a.heap[n],v=n<<1;v<=a.heap_len&&(v<a.heap_len&&Do(u,a.heap[v+1],a.heap[v],a.depth)&&v++,!Do(u,l,a.heap[v],a.depth));)a.heap[n]=a.heap[v],n=v,v<<=1;a.heap[n]=l},Nl=function(a,u,n){var l=0;if(a.last_lit!==0)do{var v=a.pending_buf[a.d_buf+2*l]<<8|a.pending_buf[a.d_buf+2*l+1],d=a.pending_buf[a.l_buf+l];if(l++,v===0)ho(a,d,u);else{var x=Bl[d];ho(a,x+256+1,u);var y=Wp[x];y!==0&&(d-=nf[x],lo(a,d,y)),v--,x=256>v?Xs[v]:Xs[256+(v>>>7)],ho(a,x,n),y=Fl[x],y!==0&&(v-=Du[x],lo(a,v,y))}}while(l<a.last_lit);ho(a,256,u)},em=function(a,u){var n=u.dyn_tree,l=u.stat_desc.static_tree,v=u.stat_desc.has_stree,d=u.stat_desc.elems,x,y=-1;for(a.heap_len=0,a.heap_max=573,x=0;x<d;x++)n[2*x]!==0?(a.heap[++a.heap_len]=y=x,a.depth[x]=0):n[2*x+1]=0;for(;2>a.heap_len;){var M=a.heap[++a.heap_len]=2>y?++y:0;n[2*M]=1,a.depth[M]=0,a.opt_len--,v&&(a.static_len-=l[2*M+1])}for(u.max_code=y,x=a.heap_len>>1;1<=x;x--)Yp(a,n,x);M=d;do x=a.heap[1],a.heap[1]=a.heap[a.heap_len--],Yp(a,n,1),l=a.heap[1],a.heap[--a.heap_max]=x,a.heap[--a.heap_max]=l,n[2*M]=n[2*x]+n[2*l],a.depth[M]=(a.depth[x]>=a.depth[l]?a.depth[x]:a.depth[l])+1,n[2*x+1]=n[2*l+1]=M,a.heap[1]=M++,Yp(a,n,1);while(2<=a.heap_len);a.heap[--a.heap_max]=a.heap[1],x=u.dyn_tree,M=u.max_code,l=u.stat_desc.static_tree,v=u.stat_desc.has_stree,d=u.stat_desc.extra_bits;var D=u.stat_desc.extra_base,U=u.stat_desc.max_length,C,E=0;for(C=0;15>=C;C++)a.bl_count[C]=0;for(x[2*a.heap[a.heap_max]+1]=0,u=a.heap_max+1;573>u;u++){var B=a.heap[u];if(C=x[2*x[2*B+1]+1]+1,C>U&&(C=U,E++),x[2*B+1]=C,!(B>M)){a.bl_count[C]++;var O=0;B>=D&&(O=d[B-D]);var H=x[2*B];a.opt_len+=H*(C+O),v&&(a.static_len+=H*(l[2*B+1]+O))}}if(E!==0){do{for(C=U-1;a.bl_count[C]===0;)C--;a.bl_count[C]--,a.bl_count[C+1]+=2,a.bl_count[U]--,E-=2}while(0<E);for(C=U;C!==0;C--)for(B=a.bl_count[C];B!==0;)l=a.heap[--u],l>M||(x[2*l+1]!==C&&(a.opt_len+=(C-x[2*l+1])*x[2*l],x[2*l+1]=C),B--)}tm(n,y,a.bl_count)},H0=function(a,u,n){var l,v=-1,d=u[1],x=0,y=7,M=4;for(d===0&&(y=138,M=3),u[2*(n+1)+1]=65535,l=0;l<=n;l++){var D=d;d=u[2*(l+1)+1],++x<y&&D===d||(x<M?a.bl_tree[2*D]+=x:D!==0?(D!==v&&a.bl_tree[2*D]++,a.bl_tree[32]++):10>=x?a.bl_tree[34]++:a.bl_tree[36]++,x=0,v=D,d===0?(y=138,M=3):D===d?(y=6,M=3):(y=7,M=4))}},k0=function(a,u,n){var l,v=-1,d=u[1],x=0,y=7,M=4;for(d===0&&(y=138,M=3),l=0;l<=n;l++){var D=d;if(d=u[2*(l+1)+1],!(++x<y&&D===d)){if(x<M)do ho(a,D,a.bl_tree);while(--x!==0);else D!==0?(D!==v&&(ho(a,D,a.bl_tree),x--),ho(a,16,a.bl_tree),lo(a,x-3,2)):10>=x?(ho(a,17,a.bl_tree),lo(a,x-3,3)):(ho(a,18,a.bl_tree),lo(a,x-11,7));x=0,v=D,d===0?(y=138,M=3):D===d?(y=6,M=3):(y=7,M=4)}}},to=function(a){var u=4093624447,n;for(n=0;31>=n;n++,u>>>=1)if(u&1&&a.dyn_ltree[2*n]!==0)return 0;if(a.dyn_ltree[18]!==0||a.dyn_ltree[20]!==0||a.dyn_ltree[26]!==0)return 1;for(n=32;256>n;n++)if(a.dyn_ltree[2*n]!==0)return 1;return 0},G0=!1,yn=function(a,u,n,l){lo(a,l?1:0,3),Xp(a),Fu(a,n),Fu(a,~n),a.pending_buf.set(a.window.subarray(u,u+n),a.pending),a.pending+=n},xn=function(a,u,n,l){var v=a&65535|0;a=a>>>16&65535|0;for(var d;n!==0;){d=2e3<n?2e3:n,n-=d;do v=v+u[l++]|0,a=a+v|0;while(--d);v%=65521,a%=65521}return v|a<<16|0},rm=new Uint32Array(function(){for(var a,u=[],n=0;256>n;n++){a=n;for(var l=0;8>l;l++)a=a&1?3988292384^a>>>1:a>>>1;u[n]=a}return u}()),eo=function(a,u,n,l){for(n=l+n,a^=-1;l<n;l++)a=a>>>8^rm[(a^u[l])&255];return a^-1},An={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},$r={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Zr=function(a,u,n){return a.pending_buf[a.d_buf+2*a.last_lit]=u>>>8&255,a.pending_buf[a.d_buf+2*a.last_lit+1]=u&255,a.pending_buf[a.l_buf+a.last_lit]=n&255,a.last_lit++,u===0?a.dyn_ltree[2*n]++:(a.matches++,u--,a.dyn_ltree[2*(Bl[n]+256+1)]++,a.dyn_dtree[2*(256>u?Xs[u]:Xs[256+(u>>>7)])]++),a.last_lit===a.lit_bufsize-1},vi=$r.Z_NO_FLUSH,zl=$r.Z_PARTIAL_FLUSH,ro=$r.Z_FULL_FLUSH,Yi=$r.Z_FINISH,co=$r.Z_BLOCK,fo=$r.Z_OK,Yo=$r.Z_STREAM_END,_o=$r.Z_STREAM_ERROR,Zp=$r.Z_DATA_ERROR,Jp=$r.Z_BUF_ERROR,sf=$r.Z_DEFAULT_COMPRESSION,Zx=$r.Z_FILTERED,wo=$r.Z_HUFFMAN_ONLY,Bu=$r.Z_RLE,va=$r.Z_FIXED,Jx=$r.Z_DEFAULT_STRATEGY,Gi=$r.Z_UNKNOWN,jn=$r.Z_DEFLATED,Je=function(a,u){return a.msg=An[u],u},Nu=function(a){for(var u=a.length;0<=--u;)a[u]=0},Zo=function(a,u,n){return(u<<a.hash_shift^n)&a.hash_mask},ya=function(a){var u=a.state,n=u.pending;n>a.avail_out&&(n=a.avail_out),n!==0&&(a.output.set(u.pending_buf.subarray(u.pending_out,u.pending_out+n),a.next_out),a.next_out+=n,u.pending_out+=n,a.total_out+=n,a.avail_out-=n,u.pending-=n,u.pending===0&&(u.pending_out=0))},ln=function(a,u){var n=0<=a.block_start?a.block_start:-1,l=a.strstart-a.block_start,v=0;if(0<a.level){for(a.strm.data_type===2&&(a.strm.data_type=to(a)),em(a,a.l_desc),em(a,a.d_desc),H0(a,a.dyn_ltree,a.l_desc.max_code),H0(a,a.dyn_dtree,a.d_desc.max_code),em(a,a.bl_desc),v=18;3<=v&&a.bl_tree[2*$g[v]+1]===0;v--);a.opt_len+=3*(v+1)+14;var d=a.opt_len+3+7>>>3,x=a.static_len+3+7>>>3;x<=d&&(d=x)}else d=x=l+5;if(l+4<=d&&n!==-1)yn(a,n,l,u);else if(a.strategy===4||x===d)lo(a,2+(u?1:0),3),Nl(a,Xo,Ga);else{for(lo(a,4+(u?1:0),3),n=a.l_desc.max_code+1,l=a.d_desc.max_code+1,v+=1,lo(a,n-257,5),lo(a,l-1,5),lo(a,v-4,4),d=0;d<v;d++)lo(a,a.bl_tree[2*$g[d]+1],3);k0(a,a.dyn_ltree,n-1),k0(a,a.dyn_dtree,l-1),Nl(a,a.dyn_ltree,a.dyn_dtree)}ba(a),u&&Xp(a),a.block_start=a.strstart,ya(a.strm)},ci=function(a,u){a.pending_buf[a.pending++]=u},af=function(a,u){a.pending_buf[a.pending++]=u>>>8&255,a.pending_buf[a.pending++]=u&255},b0=function(a,u){var n=a.max_chain_length,l=a.strstart,v=a.prev_length,d=a.nice_match,x=a.strstart>a.w_size-262?a.strstart-(a.w_size-262):0,y=a.window,M=a.w_mask,D=a.prev,U=a.strstart+258,C=y[l+v-1],E=y[l+v];a.prev_length>=a.good_match&&(n>>=2),d>a.lookahead&&(d=a.lookahead);do{var B=u;if(y[B+v]===E&&y[B+v-1]===C&&y[B]===y[l]&&y[++B]===y[l+1]){for(l+=2,B++;y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&y[++l]===y[++B]&&l<U;);if(B=258-(U-l),l=U-258,B>v){if(a.match_start=u,v=B,B>=d)break;C=y[l+v-1],E=y[l+v]}}}while((u=D[u&M])>x&&--n!==0);return v<=a.lookahead?v:a.lookahead},Va=function(a){var u=a.w_size,n;do{var l=a.window_size-a.lookahead-a.strstart;if(a.strstart>=u+(u-262)){a.window.set(a.window.subarray(u,u+u),0),a.match_start-=u,a.strstart-=u,a.block_start-=u;var v=n=a.hash_size;do{var d=a.head[--v];a.head[v]=d>=u?d-u:0}while(--n);v=n=u;do d=a.prev[--v],a.prev[v]=d>=u?d-u:0;while(--n);l+=u}if(a.strm.avail_in===0)break;v=a.strm,n=a.window,d=a.strstart+a.lookahead;var x=v.avail_in;if(x>l&&(x=l),x===0?n=0:(v.avail_in-=x,n.set(v.input.subarray(v.next_in,v.next_in+x),d),v.state.wrap===1?v.adler=xn(v.adler,n,x,d):v.state.wrap===2&&(v.adler=eo(v.adler,n,x,d)),v.next_in+=x,v.total_in+=x,n=x),a.lookahead+=n,3<=a.lookahead+a.insert)for(l=a.strstart-a.insert,a.ins_h=a.window[l],a.ins_h=Zo(a,a.ins_h,a.window[l+1]);a.insert&&(a.ins_h=Zo(a,a.ins_h,a.window[l+3-1]),a.prev[l&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=l,l++,a.insert--,!(3>a.lookahead+a.insert)););}while(262>a.lookahead&&a.strm.avail_in!==0)},im=function(a,u){for(var n;;){if(262>a.lookahead){if(Va(a),262>a.lookahead&&u===vi)return 1;if(a.lookahead===0)break}if(n=0,3<=a.lookahead&&(a.ins_h=Zo(a,a.ins_h,a.window[a.strstart+3-1]),n=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),n!==0&&a.strstart-n<=a.w_size-262&&(a.match_length=b0(a,n)),3<=a.match_length)if(n=Zr(a,a.strstart-a.match_start,a.match_length-3),a.lookahead-=a.match_length,a.match_length<=a.max_lazy_match&&3<=a.lookahead){a.match_length--;do a.strstart++,a.ins_h=Zo(a,a.ins_h,a.window[a.strstart+3-1]),a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart;while(--a.match_length!==0);a.strstart++}else a.strstart+=a.match_length,a.match_length=0,a.ins_h=a.window[a.strstart],a.ins_h=Zo(a,a.ins_h,a.window[a.strstart+1]);else n=Zr(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++;if(n&&(ln(a,!1),a.strm.avail_out===0))return 1}return a.insert=2>a.strstart?a.strstart:2,u===Yi?(ln(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(ln(a,!1),a.strm.avail_out===0)?1:2},Wa=function(a,u){for(var n,l;;){if(262>a.lookahead){if(Va(a),262>a.lookahead&&u===vi)return 1;if(a.lookahead===0)break}if(n=0,3<=a.lookahead&&(a.ins_h=Zo(a,a.ins_h,a.window[a.strstart+3-1]),n=a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart),a.prev_length=a.match_length,a.prev_match=a.match_start,a.match_length=2,n!==0&&a.prev_length<a.max_lazy_match&&a.strstart-n<=a.w_size-262&&(a.match_length=b0(a,n),5>=a.match_length&&(a.strategy===Zx||a.match_length===3&&4096<a.strstart-a.match_start)&&(a.match_length=2)),3<=a.prev_length&&a.match_length<=a.prev_length){l=a.strstart+a.lookahead-3,n=Zr(a,a.strstart-1-a.prev_match,a.prev_length-3),a.lookahead-=a.prev_length-1,a.prev_length-=2;do++a.strstart<=l&&(a.ins_h=Zo(a,a.ins_h,a.window[a.strstart+3-1]),a.prev[a.strstart&a.w_mask]=a.head[a.ins_h],a.head[a.ins_h]=a.strstart);while(--a.prev_length!==0);if(a.match_available=0,a.match_length=2,a.strstart++,n&&(ln(a,!1),a.strm.avail_out===0))return 1}else if(a.match_available){if((n=Zr(a,0,a.window[a.strstart-1]))&&ln(a,!1),a.strstart++,a.lookahead--,a.strm.avail_out===0)return 1}else a.match_available=1,a.strstart++,a.lookahead--}return a.match_available&&(Zr(a,0,a.window[a.strstart-1]),a.match_available=0),a.insert=2>a.strstart?a.strstart:2,u===Yi?(ln(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(ln(a,!1),a.strm.avail_out===0)?1:2},qx=function(a,u){for(var n,l,v,d=a.window;;){if(258>=a.lookahead){if(Va(a),258>=a.lookahead&&u===vi)return 1;if(a.lookahead===0)break}if(a.match_length=0,3<=a.lookahead&&0<a.strstart&&(l=a.strstart-1,n=d[l],n===d[++l]&&n===d[++l]&&n===d[++l])){for(v=a.strstart+258;n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&n===d[++l]&&l<v;);a.match_length=258-(v-l),a.match_length>a.lookahead&&(a.match_length=a.lookahead)}if(3<=a.match_length?(n=Zr(a,1,a.match_length-3),a.lookahead-=a.match_length,a.strstart+=a.match_length,a.match_length=0):(n=Zr(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++),n&&(ln(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===Yi?(ln(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(ln(a,!1),a.strm.avail_out===0)?1:2},Kx=function(a,u){for(var n;;){if(a.lookahead===0&&(Va(a),a.lookahead===0)){if(u===vi)return 1;break}if(a.match_length=0,n=Zr(a,0,a.window[a.strstart]),a.lookahead--,a.strstart++,n&&(ln(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===Yi?(ln(a,!0),a.strm.avail_out===0?3:4):a.last_lit&&(ln(a,!1),a.strm.avail_out===0)?1:2},ja=[new He(0,0,0,0,function(a,u){var n=65535;for(n>a.pending_buf_size-5&&(n=a.pending_buf_size-5);;){if(1>=a.lookahead){if(Va(a),a.lookahead===0&&u===vi)return 1;if(a.lookahead===0)break}a.strstart+=a.lookahead,a.lookahead=0;var l=a.block_start+n;if((a.strstart===0||a.strstart>=l)&&(a.lookahead=a.strstart-l,a.strstart=l,ln(a,!1),a.strm.avail_out===0)||a.strstart-a.block_start>=a.w_size-262&&(ln(a,!1),a.strm.avail_out===0))return 1}return a.insert=0,u===Yi?(ln(a,!0),a.strm.avail_out===0?3:4):(a.strstart>a.block_start&&ln(a,!1),1)}),new He(4,4,8,4,im),new He(4,5,16,8,im),new He(4,6,32,32,im),new He(4,4,16,16,Wa),new He(8,16,32,32,Wa),new He(8,16,128,128,Wa),new He(8,32,128,256,Wa),new He(32,128,258,1024,Wa),new He(32,258,258,4096,Wa)],V0=function(a){if(!a||!a.state)return Je(a,_o);a.total_in=a.total_out=0,a.data_type=Gi;var u=a.state;if(u.pending=0,u.pending_out=0,0>u.wrap&&(u.wrap=-u.wrap),u.status=u.wrap?42:113,a.adler=u.wrap===2?0:1,u.last_flush=vi,!G0){var n,l,v;for(a=Array(16),v=l=0;28>v;v++)for(nf[v]=l,n=0;n<1<<Wp[v];n++)Bl[l++]=v;for(Bl[l-1]=v,v=l=0;16>v;v++)for(Du[v]=l,n=0;n<1<<Fl[v];n++)Xs[l++]=v;for(l>>=7;30>v;v++)for(Du[v]=l<<7,n=0;n<1<<Fl[v]-7;n++)Xs[256+l++]=v;for(n=0;15>=n;n++)a[n]=0;for(n=0;143>=n;)Xo[2*n+1]=8,n++,a[8]++;for(;255>=n;)Xo[2*n+1]=9,n++,a[9]++;for(;279>=n;)Xo[2*n+1]=7,n++,a[7]++;for(;287>=n;)Xo[2*n+1]=8,n++,a[8]++;for(tm(Xo,287,a),n=0;30>n;n++)Ga[2*n+1]=5,Ga[2*n]=jp(n,5);of=new de(Xo,Wp,257,286,15),Tn=new de(Ga,Fl,0,30,15),Ou=new de([],rf,0,19,7),G0=!0}return u.l_desc=new Rr(u.dyn_ltree,of),u.d_desc=new Rr(u.dyn_dtree,Tn),u.bl_desc=new Rr(u.bl_tree,Ou),u.bi_buf=0,u.bi_valid=0,ba(u),fo},W0=function(a){var u=V0(a);return u===fo&&(a=a.state,a.window_size=2*a.w_size,Nu(a.head),a.max_lazy_match=ja[a.level].max_lazy,a.good_match=ja[a.level].good_length,a.nice_match=ja[a.level].nice_length,a.max_chain_length=ja[a.level].max_chain,a.strstart=0,a.block_start=0,a.lookahead=0,a.insert=0,a.match_length=a.prev_length=2,a.match_available=0,a.ins_h=0),u},uf=function(a,u,n,l,v,d){if(!a)return _o;var x=1;if(u===sf&&(u=6),0>l?(x=0,l=-l):15<l&&(x=2,l-=16),1>v||9<v||n!==jn||8>l||15<l||0>u||9<u||0>d||d>va)return Je(a,_o);l===8&&(l=9);var y=new Di;return a.state=y,y.strm=a,y.wrap=x,y.gzhead=null,y.w_bits=l,y.w_size=1<<y.w_bits,y.w_mask=y.w_size-1,y.hash_bits=v+7,y.hash_size=1<<y.hash_bits,y.hash_mask=y.hash_size-1,y.hash_shift=~~((y.hash_bits+3-1)/3),y.window=new Uint8Array(2*y.w_size),y.head=new Uint16Array(y.hash_size),y.prev=new Uint16Array(y.w_size),y.lit_bufsize=1<<v+6,y.pending_buf_size=4*y.lit_bufsize,y.pending_buf=new Uint8Array(y.pending_buf_size),y.d_buf=1*y.lit_bufsize,y.l_buf=3*y.lit_bufsize,y.level=u,y.strategy=d,y.method=n,W0(a)},Nh={deflateInit:function(a,u){return uf(a,u,jn,15,8,Jx)},deflateInit2:uf,deflateReset:W0,deflateResetKeep:V0,deflateSetHeader:function(a,u){return!a||!a.state||a.state.wrap!==2?_o:(a.state.gzhead=u,fo)},deflate:function(a,u){if(!a||!a.state||u>co||0>u)return a?Je(a,_o):_o;var n=a.state;if(!a.output||!a.input&&a.avail_in!==0||n.status===666&&u!==Yi)return Je(a,a.avail_out===0?Jp:_o);n.strm=a;var l=n.last_flush;if(n.last_flush=u,n.status===42)if(n.wrap===2)a.adler=0,ci(n,31),ci(n,139),ci(n,8),n.gzhead?(ci(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),ci(n,n.gzhead.time&255),ci(n,n.gzhead.time>>8&255),ci(n,n.gzhead.time>>16&255),ci(n,n.gzhead.time>>24&255),ci(n,n.level===9?2:n.strategy>=wo||2>n.level?4:0),ci(n,n.gzhead.os&255),n.gzhead.extra&&n.gzhead.extra.length&&(ci(n,n.gzhead.extra.length&255),ci(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(a.adler=eo(a.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(ci(n,0),ci(n,0),ci(n,0),ci(n,0),ci(n,0),ci(n,n.level===9?2:n.strategy>=wo||2>n.level?4:0),ci(n,3),n.status=113);else{var v=jn+(n.w_bits-8<<4)<<8;v|=(n.strategy>=wo||2>n.level?0:6>n.level?1:n.level===6?2:3)<<6,n.strstart!==0&&(v|=32),n.status=113,af(n,v+(31-v%31)),n.strstart!==0&&(af(n,a.adler>>>16),af(n,a.adler&65535)),a.adler=1}if(n.status===69)if(n.gzhead.extra){for(v=n.pending;n.gzindex<(n.gzhead.extra.length&65535)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),ya(a),v=n.pending,n.pending!==n.pending_buf_size));)ci(n,n.gzhead.extra[n.gzindex]&255),n.gzindex++;n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(n.status===73)if(n.gzhead.name){v=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),ya(a),v=n.pending,n.pending===n.pending_buf_size)){var d=1;break}d=n.gzindex<n.gzhead.name.length?n.gzhead.name.charCodeAt(n.gzindex++)&255:0,ci(n,d)}while(d!==0);n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),d===0&&(n.gzindex=0,n.status=91)}else n.status=91;if(n.status===91)if(n.gzhead.comment){v=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),ya(a),v=n.pending,n.pending===n.pending_buf_size)){d=1;break}d=n.gzindex<n.gzhead.comment.length?n.gzhead.comment.charCodeAt(n.gzindex++)&255:0,ci(n,d)}while(d!==0);n.gzhead.hcrc&&n.pending>v&&(a.adler=eo(a.adler,n.pending_buf,n.pending-v,v)),d===0&&(n.status=103)}else n.status=103;if(n.status===103&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&ya(a),n.pending+2<=n.pending_buf_size&&(ci(n,a.adler&255),ci(n,a.adler>>8&255),a.adler=0,n.status=113)):n.status=113),n.pending!==0){if(ya(a),a.avail_out===0)return n.last_flush=-1,fo}else if(a.avail_in===0&&(u<<1)-(4<u?9:0)<=(l<<1)-(4<l?9:0)&&u!==Yi)return Je(a,Jp);if(n.status===666&&a.avail_in!==0)return Je(a,Jp);if(a.avail_in!==0||n.lookahead!==0||u!==vi&&n.status!==666){if(l=n.strategy===wo?Kx(n,u):n.strategy===Bu?qx(n,u):ja[n.level].func(n,u),(l===3||l===4)&&(n.status=666),l===1||l===3)return a.avail_out===0&&(n.last_flush=-1),fo;if(l===2&&(u===zl?(lo(n,2,3),ho(n,256,Xo),n.bi_valid===16?(Fu(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):8<=n.bi_valid&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)):u!==co&&(yn(n,0,0,!1),u===ro&&(Nu(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),ya(a),a.avail_out===0))return n.last_flush=-1,fo}return u!==Yi?fo:0>=n.wrap?Yo:(n.wrap===2?(ci(n,a.adler&255),ci(n,a.adler>>8&255),ci(n,a.adler>>16&255),ci(n,a.adler>>24&255),ci(n,a.total_in&255),ci(n,a.total_in>>8&255),ci(n,a.total_in>>16&255),ci(n,a.total_in>>24&255)):(af(n,a.adler>>>16),af(n,a.adler&65535)),ya(a),0<n.wrap&&(n.wrap=-n.wrap),n.pending!==0?fo:Yo)},deflateEnd:function(a){if(!a||!a.state)return _o;var u=a.state.status;return u!==42&&u!==69&&u!==73&&u!==91&&u!==103&&u!==113&&u!==666?Je(a,_o):(a.state=null,u===113?Je(a,Zp):fo)},deflateSetDictionary:function(a,u){var n=u.length;if(!a||!a.state)return _o;var l=a.state,v=l.wrap;if(v===2||v===1&&l.status!==42||l.lookahead)return _o;if(v===1&&(a.adler=xn(a.adler,u,n,0)),l.wrap=0,n>=l.w_size){v===0&&(Nu(l.head),l.strstart=0,l.block_start=0,l.insert=0);var d=new Uint8Array(l.w_size);d.set(u.subarray(n-l.w_size,n),0),u=d,n=l.w_size}d=a.avail_in;var x=a.next_in,y=a.input;for(a.avail_in=n,a.next_in=0,a.input=u,Va(l);3<=l.lookahead;){u=l.strstart,n=l.lookahead-2;do l.ins_h=Zo(l,l.ins_h,l.window[u+3-1]),l.prev[u&l.w_mask]=l.head[l.ins_h],l.head[l.ins_h]=u,u++;while(--n);l.strstart=u,l.lookahead=2,Va(l)}return l.strstart+=l.lookahead,l.block_start=l.strstart,l.insert=l.lookahead,l.lookahead=0,l.match_length=l.prev_length=2,l.match_available=0,a.next_in=x,a.input=y,a.avail_in=d,l.wrap=v,fo},deflateInfo:"pako deflate (from Nodeca project)"},zh={assign:function(a){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var n=u.shift();if(n){if((typeof n=="undefined"?"undefined":Qr(n))!=="object")throw new TypeError(n+"must be non-object");for(var l in n)Object.prototype.hasOwnProperty.call(n,l)&&(a[l]=n[l])}}return a},flattenChunks:function(a){for(var u=0,n=0,l=a.length;n<l;n++)u+=a[n].length;u=new Uint8Array(u),l=n=0;for(var v=a.length;n<v;n++){var d=a[n];u.set(d,l),l+=d.length}return u}},j0=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(a){j0=!1}for(var lf=new Uint8Array(256),Xa=0;256>Xa;Xa++)lf[Xa]=252<=Xa?6:248<=Xa?5:240<=Xa?4:224<=Xa?3:192<=Xa?2:1;lf[254]=lf[254]=1;var zu={string2buf:function(a){var u,n,l=a.length,v=0;for(u=0;u<l;u++){var d=a.charCodeAt(u);if((d&64512)===55296&&u+1<l){var x=a.charCodeAt(u+1);(x&64512)===56320&&(d=65536+(d-55296<<10)+(x-56320),u++)}v+=128>d?1:2048>d?2:65536>d?3:4}var y=new Uint8Array(v);for(u=n=0;n<v;u++)d=a.charCodeAt(u),(d&64512)===55296&&u+1<l&&(x=a.charCodeAt(u+1),(x&64512)===56320&&(d=65536+(d-55296<<10)+(x-56320),u++)),128>d?y[n++]=d:(2048>d?y[n++]=192|d>>>6:(65536>d?y[n++]=224|d>>>12:(y[n++]=240|d>>>18,y[n++]=128|d>>>12&63),y[n++]=128|d>>>6&63),y[n++]=128|d&63);return y},buf2string:function(a,u){var n,l,v=u||a.length;for(u=Array(2*v),n=l=0;n<v;){var d=a[n++];if(128>d)u[l++]=d;else{var x=lf[d];if(4<x)u[l++]=65533,n+=x-1;else{for(d&=x===2?31:x===3?15:7;1<x&&n<v;)d=d<<6|a[n++]&63,x--;1<x?u[l++]=65533:65536>d?u[l++]=d:(d-=65536,u[l++]=55296|d>>10&1023,u[l++]=56320|d&1023)}}}if(a=l,65534>a&&u.subarray&&j0)u=String.fromCharCode.apply(null,u.length===a?u:u.subarray(0,a));else{for(n="",l=0;l<a;l++)n+=String.fromCharCode(u[l]);u=n}return u},utf8border:function(a,u){u=u||a.length,u>a.length&&(u=a.length);for(var n=u-1;0<=n&&(a[n]&192)===128;)n--;return 0>n||n===0?u:n+lf[a[n]]>u?n:u}},Ul=function(){this.input=null,this.total_in=this.avail_in=this.next_in=0,this.output=null,this.total_out=this.avail_out=this.next_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},nm=Object.prototype.toString,X0=$r.Z_NO_FLUSH,om=$r.Z_SYNC_FLUSH,Qx=$r.Z_FULL_FLUSH,sm=$r.Z_FINISH,Hl=$r.Z_OK,Uu=$r.Z_STREAM_END,$x=$r.Z_DEFAULT_COMPRESSION,tA=$r.Z_DEFAULT_STRATEGY,Y0=$r.Z_DEFLATED;Cr.prototype.push=function(a,u){var n=this.strm,l=this.options.chunkSize;if(this.ended)return!1;for(u=u===~~u?u:u===!0?sm:X0,typeof a=="string"?n.input=zu.string2buf(a):nm.call(a)==="[object ArrayBuffer]"?n.input=new Uint8Array(a):n.input=a,n.next_in=0,n.avail_in=n.input.length;;)if(n.avail_out===0&&(n.output=new Uint8Array(l),n.next_out=0,n.avail_out=l),(u===om||u===Qx)&&6>=n.avail_out)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else{if(a=Nh.deflate(n,u),a===Uu)return 0<n.next_out&&this.onData(n.output.subarray(0,n.next_out)),a=Nh.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Hl;if(n.avail_out===0)this.onData(n.output);else if(0<u&&0<n.next_out)this.onData(n.output.subarray(0,n.next_out)),n.avail_out=0;else if(n.avail_in===0)break}return!0},Cr.prototype.onData=function(a){this.chunks.push(a)},Cr.prototype.onEnd=function(a){a===Hl&&(this.result=zh.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};var at=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),am=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),qp=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Kp=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Uh=function(a,u,n,l,v,d,x,y){var M=y.bits,D,U,C,E,B,O,H=0,V=new Uint16Array(16),G=new Uint16Array(16),j,Y=0;for(D=0;15>=D;D++)V[D]=0;for(U=0;U<l;U++)V[u[n+U]]++;var $=M;for(C=15;1<=C&&V[C]===0;C--);if($>C&&($=C),C===0)return v[d++]=20971520,v[d++]=20971520,y.bits=1,0;for(M=1;M<C&&V[M]===0;M++);for($<M&&($=M),D=E=1;15>=D;D++)if(E<<=1,E-=V[D],0>E)return-1;if(0<E&&(a===0||C!==1))return-1;for(G[1]=0,D=1;15>D;D++)G[D+1]=G[D]+V[D];for(U=0;U<l;U++)u[n+U]!==0&&(x[G[u[n+U]]++]=U);if(a===0)var it=j=x,nt=19;else a===1?(it=at,H-=257,j=am,Y-=257,nt=256):(it=qp,j=Kp,nt=-1);U=B=0,D=M;var pt=d;l=$,G=0;var Rt=-1,Et=1<<$,Jt=Et-1;if(a===1&&852<Et||a===2&&592<Et)return 1;for(;;){var oe=D-G;if(x[U]<nt)var Se=0,ge=x[U];else x[U]>nt?(Se=j[Y+x[U]],ge=it[H+x[U]]):(Se=96,ge=0);E=1<<D-G,M=O=1<<l;do O-=E,v[pt+(B>>G)+O]=oe<<24|Se<<16|ge|0;while(O!==0);for(E=1<<D-1;B&E;)E>>=1;if(E!==0?(B&=E-1,B+=E):B=0,U++,--V[D]===0){if(D===C)break;D=u[n+x[U]]}if(D>$&&(B&Jt)!==Rt){for(G===0&&(G=$),pt+=M,l=D-G,E=1<<l;l+G<C&&(E-=V[l+G],!(0>=E));)l++,E<<=1;if(Et+=1<<l,a===1&&852<Et||a===2&&592<Et)return 1;Rt=B&Jt,v[Rt]=$<<24|l<<16|pt-d|0}}return B!==0&&(v[pt+B]=D-G<<24|4194304),y.bits=$,0},Z0=$r.Z_FINISH,eA=$r.Z_BLOCK,ut=$r.Z_TREES,kl=$r.Z_OK,rA=$r.Z_STREAM_END,iA=$r.Z_NEED_DICT,Pn=$r.Z_STREAM_ERROR,Nn=$r.Z_DATA_ERROR,J0=$r.Z_MEM_ERROR,q0=$r.Z_BUF_ERROR,Hu=$r.Z_DEFLATED,um=function(a){return(a>>>24&255)+(a>>>8&65280)+((a&65280)<<8)+((a&255)<<24)},K0=function(a){if(!a||!a.state)return Pn;var u=a.state;return a.total_in=a.total_out=u.total=0,a.msg="",u.wrap&&(a.adler=u.wrap&1),u.mode=1,u.last=0,u.havedict=0,u.dmax=32768,u.head=null,u.hold=0,u.bits=0,u.lencode=u.lendyn=new Int32Array(852),u.distcode=u.distdyn=new Int32Array(592),u.sane=1,u.back=-1,kl},lm=function(a){if(!a||!a.state)return Pn;var u=a.state;return u.wsize=0,u.whave=0,u.wnext=0,K0(a)},Q0=function(a,u){if(!a||!a.state)return Pn;var n=a.state;if(0>u){var l=0;u=-u}else l=(u>>4)+1,48>u&&(u&=15);return u&&(8>u||15<u)?Pn:(n.window!==null&&n.wbits!==u&&(n.window=null),n.wrap=l,n.wbits=u,lm(a))},hm=function(a,u){if(!a)return Pn;var n=new As;return a.state=n,n.window=null,u=Q0(a,u),u!==kl&&(a.state=null),u},Qp=!0,hf=void 0,cm=void 0,$p=function(a,u,n,l){var v=a.state;return v.window===null&&(v.wsize=1<<v.wbits,v.wnext=0,v.whave=0,v.window=new Uint8Array(v.wsize)),l>=v.wsize?(v.window.set(u.subarray(n-v.wsize,n),0),v.wnext=0,v.whave=v.wsize):(a=v.wsize-v.wnext,a>l&&(a=l),v.window.set(u.subarray(n-l,n-l+a),v.wnext),(l-=a)?(v.window.set(u.subarray(n-l,n),0),v.wnext=l,v.whave=v.wsize):(v.wnext+=a,v.wnext===v.wsize&&(v.wnext=0),v.whave<v.wsize&&(v.whave+=a))),0},Ya={inflateReset:lm,inflateReset2:Q0,inflateResetKeep:K0,inflateInit:function(a){return hm(a,15)},inflateInit2:hm,inflate:function(a,u){var n=new Uint8Array(4),l=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!a||!a.state||!a.output||!a.input&&a.avail_in!==0)return Pn;var v=a.state;v.mode===12&&(v.mode=13);var d=a.next_out,x=a.output,y=a.avail_out,M=a.next_in,D=a.input,U=a.avail_in,C=v.hold,E=v.bits,B=U,O=y,H=kl;t:for(;;)switch(v.mode){case 1:if(v.wrap===0){v.mode=13;break}for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.wrap&2&&C===35615){v.check=0,n[0]=C&255,n[1]=C>>>8&255,v.check=eo(v.check,n,2,0),E=C=0,v.mode=2;break}if(v.flags=0,v.head&&(v.head.done=!1),!(v.wrap&1)||(((C&255)<<8)+(C>>8))%31){a.msg="incorrect header check",v.mode=30;break}if((C&15)!==Hu){a.msg="unknown compression method",v.mode=30;break}C>>>=4,E-=4;var V=(C&15)+8;if(v.wbits===0)v.wbits=V;else if(V>v.wbits){a.msg="invalid window size",v.mode=30;break}v.dmax=1<<v.wbits,a.adler=v.check=1,v.mode=C&512?10:12,E=C=0;break;case 2:for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.flags=C,(v.flags&255)!==Hu){a.msg="unknown compression method",v.mode=30;break}if(v.flags&57344){a.msg="unknown header flags set",v.mode=30;break}v.head&&(v.head.text=C>>8&1),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=eo(v.check,n,2,0)),E=C=0,v.mode=3;case 3:for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.head&&(v.head.time=C),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,n[2]=C>>>16&255,n[3]=C>>>24&255,v.check=eo(v.check,n,4,0)),E=C=0,v.mode=4;case 4:for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.head&&(v.head.xflags=C&255,v.head.os=C>>8),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=eo(v.check,n,2,0)),E=C=0,v.mode=5;case 5:if(v.flags&1024){for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.length=C,v.head&&(v.head.extra_len=C),v.flags&512&&(n[0]=C&255,n[1]=C>>>8&255,v.check=eo(v.check,n,2,0)),E=C=0}else v.head&&(v.head.extra=null);v.mode=6;case 6:if(v.flags&1024){var G=v.length;if(G>U&&(G=U),G&&(v.head&&(V=v.head.extra_len-v.length,v.head.extra||(v.head.extra=new Uint8Array(v.head.extra_len)),v.head.extra.set(D.subarray(M,M+G),V)),v.flags&512&&(v.check=eo(v.check,D,G,M)),U-=G,M+=G,v.length-=G),v.length)break t}v.length=0,v.mode=7;case 7:if(v.flags&2048){if(U===0)break t;G=0;do V=D[M+G++],v.head&&V&&65536>v.length&&(v.head.name+=String.fromCharCode(V));while(V&&G<U);if(v.flags&512&&(v.check=eo(v.check,D,G,M)),U-=G,M+=G,V)break t}else v.head&&(v.head.name=null);v.length=0,v.mode=8;case 8:if(v.flags&4096){if(U===0)break t;G=0;do V=D[M+G++],v.head&&V&&65536>v.length&&(v.head.comment+=String.fromCharCode(V));while(V&&G<U);if(v.flags&512&&(v.check=eo(v.check,D,G,M)),U-=G,M+=G,V)break t}else v.head&&(v.head.comment=null);v.mode=9;case 9:if(v.flags&512){for(;16>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C!==(v.check&65535)){a.msg="header crc mismatch",v.mode=30;break}E=C=0}v.head&&(v.head.hcrc=v.flags>>9&1,v.head.done=!0),a.adler=v.check=0,v.mode=12;break;case 10:for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}a.adler=v.check=um(C),E=C=0,v.mode=11;case 11:if(v.havedict===0)return a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,iA;a.adler=v.check=1,v.mode=12;case 12:if(u===eA||u===ut)break t;case 13:if(v.last){C>>>=E&7,E-=E&7,v.mode=27;break}for(;3>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}switch(v.last=C&1,C>>>=1,--E,C&3){case 0:v.mode=14;break;case 1:if(G=v,Qp){for(hf=new Int32Array(512),cm=new Int32Array(32),V=0;144>V;)G.lens[V++]=8;for(;256>V;)G.lens[V++]=9;for(;280>V;)G.lens[V++]=7;for(;288>V;)G.lens[V++]=8;for(Uh(1,G.lens,0,288,hf,0,G.work,{bits:9}),V=0;32>V;)G.lens[V++]=5;Uh(2,G.lens,0,32,cm,0,G.work,{bits:5}),Qp=!1}if(G.lencode=hf,G.lenbits=9,G.distcode=cm,G.distbits=5,v.mode=20,u===ut){C>>>=2,E-=2;break t}break;case 2:v.mode=17;break;case 3:a.msg="invalid block type",v.mode=30}C>>>=2,E-=2;break;case 14:for(C>>>=E&7,E-=E&7;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if((C&65535)!==(C>>>16^65535)){a.msg="invalid stored block lengths",v.mode=30;break}if(v.length=C&65535,E=C=0,v.mode=15,u===ut)break t;case 15:v.mode=16;case 16:if(G=v.length){if(G>U&&(G=U),G>y&&(G=y),G===0)break t;x.set(D.subarray(M,M+G),d),U-=G,M+=G,y-=G,d+=G,v.length-=G;break}v.mode=12;break;case 17:for(;14>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(v.nlen=(C&31)+257,C>>>=5,E-=5,v.ndist=(C&31)+1,C>>>=5,E-=5,v.ncode=(C&15)+4,C>>>=4,E-=4,286<v.nlen||30<v.ndist){a.msg="too many length or distance symbols",v.mode=30;break}v.have=0,v.mode=18;case 18:for(;v.have<v.ncode;){for(;3>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.lens[l[v.have++]]=C&7,C>>>=3,E-=3}for(;19>v.have;)v.lens[l[v.have++]]=0;if(v.lencode=v.lendyn,v.lenbits=7,G={bits:v.lenbits},H=Uh(0,v.lens,0,19,v.lencode,0,v.work,G),v.lenbits=G.bits,H){a.msg="invalid code lengths set",v.mode=30;break}v.have=0,v.mode=19;case 19:for(;v.have<v.nlen+v.ndist;){for(;;){var j=v.lencode[C&(1<<v.lenbits)-1];if(G=j>>>24,j&=65535,G<=E)break;if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(16>j)C>>>=G,E-=G,v.lens[v.have++]=j;else{if(j===16){for(V=G+2;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C>>>=G,E-=G,v.have===0){a.msg="invalid bit length repeat",v.mode=30;break}V=v.lens[v.have-1],G=3+(C&3),C>>>=2,E-=2}else if(j===17){for(V=G+3;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=G,E-=G,V=0,G=3+(C&7),C>>>=3,E-=3}else{for(V=G+7;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=G,E-=G,V=0,G=11+(C&127),C>>>=7,E-=7}if(v.have+G>v.nlen+v.ndist){a.msg="invalid bit length repeat",v.mode=30;break}for(;G--;)v.lens[v.have++]=V}}if(v.mode===30)break;if(v.lens[256]===0){a.msg="invalid code -- missing end-of-block",v.mode=30;break}if(v.lenbits=9,G={bits:v.lenbits},H=Uh(1,v.lens,0,v.nlen,v.lencode,0,v.work,G),v.lenbits=G.bits,H){a.msg="invalid literal/lengths set",v.mode=30;break}if(v.distbits=6,v.distcode=v.distdyn,G={bits:v.distbits},H=Uh(2,v.lens,v.nlen,v.ndist,v.distcode,0,v.work,G),v.distbits=G.bits,H){a.msg="invalid distances set",v.mode=30;break}if(v.mode=20,u===ut)break t;case 20:v.mode=21;case 21:if(6<=U&&258<=y){a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,D=a;var Y=D.state;x=D.next_in;var $=D.input;M=x+(D.avail_in-5),d=D.next_out;var it=D.output;U=d-(O-D.avail_out),y=d+(D.avail_out-257),C=Y.dmax,E=Y.wsize,G=Y.whave,V=Y.wnext;var nt=Y.window,pt=Y.hold,Rt=Y.bits;j=Y.lencode;var Et=Y.distcode,Jt=(1<<Y.lenbits)-1,oe=(1<<Y.distbits)-1;e:do{15>Rt&&(pt+=$[x++]<<Rt,Rt+=8,pt+=$[x++]<<Rt,Rt+=8);var Se=j[pt&Jt];r:for(;;){var ge=Se>>>24;if(pt>>>=ge,Rt-=ge,ge=Se>>>16&255,ge===0)it[d++]=Se&65535;else if(ge&16){var Xe=Se&65535;(ge&=15)&&(Rt<ge&&(pt+=$[x++]<<Rt,Rt+=8),Xe+=pt&(1<<ge)-1,pt>>>=ge,Rt-=ge),15>Rt&&(pt+=$[x++]<<Rt,Rt+=8,pt+=$[x++]<<Rt,Rt+=8),Se=Et[pt&oe];i:for(;;){if(ge=Se>>>24,pt>>>=ge,Rt-=ge,ge=Se>>>16&255,ge&16){if(Se&=65535,ge&=15,Rt<ge&&(pt+=$[x++]<<Rt,Rt+=8,Rt<ge&&(pt+=$[x++]<<Rt,Rt+=8)),Se+=pt&(1<<ge)-1,Se>C){D.msg="invalid distance too far back",Y.mode=30;break e}if(pt>>>=ge,Rt-=ge,ge=d-U,Se>ge){if(ge=Se-ge,ge>G&&Y.sane){D.msg="invalid distance too far back",Y.mode=30;break e}var _r=0,he=nt;if(V===0){if(_r+=E-ge,ge<Xe){Xe-=ge;do it[d++]=nt[_r++];while(--ge);_r=d-Se,he=it}}else if(V<ge){if(_r+=E+V-ge,ge-=V,ge<Xe){Xe-=ge;do it[d++]=nt[_r++];while(--ge);if(_r=0,V<Xe){ge=V,Xe-=ge;do it[d++]=nt[_r++];while(--ge);_r=d-Se,he=it}}}else if(_r+=V-ge,ge<Xe){Xe-=ge;do it[d++]=nt[_r++];while(--ge);_r=d-Se,he=it}for(;2<Xe;)it[d++]=he[_r++],it[d++]=he[_r++],it[d++]=he[_r++],Xe-=3;Xe&&(it[d++]=he[_r++],1<Xe&&(it[d++]=he[_r++]))}else{_r=d-Se;do it[d++]=it[_r++],it[d++]=it[_r++],it[d++]=it[_r++],Xe-=3;while(2<Xe);Xe&&(it[d++]=it[_r++],1<Xe&&(it[d++]=it[_r++]))}}else if(ge&64){D.msg="invalid distance code",Y.mode=30;break e}else{Se=Et[(Se&65535)+(pt&(1<<ge)-1)];continue i}break}}else if(ge&64){ge&32?Y.mode=12:(D.msg="invalid literal/length code",Y.mode=30);break e}else{Se=j[(Se&65535)+(pt&(1<<ge)-1)];continue r}break}}while(x<M&&d<y);Xe=Rt>>3,x-=Xe,Rt-=Xe<<3,D.next_in=x,D.next_out=d,D.avail_in=x<M?5+(M-x):5-(x-M),D.avail_out=d<y?257+(y-d):257-(d-y),Y.hold=pt&(1<<Rt)-1,Y.bits=Rt,d=a.next_out,x=a.output,y=a.avail_out,M=a.next_in,D=a.input,U=a.avail_in,C=v.hold,E=v.bits,v.mode===12&&(v.back=-1);break}for(v.back=0;j=v.lencode[C&(1<<v.lenbits)-1],G=j>>>24,V=j>>>16&255,j&=65535,!(G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(V&&!(V&240)){for(nt=G,pt=V,Rt=j;j=v.lencode[Rt+((C&(1<<nt+pt)-1)>>nt)],G=j>>>24,V=j>>>16&255,j&=65535,!(nt+G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=nt,E-=nt,v.back+=nt}if(C>>>=G,E-=G,v.back+=G,v.length=j,V===0){v.mode=26;break}if(V&32){v.back=-1,v.mode=12;break}if(V&64){a.msg="invalid literal/length code",v.mode=30;break}v.extra=V&15,v.mode=22;case 22:if(v.extra){for(V=v.extra;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.length+=C&(1<<v.extra)-1,C>>>=v.extra,E-=v.extra,v.back+=v.extra}v.was=v.length,v.mode=23;case 23:for(;j=v.distcode[C&(1<<v.distbits)-1],G=j>>>24,V=j>>>16&255,j&=65535,!(G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(!(V&240)){for(nt=G,pt=V,Rt=j;j=v.distcode[Rt+((C&(1<<nt+pt)-1)>>nt)],G=j>>>24,V=j>>>16&255,j&=65535,!(nt+G<=E);){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}C>>>=nt,E-=nt,v.back+=nt}if(C>>>=G,E-=G,v.back+=G,V&64){a.msg="invalid distance code",v.mode=30;break}v.offset=j,v.extra=V&15,v.mode=24;case 24:if(v.extra){for(V=v.extra;E<V;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}v.offset+=C&(1<<v.extra)-1,C>>>=v.extra,E-=v.extra,v.back+=v.extra}if(v.offset>v.dmax){a.msg="invalid distance too far back",v.mode=30;break}v.mode=25;case 25:if(y===0)break t;if(G=O-y,v.offset>G){if(G=v.offset-G,G>v.whave&&v.sane){a.msg="invalid distance too far back",v.mode=30;break}G>v.wnext?(G-=v.wnext,V=v.wsize-G):V=v.wnext-G,G>v.length&&(G=v.length),nt=v.window}else nt=x,V=d-v.offset,G=v.length;G>y&&(G=y),y-=G,v.length-=G;do x[d++]=nt[V++];while(--G);v.length===0&&(v.mode=21);break;case 26:if(y===0)break t;x[d++]=v.length,y--,v.mode=21;break;case 27:if(v.wrap){for(;32>E;){if(U===0)break t;U--,C|=D[M++]<<E,E+=8}if(O-=y,a.total_out+=O,v.total+=O,O&&(a.adler=v.check=v.flags?eo(v.check,x,O,d-O):xn(v.check,x,O,d-O)),O=y,(v.flags?C:um(C))!==v.check){a.msg="incorrect data check",v.mode=30;break}E=C=0}v.mode=28;case 28:if(v.wrap&&v.flags){for(;32>E;){if(U===0)break t;U--,C+=D[M++]<<E,E+=8}if(C!==(v.total&4294967295)){a.msg="incorrect length check",v.mode=30;break}E=C=0}v.mode=29;case 29:H=rA;break t;case 30:H=Nn;break t;case 31:return J0;default:return Pn}return a.next_out=d,a.avail_out=y,a.next_in=M,a.avail_in=U,v.hold=C,v.bits=E,(v.wsize||O!==a.avail_out&&30>v.mode&&(27>v.mode||u!==Z0))&&$p(a,a.output,a.next_out,O-a.avail_out),B-=a.avail_in,O-=a.avail_out,a.total_in+=B,a.total_out+=O,v.total+=O,v.wrap&&O&&(a.adler=v.check=v.flags?eo(v.check,x,O,a.next_out-O):xn(v.check,x,O,a.next_out-O)),a.data_type=v.bits+(v.last?64:0)+(v.mode===12?128:0)+(v.mode===20||v.mode===15?256:0),(B===0&&O===0||u===Z0)&&H===kl&&(H=q0),H},inflateEnd:function(a){if(!a||!a.state)return Pn;var u=a.state;return u.window&&(u.window=null),a.state=null,kl},inflateGetHeader:function(a,u){return!a||!a.state||(a=a.state,!(a.wrap&2))?Pn:(a.head=u,u.done=!1,kl)},inflateSetDictionary:function(a,u){var n=u.length;if(!a||!a.state)return Pn;var l=a.state;if(l.wrap!==0&&l.mode!==11)return Pn;if(l.mode===11){var v=xn(1,u,n,0);if(v!==l.check)return Nn}return $p(a,u,n,n)?(l.mode=31,J0):(l.havedict=1,kl)},inflateInfo:"pako inflate (from Nodeca project)"},$0=function(){this.os=this.xflags=this.time=this.text=0,this.extra=null,this.extra_len=0,this.comment=this.name="",this.hcrc=0,this.done=!1},fm=Object.prototype.toString,t1=$r.Z_NO_FLUSH,nA=$r.Z_FINISH,cf=$r.Z_OK,Hh=$r.Z_STREAM_END,pm=$r.Z_NEED_DICT,dm=$r.Z_STREAM_ERROR,td=$r.Z_DATA_ERROR,e1=$r.Z_MEM_ERROR;Vi.prototype.push=function(a,u){var n=this.strm,l=this.options.chunkSize,v=this.options.dictionary;if(this.ended)return!1;var d=u===~~u?u:u===!0?nA:t1;for(fm.call(a)==="[object ArrayBuffer]"?n.input=new Uint8Array(a):n.input=a,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(l),n.next_out=0,n.avail_out=l),u=Ya.inflate(n,d),u===pm&&v&&(u=Ya.inflateSetDictionary(n,v),u===cf?u=Ya.inflate(n,d):u===td&&(u=pm));0<n.avail_in&&u===Hh&&0<n.state.wrap&&a[n.next_in]!==0;)Ya.inflateReset(n),u=Ya.inflate(n,d);switch(u){case dm:case td:case pm:case e1:return this.onEnd(u),this.ended=!0,!1}var x=n.avail_out;if(n.next_out&&(n.avail_out===0||u===Hh))if(this.options.to==="string"){var y=zu.utf8border(n.output,n.next_out),M=n.next_out-y,D=zu.buf2string(n.output,y);n.next_out=M,n.avail_out=l-M,M&&n.output.set(n.output.subarray(y,y+M),0),this.onData(D)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(u!==cf||x!==0){if(u===Hh){u=Ya.inflateEnd(this.strm),this.onEnd(u),this.ended=!0;break}if(n.avail_in===0)break}}return!0},Vi.prototype.onData=function(a){this.chunks.push(a)},Vi.prototype.onEnd=function(a){a===cf&&(this.result=this.options.to==="string"?this.chunks.join(""):zh.flattenChunks(this.chunks)),this.chunks=[],this.err=a,this.msg=this.strm.msg};var gm={Deflate:Cr,deflate:Oi,deflateRaw:function(a,u){return u=u||{},u.raw=!0,Oi(a,u)},gzip:function(a,u){return u=u||{},u.gzip=!0,Oi(a,u)},Inflate:Vi,inflate:Ln,inflateRaw:function(a,u){return u=u||{},u.raw=!0,Ln(a,u)},ungzip:Ln,constants:$r},Ys=It(function(a,u){Object.defineProperty(u,"__esModule",{value:!0}),u.setMatrixArrayType=function(d){u.ARRAY_TYPE=l=d},u.toRadian=function(d){return d*v},u.equals=function(d,x){return Math.abs(d-x)<=n*Math.max(1,Math.abs(d),Math.abs(x))},u.RANDOM=u.ARRAY_TYPE=u.EPSILON=void 0;var n=1e-6;u.EPSILON=n;var l=typeof Float32Array!="undefined"?Float32Array:Array;u.ARRAY_TYPE=l,u.RANDOM=Math.random;var v=Math.PI/180});zt(Ys);var kh=It(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2];x=x[3];var C=y[0],E=y[1],B=y[2];return y=y[3],d[0]=M*C+U*E,d[1]=D*C+x*E,d[2]=M*B+U*y,d[3]=D*B+x*y,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(4);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0),d[0]=1,d[3]=1,d},u.clone=function(d){var x=new v.ARRAY_TYPE(4);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d},u.fromValues=function(d,x,y,M){var D=new v.ARRAY_TYPE(4);return D[0]=d,D[1]=x,D[2]=y,D[3]=M,D},u.set=function(d,x,y,M,D){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d},u.transpose=function(d,x){if(d===x){var y=x[1];d[1]=x[2],d[2]=y}else d[0]=x[0],d[1]=x[2],d[2]=x[1],d[3]=x[3];return d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2];x=x[3];var U=y*x-D*M;return U?(U=1/U,d[0]=x*U,d[1]=-M*U,d[2]=-D*U,d[3]=y*U,d):null},u.adjoint=function(d,x){var y=x[0];return d[0]=x[3],d[1]=-x[1],d[2]=-x[2],d[3]=y,d},u.determinant=function(d){return d[0]*d[3]-d[2]*d[1]},u.multiply=n,u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2];x=x[3];var C=Math.sin(y);return y=Math.cos(y),d[0]=M*y+U*C,d[1]=D*y+x*C,d[2]=M*-C+U*y,d[3]=D*-C+x*y,d},u.scale=function(d,x,y){var M=x[1],D=x[2],U=x[3],C=y[0];return y=y[1],d[0]=x[0]*C,d[1]=M*C,d[2]=D*y,d[3]=U*y,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=-y,d[3]=x,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=x[1],d},u.str=function(d){return"mat2("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2))},u.LDU=function(d,x,y,M){return d[2]=M[2]/M[0],y[0]=M[0],y[1]=M[1],y[3]=M[3]-d[2]*y[1],[d,x,y]},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d},u.subtract=l,u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2];d=d[3];var U=x[0],C=x[1],E=x[2];return x=x[3],Math.abs(y-U)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(U))&&Math.abs(M-C)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(C))&&Math.abs(D-E)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(E))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=gn&&vn?vn(d,y):{};M.get||M.set?gn(x,y,M):x[y]=d[y]}}return x.default=d,x}(Ys);u.mul=n,u.sub=l});zt(kh);var ff=It(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=y[0],O=y[1],H=y[2],V=y[3],G=y[4];return y=y[5],d[0]=M*B+U*O,d[1]=D*B+C*O,d[2]=M*H+U*V,d[3]=D*H+C*V,d[4]=M*G+U*y+E,d[5]=D*G+C*y+x,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d[4]=x[4]-y[4],d[5]=x[5]-y[5],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(6);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[4]=0,d[5]=0),d[0]=1,d[3]=1,d},u.clone=function(d){var x=new v.ARRAY_TYPE(6);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x[4]=d[4],x[5]=d[5],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d[4]=x[4],d[5]=x[5],d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=0,d[5]=0,d},u.fromValues=function(d,x,y,M,D,U){var C=new v.ARRAY_TYPE(6);return C[0]=d,C[1]=x,C[2]=y,C[3]=M,C[4]=D,C[5]=U,C},u.set=function(d,x,y,M,D,U,C){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d[4]=U,d[5]=C,d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4];x=x[5];var E=y*U-M*D;return E?(E=1/E,d[0]=U*E,d[1]=-M*E,d[2]=-D*E,d[3]=y*E,d[4]=(D*x-U*C)*E,d[5]=(M*C-y*x)*E,d):null},u.determinant=function(d){return d[0]*d[3]-d[1]*d[2]},u.multiply=n,u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=Math.sin(y);return y=Math.cos(y),d[0]=M*y+U*B,d[1]=D*y+C*B,d[2]=M*-B+U*y,d[3]=D*-B+C*y,d[4]=E,d[5]=x,d},u.scale=function(d,x,y){var M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=y[0];return y=y[1],d[0]=x[0]*B,d[1]=M*B,d[2]=D*y,d[3]=U*y,d[4]=C,d[5]=E,d},u.translate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4];x=x[5];var B=y[0];return y=y[1],d[0]=M,d[1]=D,d[2]=U,d[3]=C,d[4]=M*B+U*y+E,d[5]=D*B+C*y+x,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=-y,d[3]=x,d[4]=0,d[5]=0,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=x[1],d[4]=0,d[5]=0,d},u.fromTranslation=function(d,x){return d[0]=1,d[1]=0,d[2]=0,d[3]=1,d[4]=x[0],d[5]=x[1],d},u.str=function(d){return"mat2d("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+1)},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d[4]=x[4]+y[4],d[5]=x[5]+y[5],d},u.subtract=l,u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d[4]=x[4]*y,d[5]=x[5]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d[4]=x[4]+y[4]*M,d[5]=x[5]+y[5]*M,d},u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]&&d[4]===x[4]&&d[5]===x[5]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2],U=d[3],C=d[4];d=d[5];var E=x[0],B=x[1],O=x[2],H=x[3],V=x[4];return x=x[5],Math.abs(y-E)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(E))&&Math.abs(M-B)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(B))&&Math.abs(D-O)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(O))&&Math.abs(U-H)<=v.EPSILON*Math.max(1,Math.abs(U),Math.abs(H))&&Math.abs(C-V)<=v.EPSILON*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=gn&&vn?vn(d,y):{};M.get||M.set?gn(x,y,M):x[y]=d[y]}}return x.default=d,x}(Ys);u.mul=n,u.sub=l});zt(ff);var xa=It(function(a,u){function n(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=y[0],G=y[1],j=y[2],Y=y[3],$=y[4],it=y[5],nt=y[6],pt=y[7];return y=y[8],d[0]=V*M+G*C+j*O,d[1]=V*D+G*E+j*H,d[2]=V*U+G*B+j*x,d[3]=Y*M+$*C+it*O,d[4]=Y*D+$*E+it*H,d[5]=Y*U+$*B+it*x,d[6]=nt*M+pt*C+y*O,d[7]=nt*D+pt*E+y*H,d[8]=nt*U+pt*B+y*x,d}function l(d,x,y){return d[0]=x[0]-y[0],d[1]=x[1]-y[1],d[2]=x[2]-y[2],d[3]=x[3]-y[3],d[4]=x[4]-y[4],d[5]=x[5]-y[5],d[6]=x[6]-y[6],d[7]=x[7]-y[7],d[8]=x[8]-y[8],d}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var d=new v.ARRAY_TYPE(9);return v.ARRAY_TYPE!=Float32Array&&(d[1]=0,d[2]=0,d[3]=0,d[5]=0,d[6]=0,d[7]=0),d[0]=1,d[4]=1,d[8]=1,d},u.fromMat4=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[4],d[4]=x[5],d[5]=x[6],d[6]=x[8],d[7]=x[9],d[8]=x[10],d},u.clone=function(d){var x=new v.ARRAY_TYPE(9);return x[0]=d[0],x[1]=d[1],x[2]=d[2],x[3]=d[3],x[4]=d[4],x[5]=d[5],x[6]=d[6],x[7]=d[7],x[8]=d[8],x},u.copy=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=x[2],d[3]=x[3],d[4]=x[4],d[5]=x[5],d[6]=x[6],d[7]=x[7],d[8]=x[8],d},u.fromValues=function(d,x,y,M,D,U,C,E,B){var O=new v.ARRAY_TYPE(9);return O[0]=d,O[1]=x,O[2]=y,O[3]=M,O[4]=D,O[5]=U,O[6]=C,O[7]=E,O[8]=B,O},u.set=function(d,x,y,M,D,U,C,E,B,O){return d[0]=x,d[1]=y,d[2]=M,d[3]=D,d[4]=U,d[5]=C,d[6]=E,d[7]=B,d[8]=O,d},u.identity=function(d){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.transpose=function(d,x){if(d===x){var y=x[1],M=x[2],D=x[5];d[1]=x[3],d[2]=x[6],d[3]=y,d[5]=x[7],d[6]=M,d[7]=D}else d[0]=x[0],d[1]=x[3],d[2]=x[6],d[3]=x[1],d[4]=x[4],d[5]=x[7],d[6]=x[2],d[7]=x[5],d[8]=x[8];return d},u.invert=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7];x=x[8];var H=x*C-E*O,V=-x*U+E*B,G=O*U-C*B,j=y*H+M*V+D*G;return j?(j=1/j,d[0]=H*j,d[1]=(-x*M+D*O)*j,d[2]=(E*M-D*C)*j,d[3]=V*j,d[4]=(x*y-D*B)*j,d[5]=(-E*y+D*U)*j,d[6]=G*j,d[7]=(-O*y+M*B)*j,d[8]=(C*y-M*U)*j,d):null},u.adjoint=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7];return x=x[8],d[0]=C*x-E*O,d[1]=D*O-M*x,d[2]=M*E-D*C,d[3]=E*B-U*x,d[4]=y*x-D*B,d[5]=D*U-y*E,d[6]=U*O-C*B,d[7]=M*B-y*O,d[8]=y*C-M*U,d},u.determinant=function(d){var x=d[3],y=d[4],M=d[5],D=d[6],U=d[7],C=d[8];return d[0]*(C*y-M*U)+d[1]*(-C*x+M*D)+d[2]*(U*x-y*D)},u.multiply=n,u.translate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=y[0];return y=y[1],d[0]=M,d[1]=D,d[2]=U,d[3]=C,d[4]=E,d[5]=B,d[6]=V*M+y*C+O,d[7]=V*D+y*E+H,d[8]=V*U+y*B+x,d},u.rotate=function(d,x,y){var M=x[0],D=x[1],U=x[2],C=x[3],E=x[4],B=x[5],O=x[6],H=x[7];x=x[8];var V=Math.sin(y);return y=Math.cos(y),d[0]=y*M+V*C,d[1]=y*D+V*E,d[2]=y*U+V*B,d[3]=y*C-V*M,d[4]=y*E-V*D,d[5]=y*B-V*U,d[6]=O,d[7]=H,d[8]=x,d},u.scale=function(d,x,y){var M=y[0];return y=y[1],d[0]=M*x[0],d[1]=M*x[1],d[2]=M*x[2],d[3]=y*x[3],d[4]=y*x[4],d[5]=y*x[5],d[6]=x[6],d[7]=x[7],d[8]=x[8],d},u.fromTranslation=function(d,x){return d[0]=1,d[1]=0,d[2]=0,d[3]=0,d[4]=1,d[5]=0,d[6]=x[0],d[7]=x[1],d[8]=1,d},u.fromRotation=function(d,x){var y=Math.sin(x);return x=Math.cos(x),d[0]=x,d[1]=y,d[2]=0,d[3]=-y,d[4]=x,d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.fromScaling=function(d,x){return d[0]=x[0],d[1]=0,d[2]=0,d[3]=0,d[4]=x[1],d[5]=0,d[6]=0,d[7]=0,d[8]=1,d},u.fromMat2d=function(d,x){return d[0]=x[0],d[1]=x[1],d[2]=0,d[3]=x[2],d[4]=x[3],d[5]=0,d[6]=x[4],d[7]=x[5],d[8]=1,d},u.fromQuat=function(d,x){var y=x[0],M=x[1],D=x[2];x=x[3];var U=y+y,C=M+M,E=D+D;y*=U;var B=M*U;M*=C;var O=D*U,H=D*C;return D*=E,U*=x,C*=x,x*=E,d[0]=1-M-D,d[3]=B-x,d[6]=O+C,d[1]=B+x,d[4]=1-y-D,d[7]=H-U,d[2]=O-C,d[5]=H+U,d[8]=1-y-M,d},u.normalFromMat4=function(d,x){var y=x[0],M=x[1],D=x[2],U=x[3],C=x[4],E=x[5],B=x[6],O=x[7],H=x[8],V=x[9],G=x[10],j=x[11],Y=x[12],$=x[13],it=x[14];x=x[15];var nt=y*E-M*C,pt=y*B-D*C,Rt=y*O-U*C,Et=M*B-D*E,Jt=M*O-U*E,oe=D*O-U*B,Se=H*$-V*Y,ge=H*it-G*Y;H=H*x-j*Y;var Xe=V*it-G*$;return V=V*x-j*$,G=G*x-j*it,j=nt*G-pt*V+Rt*Xe+Et*H-Jt*ge+oe*Se,j?(j=1/j,d[0]=(E*G-B*V+O*Xe)*j,d[1]=(B*H-C*G-O*ge)*j,d[2]=(C*V-E*H+O*Se)*j,d[3]=(D*V-M*G-U*Xe)*j,d[4]=(y*G-D*H+U*ge)*j,d[5]=(M*H-y*V-U*Se)*j,d[6]=($*oe-it*Jt+x*Et)*j,d[7]=(it*Rt-Y*oe-x*pt)*j,d[8]=(Y*Jt-$*Rt+x*nt)*j,d):null},u.projection=function(d,x,y){return d[0]=2/x,d[1]=0,d[2]=0,d[3]=0,d[4]=-2/y,d[5]=0,d[6]=-1,d[7]=1,d[8]=1,d},u.str=function(d){return"mat3("+d[0]+", "+d[1]+", "+d[2]+", "+d[3]+", "+d[4]+", "+d[5]+", "+d[6]+", "+d[7]+", "+d[8]+")"},u.frob=function(d){return Math.sqrt(Math.pow(d[0],2)+Math.pow(d[1],2)+Math.pow(d[2],2)+Math.pow(d[3],2)+Math.pow(d[4],2)+Math.pow(d[5],2)+Math.pow(d[6],2)+Math.pow(d[7],2)+Math.pow(d[8],2))},u.add=function(d,x,y){return d[0]=x[0]+y[0],d[1]=x[1]+y[1],d[2]=x[2]+y[2],d[3]=x[3]+y[3],d[4]=x[4]+y[4],d[5]=x[5]+y[5],d[6]=x[6]+y[6],d[7]=x[7]+y[7],d[8]=x[8]+y[8],d},u.subtract=l,u.multiplyScalar=function(d,x,y){return d[0]=x[0]*y,d[1]=x[1]*y,d[2]=x[2]*y,d[3]=x[3]*y,d[4]=x[4]*y,d[5]=x[5]*y,d[6]=x[6]*y,d[7]=x[7]*y,d[8]=x[8]*y,d},u.multiplyScalarAndAdd=function(d,x,y,M){return d[0]=x[0]+y[0]*M,d[1]=x[1]+y[1]*M,d[2]=x[2]+y[2]*M,d[3]=x[3]+y[3]*M,d[4]=x[4]+y[4]*M,d[5]=x[5]+y[5]*M,d[6]=x[6]+y[6]*M,d[7]=x[7]+y[7]*M,d[8]=x[8]+y[8]*M,d},u.exactEquals=function(d,x){return d[0]===x[0]&&d[1]===x[1]&&d[2]===x[2]&&d[3]===x[3]&&d[4]===x[4]&&d[5]===x[5]&&d[6]===x[6]&&d[7]===x[7]&&d[8]===x[8]},u.equals=function(d,x){var y=d[0],M=d[1],D=d[2],U=d[3],C=d[4],E=d[5],B=d[6],O=d[7];d=d[8];var H=x[0],V=x[1],G=x[2],j=x[3],Y=x[4],$=x[5],it=x[6],nt=x[7];return x=x[8],Math.abs(y-H)<=v.EPSILON*Math.max(1,Math.abs(y),Math.abs(H))&&Math.abs(M-V)<=v.EPSILON*Math.max(1,Math.abs(M),Math.abs(V))&&Math.abs(D-G)<=v.EPSILON*Math.max(1,Math.abs(D),Math.abs(G))&&Math.abs(U-j)<=v.EPSILON*Math.max(1,Math.abs(U),Math.abs(j))&&Math.abs(C-Y)<=v.EPSILON*Math.max(1,Math.abs(C),Math.abs(Y))&&Math.abs(E-$)<=v.EPSILON*Math.max(1,Math.abs(E),Math.abs($))&&Math.abs(B-it)<=v.EPSILON*Math.max(1,Math.abs(B),Math.abs(it))&&Math.abs(O-nt)<=v.EPSILON*Math.max(1,Math.abs(O),Math.abs(nt))&&Math.abs(d-x)<=v.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))},u.sub=u.mul=void 0;var v=function(d){if(d&&d.__esModule)return d;var x={};if(d!=null){for(var y in d)if(Object.prototype.hasOwnProperty.call(d,y)){var M=gn&&vn?vn(d,y):{};M.get||M.set?gn(x,y,M):x[y]=d[y]}}return x.default=d,x}(Ys);u.mul=n,u.sub=l});zt(xa);var ed=It(function(a,u){function n(y){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y}function l(y,M,D){var U=M[0],C=M[1],E=M[2],B=M[3],O=M[4],H=M[5],V=M[6],G=M[7],j=M[8],Y=M[9],$=M[10],it=M[11],nt=M[12],pt=M[13],Rt=M[14];M=M[15];var Et=D[0],Jt=D[1],oe=D[2],Se=D[3];return y[0]=Et*U+Jt*O+oe*j+Se*nt,y[1]=Et*C+Jt*H+oe*Y+Se*pt,y[2]=Et*E+Jt*V+oe*$+Se*Rt,y[3]=Et*B+Jt*G+oe*it+Se*M,Et=D[4],Jt=D[5],oe=D[6],Se=D[7],y[4]=Et*U+Jt*O+oe*j+Se*nt,y[5]=Et*C+Jt*H+oe*Y+Se*pt,y[6]=Et*E+Jt*V+oe*$+Se*Rt,y[7]=Et*B+Jt*G+oe*it+Se*M,Et=D[8],Jt=D[9],oe=D[10],Se=D[11],y[8]=Et*U+Jt*O+oe*j+Se*nt,y[9]=Et*C+Jt*H+oe*Y+Se*pt,y[10]=Et*E+Jt*V+oe*$+Se*Rt,y[11]=Et*B+Jt*G+oe*it+Se*M,Et=D[12],Jt=D[13],oe=D[14],Se=D[15],y[12]=Et*U+Jt*O+oe*j+Se*nt,y[13]=Et*C+Jt*H+oe*Y+Se*pt,y[14]=Et*E+Jt*V+oe*$+Se*Rt,y[15]=Et*B+Jt*G+oe*it+Se*M,y}function v(y,M,D){var U=M[0],C=M[1],E=M[2],B=M[3],O=U+U,H=C+C,V=E+E;M=U*O;var G=U*H;U*=V;var j=C*H;return C*=V,E*=V,O*=B,H*=B,B*=V,y[0]=1-(j+E),y[1]=G+B,y[2]=U-H,y[3]=0,y[4]=G-B,y[5]=1-(M+E),y[6]=C+O,y[7]=0,y[8]=U+H,y[9]=C-O,y[10]=1-(M+j),y[11]=0,y[12]=D[0],y[13]=D[1],y[14]=D[2],y[15]=1,y}function d(y,M,D){return y[0]=M[0]-D[0],y[1]=M[1]-D[1],y[2]=M[2]-D[2],y[3]=M[3]-D[3],y[4]=M[4]-D[4],y[5]=M[5]-D[5],y[6]=M[6]-D[6],y[7]=M[7]-D[7],y[8]=M[8]-D[8],y[9]=M[9]-D[9],y[10]=M[10]-D[10],y[11]=M[11]-D[11],y[12]=M[12]-D[12],y[13]=M[13]-D[13],y[14]=M[14]-D[14],y[15]=M[15]-D[15],y}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var y=new x.ARRAY_TYPE(16);return x.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=0,y[12]=0,y[13]=0,y[14]=0),y[0]=1,y[5]=1,y[10]=1,y[15]=1,y},u.clone=function(y){var M=new x.ARRAY_TYPE(16);return M[0]=y[0],M[1]=y[1],M[2]=y[2],M[3]=y[3],M[4]=y[4],M[5]=y[5],M[6]=y[6],M[7]=y[7],M[8]=y[8],M[9]=y[9],M[10]=y[10],M[11]=y[11],M[12]=y[12],M[13]=y[13],M[14]=y[14],M[15]=y[15],M},u.copy=function(y,M){return y[0]=M[0],y[1]=M[1],y[2]=M[2],y[3]=M[3],y[4]=M[4],y[5]=M[5],y[6]=M[6],y[7]=M[7],y[8]=M[8],y[9]=M[9],y[10]=M[10],y[11]=M[11],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15],y},u.fromValues=function(y,M,D,U,C,E,B,O,H,V,G,j,Y,$,it,nt){var pt=new x.ARRAY_TYPE(16);return pt[0]=y,pt[1]=M,pt[2]=D,pt[3]=U,pt[4]=C,pt[5]=E,pt[6]=B,pt[7]=O,pt[8]=H,pt[9]=V,pt[10]=G,pt[11]=j,pt[12]=Y,pt[13]=$,pt[14]=it,pt[15]=nt,pt},u.set=function(y,M,D,U,C,E,B,O,H,V,G,j,Y,$,it,nt,pt){return y[0]=M,y[1]=D,y[2]=U,y[3]=C,y[4]=E,y[5]=B,y[6]=O,y[7]=H,y[8]=V,y[9]=G,y[10]=j,y[11]=Y,y[12]=$,y[13]=it,y[14]=nt,y[15]=pt,y},u.identity=n,u.transpose=function(y,M){if(y===M){var D=M[1],U=M[2],C=M[3],E=M[6],B=M[7],O=M[11];y[1]=M[4],y[2]=M[8],y[3]=M[12],y[4]=D,y[6]=M[9],y[7]=M[13],y[8]=U,y[9]=E,y[11]=M[14],y[12]=C,y[13]=B,y[14]=O}else y[0]=M[0],y[1]=M[4],y[2]=M[8],y[3]=M[12],y[4]=M[1],y[5]=M[5],y[6]=M[9],y[7]=M[13],y[8]=M[2],y[9]=M[6],y[10]=M[10],y[11]=M[14],y[12]=M[3],y[13]=M[7],y[14]=M[11],y[15]=M[15];return y},u.invert=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[3],B=M[4],O=M[5],H=M[6],V=M[7],G=M[8],j=M[9],Y=M[10],$=M[11],it=M[12],nt=M[13],pt=M[14];M=M[15];var Rt=D*O-U*B,Et=D*H-C*B,Jt=D*V-E*B,oe=U*H-C*O,Se=U*V-E*O,ge=C*V-E*H,Xe=G*nt-j*it,_r=G*pt-Y*it,he=G*M-$*it,Ue=j*pt-Y*nt,Sr=j*M-$*nt,Ir=Y*M-$*pt,je=Rt*Ir-Et*Sr+Jt*Ue+oe*he-Se*_r+ge*Xe;return je?(je=1/je,y[0]=(O*Ir-H*Sr+V*Ue)*je,y[1]=(C*Sr-U*Ir-E*Ue)*je,y[2]=(nt*ge-pt*Se+M*oe)*je,y[3]=(Y*Se-j*ge-$*oe)*je,y[4]=(H*he-B*Ir-V*_r)*je,y[5]=(D*Ir-C*he+E*_r)*je,y[6]=(pt*Jt-it*ge-M*Et)*je,y[7]=(G*ge-Y*Jt+$*Et)*je,y[8]=(B*Sr-O*he+V*Xe)*je,y[9]=(U*he-D*Sr-E*Xe)*je,y[10]=(it*Se-nt*Jt+M*Rt)*je,y[11]=(j*Jt-G*Se-$*Rt)*je,y[12]=(O*_r-B*Ue-H*Xe)*je,y[13]=(D*Ue-U*_r+C*Xe)*je,y[14]=(nt*Et-it*oe-pt*Rt)*je,y[15]=(G*oe-j*Et+Y*Rt)*je,y):null},u.adjoint=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[3],B=M[4],O=M[5],H=M[6],V=M[7],G=M[8],j=M[9],Y=M[10],$=M[11],it=M[12],nt=M[13],pt=M[14];return M=M[15],y[0]=O*(Y*M-$*pt)-j*(H*M-V*pt)+nt*(H*$-V*Y),y[1]=-(U*(Y*M-$*pt)-j*(C*M-E*pt)+nt*(C*$-E*Y)),y[2]=U*(H*M-V*pt)-O*(C*M-E*pt)+nt*(C*V-E*H),y[3]=-(U*(H*$-V*Y)-O*(C*$-E*Y)+j*(C*V-E*H)),y[4]=-(B*(Y*M-$*pt)-G*(H*M-V*pt)+it*(H*$-V*Y)),y[5]=D*(Y*M-$*pt)-G*(C*M-E*pt)+it*(C*$-E*Y),y[6]=-(D*(H*M-V*pt)-B*(C*M-E*pt)+it*(C*V-E*H)),y[7]=D*(H*$-V*Y)-B*(C*$-E*Y)+G*(C*V-E*H),y[8]=B*(j*M-$*nt)-G*(O*M-V*nt)+it*(O*$-V*j),y[9]=-(D*(j*M-$*nt)-G*(U*M-E*nt)+it*(U*$-E*j)),y[10]=D*(O*M-V*nt)-B*(U*M-E*nt)+it*(U*V-E*O),y[11]=-(D*(O*$-V*j)-B*(U*$-E*j)+G*(U*V-E*O)),y[12]=-(B*(j*pt-Y*nt)-G*(O*pt-H*nt)+it*(O*Y-H*j)),y[13]=D*(j*pt-Y*nt)-G*(U*pt-C*nt)+it*(U*Y-C*j),y[14]=-(D*(O*pt-H*nt)-B*(U*pt-C*nt)+it*(U*H-C*O)),y[15]=D*(O*Y-H*j)-B*(U*Y-C*j)+G*(U*H-C*O),y},u.determinant=function(y){var M=y[0],D=y[1],U=y[2],C=y[3],E=y[4],B=y[5],O=y[6],H=y[7],V=y[8],G=y[9],j=y[10],Y=y[11],$=y[12],it=y[13],nt=y[14];return y=y[15],(M*B-D*E)*(j*y-Y*nt)-(M*O-U*E)*(G*y-Y*it)+(M*H-C*E)*(G*nt-j*it)+(D*O-U*B)*(V*y-Y*$)-(D*H-C*B)*(V*nt-j*$)+(U*H-C*O)*(V*it-G*$)},u.multiply=l,u.translate=function(y,M,D){var U=D[0],C=D[1];if(D=D[2],M===y)y[12]=M[0]*U+M[4]*C+M[8]*D+M[12],y[13]=M[1]*U+M[5]*C+M[9]*D+M[13],y[14]=M[2]*U+M[6]*C+M[10]*D+M[14],y[15]=M[3]*U+M[7]*C+M[11]*D+M[15];else{var E=M[0],B=M[1],O=M[2],H=M[3],V=M[4],G=M[5],j=M[6],Y=M[7],$=M[8],it=M[9],nt=M[10],pt=M[11];y[0]=E,y[1]=B,y[2]=O,y[3]=H,y[4]=V,y[5]=G,y[6]=j,y[7]=Y,y[8]=$,y[9]=it,y[10]=nt,y[11]=pt,y[12]=E*U+V*C+$*D+M[12],y[13]=B*U+G*C+it*D+M[13],y[14]=O*U+j*C+nt*D+M[14],y[15]=H*U+Y*C+pt*D+M[15]}return y},u.scale=function(y,M,D){var U=D[0],C=D[1];return D=D[2],y[0]=M[0]*U,y[1]=M[1]*U,y[2]=M[2]*U,y[3]=M[3]*U,y[4]=M[4]*C,y[5]=M[5]*C,y[6]=M[6]*C,y[7]=M[7]*C,y[8]=M[8]*D,y[9]=M[9]*D,y[10]=M[10]*D,y[11]=M[11]*D,y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15],y},u.rotate=function(y,M,D,U){var C=U[0],E=U[1];U=U[2];var B=Math.sqrt(C*C+E*E+U*U);if(B<x.EPSILON)return null;B=1/B,C*=B,E*=B,U*=B;var O=Math.sin(D),H=Math.cos(D),V=1-H;D=M[0],B=M[1];var G=M[2],j=M[3],Y=M[4],$=M[5],it=M[6],nt=M[7],pt=M[8],Rt=M[9],Et=M[10],Jt=M[11],oe=C*C*V+H,Se=E*C*V+U*O,ge=U*C*V-E*O,Xe=C*E*V-U*O,_r=E*E*V+H,he=U*E*V+C*O,Ue=C*U*V+E*O;return C=E*U*V-C*O,E=U*U*V+H,y[0]=D*oe+Y*Se+pt*ge,y[1]=B*oe+$*Se+Rt*ge,y[2]=G*oe+it*Se+Et*ge,y[3]=j*oe+nt*Se+Jt*ge,y[4]=D*Xe+Y*_r+pt*he,y[5]=B*Xe+$*_r+Rt*he,y[6]=G*Xe+it*_r+Et*he,y[7]=j*Xe+nt*_r+Jt*he,y[8]=D*Ue+Y*C+pt*E,y[9]=B*Ue+$*C+Rt*E,y[10]=G*Ue+it*C+Et*E,y[11]=j*Ue+nt*C+Jt*E,M!==y&&(y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y},u.rotateX=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[4],E=M[5],B=M[6],O=M[7],H=M[8],V=M[9],G=M[10],j=M[11];return M!==y&&(y[0]=M[0],y[1]=M[1],y[2]=M[2],y[3]=M[3],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[4]=C*D+H*U,y[5]=E*D+V*U,y[6]=B*D+G*U,y[7]=O*D+j*U,y[8]=H*D-C*U,y[9]=V*D-E*U,y[10]=G*D-B*U,y[11]=j*D-O*U,y},u.rotateY=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],E=M[1],B=M[2],O=M[3],H=M[8],V=M[9],G=M[10],j=M[11];return M!==y&&(y[4]=M[4],y[5]=M[5],y[6]=M[6],y[7]=M[7],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[0]=C*D-H*U,y[1]=E*D-V*U,y[2]=B*D-G*U,y[3]=O*D-j*U,y[8]=C*U+H*D,y[9]=E*U+V*D,y[10]=B*U+G*D,y[11]=O*U+j*D,y},u.rotateZ=function(y,M,D){var U=Math.sin(D);D=Math.cos(D);var C=M[0],E=M[1],B=M[2],O=M[3],H=M[4],V=M[5],G=M[6],j=M[7];return M!==y&&(y[8]=M[8],y[9]=M[9],y[10]=M[10],y[11]=M[11],y[12]=M[12],y[13]=M[13],y[14]=M[14],y[15]=M[15]),y[0]=C*D+H*U,y[1]=E*D+V*U,y[2]=B*D+G*U,y[3]=O*D+j*U,y[4]=H*D-C*U,y[5]=V*D-E*U,y[6]=G*D-B*U,y[7]=j*D-O*U,y},u.fromTranslation=function(y,M){return y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=M[0],y[13]=M[1],y[14]=M[2],y[15]=1,y},u.fromScaling=function(y,M){return y[0]=M[0],y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M[1],y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=M[2],y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromRotation=function(y,M,D){var U=D[0],C=D[1];D=D[2];var E=Math.sqrt(U*U+C*C+D*D);if(E<x.EPSILON)return null;E=1/E,U*=E,C*=E,D*=E,E=Math.sin(M),M=Math.cos(M);var B=1-M;return y[0]=U*U*B+M,y[1]=C*U*B+D*E,y[2]=D*U*B-C*E,y[3]=0,y[4]=U*C*B-D*E,y[5]=C*C*B+M,y[6]=D*C*B+U*E,y[7]=0,y[8]=U*D*B+C*E,y[9]=C*D*B-U*E,y[10]=D*D*B+M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromXRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=1,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M,y[6]=D,y[7]=0,y[8]=0,y[9]=-D,y[10]=M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromYRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=M,y[1]=0,y[2]=-D,y[3]=0,y[4]=0,y[5]=1,y[6]=0,y[7]=0,y[8]=D,y[9]=0,y[10]=M,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromZRotation=function(y,M){var D=Math.sin(M);return M=Math.cos(M),y[0]=M,y[1]=D,y[2]=0,y[3]=0,y[4]=-D,y[5]=M,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=1,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.fromRotationTranslation=v,u.fromQuat2=function(y,M){var D=new x.ARRAY_TYPE(3),U=-M[0],C=-M[1],E=-M[2],B=M[3],O=M[4],H=M[5],V=M[6],G=M[7],j=U*U+C*C+E*E+B*B;return 0<j?(D[0]=2*(O*B+G*U+H*E-V*C)/j,D[1]=2*(H*B+G*C+V*U-O*E)/j,D[2]=2*(V*B+G*E+O*C-H*U)/j):(D[0]=2*(O*B+G*U+H*E-V*C),D[1]=2*(H*B+G*C+V*U-O*E),D[2]=2*(V*B+G*E+O*C-H*U)),v(y,M,D),y},u.getTranslation=function(y,M){return y[0]=M[12],y[1]=M[13],y[2]=M[14],y},u.getScaling=function(y,M){var D=M[0],U=M[1],C=M[2],E=M[4],B=M[5],O=M[6],H=M[8],V=M[9];return M=M[10],y[0]=Math.sqrt(D*D+U*U+C*C),y[1]=Math.sqrt(E*E+B*B+O*O),y[2]=Math.sqrt(H*H+V*V+M*M),y},u.getRotation=function(y,M){var D=M[0]+M[5]+M[10];return 0<D?(D=2*Math.sqrt(D+1),y[3]=.25*D,y[0]=(M[6]-M[9])/D,y[1]=(M[8]-M[2])/D,y[2]=(M[1]-M[4])/D):M[0]>M[5]&&M[0]>M[10]?(D=2*Math.sqrt(1+M[0]-M[5]-M[10]),y[3]=(M[6]-M[9])/D,y[0]=.25*D,y[1]=(M[1]+M[4])/D,y[2]=(M[8]+M[2])/D):M[5]>M[10]?(D=2*Math.sqrt(1+M[5]-M[0]-M[10]),y[3]=(M[8]-M[2])/D,y[0]=(M[1]+M[4])/D,y[1]=.25*D,y[2]=(M[6]+M[9])/D):(D=2*Math.sqrt(1+M[10]-M[0]-M[5]),y[3]=(M[1]-M[4])/D,y[0]=(M[8]+M[2])/D,y[1]=(M[6]+M[9])/D,y[2]=.25*D),y},u.fromRotationTranslationScale=function(y,M,D,U){var C=M[0],E=M[1],B=M[2],O=M[3],H=C+C,V=E+E,G=B+B;M=C*H;var j=C*V;C*=G;var Y=E*V;E*=G,B*=G,H*=O,V*=O,O*=G,G=U[0];var $=U[1];return U=U[2],y[0]=(1-(Y+B))*G,y[1]=(j+O)*G,y[2]=(C-V)*G,y[3]=0,y[4]=(j-O)*$,y[5]=(1-(M+B))*$,y[6]=(E+H)*$,y[7]=0,y[8]=(C+V)*U,y[9]=(E-H)*U,y[10]=(1-(M+Y))*U,y[11]=0,y[12]=D[0],y[13]=D[1],y[14]=D[2],y[15]=1,y},u.fromRotationTranslationScaleOrigin=function(y,M,D,U,C){var E=M[0],B=M[1],O=M[2],H=M[3],V=E+E,G=B+B,j=O+O;M=E*V;var Y=E*G,$=E*j;E=B*G,B*=j;var it=O*j;O=H*V,G*=H;var nt=H*j,pt=U[0],Rt=U[1];j=U[2],U=C[0],H=C[1],C=C[2],V=(1-(E+it))*pt;var Et=(Y+nt)*pt;return pt*=$-G,Y=(Y-nt)*Rt,it=(1-(M+it))*Rt,Rt*=B+O,$=($+G)*j,B=(B-O)*j,M=(1-(M+E))*j,y[0]=V,y[1]=Et,y[2]=pt,y[3]=0,y[4]=Y,y[5]=it,y[6]=Rt,y[7]=0,y[8]=$,y[9]=B,y[10]=M,y[11]=0,y[12]=D[0]+U-(V*U+Y*H+$*C),y[13]=D[1]+H-(Et*U+it*H+B*C),y[14]=D[2]+C-(pt*U+Rt*H+M*C),y[15]=1,y},u.fromQuat=function(y,M){var D=M[0],U=M[1],C=M[2];M=M[3];var E=D+D,B=U+U,O=C+C;D*=E;var H=U*E;U*=B;var V=C*E,G=C*B;return C*=O,E*=M,B*=M,M*=O,y[0]=1-U-C,y[1]=H+M,y[2]=V-B,y[3]=0,y[4]=H-M,y[5]=1-D-C,y[6]=G+E,y[7]=0,y[8]=V+B,y[9]=G-E,y[10]=1-D-U,y[11]=0,y[12]=0,y[13]=0,y[14]=0,y[15]=1,y},u.frustum=function(y,M,D,U,C,E,B){var O=1/(D-M),H=1/(C-U),V=1/(E-B);return y[0]=2*E*O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=2*E*H,y[6]=0,y[7]=0,y[8]=(D+M)*O,y[9]=(C+U)*H,y[10]=(B+E)*V,y[11]=-1,y[12]=0,y[13]=0,y[14]=B*E*2*V,y[15]=0,y},u.perspective=function(y,M,D,U,C){return M=1/Math.tan(M/2),y[0]=M/D,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=M,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[11]=-1,y[12]=0,y[13]=0,y[15]=0,C!=null&&C!==1/0?(D=1/(U-C),y[10]=(C+U)*D,y[14]=2*C*U*D):(y[10]=-1,y[14]=-2*U),y},u.perspectiveFromFieldOfView=function(y,M,D,U){var C=Math.tan(M.upDegrees*Math.PI/180),E=Math.tan(M.downDegrees*Math.PI/180),B=Math.tan(M.leftDegrees*Math.PI/180);M=Math.tan(M.rightDegrees*Math.PI/180);var O=2/(B+M),H=2/(C+E);return y[0]=O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=H,y[6]=0,y[7]=0,y[8]=-((B-M)*O*.5),y[9]=(C-E)*H*.5,y[10]=U/(D-U),y[11]=-1,y[12]=0,y[13]=0,y[14]=U*D/(D-U),y[15]=0,y},u.ortho=function(y,M,D,U,C,E,B){var O=1/(M-D),H=1/(U-C),V=1/(E-B);return y[0]=-2*O,y[1]=0,y[2]=0,y[3]=0,y[4]=0,y[5]=-2*H,y[6]=0,y[7]=0,y[8]=0,y[9]=0,y[10]=2*V,y[11]=0,y[12]=(M+D)*O,y[13]=(C+U)*H,y[14]=(B+E)*V,y[15]=1,y},u.lookAt=function(y,M,D,U){var C=M[0],E=M[1];M=M[2];var B=U[0],O=U[1],H=U[2],V=D[0];U=D[1];var G=D[2];if(Math.abs(C-V)<x.EPSILON&&Math.abs(E-U)<x.EPSILON&&Math.abs(M-G)<x.EPSILON)return n(y);D=C-V,U=E-U,V=M-G;var j=1/Math.sqrt(D*D+U*U+V*V);D*=j,U*=j,V*=j,G=O*V-H*U,H=H*D-B*V,B=B*U-O*D,(j=Math.sqrt(G*G+H*H+B*B))?(j=1/j,G*=j,H*=j,B*=j):B=H=G=0,O=U*B-V*H;var Y=V*G-D*B,$=D*H-U*G;return(j=Math.sqrt(O*O+Y*Y+$*$))?(j=1/j,O*=j,Y*=j,$*=j):$=Y=O=0,y[0]=G,y[1]=O,y[2]=D,y[3]=0,y[4]=H,y[5]=Y,y[6]=U,y[7]=0,y[8]=B,y[9]=$,y[10]=V,y[11]=0,y[12]=-(G*C+H*E+B*M),y[13]=-(O*C+Y*E+$*M),y[14]=-(D*C+U*E+V*M),y[15]=1,y},u.targetTo=function(y,M,D,U){var C=M[0],E=M[1];M=M[2];var B=U[0],O=U[1],H=U[2];U=C-D[0];var V=E-D[1];D=M-D[2];var G=U*U+V*V+D*D;0<G&&(G=1/Math.sqrt(G),U*=G,V*=G,D*=G);var j=O*D-H*V;return H=H*U-B*D,B=B*V-O*U,G=j*j+H*H+B*B,0<G&&(G=1/Math.sqrt(G),j*=G,H*=G,B*=G),y[0]=j,y[1]=H,y[2]=B,y[3]=0,y[4]=V*B-D*H,y[5]=D*j-U*B,y[6]=U*H-V*j,y[7]=0,y[8]=U,y[9]=V,y[10]=D,y[11]=0,y[12]=C,y[13]=E,y[14]=M,y[15]=1,y},u.str=function(y){return"mat4("+y[0]+", "+y[1]+", "+y[2]+", "+y[3]+", "+y[4]+", "+y[5]+", "+y[6]+", "+y[7]+", "+y[8]+", "+y[9]+", "+y[10]+", "+y[11]+", "+y[12]+", "+y[13]+", "+y[14]+", "+y[15]+")"},u.frob=function(y){return Math.sqrt(Math.pow(y[0],2)+Math.pow(y[1],2)+Math.pow(y[2],2)+Math.pow(y[3],2)+Math.pow(y[4],2)+Math.pow(y[5],2)+Math.pow(y[6],2)+Math.pow(y[7],2)+Math.pow(y[8],2)+Math.pow(y[9],2)+Math.pow(y[10],2)+Math.pow(y[11],2)+Math.pow(y[12],2)+Math.pow(y[13],2)+Math.pow(y[14],2)+Math.pow(y[15],2))},u.add=function(y,M,D){return y[0]=M[0]+D[0],y[1]=M[1]+D[1],y[2]=M[2]+D[2],y[3]=M[3]+D[3],y[4]=M[4]+D[4],y[5]=M[5]+D[5],y[6]=M[6]+D[6],y[7]=M[7]+D[7],y[8]=M[8]+D[8],y[9]=M[9]+D[9],y[10]=M[10]+D[10],y[11]=M[11]+D[11],y[12]=M[12]+D[12],y[13]=M[13]+D[13],y[14]=M[14]+D[14],y[15]=M[15]+D[15],y},u.subtract=d,u.multiplyScalar=function(y,M,D){return y[0]=M[0]*D,y[1]=M[1]*D,y[2]=M[2]*D,y[3]=M[3]*D,y[4]=M[4]*D,y[5]=M[5]*D,y[6]=M[6]*D,y[7]=M[7]*D,y[8]=M[8]*D,y[9]=M[9]*D,y[10]=M[10]*D,y[11]=M[11]*D,y[12]=M[12]*D,y[13]=M[13]*D,y[14]=M[14]*D,y[15]=M[15]*D,y},u.multiplyScalarAndAdd=function(y,M,D,U){return y[0]=M[0]+D[0]*U,y[1]=M[1]+D[1]*U,y[2]=M[2]+D[2]*U,y[3]=M[3]+D[3]*U,y[4]=M[4]+D[4]*U,y[5]=M[5]+D[5]*U,y[6]=M[6]+D[6]*U,y[7]=M[7]+D[7]*U,y[8]=M[8]+D[8]*U,y[9]=M[9]+D[9]*U,y[10]=M[10]+D[10]*U,y[11]=M[11]+D[11]*U,y[12]=M[12]+D[12]*U,y[13]=M[13]+D[13]*U,y[14]=M[14]+D[14]*U,y[15]=M[15]+D[15]*U,y},u.exactEquals=function(y,M){return y[0]===M[0]&&y[1]===M[1]&&y[2]===M[2]&&y[3]===M[3]&&y[4]===M[4]&&y[5]===M[5]&&y[6]===M[6]&&y[7]===M[7]&&y[8]===M[8]&&y[9]===M[9]&&y[10]===M[10]&&y[11]===M[11]&&y[12]===M[12]&&y[13]===M[13]&&y[14]===M[14]&&y[15]===M[15]},u.equals=function(y,M){var D=y[0],U=y[1],C=y[2],E=y[3],B=y[4],O=y[5],H=y[6],V=y[7],G=y[8],j=y[9],Y=y[10],$=y[11],it=y[12],nt=y[13],pt=y[14];y=y[15];var Rt=M[0],Et=M[1],Jt=M[2],oe=M[3],Se=M[4],ge=M[5],Xe=M[6],_r=M[7],he=M[8],Ue=M[9],Sr=M[10],Ir=M[11],je=M[12],ts=M[13],Ji=M[14];return M=M[15],Math.abs(D-Rt)<=x.EPSILON*Math.max(1,Math.abs(D),Math.abs(Rt))&&Math.abs(U-Et)<=x.EPSILON*Math.max(1,Math.abs(U),Math.abs(Et))&&Math.abs(C-Jt)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(Jt))&&Math.abs(E-oe)<=x.EPSILON*Math.max(1,Math.abs(E),Math.abs(oe))&&Math.abs(B-Se)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs(Se))&&Math.abs(O-ge)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(ge))&&Math.abs(H-Xe)<=x.EPSILON*Math.max(1,Math.abs(H),Math.abs(Xe))&&Math.abs(V-_r)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(_r))&&Math.abs(G-he)<=x.EPSILON*Math.max(1,Math.abs(G),Math.abs(he))&&Math.abs(j-Ue)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(Ue))&&Math.abs(Y-Sr)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Sr))&&Math.abs($-Ir)<=x.EPSILON*Math.max(1,Math.abs($),Math.abs(Ir))&&Math.abs(it-je)<=x.EPSILON*Math.max(1,Math.abs(it),Math.abs(je))&&Math.abs(nt-ts)<=x.EPSILON*Math.max(1,Math.abs(nt),Math.abs(ts))&&Math.abs(pt-Ji)<=x.EPSILON*Math.max(1,Math.abs(pt),Math.abs(Ji))&&Math.abs(y-M)<=x.EPSILON*Math.max(1,Math.abs(y),Math.abs(M))},u.sub=u.mul=void 0;var x=function(y){if(y&&y.__esModule)return y;var M={};if(y!=null){for(var D in y)if(Object.prototype.hasOwnProperty.call(y,D)){var U=gn&&vn?vn(y,D):{};U.get||U.set?gn(M,D,U):M[D]=y[D]}}return M.default=y,M}(Ys);u.mul=l,u.sub=d});zt(ed);var rd=It(function(a,u){function n(){var O=new B.ARRAY_TYPE(3);return B.ARRAY_TYPE!=Float32Array&&(O[0]=0,O[1]=0,O[2]=0),O}function l(O){var H=O[0],V=O[1];return O=O[2],Math.sqrt(H*H+V*V+O*O)}function v(O,H,V){var G=new B.ARRAY_TYPE(3);return G[0]=O,G[1]=H,G[2]=V,G}function d(O,H,V){return O[0]=H[0]-V[0],O[1]=H[1]-V[1],O[2]=H[2]-V[2],O}function x(O,H,V){return O[0]=H[0]*V[0],O[1]=H[1]*V[1],O[2]=H[2]*V[2],O}function y(O,H,V){return O[0]=H[0]/V[0],O[1]=H[1]/V[1],O[2]=H[2]/V[2],O}function M(O,H){var V=H[0]-O[0],G=H[1]-O[1];return O=H[2]-O[2],Math.sqrt(V*V+G*G+O*O)}function D(O,H){var V=H[0]-O[0],G=H[1]-O[1];return O=H[2]-O[2],V*V+G*G+O*O}function U(O){var H=O[0],V=O[1];return O=O[2],H*H+V*V+O*O}function C(O,H){var V=H[0],G=H[1],j=H[2];return V=V*V+G*G+j*j,0<V&&(V=1/Math.sqrt(V)),O[0]=H[0]*V,O[1]=H[1]*V,O[2]=H[2]*V,O}function E(O,H){return O[0]*H[0]+O[1]*H[1]+O[2]*H[2]}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(O){var H=new B.ARRAY_TYPE(3);return H[0]=O[0],H[1]=O[1],H[2]=O[2],H},u.length=l,u.fromValues=v,u.copy=function(O,H){return O[0]=H[0],O[1]=H[1],O[2]=H[2],O},u.set=function(O,H,V,G){return O[0]=H,O[1]=V,O[2]=G,O},u.add=function(O,H,V){return O[0]=H[0]+V[0],O[1]=H[1]+V[1],O[2]=H[2]+V[2],O},u.subtract=d,u.multiply=x,u.divide=y,u.ceil=function(O,H){return O[0]=Math.ceil(H[0]),O[1]=Math.ceil(H[1]),O[2]=Math.ceil(H[2]),O},u.floor=function(O,H){return O[0]=Math.floor(H[0]),O[1]=Math.floor(H[1]),O[2]=Math.floor(H[2]),O},u.min=function(O,H,V){return O[0]=Math.min(H[0],V[0]),O[1]=Math.min(H[1],V[1]),O[2]=Math.min(H[2],V[2]),O},u.max=function(O,H,V){return O[0]=Math.max(H[0],V[0]),O[1]=Math.max(H[1],V[1]),O[2]=Math.max(H[2],V[2]),O},u.round=function(O,H){return O[0]=Math.round(H[0]),O[1]=Math.round(H[1]),O[2]=Math.round(H[2]),O},u.scale=function(O,H,V){return O[0]=H[0]*V,O[1]=H[1]*V,O[2]=H[2]*V,O},u.scaleAndAdd=function(O,H,V,G){return O[0]=H[0]+V[0]*G,O[1]=H[1]+V[1]*G,O[2]=H[2]+V[2]*G,O},u.distance=M,u.squaredDistance=D,u.squaredLength=U,u.negate=function(O,H){return O[0]=-H[0],O[1]=-H[1],O[2]=-H[2],O},u.inverse=function(O,H){return O[0]=1/H[0],O[1]=1/H[1],O[2]=1/H[2],O},u.normalize=C,u.dot=E,u.cross=function(O,H,V){var G=H[0],j=H[1];H=H[2];var Y=V[0],$=V[1];return V=V[2],O[0]=j*V-H*$,O[1]=H*Y-G*V,O[2]=G*$-j*Y,O},u.lerp=function(O,H,V,G){var j=H[0],Y=H[1];return H=H[2],O[0]=j+G*(V[0]-j),O[1]=Y+G*(V[1]-Y),O[2]=H+G*(V[2]-H),O},u.hermite=function(O,H,V,G,j,Y){var $=Y*Y,it=$*(2*Y-3)+1,nt=$*(Y-2)+Y,pt=$*(Y-1);return Y=$*(3-2*Y),O[0]=H[0]*it+V[0]*nt+G[0]*pt+j[0]*Y,O[1]=H[1]*it+V[1]*nt+G[1]*pt+j[1]*Y,O[2]=H[2]*it+V[2]*nt+G[2]*pt+j[2]*Y,O},u.bezier=function(O,H,V,G,j,Y){var $=1-Y,it=$*$,nt=Y*Y,pt=it*$;return it*=3*Y,$*=3*nt,Y*=nt,O[0]=H[0]*pt+V[0]*it+G[0]*$+j[0]*Y,O[1]=H[1]*pt+V[1]*it+G[1]*$+j[1]*Y,O[2]=H[2]*pt+V[2]*it+G[2]*$+j[2]*Y,O},u.random=function(O,H){H=H||1;var V=2*B.RANDOM()*Math.PI,G=2*B.RANDOM()-1,j=Math.sqrt(1-G*G)*H;return O[0]=Math.cos(V)*j,O[1]=Math.sin(V)*j,O[2]=G*H,O},u.transformMat4=function(O,H,V){var G=H[0],j=H[1];H=H[2];var Y=V[3]*G+V[7]*j+V[11]*H+V[15];return Y=Y||1,O[0]=(V[0]*G+V[4]*j+V[8]*H+V[12])/Y,O[1]=(V[1]*G+V[5]*j+V[9]*H+V[13])/Y,O[2]=(V[2]*G+V[6]*j+V[10]*H+V[14])/Y,O},u.transformMat3=function(O,H,V){var G=H[0],j=H[1];return H=H[2],O[0]=G*V[0]+j*V[3]+H*V[6],O[1]=G*V[1]+j*V[4]+H*V[7],O[2]=G*V[2]+j*V[5]+H*V[8],O},u.transformQuat=function(O,H,V){var G=V[0],j=V[1],Y=V[2],$=H[0],it=H[1];H=H[2];var nt=j*H-Y*it,pt=Y*$-G*H,Rt=G*it-j*$;return V=2*V[3],O[0]=$+nt*V+2*(j*Rt-Y*pt),O[1]=it+pt*V+2*(Y*nt-G*Rt),O[2]=H+Rt*V+2*(G*pt-j*nt),O},u.rotateX=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[0],Y[1]=j[1]*Math.cos(G)-j[2]*Math.sin(G),Y[2]=j[1]*Math.sin(G)+j[2]*Math.cos(G),O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.rotateY=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[2]*Math.sin(G)+j[0]*Math.cos(G),Y[1]=j[1],Y[2]=j[2]*Math.cos(G)-j[0]*Math.sin(G),O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.rotateZ=function(O,H,V,G){var j=[],Y=[];return j[0]=H[0]-V[0],j[1]=H[1]-V[1],j[2]=H[2]-V[2],Y[0]=j[0]*Math.cos(G)-j[1]*Math.sin(G),Y[1]=j[0]*Math.sin(G)+j[1]*Math.cos(G),Y[2]=j[2],O[0]=Y[0]+V[0],O[1]=Y[1]+V[1],O[2]=Y[2]+V[2],O},u.angle=function(O,H){return O=v(O[0],O[1],O[2]),H=v(H[0],H[1],H[2]),C(O,O),C(H,H),H=E(O,H),1<H?0:-1>H?Math.PI:Math.acos(H)},u.zero=function(O){return O[0]=0,O[1]=0,O[2]=0,O},u.str=function(O){return"vec3("+O[0]+", "+O[1]+", "+O[2]+")"},u.exactEquals=function(O,H){return O[0]===H[0]&&O[1]===H[1]&&O[2]===H[2]},u.equals=function(O,H){var V=O[0],G=O[1];O=O[2];var j=H[0],Y=H[1];return H=H[2],Math.abs(V-j)<=B.EPSILON*Math.max(1,Math.abs(V),Math.abs(j))&&Math.abs(G-Y)<=B.EPSILON*Math.max(1,Math.abs(G),Math.abs(Y))&&Math.abs(O-H)<=B.EPSILON*Math.max(1,Math.abs(O),Math.abs(H))},u.forEach=u.sqrLen=u.len=u.sqrDist=u.dist=u.div=u.mul=u.sub=void 0;var B=function(O){if(O&&O.__esModule)return O;var H={};if(O!=null){for(var V in O)if(Object.prototype.hasOwnProperty.call(O,V)){var G=gn&&vn?vn(O,V):{};G.get||G.set?gn(H,V,G):H[V]=O[V]}}return H.default=O,H}(Ys);u.sub=d,u.mul=x,u.div=y,u.dist=M,u.sqrDist=D,u.len=l,u.sqrLen=U,a=function(){var O=n();return function(H,V,G,j,Y,$){for(V||(V=3),G||(G=0),j=j?Math.min(j*V+G,H.length):H.length;G<j;G+=V)O[0]=H[G],O[1]=H[G+1],O[2]=H[G+2],Y(O,O,$),H[G]=O[0],H[G+1]=O[1],H[G+2]=O[2];return H}}(),u.forEach=a});zt(rd);var pf=It(function(a,u){function n(){var C=new U.ARRAY_TYPE(4);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[3]=0),C}function l(C,E,B){return C[0]=E[0]-B[0],C[1]=E[1]-B[1],C[2]=E[2]-B[2],C[3]=E[3]-B[3],C}function v(C,E,B){return C[0]=E[0]*B[0],C[1]=E[1]*B[1],C[2]=E[2]*B[2],C[3]=E[3]*B[3],C}function d(C,E,B){return C[0]=E[0]/B[0],C[1]=E[1]/B[1],C[2]=E[2]/B[2],C[3]=E[3]/B[3],C}function x(C,E){var B=E[0]-C[0],O=E[1]-C[1],H=E[2]-C[2];return C=E[3]-C[3],Math.sqrt(B*B+O*O+H*H+C*C)}function y(C,E){var B=E[0]-C[0],O=E[1]-C[1],H=E[2]-C[2];return C=E[3]-C[3],B*B+O*O+H*H+C*C}function M(C){var E=C[0],B=C[1],O=C[2];return C=C[3],Math.sqrt(E*E+B*B+O*O+C*C)}function D(C){var E=C[0],B=C[1],O=C[2];return C=C[3],E*E+B*B+O*O+C*C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(C){var E=new U.ARRAY_TYPE(4);return E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E},u.fromValues=function(C,E,B,O){var H=new U.ARRAY_TYPE(4);return H[0]=C,H[1]=E,H[2]=B,H[3]=O,H},u.copy=function(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C},u.set=function(C,E,B,O,H){return C[0]=E,C[1]=B,C[2]=O,C[3]=H,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C[2]=E[2]+B[2],C[3]=E[3]+B[3],C},u.subtract=l,u.multiply=v,u.divide=d,u.ceil=function(C,E){return C[0]=Math.ceil(E[0]),C[1]=Math.ceil(E[1]),C[2]=Math.ceil(E[2]),C[3]=Math.ceil(E[3]),C},u.floor=function(C,E){return C[0]=Math.floor(E[0]),C[1]=Math.floor(E[1]),C[2]=Math.floor(E[2]),C[3]=Math.floor(E[3]),C},u.min=function(C,E,B){return C[0]=Math.min(E[0],B[0]),C[1]=Math.min(E[1],B[1]),C[2]=Math.min(E[2],B[2]),C[3]=Math.min(E[3],B[3]),C},u.max=function(C,E,B){return C[0]=Math.max(E[0],B[0]),C[1]=Math.max(E[1],B[1]),C[2]=Math.max(E[2],B[2]),C[3]=Math.max(E[3],B[3]),C},u.round=function(C,E){return C[0]=Math.round(E[0]),C[1]=Math.round(E[1]),C[2]=Math.round(E[2]),C[3]=Math.round(E[3]),C},u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C[2]=E[2]*B,C[3]=E[3]*B,C},u.scaleAndAdd=function(C,E,B,O){return C[0]=E[0]+B[0]*O,C[1]=E[1]+B[1]*O,C[2]=E[2]+B[2]*O,C[3]=E[3]+B[3]*O,C},u.distance=x,u.squaredDistance=y,u.length=M,u.squaredLength=D,u.negate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C[2]=-E[2],C[3]=-E[3],C},u.inverse=function(C,E){return C[0]=1/E[0],C[1]=1/E[1],C[2]=1/E[2],C[3]=1/E[3],C},u.normalize=function(C,E){var B=E[0],O=E[1],H=E[2];E=E[3];var V=B*B+O*O+H*H+E*E;return 0<V&&(V=1/Math.sqrt(V)),C[0]=B*V,C[1]=O*V,C[2]=H*V,C[3]=E*V,C},u.dot=function(C,E){return C[0]*E[0]+C[1]*E[1]+C[2]*E[2]+C[3]*E[3]},u.cross=function(C,E,B,O){var H=B[0]*O[1]-B[1]*O[0],V=B[0]*O[2]-B[2]*O[0],G=B[0]*O[3]-B[3]*O[0],j=B[1]*O[2]-B[2]*O[1],Y=B[1]*O[3]-B[3]*O[1];B=B[2]*O[3]-B[3]*O[2],O=E[0];var $=E[1],it=E[2];return E=E[3],C[0]=$*B-it*Y+E*j,C[1]=-(O*B)+it*G-E*V,C[2]=O*Y-$*G+E*H,C[3]=-(O*j)+$*V-it*H,C},u.lerp=function(C,E,B,O){var H=E[0],V=E[1],G=E[2];return E=E[3],C[0]=H+O*(B[0]-H),C[1]=V+O*(B[1]-V),C[2]=G+O*(B[2]-G),C[3]=E+O*(B[3]-E),C},u.random=function(C,E){E=E||1;do var B=2*U.RANDOM()-1,O=2*U.RANDOM()-1,H=B*B+O*O;while(1<=H);do var V=2*U.RANDOM()-1,G=2*U.RANDOM()-1,j=V*V+G*G;while(1<=j);return H=Math.sqrt((1-H)/j),C[0]=E*B,C[1]=E*O,C[2]=E*V*H,C[3]=E*G*H,C},u.transformMat4=function(C,E,B){var O=E[0],H=E[1],V=E[2];return E=E[3],C[0]=B[0]*O+B[4]*H+B[8]*V+B[12]*E,C[1]=B[1]*O+B[5]*H+B[9]*V+B[13]*E,C[2]=B[2]*O+B[6]*H+B[10]*V+B[14]*E,C[3]=B[3]*O+B[7]*H+B[11]*V+B[15]*E,C},u.transformQuat=function(C,E,B){var O=E[0],H=E[1],V=E[2],G=B[0],j=B[1],Y=B[2];B=B[3];var $=B*O+j*V-Y*H,it=B*H+Y*O-G*V,nt=B*V+G*H-j*O;return O=-G*O-j*H-Y*V,C[0]=$*B+O*-G+it*-Y-nt*-j,C[1]=it*B+O*-j+nt*-G-$*-Y,C[2]=nt*B+O*-Y+$*-j-it*-G,C[3]=E[3],C},u.zero=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=0,C},u.str=function(C){return"vec4("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]&&C[3]===E[3]},u.equals=function(C,E){var B=C[0],O=C[1],H=C[2];C=C[3];var V=E[0],G=E[1],j=E[2];return E=E[3],Math.abs(B-V)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(V))&&Math.abs(O-G)<=U.EPSILON*Math.max(1,Math.abs(O),Math.abs(G))&&Math.abs(H-j)<=U.EPSILON*Math.max(1,Math.abs(H),Math.abs(j))&&Math.abs(C-E)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.forEach=u.sqrLen=u.len=u.sqrDist=u.dist=u.div=u.mul=u.sub=void 0;var U=function(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=gn&&vn?vn(C,B):{};O.get||O.set?gn(E,B,O):E[B]=C[B]}}return E.default=C,E}(Ys);u.sub=l,u.mul=v,u.div=d,u.dist=x,u.sqrDist=y,u.len=M,u.sqrLen=D,a=function(){var C=n();return function(E,B,O,H,V,G){for(B||(B=4),O||(O=0),H=H?Math.min(H*B+O,E.length):E.length;O<H;O+=B)C[0]=E[O],C[1]=E[O+1],C[2]=E[O+2],C[3]=E[O+3],V(C,C,G),E[O]=C[0],E[O+1]=C[1],E[O+2]=C[2],E[O+3]=C[3];return E}}(),u.forEach=a});zt(pf);var df=It(function(a,u){function n(B){if(B&&B.__esModule)return B;var O={};if(B!=null){for(var H in B)if(Object.prototype.hasOwnProperty.call(B,H)){var V=gn&&vn?vn(B,H):{};V.get||V.set?gn(O,H,V):O[H]=B[H]}}return O.default=B,O}function l(){var B=new M.ARRAY_TYPE(4);return M.ARRAY_TYPE!=Float32Array&&(B[0]=0,B[1]=0,B[2]=0),B[3]=1,B}function v(B,O,H){H*=.5;var V=Math.sin(H);return B[0]=V*O[0],B[1]=V*O[1],B[2]=V*O[2],B[3]=Math.cos(H),B}function d(B,O,H){var V=O[0],G=O[1],j=O[2];O=O[3];var Y=H[0],$=H[1],it=H[2];return H=H[3],B[0]=V*H+O*Y+G*it-j*$,B[1]=G*H+O*$+j*Y-V*it,B[2]=j*H+O*it+V*$-G*Y,B[3]=O*H-V*Y-G*$-j*it,B}function x(B,O,H,V){var G=O[0],j=O[1],Y=O[2];O=O[3];var $=H[0],it=H[1],nt=H[2];H=H[3];var pt=G*$+j*it+Y*nt+O*H;if(0>pt&&(pt=-pt,$=-$,it=-it,nt=-nt,H=-H),1-pt>M.EPSILON){var Rt=Math.acos(pt),Et=Math.sin(Rt);pt=Math.sin((1-V)*Rt)/Et,V=Math.sin(V*Rt)/Et}else pt=1-V;return B[0]=pt*G+V*$,B[1]=pt*j+V*it,B[2]=pt*Y+V*nt,B[3]=pt*O+V*H,B}function y(B,O){var H=O[0]+O[4]+O[8];if(0<H)H=Math.sqrt(H+1),B[3]=.5*H,H=.5/H,B[0]=(O[5]-O[7])*H,B[1]=(O[6]-O[2])*H,B[2]=(O[1]-O[3])*H;else{var V=0;O[4]>O[0]&&(V=1),O[8]>O[3*V+V]&&(V=2);var G=(V+1)%3,j=(V+2)%3;H=Math.sqrt(O[3*V+V]-O[3*G+G]-O[3*j+j]+1),B[V]=.5*H,H=.5/H,B[3]=(O[3*G+j]-O[3*j+G])*H,B[G]=(O[3*G+V]+O[3*V+G])*H,B[j]=(O[3*j+V]+O[3*V+j])*H}return B}Object.defineProperty(u,"__esModule",{value:!0}),u.create=l,u.identity=function(B){return B[0]=0,B[1]=0,B[2]=0,B[3]=1,B},u.setAxisAngle=v,u.getAxisAngle=function(B,O){var H=2*Math.acos(O[3]),V=Math.sin(H/2);return V>M.EPSILON?(B[0]=O[0]/V,B[1]=O[1]/V,B[2]=O[2]/V):(B[0]=1,B[1]=0,B[2]=0),H},u.multiply=d,u.rotateX=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H+O*Y,B[1]=G*H+j*Y,B[2]=j*H-G*Y,B[3]=O*H-V*Y,B},u.rotateY=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H-j*Y,B[1]=G*H+O*Y,B[2]=j*H+V*Y,B[3]=O*H-G*Y,B},u.rotateZ=function(B,O,H){H*=.5;var V=O[0],G=O[1],j=O[2];O=O[3];var Y=Math.sin(H);return H=Math.cos(H),B[0]=V*H+G*Y,B[1]=G*H-V*Y,B[2]=j*H+O*Y,B[3]=O*H-j*Y,B},u.calculateW=function(B,O){var H=O[0],V=O[1];return O=O[2],B[0]=H,B[1]=V,B[2]=O,B[3]=Math.sqrt(Math.abs(1-H*H-V*V-O*O)),B},u.slerp=x,u.random=function(B){var O=M.RANDOM(),H=M.RANDOM(),V=M.RANDOM(),G=Math.sqrt(1-O);return O=Math.sqrt(O),B[0]=G*Math.sin(2*Math.PI*H),B[1]=G*Math.cos(2*Math.PI*H),B[2]=O*Math.sin(2*Math.PI*V),B[3]=O*Math.cos(2*Math.PI*V),B},u.invert=function(B,O){var H=O[0],V=O[1],G=O[2];O=O[3];var j=H*H+V*V+G*G+O*O;return j=j?1/j:0,B[0]=-H*j,B[1]=-V*j,B[2]=-G*j,B[3]=O*j,B},u.conjugate=function(B,O){return B[0]=-O[0],B[1]=-O[1],B[2]=-O[2],B[3]=O[3],B},u.fromMat3=y,u.fromEuler=function(B,O,H,V){var G=.5*Math.PI/180;O*=G,H*=G,V*=G,G=Math.sin(O),O=Math.cos(O);var j=Math.sin(H);H=Math.cos(H);var Y=Math.sin(V);return V=Math.cos(V),B[0]=G*H*V-O*j*Y,B[1]=O*j*V+G*H*Y,B[2]=O*H*Y-G*j*V,B[3]=O*H*V+G*j*Y,B},u.str=function(B){return"quat("+B[0]+", "+B[1]+", "+B[2]+", "+B[3]+")"},u.setAxes=u.sqlerp=u.rotationTo=u.equals=u.exactEquals=u.normalize=u.sqrLen=u.squaredLength=u.len=u.length=u.lerp=u.dot=u.scale=u.mul=u.add=u.set=u.copy=u.fromValues=u.clone=void 0;var M=n(Ys),D=n(xa),U=n(rd);a=n(pf),u.clone=a.clone,u.fromValues=a.fromValues,u.copy=a.copy,u.set=a.set,u.add=a.add,u.mul=d,u.scale=a.scale,u.dot=a.dot,u.lerp=a.lerp;var C=a.length;u.length=C,u.len=C,C=a.squaredLength,u.squaredLength=C,u.sqrLen=C;var E=a.normalize;u.normalize=E,u.exactEquals=a.exactEquals,u.equals=a.equals,a=function(){var B=U.create(),O=U.fromValues(1,0,0),H=U.fromValues(0,1,0);return function(V,G,j){var Y=U.dot(G,j);return-.999999>Y?(U.cross(B,O,G),1e-6>U.len(B)&&U.cross(B,H,G),U.normalize(B,B),v(V,B,Math.PI),V):.999999<Y?(V[0]=0,V[1]=0,V[2]=0,V[3]=1,V):(U.cross(B,G,j),V[0]=B[0],V[1]=B[1],V[2]=B[2],V[3]=1+Y,E(V,V))}}(),u.rotationTo=a,a=function(){var B=l(),O=l();return function(H,V,G,j,Y,$){return x(B,V,Y,$),x(O,G,j,$),x(H,B,O,2*$*(1-$)),H}}(),u.sqlerp=a,a=function(){var B=D.create();return function(O,H,V,G){return B[0]=V[0],B[3]=V[1],B[6]=V[2],B[1]=G[0],B[4]=G[1],B[7]=G[2],B[2]=-H[0],B[5]=-H[1],B[8]=-H[2],E(O,y(O,B))}}(),u.setAxes=a});zt(df);var mm=It(function(a,u){function n(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=gn&&vn?vn(C,B):{};O.get||O.set?gn(E,B,O):E[B]=C[B]}}return E.default=C,E}function l(C,E,B){var O=.5*B[0],H=.5*B[1];B=.5*B[2];var V=E[0],G=E[1],j=E[2];return E=E[3],C[0]=V,C[1]=G,C[2]=j,C[3]=E,C[4]=O*E+H*j-B*G,C[5]=H*E+B*V-O*j,C[6]=B*E+O*G-H*V,C[7]=-O*V-H*G-B*j,C}function v(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=E[4],C[5]=E[5],C[6]=E[6],C[7]=E[7],C}function d(C,E,B){var O=E[0],H=E[1],V=E[2],G=E[3],j=B[4],Y=B[5],$=B[6],it=B[7],nt=E[4],pt=E[5],Rt=E[6];E=E[7];var Et=B[0],Jt=B[1],oe=B[2];return B=B[3],C[0]=O*B+G*Et+H*oe-V*Jt,C[1]=H*B+G*Jt+V*Et-O*oe,C[2]=V*B+G*oe+O*Jt-H*Et,C[3]=G*B-O*Et-H*Jt-V*oe,C[4]=O*it+G*j+H*$-V*Y+nt*B+E*Et+pt*oe-Rt*Jt,C[5]=H*it+G*Y+V*j-O*$+pt*B+E*Jt+Rt*Et-nt*oe,C[6]=V*it+G*$+O*Y-H*j+Rt*B+E*oe+nt*Jt-pt*Et,C[7]=G*it-O*j-H*Y-V*$+E*B-nt*Et-pt*Jt-Rt*oe,C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=function(){var C=new x.ARRAY_TYPE(8);return x.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0,C[2]=0,C[4]=0,C[5]=0,C[6]=0,C[7]=0),C[3]=1,C},u.clone=function(C){var E=new x.ARRAY_TYPE(8);return E[0]=C[0],E[1]=C[1],E[2]=C[2],E[3]=C[3],E[4]=C[4],E[5]=C[5],E[6]=C[6],E[7]=C[7],E},u.fromValues=function(C,E,B,O,H,V,G,j){var Y=new x.ARRAY_TYPE(8);return Y[0]=C,Y[1]=E,Y[2]=B,Y[3]=O,Y[4]=H,Y[5]=V,Y[6]=G,Y[7]=j,Y},u.fromRotationTranslationValues=function(C,E,B,O,H,V,G){var j=new x.ARRAY_TYPE(8);return j[0]=C,j[1]=E,j[2]=B,j[3]=O,H*=.5,V*=.5,G*=.5,j[4]=H*O+V*B-G*E,j[5]=V*O+G*C-H*B,j[6]=G*O+H*E-V*C,j[7]=-H*C-V*E-G*B,j},u.fromRotationTranslation=l,u.fromTranslation=function(C,E){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=.5*E[0],C[5]=.5*E[1],C[6]=.5*E[2],C[7]=0,C},u.fromRotation=function(C,E){return C[0]=E[0],C[1]=E[1],C[2]=E[2],C[3]=E[3],C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},u.fromMat4=function(C,E){var B=y.create();M.getRotation(B,E);var O=new x.ARRAY_TYPE(3);return M.getTranslation(O,E),l(C,B,O),C},u.copy=v,u.identity=function(C){return C[0]=0,C[1]=0,C[2]=0,C[3]=1,C[4]=0,C[5]=0,C[6]=0,C[7]=0,C},u.set=function(C,E,B,O,H,V,G,j,Y){return C[0]=E,C[1]=B,C[2]=O,C[3]=H,C[4]=V,C[5]=G,C[6]=j,C[7]=Y,C},u.getDual=function(C,E){return C[0]=E[4],C[1]=E[5],C[2]=E[6],C[3]=E[7],C},u.setDual=function(C,E){return C[4]=E[0],C[5]=E[1],C[6]=E[2],C[7]=E[3],C},u.getTranslation=function(C,E){var B=E[4],O=E[5],H=E[6],V=E[7],G=-E[0],j=-E[1],Y=-E[2];return E=E[3],C[0]=2*(B*E+V*G+O*Y-H*j),C[1]=2*(O*E+V*j+H*G-B*Y),C[2]=2*(H*E+V*Y+B*j-O*G),C},u.translate=function(C,E,B){var O=E[0],H=E[1],V=E[2],G=E[3],j=.5*B[0],Y=.5*B[1];B=.5*B[2];var $=E[4],it=E[5],nt=E[6];return E=E[7],C[0]=O,C[1]=H,C[2]=V,C[3]=G,C[4]=G*j+H*B-V*Y+$,C[5]=G*Y+V*j-O*B+it,C[6]=G*B+O*Y-H*j+nt,C[7]=-O*j-H*Y-V*B+E,C},u.rotateX=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,pt=Y*G+it*H+$*O-j*V,Rt=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateX(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+pt*V-Rt*H,C[5]=pt*G+j*H+Rt*O-nt*V,C[6]=Rt*G+j*V+nt*H-pt*O,C[7]=j*G-nt*O-pt*H-Rt*V,C},u.rotateY=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,pt=Y*G+it*H+$*O-j*V,Rt=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateY(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+pt*V-Rt*H,C[5]=pt*G+j*H+Rt*O-nt*V,C[6]=Rt*G+j*V+nt*H-pt*O,C[7]=j*G-nt*O-pt*H-Rt*V,C},u.rotateZ=function(C,E,B){var O=-E[0],H=-E[1],V=-E[2],G=E[3],j=E[4],Y=E[5],$=E[6],it=E[7],nt=j*G+it*O+Y*V-$*H,pt=Y*G+it*H+$*O-j*V,Rt=$*G+it*V+j*H-Y*O;return j=it*G-j*O-Y*H-$*V,y.rotateZ(C,E,B),O=C[0],H=C[1],V=C[2],G=C[3],C[4]=nt*G+j*O+pt*V-Rt*H,C[5]=pt*G+j*H+Rt*O-nt*V,C[6]=Rt*G+j*V+nt*H-pt*O,C[7]=j*G-nt*O-pt*H-Rt*V,C},u.rotateByQuatAppend=function(C,E,B){var O=B[0],H=B[1],V=B[2];B=B[3];var G=E[0],j=E[1],Y=E[2],$=E[3];return C[0]=G*B+$*O+j*V-Y*H,C[1]=j*B+$*H+Y*O-G*V,C[2]=Y*B+$*V+G*H-j*O,C[3]=$*B-G*O-j*H-Y*V,G=E[4],j=E[5],Y=E[6],$=E[7],C[4]=G*B+$*O+j*V-Y*H,C[5]=j*B+$*H+Y*O-G*V,C[6]=Y*B+$*V+G*H-j*O,C[7]=$*B-G*O-j*H-Y*V,C},u.rotateByQuatPrepend=function(C,E,B){var O=E[0],H=E[1],V=E[2];E=E[3];var G=B[0],j=B[1],Y=B[2],$=B[3];return C[0]=O*$+E*G+H*Y-V*j,C[1]=H*$+E*j+V*G-O*Y,C[2]=V*$+E*Y+O*j-H*G,C[3]=E*$-O*G-H*j-V*Y,G=B[4],j=B[5],Y=B[6],$=B[7],C[4]=O*$+E*G+H*Y-V*j,C[5]=H*$+E*j+V*G-O*Y,C[6]=V*$+E*Y+O*j-H*G,C[7]=E*$-O*G-H*j-V*Y,C},u.rotateAroundAxis=function(C,E,B,O){if(Math.abs(O)<x.EPSILON)return v(C,E);var H=Math.sqrt(B[0]*B[0]+B[1]*B[1]+B[2]*B[2]);O*=.5;var V=Math.sin(O),G=V*B[0]/H,j=V*B[1]/H;B=V*B[2]/H,O=Math.cos(O),H=E[0],V=E[1];var Y=E[2],$=E[3];return C[0]=H*O+$*G+V*B-Y*j,C[1]=V*O+$*j+Y*G-H*B,C[2]=Y*O+$*B+H*j-V*G,C[3]=$*O-H*G-V*j-Y*B,H=E[4],V=E[5],Y=E[6],E=E[7],C[4]=H*O+E*G+V*B-Y*j,C[5]=V*O+E*j+Y*G-H*B,C[6]=Y*O+E*B+H*j-V*G,C[7]=E*O-H*G-V*j-Y*B,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C[2]=E[2]+B[2],C[3]=E[3]+B[3],C[4]=E[4]+B[4],C[5]=E[5]+B[5],C[6]=E[6]+B[6],C[7]=E[7]+B[7],C},u.multiply=d,u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C[2]=E[2]*B,C[3]=E[3]*B,C[4]=E[4]*B,C[5]=E[5]*B,C[6]=E[6]*B,C[7]=E[7]*B,C},u.lerp=function(C,E,B,O){var H=1-O;return 0>D(E,B)&&(O=-O),C[0]=E[0]*H+B[0]*O,C[1]=E[1]*H+B[1]*O,C[2]=E[2]*H+B[2]*O,C[3]=E[3]*H+B[3]*O,C[4]=E[4]*H+B[4]*O,C[5]=E[5]*H+B[5]*O,C[6]=E[6]*H+B[6]*O,C[7]=E[7]*H+B[7]*O,C},u.invert=function(C,E){var B=U(E);return C[0]=-E[0]/B,C[1]=-E[1]/B,C[2]=-E[2]/B,C[3]=E[3]/B,C[4]=-E[4]/B,C[5]=-E[5]/B,C[6]=-E[6]/B,C[7]=E[7]/B,C},u.conjugate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C[2]=-E[2],C[3]=E[3],C[4]=-E[4],C[5]=-E[5],C[6]=-E[6],C[7]=E[7],C},u.normalize=function(C,E){var B=U(E);if(0<B){B=Math.sqrt(B);var O=E[0]/B,H=E[1]/B,V=E[2]/B,G=E[3]/B,j=E[4],Y=E[5],$=E[6];E=E[7];var it=O*j+H*Y+V*$+G*E;C[0]=O,C[1]=H,C[2]=V,C[3]=G,C[4]=(j-O*it)/B,C[5]=(Y-H*it)/B,C[6]=($-V*it)/B,C[7]=(E-G*it)/B}return C},u.str=function(C){return"quat2("+C[0]+", "+C[1]+", "+C[2]+", "+C[3]+", "+C[4]+", "+C[5]+", "+C[6]+", "+C[7]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]&&C[3]===E[3]&&C[4]===E[4]&&C[5]===E[5]&&C[6]===E[6]&&C[7]===E[7]},u.equals=function(C,E){var B=C[0],O=C[1],H=C[2],V=C[3],G=C[4],j=C[5],Y=C[6];C=C[7];var $=E[0],it=E[1],nt=E[2],pt=E[3],Rt=E[4],Et=E[5],Jt=E[6];return E=E[7],Math.abs(B-$)<=x.EPSILON*Math.max(1,Math.abs(B),Math.abs($))&&Math.abs(O-it)<=x.EPSILON*Math.max(1,Math.abs(O),Math.abs(it))&&Math.abs(H-nt)<=x.EPSILON*Math.max(1,Math.abs(H),Math.abs(nt))&&Math.abs(V-pt)<=x.EPSILON*Math.max(1,Math.abs(V),Math.abs(pt))&&Math.abs(G-Rt)<=x.EPSILON*Math.max(1,Math.abs(G),Math.abs(Rt))&&Math.abs(j-Et)<=x.EPSILON*Math.max(1,Math.abs(j),Math.abs(Et))&&Math.abs(Y-Jt)<=x.EPSILON*Math.max(1,Math.abs(Y),Math.abs(Jt))&&Math.abs(C-E)<=x.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.sqrLen=u.squaredLength=u.len=u.length=u.dot=u.mul=u.setReal=u.getReal=void 0;var x=n(Ys),y=n(df),M=n(ed);u.getReal=y.copy,u.setReal=y.copy,u.mul=d;var D=y.dot;u.dot=D,a=y.length,u.length=a,u.len=a;var U=y.squaredLength;u.squaredLength=U,u.sqrLen=U});zt(mm);var id=It(function(a,u){function n(){var C=new U.ARRAY_TYPE(2);return U.ARRAY_TYPE!=Float32Array&&(C[0]=0,C[1]=0),C}function l(C,E,B){return C[0]=E[0]-B[0],C[1]=E[1]-B[1],C}function v(C,E,B){return C[0]=E[0]*B[0],C[1]=E[1]*B[1],C}function d(C,E,B){return C[0]=E[0]/B[0],C[1]=E[1]/B[1],C}function x(C,E){var B=E[0]-C[0];return C=E[1]-C[1],Math.sqrt(B*B+C*C)}function y(C,E){var B=E[0]-C[0];return C=E[1]-C[1],B*B+C*C}function M(C){var E=C[0];return C=C[1],Math.sqrt(E*E+C*C)}function D(C){var E=C[0];return C=C[1],E*E+C*C}Object.defineProperty(u,"__esModule",{value:!0}),u.create=n,u.clone=function(C){var E=new U.ARRAY_TYPE(2);return E[0]=C[0],E[1]=C[1],E},u.fromValues=function(C,E){var B=new U.ARRAY_TYPE(2);return B[0]=C,B[1]=E,B},u.copy=function(C,E){return C[0]=E[0],C[1]=E[1],C},u.set=function(C,E,B){return C[0]=E,C[1]=B,C},u.add=function(C,E,B){return C[0]=E[0]+B[0],C[1]=E[1]+B[1],C},u.subtract=l,u.multiply=v,u.divide=d,u.ceil=function(C,E){return C[0]=Math.ceil(E[0]),C[1]=Math.ceil(E[1]),C},u.floor=function(C,E){return C[0]=Math.floor(E[0]),C[1]=Math.floor(E[1]),C},u.min=function(C,E,B){return C[0]=Math.min(E[0],B[0]),C[1]=Math.min(E[1],B[1]),C},u.max=function(C,E,B){return C[0]=Math.max(E[0],B[0]),C[1]=Math.max(E[1],B[1]),C},u.round=function(C,E){return C[0]=Math.round(E[0]),C[1]=Math.round(E[1]),C},u.scale=function(C,E,B){return C[0]=E[0]*B,C[1]=E[1]*B,C},u.scaleAndAdd=function(C,E,B,O){return C[0]=E[0]+B[0]*O,C[1]=E[1]+B[1]*O,C},u.distance=x,u.squaredDistance=y,u.length=M,u.squaredLength=D,u.negate=function(C,E){return C[0]=-E[0],C[1]=-E[1],C},u.inverse=function(C,E){return C[0]=1/E[0],C[1]=1/E[1],C},u.normalize=function(C,E){var B=E[0],O=E[1];return B=B*B+O*O,0<B&&(B=1/Math.sqrt(B)),C[0]=E[0]*B,C[1]=E[1]*B,C},u.dot=function(C,E){return C[0]*E[0]+C[1]*E[1]},u.cross=function(C,E,B){return E=E[0]*B[1]-E[1]*B[0],C[0]=C[1]=0,C[2]=E,C},u.lerp=function(C,E,B,O){var H=E[0];return E=E[1],C[0]=H+O*(B[0]-H),C[1]=E+O*(B[1]-E),C},u.random=function(C,E){E=E||1;var B=2*U.RANDOM()*Math.PI;return C[0]=Math.cos(B)*E,C[1]=Math.sin(B)*E,C},u.transformMat2=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[2]*E,C[1]=B[1]*O+B[3]*E,C},u.transformMat2d=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[2]*E+B[4],C[1]=B[1]*O+B[3]*E+B[5],C},u.transformMat3=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[3]*E+B[6],C[1]=B[1]*O+B[4]*E+B[7],C},u.transformMat4=function(C,E,B){var O=E[0];return E=E[1],C[0]=B[0]*O+B[4]*E+B[12],C[1]=B[1]*O+B[5]*E+B[13],C},u.rotate=function(C,E,B,O){var H=E[0]-B[0];E=E[1]-B[1];var V=Math.sin(O);return O=Math.cos(O),C[0]=H*O-E*V+B[0],C[1]=H*V+E*O+B[1],C},u.angle=function(C,E){var B=C[0];C=C[1];var O=E[0];E=E[1];var H=B*B+C*C;0<H&&(H=1/Math.sqrt(H));var V=O*O+E*E;return 0<V&&(V=1/Math.sqrt(V)),B=(B*O+C*E)*H*V,1<B?0:-1>B?Math.PI:Math.acos(B)},u.zero=function(C){return C[0]=0,C[1]=0,C},u.str=function(C){return"vec2("+C[0]+", "+C[1]+")"},u.exactEquals=function(C,E){return C[0]===E[0]&&C[1]===E[1]},u.equals=function(C,E){var B=C[0];C=C[1];var O=E[0];return E=E[1],Math.abs(B-O)<=U.EPSILON*Math.max(1,Math.abs(B),Math.abs(O))&&Math.abs(C-E)<=U.EPSILON*Math.max(1,Math.abs(C),Math.abs(E))},u.forEach=u.sqrLen=u.sqrDist=u.dist=u.div=u.mul=u.sub=u.len=void 0;var U=function(C){if(C&&C.__esModule)return C;var E={};if(C!=null){for(var B in C)if(Object.prototype.hasOwnProperty.call(C,B)){var O=gn&&vn?vn(C,B):{};O.get||O.set?gn(E,B,O):E[B]=C[B]}}return E.default=C,E}(Ys);u.len=M,u.sub=l,u.mul=v,u.div=d,u.dist=x,u.sqrDist=y,u.sqrLen=D,a=function(){var C=n();return function(E,B,O,H,V,G){for(B||(B=2),O||(O=0),H=H?Math.min(H*B+O,E.length):E.length;O<H;O+=B)C[0]=E[O],C[1]=E[O+1],V(C,C,G),E[O]=C[0],E[O+1]=C[1];return E}}(),u.forEach=a});zt(id);var Mo=It(function(a,u){function n(l){if(l&&l.__esModule)return l;var v={};if(l!=null){for(var d in l)if(Object.prototype.hasOwnProperty.call(l,d)){var x=gn&&vn?vn(l,d):{};x.get||x.set?gn(v,d,x):v[d]=l[d]}}return v.default=l,v}Object.defineProperty(u,"__esModule",{value:!0}),u.vec4=u.vec3=u.vec2=u.quat2=u.quat=u.mat4=u.mat3=u.mat2d=u.mat2=u.glMatrix=void 0,a=n(Ys),u.glMatrix=a,a=n(kh),u.mat2=a,a=n(ff),u.mat2d=a,a=n(xa),u.mat3=a,a=n(ed),u.mat4=a,a=n(df),u.quat=a,a=n(mm),u.quat2=a,a=n(id),u.vec2=a,a=n(rd),u.vec3=a,a=n(pf),u.vec4=a});zt(Mo);var Ni=Mo.vec4,Or=Mo.vec3,ii=Mo.vec2,oA=Mo.quat2,gf=Mo.quat,or=Mo.mat4,r1=Mo.mat3,i1=Mo.mat2d,vm=Mo.mat2,ym=Mo.glMatrix,qr=function(){function a(u,n,l){Ke(this,a),this.options=n,this.gl=u,l&&(this.map=l.map),l=this.getVertexShader(n.vertexShader);var v=this.getFragmentShader(n.fragmentShader);n=u.createShader(u.VERTEX_SHADER),u.shaderSource(n,l),u.compileShader(n),u.getShaderParameter(n,u.COMPILE_STATUS)?(l=u.createShader(u.FRAGMENT_SHADER),u.shaderSource(l,v),u.compileShader(l),u.getShaderParameter(l,u.COMPILE_STATUS)?(v=u.createProgram(),u.attachShader(v,n),u.attachShader(v,l),u.deleteShader(n),u.deleteShader(l),u.linkProgram(v),u.getProgramParameter(v,u.LINK_STATUS)?n=v:(n="Shader program failed to link.  The error log is:"+u.getProgramInfoLog(v),console.error(n),n=-1)):(n="Fragment shader failed to compile.  The error log is:"+u.getShaderInfoLog(l),console.error(n),n=-1)):(n="Vertex shader failed to compile.  The error log is:"+u.getShaderInfoLog(n),console.error(n),n=-1),n=this.program=n,l={},v=u.getProgramParameter(n,u.ACTIVE_ATTRIBUTES);for(var d=0;d<v;d++){var x=u.getActiveAttrib(n,d);l[x.name]=u.getAttribLocation(n,x.name)}d={},x={};for(var y=u.getProgramParameter(n,u.ACTIVE_UNIFORMS),M=0;M<y;M++){var D=u.getActiveUniform(n,M);d[D.name]=u.getUniformLocation(n,D.name),x[D.name]=D.type}this.parameter=u={attributes:l,numAttributes:v,uniformsType:x,uniforms:d},this.attributes=u.attributes,this.uniforms=u.uniforms,this.parameter=u}return Qe(a,[{key:"getVertexShader",value:function(u){var n="";return this.map&&this.map.type==="cesium"&&(n=`#define LOG_DEPTH
`),n+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,u=this.getDefines()+n+u,u=u.replace("void main","void originMain"),u+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(u){var n="";return this.map&&this.map.type==="cesium"&&(n=`#define LOG_DEPTH
`),n+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,u=this.getDefines()+n+u,u=u.replace("void main","void originMain"),u+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var u="",n=this.options.defines;if(n)for(var l=0;l<n.length;l++)u+="#define "+n[l]+`
`;return u}},{key:"use",value:function(u,n){this.gl=u,u.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[u.canvas.width,u.canvas.height]})}},{key:"setUniform",value:function(u,n){var l=this.gl,v=this.uniforms[u];if(v)switch(this.parameter.uniformsType[u]){case l.FLOAT:l.uniform1f(v,n);break;case l.FLOAT_VEC2:l.uniform2f(v,n[0],n[1]);break;case l.FLOAT_VEC3:l.uniform3f(v,n[0],n[1],n[2]);break;case l.FLOAT_VEC4:l.uniform4f(v,n[0],n[1],n[2],n[3]);break;case l.SAMPLER_2D:case l.SAMPLER_CUBE:l.activeTexture(l["TEXTURE"+this.textureIndex]),l.uniform1i(v,this.textureIndex),l.bindTexture(l.TEXTURE_2D,n),this.textureIndex++;break;case l.INT:case l.BOOL:l.uniform1i(v,n);break;case l.INT_VEC2:case l.BOOL_VEC2:l.uniform2i(v,n[0],n[1]);break;case l.INT_VEC3:case l.BOOL_VEC3:l.uniform3i(v,n[0],n[1],n[2]);break;case l.INT_VEC4:case l.BOOL_VEC4:l.uniform4i(v,n[0],n[1],n[2],n[3]);break;case l.FLOAT_MAT2:l.uniformMatrix2fv(v,!1,n);break;case l.FLOAT_MAT3:l.uniformMatrix3fv(v,!1,n);break;case l.FLOAT_MAT4:l.uniformMatrix4fv(v,!1,n);break;default:console.error("Unrecognized uniform type: "+u)}else console.warn("Unrecognized uniform type: "+u)}},{key:"setUniforms",value:function(u){this.textureIndex=0;for(var n in u)this.setUniform(n,u[n])}}]),a}(),ds=function(a,u,n,l){var v=n?n.call(l,a,u):void 0;if(v!==void 0)return!!v;if(a===u)return!0;if((typeof a=="undefined"?"undefined":Qr(a))!=="object"||!a||(typeof u=="undefined"?"undefined":Qr(u))!=="object"||!u)return!1;var d=dn(a),x=dn(u);if(d.length!==x.length)return!1;x=Object.prototype.hasOwnProperty.bind(u);for(var y=0;y<d.length;y++){if(v=d[y],!x(v))return!1;var M=a[v],D=u[v];if(v=n?n.call(l,M,D,v):void 0,v===!1||v===void 0&&M!==D)return!1}return!0},xm=function(){function a(u){Ke(this,a),this.options=u,this.gl=u.gl,this.savedState=[],this.currentState=this.getDefaultState()}return Qe(a,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var u=this.gl;return{blend:!1,blendEquation:u.FUNC_ADD,blendFunc:[u.ONE,u.ZERO],depthMask:!0,depthTest:!0,depthFunc:u.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var u=this.gl;return{blend:u.getParameter(u.BLEND),blendEquation:u.getParameter(u.BLEND_EQUATION),depthMask:u.getParameter(u.DEPTH_WRITEMASK),depthTest:u.getParameter(u.DEPTH_TEST),depthFunc:u.getParameter(u.DEPTH_FUNC),polygonOffset:[u.getParameter(u.POLYGON_OFFSET_FACTOR),u.getParameter(u.POLYGON_OFFSET_UNITS)],cullFace:u.getParameter(u.CULL_FACE),stencilTest:u.getParameter(u.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var u=this.savedState.pop();this.setState(u,{force:!0})}},{key:"setState",value:function(u){var n=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};u=Nr(this.getDefaultState(),u),this.setBlend(u,n),this.setDepth(u,n),this.setCullFace(u,n),this.setPolygonOffset(u,n),this.setStencil(u,n),this.currentState=u}},{key:"setBlend",value:function(u,n){var l=this.gl,v=this.getCurrentState();((n=n.force)||!ds(u.blend,v.blend))&&(u.blend?l.enable(l.BLEND):l.disable(l.BLEND)),!n&&ds(u.blendEquation,v.blendEquation)||l.blendEquation(u.blendEquation),(n||!ds(u.blendFunc,v.blendFunc))&&(u.blendFunc.length===2?l.blendFunc(u.blendFunc[0],u.blendFunc[1]):u.blendFunc.length===4&&l.blendFuncSeparate(u.blendFunc[0],u.blendFunc[1],u.blendFunc[2],u.blendFunc[3]))}},{key:"setDepth",value:function(u,n){var l=this.gl,v=this.getCurrentState();((n=n.force)||!ds(u.depthTest,v.depthTest))&&(u.depthTest?l.enable(l.DEPTH_TEST):l.disable(l.DEPTH_TEST)),(n||!ds(u.depthMask,v.depthMask))&&(u.depthMask?l.depthMask(!0):l.depthMask(!1)),!n&&ds(u.depthFunc,v.depthFunc)||l.depthFunc(u.depthFunc)}},{key:"setPolygonOffset",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!ds(u.polygonOffset,v.polygonOffset))&&(u.polygonOffset[0]!==0&&u.polygonOffset[1]!==0?l.enable(l.POLYGON_OFFSET_FILL):l.disable(l.POLYGON_OFFSET_FILL),l.polygonOffset(u.polygonOffset[0],u.polygonOffset[1]))}},{key:"setCullFace",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!ds(u.cullFace,v.cullFace))&&(u.cullFace?(l.enable(l.CULL_FACE),l.cullFace(l.BACK)):l.disable(l.CULL_FACE))}},{key:"setStencil",value:function(u,n){var l=this.gl,v=this.getCurrentState();(n.force||!ds(u.stencilTest,v.stencilTest))&&(u.stencilTest?l.enable(l.STENCIL_TEST):l.disable(l.STENCIL_TEST))}}]),a}(),$e=function(){function a(u){Ke(this,a),this.options=u,this.gl=u.gl,this.buffer=this.gl.createBuffer(),u.data&&this.updateData(u.data)}return Qe(a,[{key:"updateData",value:function(u){var n=this.options,l=this.gl;this.bind(),l.bufferData(l[n.target],u,l[n.usage])}},{key:"bind",value:function(u){u=u||this.gl,u.bindBuffer(u[this.options.target],this.buffer)}},{key:"unBind",value:function(u){u=u||this.gl,u.bindBuffer(u[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),a}(),n1={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},bi=function(){function a(u){for(Ke(this,a),this.options=u,this.attributes=u.attributes,this.gl=u.gl,this.program=u.program,u=this.stride=0;u<this.attributes.length;u++)this.stride+=n1[this.attributes[u].type]*this.attributes[u].size}return Qe(a,[{key:"setVertexAttribPointers",value:function(){for(var u=this.gl,n=this.program,l=0;l<this.attributes.length;l++){var v=this.attributes[l],d=n.attributes[v.name];d!==void 0&&(v.buffer.bind(u),u.vertexAttribPointer(d,v.size,u[v.type],v.normalize||!1,v.stride!==void 0?v.stride:this.stride,v.offset),u.enableVertexAttribArray(d))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),a}(),zn=function a(u,n,l){Ke(this,a),n=n||u.canvas.width,l=l||u.canvas.height;var v=u.createFramebuffer(),d=u.createTexture();u.bindTexture(u.TEXTURE_2D,d),u.texImage2D(u.TEXTURE_2D,0,u.RGBA,n,l,0,u.RGBA,u.UNSIGNED_BYTE,null),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,u.LINEAR),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,u.CLAMP_TO_EDGE),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,u.CLAMP_TO_EDGE),v.texture=d;var x=u.createRenderbuffer();u.bindRenderbuffer(u.RENDERBUFFER,x),u.renderbufferStorage(u.RENDERBUFFER,u.DEPTH_STENCIL,n,l),v.depthBuffer=x,u.bindFramebuffer(u.FRAMEBUFFER,v),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,d,0),u.framebufferRenderbuffer(u.FRAMEBUFFER,u.DEPTH_STENCIL_ATTACHMENT,u.RENDERBUFFER,x),n=u.checkFramebufferStatus(u.FRAMEBUFFER),u.FRAMEBUFFER_COMPLETE===n&&(u.bindFramebuffer(u.FRAMEBUFFER,null),u.bindTexture(u.TEXTURE_2D,null),u.bindRenderbuffer(u.RENDERBUFFER,null),this.framebuffer=v)},Gl=function(){function a(u){Ke(this,a),this.options={},Nr(this.options,u),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return Qe(a,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(u){}},{key:"render",value:function(u){var n=u.gl;u=u.texture;var l=this.programSample;n.useProgram(l.program);var v=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,v);var d=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.STATIC_DRAW),n.enableVertexAttribArray(l.attributes.aPos),n.vertexAttribPointer(l.attributes.aPos,3,n.FLOAT,!1,0,0),v=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,v),n.bufferData(n.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),n.STATIC_DRAW),n.enableVertexAttribArray(l.attributes.aTextureCoord),n.vertexAttribPointer(l.attributes.aTextureCoord,2,n.FLOAT,!1,0,0),n.activeTexture(n.TEXTURE0),n.bindTexture(n.TEXTURE_2D,u),n.uniform1i(l.uniforms.uSampler,0),n.drawArrays(n.TRIANGLES,0,d.length/3)}}]),a}(),Am=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture,this.getOptions(),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var v=this.getProgram(l);l.useProgram(v.program);var d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),d=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aTextureCoord),l.vertexAttribPointer(v.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.uniform2fv(v.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Gl),_m=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){if(this.program1||(this.program1=new qr(n,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new qr(n,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new qr(n,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var l=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new bi({gl:n,program:this.program1,attributes:l}),this.vertexArray2=new bi({gl:n,program:this.program2,attributes:l}),this.vertexArray3=new bi({gl:n,program:this.program3,attributes:l})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new zn(n),this.bloomBuffer=new zn(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new zn(n)),this.bloomBuffer||(this.bloomBuffer=new zn(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo,this.getOptions(),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var d=this.getProgram(l),x=d.program1,y=d.program2;d=d.program3;var M=this.getExtraFbo(l),D=M.collectBrightBuffer;M=M.bloomBuffer;var U=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,U),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(x.attributes.position),l.vertexAttribPointer(x.attributes.position,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.position),l.vertexAttribPointer(y.attributes.position,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(d.attributes.position),l.vertexAttribPointer(d.attributes.position,3,l.FLOAT,!1,0,0),U=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,U),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(x.attributes.uv),l.vertexAttribPointer(x.attributes.uv,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.uv),l.vertexAttribPointer(y.attributes.uv,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(d.attributes.uv),l.vertexAttribPointer(d.attributes.uv,2,l.FLOAT,!1,0,0),l.useProgram(x.program),l.bindFramebuffer(l.FRAMEBUFFER,D),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(x.uniforms.tDiffuse,2),l.uniform2fv(x.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,M),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,D.texture),l.uniform1i(y.uniforms.uSampler,2),l.uniform2fv(y.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(d.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE2),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(d.uniforms.tDiffuse,2),l.activeTexture(l.TEXTURE3),l.bindTexture(l.TEXTURE_2D,M.texture),l.uniform1i(d.uniforms.tColor,3),l.uniform2fv(d.uniforms.resolution,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),u}(Gl),o1=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new bi({gl:n,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture,l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var v=this.getProgram(l);v.use(l),this.vertexArray.bind(),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3)}}]),u}(Gl),nd=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){return this.programBright||(this.programBright=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new zn(n),this.bloomBuffer=new zn(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new zn(n)),this.bloomBuffer||(this.bloomBuffer=new zn(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo;var d=this.getOptions();l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var x=this.getProgram(l),y=x.programBright,M=x.programBloom;x=x.programResult;var D=this.getExtraFbo(l),U=D.collectBrightBuffer;D=D.bloomBuffer;var C=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,C),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(y.attributes.aPos),l.vertexAttribPointer(y.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(M.attributes.aPos),l.vertexAttribPointer(M.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(x.attributes.aPos),l.vertexAttribPointer(x.attributes.aPos,3,l.FLOAT,!1,0,0),C=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,C),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(y.attributes.aTextureCoord),l.vertexAttribPointer(y.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(M.attributes.aTextureCoord),l.vertexAttribPointer(M.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(x.attributes.aTextureCoord),l.vertexAttribPointer(x.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(y.uniforms.uSampler,1),l.uniform1f(y.uniforms.threshold,d.threshold||0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,D),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(M.uniforms.uSampler,1),l.uniform1i(M.uniforms.isVertical,!0),l.uniform1f(M.uniforms.blurSize,d.blurSize||2),l.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(M.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,D.texture),l.uniform1i(M.uniforms.uSampler,1),l.uniform1i(M.uniforms.isVertical,!1),l.uniform1f(M.uniforms.blurSize,d.blurSize||2),l.uniform1f(M.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(M.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(x.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(x.uniforms.originalTexture,1),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(x.uniforms.bloomTexture,0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Gl),od=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){return this.programBright||(this.programBright=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(n){this.collectBrightBuffer=new zn(n),this.bloomBuffer=new zn(n)}},{key:"getExtraFbo",value:function(n){return this.collectBrightBuffer||(this.collectBrightBuffer=new zn(n)),this.bloomBuffer||(this.bloomBuffer=new zn(n)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(n){var l=n.gl,v=n.texture;n=n.fbo;var d=this.getOptions(),x="clarity"in d?d.clarity:1;x=Math.max(0,x),x=Math.min(1,x),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT);var y=this.getProgram(l),M=y.programBright,D=y.programBloom;y=y.programResult;var U=this.getExtraFbo(l),C=U.collectBrightBuffer;U=U.bloomBuffer;var E=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,E),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(M.attributes.aPos),l.vertexAttribPointer(M.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(D.attributes.aPos),l.vertexAttribPointer(D.attributes.aPos,3,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.aPos),l.vertexAttribPointer(y.attributes.aPos,3,l.FLOAT,!1,0,0),E=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,E),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(M.attributes.aTextureCoord),l.vertexAttribPointer(M.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(D.attributes.aTextureCoord),l.vertexAttribPointer(D.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.enableVertexAttribArray(y.attributes.aTextureCoord),l.vertexAttribPointer(y.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.useProgram(M.program),l.bindFramebuffer(l.FRAMEBUFFER,C),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(M.uniforms.uSampler,1),l.uniform1f(M.uniforms.threshold,d.threshold||0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(D.program),l.bindFramebuffer(l.FRAMEBUFFER,U),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,C.texture),l.uniform1i(D.uniforms.uSampler,1),l.uniform1i(D.uniforms.isVertical,!0),l.uniform1f(D.uniforms.blurSize,d.blurSize||2),l.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(D.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(D.program),l.bindFramebuffer(l.FRAMEBUFFER,C),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,U.texture),l.uniform1i(D.uniforms.uSampler,1),l.uniform1i(D.uniforms.isVertical,!1),l.uniform1f(D.uniforms.blurSize,d.blurSize||2),l.uniform1f(D.uniforms.devicePixelRatio,window.devicePixelRatio),l.uniform2fv(D.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.useProgram(y.program),l.bindFramebuffer(l.FRAMEBUFFER,n),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,v),l.uniform1i(y.uniforms.originalTexture,1),l.uniform1f(y.uniforms.toneScale,x),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,C.texture),l.uniform1i(y.uniforms.bloomTexture,0),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3),l.bindBuffer(l.ARRAY_BUFFER,null),l.useProgram(null)}}]),u}(Gl),s1=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"getProgram",value:function(n){return this.programSample||(this.programSample=new qr(n,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(n){var l=n.gl;n=n.texture;var v=this.getProgram(l);l.useProgram(v.program);var d=l.createBuffer();l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.vertex),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),d=l.createBuffer(),l.bindBuffer(l.ARRAY_BUFFER,d),l.bufferData(l.ARRAY_BUFFER,new Float32Array(this.sampleCoord),l.STATIC_DRAW),l.enableVertexAttribArray(v.attributes.aTextureCoord),l.vertexAttribPointer(v.attributes.aTextureCoord,2,l.FLOAT,!1,0,0),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,n),l.uniform1i(v.uniforms.uSampler,1),l.uniform2fv(v.uniforms.canvasSize,[l.canvas.width,l.canvas.height]),l.drawArrays(l.TRIANGLES,0,this.vertex.length/3)}}]),u}(Gl),a1=function(){function a(u){Ke(this,a),this.gl=u,this.effects=[],this.initFbo()}return Qe(a,[{key:"addEffect",value:function(u){this.effects.push(u)}},{key:"removeEffect",value:function(u){}},{key:"setEffects",value:function(u){this.effects=u}},{key:"onResize",value:function(){this.initFbo();var u=this.gl,n=this.effects;if(n&&1<n.length)for(var l=1;l<n.length;l++){var v=n[l];v.onResize&&v.onResize(u)}}},{key:"initFbo",value:function(){var u=this.gl;u&&(this.fbo=[new zn(u),new zn(u)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var u=this.gl,n=this.effects;if(n&&0<n.length)for(var l={},v=0;v<n.length;v++){var d=this.fbo[v%2].framebuffer;v===n.length-1&&(d=null),u.bindFramebuffer(u.FRAMEBUFFER,d);var x=[0,0,0,0];u.clearColor(x[0],x[1],x[2],x[3]),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT),n[v].render({isPickRender:!1,gl:u,texture:l.texture,fbo:d}),l=d}}}]),a}(),bl=function(){function a(u,n){Ke(this,a),this.map=u,this.options=n||{},this.eventMap={}}return Qe(a,[{key:"onResize",value:function(u){}},{key:"onUpdate",value:function(u){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(u,n){return this.options.coordinateSystem==="gcj02"?(n=n*Math.PI/180,n=31890685e-1*Math.log((1+Math.sin(n))/(1-Math.sin(n))),[parseFloat((u*Math.PI/180*6378137).toFixed(2)),parseFloat(n.toFixed(2))]):(u=Yr.convertLL2MC({lng:u,lat:n}),[u.lng,u.lat])}}]),a}(),sd=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.eventMap={},n}return Pr(u,a),Qe(u,[{key:"onResize",value:function(n){this.map.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onMousemove",value:function(n){n=this.extendCallback(n),this.map.addEventListener("mousemove",n),this.eventMap.mousemove=n}},{key:"onClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("click",n),this.eventMap.click=n}},{key:"onDblClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("dblclick",n),this.eventMap.dblclick=n}},{key:"onRightClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("rightclick",n),this.eventMap.rightclick=n}},{key:"onUpdate",value:function(n){this.map.addEventListener("update",n),this.map.addEventListener("onearthstatuschange",n),this.eventMap.update=n,this.eventMap.onearthstatuschange=n}},{key:"extendCallback",value:function(n){return function(l){n(Nr(l,{x:l.x,y:l.y}))}}},{key:"unbind",value:function(n){var l=this;this.eventMap[n]?(this.map.removeEventListener(n,this.eventMap[n]),delete this.eventMap[n]):(dn(this.eventMap).forEach(function(v){l.map.removeEventListener(v,l.eventMap[v])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var n=this.map.getCenter();return-180<=n.lng&&180>=n.lng&&(n=this.map.lnglatToMercator(n.lng,n.lat),n={lng:n[0],lat:n[1]}),n}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(n,l){return this.map.lnglatToMercator(n,l)}},{key:"mercatorToLnglat",value:function(n,l){return this.map.mercatorToLnglat(n,l)}},{key:"pixelToPointIn",value:function(n){return n=this.map.pixelToPointIn(n),this.mercatorToLnglat(n.lng,n.lat)}}]),u}(bl),u1=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.div=document.createElement("div"),n.div.style.position="absolute",n.div.style.userSelect="none",n.map.getPanes().mapPane.appendChild(n.div),n.eventMap={},n}return Pr(u,a),Qe(u,[{key:"onResize",value:function(n){this.map.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onMousemove",value:function(n){n=this.extendCallback(n),this.map.addEventListener("mousemove",n),this.eventMap.mousemove=n}},{key:"onClick",value:function(n){n=this.extendCallback(n),Kg?(this.map.addEventListener("touchend",n),this.eventMap.touchend=n):(this.map.addEventListener("click",n),this.eventMap.click=n)}},{key:"onDblClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("dblclick",n),this.eventMap.dblclick=n}},{key:"onRightClick",value:function(n){n=this.extendCallback(n),this.map.addEventListener("rightclick",n),this.eventMap.rightclick=n}},{key:"changeCanvas",value:function(){var n=this.map,l=n.getSize(),v=n.getCenter();n=n.pointToOverlayPixel(v),this.div.style.left=n.x-l.width/2+"px",this.div.style.top=n.y-l.height/2+"px"}},{key:"onUpdate",value:function(n){var l=this,v=function(){l.changeCanvas(),n()};this.map.addEventListener("moveend",v),this.map.addEventListener("moving",v),this.map.addEventListener("zoomend",v),this.eventMap.moveend=v,this.eventMap.moving=v,this.eventMap.zoomend=v}},{key:"extendCallback",value:function(n){return function(l){n(Nr(l,{x:l.pixel.x,y:l.pixel.y}))}}},{key:"unbind",value:function(){var n=this;dn(this.eventMap).forEach(function(l){n.map.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var n=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(n):Math.pow(2,18-n)}},{key:"getCenter",value:function(){var n=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:n.x,lat:n.y}}},{key:"lnglatToMercator",value:function(n,l){return n=this.map.getMapType().getProjection().lngLatToPoint({lng:n,lat:l}),[n.x,n.y]}},{key:"mercatorToLnglat",value:function(n,l){return n=this.map.getMapType().getProjection().pointToLngLat({lng:n,lat:l}),[n.lng,n.lat]}}]),u}(bl),l1=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.eventMap={},n}return Pr(u,a),Qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;dn(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var n=this.map;return{width:n.canvas.clientWidth,height:n.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var n=this.map;return 6.8*n.scene.globe.ellipsoid.cartesianToCartographic(n.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var n=this.map;return n=n.camera.pickEllipsoid(new Cesium.Cartesian2(n.canvas.clientWidth/2,n.canvas.clientHeight/2)),n=Cesium.Ellipsoid.WGS84.cartesianToCartographic(n),n=this.getMercator([180*n.longitude/Math.PI,180*n.latitude/Math.PI]),{lng:n[0],lat:n[1]}}},{key:"getMercator",value:function(n){var l=[];return l[0]=n[0]*Math.PI/180*6378137,n=n[1]*Math.PI/180,l[1]=31890685e-1*Math.log((1+Math.sin(n))/(1-Math.sin(n))),l}}]),u}(bl),h1=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.eventMap={},n}return Pr(u,a),Qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;dn(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),u}(bl),c1=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.eventMap={},n}return Pr(u,a),Qe(u,[{key:"onResize",value:function(n){window.addEventListener("resize",n),this.eventMap.resize=n}},{key:"onUpdate",value:function(n){}},{key:"unbind",value:function(){var n=this;dn(this.eventMap).forEach(function(l){window.removeEventListener(l,n.eventMap[l])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),u}(bl),Vl=function(){function a(u,n){var l=this;Ke(this,a),n=n||{},n.mapType==="bmap"?this.map=new u1(u,n):n.mapType==="blank"?this.map=new h1(u,n):n.mapType==="cesium"?this.map=new l1(u,n):n.mapType==="three"?this.map=new c1(u,n):(n.mapType="bmapgl",this.map=new sd(u,n)),this.map.type=n.mapType,this._dpr=window.devicePixelRatio,n.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=n||{},this.renderArr=[],(u=n.canvas)||(u=document.createElement("canvas")),this.canvas=u,this.gl=n.gl?n.gl:_s(u,n),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(v){l.gl.getExtension(v)}),this.changeSize(),this.projectionMatrix=or.create(Float64Array),this.orthoMatrix=or.create(Float64Array),this.matrix=or.create(Float64Array),this.viewMatrix=or.create(Float64Array),this.pointToPixelMatrix=or.create(Float64Array),this.pixelToViewMatrix=or.create(Float64Array),this.fovy=35,this.fps=Math.min(n.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new xm({gl:this.gl}),this.pickFBO=new zn(this.gl),this.transferOptions={},this.bind()}return Qe(a,[{key:"bind",value:function(){var u=this,n=this.map;n.onResize(function(){u.changeSize(),u.render()}),n.onUpdate(this._update),n.onClick&&n.onClick(function(l){u.onClick&&u.onClick(l)}),n.onDblClick&&n.onDblClick(function(l){u.onDblClick&&u.onDblClick(l)}),n.onRightClick&&n.onRightClick(function(l){u.onRightClick&&u.onRightClick(l)}),n.onMousemove&&n.onMousemove(function(l){u.onMousemove&&u.onMousemove(l)}),this.options.canvas||n.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var u=this.map;u.unbind&&u.unbind()}},{key:"setOptions",value:function(u){this.options=u}},{key:"onInitialize",value:function(u){u&&(this.transferOptions=u.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(u){var n=this.gl;u?n.bindFramebuffer(n.FRAMEBUFFER,u.framebuffer):n.bindFramebuffer(n.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var u=this.gl;this.preFramebuffer=u.getParameter(u.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(u){this.renderArr.push(u)}},{key:"changeSize",value:function(){var u=this.canvas,n=this.options;if(u){var l=u.style,v=this.map.getSize(),d=this._dpr;u.width=v.width*d,u.height=v.height*d,l.cssText="position: absolute;left:0;top:0;width:"+v.width+"px;height:"+v.height+"px;z-index:2;",n.mapType!=="cesium"||n.canvas||(l.pointerEvents="none"),this.gl.viewport(0,0,u.width,u.height)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(u){return this.map.pixelToPointIn(u)}},{key:"render",value:function(){if(this.map&&this.gl){var u=this.options,n=this.projectionMatrix,l=this.viewMatrix;if(u.mapType==="three")l=this.map.map.camera,n=l.projectionMatrix.elements,l=l.matrixWorldInverse.elements;else if(u.mapType==="cesium"){l=this.map.map;var v=l.camera.frustum.projectionMatrix;n=new Float32Array([v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]]),v=l.camera.viewMatrix,l=new Float32Array([v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(n=this.map.map.getEarth().scene._camera.getProjectionMatrix(),l=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(v=or.multiply(this.matrix,n,l),Nr(this.transferOptions,{gl:this.gl,matrix:v,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:n,orthoMatrix:this.orthoMatrix,viewMatrix:l,stateManager:this.stateManager}),u.mapType!=="three"&&u.mapType!=="cesium"&&u.autoUpdate!==!1&&this.clear(),u=0;u<this.renderArr.length;u++)this.renderArr[u]&&this.renderArr[u].bind(this)(this.transferOptions)}}},{key:"clear",value:function(u){var n=this.gl,l=this.options.clearColor||[0,0,0,0];n.clearColor(l[0],l[1],l[2],l[3]),u&&(u instanceof Array||(u=Ot(u).unitArray()),n.clearColor(u[0],u[1],u[2],u[3])),n.clear(n.COLOR_BUFFER_BIT|n.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var u=this.gl.canvas.width/this.gl.canvas.height,n=this.options.cameraNear||1,l=this.options.cameraFar||4e3;or.perspective(this.projectionMatrix,jt(this.fovy),u,n,l),u=this.map.getSize(),or.ortho(this.orthoMatrix,-u.width/2,u.width/2,-u.height/2,u.height/2,n,l)}},{key:"updateModelViewMatrix",value:function(){var u=this.map,n=this.viewMatrix,l=this.pointToPixelMatrix,v=this.pixelToViewMatrix;or.identity(n),or.identity(l),or.identity(v);var d=u.getSize();d=Math.round(-d.height/(2*Math.tan(jt(this.fovy)/2))),or.translate(v,v,[0,0,d]),or.rotate(v,v,jt(u.getTilt()),[-1,0,0]),or.rotate(v,v,jt(u.getHeading()),[0,0,-1]),d=u.getCenter();var x=this.options.pointOffset||[0,0];u=u.getZoomUnits(),or.translate(l,l,[(x[0]-d.lng)/u,(x[1]-d.lat)/u,0]),u=1/u,or.scale(l,l,[u,u,u]),or.multiply(n,v,l)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var u=this.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this.canvas.remove(),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var u=new Date().valueOf(),n=Math.floor(1e3/this.fps),l=u-this.renderTime;l>n&&(this.render(),this.renderTime=u-l%n)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),a}(),f1=function(){function a(u){Ke(this,a),this.layers=[],this.options=u,this.webglLayer=u.webglLayer}return Qe(a,[{key:"addLayer",value:function(u){for(var n=!1,l=0;l<this.layers.length;l++)if(this.layers[l]===u){n=!0;break}n||(u.map=this.webglLayer.map,u.layerType==="threeLayer"?(u.setWebglLayer(this.webglLayer),n=u.getThreeLayer(),this.addLayer(n),u.initialize&&u.initialize(n)):(u.setWebglLayer(this.webglLayer),u.commonInitialize&&u.commonInitialize(this.webglLayer.gl),u.initialize&&u.initialize(this.webglLayer.gl),u.onOptionsChanged(u.getOptions(),{}),u.onDataChanged(u.getData()),u.onChanged(u.getOptions(),u.getData())),this.putInLayer(u)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(u){u.options.renderOrder===void 0&&(u.options.renderOrder=this.layers.length),this.layers.push(u),this.layers=this.layers.sort(function(n,l){return n.options.renderOrder-l.options.renderOrder})}},{key:"removeLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&this.layers.splice(n,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&u.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(u){for(var n=0;n<this.layers.length;n++)this.layers[n]===u&&u.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var u=0;u<this.layers.length;u++){var n=this.layers[u];n.destroy&&n.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var u=[],n=0;n<this.layers.length;n++){var l=this.layers[n];l.layerType==="ThreeLayer"&&u.push(l)}return u}},{key:"isRequestAnimation",value:function(){for(var u=!1,n=0;n<this.layers.length;n++)if(this.layers[n].isRequestAnimation()){u=!0;break}return u}},{key:"beforeRender",value:function(u){u.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(u){(u=u.gl)&&(u.bindBuffer(u.ARRAY_BUFFER,null),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null),u.useProgram(null))}},{key:"renderGLLayers",value:function(u){this.webglLayer.stateManager.save();for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||(this.beforeRender(u),l.render(u),this.afterRender(u))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(u){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[u.gl.SRC_ALPHA,u.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:u.gl.LESS,cullFace:!1});for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType==="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||l.render(u)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(u){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[u.gl.SRC_ALPHA,u.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:u.gl.LESS,cullFace:!1});for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType==="threeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<d[0]||v>=d[1])||l.render(u)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(u){for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<=d[0]||v>=d[1])||!l.options.enablePicked||!l.options.onClick||!l.pick||(v=l.pick(u.x,u.y,"onClick"),l.options.onClick(v,u),l.options.autoSelect&&this.webglLayer.render())}}}},{key:"onDblClick",value:function(u){for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<=d[0]||v>=d[1])||!l.options.enablePicked||!l.options.onDblClick||!l.pick||(v=l.pick(u.x,u.y,"onDblClick"),l.options.onDblClick(v,u),l.options.autoSelect&&this.webglLayer.render())}}}},{key:"onRightClick",value:function(u){for(var n=0;n<this.layers.length;n++){var l=this.layers[n];if(l._visible===!0&&l.layerType!=="threeLayer"&&l.layerType!=="ThreeLayer"){var v=l.map.getZoom(),d=l.getOptions().zoomThreshold;d&&(v<=d[0]||v>=d[1])||!l.options.enablePicked||!l.options.onRightClick||!l.pick||(v=l.pick(u.x,u.y,"onRightClick"),l.options.onRightClick(v,u),l.options.autoSelect&&this.webglLayer.render())}}}},{key:"onMousemove",value:function(u){for(var n=!1,l=0;l<this.layers.length;l++){var v=this.layers[l];if(v._visible===!0&&v.layerType!=="threeLayer"&&v.layerType!=="ThreeLayer"){var d=v.map.getZoom(),x=v.getOptions().zoomThreshold;(!x||!(d<=x[0]||d>=x[1]))&&v.options.enablePicked&&v.pick&&(v.options.onMousemove||v.options.autoSelect)&&(d=v.pick(u.x,u.y,"onMousemove"),this.webglLayer.map.map.platform.style.cursor=d.dataIndex===-1?"default":"pointer",v.options.onMousemove&&v.options.onMousemove(d,u),v.options.autoSelect&&(n=!0))}}n&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),a}(),wm=function(){function a(u){var n=this;Ke(this,a),this.options={autoUpdate:!0},this._visible=!0,Nr(this.options,u);var l=u.pointOffset;this.webglLayer=u.webglLayer||new Vl(u.map,this.options),this.layerManager=new f1({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new a1(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(v){n._render(v)}),this.webglLayer.onClick=function(v){n._visible&&n.layerManager.onClick(v)},this.webglLayer.onDblClick=function(v){n._visible&&n.layerManager.onDblClick(v)},this.webglLayer.onRightClick=function(v){n._visible&&n.layerManager.onRightClick(v)},this.webglLayer.onMousemove=function(v){n._visible&&n.layerManager.onMousemove(v)},l||this.webglLayer.options.mapType==="cesium"||(l=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[l.lng,l.lat]),this.webglLayer.map.onResize(function(){n.effectManager.onResize()}),(this.postProcessing=u.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),u=this.postProcessing.getThreeLayer(),this.addLayer(u),this.postProcessing.initialize(u),u.postProcessing=this.postProcessing)}return Qe(a,[{key:"renderCanvas",value:function(u){var n=this;this.postProcessing?this.postProcessing.addRender(function(){n.layerManager.renderGLLayers(u)}):this.layerManager.renderGLLayers(u),this.layerManager.renderThreeLayers(u),this.layerManager.renderThreeLayer(u)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(u){var n=this;if(this._visible){var l=this.options.effects;l&&0<l.length?(this.webglRender.render=function(){n.renderCanvas(u)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(u),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(u){this.webglLayer.onRender(u)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(u){this.layerManager.showLayer(u)}},{key:"hideLayer",value:function(u){this.layerManager.hideLayer(u)}},{key:"add",value:function(u){this.addLayer(u)}},{key:"remove",value:function(u){this.removeLayer(u)}},{key:"addLayer",value:function(u){this.layerManager.addLayer(u)}},{key:"removeLayer",value:function(u){this.layerManager.removeLayer(u)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),a}(),Ps=function(){function a(u){Ke(this,a),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=Nr(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=Nr(this.options,u),this.options.data&&(this.data=this.options.data,delete this.options.data)}return Qe(a,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(u){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(u,n){n=n||{},this.data=u,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),n),n.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(u,n){u=u||{},n=n||{};var l=Nr({},this.getOptions());Nr(this.options,u),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),l),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),n),u.data?(this.setData(u.data,n),delete u.data):n.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(u,n){}},{key:"onDataChanged",value:function(u){}},{key:"onChanged",value:function(u,n){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(u,n){}},{key:"setWebglLayer",value:function(u){this.webglLayer=u}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),a}(),Ti=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.pickedColor=[-1,-1,-1],n}return Pr(u,a),Qe(u,[{key:"getCommonDefaultOptions",value:function(){return{pickWidth:1,pickHeight:1,blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(n){var l=this.getOptions();this.gl=n,l.enablePicked&&(this.pickBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var n=[];return this.getOptions().enablePicked&&n.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),n}},{key:"getProperty",value:function(n,l,v){return Object.prototype.toString.call(l)==="[object Function]"?l(v):(l=v[n]||l,"properties"in v&&n in v.properties&&(l=v.properties[n]),l)}},{key:"normizedColor",value:function(n){var l=n;return n instanceof Array||(l=Ot(n).unitArray()),l[3]===void 0&&(l[3]=1),l}},{key:"normizedPoint",value:function(n){var l=this.getPointOffset();if(!n||n[0]===void 0||n[1]===void 0)return[l[0],l[1],0];var v=Number(n[0]),d=Number(n[1]);-180<=v&&180>=v&&-90<=d&&90>=d&&(d=this.webglLayer.map.lnglatToMercator(v,d),v=d[0],d=d[1]);var x=Number(n[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(v=this.convertLngLat([v,d]),x=window.Cesium.Cartesian3.fromDegrees(v[0],v[1],x),v=x.x,d=x.y,x=x.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(v=this.convertLngLat([v,d]),x=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:v[0],lat:v[1]}),v=x.x,d=x.y,x=x.z),3<n.length?[v-l[0],d-l[1],x].concat(Jr(n.slice(3))):[v-l[0],d-l[1],x]}},{key:"convertLngLat",value:function(n){return[n[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(n[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var n=[0,0],l=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?n=this.webglLayer.options.pointOffset:l.pointOffset&&(n=l.pointOffset),n}},{key:"indexToRgb",value:function(n){n++;var l=Math.floor(n/65536);n-=65536*l;var v=Math.floor(n/256);return[n-256*v,v,l]}},{key:"rgbToIndex",value:function(n){for(var l=n.length/4,v=Math.floor(l/2),d=function(U){return n[U]+256*n[U+1]+65536*n[U+2]-1},x=0;;x++){var y=v+x,M=v-x;if(y===M){if(y=d(4*y),-1<y)return y}else{if(y<l){var D=d(4*y);if(-1<D)return D}if(0<=M&&(D=d(4*M),-1<D))return D;if(y>=l&&0>M)break}}return-1}},{key:"getCommonUniforms",value:function(n){n=n.isPickRender;var l=this.getOptions(),v={};if(l.enablePicked){var d=0<=l.selectedIndex?l.selectedIndex:-1;d=l.autoSelect?this.pickedColor:this.indexToRgb(d),v=Nr(v,{uSelectedColor:this.normizedColor(l.selectedColor),uEnablePicked:l.enablePicked,uPickedColor:d.map(function(x){return x/255}),uIsPickRender:!!n})}return v}},{key:"pick",value:function(n,l,v){var d=this.getOptions(),x=this.gl,y=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:x,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var M=new Uint8Array(4*d.pickWidth*d.pickHeight);return x.readPixels(n*y-Math.floor(d.pickWidth/2),x.canvas.height-l*y-Math.floor(d.pickHeight/2),d.pickWidth,d.pickHeight,x.RGBA,x.UNSIGNED_BYTE,M),n=this.rgbToIndex(M),this.pickAfter&&(n=this.pickAfter(M,n+1)),this.setPickedIndex&&this.setPickedIndex(n,v),v=this.getData(),this.pickedColor=[M[0],M[1],M[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:n,dataItem:v[n]}}},{key:"setGLState",value:function(n){this.webglLayer.stateManager.setState(n,this.options)}},{key:"addMultipleCoords",value:function(n,l,v){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[n];var d=this.webglLayer.map.map;l=l||d.getZoom();var x=v?d.worldSize(l):4007545274461451e-8;if(l=function(B){return[[B[0]-x,B[1],B[2]||0],[B[0]+x,B[1],B[2]||0]]},n instanceof Array&&!(n[0]instanceof Array))return l=l(n),l=yi(l,2),[n,l[0],l[1]];if(n instanceof Array&&n[0]instanceof Array&&!(n[0][0]instanceof Array)){v=[],d=[];for(var y=0;y<n.length;y++){var M=l(n[y]);M=yi(M,2);var D=M[1];v.push(M[0]),d.push(D)}return[n,v,d]}for(v=[],d=[],y=0;y<n.length;y++){M=[],D=[];for(var U=0;U<n[y].length;U++){var C=l(n[y][U]);C=yi(C,2);var E=C[1];M.push(C[0]),D.push(E)}v.push(M),d.push(D)}return[n,v,d]}}]),u}(Ps),ad=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="CircleLayer",n.bufferData=[],n.initializeTime=new Date,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,size:10,unit:"px",color:"blue",borderWidth:0,borderColor:"#000000",antialias:!0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new qr(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aBorderWidth;attribute vec4 aBorderColor;varying vec4 vColor;varying vec3 vPosition;varying vec3 vFragPosition;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vBorderWidth=aBorderWidth*uZoomUnits;vBorderColor=aBorderColor;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;vSize=aSize*uZoomUnits+vBorderWidth;if(aIndex==1.0){x+=vSize;y-=vSize;}else if(aIndex==2.0){x-=vSize;y+=vSize;}else if(aIndex==3.0){x+=vSize;y+=vSize;}else{x-=vSize;y-=vSize;}vPosition=aPos;vFragPosition=vec3(x,y,z);gl_Position=uMatrix*vec4(vFragPosition,1.0);
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec3 vPosition;varying float vSize;varying vec3 vFragPosition;varying vec4 vColor;varying float vBorderWidth;varying vec4 vBorderColor;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float lineWidth;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>vSize){discard;}vec4 color=vColor;float r=vSize-vBorderWidth;if(vBorderWidth>0.0){if(d>r){color=vBorderColor;}else if(uAntiAliasing==1.0&&d>0.95*r){color=vBorderColor;float st=1.0-smoothstep(0.95*r,r,d);color.r+=(vColor.r-vBorderColor.r)*st;color.g+=(vColor.g-vBorderColor.g)*st;color.b+=(vColor.b-vBorderColor.b)*st;color.a+=(vColor.a-vBorderColor.a)*st;}}if(uAntiAliasing==1.0&&d>0.95*vSize&&d<=vSize){color.a*=1.0-smoothstep(0.95*vSize,vSize,d);}gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=Float32Array.BYTES_PER_ELEMENT;var v=14*l;l=[{stride:v,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:v,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:3*l},{stride:v,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:4*l},{stride:v,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:5*l},{stride:v,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:9*l},{stride:v,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:10*l}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={},this.data=l,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=this,l=[],v=[];this.data.forEach(function(d,x){var y=d.properties||{},M=function(O){return d[O]||y[O]||n.options[O]},D=M("color"),U=M("size"),C=M("borderWidth");M=M("borderColor"),D=n.normizedColor(D),M=n.normizedColor(M);for(var E=n.normizedPoint(d.geometry.coordinates),B=0;4>B;B++)l.push(E[0],E[1],E[2]||0,U,B),l.push(D[0],D[1],D[2],D[3]),l.push(C,M[0],M[1],M[2],M[3]);D=4*x,0<x&&v.push(D-1,D),v.push(D,D+1,D+2,D+3)}),this.bufferData=l,this.indexData=v,this.buffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v))}},{key:"parsePickData",value:function(n){var l=[];if(this.getOptions().enablePicked){for(var v=0;v<n.length;v++){var d=this.indexToRgb(v);l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255)}this.pickBuffer.updateData(new Float32Array(l))}}},{key:"render",value:function(n){var l=this.getOptions(),v=this.program,d=n.gl,x=n.matrix;this.setGLState({blend:!0,blendEquation:d.FUNC_ADD,blendFunc:so(d,l.blend||"lighter"),depthTest:l.depthTest,depthMask:l.depthWrite}),v.use(d),this.vertexArray.bind(),this.indexBuffer.bind(),l=this.map.getZoomUnits(),Nr(this.uniforms,this.getCommonUniforms(n),{uZoomUnits:this.options.unit==="px"?l:1,uMatrix:x,uAntiAliasing:this.options.antialias?1:0}),v.setUniforms(this.uniforms),d.drawElements(d.TRIANGLE_STRIP,this.indexData.length,d.UNSIGNED_INT,0)}}]),u}(Ti),Mm={wave:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;float R=vRadius;float center=vSize;float time=vStartTime+uTime;float alpha=sin((R-d)/R*trail*2.0*3.14+time/duration);if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){if(alpha>=0.5){color.a=0.9;}else{color.a=1.0-smoothstep(0.9*center,center,d);}}}else{if(alpha>=0.5){color.a=0.9;if(uAntiAliasing==1.0){if(alpha>=0.5&&alpha<=0.6){color.a*=smoothstep(0.0,0.1,alpha-0.5);}if(d>=0.98*R&&d<=R){color.a*=1.0-smoothstep(0.98,1.0,d/R);}}}else{color.a=0.0;}}gl_FragColor=color;}",bubble:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}float center=vSize;float R=vRadius;float r=R*percent;vec4 color=vColor;if(d<=center){if(uAntiAliasing==1.0&&d>0.9*center&&d<=center){color.a=1.0-smoothstep(0.9*center,center,d);}}else{if(d<r){color.a=smoothstep(0.1,0.9,pow(d/r,2.0)*0.9);if(uAntiAliasing==1.0&&d>=0.9*r&&d<=r){color.a*=1.0-smoothstep(0.9,1.0,d/r);}if(range>duration){color.a*=1.0-(range-duration)/trail;}}else{color.a=0.0;}}gl_FragColor=color;}",breath:"varying vec4 vPosition;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}vec4 color=vColor;if(uAntiAliasing==1.0&&d>0.9*vRadius&&d<=vRadius){color.a=1.0-smoothstep(0.9*vRadius,vRadius,d);}float time=vStartTime+uTime;float range=mod(time,(duration+trail));float percent=0.0;if(range<=duration){percent=range/duration;}else{percent=1.0;}color.a*=abs(1.0-percent*2.0)+0.2;gl_FragColor=color;}",radar:"varying vec4 vPosition;varying float vSize;varying vec4 vFragPosition;varying vec4 vColor;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uTime;uniform float duration;uniform float trail;uniform float uAntiAliasing;varying float vWidth;void main(){float d=distance(vFragPosition.xy,vPosition.xy);if(d>=vRadius){discard;}float time=vStartTime+uTime;float range=mod(time,duration);float percent=range/duration;float center=vSize;float startDeg=360.0*percent;vec4 color=vColor;float deltaX=vFragPosition.x-vPosition.x;float deltaY=vFragPosition.y-vPosition.y;float currDeg=degrees(atan(deltaX/deltaY));if(deltaX>=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY<=0.0){currDeg=180.0+currDeg;}if(deltaX<=0.0&&deltaY>=0.0){currDeg=360.0+currDeg;}float maxDeg=trail;if(trail<0.0){currDeg=-currDeg;maxDeg=-trail;}float modDeg=mod((currDeg-startDeg),360.0);if(modDeg<maxDeg){color.a=modDeg/maxDeg;}else{color.a=0.0;}if(uAntiAliasing==1.0&&d>0.95*vRadius&&d<=vRadius){color.a=color.a-smoothstep(0.95*vRadius,vRadius,d);}gl_FragColor=color;}"},mf=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="RippleCircleLayer",n.autoUpdate=!0,n.bufferData=[],n.initializeTime=new Date,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){var n=1;return this.options.type==="radar"&&(n=120),{depthWrite:!1,depthTest:!0,type:"bubble",size:10,duration:1,trail:n,unit:"px",random:!0,color:"blue",antialias:!0,radius:function(l){return 2*l}}}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:`attribute vec3 aPos;attribute float aSize;attribute float aIndex;attribute vec4 aColor;attribute float aStartTime;attribute float aRadius;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vWidth;varying float vStartTime;varying float vRadius;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vStartTime=aStartTime;vSize=aSize*uZoomUnits;vRadius=aRadius*uZoomUnits;float x=aPos.x;float y=aPos.y;float z=aPos.z*uZoomUnits;float R=vRadius;if(aIndex==1.0){x+=R;y-=R;}else if(aIndex==2.0){x-=R;y+=R;}else if(aIndex==3.0){x+=R;y+=R;}else{x-=R;y-=R;}vPosition=vec4(aPos.xy,z,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:Mm[this.options.type]||"bubble",defines:this.options.enablePicked?["PICK"]:[]},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var l=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:20},{stride:44,name:"aRadius",buffer:this.buffer,size:1,type:"FLOAT",offset:36},{stride:44,name:"aStartTime",buffer:this.buffer,size:1,type:"FLOAT",offset:40}];l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={duration:n.duration,trail:n.trail},this.data=l,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=this,l=[],v=[];this.data.forEach(function(d,x){var y=d.size||n.options.size,M=d.radius||n.options.radius||1.618*y;typeof M=="function"&&(M=M(y));var D=d.color||n.options.color;D=n.normizedColor(D),d=n.normizedPoint(d.geometry.coordinates);for(var U=n.options.random?Math.random()*n.data.length*9999:0,C=0;4>C;C++)l.push(d[0],d[1],d[2]||0,y,C),l.push(D[0],D[1],D[2],D[3]),l.push(M),l.push(U);y=4*x,0<x&&v.push(y-1,y),v.push(y,y+1,y+2,y+3)}),this.bufferData=l,this.indexData=v,this.buffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v))}},{key:"parsePickData",value:function(n){var l=[];if(this.getOptions().enablePicked){for(var v=0;v<n.length;v++){var d=this.indexToRgb(v);l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255),l.push(d[0]/255,d[1]/255,d[2]/255)}this.pickBuffer.updateData(new Float32Array(l))}}},{key:"render",value:function(n){var l=this.getOptions(),v=this.program,d=n.gl,x=n.matrix;v.use(d);var y=this.map.getZoomUnits();Nr(this.uniforms,this.getCommonUniforms(n),{uTime:(new Date-this.initializeTime)/1e3,uZoomUnits:l.unit==="m"?1:y,uMatrix:x,uAntiAliasing:l.antialias?1:0}),v.setUniforms(this.uniforms),this.setGLState({blend:!0,blendEquation:d.FUNC_ADD,blendFunc:so(d,l.blend||"lighter"),depthTest:l.depthTest,depthMask:l.depthWrite}),0<this.indexData.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),d.drawElements(d.TRIANGLE_STRIP,this.indexData.length,d.UNSIGNED_INT,0))}}]),u}(Ti),ud=dn(Mm),p1=It(function(a,u){u.__esModule=!0;var n=ao&&ao.__esModule?ao:{default:ao},l=Dh&&Dh.__esModule?Dh:{default:Dh};u.default=function v(d,x,y){d===null&&(d=Function.prototype);var M=(0,l.default)(d,x);if(M===void 0){if(d=(0,n.default)(d),d!==null)return v(d,x,y)}else return"value"in M?M.value:(x=M.get,x===void 0?void 0:x.call(y))}}),Ds=zt(p1);We.deviation=function(a,u,n,l){var v=u&&u.length,d=Math.abs(Bg(a,0,v?u[0]*n:a.length,n));if(v){v=0;for(var x=u.length;v<x;v++)d-=Math.abs(Bg(a,u[v]*n,v<x-1?u[v+1]*n:a.length,n))}for(v=u=0;v<l.length;v+=3){x=l[v]*n;var y=l[v+1]*n,M=l[v+2]*n;u+=Math.abs((a[x]-a[M])*(a[y+1]-a[x+1])-(a[x]-a[y])*(a[M+1]-a[x+1]))}return d===0&&u===0?0:Math.abs((u-d)/d)},We.flatten=function(a){for(var u=a[0][0].length,n={vertices:[],holes:[],dimensions:u},l=0,v=0;v<a.length;v++){for(var d=0;d<a[v].length;d++)for(var x=0;x<u;x++)n.vertices.push(a[v][d][x]);0<v&&(l+=a[v-1].length,n.holes.push(l))}return n},We.default=We;var d1=typeof R0=="undefined"?"__target":R0(),sA=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,Za=window.URL||window.webkitURL,ku=window.Worker;if(ku){var ld=qv("self.onmessage = function () {}"),g1=new Uint8Array(1);try{if(/(?:Trident|Edge)\/(?:[567]|12)/i.test(navigator.userAgent))throw Error("Not available");var hd=new ku(ld);hd.postMessage(g1,[g1.buffer])}catch(a){ku=null}finally{Za.revokeObjectURL(ld),hd&&hd.terminate()}}var aA=new function(a,u){return function(n){var l=this;if(u){if(ku&&!n)return n=(""+u).replace(/^function.+?{/,"").slice(0,-1),n=qv(n),this[d1]=new ku(n),Za.revokeObjectURL(n),this[d1];var v={postMessage:function(d){l.onmessage&&setTimeout(function(){return l.onmessage({data:d,target:v})})}};u.call(v),this.postMessage=function(d){setTimeout(function(){return v.onmessage({data:d,target:l})})},this.isThisThread=!0}else return new ku(a)}}("./worker.js",function(a,u){}),m1={window:1,windowAnimation:2,gradual:3,ripple:4,water:6,repeat:7},xi=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="ShapeLayer",n._isShow=!0,l=n.getOptions(),(l.style==="windowAnimation"||l.style==="ripple"||0<l.riseTime)&&(n.autoUpdate=!0),n.selectedColor=[-1,-1,-1],n.textureCache={},n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(50, 50, 230, 1.0)",opacity:1,height:0,isTextureFull:!1,topColor:"rgba(76, 76, 76, 0.8)",textureRotate:0,textureScale:1,useLight:!0,useTopColor:!1,riseTime:0,polygonOffset:[0,0],depthTest:!0,zIndex:0,zFightFactor:0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.dataMgr=new gl(this,this.gl),this.texture=null,this.isUseTexture=!1;var v=[];l.enablePicked&&v.push("PICK"),l.texture&&v.push("USE_TEXTURE"),this.program=new qr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;attribute vec4 a_pos;attribute vec3 a_normal;attribute vec4 a_color;attribute vec4 a_pre_color;attribute float a_height;attribute float a_pre_height;attribute float a_block_index;
#if defined(USE_TEXTURE)
attribute vec2 a_texture_coord;
#endif
uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform mat4 u_normal_matrix;uniform vec3 u_side_light_dir;uniform bool u_use_lighting;uniform bool u_use_texture;uniform vec3 u_ripple_center;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform float dataTime;uniform float riseTime;uniform vec2 uMapCenter;uniform float uMapZoom;uniform float u_zIndex;uniform float u_zFightFactor;varying float v_height;varying vec4 v_color;varying vec3 v_position;varying vec2 v_texture_coord;const vec3 point_color=vec3(0.06,0.06,0.06);const vec3 light_color=vec3(0.53,0.53,0.53);const vec3 light_color_2=vec3(0.4,0.4,0.4);const vec3 uAmbientColor=vec3(0.8,0.8,0.8);const vec3 uLightingDirection=vec3(0.0,1.0,1.0);const vec3 uDirectionalColor=vec3(1.0,1.0,1.0);float getTransitionValue(float pre_value,float to_value,float dataTime,float riseTime){float result=0.0;if(pre_value==to_value){result=to_value;}else{if(riseTime>0.0&&dataTime<riseTime){result=(pre_value+(to_value-pre_value)*(dataTime/riseTime));}else{result=to_value;}}return result;}void main(){vec4 pos=a_pos;pos.z=pos.z+pos.w*getTransitionValue(a_pre_height,a_height,dataTime,riseTime);v_position=pos.xyz;v_height=a_height;
#if defined(USE_TEXTURE)
if(u_use_texture){v_texture_coord=a_texture_coord;}
#endif
pos.z+=u_zIndex;vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos.xyz,1.0);gl_Position=position;if(u_zFightFactor>0.){float v_z_offset=-a_block_index/u_zFightFactor;gl_Position.z=gl_Position.z+v_z_offset;}vec4 icolor=a_color;
#if defined(PICK)
if(mapvIsPicked()){icolor=uSelectedColor;}
#endif
if(u_use_lighting){vec3 N=normalize(vec3(u_normal_matrix*vec4(a_normal,1.0)));vec4 point_dir=u_mv_matrix*vec4(0,1,0,0);vec3 L_point=normalize(point_dir.xyz);float lambert_point=max(0.0,dot(N,-L_point));vec4 light_dir=u_mv_matrix*vec4(u_side_light_dir,0);vec3 L=normalize(light_dir.xyz);float lambert=max(0.0,dot(N,-L));if(pos.z<5.0){float deepGradientColor=(5.0-pos.z)/8.0;lambert=lambert-deepGradientColor;}vec4 light_dir_2=u_mv_matrix*vec4(0,0,-1,0);vec3 L2=normalize(light_dir_2.xyz);float lambert_2=max(0.0,dot(N,-L2));if(a_pre_color.r==a_color.r&&a_pre_color.g==a_color.g&&a_pre_color.b==a_color.b){}else{if(riseTime>0.0&&dataTime<riseTime){icolor.r=a_pre_color.r+(a_color.r-a_pre_color.r)*(dataTime/riseTime);icolor.g=a_pre_color.g+(a_color.g-a_pre_color.g)*(dataTime/riseTime);icolor.b=a_pre_color.b+(a_color.b-a_pre_color.b)*(dataTime/riseTime);}}v_color.rgb=icolor.rgb+icolor.rgb*light_color*lambert+icolor.rgb*light_color_2*lambert_2+icolor.rgb*point_color*lambert_point;v_color.a=icolor.a;if(u_use_texture){mat3 normalMatrix=mat3(u_normal_matrix);vec3 transformedNormal=normalMatrix*a_normal;vec3 dir=uLightingDirection;dir=vec3(normalMatrix*vec3(0.0,-1.0,2.0));float directionalLightWeighting=max(dot(normalize(transformedNormal),normalize(dir)),0.0);vec4 vLightWeighting;vLightWeighting=vec4(uAmbientColor+uDirectionalColor*directionalLightWeighting,1.0);v_color=vLightWeighting;}}else{v_color=icolor;}}`,fragmentShader:"precision highp float;varying vec4 v_color;varying vec3 v_position;varying float v_height;varying vec2 v_texture_coord;uniform vec3 u_ripple_center;uniform vec4 top_color;uniform float u_zoom_units;uniform float u_radius;uniform float style;uniform float alpha;uniform float time;uniform sampler2D u_sampler;uniform bool u_use_lighting;uniform bool u_use_texture;uniform bool u_use_top_color;void main(){vec4 color=vec4(v_color);vec4 textureColor=vec4(1.0,1.0,1.0,1.0);if(u_use_texture){if(style==6.0){float x=v_texture_coord.s;float y=v_texture_coord.t;vec2 cPos=-1.0+2.0*gl_FragCoord.xy/MAPV_resolution;float cLength=length(cPos);vec2 uv=gl_FragCoord.xy/MAPV_resolution+(cPos/cLength)*cos(cLength*12.0-time/1000.0*4.0)*0.03;textureColor=texture2D(u_sampler,uv/2.0+vec2(x,y));}else if(style==7.0){float tWidth=1.*u_zoom_units;float deltaX=mod(v_texture_coord.x,tWidth);float deltaY=mod(v_texture_coord.y,tWidth);if(deltaX>=0.&&deltaX<=tWidth){vec2 uv=vec2(deltaX,deltaY)/tWidth;vec4 texture=texture2D(u_sampler,uv);textureColor=texture.a>=0.1 ? texture : vec4(0.,0.,0.,0.);}}else{textureColor=texture2D(u_sampler,vec2(v_texture_coord.s,v_texture_coord.t));}if(u_use_lighting){color=vec4(textureColor*v_color*1.1);}else{color=textureColor;}}if(u_use_top_color&&v_position.z>=v_height){color=top_color;}if(style==1.0||style==2.0){float t=time/1000.0;float diffDistance=5.0;float modX=mod(v_position.x,diffDistance*2.0);float modZ=mod(v_position.z,diffDistance*2.0);if(modX<diffDistance&&modZ<diffDistance&&v_position.z<v_height){color*=1.05;if(time>0.0&&style==2.0){float iX=ceil(v_position.x/diffDistance);float iZ=ceil(v_position.z/diffDistance);float timeDistance=8.0;t+=tan(sin(iZ));color*=(1.0+mod(t,timeDistance)/timeDistance);}}}else if(style==5.0){float t=time/1000.0;float diffDistance=10.0;float modZ=mod(v_position.z-t*40.0,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.5);if(v_position.z/v_height<0.3){color.r+=0.2;color.g+=0.2;color.b+=0.2;}if(modZ<diffDistance*2.0-4.0){discard;}}else if(style==3.0){float diffDistance=10.0;float modX=mod(v_position.x,diffDistance*2.0);color.a=1.0-pow(v_position.z/v_height,0.3);}else if(style==4.0){float dis=distance(u_ripple_center,v_position);float rSize=400.0;if(v_position.z>=v_height){color=top_color;}if(dis>u_radius-rSize&&dis<u_radius+rSize){color*=(1.0-abs(dis-u_radius)/rSize)*2.0+1.0;}}else if(style==6.0){}color.a*=alpha;gl_FragColor=color;}",defines:v},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.heightBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.textureBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{name:"a_pos",buffer:this.vertexBuffer,stride:28,size:4,type:"FLOAT",offset:0},{name:"a_normal",buffer:this.vertexBuffer,size:3,stride:28,type:"FLOAT",offset:16},{name:"a_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:0},{name:"a_pre_color",buffer:this.colorBuffer,size:4,stride:32,type:"FLOAT",offset:16},{name:"a_height",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:0},{name:"a_pre_height",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:4},{name:"a_block_index",buffer:this.heightBuffer,size:1,stride:12,type:"FLOAT",offset:8}],l.texture&&v.push({name:"a_texture_coord",buffer:this.textureBuffer,size:2,stride:8,type:"FLOAT",offset:0}),v=v.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:v}),this.initializeTime=new Date,this.normalMatrix=or.create()}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.dataMgr.parseData(l),v.dataTime=new Date,v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix,d=n.viewMatrix;if(this._isShow){var x=this.getData();if(x&&!(0>=x.length)){x=this.getOptions();var y=this.program;if(y.use(l),!x.texture||this.texture){var M=0;x.style&&m1[x.style]&&(M=m1[x.style]);var D=[l.ONE,l.ZERO];if(x.blend&&(D=so(l,x.blend)),(x.height===0||x.style==="gradual")&&(D=[l.ONE,l.ONE_MINUS_SRC_ALPHA]),this.setGLState({cullFace:!1,blend:!0,blendEquation:l.FUNC_ADD,blendFunc:D,polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.style!=="gradual"}),D=this.normizedColor(x.topColor),x.style==="ripple"&&x.rippleLayer&&x.rippleLayer.data&&x.rippleLayer.data[0]){var U=this.normizedPoint(x.rippleLayer.data[0].geometry.coordinates);y.setUniforms({u_ripple_center:[U[0],U[1],0],u_radius:x.rippleLayer.options.size*x.rippleLayer.currentScale})}U=Or.fromValues(0,-1,2),x.lightDir&&(U=Or.fromValues(x.lightDir[0],x.lightDir[1],x.lightDir[2]));var C=this.normalMatrix;or.invert(C,d),or.transpose(C,C),y.setUniforms(Nr(this.getCommonUniforms(n),{u_normal_matrix:C,u_sampler:this.texture,u_proj_matrix:v,u_mv_matrix:d,u_zoom_units:this.map.getZoomUnits(),style:M,u_use_top_color:x.useTopColor,top_color:D,u_use_lighting:x.useLight,u_use_texture:this.isUseTexture,alpha:parseFloat(x.opacity),time:new Date-this.initializeTime,dataTime:new Date-this.dataTime,riseTime:x.riseTime,u_side_light_dir:U,u_zIndex:x.zIndex,u_zFightFactor:x.zFightFactor})),n=this.dataMgr.getData(),0<n.vertex.length&&(this.vertexArray.bind(),this.indexBuffer.bind(),l.drawElements(l.TRIANGLES,n.index.length,l.UNSIGNED_INT,0))}}}else this.webglLayer.clear()}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?(this.isUseTexture=!0,sn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,n&&n())}}]),u}(Ti);gl.prototype.initData=function(){this.outBuilding3d={pickColorVertex:[],vertex:[],texture:[],color:[],height:[],index:[]}},gl.prototype.getData=function(){return this.outBuilding3d},gl.prototype.initWorker=function(){this.worker=new aA,this.worker.onmessage=function(a){}},gl.prototype.parseData=function(a){var u=this;this.initData();for(var n=this.shapeLayer.getOptions(),l=0;l<a.length;l++){var v=a[l],d=v.height||n.height;"properties"in v&&"height"in v.properties&&(d=v.properties.height),d*=1;var x=v.color||n.color;"properties"in v&&"color"in v.properties&&(x=v.properties.color),"properties"in v&&"fillColor"in v.properties&&(x=v.properties.fillColor),Object.prototype.toString.call(x)==="[object Function]"&&(x=x(v)),x=this.shapeLayer.normizedColor(x);var y=this.shapeLayer.getProperty("angle",n.textureRotate,v),M=void 0;n.enablePicked&&(M=this.shapeLayer.indexToRgb(l));var D=void 0,U=void 0;if(n.riseTime&&(U=v.preColor,"properties"in v&&"preColor"in v.properties&&(U=v.properties.preColor),D=v.preHeight,"properties"in v&&"preHeight"in v.properties&&(D=v.properties.preHeight),D===void 0&&(D=0)),v.geometry.coordinates){if(v.geometry.type==="LineString"){var C=v.geometry.coordinates.map(function(G){return u.shapeLayer.normizedPoint(G)}),E=We.flatten([C]);C=E.vertices,E=E.holes;for(var B=[],O=[],H=0;H<C.length;H+=3)B.push(C[H+0],C[H+1]),O.push(C[H+2]);this.parseBuilding3d(this.outBuilding3d,B,O,D,d,U,x,M,y,E,l)}if(v.geometry.type==="MultiPolygon"){for(C=v.geometry.coordinates,v=[],E=0;E<C.length;E++)v.push(C[E].map(function(G){return G.map(function(j){return u.shapeLayer.normizedPoint(j)})}));for(C=0;C<v.length;C++){E=[],B=[],H=We.flatten(v[C]),O=H.vertices,H=H.holes;for(var V=0;V<O.length;V+=3)E.push(O[V+0],O[V+1]),B.push(O[V+2]);this.parseBuilding3d(this.outBuilding3d,E,B,D,d,U,x,M,y,H,l)}}else{for(C=[],E=0;E<v.geometry.coordinates.length;E++)C.push(v.geometry.coordinates[E].map(function(G){return u.shapeLayer.normizedPoint(G)}));for(C=We.flatten(C),v=C.vertices,C=C.holes,E=[],B=[],O=0;O<v.length;O+=3)E.push(v[O+0],v[O+1]),B.push(v[O+2]);this.parseBuilding3d(this.outBuilding3d,E,B,D,d,U,x,M,y,C,l)}}}this.shapeLayer.vertexBuffer.updateData(new Float32Array(this.outBuilding3d.vertex)),this.shapeLayer.colorBuffer.updateData(new Float32Array(this.outBuilding3d.color)),this.shapeLayer.heightBuffer.updateData(new Float32Array(this.outBuilding3d.height)),this.shapeLayer.textureBuffer.updateData(new Float32Array(this.outBuilding3d.texture)),this.shapeLayer.indexBuffer.updateData(new Uint32Array(this.outBuilding3d.index)),n.enablePicked&&this.shapeLayer.pickBuffer.updateData(new Float32Array(this.outBuilding3d.pickColorVertex))},gl.prototype.getBounds=function(a,u){for(var n=a[0],l=a[1],v=a[0],d=a[1],x=0;x<a.length;x+=2)n=Math.min(a[x],n),l=Math.min(a[x+1],l),v=Math.max(a[x],v),d=Math.max(a[x+1],d);if(x=[(v-n)/2+n,(d-l)/2+l],u===0||!u)return{minX:n,minY:l,maxX:v,maxY:d,width:v-n,height:d-l,center:x};for(n=a.slice(0),l=0;l<n.length;l+=2)v=Kv(a[l],a[l+1],x,u),n[l]=v[0],n[l+1]=v[1];return this.getBounds(n,0)},gl.prototype.parseBuilding3d=function(a,u,n,l,v,d,x,y,M,D,U){l===void 0&&(l=v);var C=this.shapeLayer.options,E=a.vertex,B=a.texture,O=a.color,H=a.height,V=a.pickColorVertex;a=a.index,d===void 0&&(d=x);var G=0,j=0;if(this.shapeLayer.image&&(G=this.shapeLayer.image.width*C.textureScale,j=this.shapeLayer.image.height*C.textureScale),C.style!=="gradual"){D=D&&D.length?We(u,D,2):We(u);var Y=D[0],$=D[1],it=D[2];Y=[u[2*Y],u[2*Y+1],1],$=[u[2*$],u[2*$+1],1];var nt=[u[2*it],u[2*it+1],1];it=[],Or.cross(it,[nt[0]-$[0],nt[1]-$[1],nt[2]-$[2]],[Y[0]-$[0],Y[1]-$[1],Y[2]-$[2]]),$=E.length/7;var pt;C.texture&&(pt=this.getBounds(u,M)),Y=C.isTextureFull,nt=0;for(var Rt=u.length;nt<Rt;nt+=2){if(E.push(u[nt],u[nt+1],n[nt/2],1,it[0],it[1],it[2]),O.push(x[0],x[1],x[2],x[3],d[0],d[1],d[2],d[3]),H.push(v,l,U),C.texture){var Et=Kv(u[nt],u[nt+1],pt.center,M),Jt=yi(Et,2);Et=Jt[0],Jt=Jt[1],Y?(Et=(Et-pt.minX)/pt.width,Jt=(Jt-pt.minY)/pt.height):(Et=(Et-pt.minX)/G,Jt=(Jt-pt.minY)/j),B.push(Et,Jt)}y&&V.push(y[0]/255,y[1]/255,y[2]/255)}for(M=0,pt=D.length;M<pt;M++)a.push(D[M]+$)}if(!(v===l&&0>=v))for(M=0,D=u.length;M<D;M+=2)pt=E.length/7,Rt=u[M],Et=u[M+1],it=[Rt,Et,n[M/2],0],$=[Rt,Et,n[M/2],1],nt=M+2,Jt=M+3,M===D-2&&(nt=0,Jt=1),nt=u[nt],Jt=u[Jt],Rt=Math.sqrt(Math.pow(nt-Rt,2),Math.pow(Jt-Et,2)),Et=[nt,Jt,n[M/2],0],nt=[nt,Jt,n[M/2],1],Jt=[],Or.cross(Jt,[Et[0]-it[0],Et[1]-it[1],Et[2]-it[2]],[$[0]-it[0],$[1]-it[1],$[2]-it[2]]),E.push(it[0],it[1],it[2],it[3]),E.push(Jt[0],Jt[1],Jt[2]),E.push($[0],$[1],$[2],$[3]),E.push(Jt[0],Jt[1],Jt[2]),E.push(Et[0],Et[1],Et[2],Et[3]),E.push(Jt[0],Jt[1],Jt[2]),E.push(nt[0],nt[1],nt[2],nt[3]),E.push(Jt[0],Jt[1],Jt[2]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),O.push(x[0],x[1],x[2],x[3]),O.push(d[0],d[1],d[2],d[3]),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),H.push(v),H.push(l),H.push(U),C.texture&&(Y?(B.push(0,0),B.push(0,1),B.push(1,0),B.push(1,1)):(B.push(0,0),B.push(0,v/j),B.push(Rt/G,0),B.push(Rt/G,v/j))),y&&(V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255),V.push(y[0]/255,y[1]/255,y[2]/255)),a.push(pt,pt+2,pt+3,pt,pt+3,pt+1)};var Os=It(function(a,u){(function(n,l){a.exports=l()})(zg,function(){function n(G,j,Y,$,it){for(;$>Y;){if(600<$-Y){var nt=$-Y+1,pt=j-Y+1,Rt=Math.log(nt),Et=.5*Math.exp(2*Rt/3);Rt=.5*Math.sqrt(Rt*Et*(nt-Et)/nt)*(0>pt-nt/2?-1:1),n(G,j,Math.max(Y,Math.floor(j-pt*Et/nt+Rt)),Math.min($,Math.floor(j+(nt-pt)*Et/nt+Rt)),it)}for(nt=G[j],pt=Y,Et=$,l(G,Y,j),0<it(G[$],nt)&&l(G,Y,$);pt<Et;){for(l(G,pt,Et),pt++,Et--;0>it(G[pt],nt);)pt++;for(;0<it(G[Et],nt);)Et--}it(G[Y],nt)===0?l(G,Y,Et):(Et++,l(G,Et,$)),Et<=j&&(Y=Et+1),j<=Et&&($=Et-1)}}function l(G,j,Y){var $=G[j];G[j]=G[Y],G[Y]=$}function v(G,j){return G<j?-1:G>j?1:0}function d(G,j){x(G,0,G.children.length,j,G)}function x(G,j,Y,$,it){for(it||(it=O(null)),it.minX=1/0,it.minY=1/0,it.maxX=-1/0,it.maxY=-1/0;j<Y;j++){var nt=G.children[j];y(it,G.leaf?$(nt):nt)}return it}function y(G,j){return G.minX=Math.min(G.minX,j.minX),G.minY=Math.min(G.minY,j.minY),G.maxX=Math.max(G.maxX,j.maxX),G.maxY=Math.max(G.maxY,j.maxY),G}function M(G,j){return G.minX-j.minX}function D(G,j){return G.minY-j.minY}function U(G){return(G.maxX-G.minX)*(G.maxY-G.minY)}function C(G){return G.maxX-G.minX+(G.maxY-G.minY)}function E(G,j){return G.minX<=j.minX&&G.minY<=j.minY&&j.maxX<=G.maxX&&j.maxY<=G.maxY}function B(G,j){return j.minX<=G.maxX&&j.minY<=G.maxY&&j.maxX>=G.minX&&j.maxY>=G.minY}function O(G){return{children:G,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function H(G,j,Y,$,it){for(var nt=[j,Y];nt.length;)if(Y=nt.pop(),j=nt.pop(),!(Y-j<=$)){var pt=j+Math.ceil((Y-j)/$/2)*$;n(G,pt,j||0,Y||G.length-1,it||v),nt.push(j,pt,pt,Y)}}var V=function(G){G===void 0&&(G=9),this._maxEntries=Math.max(4,G),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};return V.prototype.all=function(){return this._all(this.data,[])},V.prototype.search=function(G){var j=this.data,Y=[];if(!B(G,j))return Y;for(var $=this.toBBox,it=[];j;){for(var nt=0;nt<j.children.length;nt++){var pt=j.children[nt],Rt=j.leaf?$(pt):pt;B(G,Rt)&&(j.leaf?Y.push(pt):E(G,Rt)?this._all(pt,Y):it.push(pt))}j=it.pop()}return Y},V.prototype.collides=function(G){var j=this.data;if(!B(G,j))return!1;for(var Y=[];j;){for(var $=0;$<j.children.length;$++){var it=j.children[$],nt=j.leaf?this.toBBox(it):it;if(B(G,nt)){if(j.leaf||E(G,nt))return!0;Y.push(it)}}j=Y.pop()}return!1},V.prototype.load=function(G){if(!G||!G.length)return this;if(G.length<this._minEntries){for(var j=0;j<G.length;j++)this.insert(G[j]);return this}return G=this._build(G.slice(),0,G.length-1,0),this.data.children.length?this.data.height===G.height?this._splitRoot(this.data,G):(this.data.height<G.height&&(j=this.data,this.data=G,G=j),this._insert(G,this.data.height-G.height-1,!0)):this.data=G,this},V.prototype.insert=function(G){return G&&this._insert(G,this.data.height-1),this},V.prototype.clear=function(){return this.data=O([]),this},V.prototype.remove=function(G,j){if(!G)return this;for(var Y=this.data,$=this.toBBox(G),it=[],nt=[],pt,Rt,Et;Y||it.length;){if(Y||(Y=it.pop(),Rt=it[it.length-1],pt=nt.pop(),Et=!0),Y.leaf){t:{var Jt=G,oe=Y.children,Se=j;if(Se){for(var ge=0;ge<oe.length;ge++)if(Se(Jt,oe[ge])){Jt=ge;break t}Jt=-1}else Jt=oe.indexOf(Jt)}if(Jt!==-1){Y.children.splice(Jt,1),it.push(Y),this._condense(it);break}}Et||Y.leaf||!E(Y,$)?Rt?(pt++,Y=Rt.children[pt],Et=!1):Y=null:(it.push(Y),nt.push(pt),pt=0,Rt=Y,Y=Y.children[0])}return this},V.prototype.toBBox=function(G){return G},V.prototype.compareMinX=function(G,j){return G.minX-j.minX},V.prototype.compareMinY=function(G,j){return G.minY-j.minY},V.prototype.toJSON=function(){return this.data},V.prototype.fromJSON=function(G){return this.data=G,this},V.prototype._all=function(G,j){for(var Y=[];G;)G.leaf?j.push.apply(j,G.children):Y.push.apply(Y,G.children),G=Y.pop();return j},V.prototype._build=function(G,j,Y,$){var it=Y-j+1,nt=this._maxEntries;if(it<=nt){var pt=O(G.slice(j,Y+1));return d(pt,this.toBBox),pt}for($||($=Math.ceil(Math.log(it)/Math.log(nt)),nt=Math.ceil(it/Math.pow(nt,$-1))),pt=O([]),pt.leaf=!1,pt.height=$,it=Math.ceil(it/nt),nt=it*Math.ceil(Math.sqrt(nt)),H(G,j,Y,nt,this.compareMinX);j<=Y;j+=nt){var Rt=Math.min(j+nt-1,Y);H(G,j,Rt,it,this.compareMinY);for(var Et=j;Et<=Rt;Et+=it)pt.children.push(this._build(G,Et,Math.min(Et+it-1,Rt),$-1))}return d(pt,this.toBBox),pt},V.prototype._chooseSubtree=function(G,j,Y,$){for(;$.push(j),!(j.leaf||$.length-1===Y);){for(var it=1/0,nt=1/0,pt=void 0,Rt=0;Rt<j.children.length;Rt++){var Et=j.children[Rt],Jt=U(Et),oe=(Math.max(Et.maxX,G.maxX)-Math.min(Et.minX,G.minX))*(Math.max(Et.maxY,G.maxY)-Math.min(Et.minY,G.minY))-Jt;oe<nt?(nt=oe,it=Jt<it?Jt:it,pt=Et):oe===nt&&Jt<it&&(it=Jt,pt=Et)}j=pt||j.children[0]}return j},V.prototype._insert=function(G,j,Y){Y=Y?G:this.toBBox(G);var $=[],it=this._chooseSubtree(Y,this.data,j,$);for(it.children.push(G),y(it,Y);0<=j&&$[j].children.length>this._maxEntries;)this._split($,j),j--;this._adjustParentBBoxes(Y,$,j)},V.prototype._split=function(G,j){var Y=G[j],$=Y.children.length,it=this._minEntries;this._chooseSplitAxis(Y,it,$),$=this._chooseSplitIndex(Y,it,$),$=O(Y.children.splice($,Y.children.length-$)),$.height=Y.height,$.leaf=Y.leaf,d(Y,this.toBBox),d($,this.toBBox),j?G[j-1].children.push($):this._splitRoot(Y,$)},V.prototype._splitRoot=function(G,j){this.data=O([G,j]),this.data.height=G.height+1,this.data.leaf=!1,d(this.data,this.toBBox)},V.prototype._chooseSplitIndex=function(G,j,Y){for(var $,it=1/0,nt=1/0,pt=j;pt<=Y-j;pt++){var Rt=x(G,0,pt,this.toBBox),Et=x(G,pt,Y,this.toBBox),Jt=Math.max(0,Math.min(Rt.maxX,Et.maxX)-Math.max(Rt.minX,Et.minX))*Math.max(0,Math.min(Rt.maxY,Et.maxY)-Math.max(Rt.minY,Et.minY));Rt=U(Rt)+U(Et),Jt<it?(it=Jt,$=pt,nt=Rt<nt?Rt:nt):Jt===it&&Rt<nt&&(nt=Rt,$=pt)}return $||Y-j},V.prototype._chooseSplitAxis=function(G,j,Y){var $=G.leaf?this.compareMinX:M,it=G.leaf?this.compareMinY:D,nt=this._allDistMargin(G,j,Y,$);j=this._allDistMargin(G,j,Y,it),nt<j&&G.children.sort($)},V.prototype._allDistMargin=function(G,j,Y,$){G.children.sort($),$=this.toBBox;for(var it=x(G,0,j,$),nt=x(G,Y-j,Y,$),pt=C(it)+C(nt),Rt=j;Rt<Y-j;Rt++){var Et=G.children[Rt];y(it,G.leaf?$(Et):Et),pt+=C(it)}for(Y=Y-j-1;Y>=j;Y--)it=G.children[Y],y(nt,G.leaf?$(it):it),pt+=C(nt);return pt},V.prototype._adjustParentBBoxes=function(G,j,Y){for(;0<=Y;Y--)y(j[Y],G)},V.prototype._condense=function(G){for(var j=G.length-1,Y;0<=j;j--)G[j].children.length===0?0<j?(Y=G[j-1].children,Y.splice(Y.indexOf(G[j]),1)):this.clear():d(G[j],this.toBBox)},V})}),Ja=function(a){function u(n){Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="TextLayer",n.dataChanged=!1,n.currentZoom;var l=n.canvas=document.createElement("canvas");return l=n.ctx=l.getContext("2d"),l.textAlign="start",l.textBaseline="top",n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,lineWidth:2,lineHeight:20,textAlign:"center",flat:!1,collides:!0,textMaxWidth:0,textMaxHeight:0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},stroke:{color:""}}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new qr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec4 pos=matrix*vec4(position,1.0);vec3 screen=pos.xyz/pos.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec2 positionOffset=offset*2./MAPV_resolution*devicePixelRatio;if(!uUnitPx){halfSize/=zoomUnits;positionOffset/=zoomUnits;}vec3 current=transformCoord(screen,halfSize,corner);current.xy=current.xy-positionOffset;current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){this.cachedData=[],this.dataChanged=!0;for(var v=0;v<l.length;v++){var d=this.normizedPoint(l[v].geometry.coordinates),x=l[v].text;"properties"in l[v]&&"text"in l[v].properties&&(x=l[v].properties.text);var y=this.getProperty("angle",n.angle,l[v]),M=this.getProperty("color",n.color,l[v]);d&&x!==void 0&&this.cachedData.push({point:d,text:x,angle:y,color:M,index:v})}}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l);var y=this.map.getZoomUnits();(this.dataChanged||this.currentZoom!==y)&&(this.throttleUpdate(n),this.currentZoom=y),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite}),x.setUniforms(Nr(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:1<(window.BMAPGL_FORCE_RATIO||window.devicePixelRatio)?2:1,textureImage:this.texture,uFlat:d.flat,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)),this.dataChanged=!1}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions(),x=d.fontSize,y=d.fontFamily,M=d.padding,D=d.margin,U=d.collides;n=d.enablePicked;var C=d.shadow,E=d.textMaxWidth,B=d.textMaxHeight,O=l.canvas.width/window.devicePixelRatio,H=l.canvas.height/window.devicePixelRatio;d=this.canvas,l=this.ctx,l.fillStyle="#6c0",l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),l.textBaseline="top",l.font="20px "+y;for(var V=new Os,G=[],j=void 0,Y=0;Y<this.cachedData.length;Y++){var $=this.cachedData[Y],it=$.point,nt=$.text,pt=$.angle,Rt=$.color;$=$.index;var Et=yi(it,3),Jt=Ni.clone([Et[0],Et[1],Et[2],1]);Ni.transformMat4(Jt,Jt,v),Ni.scale(Jt,Jt,1/Jt[3]);var oe=this.map.getHeading()%360;Et=(Jt[0]+1)/2*O,Jt=(-Jt[1]+1)/2*H;var Se=Et*Math.cos(oe*Math.PI/180)-Jt*Math.sin(oe*Math.PI/180),ge=Et*Math.sin(oe*Math.PI/180)+Jt*Math.cos(oe*Math.PI/180),Xe=l.measureText(nt),_r=Xe.width+2*M[0];oe=20,Xe.actualBoundingBoxAscent&&Xe.actualBoundingBoxDescent&&(oe=Xe.actualBoundingBoxDescent-Xe.actualBoundingBoxAscent),oe+=2*M[1],Xe=_r+D[0];var he=oe+D[1];Se-=Xe/2,ge-=he/2;var Ue=Se+Xe,Sr=ge+he;if(!(0>Et+Xe/2||0>Jt+he/2||Et-Xe/2>O||Jt-he/2>H)){if(U){if(Et={minX:Se,maxX:Ue,minY:ge,maxY:Sr},V.collides(Et))continue;V.insert(Et)}Et=j=E||_r,G.push({w:Et,h:B||oe,point:it,text:nt,angle:pt,color:Rt,dataIndex:$})}}l.restore(),D=xu(G),v=D.w,D=D.h,0>=v&&(v=1),0>=D&&(D=1),d.width=2*v,d.height=2*D,l.save(),l.scale(2,2),l.textBaseline="top",l.font="20px "+y,l.shadowColor=C&&C.color,l.shadowOffsetX=C&&C.offsetX,l.shadowOffsetY=C&&C.offsetY,l.shadowBlur=C&&C.blur,C=this.buildVertex(l,G,v,D,{padding:M,fontSize:x,defaultFontSize:20,enablePicked:n,cWidth:j}),x=C.vertex,y=C.textureCoord,M=C.indices,C=C.pick,l.restore(),this.loadTexture(),this.index=M,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(M)),n&&this.pickBuffer.updateData(new Float32Array(C))}},{key:"wrapText",value:function(n,l,v,d,x,y,M){if(l&&typeof l=="string"){var D=this.getOptions().stroke;l=l.split("");for(var U="",C=0;C<l.length;C++){var E=U+l[C];n.measureText(E).width>x&&0<C?(M==="left"?(D.color&&n.strokeText(U,v,d),n.fillText(U,v,d)):(D.color&&n.strokeText(U,v+(x-n.measureText(U).width)/2,d),n.fillText(U,v+(x-n.measureText(U).width)/2,d)),U=l[C],d+=y):U=E}M==="left"?(D.color&&n.strokeText(U,v,d),n.fillText(U,v,d)):(D.color&&n.strokeText(U,v+(x-n.measureText(U).width)/2,d),n.fillText(U,v+(x-n.measureText(U).width)/2,d))}}},{key:"buildVertex",value:function(n,l,v,d,x){var y=this.getOptions(),M=y.stroke,D=y.lineWidth,U=y.lineHeight,C=y.textMaxWidth;y=y.textAlign;var E=[],B=[],O=[],H=[];M.color&&(n.lineWidth=D,n.strokeStyle=M.color),D=0;for(var V=l.length;D<V;++D){var G=l[D],j=G.x+x.padding[0],Y=G.y+x.padding[1];n.fillStyle=G.color,C?this.wrapText(n,G.text,j,Y,x.cWidth,U,y):(M.color&&n.strokeText(G.text,j,Y),n.fillText(G.text,j,Y));var $=yi(G.point,3);j=$[0],Y=$[1],$=$[2];for(var it=0;4>it;it++)E.push(j,Y,$),E.push(it),E.push(G.w,G.h),E.push(x.fontSize/x.defaultFontSize,G.angle*Math.PI/180);j=G.x/v,Y=(G.x+G.w)/v,$=(G.y+G.h)/d,it=G.y/d,B.push(j,$,j,it,Y,it,Y,$),j=4*D,O.push(j,j+2,j+1,j,j+3,j+2),x.enablePicked&&(G=this.indexToRgb(G.dataIndex),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255),H.push(G[0]/255,G[1]/255,G[2]/255))}return{vertex:E,textureCoord:B,indices:O,pick:H}}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ti),Aa=function(a){function u(n){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n))}return Pr(u,a),Qe(u,[{key:"initialize",value:function(n){var l=this;this.children&&this.children.forEach(function(v){v.map=l.map,v.setWebglLayer(l.getWebglLayer()),v.commonInitialize&&v.commonInitialize(n),v.initialize&&v.initialize(n),v.onOptionsChanged(v.getOptions()),v.onDataChanged(v.getData()),v.onChanged(v.getOptions(),v.getData())})}},{key:"isRequestAnimation",value:function(){if(this.autoUpdate!==void 0)return Ds(u.prototype.__proto__||fr(u.prototype),"isRequestAnimation",this).call(this);for(var n=!1,l=0;l<this.children.length;l++)if(this.children[l].isRequestAnimation()){n=!0;break}return n}},{key:"render",value:function(n){this.children&&this.children.forEach(function(l){l.render(n)})}},{key:"onDestroy",value:function(n){this.children&&this.children.forEach(function(l){l.onDestroy(n)})}}]),u}(Ps),uA=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.preHeightMapper={},n.preColorMapper={},n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return Nr(Ds(u.prototype.__proto__||fr(u.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gridGap:5,height:function(){return 1e3},color:function(){return"rgb(200, 200, 20)"}})}},{key:"generateGrid",value:function(n,l){var v=l.gridSize,d=[],x={};l=n.length;for(var y=this.getPointOffset(),M=0;M<l;M++){var D=this.normizedPoint(n[M].geometry.coordinates);D=~~((D[0]+y[0])/v)+"_"+~~((D[1]+y[1])/v),x[D]===void 0&&(x[D]=0);var U=~~n[M].count||1;"properties"in n[M]&&"count"in n[M].properties&&(U=~~n[M].properties.count),x[D]+=U}return dn(x).forEach(function(C){var E=C.split("_");d.push([E[0]*v+v/2,E[1]*v+v/2,x[C]])}),d}},{key:"onChanged",value:function(n,l){l=this.processData(l),Ds(u.prototype.__proto__||fr(u.prototype),"onChanged",this).call(this,n,l)}},{key:"getGridDataRange",value:function(){var n=this.gridData,l=void 0,v=void 0;n[0]&&(l=n[0][2],v=n[0][2]);for(var d=n.length,x=0;x<d;x++){var y=n[x];l=Math.max(y[2],l),v=Math.min(y[2],v)}return{max:l/2,min:v}}},{key:"processData",value:function(n){var l=this.getOptions(),v=l.gridSize,d=[];if(l.style==="normal")for(var x=this.getPointOffset(),y=0;y<n.length;y++){var M=this.normizedPoint(n[y].geometry.coordinates),D=M[0]+x[0];M=M[1]+x[1];var U=~~n[y].count||1;"properties"in n[y]&&"count"in n[y].properties&&(U=~~n[y].properties.count);var C=n[y].color;"properties"in n[y]&&"color"in n[y].properties&&(C=~~n[y].properties.color),d.push([D,M,U,C])}else d=this.generateGrid(n,l);for(n=[],this._preHeightMapper={},this._preColorMapper={},x=0;x<d.length;x++)y=d[x],y[0]=y[0],y[1]=y[1],D=y[2],l.height&&(D=typeof l.height=="function"?l.height({count:y[2],coordinates:[y[0],y[1]]}):l.height),M=v/2-l.gridGap,U=y[3],l.color&&(U=typeof l.color=="function"?l.color({count:y[2],color:y[3]}):Ot(U||l.color).unitArray()),C="p"+y[0]+y[1],n.push({geometry:{type:"Polygon",coordinates:[[[y[0]-M,y[1]-M],[y[0]-M,y[1]+M],[y[0]+M,y[1]+M],[y[0]+M,y[1]-M]]]},color:U,origin:y,count:y[2],preHeight:this.preHeightMapper[C],preColor:this.preColorMapper[C],height:D}),this._preHeightMapper[C]=D,this._preColorMapper[C]=U;return this.preHeightMapper=this._preHeightMapper,this.preColorMapper=this._preColorMapper,this.gridData=n}}]),u}(xi),v1=function(a){function u(n){Ke(this,u);var l=Dr(this,(u.__proto__||fr(u)).call(this,n));return l.gridLayer=new uA(n),l.options.textOptions=Nr({show:!1,flat:!0,unit:"m",fontSize:100,collides:!1},n.textOptions||{}),l.textLayer=new Ja(l.options.textOptions),l.children=[l.gridLayer,l.textLayer],l}return Pr(u,a),Qe(u,[{key:"pick",value:function(n,l){return this.gridLayer.pick(n,l)}},{key:"setData",value:function(n){this.gridLayer.setData(n),this.options.textOptions.show&&this.setTextData()}},{key:"setTextData",value:function(){var n=this.gridLayer.gridData.map(function(l){return{geometry:{type:"Point",coordinates:[l.origin[0],l.origin[1],l.height+5]},properties:{text:l.count}}});this.textLayer.setData(n)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;Nr(this.options,n),this.gridLayer.setOptions(this.options),n.textOptions&&(this.options.textOptions.show&&this.setTextData(),this.options.textOptions=Nr(l||{},n.textOptions),this.textLayer.setOptions(this.options.textOptions))}},{key:"getData",value:function(){return this.gridLayer.getData()}},{key:"render",value:function(n){this.gridLayer.render(n),this.options.textOptions.show&&this.textLayer.render(n)}}]),u}(Aa),Gu=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.gridLayer=new v1(n.getGridOptions()),n.children=[n.gridLayer],n.options.riseTime&&(n.autoUpdate=!0),n}return Pr(u,a),Qe(u,[{key:"pick",value:function(n,l){return this.gridLayer.pick(n,l)}},{key:"onDataChanged",value:function(n){this.gridLayer.setData(n)}},{key:"getGridOptions",value:function(){var n=this.getOptions(),l=n.max,v=n.min;l===void 0&&(v=this.gridLayer.getGridDataRange(),l=v.max,v=v.min);var d=new _i({max:l,min:v,gradient:n.gradient,maxSize:n.maxHeight,minSize:n.minHeight});return n.height=function(x){var y=d.getSize(x.count);return"properties"in x&&"count"in x.properties&&(y=d.getSize(x.properties.count)),y},n.color=function(x){var y=d.getImageData(x.count);return"properties"in x&&"count"in x.properties&&(y=d.getImageData(x.properties.count)),[y[0]/255,y[1]/255,y[2]/255,y[3]/255]},n}},{key:"onOptionsChanged",value:function(n){this.gridLayer.setOptions(this.getGridOptions())}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,style:"grid",gridSize:500,maxHeight:8e3,minHeight:200,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}}]),u}(Aa),cd=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="SimpleLineLayer",n.bufferData=[],n}return Pr(u,a),Qe(u,[{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new qr(this.gl,{vertexShader:`uniform mat4 u_matrix;attribute vec3 aPos;attribute vec4 aColor;varying vec4 vColor;
#if defined(DASH)
varying vec3 vPos;
#endif
void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos,1.0);
#if defined(DASH)
vPos=aPos;
#endif
}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec3 vPos;void main(){
#if defined(DASH)
if(mod(vPos.x,3.0)<1.5){discard;}
#endif
gl_FragColor=vColor;}`,defines:l.useDash?["DASH"]:""},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:n,program:this.program,attributes:[{stride:28,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12}]})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){var d=[],x=function(C,E){if(C)for(var B=0;B<C.length-1;B++){var O=v.normizedPoint(C[B]);d.push(O[0]),d.push(O[1]),d.push(O[2]),d.push(E[0],E[1],E[2],E[3]),O=v.normizedPoint(C[B+1]),d.push(O[0]),d.push(O[1]),d.push(O[2]),d.push(E[0],E[1],E[2],E[3])}};n=n.color;for(var y=0;y<l.length;y++){var M=this.getProperty("color",n,l[y]);M=this.normizedColor(M);var D=l[y].geometry,U=D.coordinates;if(D.type==="MultiPolygon"){if(U)for(D=0;D<U.length;D++)x(U[D][0],M)}else if(D.type==="Polygon")U&&x(U[0],M);else if(D.type==="MultiLineString"){if(U)for(D=0;D<U.length;D++)x(U[D],M)}else x(U,M)}this.bufferData=d,this.buffer.updateData(new Float32Array(d))}}},{key:"render",value:function(n){var l=n.gl;if(n=n.matrix,this.bufferData&&!(0>=this.bufferData.length)){var v=this.program;v.use(l),this.vertexArray.bind(),v.setUniforms({u_matrix:n}),n=this.getOptions(),this.setGLState({blend:!0,blendFunc:n.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],blendEquation:l.FUNC_ADD}),l.drawArrays(l.LINES,0,this.bufferData.length/7)}}}]),u}(Ti),lA=Wc.f("species"),vf=It(function(a){a.exports={default:lA,__esModule:!0}});zt(vf);var y1=typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:typeof window!="undefined"?window:{},Fs=[],Jo=[],hA=typeof Uint8Array!="undefined"?Uint8Array:Array,fd=!1,x1={}.toString,A1=Array.isArray||function(a){return x1.call(a)=="[object Array]"};Be.TYPED_ARRAY_SUPPORT=y1.TYPED_ARRAY_SUPPORT!==void 0?y1.TYPED_ARRAY_SUPPORT:!0,Be.poolSize=8192,Be._augment=function(a){return a.__proto__=Be.prototype,a},Be.from=function(a,u,n){return ml(null,a,u,n)},Be.TYPED_ARRAY_SUPPORT&&(Be.prototype.__proto__=Uint8Array.prototype,Be.__proto__=Uint8Array),Be.alloc=function(a,u,n){return ss(a),a=0>=a?os(null,a):u!==void 0?typeof n=="string"?os(null,a).fill(u,n):os(null,a).fill(u):os(null,a),a},Be.allocUnsafe=function(a){return Io(null,a)},Be.allocUnsafeSlow=function(a){return Io(null,a)},Be.isBuffer=function(a){return a!=null&&(!!a._isBuffer||l0(a)||typeof a.readFloatLE=="function"&&typeof a.slice=="function"&&l0(a.slice(0,0)))},Be.compare=function(a,u){if(!sa(a)||!sa(u))throw new TypeError("Arguments must be Buffers");if(a===u)return 0;for(var n=a.length,l=u.length,v=0,d=Math.min(n,l);v<d;++v)if(a[v]!==u[v]){n=a[v],l=u[v];break}return n<l?-1:l<n?1:0},Be.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Be.concat=function(a,u){if(!A1(a))throw new TypeError('"list" argument must be an Array of Buffers');if(a.length===0)return Be.alloc(0);var n;if(u===void 0)for(n=u=0;n<a.length;++n)u+=a[n].length;u=Be.allocUnsafe(u);var l=0;for(n=0;n<a.length;++n){var v=a[n];if(!sa(v))throw new TypeError('"list" argument must be an Array of Buffers');v.copy(u,l),l+=v.length}return u},Be.byteLength=t0,Be.prototype._isBuffer=!0,Be.prototype.swap16=function(){var a=this.length;if(a%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var u=0;u<a;u+=2)vl(this,u,u+1);return this},Be.prototype.swap32=function(){var a=this.length;if(a%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var u=0;u<a;u+=4)vl(this,u,u+3),vl(this,u+1,u+2);return this},Be.prototype.swap64=function(){var a=this.length;if(a%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var u=0;u<a;u+=8)vl(this,u,u+7),vl(this,u+1,u+6),vl(this,u+2,u+5),vl(this,u+3,u+4);return this},Be.prototype.toString=function(){var a=this.length|0;return a===0?"":arguments.length===0?i0(this,0,a):Fx.apply(this,arguments)},Be.prototype.equals=function(a){if(!sa(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:Be.compare(this,a)===0},Be.prototype.inspect=function(){var a="";return 0<this.length&&(a=this.toString("hex",0,50).match(/.{2}/g).join(" "),50<this.length&&(a+=" ... ")),"<Buffer "+a+">"},Be.prototype.compare=function(a,u,n,l,v){if(!sa(a))throw new TypeError("Argument must be a Buffer");if(u===void 0&&(u=0),n===void 0&&(n=a?a.length:0),l===void 0&&(l=0),v===void 0&&(v=this.length),0>u||n>a.length||0>l||v>this.length)throw new RangeError("out of range index");if(l>=v&&u>=n)return 0;if(l>=v)return-1;if(u>=n)return 1;if(u>>>=0,n>>>=0,l>>>=0,v>>>=0,this===a)return 0;var d=v-l,x=n-u,y=Math.min(d,x);for(l=this.slice(l,v),a=a.slice(u,n),u=0;u<y;++u)if(l[u]!==a[u]){d=l[u],x=a[u];break}return d<x?-1:x<d?1:0},Be.prototype.includes=function(a,u,n){return this.indexOf(a,u,n)!==-1},Be.prototype.indexOf=function(a,u,n){return e0(this,a,u,n,!0)},Be.prototype.lastIndexOf=function(a,u,n){return e0(this,a,u,n,!1)},Be.prototype.write=function(a,u,n,l){if(u===void 0)l="utf8",n=this.length,u=0;else if(n===void 0&&typeof u=="string")l=u,n=this.length,u=0;else if(isFinite(u))u|=0,isFinite(n)?(n|=0,l===void 0&&(l="utf8")):(l=n,n=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var v=this.length-u;if((n===void 0||n>v)&&(n=v),0<a.length&&(0>n||0>u)||u>this.length)throw new RangeError("Attempt to write outside buffer bounds");for(l||(l="utf8"),v=!1;;)switch(l){case"hex":t:{if(u=Number(u)||0,l=this.length-u,n?(n=Number(n),n>l&&(n=l)):n=l,l=a.length,l%2!==0)throw new TypeError("Invalid hex string");for(n>l/2&&(n=l/2),l=0;l<n;++l){if(v=parseInt(a.substr(2*l,2),16),isNaN(v)){a=l;break t}this[u+l]=v}a=l}return a;case"utf8":case"utf-8":return Pc(vp(a,this.length-u),this,u,n);case"ascii":return Pc(a0(a),this,u,n);case"latin1":case"binary":return Pc(a0(a),this,u,n);case"base64":return Pc(u0(a),this,u,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":l=a,v=this.length-u;for(var d=[],x=0;x<l.length&&!(0>(v-=2));++x){var y=l.charCodeAt(x);a=y>>8,y%=256,d.push(y),d.push(a)}return Pc(d,this,u,n);default:if(v)throw new TypeError("Unknown encoding: "+l);l=(""+l).toLowerCase(),v=!0}},Be.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Cm=4096;Be.prototype.slice=function(a,u){var n=this.length;if(a=~~a,u=u===void 0?n:~~u,0>a?(a+=n,0>a&&(a=0)):a>n&&(a=n),0>u?(u+=n,0>u&&(u=0)):u>n&&(u=n),u<a&&(u=a),Be.TYPED_ARRAY_SUPPORT)u=this.subarray(a,u),u.__proto__=Be.prototype;else{n=u-a,u=new Be(n,void 0);for(var l=0;l<n;++l)u[l]=this[l+a]}return u},Be.prototype.readUIntLE=function(a,u,n){a|=0,u|=0,n||qn(a,u,this.length),n=this[a];for(var l=1,v=0;++v<u&&(l*=256);)n+=this[a+v]*l;return n},Be.prototype.readUIntBE=function(a,u,n){a|=0,u|=0,n||qn(a,u,this.length),n=this[a+--u];for(var l=1;0<u&&(l*=256);)n+=this[a+--u]*l;return n},Be.prototype.readUInt8=function(a,u){return u||qn(a,1,this.length),this[a]},Be.prototype.readUInt16LE=function(a,u){return u||qn(a,2,this.length),this[a]|this[a+1]<<8},Be.prototype.readUInt16BE=function(a,u){return u||qn(a,2,this.length),this[a]<<8|this[a+1]},Be.prototype.readUInt32LE=function(a,u){return u||qn(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},Be.prototype.readUInt32BE=function(a,u){return u||qn(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},Be.prototype.readIntLE=function(a,u,n){a|=0,u|=0,n||qn(a,u,this.length),n=this[a];for(var l=1,v=0;++v<u&&(l*=256);)n+=this[a+v]*l;return n>=128*l&&(n-=Math.pow(2,8*u)),n},Be.prototype.readIntBE=function(a,u,n){a|=0,u|=0,n||qn(a,u,this.length),n=u;for(var l=1,v=this[a+--n];0<n&&(l*=256);)v+=this[a+--n]*l;return v>=128*l&&(v-=Math.pow(2,8*u)),v},Be.prototype.readInt8=function(a,u){return u||qn(a,1,this.length),this[a]&128?-1*(255-this[a]+1):this[a]},Be.prototype.readInt16LE=function(a,u){return u||qn(a,2,this.length),a=this[a]|this[a+1]<<8,a&32768?a|4294901760:a},Be.prototype.readInt16BE=function(a,u){return u||qn(a,2,this.length),a=this[a+1]|this[a]<<8,a&32768?a|4294901760:a},Be.prototype.readInt32LE=function(a,u){return u||qn(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},Be.prototype.readInt32BE=function(a,u){return u||qn(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},Be.prototype.readFloatLE=function(a,u){return u||qn(a,4,this.length),pp(this,a,!0,23,4)},Be.prototype.readFloatBE=function(a,u){return u||qn(a,4,this.length),pp(this,a,!1,23,4)},Be.prototype.readDoubleLE=function(a,u){return u||qn(a,8,this.length),pp(this,a,!0,52,8)},Be.prototype.readDoubleBE=function(a,u){return u||qn(a,8,this.length),pp(this,a,!1,52,8)},Be.prototype.writeUIntLE=function(a,u,n,l){a=+a,u|=0,n|=0,l||Uo(this,a,u,n,Math.pow(2,8*n)-1,0),l=1;var v=0;for(this[u]=a&255;++v<n&&(l*=256);)this[u+v]=a/l&255;return u+n},Be.prototype.writeUIntBE=function(a,u,n,l){a=+a,u|=0,n|=0,l||Uo(this,a,u,n,Math.pow(2,8*n)-1,0),l=n-1;var v=1;for(this[u+l]=a&255;0<=--l&&(v*=256);)this[u+l]=a/v&255;return u+n},Be.prototype.writeUInt8=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,1,255,0),Be.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[u]=a&255,u+1},Be.prototype.writeUInt16LE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,2,65535,0),Be.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):gp(this,a,u,!0),u+2},Be.prototype.writeUInt16BE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,2,65535,0),Be.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):gp(this,a,u,!1),u+2},Be.prototype.writeUInt32LE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,4,4294967295,0),Be.TYPED_ARRAY_SUPPORT?(this[u+3]=a>>>24,this[u+2]=a>>>16,this[u+1]=a>>>8,this[u]=a&255):mp(this,a,u,!0),u+4},Be.prototype.writeUInt32BE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,4,4294967295,0),Be.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):mp(this,a,u,!1),u+4},Be.prototype.writeIntLE=function(a,u,n,l){a=+a,u|=0,l||(l=Math.pow(2,8*n-1),Uo(this,a,u,n,l-1,-l)),l=0;var v=1,d=0;for(this[u]=a&255;++l<n&&(v*=256);)0>a&&d===0&&this[u+l-1]!==0&&(d=1),this[u+l]=(a/v>>0)-d&255;return u+n},Be.prototype.writeIntBE=function(a,u,n,l){a=+a,u|=0,l||(l=Math.pow(2,8*n-1),Uo(this,a,u,n,l-1,-l)),l=n-1;var v=1,d=0;for(this[u+l]=a&255;0<=--l&&(v*=256);)0>a&&d===0&&this[u+l+1]!==0&&(d=1),this[u+l]=(a/v>>0)-d&255;return u+n},Be.prototype.writeInt8=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,1,127,-128),Be.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[u]=a&255,u+1},Be.prototype.writeInt16LE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,2,32767,-32768),Be.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8):gp(this,a,u,!0),u+2},Be.prototype.writeInt16BE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,2,32767,-32768),Be.TYPED_ARRAY_SUPPORT?(this[u]=a>>>8,this[u+1]=a&255):gp(this,a,u,!1),u+2},Be.prototype.writeInt32LE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,4,2147483647,-2147483648),Be.TYPED_ARRAY_SUPPORT?(this[u]=a&255,this[u+1]=a>>>8,this[u+2]=a>>>16,this[u+3]=a>>>24):mp(this,a,u,!0),u+4},Be.prototype.writeInt32BE=function(a,u,n){return a=+a,u|=0,n||Uo(this,a,u,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),Be.TYPED_ARRAY_SUPPORT?(this[u]=a>>>24,this[u+1]=a>>>16,this[u+2]=a>>>8,this[u+3]=a&255):mp(this,a,u,!1),u+4},Be.prototype.writeFloatLE=function(a,u,n){return o0(this,a,u,!0,n)},Be.prototype.writeFloatBE=function(a,u,n){return o0(this,a,u,!1,n)},Be.prototype.writeDoubleLE=function(a,u,n){return s0(this,a,u,!0,n)},Be.prototype.writeDoubleBE=function(a,u,n){return s0(this,a,u,!1,n)},Be.prototype.copy=function(a,u,n,l){if(n||(n=0),l||l===0||(l=this.length),u>=a.length&&(u=a.length),u||(u=0),0<l&&l<n&&(l=n),l===n||a.length===0||this.length===0)return 0;if(0>u)throw new RangeError("targetStart out of bounds");if(0>n||n>=this.length)throw new RangeError("sourceStart out of bounds");if(0>l)throw new RangeError("sourceEnd out of bounds");l>this.length&&(l=this.length),a.length-u<l-n&&(l=a.length-u+n);var v=l-n;if(this===a&&n<u&&u<l)for(l=v-1;0<=l;--l)a[l+u]=this[l+n];else if(1e3>v||!Be.TYPED_ARRAY_SUPPORT)for(l=0;l<v;++l)a[l+u]=this[l+n];else Uint8Array.prototype.set.call(a,this.subarray(n,n+v),u);return v},Be.prototype.fill=function(a,u,n,l){if(typeof a=="string"){if(typeof u=="string"?(l=u,u=0,n=this.length):typeof n=="string"&&(l=n,n=this.length),a.length===1){var v=a.charCodeAt(0);256>v&&(a=v)}if(l!==void 0&&typeof l!="string")throw new TypeError("encoding must be a string");if(typeof l=="string"&&!Be.isEncoding(l))throw new TypeError("Unknown encoding: "+l)}else typeof a=="number"&&(a&=255);if(0>u||this.length<u||this.length<n)throw new RangeError("Out of range index");if(n<=u)return this;if(u>>>=0,n=n===void 0?this.length:n>>>0,a||(a=0),typeof a=="number")for(l=u;l<n;++l)this[l]=a;else for(a=sa(a)?a:vp(new Be(a,l).toString()),v=a.length,l=0;l<n-u;++l)this[l+u]=a[l%v];return this};var _1=/[^+\/0-9A-Za-z-_]/g,pd={normal:null,road:p0()},dd=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="LineLayer3D",n.initData(),n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",offset:0,blend:"normal",width:4,unit:"px",flat:!1,antialias:!1,style:"normal",dashArray:[0,0],dashOffset:0,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[],uv:[]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),pd[l.style]&&(this.isUseTexture=!0,v.push("USE_TEXTURE")),this.program=new qr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 uMatrix;uniform bool uFlat;uniform bool uUnitPx;uniform vec2 uDashArray;uniform float thickness;uniform float zoomUnits;uniform float devicePixelRatio;uniform float uOffset;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aDistance;attribute float aTotalDistance;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vTotalDistance;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}vec3 getNormalAndWidth(vec2 currentScreen,vec2 previousScreen,vec2 nextScreen,float thickness){vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){thickness=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);return vec3(normal,thickness);}void main(){vColor=aColor;vCounter=aDistance/aTotalDistance;vDashArray=uDashArray/aTotalDistance;if(uUnitPx){vDashArray*=zoomUnits;}vTotalDistance=aTotalDistance;
#if defined(USE_TEXTURE)
vUV=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
if(uFlat){float width=thickness;if(uUnitPx){width*=zoomUnits;}vec3 nw=getNormalAndWidth(position.xy,previous.xy,next.xy,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;float offsetXy=uOffset;float offsetHeight=uOffset/100.0;if(uUnitPx){offsetXy/=zoomUnits;offsetHeight*=zoomUnits;}gl_Position=uMatrix*vec4(position.xy+normal*(direction+offsetXy),position.z+offsetHeight,1.0);}else{vec4 previousProjected=uMatrix*vec4(previous,1.0);vec4 currentProjected=uMatrix*vec4(position,1.0);vec4 nextProjected=uMatrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float width=thickness*devicePixelRatio;if(!uUnitPx){width/=zoomUnits;}vec3 nw=getNormalAndWidth(currentScreen,previousScreen,nextScreen,width);width=nw.z;vec2 normal=nw.xy;vNormal=normal*direction;normal*=width/2.0;vec2 pos=currentScreen+normal*direction;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}}`,fragmentShader:`precision highp float;varying vec4 vColor;varying vec2 vNormal;varying vec2 vUV;varying vec2 vDashArray;varying float vCounter;varying float vTotalDistance;uniform bool uAntialias;uniform float uDashOffset;uniform float zoomUnits;uniform float thickness;
#if defined(USE_TEXTURE)
uniform float uTextureMargin;uniform sampler2D textureImage;
#endif
void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(vNormal));color.a*=blur;}
#if defined(USE_TEXTURE)
float segLen=uTextureMargin*zoomUnits;float textureLen=thickness*zoomUnits;float deltaX=mod(vUV.x,segLen);float middle=segLen/2.0;if(deltaX>=middle&&deltaX<=middle+textureLen){float uvx=(deltaX-middle)/textureLen;vec4 texture=texture2D(textureImage,vec2(uvx,vUV.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(vDashArray.y>0.0){float offset=uDashOffset*zoomUnits/vTotalDistance;color.a*=(1.0-step(vDashArray.x,mod(vCounter+offset,vDashArray.x+vDashArray.y)));}gl_FragColor=color;}`,defines:v},this),this.prevBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:8,name:"aDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0},{stride:8,name:"aTotalDistance",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:4}],v=v.concat(this.getCommonAttributes()),pd[l.style]&&(v.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),this.setOptions({texture:pd[l.style]}),this.loadTexture()),this.vertexArray=new bi({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){this.initData();for(var d=n.color,x=[],y=0;y<l.length;y++){var M=[],D=l[y].geometry.coordinates;D&&0<D.length&&(M=l[y].geometry.type==="MultiPolygon"?D.reduce(function(E,B){return E.concat(B)})[0].map(function(E){return v.normizedPoint(E)}):l[y].geometry.type==="Polygon"||l[y].geometry.type==="MultiLineString"?D[0].map(function(E){return v.normizedPoint(E)}):D.map(function(E){return v.normizedPoint(E)})),D=this.getProperty("color",d,l[y]),D=this.getProperty("lineColor",d,l[y]),D=this.normizedColor(D);for(var U=this.addMultipleCoords(M),C=0;C<U.length;C++)this.processData(this.dataMgr,U[C],D);if(n.enablePicked)for(D=this.indexToRgb(y),U=0;U<M.length;U++)x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),n.repeat&&(x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255),x.push(D[0]/255,D[1]/255,D[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(this.dataMgr.uv)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(x))}}},{key:"processData",value:function(n,l,v){var d,x,y,M,D,U,C,E,B=l.length,O=n.position.length/6,H=c0(l),V=H.arr,G=H.total;H=Ms(V.map(function(nt){return[nt,G]})),V=V.map(function(nt){return[nt,0,nt,1]});var j=Ms(l.map(function(nt){return-1}),!0),Y=Ms(l),$=Ms(l.map(yp(-1))),it=Ms(l.map(yp(1)));l=Ms(l.map(function(nt){return v})),B=h0(B,O),(d=n.uv).push.apply(d,Jr(aa(V))),(x=n.counter).push.apply(x,Jr(aa(H))),(y=n.position).push.apply(y,Jr(aa(Y))),(M=n.prev).push.apply(M,Jr(aa($))),(D=n.next).push.apply(D,Jr(aa(it))),(U=n.direction).push.apply(U,Jr(j)),(C=n.color).push.apply(C,Jr(aa(l))),(E=n.index).push.apply(E,Jr(B))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.dataMgr;if(d&&!(0>=d.index.length)&&this.map){var x=this.getOptions(),y=this.program;y.use(l),n=Nr(this.getCommonUniforms(n),{uMatrix:v,uFlat:x.flat,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio,thickness:x.width,uDashArray:x.dashArray,uDashOffset:x.dashOffset,uAntialias:x.antialias,uOffset:x.offset}),this.isUseTexture&&(n=Nr(n,{uTextureMargin:140,textureImage:this.texture})),y.setUniforms(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.index.length,l.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?sn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()}):(this.image=this.texture=null,n&&n())}}]),u}(Ti),cA=function(){function a(u){Ke(this,a),this.join=u.join||"miter",this.cap=u.cap||"butt",this.thickness=u.thickness||4,this.miterLimit=u.miterLimit||2*this.thickness,this.dash=u.dash||!1,this.complex={positions:[],indices:[],normals:[],colors:[],uvs:[],startIndex:0,maxDistance:0},this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0,this._colorFlag=!1,this._count=0}return Qe(a,[{key:"extrude",value:function(u,n,l,v){var d=this.complex;if(1>=u.length)return d;this._lastFlip=-1,this._started=!1,this._normal=null,this._totalDistance=0;for(var x=u.length,y=d.startIndex,M=null,D=1;D<x;D++){var U=M||u[D-1],C=u[D],E=D<x-1?u[D+1]:null;E&&C[0]===E[0]&&C[1]===E[1]&&C[2]===E[2]?M=U:(U=this._segment(d,y,U,C,E,n,l,v),U!==-1&&(y+=U,M=null))}return this.dash&&(d.maxDistance=Math.max(this._totalDistance,d.maxDistance)),d.startIndex=d.positions.length/7,d}},{key:"_segment",value:function(u,n,l,v,d,x,y,M){M[0]instanceof Array&&(this._colorFlag=!0);var D=0,U=ii.create(),C=ii.create(),E=ii.create(),B=ii.create(),O=u.indices,H=u.positions,V=u.normals,G=u.colors;u=u.uvs;var j=this.cap==="square",Y=this.cap==="round",$=this.join==="bevel",it=this.join==="round",nt=[v[0],v[1]],pt=[l[0],l[1]];d0(C,nt,pt);var Rt=0;if(this.dash&&(Rt=this._calcDistance(nt,pt),this._totalDistance+=Rt),this._normal||(this._normal=ii.create(),xp(this._normal,C)),!this._started)if(this._started=!0,j){pt=ii.create();var Et=ii.create();ii.add(pt,this._normal,C),ii.sub(Et,this._normal,C),V.push(Et[0],Et[1],0),V.push(pt[0],pt[1],0),H.push(l[0],l[1],l[2],this._totalDistance-Rt,x,y,0),H.push(l[0],l[1],l[2],this._totalDistance-Rt,-x,y,0),u.push(this._totalDistance-Rt,0,this._totalDistance-Rt,1),this._colorFlag?(G.push(M[0][0],M[0][1],M[0][2],M[0][3]),G.push(M[0][0],M[0][1],M[0][2],M[0][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]))}else if(Y){pt=ii.fromValues(-C[0],-C[1]),Et=ii.create(),ii.sub(Et,this._normal,C),ii.normalize(Et,Et);var Jt=ii.create();ii.add(Jt,this._normal,C),ii.normalize(Jt,Jt);var oe=ii.fromValues(this._normal[0],this._normal[1]),Se=ii.fromValues(-this._normal[0],-this._normal[1]);for(V.push(pt[0],pt[1],0),V.push(Et[0],Et[1],0),V.push(-Jt[0],-Jt[1],0),V.push(oe[0],oe[1],0),V.push(Se[0],Se[1],0),pt=0;5>pt;pt++)H.push(l[0],l[1],l[2],this._totalDistance-Rt,x,y,0),u.push(this._totalDistance-Rt,0),this._colorFlag?G.push(M[0][0],M[0][1],M[0][2],M[0][3]):G.push(M[0],M[1],M[2],M[3]);O.push(n+0,n+2,n+1,n+1,n+2,n+3,n+3,n+2,n+4),D+=3,n+=3}else this._extrusions(H,V,u,G,l,this._normal,x,this._totalDistance-Rt,y,M,0);if(O.push.apply(O,Jr(this._lastFlip===-1?[n+0,n+1,n+2]:[n+1,n+0,n+2])),d)d0(E,[d[0],d[1]],nt),this._count++,ii.create(),ii.add(B,C,E),ii.normalize(B,B),Y=ii.fromValues(-B[1],B[0]),C=ii.fromValues(-C[1],C[0]),C=[x/ii.dot(Y,C),Y],C=yi(C,2),Y=C[0],C=C[1],B=0<ii.dot(B,this._normal)?-1:1,$||this.join!=="miter"||Math.abs(Y)>this.miterLimit&&($=!0),$?(it=Math.min(2*x,Math.abs(Y)),V.push(this._normal[0],this._normal[1],0),V.push(C[0],C[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,-it*B,y,0),O.push.apply(O,Jr(this._lastFlip===-B?[n+2,n+1,n+3]:[n+0,n+2,n+3])),xp(U,E),ii.copy(this._normal,U),V.push(this._normal[0],this._normal[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),O.push.apply(O,Jr(B===1?[n+2,n+3,n+4]:[n+3,n+2,n+4])),this._flipedUV(u,this._totalDistance,B,!0),this._colorFlag?(G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3])),D+=3):it?(it=Math.min(2*x,Math.abs(Y)),V.push(this._normal[0],this._normal[1],0),V.push(C[0],C[1],0),V.push(C[0],C[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),H.push(v[0],v[1],v[2],this._totalDistance,-it*B,y,0),O.push.apply(O,Jr(this._lastFlip===-B?[n+2,n+1,n+4,n+2,n+4,n+3]:[n+0,n+2,n+4,n+2,n+3,n+4])),xp(U,E),ii.copy(this._normal,U),V.push(this._normal[0],this._normal[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x*B,y,0),O.push.apply(O,Jr(B===1?[n+4,n+3,n+5]:[n+3,n+4,n+5])),this._flipedUV(u,this._totalDistance,B,!1),this._colorFlag?(G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3]),G.push(M[this._count][0],M[this._count][1],M[this._count][2],M[this._count][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3])),D+=4):(this._extrusions(H,V,u,G,v,C,Y,this._totalDistance,y,M,this._count),O.push.apply(O,Jr(this._lastFlip===-1?[n+2,n+1,n+3]:[n+2,n+0,n+3])),B=-1,ii.copy(this._normal,C),D+=2),this._lastFlip=B;else if(xp(this._normal,C),U=M.length-1,j?(E=ii.create(),it=ii.create(),ii.add(E,C,this._normal),ii.sub(it,C,this._normal),V.push(E[0],E[1],0),V.push(it[0],it[1],0),H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),u.push(this._totalDistance,0,this._totalDistance,1),this._colorFlag?(G.push(M[U][0],M[U][1],M[U][2],M[U][3]),G.push(M[U][0],M[U][1],M[U][2],M[U][3])):(G.push(M[0],M[1],M[2],M[3]),G.push(M[0],M[1],M[2],M[3]))):this._extrusions(H,V,u,G,v,this._normal,x,this._totalDistance,y,M,U),O.push.apply(O,Jr(this._lastFlip===-1?[n+2,n+1,n+3]:[n+2,n+0,n+3])),D+=2,Y){for(E=ii.create(),ii.add(E,C,this._normal),ii.normalize(E,E),it=ii.create(),ii.sub(it,C,this._normal),ii.normalize(it,it),C=ii.fromValues(C[0],C[1]),V.push(E[0],E[1],0),V.push(it[0],it[1],0),V.push(C[0],C[1],0),V=0;3>V;V++)H.push(v[0],v[1],v[2],this._totalDistance,x,y,0),u.push(this._totalDistance,0),this._colorFlag?G.push(M[U][0],M[U][1],M[U][2],M[U][3]):G.push(M[0],M[1],M[2],M[3]);O.push(n+2,n+3,n+4,n+4,n+3,n+5,n+4,n+5,n+6),D+=3}return D}},{key:"_extrusions",value:function(u,n,l,v,d,x,y,M,D,U,C){n.push(x[0],x[1],0),n.push(x[0],x[1],0),u.push(d[0],d[1],d[2],M,y,D,0),u.push(d[0],d[1],d[2],M,-y,D,0),l.push(M,0,M,1),this._colorFlag?(v.push(U[C][0],U[C][1],U[C][2],U[C][3]),v.push(U[C][0],U[C][1],U[C][2],U[C][3])):(v.push(U[0],U[1],U[2],U[3]),v.push(U[0],U[1],U[2],U[3]))}},{key:"_calcDistance",value:function(u,n){return Math.sqrt(Math.pow(u[0]-n[0],2)+Math.pow(u[1]-n[1],2))}},{key:"_flipedUV",value:function(u,n,l,v){v?l===-1?u.push(n,0,n,1,n,0):u.push(n,1,n,0,n,1):l===-1?u.push(n,0,n,0,n,1,n,0):u.push(n,1,n,1,n,0,n,1)}}]),a}(),gd={normal:null,road:p0,arrow:function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},u=a.width;a=a.color;var n=f0(),l=n.canvas;return n=n.ctx,n.save(),n.moveTo(5,0),n.lineTo(32,16),n.lineTo(5,32),n.strokeStyle=a||"#fff",n.lineWidth=u||8,n.stroke(),n.restore(),l}},qa=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="LineLayer",n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"default",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),gd[l.style]&&(this.isUseTexture=!0,this.prevStyle=l.style,this.prevStyleOptions=l.styleOptions,v.push("USE_TEXTURE")),l.animation===!0&&(this.isAnimateLine=!0,this.date=new Date,this.autoUpdate=!0,v.push("USE_LINE_ANIMATION")),l.useDash===!0&&v.push("USE_SIMPLE_DASH"),this.program=new qr(this.gl,{vertexShader:`precision highp float;uniform vec4 uSelectedColor;uniform mat4 u_matrix;uniform vec2 u_dash_array;uniform float u_zoom_units;uniform float u_zIndex;uniform bool u_unit_px;attribute vec4 a_color;attribute vec3 a_position;attribute vec3 a_normal;attribute float a_distance;attribute float a_total_distance;attribute float a_width;attribute float a_offset;
#if defined(USE_TEXTURE)
attribute vec2 uv;
#endif
varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_total_distance;varying float v_counter;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
void main(){v_width=a_width;v_color=a_color;v_counter=a_distance/a_total_distance;v_dash_array=u_dash_array/a_total_distance;if(u_unit_px){v_dash_array*=u_zoom_units;}v_total_distance=a_total_distance;v_normal=vec2(normalize(a_normal.xy)*sign(a_width));
#if defined(USE_TEXTURE)
v_uv=uv;
#endif
#if defined(PICK)
if(mapvIsPicked()){v_color=uSelectedColor;}
#endif
vec2 extrude=a_normal.xy*a_width/2.0;if(u_unit_px){extrude*=u_zoom_units;}vec2 offsetXY=a_normal.xy*-a_offset;float offsetZ=a_offset/100.0+u_zIndex;if(u_unit_px){offsetXY*=u_zoom_units;offsetZ*=u_zoom_units;}
#if defined(USE_SIMPLE_DASH)
v_position=a_position;
#endif
gl_Position=u_matrix*vec4(a_position.xy+extrude+offsetXY,a_position.z+offsetZ,1.0);}`,fragmentShader:`precision highp float;varying vec4 v_color;varying vec2 v_normal;varying vec2 v_uv;varying vec2 v_dash_array;varying float v_counter;varying float v_total_distance;varying float v_width;
#if defined(USE_SIMPLE_DASH)
varying vec3 v_position;
#endif
uniform bool u_antialias;uniform float u_dash_offset;uniform float u_zoom_units;
#if defined(USE_LINE_ANIMATION)
uniform bool u_animate;uniform float u_time;uniform float u_duration;uniform float u_interval;uniform float u_trail_length;
#endif
#if defined(USE_TEXTURE)
uniform float u_texture_width;uniform float u_texture_margin;uniform sampler2D u_sampler;
#endif
void main(){vec4 color=v_color;
#if defined(USE_SIMPLE_DASH)
if(mod(v_position.x,5.0)<3.0){discard;}
#endif
if(u_antialias){float blur=1.0;blur=1.0-smoothstep(0.8,1.0,length(v_normal));color.a*=blur;}
#if defined(USE_LINE_ANIMATION)
if(u_animate){float alpha=1.0-fract(mod(1.0-v_counter,u_interval)*(1.0/u_interval)+u_time/u_duration);alpha=(alpha+u_trail_length-1.0)/u_trail_length;color.a*=alpha;gl_FragColor=color;return;}
#endif
#if defined(USE_TEXTURE)
float margin_width=u_texture_margin*u_zoom_units;float margin_width_half=margin_width/2.0;float texture_width=u_texture_width*u_zoom_units;float delta=mod(v_uv.x,texture_width+margin_width);if(delta>=margin_width_half&&delta<=margin_width_half+texture_width){float uvx=(delta-margin_width_half)/texture_width;vec4 texture=texture2D(u_sampler,vec2(uvx,v_uv.y));color=texture.a>=0.5 ? texture : color;}
#endif
if(v_dash_array.y>0.0){float offset=u_dash_offset*u_zoom_units/v_total_distance;color.a*=(1.0-step(v_dash_array.x,mod(v_counter+offset,v_dash_array.x+v_dash_array.y)));}gl_FragColor=color;}`,defines:v},this),this.positionBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.normalBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),v=[{stride:28,name:"a_position",buffer:this.positionBuffer,size:3,type:"FLOAT",offset:0},{stride:28,name:"a_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:12},{stride:28,name:"a_width",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:16},{stride:28,name:"a_offset",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:20},{stride:28,name:"a_total_distance",buffer:this.positionBuffer,size:1,type:"FLOAT",offset:24},{stride:12,name:"a_normal",buffer:this.normalBuffer,size:3,type:"FLOAT",offset:0},{stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}],v=v.concat(this.getCommonAttributes()),this.isUseTexture&&(this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),v.push({stride:8,name:"uv",buffer:this.uvBuffer,size:2,type:"FLOAT",offset:0}),l=(0,gd[l.style])(l.styleOptions),this.setOptions({texture:l}),this.loadTexture()),this.vertexArray=new bi({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this,d=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};if(this.gl)if(!this.isUseTexture||this.prevStyle===n.style&&Dl(this.prevStyleOptions)===Dl(n.styleOptions))this.parseData(n,l,d);else{this.prevStyle=n.style,this.prevStyleOptions=n.styleOptions;var x=(0,gd[n.style])(n.styleOptions);this.setOptions({texture:x}),this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.parseData(n,l,d)})},0)}}},{key:"onParseProperties",value:function(n){return this.normizedColor(n)}},{key:"parseData",value:function(n,l,v){var d=this,x=n.dashArray,y=n.width,M=n.color,D=n.offset;x=!!this.isUseTexture||!!x[1]||!!this.isAnimateLine;for(var U=new cA({dash:x,cap:n.lineCap,join:n.lineJoin,miterLimit:n.miterLimit,thickness:y}),C=[],E=function(O){var H=l[O].geometry.coordinates;H&&0<H.length&&(l[O].geometry.type==="MultiPolygon"?H=H.reduce(function(it,nt){return it.concat(nt)}):l[O].geometry.type==="LineString"&&(H=[H]),H=H.map(function(it){return it=it.map(function(nt){return d.normizedPoint(nt)}),v.closePath===!0&&it[0].toString()!==it[it.length-1].toString()&&it.push(it[0]),it}));var V=d.getProperty("color",M,l[O]);V=d.getProperty("lineColor",V,l[O]),V=d.onParseProperties(V,l[0].geometry.coordinates.length);var G=d.getProperty("width",y,l[O]);G=Number(G);var j=d.getProperty("offset",D,l[O]);j=Number(j);var Y=U.complex.startIndex;H=d.addMultipleCoords(H);for(var $=0;$<H.length;$++)H[$].forEach(function(it){U.extrude(it,G,j,V)});if(n.enablePicked)for(O=d.indexToRgb(O),H=U.complex.startIndex;Y<H;Y++)C.push(O[0]/255,O[1]/255,O[2]/255),n.repeat&&(C.push(O[0]/255,O[1]/255,O[2]/255),C.push(O[0]/255,O[1]/255,O[2]/255))},B=0;B<l.length;B++)E(B);if(E=U.complex,x)for(B=0;B<E.positions.length/7;B++)E.positions[7*B+6]=E.maxDistance;this.lineData=E,this.positionBuffer.updateData(new Float32Array(E.positions)),this.normalBuffer.updateData(new Float32Array(E.normals)),this.colorBuffer.updateData(new Float32Array(E.colors)),this.indexBuffer.updateData(new Uint32Array(E.indices)),this.isUseTexture&&this.uvBuffer.updateData(new Float32Array(E.uvs)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.lineData;if(d&&!(0>=d.indices.length)&&this.map){var x=this.getOptions(),y=this.program;y.use(l),n=Nr(this.getCommonUniforms(n),{u_matrix:v,u_zoom_units:this.map.getZoomUnits(),u_dash_array:x.dashArray,u_dash_offset:x.dashOffset,u_antialias:x.antialias,u_unit_px:x.unit==="px",u_zIndex:x.zIndex}),this.isUseTexture&&(n=Nr(n,{u_texture_width:x.width,u_texture_margin:140,u_sampler:this.texture})),this.isAnimateLine&&(v=this.map.getZoom(),n=Nr(n,{u_time:(new Date-this.date)/1e3,u_animate:!!(v>=x.minZoom&&v<=x.maxZoom&&this.autoUpdate),u_duration:x.duration,u_interval:x.interval,u_trail_length:x.trailLength})),y.setUniforms(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:so(l,x.blend),polygonOffset:x.polygonOffset,depthTest:x.depthTest,depthMask:x.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.indices.length,l.UNSIGNED_INT,0)}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?sn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()}):(this.image=this.texture=null,n&&n())}}]),u}(Ti),w1=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="LineRainbowLayer",n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{style:"normal",styleOptions:{},color:"rgba(25, 25, 250, 1)",blend:"normal",lineJoin:"miter",lineCap:"butt",unit:"px",width:4,offset:0,antialias:!1,dashArray:[0,0],dashOffset:0,animation:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0],depthTest:!0,depthWrite:!0}}},{key:"onDestroy",value:function(){this.options&&this.options.enablePicked&&(this.pickBuffer=null),this.options=this.data=this.indexBuffer=this.normalBuffer=this.colorBuffer=this.positionBuffer=this.program=this.vertexArray=null}},{key:"onParseProperties",value:function(n,l){var v=n.length;if(n instanceof Array){var d=[];if(v<l){var x=Math.floor(l/v);l%=v;for(var y=0,M=0;y<v;y++,M++)for(var D=M<l?x+1:x,U=0;U<D;U++)d.push(n[y]);n=d}for(v=[],x=0;x<n.length;x++)v.push(this.normizedColor(n[x]))}else v=this.normizedColor(n);return v}}]),u}(qa),qo=function(){function a(u,n){Ke(this,a),this.layer=u,this.gl=n,this.initData()}return Qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(u,n){this.initData();var l=u.color,v=u.height,d=u.gradient;u=this.gl;for(var x=0;x<n.length;x++){var y=n[x].geometry.coordinates,M=y.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(y[U]);D.push(C)}M=n[x].color||l,"properties"in n[x]&&"color"in n[x].properties&&(M=n[x].properties.color),d||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(n[x])),y=this.layer.normizedColor(d?d[0]:M),M=this.layer.normizedColor(d?d[1]:M),U=n[x].height||v,"properties"in n[x]&&"height"in n[x].properties&&(U=n[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(n[x])),this.processData(this.outWall3d,D,y,M,U)}for(n=0;n<this.outWall3d.vertex.length;n++){for(l=[],v=this.outWall3d.vertex[n].length,d=0;d<v;d++)l.push.apply(l,Jr(this.outWall3d.vertex[n][d]));v=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,v),u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STATIC_DRAW),this.outWall3d.vertexBuffer[n]=v,u.bindBuffer(u.ARRAY_BUFFER,null),v=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[n]),u.STATIC_DRAW),this.outWall3d.indexBuffer[n]=v,u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d){var x=u.vertex[u.vertex.length-1],y=u.index[u.index.length-1],M=n.length;(!y||65536<=y.length+2*M+2)&&(x=[],y=[],u.vertex.push(x),u.index.push(y)),(u=x.length)&&y.push(u-1,u);for(var D=u=0;D<M;D++){var U=[],C=[],E=n[D];U.push(E[0],E[1]),U.push(E[2]?Number(E[2])+d:d),U.push(E[3]?Number(E[3]):D),U.push(u),U.push(l[0],l[1],l[2],l[3]),C.push(E[0],E[1]),C.push(E[2]?Number(E[2]):0),C.push(E[3]?Number(E[3]):D),C.push(u),C.push(v[0],v[1],v[2],v[3]),E=x.length,x.push(U,C),y.push(E,E+1),D<M-1&&(u+=this.getDistance(n[D],n[D+1]))}}},{key:"getDistance",value:function(u,n){return Math.sqrt(Math.pow(Math.abs(u[0]-n[0]),2)+Math.pow(Math.abs(u[1]-n[1]),2))}}]),a}(),md=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new qo(this,this.gl),this.program=new qr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute float aDistance;attribute vec4 aColor;varying vec4 vColor;varying float vHeight;varying float vTime;varying float vDistance;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vHeight=aPos.z;vColor=aColor;vDistance=aDistance;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;varying float vDistance;varying float vHeight;uniform float currentTime;void main(){if(vTime>1.0||vTime<0.0){}float radius=2.5;float distance=vDistance+currentTime*20.0;float modDistance=mod(distance,9.0);float alpha=1.0;if(modDistance>radius*2.0){discard;}else{float x=abs(modDistance-radius);float y=abs(vHeight-radius);float dis=sqrt(pow(x,2.0)+pow(y,2.0));if(dis>radius){discard;}alpha=dis/radius;}gl_FragColor=vec4(vColor.rgb,1.0-alpha);}"})}},{key:"onChanged",value:function(n,l){this.gl&&(this.dataMgr.onLayerChange(n,l),n.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;for(l.useProgram(x.program),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aDistance),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1f(x.uniforms.currentTime,this.time),l.uniform1f(x.uniforms.trailLength,d.trailLength),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,4,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aDistance,1,l.FLOAT,!1,y,4*M),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,5*M),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}this.time+=d.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),u}(Ti),Wl=function(a,u,n,l){if(!(a instanceof u)||l!==void 0&&l in a)throw TypeError(n+": incorrect invocation!");return a},Un=It(function(a){var u={},n={};a=a.exports=function(l,v,d,x,y){y=y?function(){return l}:Ls(l),d=Vn(d,x,v?2:1),x=0;var M,D;if(typeof y!="function")throw TypeError(l+" is not iterable!");if(y===void 0||Vo.Array!==y&&Np[nn]!==y){for(x=y.call(l);!(D=x.next()).done;)if(y=Ru(x,d,D.value,v),y===u||y===n)return y}else for(M=Fc(l.length);M>x;x++)if(y=v?d(vo(D=l[x])[0],D[1]):d(l[x]),y===u||y===n)return y},a.BREAK=u,a.RETURN=n}),M1=rn("species"),C1=function(a,u){a=vo(a).constructor;var n;return a===void 0||(n=vo(a)[M1])==null?u:ca(n)},yf=function(a,u,n){var l=n===void 0;switch(u.length){case 0:return l?a():a.call(n);case 1:return l?a(u[0]):a.call(n,u[0]);case 2:return l?a(u[0],u[1]):a.call(n,u[0],u[1]);case 3:return l?a(u[0],u[1],u[2]):a.call(n,u[0],u[1],u[2]);case 4:return l?a(u[0],u[1],u[2],u[3]):a.call(n,u[0],u[1],u[2],u[3])}return a.apply(n,u)},_a=si.process,jl=si.setImmediate,Bs=si.clearImmediate,Xl=si.MessageChannel,xf=si.Dispatch,Af=0,Yl={},Gh=function(){var a=+this;if(Yl.hasOwnProperty(a)){var u=Yl[a];delete Yl[a],u()}},vd=function(a){Gh.call(a.data)};if(!jl||!Bs)if(jl=function(a){for(var u=[],n=1;arguments.length>n;)u.push(arguments[n++]);return Yl[++Af]=function(){yf(typeof a=="function"?a:Function(a),u)},bu(Af),Af},Bs=function(a){delete Yl[a]},yl(_a)=="process")var bu=function(a){_a.nextTick(Vn(Gh,a,1))};else if(xf&&xf.now)bu=function(a){xf.now(Vn(Gh,a,1))};else if(Xl){var Tm=new Xl,T1=Tm.port2;Tm.port1.onmessage=vd,bu=Vn(T1.postMessage,T1,1)}else si.addEventListener&&typeof postMessage=="function"&&!si.importScripts?(bu=function(a){si.postMessage(a+"","*")},si.addEventListener("message",vd,!1)):bu="onreadystatechange"in(_u?Go.createElement("script"):{})?function(a){Mh.appendChild(_u?Go.createElement("script"):{}).onreadystatechange=function(){Mh.removeChild(this),Gh.call(a)}}:function(a){setTimeout(Vn(Gh,a,1),0)};var yd=jl,Sm=si.MutationObserver||si.WebKitMutationObserver,xd=si.process,Ad=si.Promise,Im=yl(xd)=="process",_f={f:function(a){return new Bx(a)}},wf=function(a){try{return{e:!1,v:a()}}catch(u){return{e:!0,v:u}}},S1=si.navigator,Mf=S1&&S1.userAgent||"",Vu=function(a,u){if(vo(a),mo(u)&&u.constructor===a)return u;a=_f.f(a);var n=a.resolve;return n(u),a.promise},Zs=function(a,u,n){for(var l in u)n&&a[l]?a[l]=u[l]:Cs(a,l,u[l]);return a},Ko=rn("species"),I1=function(a){a=typeof ji[a]=="function"?ji[a]:si[a],ko&&a&&!a[Ko]&&yo.f(a,Ko,{configurable:!0,get:function(){return this}})},Em=function(){var a,u,n=function(){var y;for(Im&&(y=xd.domain)&&y.exit();a;){var M=a.fn;a=a.next;try{M()}catch(D){throw a?l():u=void 0,D}}u=void 0,y&&y.enter()};if(Im)var l=function(){xd.nextTick(n)};else if(!Sm||si.navigator&&si.navigator.standalone)if(Ad&&Ad.resolve){var v=Ad.resolve(void 0);l=function(){v.then(n)}}else l=function(){yd.call(si,n)};else{var d=!0,x=document.createTextNode("");new Sm(n).observe(x,{characterData:!0}),l=function(){x.data=d=!d}}return function(y){y={fn:y,next:void 0},u&&(u.next=y),a||(a=y,l()),u=y}}(),bh=si.TypeError,Ka=si.process,_d=Ka&&Ka.versions,fA=_d&&_d.v8||"",wa=si.Promise,Wu=Eu(Ka)=="process",wd=function(){},E1,Vh=E1=_f.f,Cf=!!function(){try{var a=wa.resolve(1),u=(a.constructor={})[rn("species")]=function(n){n(wd,wd)};return(Wu||typeof PromiseRejectionEvent=="function")&&a.then(wd)instanceof u&&fA.indexOf("6.6")!==0&&Mf.indexOf("Chrome/66")===-1}catch(n){}}(),Lm=function(a){var u;return mo(a)&&typeof(u=a.then)=="function"?u:!1},Rm=function(a,u){if(!a._n){a._n=!0;var n=a._c;Em(function(){for(var l=a._v,v=a._s==1,d=0;n.length>d;){var x=void 0,y=void 0,M=void 0,D=n[d++],U=v?D.ok:D.fail,C=D.resolve,E=D.reject,B=D.domain;try{U?(v||(a._h==2&&Pm(a),a._h=1),U===!0?M=l:(B&&B.enter(),M=U(l),B&&(B.exit(),x=!0)),M===D.promise?E(bh("Promise-chain cycle")):(y=Lm(M))?y.call(M,C,E):C(M)):E(l)}catch(O){B&&!x&&B.exit(),E(O)}}a._c=[],a._n=!1,u&&!a._h&&pA(a)})}},pA=function(a){yd.call(si,function(){var u=a._v,n=a._h!==1&&(a._a||a._c).length===0,l,v;if(n){var d=wf(function(){Wu?Ka.emit("unhandledRejection",u,a):(l=si.onunhandledrejection)?l({promise:a,reason:u}):(v=si.console)&&v.error&&v.error("Unhandled promise rejection",u)});a._h=Wu||a._h!==1&&(a._a||a._c).length===0?2:1}if(a._a=void 0,n&&d.e)throw d.v})},Pm=function(a){yd.call(si,function(){var u;Wu?Ka.emit("rejectionHandled",a):(u=si.onrejectionhandled)&&u({promise:a,reason:a._v})})},Wh=function(a){var u=this;u._d||(u._d=!0,u=u._w||u,u._v=a,u._s=2,u._a||(u._a=u._c.slice()),Rm(u,!0))},Dm=function(a){var u=this,n;if(!u._d){u._d=!0,u=u._w||u;try{if(u===a)throw bh("Promise can't be resolved itself");(n=Lm(a))?Em(function(){var l={_w:u,_d:!1};try{n.call(a,Vn(Dm,l,1),Vn(Wh,l,1))}catch(v){Wh.call(l,v)}}):(u._v=a,u._s=1,Rm(u,!1))}catch(l){Wh.call({_w:u,_d:!1},l)}}};if(!Cf){wa=function(a){Wl(this,wa,"Promise","_h"),ca(a),Js.call(this);try{a(Vn(Dm,this,1),Vn(Wh,this,1))}catch(u){Wh.call(this,u)}};var Js=function(a){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};Js.prototype=Zs(wa.prototype,{then:function(a,u){var n=Vh(C1(this,wa));return n.ok=typeof a=="function"?a:!0,n.fail=typeof u=="function"&&u,n.domain=Wu?Ka.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Rm(this,!1),n.promise},catch:function(a){return this.then(void 0,a)}});var Hn=function(){var a=new Js;this.promise=a,this.resolve=Vn(Dm,a,1),this.reject=Vn(Wh,a,1)};_f.f=Vh=function(a){return a===wa||a===L1?new Hn(a):E1(a)}}Er(Er.G+Er.W+Er.F*!Cf,{Promise:wa}),_l(wa,"Promise"),I1("Promise");var L1=ji.Promise;Er(Er.S+Er.F*!Cf,"Promise",{reject:function(a){var u=Vh(this),n=u.reject;return n(a),u.promise}}),Er(Er.S+1*Er.F,"Promise",{resolve:function(a){return Vu(this===L1?wa:this,a)}}),Er(Er.S+Er.F*!(Cf&&ef(function(a){wa.all(a).catch(wd)})),"Promise",{all:function(a){var u=this,n=Vh(u),l=n.resolve,v=n.reject,d=wf(function(){var x=[],y=0,M=1;Un(a,!1,function(D){var U=y++,C=!1;x.push(void 0),M++,u.resolve(D).then(function(E){C||(C=!0,x[U]=E,--M||l(x))},v)}),--M||l(x)});return d.e&&v(d.v),n.promise},race:function(a){var u=this,n=Vh(u),l=n.reject,v=wf(function(){Un(a,!1,function(d){u.resolve(d).then(n.resolve,l)})});return v.e&&l(v.v),n.promise}}),Er(Er.P+Er.R,"Promise",{finally:function(a){var u=C1(this,ji.Promise||si.Promise),n=typeof a=="function";return this.then(n?function(l){return Vu(u,a()).then(function(){return l})}:a,n?function(l){return Vu(u,a()).then(function(){throw l})}:a)}}),Er(Er.S,"Promise",{try:function(a){var u=_f.f(this);return a=wf(a),(a.e?u.reject:u.resolve)(a.v),u.promise}});var zi=ji.Promise,Om=It(function(a){a.exports={default:zi,__esModule:!0}}),ju=zt(Om),Xu=function(a,u){if(!mo(a)||a._t!==u)throw TypeError("Incompatible receiver, "+u+" required!");return a},dA=yo.f,Tf=Ts.fastKey,jh=ko?"_s":"size",Xh=function(a,u){var n=Tf(u);if(n!=="F")return a._i[n];for(a=a._f;a;a=a.n)if(a.k==u)return a},Yh={getConstructor:function(a,u,n,l){var v=a(function(d,x){Wl(d,v,u,"_i"),d._t=u,d._i=Na(null),d._f=void 0,d._l=void 0,d[jh]=0,x!=null&&Un(x,n,d[l],d)});return Zs(v.prototype,{clear:function(){for(var d=Xu(this,u),x=d._i,y=d._f;y;y=y.n)y.r=!0,y.p&&(y.p=y.p.n=void 0),delete x[y.i];d._f=d._l=void 0,d[jh]=0},delete:function(d){var x=Xu(this,u);if(d=Xh(x,d)){var y=d.n,M=d.p;delete x._i[d.i],d.r=!0,M&&(M.n=y),y&&(y.p=M),x._f==d&&(x._f=y),x._l==d&&(x._l=M),x[jh]--}return!!d},forEach:function(d){Xu(this,u);for(var x=Vn(d,1<arguments.length?arguments[1]:void 0,3),y;y=y?y.n:this._f;)for(x(y.v,y.k,this);y&&y.r;)y=y.p},has:function(d){return!!Xh(Xu(this,u),d)}}),ko&&dA(v.prototype,"size",{get:function(){return Xu(this,u)[jh]}}),v},def:function(a,u,n){var l=Xh(a,u),v;return l?l.v=n:(a._l=l={i:v=Tf(u,!0),k:u,v:n,p:u=a._l,n:void 0,r:!1},a._f||(a._f=l),u&&(u.n=l),a[jh]++,v!=="F"&&(a._i[v]=l)),a},getEntry:Xh,setStrong:function(a,u,n){Th(a,u,function(l,v){this._t=Xu(l,u),this._k=v,this._l=void 0},function(){for(var l=this._k,v=this._l;v&&v.r;)v=v.p;return this._t&&(this._l=v=v?v.n:this._t._f)?l=="keys"?bs(0,v.k):l=="values"?bs(0,v.v):bs(0,[v.k,v.v]):(this._t=void 0,bs(1))},n?"entries":"values",!n,!0),I1(u)}},gA=rn("species"),mA=function(a,u){if(wl(a)){var n=a.constructor;typeof n!="function"||n!==Array&&!wl(n.prototype)||(n=void 0),mo(n)&&(n=n[gA],n===null&&(n=void 0))}return new(n===void 0?Array:n)(u)},Zi=yo.f,vA=function(a,u){var n=a==1,l=a==2,v=a==3,d=a==4,x=a==6,y=a==5||x,M=u||mA;return function(D,U,C){var E=Object(ua(D)),B=Hg(E);U=Vn(U,C,3),C=Fc(B.length);var O=0;D=n?M(D,C):l?M(D,0):void 0;for(var H,V;C>O;O++)if((y||O in B)&&(H=B[O],V=U(H,O,E),a)){if(n)D[O]=V;else if(V)switch(a){case 3:return!0;case 5:return H;case 6:return O;case 2:D.push(H)}else if(d)return!1}return x?-1:v||d?d:D}}(0);(function(a,u,n,l,v,d){var x=si[a],y=x,M=v?"set":"add",D=y&&y.prototype,U={};return ko&&typeof y=="function"&&(d||D.forEach&&!fa(function(){new y().entries().next()}))?(y=u(function(C,E){Wl(C,y,a,"_c"),C._c=new x,E!=null&&Un(E,v,C[M],C)}),vA("add clear delete forEach get has set keys values entries toJSON".split(" "),function(C){var E=C=="add"||C=="set";C in D&&(!d||C!="clear")&&Cs(y.prototype,C,function(B,O){return Wl(this,y,C),!E&&d&&!mo(B)?C=="get"?void 0:!1:(B=this._c[C](B===0?0:B,O),E?this:B)})}),d||Zi(y.prototype,"size",{get:function(){return this._c.size}})):(y=l.getConstructor(u,a,v,M),Zs(y.prototype,n),Ts.NEED=!0),_l(y,a),U[a]=y,Er(Er.G+Er.W+Er.F,U),d||l.setStrong(y,a,v),y})("Map",function(a){return function(){return a(this,0<arguments.length?arguments[0]:void 0)}},{get:function(a){return(a=Yh.getEntry(Xu(this,"Map"),a))&&a.v},set:function(a,u){return Yh.def(Xu(this,"Map"),a===0?0:a,u)}},Yh,!0),Er(Er.P+Er.R,"Map",{toJSON:function(a){return function(){if(Eu(this)!=a)throw TypeError(a+"#toJSON isn't generic");var u=[];return Un(this,!1,u.push,u,void 0),u}}("Map")}),function(a){Er(Er.S,a,{of:function(){for(var u=arguments.length,n=Array(u);u--;)n[u]=arguments[u];return new this(n)}})}("Map"),function(a){Er(Er.S,a,{from:function(u,n,l){var v;if(ca(this),(v=n!==void 0)&&ca(n),u==null)return new this;var d=[];if(v){var x=0,y=Vn(n,l,2);Un(u,!1,function(M){d.push(y(M,x++))})}else Un(u,!1,d.push,d);return new this(d)}})}("Map");var yA=ji.Map,Xn=It(function(a){a.exports={default:yA,__esModule:!0}}),Yu=zt(Xn),Ri=It(function(a,u){u.__esModule=!0;var n=bo&&bo.__esModule?bo:{default:bo};u.default=function(l,v,d){return v in l?(0,n.default)(l,v,{value:d,enumerable:!0,configurable:!0,writable:!0}):l[v]=d,l}}),Zh=zt(Ri),_n,Sf,xA=(_n={},Zh(_n,1,1),Zh(_n,2,1),Zh(_n,3,1),_n),R1=(Sf={},Zh(Sf,1,1),Zh(Sf,2,1),Zh(Sf,3,1),Sf),Zl=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.vertCount=0,n.bufferMap={},n.bufferData=[],n.autoUpdate=!0,l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Yu,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,1,1,.8],speed:1,size:5,pointFade:!0,pointFadeBuffer:1,minLineLength:2,animationType:2,shapeType:2,depthTest:!1,delay:0,unit:"px",padding:0}}},{key:"initialize",value:function(n){this.gl=n,this.texture=null,this.isUseTexture=!1;var l=this.getOptions();this.updateUniformsFromOptions(l),this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec3 aPos;attribute vec3 aNextPos;attribute vec4 aColor;attribute float aIndex;attribute float aNextIndex;attribute float aLength;attribute float aSpeed;attribute float aDelay;attribute vec3 aUV;uniform float uSize;uniform mat4 u_matrix;uniform float uOriginSpeed;uniform float uElapsedSteps;uniform int uAnimationType;uniform int uPointFade;uniform float uPointFadeBuffer;uniform float uZoomUnits;varying float vAddOpacity;varying vec3 vUV;varying vec4 vColor;void main(){vColor=aColor;if(uAnimationType==1){if(abs(aIndex-mod(uElapsedSteps,aLength))>.1){gl_Position=vec4(-2.,-2.,0,1.0);return;}gl_Position=u_matrix*vec4(aPos.xyz,1.0);vAddOpacity=1.;}else if(uAnimationType==2){float lineLength=aLength-1.;float cIndex=mod(uElapsedSteps,lineLength);float rest=cIndex-aIndex;if(rest<1.&&rest>=0.){if(uPointFade==1){if(cIndex<uPointFadeBuffer){vAddOpacity=cIndex/uPointFadeBuffer;}else if(cIndex>lineLength-uPointFadeBuffer){vAddOpacity=(lineLength-cIndex)/uPointFadeBuffer;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}else if(uAnimationType==3){float speedRatio=aSpeed/uOriginSpeed;float percent=mod(mod(uElapsedSteps*aSpeed,aLength)/aLength-aDelay,1.0);if(percent<=aNextIndex&&percent>=aIndex){if(uPointFade==1){float fadePercent=uPointFadeBuffer*1000./aLength;if(percent<fadePercent){vAddOpacity=percent/fadePercent;}else if(percent>1.-fadePercent){vAddOpacity=(1.-percent)/fadePercent;}else{vAddOpacity=1.;}}else{vAddOpacity=1.;}float rest=(percent-aIndex)/(aNextIndex-aIndex);gl_Position=u_matrix*vec4(aPos.x+(aNextPos.x-aPos.x)*rest,aPos.y+(aNextPos.y-aPos.y)*rest,aPos.z+(aNextPos.z-aPos.z)*rest,1.0);}else{gl_Position=vec4(-2.,-2.,0,1.0);return;}}vUV=aUV;gl_PointSize=uSize/uZoomUnits;}",fragmentShader:"precision highp float;uniform int ushapeType;uniform bool uUseTexture;uniform sampler2D uSampler;varying float vAddOpacity;varying vec4 vColor;varying vec3 vUV;void main(){if(ushapeType==2){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}else if(ushapeType==3){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}gl_FragColor=vec4(vColor.rgb,vColor.a*smoothstep(1.0,0.0,d*2.)*vAddOpacity);}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vAddOpacity);}if(uUseTexture){float ratio=vUV.z;vec2 uv=vUV.xy;gl_FragColor=texture2D(uSampler,vec2(gl_PointCoord.x*ratio+uv.x,1.0-(uv.y+gl_PointCoord.y*ratio)));}}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"bindAttributeBufferData",value:function(n,l,v,d){var x=n.createBuffer();n.bindBuffer(n.ARRAY_BUFFER,x),v=new Float32Array(v),n.bufferData(n.ARRAY_BUFFER,v,n.STATIC_DRAW),this.bufferMap[l]={buffer:x,data:v,elementSize:d}}},{key:"onChanged",value:function(n,l){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(Array.isArray(l)||(l=[]),this.processCache(n,l,v))}},{key:"processCache",value:function(n,l,v){var d=this;this.cachedData=[];for(var x=n.icon,y=n.speed,M=n.color,D=0;D<l.length;D++){var U=l[D].geometry.coordinates,C=this.getProperty("color",M,l[D]);C=this.normizedColor(C);var E=this.getProperty("icon",x,l[D]),B=this.getProperty("speed",y,l[D]),O=this.getProperty("delay",0,l[D]);U&&(this.cachedData.push({coordinates:U,color:C,icon:E,speed:B,delay:O}),this.iconHash.get(E)||this.iconHash.set(E,E))}l=js(this.iconHash.entries()).filter(function(H){return typeof H[1]=="string"}).map(function(H){var V=yi(H,2)[0];return new ju(function(G,j){d.url2canvas(V,function(Y){d.iconHash.set(V,Y),G()})})}),ju.all(l).then(function(H){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=0,y=[],M=new Yu;if(n.icon){x=!0;var D=!1,U=void 0;try{for(var C=Po(this.iconHash),E;!(x=(E=C.next()).done);x=!0){var B=yi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=H+l;y.push({w:V,h:V,width:H,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!x&&C.return&&C.return()}finally{if(D)throw U}}for(C=xu(y),E=0;E<y.length;E++)B=y[E],M.get(B.key)||M.set(B.key,B);for(x=Math.max(Ie(C.w),Ie(C.h)),v.width=x||1,v.height=x||1,d.save(),v=0;v<y.length;v++)C=y[v],d.drawImage(C.icon,C.x+l,C.y+l,C.width,C.width);d.restore()}this.loadTexture(),this.buildVertex(n,M,x)}},{key:"buildVertex",value:function(n,l,v){var d=this.gl;this.updateUniformsFromOptions(n);for(var x=[],y=[],M=[],D=[],U=[],C=[],E=[],B=[],O=[],H=n.minLineLength,V=0;V<this.cachedData.length;V++){var G=this.cachedData[V],j=G.coordinates,Y=G.icon,$=G.speed,it=G.delay;G=G.color;var nt=j.length,pt=[];if(!(nt<H)){for(n.icon&&(pt=(pt=l.get(Y))?[pt.x/v,pt.y/v,pt.w/v]:[0,0,0]),Y=0;Y<nt;++Y){var Rt=this.normizedPoint(j[Y]);x.push(Rt[0]),x.push(Rt[1]),x.push(Rt[2]||0),y.push.apply(y,Jr(G)),O.push.apply(O,Jr(pt)),this.animationType!==3&&(M.push(Y),U.push(nt))}if(this.animationType!==1){for(pt=x.length-3*nt+3,nt=x.length,j=pt;j<nt;++j)C.push(x[j]);if(x.splice(nt-3,3),O.splice(nt-3,2),y.splice(nt-3,4),this.animationType===2)M.pop(),U.pop();else if(this.animationType===3){for(pt-=3,nt=x.length-3,j=0,G=[],Y=pt;Y<=nt;Y+=3)pt=Math.sqrt(Math.pow(C[Y]-x[Y],2)+Math.pow(C[Y+1]-x[Y+1],2)+Math.pow(C[Y+2]-x[Y+2],2)),j+=pt,G.push(pt);for(M.push(0),E.push($),it/=j/$,B.push(it),Y=nt=0,Rt=G.length-1;Y<Rt;++Y)nt+=G[Y],pt=nt/j,M.push(pt),D.push(pt),U.push(j),E.push($),B.push(it);D.push(1),U.push(j)}}}}this.bindAttributeBufferData(d,"aPos",x,3),this.bindAttributeBufferData(d,"aIndex",M,1),this.bindAttributeBufferData(d,"aLength",U,1),this.bindAttributeBufferData(d,"aColor",y,4),this.animationType!==1&&(this.bindAttributeBufferData(d,"aNextPos",C,3),this.animationType===3&&(this.bindAttributeBufferData(d,"aNextIndex",D,1),this.bindAttributeBufferData(d,"aSpeed",E,1),this.bindAttributeBufferData(d,"aDelay",B,1))),n.icon&&this.bindAttributeBufferData(d,"aUV",O,3),this.vertCount=x.length/3}},{key:"updateUniformsFromOptions",value:function(n){this.startTime=new Date().getTime(),xA[n.animationType]||(n.animationType=2),R1[n.shapeType]||(n.shapeType=2),(isNaN(n.minLineLength)||2>n.minLineLength)&&(n.minLineLength=2),this.animationType=n.animationType}},{key:"renderAttributeArr",value:function(n,l,v){if(l.attributes[v]!==void 0){var d=this.bufferMap[v];d&&(n.bindBuffer(n.ARRAY_BUFFER,d.buffer),n.enableVertexAttribArray(l.attributes[v]),n.vertexAttribPointer(l.attributes[v],d.elementSize,n.FLOAT,!1,d.data.BYTES_PER_ELEMENT*d.elementSize,0))}}},{key:"render",value:function(n){var l=n.gl;if(n=n.matrix,!(0>=this.vertCount)){var v=this.getOptions(),d=this.program;l.useProgram(d.program),this.renderAttributeArr(l,d,"aPos"),this.renderAttributeArr(l,d,"aIndex"),this.renderAttributeArr(l,d,"aLength"),this.renderAttributeArr(l,d,"aColor"),this.animationType!==1&&(this.renderAttributeArr(l,d,"aNextPos"),this.animationType===3&&(this.renderAttributeArr(l,d,"aNextIndex"),this.renderAttributeArr(l,d,"aSpeed"),this.renderAttributeArr(l,d,"aDelay"))),v.icon&&this.texture&&(this.renderAttributeArr(l,d,"aUV"),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.texture),l.uniform1i(d.uniforms.uSampler,0)),l.uniform1i(d.uniforms.uUseTexture,this.isUseTexture);var x=new Date().getTime()-this.startTime;x<this.options.delay?x=0:(x-=this.options.delay,x=this.animationType===1?Math.round(x/1e3*this.options.speed*20):this.animationType===3?x/1e3*this.options.speed*1e3:x/1e3*this.options.speed);var y=this.options.size;if(Array.isArray(y)){var M=this.map.map.getMaxZoom(),D=this.map.map.getMinZoom();y=y[0]+(this.map.getZoom()-D)/(M-D)*(y[1]-y[0])}l.uniformMatrix4fv(d.uniforms.u_matrix,!1,n),l.uniform1f(d.uniforms.uSize,y),l.uniform1f(d.uniforms.uElapsedSteps,x),l.uniform1f(d.uniforms.uOriginSpeed,this.options.speed),l.uniform1i(d.uniforms.uAnimationType,this.animationType),l.uniform1i(d.uniforms.ushapeType,this.options.shapeType),l.uniform1i(d.uniforms.uPointFade,this.options.pointFade?1:0),l.uniform1f(d.uniforms.uPointFadeBuffer,this.options.pointFadeBuffer),l.uniform1f(d.uniforms.uZoomUnits,this.options.unit==="m"?this.map.getZoomUnits():1),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:v.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],depthTest:!!v.depthTest}),l.drawArrays(l.POINTS,0,this.vertCount)}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":Qr(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=document.createElement("canvas");d.width=128,d.height=128,d.getContext("2d").drawImage(v,0,0,128,128),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas&&this.getOptions().icon?sn(this.gl,this.canvas,function(l){n.isUseTexture=!0,n.texture=l}):(this.isUseTexture=!1,this.texture=null)}}]),u}(Ti);Zl.ANIMATION_TYPE_LEAP=1,Zl.ANIMATION_TYPE_SMOOTH=2,Zl.ANIMATION_TYPE_UNIFORM_SPEED=3,Zl.SHAPE_TYPE_SQUARE=1,Zl.SHAPE_TYPE_CIRCLE=2,Zl.SHAPE_TYPE_CIRCLE_GRADIENT=3;var Yn=function(){function a(u,n){Ke(this,a),this.layer=u,this.gl=n,this.initData()}return Qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]}}},{key:"getData",value:function(){return this.outWall3d}},{key:"onLayerChange",value:function(u,n){this.initData();for(var l=u.color,v=u.height,d=u.gradient,x=u.enablePreciseMap,y=u.repeatMap,M=u.closePath,D=this.gl,U=0;U<n.length;U++){var C=n[U],E=C.color||l;"properties"in C&&"color"in C.properties&&(E=C.properties.color),d||Object.prototype.toString.call(E)!=="[object Function]"||(E=E(C));var B=this.layer.normizedColor(d?d[0]:E);E=this.layer.normizedColor(d?d[1]:E);var O=C.height||v;if("properties"in C&&"height"in C.properties&&(O=C.properties.height),Object.prototype.toString.call(O)==="[object Function]"&&(O=O(C)),C.geometry.type==="MultiLineString"||C.geometry.type==="Polygon")for(var H=0;H<C.geometry.coordinates.length;H++){var V=C.geometry.coordinates[H];M&&!Ee(V)&&V.push(V[0]);for(var G=[],j=[],Y=0,$=0;$<V.length;$++){var it=this.layer.normizedPoint(V[$]);if(0<$&&(x||y)){var nt=this.layer.normizedPoint(V[$-1]);Y+=Math.sqrt(Math.pow(it[0]-nt[0],2)+Math.pow(it[1]-nt[1],2))}G.push(it),j.push(Y)}this.processData(this.outWall3d,u,G,j,B,E,O)}else{for(C=C.geometry.coordinates,M&&!Ee(C)&&C.push(C[0]),H=[],V=[],j=G=0;j<C.length;j++)Y=this.layer.normizedPoint(C[j]),0<j&&(x||y)&&($=this.layer.normizedPoint(C[j-1]),G+=Math.sqrt(Math.pow(Y[0]-$[0],2)+Math.pow(Y[1]-$[1],2))),H.push(Y),V.push(G);this.processData(this.outWall3d,u,H,V,B,E,O)}}for(u=0;u<this.outWall3d.vertex.length;u++){for(n=[],l=this.outWall3d.vertex[u].length,v=0;v<l;v++)n.push.apply(n,Jr(this.outWall3d.vertex[u][v]));l=D.createBuffer(),D.bindBuffer(D.ARRAY_BUFFER,l),D.bufferData(D.ARRAY_BUFFER,new Float32Array(n),D.STATIC_DRAW),this.outWall3d.vertexBuffer[u]=l,D.bindBuffer(D.ARRAY_BUFFER,null),l=D.createBuffer(),D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,l),D.bufferData(D.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[u]),D.STATIC_DRAW),this.outWall3d.indexBuffer[u]=l,D.bindBuffer(D.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d,x,y){var M=v[v.length-1],D=u.vertex[u.vertex.length-1],U=u.index[u.index.length-1],C=l.length;for((!U||65536<=U.length+2*C+2)&&(D=[],U=[],u.vertex.push(D),u.index.push(U)),(u=D.length)&&U.push(u-1,u),u=0;u<C;u++){var E=[],B=[],O=l[u];E.push(O[0],O[1],O[2]+y),E.push(d[0],d[1],d[2],d[3]),B.push(O[0],O[1],O[2]),B.push(x[0],x[1],x[2],x[3]),n.texture&&(O=v[u],n.enablePreciseMap||n.repeatMap?(E.push(O,1,M),B.push(O,0,M)):(E.push(u,1,C-1),B.push(u,0,C-1))),O=D.length,D.push(E,B),U.push(O,O+1)}}}]),a}(),AA=function(a){function u(n,l){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n,l))}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{texture:null,enablePreciseMap:!1,repeatMap:0,height:100,closePath:!1,color:[1,1,1,1]}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new Yn(this,this.gl),this.texture=null,this.isUseTexture=!1,this.vertexLength=10,this.program=new qr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform bool uUseTexture;attribute vec3 aPos;attribute vec4 aColor;attribute vec2 aTextureCoords;attribute float aTotalDistance;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}if(uUseTexture){vTextureCoords=aTextureCoords;vTotalDistance=aTotalDistance;}gl_Position=u_matrix*vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform bool uUseTexture;uniform float uDistance;uniform sampler2D uSampler;varying vec2 vTextureCoords;varying float vTotalDistance;varying vec4 vColor;void main(){if(uUseTexture){float uvx=vTextureCoords.x/vTotalDistance;if(uDistance>0.0){uvx=mod(vTextureCoords.x,uDistance)/uDistance;}gl_FragColor=vec4(1.0,1.0,1.0,1.0)*texture2D(uSampler,vec2(uvx,vTextureCoords.y));}else{gl_FragColor=vColor;}}"}),this.loadTexture()}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.dataMgr.onLayerChange(n,l),v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;if(l.useProgram(x.program),d.texture){if(!this.texture)return;l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.texture),l.uniform1i(x.uniforms.uSampler,0)}for(this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],depthMask:!!d.texture,depthFunc:d.texture?l.LESS:l.LEQUAL}),d.texture?l.enableVertexAttribArray(x.attributes.aTextureCoords):l.disableVertexAttribArray(x.attributes.aTextureCoords),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1i(x.uniforms.uUseTexture,this.isUseTexture),l.uniform1f(x.uniforms.uDistance,d.repeatMap),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,3,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,3*M),d.texture&&(l.vertexAttribPointer(x.attributes.aTextureCoords,2,l.FLOAT,!1,y,7*M),l.vertexAttribPointer(x.attributes.aTotalDistance,1,l.FLOAT,!1,y,9*M)),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}}}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.texture?(this.isUseTexture=!0,sn(this.gl,v.texture,function(d,x){l.image=x,l.texture=d,n&&n(),l.webglLayer.render()})):(this.isUseTexture=!1,this.image=this.texture=null,n&&n())}}]),u}(Ti),_A=function(){function a(u,n){Ke(this,a),this.layer=u,this.gl=n,this.initData()}return Qe(a,[{key:"initData",value:function(){this.outWall3d={vertex:[],vertexBuffer:[],index:[],indexBuffer:[]},this.maxLength=0}},{key:"getData",value:function(){return this.outWall3d}},{key:"getMaxDataLength",value:function(){return this.maxLength}},{key:"onLayerChange",value:function(u,n){this.initData();var l=u.color,v=u.height,d=u.gradient;u=this.gl;for(var x=0;x<n.length;x++){var y=n[x].geometry.coordinates,M=y.length;this.maxLength=M>this.maxLength?M:this.maxLength;for(var D=[],U=0;U<M;U++){var C=this.layer.normizedPoint(y[U]);D.push(C)}M=n[x].color||l,"properties"in n[x]&&"color"in n[x].properties&&(M=n[x].properties.color),d||Object.prototype.toString.call(M)!=="[object Function]"||(M=M(n[x])),y=this.layer.normizedColor(d?d[0]:M),M=this.layer.normizedColor(d?d[1]:M),U=n[x].height||v,"properties"in n[x]&&"height"in n[x].properties&&(U=n[x].properties.height),Object.prototype.toString.call(U)==="[object Function]"&&(U=U(n[x])),this.processData(this.outWall3d,D,y,M,U)}for(n=0;n<this.outWall3d.vertex.length;n++){for(l=[],v=this.outWall3d.vertex[n].length,d=0;d<v;d++)l.push.apply(l,Jr(this.outWall3d.vertex[n][d]));v=u.createBuffer(),u.bindBuffer(u.ARRAY_BUFFER,v),u.bufferData(u.ARRAY_BUFFER,new Float32Array(l),u.STATIC_DRAW),this.outWall3d.vertexBuffer[n]=v,u.bindBuffer(u.ARRAY_BUFFER,null),v=u.createBuffer(),u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,v),u.bufferData(u.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.outWall3d.index[n]),u.STATIC_DRAW),this.outWall3d.indexBuffer[n]=v,u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,null)}}},{key:"processData",value:function(u,n,l,v,d){var x=u.vertex[u.vertex.length-1],y=u.index[u.index.length-1],M=n.length;for((!y||65536<=y.length+2*M+2)&&(x=[],y=[],u.vertex.push(x),u.index.push(y)),(u=x.length)&&y.push(u-1,u),u=0;u<M;u++){var D=[],U=[],C=n[u];D.push(C[0],C[1]),D.push(C[2]?Number(C[2])+d:d),D.push(C[3]?Number(C[3]):u),D.push(l[0],l[1],l[2],l[3]),U.push(C[0],C[1]),U.push(C[2]?Number(C[2]):0),U.push(C[3]?Number(C[3]):u),U.push(v[0],v[1],v[2],v[3]),C=x.length,x.push(D,U),y.push(C,C+1)}}}]),a}(),Pi=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{height:100,color:[1,1,1,1],trailLength:3,step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.dataMgr=new _A(this,this.gl),this.program=new qr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;varying float vTime;void main(){vTime=1.0-((currentTime-aPos.w)/trailLength);vColor=aColor;gl_Position=u_matrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"})}},{key:"onChanged",value:function(n,l){this.gl&&(this.dataMgr.onLayerChange(n,l),n.endTime===void 0&&(this.endTime=this.dataMgr.getMaxDataLength()))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;if((n=this.dataMgr.getData())&&!(0>=n.vertex.length)){var d=this.getOptions(),x=this.program;for(l.useProgram(x.program),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.enableVertexAttribArray(x.attributes.aPos),l.enableVertexAttribArray(x.attributes.aColor),l.uniformMatrix4fv(x.uniforms.u_matrix,!1,v),l.uniform1f(x.uniforms.currentTime,this.time),l.uniform1f(x.uniforms.trailLength,d.trailLength),v=0;v<n.vertex.length;v++)if(!(0>=n.vertex[v].length)){var y=n.vertex[v],M=new Float32Array(y[0]).BYTES_PER_ELEMENT;y=M*y[0].length,l.bindBuffer(l.ARRAY_BUFFER,n.vertexBuffer[v]),l.vertexAttribPointer(x.attributes.aPos,4,l.FLOAT,!1,y,0),l.vertexAttribPointer(x.attributes.aColor,4,l.FLOAT,!1,y,4*M),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,n.indexBuffer[v]),l.drawElements(l.TRIANGLE_STRIP,n.index[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}this.time+=d.step,this.time>this.endTime&&(this.time=this.startTime)}}}]),u}(Ti),P1=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.simpleLineLayer=new cd(n.getHeatOptions()),n.children=[n.simpleLineLayer],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{blend:"normal",gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}}}},{key:"onDataChanged",value:function(n){this.simpleLineLayer.setData(n)}},{key:"onOptionsChanged",value:function(n){this.simpleLineLayer.setOptions(this.getHeatOptions())}},{key:"getHeatOptions",value:function(){var n=this.getOptions(),l=n.max,v=n.min;l===void 0&&(v=this.getDataRange(),l=v.max,v=v.min);var d=new _i({max:l,min:v,gradient:n.gradient});return n.color=function(x){var y=~~x.count||1;return"properties"in x&&"count"in x.properties&&(y=~~x.properties.count),x=d.getImageData(y),[x[0]/255,x[1]/255,x[2]/255,x[3]/255]},n}},{key:"getDataRange",value:function(){var n=this.getData(),l=0,v=0;n[0]&&(l=~~n[0].count||1,v=~~n[0].count||1),"properties"in n[0]&&"count"in n[0].properties&&(l=~~n[0].properties.count,v=~~n[0].properties.count);for(var d=n.length,x=0;x<d;x++){var y=~~n[x].count||1;"properties"in n[x]&&"count"in n[x].properties&&(y=~~n[x].properties.count),l=Math.max(y,l),v=Math.min(y,v)}return{max:l/2,min:v}}}]),u}(Aa),Fm=It(function(a,u){(function(n,l){a.exports=l()})(zg,function(){function n(j,Y,$,it,nt,pt){if(!(nt-it<=$)){var Rt=it+nt>>1;l(j,Y,Rt,it,nt,pt%2),n(j,Y,$,it,Rt-1,pt+1),n(j,Y,$,Rt+1,nt,pt+1)}}function l(j,Y,$,it,nt,pt){for(;nt>it;){if(600<nt-it){var Rt=nt-it+1,Et=$-it+1,Jt=Math.log(Rt),oe=.5*Math.exp(2*Jt/3);Jt=.5*Math.sqrt(Jt*oe*(Rt-oe)/Rt)*(0>Et-Rt/2?-1:1),l(j,Y,$,Math.max(it,Math.floor($-Et*oe/Rt+Jt)),Math.min(nt,Math.floor($+(Rt-Et)*oe/Rt+Jt)),pt)}for(Rt=Y[2*$+pt],Et=it,oe=nt,v(j,Y,it,$),Y[2*nt+pt]>Rt&&v(j,Y,it,nt);Et<oe;){for(v(j,Y,Et,oe),Et++,oe--;Y[2*Et+pt]<Rt;)Et++;for(;Y[2*oe+pt]>Rt;)oe--}Y[2*it+pt]===Rt?v(j,Y,it,oe):(oe++,v(j,Y,oe,nt)),oe<=$&&(it=oe+1),$<=oe&&(nt=oe-1)}}function v(j,Y,$,it){d(j,$,it),d(Y,2*$,2*it),d(Y,2*$+1,2*it+1)}function d(j,Y,$){var it=j[Y];j[Y]=j[$],j[$]=it}function x(j,Y){return j=j.geometry.coordinates,{x:j[0]/360+.5,y:D(j[1]),zoom:1/0,index:Y,parentId:-1}}function y(j){var Y=j.id,$=M(j);return{type:"Feature",id:Y,properties:$,geometry:{type:"Point",coordinates:[360*(j.x-.5),360*Math.atan(Math.exp((180-360*j.y)*Math.PI/180))/Math.PI-90]}}}function M(j){var Y=j.numPoints,$=1e4<=Y?Math.round(Y/1e3)+"k":1e3<=Y?Math.round(Y/100)/10+"k":Y;return U(U({},j.properties),{cluster:!0,cluster_id:j.id,point_count:Y,point_count_abbreviated:$})}function D(j){return j=Math.sin(j*Math.PI/180),j=.5-.25*Math.log((1+j)/(1-j))/Math.PI,0>j?0:1<j?1:j}function U(j,Y){for(var $ in Y)j[$]=Y[$];return j}function C(j){return j.x}function E(j){return j.y}var B=function(j){return j[0]},O=function(j){return j[1]},H=function(j,Y,$,it,nt){Y===void 0&&(Y=B),$===void 0&&($=O),it===void 0&&(it=64),nt===void 0&&(nt=Float64Array),this.nodeSize=it,this.points=j;var pt=this.ids=new(65536>j.length?Uint16Array:Uint32Array)(j.length);nt=this.coords=new nt(2*j.length);for(var Rt=0;Rt<j.length;Rt++)pt[Rt]=Rt,nt[2*Rt]=Y(j[Rt]),nt[2*Rt+1]=$(j[Rt]);n(pt,nt,it,0,pt.length-1,0)};H.prototype.range=function(j,Y,$,it){for(var nt=this.ids,pt=this.coords,Rt=this.nodeSize,Et=[0,nt.length-1,0],Jt=[],oe,Se;Et.length;){var ge=Et.pop(),Xe=Et.pop(),_r=Et.pop();if(Xe-_r<=Rt)for(ge=_r;ge<=Xe;ge++)oe=pt[2*ge],Se=pt[2*ge+1],oe>=j&&oe<=$&&Se>=Y&&Se<=it&&Jt.push(nt[ge]);else{var he=Math.floor((_r+Xe)/2);oe=pt[2*he],Se=pt[2*he+1],oe>=j&&oe<=$&&Se>=Y&&Se<=it&&Jt.push(nt[he]);var Ue=(ge+1)%2;(ge===0?j<=oe:Y<=Se)&&(Et.push(_r),Et.push(he-1),Et.push(Ue)),(ge===0?$>=oe:it>=Se)&&(Et.push(he+1),Et.push(Xe),Et.push(Ue))}}return Jt},H.prototype.within=function(j,Y,$){for(var it=this.ids,nt=this.coords,pt=this.nodeSize,Rt=[0,it.length-1,0],Et=[],Jt=$*$;Rt.length;){var oe=Rt.pop(),Se=Rt.pop(),ge=Rt.pop();if(Se-ge<=pt)for(oe=ge;oe<=Se;oe++){ge=nt[2*oe]-j;var Xe=nt[2*oe+1]-Y;ge*ge+Xe*Xe<=Jt&&Et.push(it[oe])}else{Xe=Math.floor((ge+Se)/2);var _r=nt[2*Xe],he=nt[2*Xe+1],Ue=_r-j,Sr=he-Y;Ue*Ue+Sr*Sr<=Jt&&Et.push(it[Xe]),Ue=(oe+1)%2,(oe===0?j-$<=_r:Y-$<=he)&&(Rt.push(ge),Rt.push(Xe-1),Rt.push(Ue)),(oe===0?j+$>=_r:Y+$>=he)&&(Rt.push(Xe+1),Rt.push(Se),Rt.push(Ue))}}return Et};var V={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(j){return j}},G=function(j){this.options=U(Es(V),j),this.trees=Array(this.options.maxZoom+1)};return G.prototype.load=function(j){var Y=this.options,$=Y.minZoom,it=Y.maxZoom;Y=Y.nodeSize,this.points=j;for(var nt=[],pt=0;pt<j.length;pt++)j[pt].geometry&&nt.push(x(j[pt],pt));for(this.trees[it+1]=new H(nt,C,E,Y,Float32Array),j=it;j>=$;j--)nt=this._cluster(nt,j),this.trees[j]=new H(nt,C,E,Y,Float32Array);return this},G.prototype.getClusters=function(j,Y){var $=((j[0]+180)%360+360)%360-180,it=Math.max(-90,Math.min(90,j[1])),nt=j[2]===180?180:((j[2]+180)%360+360)%360-180,pt=Math.max(-90,Math.min(90,j[3]));if(360<=j[2]-j[0])$=-180,nt=180;else if($>nt)return $=this.getClusters([$,it,180,pt],Y),it=this.getClusters([-180,it,nt,pt],Y),$.concat(it);Y=this.trees[this._limitZoom(Y)],j=[];var Rt=0;for(it=Y.range($/360+.5,D(pt),nt/360+.5,D(it));Rt<it.length;Rt+=1)nt=Y.points[it[Rt]],j.push(nt.numPoints?y(nt):this.points[nt.index]);return j},G.prototype.getChildren=function(j){var Y=this._getOriginId(j),$=this._getOriginZoom(j),it=this.trees[$];if(!it)throw Error("No cluster with the specified id.");var nt=it.points[Y];if(!nt)throw Error("No cluster with the specified id.");Y=[];var pt=0;for($=it.within(nt.x,nt.y,this.options.radius/(this.options.extent*Math.pow(2,$-1)));pt<$.length;pt+=1)nt=it.points[$[pt]],nt.parentId===j&&Y.push(nt.numPoints?y(nt):this.points[nt.index]);if(Y.length===0)throw Error("No cluster with the specified id.");return Y},G.prototype.getLeaves=function(j,Y,$){var it=[];return this._appendLeaves(it,j,Y||10,$||0,0),it},G.prototype.getTile=function(j,Y,$){var it=this.trees[this._limitZoom(j)];j=Math.pow(2,j);var nt=this.options;nt=nt.radius/nt.extent;var pt=($-nt)/j,Rt=($+1+nt)/j,Et={features:[]};return this._addTileFeatures(it.range((Y-nt)/j,pt,(Y+1+nt)/j,Rt),it.points,Y,$,j,Et),Y===0&&this._addTileFeatures(it.range(1-nt/j,pt,1,Rt),it.points,j,$,j,Et),Y===j-1&&this._addTileFeatures(it.range(0,pt,nt/j,Rt),it.points,-1,$,j,Et),Et.features.length?Et:null},G.prototype.getClusterExpansionZoom=function(j){for(var Y=this._getOriginZoom(j)-1;Y<=this.options.maxZoom&&(j=this.getChildren(j),Y++,j.length===1);)j=j[0].properties.cluster_id;return Y},G.prototype._appendLeaves=function(j,Y,$,it,nt){var pt=0;for(Y=this.getChildren(Y);pt<Y.length;pt+=1){var Rt=Y[pt],Et=Rt.properties;if(Et&&Et.cluster?nt=nt+Et.point_count<=it?nt+Et.point_count:this._appendLeaves(j,Et.cluster_id,$,it,nt):nt<it?nt++:j.push(Rt),j.length===$)break}return nt},G.prototype._addTileFeatures=function(j,Y,$,it,nt,pt){for(var Rt=0;Rt<j.length;Rt+=1){var Et=Y[j[Rt]],Jt=Et.numPoints,oe={type:1,geometry:[[Math.round(this.options.extent*(Et.x*nt-$)),Math.round(this.options.extent*(Et.y*nt-it))]],tags:Jt?M(Et):this.points[Et.index].properties},Se=void 0;Jt?Se=Et.id:this.options.generateId?Se=Et.index:this.points[Et.index].id&&(Se=this.points[Et.index].id),Se!==void 0&&(oe.id=Se),pt.features.push(oe)}},G.prototype._limitZoom=function(j){return Math.max(this.options.minZoom,Math.min(+j,this.options.maxZoom+1))},G.prototype._cluster=function(j,Y){var $=[],it=this.options,nt=it.reduce,pt=it.minPoints;it=it.radius/(it.extent*Math.pow(2,Y));for(var Rt=0;Rt<j.length;Rt++){var Et=j[Rt];if(!(Et.zoom<=Y)){Et.zoom=Y;for(var Jt=this.trees[Y+1],oe=Jt.within(Et.x,Et.y,it),Se=Et.numPoints||1,ge=Se,Xe=0,_r=oe;Xe<_r.length;Xe+=1){var he=Jt.points[_r[Xe]];he.zoom>Y&&(ge+=he.numPoints||1)}if(ge>=pt){Xe=Et.x*Se,_r=Et.y*Se,Se=nt&&1<Se?this._map(Et,!0):null,he=(Rt<<5)+(Y+1)+this.points.length;for(var Ue=0;Ue<oe.length;Ue+=1){var Sr=Jt.points[oe[Ue]];if(!(Sr.zoom<=Y)){Sr.zoom=Y;var Ir=Sr.numPoints||1;Xe+=Sr.x*Ir,_r+=Sr.y*Ir,Sr.parentId=he,nt&&(Se||(Se=this._map(Et,!0)),nt(Se,this._map(Sr)))}}Et.parentId=he,$.push({x:Xe/ge,y:_r/ge,zoom:1/0,id:he,parentId:-1,numPoints:ge,properties:Se})}else if($.push(Et),1<ge)for(Et=0,ge=oe;Et<ge.length;Et+=1)oe=Jt.points[ge[Et]],oe.zoom<=Y||(oe.zoom=Y,$.push(oe))}}return $},G.prototype._getOriginId=function(j){return j-this.points.length>>5},G.prototype._getOriginZoom=function(j){return(j-this.points.length)%32},G.prototype._map=function(j,Y){if(j.numPoints)return Y?U({},j.properties):j.properties;j=this.points[j.index].properties;var $=this.options.map(j);return Y&&$===j?U({},$):$},G})}),wA=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.shapeLayer=new xi(n.options),n.textLayer=new Ja(n.options.textOptions),n.children=[n.shapeLayer,n.textLayer],n.max=[],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{size:50,height:0,maxZoom:19,minZoom:5,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},enableCluster:!1,showText:!0,textOptions:{fontSize:13,color:"white"}}}},{key:"onOptionsChanged",value:function(n){this.textLayer.setOptions(n.textOptions)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;n.textOptions&&Nr(l,n.textOptions);var v=n.minZoom,d=n.maxZoom,x=n.size;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.size,Nr(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshLayer(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){if(l&&l.length){this.zoom=Math.floor(this.map.getZoom());var v=n.maxZoom,d=n.minZoom,x=n.enableCluster;n=n.size,this.zoom>v?this.zoom=v:this.zoom<d&&(this.zoom=d),x&&(this.supercluster=new Fm({maxZoom:v,minZoom:d,radius:n/2}),this.supercluster.load(l)),this.refreshLayer()}}},{key:"refreshLayer",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,l=1<arguments.length&&arguments[1]!==void 0?arguments[1]:this.data,v=this.map,d=this.zoom;if(n.enableCluster&&this.supercluster&&(l=this.getClusterData(n)),l&&l.length){var x=n.gradient,y=n.showText,M=n.textOptions,D=n.height,U=n.size;U*=Math.pow(2,18-d),l=g0(l,U,function(B){var O=yi(B,2),H=O[0];return O=O[1],-180<=H&&180>=H&&-90<=O&&90>=O&&(O=v.lnglatToMercator(H,O),H=O[0],O=O[1]),B[0]=H,B[1]=O,B}),this.max[d]=Math.max(this.max[d]||0,l.max);var C=new _i({max:this.max[d],min:0,maxSize:D*Math.pow(2,18-d),minSize:0,gradient:x});if(x=[],y){var E=M&&M.format;E=typeof E=="function"?E:null,x=l.map(function(B){return{geometry:{coordinates:[B.center.x,B.center.y,C.getSize(B.count)+M.fontSize/2*Math.pow(2,18-d)]},text:E?E(B.count):B.count}})}this.textLayer.setData(x),y=l.map(function(B){for(var O=B.center,H=l.r,V=[],G=0;6>G;G++)V.push(Nx({x:O.x,y:O.y},H,G));return{geometry:{type:"Polygon",coordinates:[V]},properties:{height:C.getSize(B.count),color:C.getColor(B.count)}}}),this.shapeLayer.setData(y),n.enablePicked&&n.autoSelect&&this.pick(-1,-1)}}},{key:"getClusterData",value:function(){var n=this.map,l=n.getBounds(),v=l.ne;l=l.sw,this.ne=v,this.sw=l;var d=v,x=d.lng;d=d.lat;var y=[];return-180<=x&&180>=x&&-90<=d&&90>=d?y=[l.lng,l.lat,v.lng,v.lat]:(v=n.mercatorToLnglat(this.ne.lng,this.ne.lat),l=n.mercatorToLnglat(this.sw.lng,this.sw.lat),y=l.concat(v)),this.supercluster.getClusters(y,this.zoom).map(function(M){var D=0;return M.properties&&M.properties.point_count&&(D=M.properties.point_count),{geometry:M.geometry,count:D}})}},{key:"pick",value:function(n,l){return this.shapeLayer.pick(n,l)}},{key:"shouldUpdate",value:function(){if(!this.data)return!1;var n=this.map,l=Math.floor(n.getZoom()),v=this.options,d=v.maxZoom;if(v=v.minZoom,l>d?l=d:l<v&&(l=v),this.zoom!==l)return this.zoom=l,!0;if(!this.options.enableCluster||(l=n.getBounds(),n=l.ne,l=l.sw,!(n&&l&&this.ne&&this.sw)))return!1;if(this.ne.lng!==n.lng||this.ne.lat!==n.lat||this.sw.lng!==l.lng||this.sw.lat!==l.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshLayer():Ds(u.prototype.__proto__||fr(u.prototype),"render",this).call(this,n)}}]),u}(Aa),Oo=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="PointLayer",n.bufferData=[],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],blend:"default",shape:"circle",size:5,unit:"px",borderWidth:0,borderColor:[1,1,1,.9],polygonOffset:[0,0],depthTest:!0}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v=[];l.enablePicked&&v.push("PICK"),l.shape&&l.shape==="circle"&&v.push("SHAPE_CIRCLE"),this.program=new qr(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aBorderWidth;attribute vec4 aBorderColor;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float size=aSize*devicePixelRatio;float borderWidth=aBorderWidth*devicePixelRatio;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=uUnitPx ? size : size/zoomUnits;vSize=size;vBorderWidth=borderWidth;vBorderColor=aBorderColor;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:`varying vec4 vColor;varying float vSize;varying float vBorderWidth;varying vec4 vBorderColor;void main(void){vec4 color=vColor;
#if defined(SHAPE_CIRCLE)
float d=distance(gl_PointCoord,vec2(0.5,0.5));float ratio=1.0-vBorderWidth/vSize*2.0;if(d>0.5){discard;}if(d>ratio*0.5){color=vBorderColor;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;
#else
float ratio=vBorderWidth/vSize;if(gl_PointCoord.x<ratio||gl_PointCoord.x>1.0-ratio||gl_PointCoord.y<ratio||gl_PointCoord.y>1.0-ratio){color=vBorderColor;}
#endif
gl_FragColor=color;}`,defines:v},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:52,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:52,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:52,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28},{stride:52,name:"aBorderWidth",buffer:this.buffer,size:1,type:"FLOAT",offset:32},{stride:52,name:"aBorderColor",buffer:this.buffer,size:4,type:"FLOAT",offset:36}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){if(this.gl){for(var v=[],d=n.color,x=n.size,y=n.borderWidth,M=n.borderColor,D=0;D<l.length;D++){var U=this.normizedPoint(l[D].geometry.coordinates),C=this.getProperty("color",d,l[D]);C=this.normizedColor(C);var E=this.getProperty("size",x,l[D]);E=Number(E);var B=this.getProperty("borderWidth",y,l[D]);B=Number(B);var O=this.getProperty("borderColor",M,l[D]);O=this.normizedColor(O),U=this.addMultipleCoords(U);for(var H=0;H<U.length;H++){var V=U[H];v.push(V[0],V[1],Number(V[2]||0)),v.push(C[0],C[1],C[2],C[3]),v.push(E),v.push(B,O[0],O[1],O[2],O[3])}}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),n.enablePicked&&this.parsePickData(l)}}},{key:"parsePickData",value:function(n){var l=this.getOptions(),v=[];if(l.enablePicked)for(var d=0;d<n.length;d++){var x=this.indexToRgb(d);v.push(x[0]/255,x[1]/255,x[2]/255),l.repeat&&(v.push(x[0]/255,x[1]/255,x[2]/255),v.push(x[0]/255,x[1]/255,x[2]/255))}l.enablePicked&&this.pickBuffer.updateData(new Float32Array(v))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),y=this.program;y.use(l),n=this.getCommonUniforms(n),n=Nr(n,{uMatrix:v,uUnitPx:x.unit==="px",zoomUnits:this.map.getZoomUnits(),devicePixelRatio:window.devicePixelRatio}),y.setUniforms(n),this.setGLState({blend:!d,blendFunc:so(l,x.blend),blendEquation:l.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),this.vertexArray.bind(),l.drawArrays(l.POINTS,0,this.bufferData.length/13)}}}]),u}(Ti),MA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="GroundRippleLayer",n.bufferDataArr=[],n.indexDataArr=[],n.vertexBuffer=[],n.indexBuffer=[],n.position=[],n.opacity=1,n.currentScale=1,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.1,.1,.9,1],size:5,segs:32,scale:2,unit:"m",step:.1}}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:"uniform mat4 u_projectionMatrix;uniform mat4 u_modelViewMatrix;uniform mat4 u_modelMatrix;uniform float u_opacity;attribute vec4 aPos;attribute vec4 aColor;varying vec4 vColor;void main(){vColor=aColor;vColor.a=u_opacity;gl_Position=u_projectionMatrix*u_modelViewMatrix*u_modelMatrix*vec4(aPos.xyz,1.0);}",fragmentShader:"precision highp float;varying vec4 vColor;void main(){if(vColor.a==0.0){discard;}gl_FragColor=vColor;}"})}},{key:"onDestroy",value:function(){this.bufferDataArr=[],this.indexDataArr=[],this.vertexBuffer=[],this.indexBuffer=[]}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v&&(this.currentScale=this.opacity=1,(this.data=l)&&l.length)){var d=n.color,x=n.segs;n=n.size;for(var y=360/x,M=0;M<l.length;M++){var D=[],U=[],C=this.normizedPoint(l[M].geometry.coordinates),E=d;Object.prototype.toString.call(E)==="[object Function]"?E=E(l[M]):(E=l[M].color||d,"properties"in l[M]&&"color"in l[M].properties&&(E=l[M].properties.color)),E=this.normizedColor(E);var B=Object.prototype.toString.call(n)==="[object Function]"?n(l[M]):Number(n),O=C[0],H=C[1];D.push(0,0,-.5),D.push(E[0],E[1],E[2],0);for(var V=1,G=0;V<=x;V++,G+=y)D.push(C[0]-O+Math.cos(Math.PI/180*G)*B,C[1]-H+Math.sin(Math.PI/180*G)*B,-.5),D.push(E[0],E[1],E[2],this.opacity),V===x?U.push(0,0+V,1):U.push(0,0+V,0+V+1);E=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,E),v.bufferData(v.ARRAY_BUFFER,new Float32Array(D),v.STATIC_DRAW),this.vertexBuffer[M]=E,this.bufferDataArr[M]=D,v.bindBuffer(v.ARRAY_BUFFER,null),D=v.createBuffer(),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,D),v.bufferData(v.ELEMENT_ARRAY_BUFFER,new Uint16Array(U),v.STATIC_DRAW),this.indexBuffer[M]=D,this.indexDataArr[M]=U,v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,null),this.position[M]=[C[0],C[1]]}this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix,d=n.viewMatrix;for(n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_projectionMatrix,!1,v),l.uniformMatrix4fv(n.uniforms.u_modelViewMatrix,!1,d),v=this.opacity,this.options.opacity!==void 0&&(v=this.options.opacity),l.uniform1f(n.uniforms.u_opacity,v),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.DST_ALPHA]}),l.enableVertexAttribArray(n.attributes.aPos),l.enableVertexAttribArray(n.attributes.aColor),v=0;v<this.bufferDataArr.length;v++)if(!(0>=this.bufferDataArr[v].length)){d=new Float32Array(this.bufferDataArr[v]).BYTES_PER_ELEMENT,l.bindBuffer(l.ARRAY_BUFFER,this.vertexBuffer[v]),l.vertexAttribPointer(n.attributes.aColor,4,l.FLOAT,!1,7*d,3*d),l.vertexAttribPointer(n.attributes.aPos,3,l.FLOAT,!1,7*d,0),d=this.position[v];var x=or.create(),y=[this.currentScale,this.currentScale,this.currentScale];this.options.unit==="px"&&this.map&&(y=this.map.getZoomUnits(),y=[this.currentScale*y,this.currentScale*y,this.currentScale]),or.identity(x),or.translate(x,x,[d[0],d[1],0]),or.scale(x,x,y),l.uniformMatrix4fv(n.uniforms.u_modelMatrix,!1,x),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indexBuffer[v]),l.drawElements(l.TRIANGLES,this.indexDataArr[v].length,l.UNSIGNED_SHORT,0),l.bindBuffer(l.ARRAY_BUFFER,null),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,null)}n=this.getOptions(),l=n.scale,n=n.step,this.opacity-=n/10,this.currentScale+=l*n,0>this.opacity&&(this.currentScale=this.opacity=1)}}]),u}(Ti),CA=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="RippleLayer",n.bufferData=[],n.date=new Date,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthTest:!0,polygonOffset:[0,0],color:[.1,.1,.9,1],blend:"normal",size:20,unit:"px",duration:2}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new qr(this.gl,{vertexShader:`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 uMatrix;uniform vec4 uSelectedColor;uniform float uTime;uniform float duration;uniform float zoomUnits;varying vec4 vColor;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}float percent=mod(uTime,duration)/duration;vColor.a=1.-percent;gl_Position=uMatrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize/zoomUnits*percent;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,fragmentShader:"varying vec4 vColor;void main(void){vec4 color=vColor;float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d>0.5){discard;}float blur=1.0;blur=1.0-smoothstep(0.49,0.5,d);color.a*=blur;gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:32,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:32,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:12},{stride:32,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:28}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){if(this.gl){for(var v=[],d=n.color,x=n.size,y=0;y<l.length;y++){var M=l[y].geometry.coordinates,D=d;Object.prototype.toString.call(D)==="[object Function]"?D=D(l[y]):(D=l[y].color||d,"properties"in l[y]&&"color"in l[y].properties&&(D=l[y].properties.color)),D=this.normizedColor(D),M=this.normizedPoint(M);var U=l[y].size||x;"properties"in l[y]&&"size"in l[y].properties&&(U=l[y].properties.size),U=Object.prototype.toString.call(U)==="[object Function]"?U(l[y]):Number(U),v.push(M[0],M[1],Number(M[2]||0)),v.push(D[0],D[1],D[2],D[3]),v.push(U*window.devicePixelRatio)}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),n.enablePicked&&this.parsePickData(l)}}},{key:"parsePickData",value:function(n){var l=this.getOptions(),v=[];if(l.enablePicked)for(var d=0;d<n.length;d++){var x=this.indexToRgb(d);v.push(x[0]/255,x[1]/255,x[2]/255)}l.enablePicked&&this.pickBuffer.updateData(new Float32Array(v))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.isPickRender;if(!(0>=this.bufferData.length)){var x=this.getOptions(),y=this.program;y.use(l),this.vertexArray.bind(),n=this.getCommonUniforms(n);var M=1;x.unit==="m"&&this.map&&(M=this.map.getZoomUnits()),n=Nr(n,{zoomUnits:M,uTime:(new Date-this.date)/1e3,duration:x.duration,uMatrix:v}),y.setUniforms(n),this.setGLState({blend:!d,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],blendEquation:l.FUNC_ADD,polygonOffset:x.polygonOffset,depthTest:x.depthTest}),l.drawArrays(l.POINTS,0,this.bufferData.length/8)}}}]),u}(Ti),TA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="SparkLayer",n.bufferData=[],n.startTime=Number(n.options.startTime)||0,n.endTime=Number(n.options.endTime),n.time=n.startTime,n.segs=Number(n.options.segs)||10,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[.9,.1,.1,1],trailLength:3,height:100,step:.1,segs:10,polygonOffset:[0,0]}}},{key:"setTime",value:function(n){this.time=n}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:"precision mediump float;attribute vec4 aPos;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision mediump float;uniform vec3 uFragColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(uFragColor,1.0*vTime);}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=n.height,y=0;y<l.length;y++)for(var M=l[y].geometry.coordinates,D=Object.prototype.toString.call(x)==="[object Function]"?x(l[y]):Number(x),U=0,C=0;C<this.segs;C++){var E=this.normizedPoint(M);d.push(E[0],E[1],U),M[2]===void 0?d.push(C):d.push(Number(M[2])),U+=D/this.segs,d.push(E[0],E[1],U),M[2]===void 0?d.push(C+1):d.push(Number(M[2]))}n.endTime===void 0&&(this.endTime=this.segs),this.bufferData=d,v.bufferData(v.ARRAY_BUFFER,new Float32Array(d),v.STATIC_DRAW),this.webglLayer&&this.webglLayer.render()}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),l.enableVertexAttribArray(n.attributes.aPos),l.vertexAttribPointer(n.attributes.aPos,4,l.FLOAT,!1,0,0),v=this.normizedColor(this.options.color),l.uniform3f(n.uniforms.uFragColor,v[0],v[1],v[2]),l.uniform1f(n.uniforms.currentTime,this.time),l.uniform1f(n.uniforms.trailLength,this.options.trailLength),this.setGLState({blend:!0,blendFunc:[l.SRC_ALPHA,l.ONE],blendEquation:l.FUNC_ADD,polygonOffset:this.options.polygonOffset}),l.drawArrays(l.LINES,0,this.bufferData.length/4),this.time+=Number(this.options.step),this.time>1.5*this.endTime&&(this.time=this.startTime)}}]),u}(Ti),Gr=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="IconLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Yu,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!0,depthTest:!0,blend:"default",flat:!1,unit:"px",scale:1,angle:0,opacity:1,offset:[0,0],padding:[0,0],polygonOffset:[0,0]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform float u_opacity;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}textureColor.a*=u_opacity;gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l,2<arguments.length&&arguments[2]!==void 0?arguments[2]:{})}},{key:"processCache",value:function(n,l,v){var d=this;this.cachedData=[];for(var x=n.icon,y=n.width,M=n.height,D=n.offset,U=n.angle,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",x,l[C]),O=this.getProperty("width",y,l[C]),H=this.getProperty("height",M,l[C]),V=this.getProperty("offset",D,l[C]),G=this.getProperty("angle",U,l[C]);E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offset:V,angle:G,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=js(this.iconHash.entries()).filter(function(j){return typeof j[1]=="string"}).map(function(j){var Y=yi(j,2)[0];return new ju(function($,it){d.url2canvas(Y,function(nt){d.iconHash.set(Y,nt),$()})})}),ju.all(l).then(function(j){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=[],y=new Yu,M=!0,D=!1,U=void 0;try{for(var C=Po(this.iconHash),E;!(M=(E=C.next()).done);M=!0){var B=yi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=O.height;x.push({w:H+l[0],h:V+l[0],width:H,height:V,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=xu(x),M=0;M<x.length;M++)U=x[M],y.get(U.key)||y.set(U.key,U);for(M=Ie(D.w),D=Ie(D.h),v.width=M||1,v.height=D||1,d.save(),v=0;v<x.length;v++)U=x[v],d.drawImage(U.icon,U.x+l[0],U.y+l[1],U.width,U.height);d.restore(),this.loadTexture(),this.buildVertex(n,y,M,D)}},{key:"buildVertex",value:function(n,l,v,d){n=n.enablePicked;for(var x=[],y=[],M=[],D=[],U=0;U<this.cachedData.length;U++){var C=this.cachedData[U],E=C.point,B=C.width,O=C.height,H=C.offset,V=C.angle,G=C.index;if(C=l.get(C.icon)){B=B||C.icon.width,O=O||C.icon.height;var j=yi(E,3);E=j[0];var Y=j[1];j=j[2];for(var $=0;4>$;$++)x.push(E,Y,j),x.push($),x.push(B,O),x.push.apply(x,Jr(H)),x.push(V*Math.PI/180);B=C.x/v,O=(C.x+C.w)/v,H=(C.y+C.h)/d,C=C.y/d,y.push(B,H,B,C,O,C,O,H),C=4*U,M.push(C,C+2,C+1,C,C+3,C+2),n&&(G=this.indexToRgb(G),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255),D.push(G[0]/255,G[1]/255,G[2]/255))}}this.index=M,this.vertexBuffer.updateData(new Float32Array(x)),this.uvBuffer.updateData(new Float32Array(y)),this.indexBuffer.updateData(new Uint32Array(M)),n&&this.pickBuffer.updateData(new Float32Array(D))}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l);var y=n.isPickRender?so(l,null):so(l,d.blend);this.setGLState({blend:!0,blendFunc:y,polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite}),x.setUniforms(Nr(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_flat:d.flat,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale,u_opacity:d.opacity,u_zIndex:d.zIndex,devicePixelRatio:1<(window.BMAPGL_FORCE_RATIO||window.devicePixelRatio)?2:1})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":Qr(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ti),SA=function(a){function u(n){Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n));var l=Nr({blend:"default"},n.options);return n.pointLayer=new Oo(l),n.options.textOptions=Nr({depthTest:!1,collides:!1},n.options.textOptions),n.textLayer=new Ja(n.options.textOptions),l=Nr({},n.options,n.options.iconOptions),n.iconLayer=new Gr(l),n.children=[n.pointLayer,n.textLayer,n.iconLayer],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{minSize:25,maxSize:40,clusterRadius:200,minPoints:2,extent:400,showText:!0,maxZoom:19,minZoom:4,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"},textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"onOptionsChanged",value:function(n){this.textLayer.setOptions(n.textOptions)}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions;n.textOptions&&Nr(l,n.textOptions);var v=n.minZoom,d=n.maxZoom,x=n.clusterRadius;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.clusterRadius,Nr(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){var v=this;l&&l.length?(l.forEach(function(d){var x=yi(d.geometry.coordinates,2),y=x[0];x=x[1],-180<=y&&180>=y&&-90<=x&&90>=x||(y=v.map.mercatorToLnglat(y,x),d.geometry.coordinates[0]=y[0],d.geometry.coordinates[1]=y[1])}),this.supercluster=new Fm({maxZoom:n.maxZoom,minZoom:n.minZoom,radius:n.clusterRadius,minPoints:n.minPoints,extent:n.extent}),this.supercluster.load(l),this.supercluster.trees.forEach(function(d){var x=0,y=1/0;d.points.forEach(function(M){x=Math.max(M.numPoints||0,x),y=Math.min(M.numPoints||1/0,y)}),d.max=x,d.min=y}),this.refreshCluster()):(this.supercluster=null,this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]))}},{key:"refreshCluster",value:function(){var n=this,l=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options;if(this.supercluster){var v=this.getClusterData(l);if(v&&v.length)if(typeof l.beforeRender=="function"&&l.beforeRender(v)===!1)this.pointLayer.setData([]),this.iconLayer.setData([]),this.textLayer.setData([]);else{var d=[],x=[],y=[];v.forEach(function(M){M.properties.cluster?(d.push(M),y.push({geometry:M.geometry,properties:{text:M.properties.text}})):M.properties.icon||n.options.iconOptions.icon?x.push(M):d.push(M)}),this.pointLayer.setData(d),this.iconLayer.setData(x),this.textLayer.setData(l.showText?y:[]),l.enablePicked&&l.autoSelect&&this.pick(-1,-1)}}}},{key:"getClusterData",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options,l=this.map.getBounds(),v=this.ne=l.getNorthEast();l=this.sw=l.getSouthWest();var d=v,x=d.lng;return d=d.lat,-180<=x&&180>=x&&-90<=d&&90>=d?l=[l.lng,l.lat,v.lng,v.lat]:(v=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),l=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat),l=l.concat(v)),v=Math.floor(this.map.getZoom()),l=this.supercluster.getClusters(l,v),this.zoom!==v&&0<l.length&&(this.zoom=v,d=this.supercluster.trees,x=d[v]&&d[v].max||this.max,v=d[v]&&d[v].min||this.min,x!==v&&(this.max=x,this.min=v)),this.processData(l,n)}},{key:"processData",value:function(n,l){var v=l.defaultColor,d=l.defaultSize,x=l.gradient,y=l.minSize,M=l.textOptions,D=new _i({max:this.max,min:~~this.min||1,minSize:y||8,maxSize:l.maxSize||30,gradient:x});v=v||x[0]||"black",d=d||.5*y||5;var U=M&&M.format;return U=typeof U=="function"?U:null,n.map(function(C){var E=d,B=v,O="";return C.properties&&C.properties.point_count&&(O=C.properties.point_count,E=D.getSize(O)||E,B=D.getColor(O),O=U?U(O):O),E=Nr({},C.properties,{text:O,size:E,color:B}),Nr({},C,{properties:E,children:C.id})})}},{key:"pick",value:function(n,l){var v=this.pointLayer.pick(n,l);return 0>v.dataIndex&&(v=this.iconLayer.pick(n,l)),(n=v.dataItem)&&typeof n.children=="number"&&(n.children=this.getClusterPoints(n.children)),v}},{key:"getClusterPoints",value:function(n){var l=this;return n?this.supercluster.getChildren(n).map(function(v){return v.type==="Feature"?l.getClusterPoints(v.id):v}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var n=this.map.getBounds(),l=n.getNorthEast();if(n=n.getSouthWest(),this.ne.lng!==l.lng||this.ne.lat!==l.lat||this.sw.lng!==n.lng||this.sw.lat!==n.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshCluster():Ds(u.prototype.__proto__||fr(u.prototype),"render",this).call(this,n)}}]),u}(Aa),IA=function(a){function u(n){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.options.textOptions=Nr({collides:!1,depthWrite:!0},n.options.textOptions),n.textLayer=new Ja(n.options.textOptions),n.options.iconOptions=Nr({},n.options,n.options.iconOptions),n.iconLayer=new Gr(n.options.iconOptions),n.children=[n.iconLayer,n.textLayer],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{clusterRadius:200,minPoints:2,showText:!0,maxZoom:19,minZoom:4,extent:400,textOptions:{fontSize:12,color:"white"},iconOptions:{}}}},{key:"setOptions",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},l=this.options.textOptions,v=this.options.iconOptions;n.textOptions&&Nr(l,n.textOptions),n.iconOptions&&Nr(v,n.textOptions),v=n.minZoom;var d=n.maxZoom,x=n.clusterRadius;v=d&&d!==this.options.maxZoom||v&&v!==this.options.minZoom||x&&x!==this.options.clusterRadius,Nr(this.options,n,{textOptions:l}),v?this.onChanged(this.options,this.data):this.refreshCluster(),this.onOptionsChanged(this.getOptions())}},{key:"onChanged",value:function(n,l){var v=this;l&&l.length?(l.forEach(function(d){var x=yi(d.geometry.coordinates,2),y=x[0];x=x[1],-180<=y&&180>=y&&-90<=x&&90>=x||(y=v.map.mercatorToLngLat(y,x),d.geometry.coordinates[0]=y[0],d.geometry.coordinates[1]=y[1])}),this.supercluster=new Fm({maxZoom:n.maxZoom,minZoom:n.minZoom,minPoints:n.minPoints,radius:n.clusterRadius,extent:n.extent}),this.supercluster.load(l),this.supercluster.trees.forEach(function(d){var x=0,y=1/0;d.points.forEach(function(M){x=Math.max(M.numPoints||0,x),y=Math.min(M.numPoints||1/0,y)}),d.max=x,d.min=y}),this.refreshCluster()):(this.supercluster=null,this.textLayer.setData([]),this.iconLayer.setData([]))}},{key:"refreshCluster",value:function(){var n=0<arguments.length&&arguments[0]!==void 0?arguments[0]:this.options;if(this.supercluster){var l=this.getClusterData(n);if(l&&l.length)if(typeof n.beforeRender=="function"&&n.beforeRender(l)===!1)this.textLayer.setData([]),this.iconLayer.setData([]);else{var v=[],d=[];l.forEach(function(x){x.properties.cluster&&v.push({geometry:x.geometry,properties:{text:x.properties.text}}),d.push(x)}),this.textLayer.setData(n.showText?v:[]),this.iconLayer.setData(d),n.enablePicked&&n.autoSelect&&this.pick(-1,-1)}}}},{key:"getClusterData",value:function(n){var l=this.map.getBounds(),v=this.ne=l.getNorthEast();l=this.sw=l.getSouthWest();var d=v,x=d.lng;return d=d.lat,-180<=x&&180>=x&&-90<=d&&90>=d?l=[l.lng,l.lat,v.lng,v.lat]:(v=this.map.mercatorToLnglat(this.ne.lng,this.ne.lat),l=this.map.mercatorToLnglat(this.sw.lng,this.sw.lat),l=l.concat(v)),v=Math.floor(this.map.getZoom()),l=this.supercluster.getClusters(l,v),this.zoom!==v&&0<l.length&&(this.zoom=v,d=this.supercluster.trees,x=d[v]&&d[v].max||this.max,v=d[v]&&d[v].min||this.min,x!==v&&(this.max=x,this.min=v)),this.processData(l,n)}},{key:"processData",value:function(n,l){var v=this,d=(l=l.textOptions)&&l.format;return d=typeof d=="function"?d:null,n.map(function(x){var y=x.properties||{};if(x.properties&&x.properties.point_count){y=x.properties.point_count;var M=v.getClusterIcon(y);y=d&&d(y),y=Nr({},x.properties,{text:y,icon:M})}return Nr({},x,{properties:y,children:x.id})})}},{key:"getClusterIcon",value:function(n){var l=this.options.iconExtent,v=dn(l).map(function(D){return+D}),d=v.length;if(d!==0){for(var x=1,y=void 0,M=v[0];x<d;){if(y=M,M=v[x],y<=n&&M>n)return l[y];x++}if(n>M)return l[M]}}},{key:"pick",value:function(n,l){return n=this.iconLayer.pick(n,l),(l=n.dataItem)&&typeof l.children=="number"&&(l.children=this.getClusterPoints(l.children)),n}},{key:"getClusterPoints",value:function(n){var l=this;return n?this.supercluster.getChildren(n).map(function(v){return v.type==="Feature"?l.getClusterPoints(v.id):v}).flat():[]}},{key:"shouldUpdate",value:function(){if(!this.data||!this.supercluster)return!1;if(this.zoom!==Math.floor(this.map.getZoom()))return!0;var n=this.map.getBounds(),l=n.getNorthEast();if(n=n.getSouthWest(),this.ne.lng!==l.lng||this.ne.lat!==l.lat||this.sw.lng!==n.lng||this.sw.lat!==n.lat)return!0}},{key:"render",value:function(n){this.shouldUpdate()?this.refreshCluster():Ds(u.prototype.__proto__||fr(u.prototype),"render",this).call(this,n)}}]),u}(Aa),Zu=function(a){function u(n,l){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n,l))}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return Nr(Ds(u.prototype.__proto__||fr(u.prototype),"getDefaultOptions",this).call(this),{style:"grid",gridSize:500,gradient:{0:"rgb(50, 50, 256)","0.1":"rgb(50, 250, 56)","0.5":"rgb(250, 250, 56)",1:"rgb(250, 50, 56)"}})}},{key:"onChanged",value:function(n,l){this.gl&&(l=this.processData(l,n),Ds(u.prototype.__proto__||fr(u.prototype),"onChanged",this).call(this,n,l))}},{key:"generateGrid",value:function(n,l){var v=l.gridSize,d=[],x={};l=n.length;for(var y=this.getPointOffset(),M=0;M<l;M++){var D=this.normizedPoint(n[M].geometry.coordinates),U=D[2];D=~~((D[0]+y[0])/v)+"_"+~~((D[1]+y[1])/v),x[D]===void 0&&(x[D]={count:0,num:0,z:0});var C=~~n[M].count||1;"properties"in n[M]&&"count"in n[M].properties&&(C=~~n[M].properties.count),x[D].count+=C,x[D].num+=1,x[D].z+=U}return dn(x).forEach(function(E){var B=E.split("_");d.push([B[0]*v+v/2,B[1]*v+v/2,x[E].z/x[E].num,x[E].count])}),d}},{key:"processData",value:function(n,l){var v=[];if(l.style==="normal")for(var d=this.getPointOffset(),x=0;x<n.length;x++){var y=this.normizedPoint(n[x].geometry.coordinates),M=y[0]+d[0],D=y[1]+d[1];y=y[2];var U=~~n[x].count||1;"properties"in n[x]&&"count"in n[x].properties&&(U=~~n[x].properties.count),v.push([M,D,y,U])}else v=this.generateGrid(n,l);if(d=n=0,l.max!==void 0&&l.min!==void 0)n=l.max,d=l.min;else{for(v[0]&&(n=v[0][3],d=v[0][3]),x=v.length,M=0;M<x;M++)D=v[M],n=Math.max(D[3],n),d=Math.min(D[3],d);n/=2}for(l=new _i({max:~~n,min:d,gradient:l.gradient}),n=[],d=0;d<v.length;d++)x=v[d],x[0]=x[0],x[1]=x[1],M=l.getImageData(x[3]),n.push({geometry:{type:"Point",coordinates:[x[0],x[1],x[2]]},color:[M[0]/255,M[1]/255,M[2]/255,M[3]/255]});return n}}]),u}(Oo),EA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.bufferData=[],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1]}}},{key:"onChanged",value:function(n,l){var v=this;if(n=this.gl){this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer);for(var d=[],x=function(M){var D=5*M;for(M=0;M<l.length;M++)l[M].geometry.coordinates.forEach(function(U){for(var C=0;C<U.length-1;C++){var E=v.normizedPoint(U[C]);d.push(E[0]),d.push(E[1]),d.push(Number(D)),E=v.normizedPoint(U[C+1]),d.push(E[0]),d.push(E[1]),d.push(Number(D))}})},y=0;20>y;y++)x(y);n.bufferData(n.ARRAY_BUFFER,new Float32Array(d),n.STATIC_DRAW),this.bufferData=d,n.bindBuffer(n.ARRAY_BUFFER,null)}}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(n,{vertexShader:"uniform mat4 uMatrix;attribute vec3 aPos;void main(){gl_PointSize=10.0;gl_Position=uMatrix*vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform vec4 uFragColor;void main(){gl_FragColor=uFragColor;}"}),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"render",value:function(n){var l=n.gl;n=n.matrix;var v=this.program;l.useProgram(v.program);var d=this.normizedColor(this.options.color);l.uniform4f(v.uniforms.uFragColor,d[0],d[1],d[2],d[3]),l.uniformMatrix4fv(v.uniforms.uMatrix,!1,n),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),l.enableVertexAttribArray(v.attributes.aPos),l.vertexAttribPointer(v.attributes.aPos,3,l.FLOAT,!1,0,0),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.ONE,l.ONE]}),l.drawArrays(l.LINES,0,this.bufferData.length/3)}}]),u}(Ti),D1={circle:1,square:2},LA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.bufferData=[],n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:"attribute vec4 aPos;attribute vec4 aColor;attribute float aSize;uniform mat4 u_matrix;varying vec4 vColor;uniform float currentTime;uniform float trailLength;varying float vTime;void main(void){if(aColor.w>=0.0&&aColor.w<=1.0){vColor=aColor;}else{vColor=vec4(aColor.xyz,1.0);}gl_Position=u_matrix*vec4(aPos.xyz,1.0);gl_PointSize=aSize;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;varying vec4 vColor;uniform int uShape;varying float vTime;void main(void){if(vTime>1.0||vTime<0.0){discard;}if(uShape==1){float d=distance(gl_PointCoord,vec2(0.5,0.5));if(d<0.5){gl_FragColor=vColor;}else{discard;}}else{gl_FragColor=vec4(vColor.rgb,vColor.a*vTime);}}"}),this.f32BufferData=new Float32Array,this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=n.color||[.1,.1,.9,1],y=n.size||5,M=0;M<l.length;M++){var D=l[M].geometry.coordinates,U=x;Object.prototype.toString.call(U)==="[object Function]"?U=U(l[M]):(U=l[M].color||x,"properties"in l[M]&&"color"in l[M].properties&&(U=l[M].properties.color)),U=this.normizedColor(U);var C=this.normizedPoint(D),E=y;E=Object.prototype.toString.call(E)==="[object Function]"?E(l[M]):Number(E);var B=l[M].time||M;"properties"in l[M]&&"time"in l[M].properties&&(B=l[M].properties.time),d.push(C[0],C[1],Number(D[2]||0),B),d.push(U[0],U[1],U[2],U[3]),d.push(E*window.devicePixelRatio)}n.endTime===void 0&&(this.endTime=l.length),this.bufferData=d,this.f32BufferData=new Float32Array(d),v.bufferData(v.ARRAY_BUFFER,this.f32BufferData,v.STATIC_DRAW)}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;0>=this.bufferData.length||(n=this.program,l.useProgram(n.program),l.uniformMatrix4fv(n.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),v=this.f32BufferData.BYTES_PER_ELEMENT,l.enableVertexAttribArray(n.attributes.aPos),l.vertexAttribPointer(n.attributes.aPos,4,l.FLOAT,!1,9*v,0),l.enableVertexAttribArray(n.attributes.aColor),l.vertexAttribPointer(n.attributes.aColor,4,l.FLOAT,!1,9*v,4*v),l.enableVertexAttribArray(n.attributes.aSize),l.vertexAttribPointer(n.attributes.aSize,1,l.FLOAT,!1,9*v,8*v),l.uniform1f(n.uniforms.currentTime,this.time),l.uniform1f(n.uniforms.trailLength,this.options.trailLength||3),v=1,this.options.shape&&D1[this.options.shape]&&(v=D1[this.options.shape]),l.uniform1i(n.uniforms.uShape,v),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:this.options.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),l.drawArrays(l.POINTS,0,this.bufferData.length/9),this.time+=this.options.step||.1,this.time>this.endTime&&(this.time=this.startTime))}}]),u}(Ti),Jh=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.bufferData=[],n.startTime=n.options.startTime||0,n.endTime=n.options.endTime,n.time=n.startTime,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:[1,.05,.05,1],trailLength:3,step:.1,polygonOffset:[0,0]}}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec4 aPos;attribute vec4 aColor;uniform mat4 u_matrix;uniform float currentTime;uniform float trailLength;varying float vTime;varying vec4 vColor;void main(){gl_Position=u_matrix*vec4(aPos.xyz,1.0);vColor=aColor;vTime=1.0-((currentTime-aPos.w)/trailLength);}",fragmentShader:"precision highp float;uniform vec3 uFragColor;varying vec4 vColor;varying float vTime;void main(){if(vTime>1.0||vTime<0.0){discard;}gl_FragColor=vec4(vColor.rgb,1.0*vTime);}"},this),this.buffer=n.createBuffer(),n.bindBuffer(n.ARRAY_BUFFER,this.buffer)}},{key:"setTime",value:function(n){this.time=n}},{key:"onChanged",value:function(n,l){var v=this.gl;if(v){this.buffer=v.createBuffer(),v.bindBuffer(v.ARRAY_BUFFER,this.buffer);for(var d=[],x=0,y=this.options.color,M=0;M<l.length;M++){var D=l[M].geometry.coordinates;l[M].color&&(y=l[M].color),"properties"in l[M]&&"color"in l[M].properties&&(y=l[M].properties.color),Object.prototype.toString.call(y)==="[object Function]"&&(y=y(l[M])),y=this.normizedColor(y),D.length>x&&(x=D.length);for(var U=0;U<D.length-1;U++){var C=this.normizedPoint(D[U]);d.push(C[0]),d.push(C[1]),d.push(C[2]),D[U][3]===void 0?d.push(U):d.push(Number(D[U][3])),d.push(y[0]),d.push(y[1]),d.push(y[2]),d.push(y[3]),C=this.normizedPoint(D[U+1]),d.push(C[0]),d.push(C[1]),d.push(C[2]),D[U+1][3]===void 0?d.push(U+1):d.push(Number(D[U+1][3])),d.push(y[0]),d.push(y[1]),d.push(y[2]),d.push(y[3])}}n.endTime===void 0&&(this.endTime=x),this.bufferData=d,this.f32BufferData=new Float32Array(d),v.bufferData(v.ARRAY_BUFFER,this.f32BufferData,v.STATIC_DRAW)}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix;n=this.getOptions();var d=this.program;d.use(l),l.uniformMatrix4fv(d.uniforms.u_matrix,!1,v),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),v=this.f32BufferData.BYTES_PER_ELEMENT,l.enableVertexAttribArray(d.attributes.aPos),l.vertexAttribPointer(d.attributes.aPos,4,l.FLOAT,!1,8*v,0),l.enableVertexAttribArray(d.attributes.aColor),l.vertexAttribPointer(d.attributes.aColor,4,l.FLOAT,!1,8*v,4*v),v=this.normizedColor(n.color),l.uniform3f(d.uniforms.uFragColor,v[0],v[1],v[2]),l.uniform1f(d.uniforms.currentTime,this.time),l.uniform1f(d.uniforms.trailLength,n.trailLength),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:n.blend==="lighter"?[l.ONE,l.ONE]:[l.SRC_ALPHA,l.ONE],polygonOffset:n.polygonOffset,depthMask:!1}),l.drawArrays(l.LINES,0,this.bufferData.length/8),this.time+=n.step,this.time>this.endTime&&(this.time=this.startTime)}}]),u}(Ti),RA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="IconCollidesLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Yu,n.boxHash=new Yu,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{flat:!1,unit:"px",scale:1,angle:0,offset:[0,0],padding:[0,0]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute vec2 a_size;attribute vec2 a_offset;attribute vec2 a_texture_coord;uniform mat4 u_matrix;uniform vec2 u_size;uniform float devicePixelRatio;uniform float u_zoom_units;uniform float u_zIndex;uniform float u_scale;uniform bool u_unit_px;uniform bool u_flat;varying vec2 v_texture_coord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)+size.x*sin(a_rotation);}else if(corner==2.0){x+=size.x*cos(a_rotation)+size.y*sin(a_rotation);y+=size.y*cos(a_rotation)-size.x*sin(a_rotation);}else if(corner==3.0){x+=size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)-size.x*sin(a_rotation);}else{x+=-size.x*cos(a_rotation)-size.y*sin(a_rotation);y+=-size.y*cos(a_rotation)+size.x*sin(a_rotation);}return vec3(x,y,coord.z);}void main(){v_texture_coord=a_texture_coord;if(u_flat){vec2 offset=a_offset;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;offset*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=u_zIndex;gl_Position=u_matrix*vec4(current.x+offset[0],current.y-offset[1],current.z,1.0);}else{vec4 position=u_matrix*vec4(a_pos,1.0);vec3 screen=position.xyz/position.w;vec2 halfSize=a_size/MAPV_resolution*devicePixelRatio*u_scale;vec2 offset=a_offset*2./MAPV_resolution*devicePixelRatio;if(!u_unit_px){halfSize/=u_zoom_units;offset/=u_zoom_units;}vec3 current=transformCoord(screen,halfSize,a_corner);current.xy=current.xy-offset;current.z+=u_zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;varying vec2 v_texture_coord;uniform sampler2D u_icon;uniform vec4 uSelectedColor;void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:36,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:16},{name:"a_offset",buffer:this.vertexBuffer,size:2,stride:36,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:36,type:"FLOAT",offset:32},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:{};this.gl&&(this.cachedData=[],this.boxHash.clear(),this.processCache(n,l,v))}},{key:"processCache",value:function(n,l,v){for(var d=this,x=n.icon,y=n.width,M=n.height,D=n.offset,U=n.angle,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",x,l[C]),O=this.getProperty("width",y,l[C]),H=this.getProperty("height",M,l[C]),V=this.getProperty("offset",D,l[C]),G=this.getProperty("angle",U,l[C]);E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offset:V,angle:G,dataIndex:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=js(this.iconHash.entries()).filter(function(j){return typeof j[1]=="string"}).map(function(j){var Y=yi(j,2)[0];return new ju(function($,it){d.url2canvas(Y,function(nt){d.iconHash.set(Y,nt),$()})})}),ju.all(l).then(function(j){d.buildSprite(n),v.autoRender!==!1&&d.webglLayer&&d.webglLayer.render()})}},{key:"buildSprite",value:function(n){n=n.padding;var l=this.canvas,v=this.ctx,d=[],x=!0,y=!1,M=void 0;try{for(var D=Po(this.iconHash),U;!(x=(U=D.next()).done);x=!0){var C=yi(U.value,2),E=C[1];if(typeof E!="string"){var B=E.width,O=E.height;d.push({w:B+n[0],h:O+n[0],width:B,height:O,key:C[0],icon:E})}}}catch(H){y=!0,M=H}finally{try{!x&&D.return&&D.return()}finally{if(y)throw M}}for(D=xu(d),U=0;U<d.length;U++)C=d[U],this.boxHash.get(C.key)||this.boxHash.set(C.key,C);for(U=Ie(D.w)||1,D=Ie(D.h)||1,l.width=U,l.height=D,v.save(),l=0;l<d.length;l++)D=d[l],v.drawImage(D.icon,D.x+n[0],D.y+n[1],D.width,D.height);v.restore(),this.loadTexture()}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA]}),x.setUniforms(Nr(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_flat:d.flat,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale,u_zIndex:d.zIndex,devicePixelRatio:window.devicePixelRatio})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateIcon(n)}},{key:"updateIcon",value:function(n){if(this.iconHash.size&&this.boxHash.size){var l=this.getOptions(),v=n.gl;n=n.matrix,l=l.enablePicked;var d=[],x=[],y=[],M=[],D=this.canvas.width,U=this.canvas.height,C=v.canvas.width/window.devicePixelRatio;v=v.canvas.height/window.devicePixelRatio;for(var E=new Os,B=0,O=0;O<this.cachedData.length;O++){var H=this.cachedData[O],V=H.point,G=H.width,j=H.height,Y=H.offset,$=H.angle,it=H.dataIndex;if(H=this.boxHash.get(H.icon)){G=G||H.icon.width,j=j||H.icon.height;var nt=yi(V,3);V=nt[0];var pt=nt[1];nt=nt[2];var Rt=Ni.clone([V,pt,nt,1]);Ni.transformMat4(Rt,Rt,n),Ni.scale(Rt,Rt,1/Rt[3]);var Et=(Rt[0]+1)/2*C-G/2;Rt=(-Rt[1]+1)/2*v-j/2;var Jt=Et+G,oe=Rt+j;if(!(0>Jt||0>oe||Et>C||Rt>v||(Et={minX:Et,maxX:Jt,minY:Rt,maxY:oe},E.collides(Et)))){for(E.insert(Et),Et=0;4>Et;Et++)d.push(V,pt,nt),d.push(Et),d.push(G,j),d.push.apply(d,Jr(Y)),d.push($*Math.PI/180);G=H.x/D,j=(H.x+H.w)/D,Y=(H.y+H.h)/U,H=H.y/U,x.push(G,Y,G,H,j,H,j,Y),H=4*B,y.push(H,H+2,H+1,H,H+3,H+2),l&&(it=this.indexToRgb(it),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255),M.push(it[0]/255,it[1]/255,it[2]/255)),B+=1}}}this.index=y,this.vertexBuffer.updateData(new Float32Array(d)),this.uvBuffer.updateData(new Float32Array(x)),this.indexBuffer.updateData(new Uint32Array(y)),l&&this.pickBuffer.updateData(new Float32Array(M))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":Qr(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ti),O1=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="LineFlowLayer",n.initData(),n.date=new Date,n.autoUpdate=!0,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(25, 25, 250, 1)",blend:"normal",width:2,antialias:!1,interval:.1,duration:2,trailLength:.5,minZoom:2,maxZoom:25,polygonOffset:[0,0]}}},{key:"initData",value:function(){this.dataMgr={position:[],prev:[],next:[],direction:[],color:[],index:[],counter:[]}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.program=new qr(this.gl,{vertexShader:`uniform mat4 u_matrix;uniform float thickness;uniform vec4 uSelectedColor;attribute vec3 position;attribute vec3 next;attribute vec3 previous;attribute float direction;attribute vec4 aColor;attribute float aCounter;attribute vec2 uv;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;vec2 project(vec4 coord){vec3 screen=coord.xyz/coord.w;vec2 clip=(screen.xy+1.0)/2.0;return clip*MAPV_resolution;}vec4 unproject(vec2 projected,float z,float w){vec2 clip=projected/MAPV_resolution;vec2 screen=clip*2.0-1.0;return vec4(screen*w,z,w);}void main(){vColor=aColor;vCounter=aCounter;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
vec4 previousProjected=u_matrix*vec4(previous,1.0);vec4 currentProjected=u_matrix*vec4(position,1.0);vec4 nextProjected=u_matrix*vec4(next,1.0);vec2 currentScreen=project(currentProjected);vec2 previousScreen=project(previousProjected);vec2 nextScreen=project(nextProjected);float len=thickness;float orientation=direction;vec2 dir=vec2(0.0);if(currentScreen==previousScreen){dir=normalize(nextScreen-currentScreen);}else if(currentScreen==nextScreen){dir=normalize(currentScreen-previousScreen);}else{vec2 dirA=normalize((currentScreen-previousScreen));vec2 dirB=normalize((nextScreen-currentScreen));vec2 tangent=normalize(dirA+dirB);vec2 perp=vec2(-dirA.y,dirA.x);vec2 miter=vec2(-tangent.y,tangent.x);dir=tangent;float angle=40.0;if(dot(dirA,dirB)>cos(radians(angle))){len=thickness/dot(miter,perp);}}vec2 normal=vec2(-dir.y,dir.x);vNormal=normal*orientation;normal*=len/2.0;vec2 pos=currentScreen+normal*orientation;vec4 finalPos=unproject(pos,currentProjected.z,currentProjected.w);gl_Position=finalPos;}`,fragmentShader:"precision highp float;uniform bool uAntialias;uniform bool uAnimate;uniform float uTime;uniform float duration;uniform float interval;uniform float trailLength;varying vec4 vColor;varying vec2 vNormal;varying float vCounter;void main(){vec4 color=vColor;if(uAntialias){float blur=1.0;blur=1.0-smoothstep(0.98,1.0,length(vNormal));color.a*=blur;}if(uAnimate){float alpha=1.0-fract(mod(1.0-vCounter,interval)*(1.0/interval)+uTime/duration);alpha=(alpha+trailLength-1.0)/trailLength;color.a*=alpha;}gl_FragColor=color;}",defines:l.enablePicked?["PICK"]:[]},this),this.prevBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.currentBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.nextBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.directionBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.colorBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.counterBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:12,name:"previous",buffer:this.prevBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"position",buffer:this.currentBuffer,size:3,type:"FLOAT",offset:0},{stride:12,name:"next",buffer:this.nextBuffer,size:3,type:"FLOAT",offset:0},{stride:4,name:"direction",buffer:this.directionBuffer,size:1,type:"FLOAT",offset:0},{stride:16,name:"aColor",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0},{stride:4,name:"aCounter",buffer:this.counterBuffer,size:1,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){this.initData();for(var d=1,x=[],y=0;y<l.length;y++){var M=[],D=l[y].geometry.coordinates;D&&0<D.length&&(M=l[y].geometry.type==="Polygon"?D[0].map(function(O){return v.normizedPoint(O)}):D.map(function(O){return v.normizedPoint(O)})),M=c0(M),D=M.total,x[y]=M.arr,d=Math.max(D,d)}for(y=[],M=n.color,D=0;D<l.length;D++){var U=[],C=l[D].geometry.coordinates;C&&0<C.length&&(U=l[D].geometry.type==="Polygon"?C[0].map(function(O){return v.normizedPoint(O)}):C.map(function(O){return v.normizedPoint(O)})),C=M,Object.prototype.toString.call(C)==="[object Function]"?C=C(l[D]):(C=l[D].color||M,"properties"in l[D]&&"color"in l[D].properties&&(C=l[D].properties.color)),C=this.normizedColor(C);for(var E=this.addMultipleCoords(U),B=0;B<E.length;B++)this.processData(this.dataMgr,E[B],x[D],d,C);if(n.enablePicked)for(C=this.indexToRgb(D),E=0;E<U.length;E++)y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),n.repeat&&(y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255),y.push(C[0]/255,C[1]/255,C[2]/255))}this.counterBuffer.updateData(new Float32Array(this.dataMgr.counter)),this.currentBuffer.updateData(new Float32Array(this.dataMgr.position)),this.prevBuffer.updateData(new Float32Array(this.dataMgr.prev)),this.nextBuffer.updateData(new Float32Array(this.dataMgr.next)),this.directionBuffer.updateData(new Float32Array(this.dataMgr.direction)),this.colorBuffer.updateData(new Float32Array(this.dataMgr.color)),this.indexBuffer.updateData(new Uint32Array(this.dataMgr.index)),n.enablePicked&&this.pickBuffer.updateData(new Float32Array(y))}}},{key:"processData",value:function(n,l,v,d,x){var y,M,D,U,C,E,B,O=l.length,H=n.position.length/6;v=Ms(v.map(function($){return $/d}));var V=Ms(l.map(function($){return-1}),!0),G=Ms(l),j=Ms(l.map(yp(-1))),Y=Ms(l.map(yp(1)));l=Ms(l.map(function($){return x})),O=h0(O,H),(y=n.counter).push.apply(y,Jr(v)),(M=n.position).push.apply(M,Jr(aa(G))),(D=n.prev).push.apply(D,Jr(aa(j))),(U=n.next).push.apply(U,Jr(aa(Y))),(C=n.direction).push.apply(C,Jr(V)),(E=n.color).push.apply(E,Jr(aa(l))),(B=n.index).push.apply(B,Jr(O))}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=this.dataMgr;if(d&&!(0>=d.index.length)){var x=this.getOptions(),y=this.program;if(y.use(l),this.map){var M=this.map.getZoom();M=!!(M>=x.minZoom&&M<=x.maxZoom&&this.autoUpdate)}else M=!0;y.setUniforms(Nr(this.getCommonUniforms(n),{u_matrix:v,thickness:x.width,uAntialias:x.antialias,uTime:(new Date-this.date)/1e3,uAnimate:M,duration:x.duration,interval:x.interval,trailLength:x.trailLength})),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:x.blend==="lighter"?[l.SRC_ALPHA,l.ONE]:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:x.polygonOffset}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,d.index.length,l.UNSIGNED_INT,0)}}}]),u}(Ti),hn=function(a){function u(n,l){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n,l))}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.program=new qr(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform sampler2D uTerrain;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(TERRAIN)
vec4 terrainColor=texture2D(uTerrain,vec2(v_texture_coord.s,v_texture_coord.t));vec3 rgb=terrainColor.rgb*256.0;pos.z=-10000.0+((rgb.r*256.0*256.0+rgb.g*256.0+rgb.b)*0.1);pos.z=pos.z-60.0;
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`,fragmentShader:"precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform bool uUseFilter;uniform vec4 uFilterColor;void main(){vec4 textureColor=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}",defines:l.terrain?["TERRAIN"]:""},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:n,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadTextureTime&&clearTimeout(this.loadTextureTime),this.loadTextureTime=setTimeout(function(){v.loadTexture(function(){v.parseData(l),v.dataTime=new Date,v.webglLayer.render()})},0))}},{key:"render",value:function(n){var l=n.gl,v=n.projectionMatrix;n=n.viewMatrix;var d=this.getOptions(),x=this.program,y=x.uniforms;x.use(l),this.texture&&(l.activeTexture(l.TEXTURE0),l.uniform1i(y.uTile,0),l.bindTexture(l.TEXTURE_2D,this.texture),l.activeTexture(l.TEXTURE1),l.uniform1i(y.uTerrain,1),l.bindTexture(l.TEXTURE_2D,this.terrainSampler),this.setGLState({cullFace:!1}),x.setUniforms({u_proj_matrix:v,uUseFilter:!!d.filterColor,uFilterColor:this.normizedColor(d.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:n}),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)))}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.tile?v.terrain?sn(this.gl,v.terrain,function(d,x){l.terrainSampler=d,sn(l.gl,v.tile,function(y,M){l.texture=y,n&&n(),l.webglLayer.render()})},{TEXTURE_WRAP_S:"MIRRORED_REPEAT",TEXTURE_WRAP_T:"MIRRORED_REPEAT"}):sn(this.gl,v.tile,function(d,x){l.texture=d,n&&n(),l.webglLayer.render()}):(this.texture=null,n&&n())}},{key:"parseData",value:function(n){var l=this,v=[],d=[];if(n&&n[0]){var x=n[0].geometry.coordinates[0];x=x.map(function(O){return l.normizedPoint(O)}),n=x[0][0];var y=x[0][1],M=x[0][2],D=(x[2][0]-n)/16;x=(x[2][1]-y)/16;for(var U=0;16>=U;U++)for(var C=0;16>=C;C++)if(v.push(n+D*C,y+x*U,M),v.push(C/16,U/16),16>C&&16>U){var E=17*U+C,B=17*(U+1)+C;d.push(E,B+1,E+1),d.push(E,B,B+1)}}this.index=d,this.vertexBuffer.updateData(new Float32Array(v)),this.indexBuffer.updateData(new Uint32Array(d))}}]),u}(Ti),po=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="BoardLayer",n.index=[],l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.iconHash=new Yu,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{unit:"px",scale:1,angle:0,offsetZ:0,padding:[0,0],polygonOffset:[0,0],enableColorMix:!1,mixColor:"#fff",mixAmount:.5}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var v=[{name:"a_pos",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"a_corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"a_size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"a_offsetZ",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"a_rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"a_texture_coord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}];v=v.concat(this.getCommonAttributes());var d=[];l.enablePicked&&d.push("PICK"),this.options.enableColorMix&&(this.colorBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),v.push({stride:16,name:"a_color",buffer:this.colorBuffer,size:4,type:"FLOAT",offset:0}),d.push("USE_COLOR_MIX")),this.program=new qr(this.gl,{vertexShader:`precision highp float;attribute vec3 a_pos;attribute float a_corner;attribute float a_rotation;attribute float a_offsetZ;attribute vec2 a_size;attribute vec2 a_texture_coord;
#if defined(USE_COLOR_MIX)
attribute vec4 a_color;
#endif
uniform mat4 u_matrix;uniform vec2 u_size;uniform float u_zoom_units;uniform float u_scale;uniform bool u_unit_px;varying vec2 v_texture_coord;varying vec4 v_color;/***\u4E09\u7EF4\u7A7A\u95F4\u5185\uFF0C\u7ED5Z\u8F74\u65CB\u8F6C\u7684\u77E9\u9635\uFF0C\u53F3\u624B\u5750\u6807\u7CFB\u4E0B*[x'][cos0-sin0  0  0]*[y']=[sin0 cos0   0  0]*[z'][0     0     1  0]*[1][0     0     0  1]*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(a_rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){
#if defined(USE_COLOR_MIX)
v_color=a_color;
#endif
v_texture_coord=a_texture_coord;vec2 halfSize=a_size/2.0*u_scale;if(u_unit_px){halfSize*=u_zoom_units;}vec3 current=transformCoord(a_pos,halfSize,a_corner);current.z+=a_offsetZ;gl_Position=u_matrix*vec4(current,1.0);}`,fragmentShader:`precision highp float;varying vec2 v_texture_coord;varying vec4 v_color;uniform sampler2D u_icon;uniform vec4 uSelectedColor;
#if defined(USE_COLOR_MIX)
uniform float u_mix_amount;
#endif
void main(){vec4 textureColor=texture2D(u_icon,vec2(v_texture_coord.x,1.0-v_texture_coord.y));if(textureColor.a==0.0&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(USE_COLOR_MIX)
gl_FragColor=mix(gl_FragColor,v_color,u_mix_amount);
#endif
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:d},this),this.vertexArray=new bi({gl:n,program:this.program,attributes:v})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"forceUpdate",value:function(){this.gl&&this.processCache(this.options,this.data)}},{key:"processCache",value:function(n,l){var v=this;this.cachedData=[];for(var d=n.icon,x=n.width,y=n.height,M=n.offsetZ,D=n.angle,U=n.mixColor,C=0;C<l.length;C++){var E=this.normizedPoint(l[C].geometry.coordinates),B=this.getProperty("icon",d,l[C]),O=this.getProperty("width",x,l[C]),H=this.getProperty("height",y,l[C]),V=this.getProperty("angle",D,l[C]),G=this.getProperty("offsetZ",M,l[C]),j=this.normizedColor(this.getProperty("mixColor",U,l[C]));E&&B&&(this.cachedData.push({point:E,icon:B,width:O,height:H,offsetZ:G,angle:V,mixColor:j,index:C}),this.iconHash.get(B)||this.iconHash.set(B,B))}l=js(this.iconHash.entries()).filter(function(Y){return typeof Y[1]=="string"}).map(function(Y){var $=yi(Y,2)[0];return new ju(function(it,nt){v.url2canvas($,function(pt){v.iconHash.set($,pt),it()})})}),ju.all(l).then(function(Y){v.buildSprite(n),v.webglLayer.render()})}},{key:"buildSprite",value:function(n){var l=n.padding,v=this.canvas,d=this.ctx,x=[],y=new Yu,M=!0,D=!1,U=void 0;try{for(var C=Po(this.iconHash),E;!(M=(E=C.next()).done);M=!0){var B=yi(E.value,2),O=B[1];if(typeof O!="string"){var H=O.width,V=O.height;x.push({w:H+l[0],h:V+l[0],width:H,height:V,key:B[0],icon:O})}}}catch(G){D=!0,U=G}finally{try{!M&&C.return&&C.return()}finally{if(D)throw U}}for(D=xu(x),M=0;M<x.length;M++)U=x[M],y.get(U.key)||y.set(U.key,U);for(M=Ie(D.w),D=Ie(D.h),v.width=M||1,v.height=D||1,d.save(),v=0;v<x.length;v++)U=x[v],d.drawImage(U.icon,U.x+l[0],U.y+l[1],U.width,U.height);d.restore(),this.loadTexture(),this.buildVertex(n,y,M,D)}},{key:"buildVertex",value:function(n,l,v,d){var x=n.enablePicked;n=n.enableColorMix;for(var y=[],M=[],D=[],U=[],C=[],E=0;E<this.cachedData.length;E++){var B=this.cachedData[E],O=B.point,H=B.width,V=B.height,G=B.offsetZ,j=B.angle,Y=B.mixColor,$=B.index;if(B=l.get(B.icon)){H=H||B.icon.width,V=V||B.icon.height;var it=yi(O,3);O=it[0];var nt=it[1];it=it[2];for(var pt=0;4>pt;pt++)y.push(O,nt,it),y.push(pt),y.push(H,V),y.push(G),y.push(j*Math.PI/180);H=B.x/v,V=(B.x+B.w)/v,G=(B.y+B.h)/d,B=B.y/d,M.push(H,G,H,B,V,B,V,G),B=4*E,D.push(B,B+2,B+1,B,B+3,B+2),x&&($=this.indexToRgb($),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255),U.push($[0]/255,$[1]/255,$[2]/255)),n&&(C.push.apply(C,Jr(Y)),C.push.apply(C,Jr(Y)),C.push.apply(C,Jr(Y)),C.push.apply(C,Jr(Y)))}}this.index=D,this.vertexBuffer.updateData(new Float32Array(y)),this.uvBuffer.updateData(new Float32Array(M)),this.indexBuffer.updateData(new Uint32Array(D)),x&&this.pickBuffer.updateData(new Float32Array(U)),n&&this.colorBuffer.updateData(new Float32Array(C))}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.iconHash&&this.texture){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.setGLState({blend:!0,blendFunc:so(l,d.blend),polygonOffset:d.polygonOffset}),n=Nr(this.getCommonUniforms(n),{u_icon:this.texture,u_matrix:v,u_unit_px:d.unit==="px",u_zoom_units:this.map.getZoomUnits(),u_scale:d.scale}),d.enableColorMix&&(n=Nr(n,{u_mix_amount:d.mixAmount})),x.setUniforms(n),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"url2canvas",value:function(n,l){if((typeof n=="undefined"?"undefined":Qr(n))==="object")l(n);else{var v=new Image;v.crossOrigin="anonymous",v.onload=function(){var d=v.width,x=v.height,y=document.createElement("canvas");y.width=d,y.height=x,y.getContext("2d").drawImage(v,0,0,d,x),l(y)},v.onerror=function(){var d=document.createElement("canvas");d.width=20,d.height=40;var x=d.getContext("2d");x.fillStyle="red",x.beginPath(),x.lineTo(0,0),x.lineTo(20,0),x.lineTo(10,40),x.closePath(),x.fill(),l(d)},v.src=n}}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l}):this.texture=null}}]),u}(Ti),If=function(a){function u(n){Ke(this,u);var l=Dr(this,(u.__proto__||fr(u)).call(this,n));return n=l.getOptions(),l.shapeLayer=new xi({enablePicked:n.enablePicked}),l.lineLayer=new qa,l.children=[l.shapeLayer,l.lineLayer],l}return Pr(u,a),Qe(u,[{key:"pick",value:function(n,l){return this.shapeLayer.pick(n,l)}},{key:"onOptionsChanged",value:function(n){this.shapeLayer.setOptions({onClick:function(l){n.onClick&&n.onClick(l)},selectedIndex:n.selectedIndex,selectedColor:n.selectedColor,height:0,polygonOffset:[2,2],depthTest:n.depthTest,autoSelect:n.autoSelect,color:n.fillColor,opacity:n.fillOpacity,topColor:n.fillColor,useLight:!1,blend:n.blend}),this.lineLayer.setOptions({depthTest:n.depthTest,dashArray:n.dashArray,color:n.lineColor,width:n.lineWidth,lineJoin:n.lineJoin,blend:n.blend})}},{key:"onDataChanged",value:function(n){this.shapeLayer.setData(n),this.lineLayer.setData(n,{closePath:!0})}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ff0000",autoSelect:!0,dashArray:[0,0],lineColor:"rgba(250, 250, 25, 1)",depthTest:!0,lineWidth:2,lineJoin:"miter",fillColor:"rgba(25, 25, 250, 1)",fillOpacity:1,blend:"default"}}}]),u}(Aa),Tr=Tr||{},Jl=0,go=null,PA=Tr.Scene=function(a,u){this.name=u.name!==void 0?u.name:null,this.nodes=Array(u.nodes.length);for(var n=0,l=u.nodes.length;n<l;n++)this.nodes[n]=a.nodes[u.nodes[n]];this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.boundingBox=null},qs=Tr.BoundingBox=function(a,u,n){a=a||Or.fromValues(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),u=u||Or.fromValues(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY),n===void 0||n===!0?(this.min=Or.clone(a),this.max=Or.clone(u)):(this.min=a,this.max=u),this.transform=or.create()};qs.prototype.updateBoundingBox=function(a){Or.min(this.min,this.min,a.min),Or.max(this.max,this.max,a.max)},qs.prototype.calculateTransform=function(){this.transform[0]=this.max[0]-this.min[0],this.transform[5]=this.max[1]-this.min[1],this.transform[10]=this.max[2]-this.min[2],this.transform[12]=this.min[0],this.transform[13]=this.min[1],this.transform[14]=this.min[2]},qs.getAABBFromOBB=function(){var a=Or.create(),u=Or.create(),n=Or.create(),l=Or.create(),v=Or.create();return function(d,x){Or.set(a,x[0],x[1],x[2]),Or.set(u,x[4],x[5],x[6]),Or.set(n,x[8],x[9],x[10]),x=Or.fromValues(x[12],x[13],x[14]);var y=Or.clone(x);return Or.scale(l,a,d.min[0]),Or.scale(v,a,d.max[0]),Or.min(a,l,v),Or.add(x,x,a),Or.max(a,l,v),Or.add(y,y,a),Or.scale(l,u,d.min[1]),Or.scale(v,u,d.max[1]),Or.min(u,l,v),Or.add(x,x,u),Or.max(u,l,v),Or.add(y,y,u),Or.scale(l,n,d.min[2]),Or.scale(v,n,d.max[2]),Or.min(n,l,v),Or.add(x,x,n),Or.max(n,l,v),Or.add(y,y,n),d=new qs(x,y,!1),d.calculateTransform(),d}}();var Bm=Tr.Accessor=function(a,u){this.bufferView=u,this.componentType=a.componentType,this.byteOffset=a.byteOffset!==void 0?a.byteOffset:0,this.byteStride=u.byteStride,this.normalized=a.normalized!==void 0?a.normalized:!1,this.count=a.count,this.type=a.type,this.size=ql[this.type],this.min=a.min,this.max=a.max,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null};Bm.prototype.prepareVertexAttrib=function(a,u){u.vertexAttribPointer(a,this.size,this.componentType,this.normalized,this.byteStride,this.byteOffset),u.enableVertexAttribArray(a)};var Ju=Tr.BufferView=function(a,u){this.byteLength=a.byteLength,this.byteOffset=a.byteOffset!==void 0?a.byteOffset:0,this.byteStride=a.byteStride!==void 0?a.byteStride:0,this.target=a.target!==void 0?a.target:null,this.data=u.slice(this.byteOffset,this.byteOffset+this.byteLength),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.buffer=null};Ju.prototype.createBuffer=function(a){this.buffer=a.createBuffer()},Ju.prototype.bindData=function(a){return this.target?(a.bindBuffer(this.target,this.buffer),a.bufferData(this.target,this.data,a.STATIC_DRAW),a.bindBuffer(this.target,null),!0):!1};var Ks=Tr.Camera=function(a){this.name=a.name!==void 0?a.name:null,this.type=a.type,this.othographic=a.othographic===void 0?null:a.othographic,this.perspective=a.perspective===void 0?null:{yfov:a.perspective.yfov,znear:a.perspective.znear,zfar:a.perspective.zfar!==void 0?a.perspective.zfar:null,aspectRatio:a.perspective.aspectRatio!==void 0?a.perspective.aspectRatio:null},this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},qh=Tr.Node=function(a,u){if(this.name=a.name!==void 0?a.name:null,this.nodeID=u,this.camera=a.camera!==void 0?a.camera:null,this.matrix=or.create(),a.hasOwnProperty("matrix")){for(u=0;16>u;++u)this.matrix[u]=a.matrix[u];this.translation=Or.create(),or.getTranslation(this.translation,this.matrix),this.rotation=gf.create(),or.getRotation(this.rotation,this.matrix),this.scale=Or.create(),or.getScaling(this.scale,this.matrix)}else this.getTransformMatrixFromTRS(a.translation,a.rotation,a.scale);this.children=a.children||[],this.mesh=a.mesh!==void 0?go.glTF.meshes[a.mesh]:null,this.skin=a.skin!==void 0?a.skin:null,a.extensions!==void 0&&a.extensions.gl_avatar!==void 0&&go.enableGLAvatar===!0&&(this.skin=new Ef(go.glTF,go.skeletonGltf.skins[go.skeletonGltf.json.extensions.gl_avatar.skins[a.extensions.gl_avatar.skin.name]],a.extensions.gl_avatar.skin.inverseBindMatrices)),this.weights=a.weights!==void 0?a.weights:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.aabb=null,this.bvh=new qs};qh.prototype.traverse=function(a,u){u(this,a),a=0;for(var n=this.children.length;a<n;a++)this.children[a].traverse(this,u)},qh.prototype.traversePostOrder=function(a,u){for(var n=0,l=this.children.length;n<l;n++)this.children[n].traversePostOrder(this,u);u(this,a)},qh.prototype.traverseTwoExecFun=function(a,u,n){u(this,a);for(var l=0,v=this.children.length;l<v;l++)this.children[l].traverseTwoExecFun(this,u,n);n(this,a)};var F1=or.create();qh.prototype.getTransformMatrixFromTRS=function(a,u,n){this.translation=a!==void 0?Or.fromValues(a[0],a[1],a[2]):Or.fromValues(0,0,0),this.rotation=u!==void 0?Ni.fromValues(u[0],u[1],u[2],u[3]):Ni.fromValues(0,0,0,1),this.scale=n!==void 0?Or.fromValues(n[0],n[1],n[2]):Or.fromValues(1,1,1),this.updateMatrixFromTRS()},qh.prototype.updateMatrixFromTRS=function(){or.fromRotationTranslation(F1,this.rotation,this.translation),or.scale(this.matrix,F1,this.scale)};var qu=Tr.Mesh=function(a,u){this.meshID=u,this.name=a.name!==void 0?a.name:null,this.primitives=[],this.boundingBox=null,u=0;for(var n=a.primitives.length;u<n;++u){var l=a.primitives[u];l=new Md(go.glTF,l),this.primitives.push(l),l.boundingBox&&(this.boundingBox||(this.boundingBox=new qs),this.boundingBox.updateBoundingBox(l.boundingBox))}this.boundingBox&&this.boundingBox.calculateTransform(),this.weights=a.weights!==void 0?a.weights:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Md=Tr.Primitive=function(a,u){this.attributes=u.attributes,this.indices=u.indices!==void 0?u.indices:null;var n;if(u.extensions!==void 0&&u.extensions.gl_avatar!==void 0&&go.enableGLAvatar===!0&&u.extensions.gl_avatar.attributes)for(n in u.extensions.gl_avatar.attributes)this.attributes[n]=u.extensions.gl_avatar.attributes[n];this.indices!==null?(this.indicesComponentType=a.json.accessors[this.indices].componentType,this.indicesLength=a.json.accessors[this.indices].count,this.indicesOffset=a.json.accessors[this.indices].byteOffset||0):(this.drawArraysCount=a.json.accessors[this.attributes.POSITION].count,this.drawArraysOffset=a.json.accessors[this.attributes.POSITION].byteOffset||0);for(n in this.attributes)this.attributes[n]=a.accessors[this.attributes[n]];this.material=u.material!==void 0?a.materials[u.material]:null,this.mode=u.mode!==void 0?u.mode:4,this.targets=u.targets,this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.boundingBox=this.shader=this.indexBuffer=this.vertexBuffer=this.vertexArray=null,this.attributes.POSITION!==void 0&&(a=this.attributes.POSITION,a.max&&a.type==="VEC3"&&(this.boundingBox=new qs(Or.fromValues(a.min[0],a.min[1],a.min[2]),Or.fromValues(a.max[0],a.max[1],a.max[2]),!1),this.boundingBox.calculateTransform()))},Qo=Tr.Texture=function(a){this.name=a.name!==void 0?a.name:null,this.sampler=a.sampler!==void 0?go.glTF.samplers[a.sampler]:null,this.source=a.source!==void 0?go.glTF.images[a.source]:null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.texture=null};Qo.prototype.createTexture=function(a){this.texture=a.createTexture(),a.bindTexture(a.TEXTURE_2D,this.texture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,this.source),a.generateMipmap(a.TEXTURE_2D),a.bindTexture(a.TEXTURE_2D,null)};var Nm=Tr.Sampler=function(a){this.name=a.name!==void 0?a.name:null,this.magFilter=a.magFilter!==void 0?a.magFilter:null,this.minFilter=a.minFilter!==void 0?a.minFilter:null,this.wrapS=a.wrapS!==void 0?a.wrapS:10497,this.wrapT=a.wrapT!==void 0?a.wrapT:10497,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null,this.sampler=null};Nm.prototype.createSampler=function(a){this.sampler=a.createSampler(),this.minFilter?a.samplerParameteri(this.sampler,a.TEXTURE_MIN_FILTER,this.minFilter):a.samplerParameteri(this.sampler,a.TEXTURE_MIN_FILTER,a.NEAREST_MIPMAP_LINEAR),this.magFilter?a.samplerParameteri(this.sampler,a.TEXTURE_MAG_FILTER,this.magFilter):a.samplerParameteri(this.sampler,a.TEXTURE_MAG_FILTER,a.LINEAR),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_S,this.wrapS),a.samplerParameteri(this.sampler,a.TEXTURE_WRAP_T,this.wrapT)};var Cd=Tr.TextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},B1=Tr.PbrMetallicRoughness=function(a){this.baseColorFactor=a.baseColorFactor!==void 0?a.baseColorFactor:[1,1,1,1],this.baseColorTexture=a.baseColorTexture!==void 0?new Cd(a.baseColorTexture):null,this.metallicFactor=a.metallicFactor!==void 0?a.metallicFactor:1,this.roughnessFactor=a.roughnessFactor!==void 0?a.roughnessFactor:1,this.metallicRoughnessTexture=a.metallicRoughnessTexture!==void 0?new Cd(a.metallicRoughnessTexture):null,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},N1=Tr.NormalTextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.scale=a.scale!==void 0?a.scale:1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Kh=Tr.OcclusionTextureInfo=function(a){this.index=a.index,this.texCoord=a.texCoord!==void 0?a.texCoord:0,this.strength=a.strength!==void 0?a.strength:1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Qa=Tr.Material=function(a){this.name=a.name!==void 0?a.name:null,this.pbrMetallicRoughness=a.pbrMetallicRoughness!==void 0?new B1(a.pbrMetallicRoughness):new B1({baseColorFactor:[1,1,1,1],metallicFactor:1,metallicRoughnessTexture:1}),this.normalTexture=a.normalTexture!==void 0?new N1(a.normalTexture):null,this.occlusionTexture=a.occlusionTexture!==void 0?new Kh(a.occlusionTexture):null,this.emissiveTexture=a.emissiveTexture!==void 0?new Cd(a.emissiveTexture):null,this.emissiveFactor=a.emissiveFactor!==void 0?a.emissiveFactor:[0,0,0],this.alphaMode=a.alphaMode!==void 0?a.alphaMode:"OPAQUE",this.alphaCutoff=a.alphaCutoff!==void 0?a.alphaCutoff:.5,this.doubleSided=a.doubleSided||!1,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},Td=Tr.Skin=function(a,u,n){this.name=u.name!==void 0?u.name:null,this.skinID=n,this.joints=Array(u.joints.length);var l;for(n=0,l=this.joints.length;n<l;n++)this.joints[n]=a.nodes[u.joints[n]];if(this.skeleton=u.skeleton!==void 0?a.nodes[u.skeleton]:null,this.inverseBindMatrices=u.inverseBindMatrices!==void 0?a.accessors[u.inverseBindMatrices]:null,this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.uniformBlockID=Jl++,this.inverseBindMatrices)for(this.inverseBindMatricesData=ks(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),n=0,l=this.inverseBindMatricesData.length;n<l;n+=16)this.inverseBindMatrix.push(or.fromValues(this.inverseBindMatricesData[n],this.inverseBindMatricesData[n+1],this.inverseBindMatricesData[n+2],this.inverseBindMatricesData[n+3],this.inverseBindMatricesData[n+4],this.inverseBindMatricesData[n+5],this.inverseBindMatricesData[n+6],this.inverseBindMatricesData[n+7],this.inverseBindMatricesData[n+8],this.inverseBindMatricesData[n+9],this.inverseBindMatricesData[n+10],this.inverseBindMatricesData[n+11],this.inverseBindMatricesData[n+12],this.inverseBindMatricesData[n+13],this.inverseBindMatricesData[n+14],this.inverseBindMatricesData[n+15]))},Ef=Tr.SkinLink=function(a,u,n){if(this.isLink=!0,a.skins||(a.skins=[]),a.skins.push(this),this.name=u.name,this.skinID=a.skins.length-1,this.joints=u.joints,this.skeleton=u.skeleton,this.inverseBindMatrices=n!==void 0?a.accessors[n]:null,this.uniformBlockID=Jl++,this.inverseBindMatrices)for(this.inverseBindMatricesData=ks(this.inverseBindMatrices),this.inverseBindMatrix=[],this.jointMatrixUniformBuffer=null,this.jointMatrixUnidormBufferData=new Float32Array(1040),a=0,u=this.inverseBindMatricesData.length;a<u;a+=16)this.inverseBindMatrix.push(or.fromValues(this.inverseBindMatricesData[a],this.inverseBindMatricesData[a+1],this.inverseBindMatricesData[a+2],this.inverseBindMatricesData[a+3],this.inverseBindMatricesData[a+4],this.inverseBindMatricesData[a+5],this.inverseBindMatricesData[a+6],this.inverseBindMatricesData[a+7],this.inverseBindMatricesData[a+8],this.inverseBindMatricesData[a+9],this.inverseBindMatricesData[a+10],this.inverseBindMatricesData[a+11],this.inverseBindMatricesData[a+12],this.inverseBindMatricesData[a+13],this.inverseBindMatricesData[a+14],this.inverseBindMatricesData[a+15]))},DA=Tr.Target=function(a){this.nodeID=a.node!==void 0?a.node:null,this.path=a.path,this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},OA=Tr.Channel=function(a,u){this.sampler=u.samplers[a.sampler],this.target=new DA(a.target),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},zm=Tr.AnimationSampler=function(a,u){this.input=a.accessors[u.input],this.output=a.accessors[u.output],this.inputTypedArray=ks(this.input),this.outputTypedArray=ks(this.output),this.interpolation=u.interpolation!==void 0?u.interpolation:"LINEAR",this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null,this.curIdx=0,this.curValue=Ni.create(),this.endT=this.inputTypedArray[this.inputTypedArray.length-1],this.inputMax=this.endT-this.inputTypedArray[0]},Um=Ni.create(),Hm=Ni.create();zm.prototype.getValue=function(a){a>this.endT&&(a-=this.inputMax*Math.ceil((a-this.endT)/this.inputMax),this.curIdx=0);for(var u=this.inputTypedArray.length;this.curIdx<=u-2&&a>=this.inputTypedArray[this.curIdx+1];)this.curIdx++;this.curIdx>=u-1&&(a-=this.inputMax,this.curIdx=0),u=ql[this.output.type];var n=u===4?gf.slerp:Ni.lerp,l=this.curIdx,v=l*u,d=v+u;for(a=Math.max(0,a-this.inputTypedArray[l])/(this.inputTypedArray[l+1]-this.inputTypedArray[l]),l=0;l<u;l++)Um[l]=this.outputTypedArray[v+l],Hm[l]=this.outputTypedArray[d+l];switch(this.interpolation){case"LINEAR":n(this.curValue,Um,Hm,a)}};var FA=Tr.Animation=function(a,u){this.name=u.name!==void 0?u.name:null;var n;this.samplers=[];var l=0;for(n=u.samplers.length;l<n;l++)this.samplers[l]=new zm(a,u.samplers[l]);for(this.channels=[],l=0,n=u.channels.length;l<n;l++)this.channels[l]=new OA(u.channels[l],this);this.extensions=u.extensions!==void 0?u.extensions:null,this.extras=u.extras!==void 0?u.extras:null},BA=Tr.glTFModel=function(a){this.json=a,this.defaultScene=a.scene!==void 0?a.scene:0,this.version=Number(a.asset.version),a.accessors&&(this.accessors=Array(a.accessors.length)),a.bufferViews&&(this.bufferViews=Array(a.bufferViews.length)),a.scenes&&(this.scenes=Array(a.scenes.length)),a.nodes&&(this.nodes=Array(a.nodes.length)),a.meshes&&(this.meshes=Array(a.meshes.length)),a.materials&&(this.materials=Array(a.materials.length)),a.textures&&(this.textures=Array(a.textures.length)),a.samplers&&(this.samplers=Array(a.samplers.length)),a.images&&(this.images=Array(a.images.length)),a.skins&&(this.skins=Array(a.skins.length)),a.animations&&(this.animations=Array(a.animations.length)),a.cameras&&(this.cameras=Array(a.cameras.length)),this.extensions=a.extensions!==void 0?a.extensions:null,this.extras=a.extras!==void 0?a.extras:null},$o=Tr.glTFLoader=function(a){this._init(),this.glTF=null,this.enableGLAvatar=!1,this.linkSkeletonGltf=null};$o.prototype._init=function(){this._loadDone=!1,this._bufferLoaded=this._bufferRequested=0,this._buffers=[],this._bufferTasks={},this._finishedPendingTasks=this._pendingTasks=this._imageLoaded=this._imageRequested=this._shaderLoaded=this._shaderRequested=0,this.onload=null,go=this},$o.prototype._checkComplete=function(){this._bufferRequested==this._bufferLoaded&&this._imageRequested==this._imageLoaded&&(this._loadDone=!0),this._loadDone&&this._pendingTasks==this._finishedPendingTasks&&(this._postprocess(),this.onload(this.glTF))},$o.prototype.loadGLTF_GL_Avatar_Skin=function(a,u,n){this.enableGLAvatar=!0,this.skeletonGltf=u,this.loadGLTF(a,n)},$o.prototype.loadGLTF=function(a,u){this._init(),this.onload=u||function(l){},this.baseUri=v0(a);var n=this;y0(a,function(l){l=JSON.parse(l),n.glTF=new BA(l);var v,d=function(M){if(n._buffers[v]=M,n._bufferLoaded++,n._bufferTasks[v]){var D,U=0;for(D=n._bufferTasks[v].length;U<D;++U)n._bufferTasks[v][U](M)}n._checkComplete()};if(l.buffers)for(v in l.buffers){n._bufferRequested++;var x=l.buffers[v].uri;x.indexOf("base64")===-1&&(x=n.baseUri+x),x0(x,d)}d=function(M,D){n._imageLoaded++,n.glTF.images[D]=M,n._checkComplete()};var y;if(l.images)for(y in l.images)n._imageRequested++,Dc(n.baseUri+l.images[y].uri,y,d);n._checkComplete()})},$o.prototype._postprocess=function(){function a(U,C){var E=M[U.nodeID];C!==null?or.mul(E,M[C.nodeID],U.matrix):or.copy(E,U.matrix)}function u(U,C){var E=M[U.nodeID];C=C!==null?C.bvh:D.boundingBox,U.mesh&&(v=U.mesh,v.boundingBox&&(U.aabb=qs.getAABBFromOBB(v.boundingBox,E),U.children.length===0&&(Or.copy(U.bvh.min,U.aabb.min),Or.copy(U.bvh.max,U.aabb.max)))),Or.min(C.min,C.min,U.bvh.min),Or.max(C.max,C.max,U.bvh.max)}go=this;var n,l,v;if(this.glTF.cameras){var d=0;for(n=this.glTF.cameras.length;d<n;d++)this.glTF.cameras[d]=new Ks(this.glTF.json.cameras[d])}if(this.glTF.bufferViews)for(d=0,n=this.glTF.bufferViews.length;d<n;d++)this.glTF.bufferViews[d]=new Ju(this.glTF.json.bufferViews[d],this._buffers[this.glTF.json.bufferViews[d].buffer]);if(this.glTF.accessors)for(d=0,n=this.glTF.accessors.length;d<n;d++)this.glTF.accessors[d]=new Bm(this.glTF.json.accessors[d],this.glTF.bufferViews[this.glTF.json.accessors[d].bufferView]);if(this.glTF.materials)for(d=0,n=this.glTF.materials.length;d<n;d++)this.glTF.materials[d]=new Qa(this.glTF.json.materials[d]);if(this.glTF.samplers)for(d=0,n=this.glTF.samplers.length;d<n;d++)this.glTF.samplers[d]=new Nm(this.glTF.json.samplers[d]);if(this.glTF.textures)for(d=0,n=this.glTF.textures.length;d<n;d++)this.glTF.textures[d]=new Qo(this.glTF.json.textures[d]);for(d=0,n=this.glTF.meshes.length;d<n;d++)this.glTF.meshes[d]=new qu(this.glTF.json.meshes[d],d);for(d=0,n=this.glTF.nodes.length;d<n;d++)this.glTF.nodes[d]=new qh(this.glTF.json.nodes[d],d);for(d=0,n=this.glTF.nodes.length;d<n;d++){var x=this.glTF.nodes[d],y=0;for(l=x.children.length;y<l;y++)x.children[y]=this.glTF.nodes[x.children[y]]}var M=Array(this.glTF.nodes.length);for(d=0,n=M.length;d<n;d++)M[d]=or.create();for(d=0,n=this.glTF.scenes.length;d<n;d++){var D=this.glTF.scenes[d]=new PA(this.glTF,this.glTF.json.scenes[d]);for(D.boundingBox=new qs,y=0,l=D.nodes.length;y<l;y++)x=D.nodes[y],x.traverseTwoExecFun(null,a,u);D.boundingBox.calculateTransform()}for(y=0,l=this.glTF.nodes.length;y<l;y++)x=this.glTF.nodes[y],x.bvh!==null&&x.bvh.calculateTransform();if(this.glTF.animations)for(d=0,n=this.glTF.animations.length;d<n;d++)this.glTF.animations[d]=new FA(this.glTF,this.glTF.json.animations[d]);if(this.glTF.json.skins)for(d=0,n=this.glTF.skins.length;d<n;d++)for(this.glTF.skins[d]=new Td(this.glTF,this.glTF.json.skins[d],d),x=this.glTF.skins[d].joints,y=0,l=x.length;y<l;y++)x[y].jointID=y;for(d=0,n=this.glTF.nodes.length;d<n;d++)x=this.glTF.nodes[d],x.skin!==null&&typeof x.skin=="number"&&(x.skin=this.glTF.skins[x.skin])};var ql={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Sd=function(a){function u(n,l){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n,l))}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{scale:1}}},{key:"initialize",value:function(n){var l=this;this.gl=n;var v=this.getOptions();this.gltfObj=zx({gl:n,options:v}),new $o().loadGLTF(v.url,function(d){l.gltfObj.setupScene(d),l.webglLayer.render()})}},{key:"onChanged",value:function(n,l){}},{key:"render",value:function(n){var l=n.gl;n=n.matrix;var v=this.getData(),d=this.getOptions(),x=d.scale,y=[x,x,x];for(d.unit==="px"&&this.map&&(y=this.map.getZoomUnits(),y=[x*y,x*y,x*y]),x=0;x<v.length;x++){var M=v[x].geometry.coordinates;d=or.create();var D=or.create();M=this.normizedPoint(M),or.identity(d),or.translate(d,d,[M[0],M[1],M[2]]),or.rotateX(d,d,Math.PI/2),or.rotateY(d,d,(v[x].angle||0)*Math.PI/180),or.scale(d,d,y),or.mul(D,n,d),this.gltfObj.render({gl:l,matrix:D})}}}]),u}(Ti),Qs=Qs||{};(function(){function a(n,l,v){return v=n.createShader(v),n.shaderSource(v,l),n.compileShader(v),v}Qs.getShaderSource=function(n){return document.getElementById(n).textContent.replace(/^\s+|\s+$/g,"")},Qs.createProgram=function(n,l,v){var d=n.createProgram();return l=a(n,l,n.VERTEX_SHADER),v=a(n,v,n.FRAGMENT_SHADER),n.attachShader(d,l),n.deleteShader(l),n.attachShader(d,v),n.deleteShader(v),n.linkProgram(d),n.getProgramInfoLog(d),n.getShaderInfoLog(l),n.getShaderInfoLog(v),d};var u=Qs.loadImage=function(n,l){var v=new Image;return v.crossOrigin="Anonymous",v.src=n,v.onload=l,v};Qs.loadImages=function(n,l){function v(){0>=--x&&l(d)}for(var d=[],x=n.length,y=0;y<x;++y)d.push(u(n[y],v))}})();var Qh=function(a){function u(n){Ke(this,u);var l=Dr(this,(u.__proto__||fr(u)).call(this,n));return n=l.getOptions(),l.gltfLayer=new Sd({url:n.url,scale:n.scale}),l.children=[l.gltfLayer],l.autoUpdate=!0,l.index=[],l.newData=[],l.isStarted=n.autoPlay!==!1,l}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{url:"https://mapv-website.bj.bcebos.com/gl/examples/model/car.gltf",scale:1,step:1,defaultAngle:90}}},{key:"onOptionsChanged",value:function(n){this.gltfLayer.setOptions({})}},{key:"onDataChanged",value:function(n){var l=this;this.index=[],this.newData=[];for(var v=0;v<n.length;v++){this.index.push(0);var d=n[v].geometry.coordinates;n[v].geometry.type==="LineString"?this.newData.push(this._addPath(d)):d.forEach(function(x){l.newData.push(l._addPath(x))})}this.updatePoints()}},{key:"lnglatToMercator",value:function(n,l){return l=l*Math.PI/180,l=31890685e-1*Math.log((1+Math.sin(l))/(1-Math.sin(l))),[parseFloat((n*Math.PI/180*6378137).toFixed(2)),parseFloat(l.toFixed(2))]}},{key:"getDeg",value:function(n,l){-180<n[0]&&180>n[0]&&(n=this.lnglatToMercator(n[0],n[1]),l=this.lnglatToMercator(l[0],l[1]));var v=180*Math.atan((l[1]-n[1])/(l[0]-n[0]))/Math.PI;return l[0]>n[0]&&(v-=180),v}},{key:"getPoint",value:function(n,l,v){return[n[0]+(l[0]-n[0])*v,n[1]+(l[1]-n[1])*v,n[2]&&l[2]?n[2]+(l[2]-n[2])*v:0]}},{key:"updatePoints",value:function(){for(var n=this.getOptions(),l=this.newData,v=[],d=0;d<l.length;d++){for(var x=l[d],y=Math.floor(this.index[d]),M=y+1;x[M]&&x[M][0]===x[y][0]&&x[M][1]===x[y][1];)M++;M>=x.length-1&&(M=--y),M=this.getDeg(x[y],x[M]),v.push({geometry:{type:"Point",coordinates:this.getPoint(x[y],x[y+1],this.index[d]%1)},angle:M-n.defaultAngle})}this.pointData=v,this.gltfLayer.setData(v,{autoRender:!1})}},{key:"getCurrentPoint",value:function(){return this.pointData}},{key:"getDistance",value:function(n,l){var v=n[1]*Math.PI/180,d=l[1]*Math.PI/180;return n=2*Math.asin(Math.sqrt(Math.pow(Math.sin((v-d)/2),2)+Math.cos(v)*Math.cos(d)*Math.pow(Math.sin((n[0]*Math.PI/180-l[0]*Math.PI/180)/2),2))),n=Math.round(6378137e4*n)/1e4}},{key:"_addPath",value:function(n){for(var l=n.length,v=0,d=[],x=[],y=1;y<l;y++){var M=this.getDistance(n[y-1],n[y]);d.push(M),v+=M}for(M=[0],y=1;y<l;y++){var D=(d[y-1]/v).toFixed(2);M[y]=M[y-1]+parseFloat(D,10),x=x.concat(this._getPath(n[y-1],n[y],1e3*D))}return this._pathPercents=M,x}},{key:"_getPath",value:function(n,l,v){if(v===0)return[n];for(var d=[],x=0;x<=v;x++)d.push([(l[0]-n[0])/v*x+n[0],(l[1]-n[1])/v*x+n[1],l[2]&&n[2]?(l[2]-n[2])/v*x+n[2]:0]);return d}},{key:"start",value:function(){this.isStarted=!0}},{key:"stop",value:function(){this.isStarted=!1}},{key:"render",value:function(n){if(Ds(u.prototype.__proto__||fr(u.prototype),"render",this).call(this,n),n=this.getOptions(),this.isStarted)for(var l=this.newData,v=0;v<this.index.length;v++)this.index[v]+=n.step,this.index[v]>l[v].length-2&&(this.index[v]=0);this.updatePoints()}}]),u}(Aa),$h=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="BoardTextLayer",l=n.canvas=document.createElement("canvas"),l=n.ctx=l.getContext("2d"),l.textAlign="start",l.textBaseline="top",n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,collides:!0,unit:"px",angle:0,translateX:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],shadow:{},maxHeightLine:20,lineBreak:`
`}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new qr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uUnitPx;uniform float zoomUnits;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/mat3 rotateZ(float angle){float cos0=cos(angle);float sin0=sin(angle);return mat3(cos0,sin0,0.,-sin0,cos0,0.,0.,0.,1.);}vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;float z=coord.z;mat3 mat=rotateZ(rotation);vec3 rotated=vec3(size[0],0.0,size[1]);if(corner==1.0){rotated=mat*vec3(-size[0],0.0,size[1]);}else if(corner==2.0){rotated=mat*vec3(size[0],0.0,size[1]);}else if(corner==3.0){rotated=mat*vec3(size[0],0.0,-size[1]);}else{rotated=mat*vec3(-size[0],0.0,-size[1]);}x+=rotated.x;y+=rotated.y;z+=rotated.z;return vec3(x,y,z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){vec4 textureColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));if(textureColor.a<=0.1&&uIsPickRender==false){discard;}gl_FragColor=textureColor;
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){this.cachedData=[];for(var v=0;v<l.length;v++){var d=this.normizedPoint(l[v].geometry.coordinates),x=l[v].text;"properties"in l[v]&&"text"in l[v].properties&&(x=l[v].properties.text);var y=this.getProperty("angle",n.angle,l[v]),M=this.getProperty("color",n.color,l[v]),D=this.getProperty("maxHeightLine",n.maxHeightLine,l[v]);d&&x!==void 0&&this.cachedData.push({point:d,text:x,angle:y,color:M,maxHeightLine:D,index:v})}}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:so(l,d.blend),polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();x.setUniforms(Nr(this.getCommonUniforms(n),{matrix:v,textureImage:this.texture,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions();n=d.fontSize;var x=d.fontFamily,y=d.translateX,M=d.padding,D=d.margin,U=d.collides,C=d.enablePicked,E=d.shadow;d=d.lineBreak;var B=l.canvas.width/window.devicePixelRatio,O=l.canvas.height/window.devicePixelRatio,H=this.canvas,V=this.ctx;V.save(),V.scale(window.devicePixelRatio,window.devicePixelRatio),V.textBaseline="top",V.font="normal bold 20px "+x;var G=new Os;l=[];for(var j=0;j<this.cachedData.length;j++){var Y=this.cachedData[j],$=Y.point,it=Y.text,nt=Y.angle,pt=Y.index,Rt=Y.color;Y=Y.maxHeightLine;var Et=yi($,3),Jt=Ni.clone([Et[0],Et[1],Et[2],1]);Ni.transformMat4(Jt,Jt,v),Ni.scale(Jt,Jt,1/Jt[3]),Et=(Jt[0]+1)/2*B,Jt=(-Jt[1]+1)/2*O;var oe=V.measureText(it),Se=it.split(d),ge=Se.map(function(he){return V.measureText(he).width});ge=Math.max.apply(Math,Jr(ge));for(var Xe=20,_r=0;_r<Se.length-1;_r++)Xe+=Y;if(Se=Xe,oe=Math.min(oe.width,ge)+1,oe+=2*M[0]+y,Se+=2*M[1],Xe=oe+D[0],ge=Se+D[1],Et-=Xe/2,Jt-=ge/2,Xe=Et+Xe,ge=Jt+ge,!(0>Xe||0>ge||Et>B||Jt>O)){if(U){if(Et={minX:Et,maxX:Xe,minY:Jt,maxY:ge},G.collides(Et))continue;G.insert(Et)}l.push({w:oe,h:Se,point:$,text:it,color:Rt,angle:nt,maxHeightLine:Y,dataIndex:pt})}}for(V.restore(),v=[],D=[],U=[],B=[],G=xu(l),O=G.w,G=G.h,0>=O&&(O=1),0>=G&&(G=1),H.width=O*window.devicePixelRatio,H.height=G*window.devicePixelRatio,V.save(),V.scale(window.devicePixelRatio,window.devicePixelRatio),V.textBaseline="top",V.font="normal bold 20px "+x,V.shadowColor=E&&E.color,V.shadowOffsetX=E&&E.offsetX,V.shadowOffsetY=E&&E.offsetY,V.shadowBlur=E&&E.blur,x=0,E=l.length;x<E;++x){for(H=l[x],V.fillStyle=H.color,Ux(V,H.text,H.x+M[0]+y,H.y+M[1],H.maxHeightLine,d),it=yi(H.point,3),j=it[0],$=it[1],it=it[2],nt=0;4>nt;nt++)v.push(j,$,it),v.push(nt),v.push(H.w,H.h),v.push(n/20,H.angle*Math.PI/180);j=H.x/O,$=(H.x+H.w)/O,it=(H.y+H.h)/G,nt=H.y/G,D.push(j,it,j,nt,$,nt,$,it),j=4*x,U.push(j,j+2,j+1,j,j+3,j+2),C&&(H=this.indexToRgb(H.dataIndex),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255),B.push(H[0]/255,H[1]/255,H[2]/255))}V.restore(),this.loadTexture(),this.index=U,this.vertexBuffer.updateData(new Float32Array(v)),this.uvBuffer.updateData(new Float32Array(D)),this.indexBuffer.updateData(new Uint32Array(U)),C&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ti),Ku=function(a){function u(n){Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.name="LabelLayer",n.pickedIndex=null;var l=n.canvas=document.createElement("canvas");return n.ctx=l.getContext("2d"),n.arrowHeight=8,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,textColor:"#0f0",borderColor:"#f00",backgroundColor:"#fff",pickedTextColor:"#fff",pickedBorderColor:"#666",pickedBackgroundColor:"#666",fontFamily:"Microsoft Yahei",fontSize:14,lineHeight:20,textAlign:"left",collides:!1,offset:[0,0],padding:[2,2],polygonOffset:[0,0],borderRadius:5,stroke:{color:"#fff",width:0}}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new qr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x;y+=size.y;}else if(corner==2.0){x+=size.x;y+=size.y;}else if(corner==3.0){x+=size.x;y+=-size.y;}else{x+=-size.x;y+=-size.y;}return vec3(x,y+size.y,coord.z);}void main(){vTextCoord=aTextCoord;vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z+zIndex,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio;vec3 current=transformCoord(screen,halfSize,corner);gl_Position=vec4(current,1.0);}",fragmentShader:"precision highp float;uniform sampler2D textureImage;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));}",defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:24,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:24,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:24,type:"FLOAT",offset:16},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){for(this.cachedData=[],this.pickedIndex=null,n=0;n<l.length;n++){var v=l[n],d=this.normizedPoint(v.geometry.coordinates);d&&this.cachedData.push({point:d,item:v,index:n})}}},{key:"setPickedIndex",value:function(n,l){var v=this;l!=="onMousemove"?0<=n&&(this.pickedIndex=n,setTimeout(function(){v.webglLayer.render()})):this.pickedIndex=n}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.updateText(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();n=Nr(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,offset:d.offset,zoomUnits:y,zIndex:d.zIndex}),delete n.uSelectedColor,x.setUniforms(n),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"updateText",value:function(n){var l=this,v=n.gl,d=n.matrix,x=this.getOptions().enablePicked;n=this.canvas;var y=this.ctx;v=this.createMapbox(y,v,d),d=xu(v);var M=d.w,D=d.h;0>=M&&(M=1),0>=D&&(D=1),n.width=M*window.devicePixelRatio,n.height=D*window.devicePixelRatio;var U=[],C=[],E=[],B=[];v.forEach(function(O,H){l.drawItem(y,O);var V=yi(O.point,3),G=V[0],j=V[1];V=V[2];for(var Y=0;4>Y;Y++)U.push(G,j,V),U.push(Y),U.push(O.w,O.h);G=O.x/M,j=(O.x+O.w)/M,V=(O.y+O.h)/D,Y=O.y/D,C.push(G,V,G,Y,j,Y,j,V),H*=4,E.push(H,H+2,H+1,H,H+3,H+2),x&&(O=l.indexToRgb(O.dataIndex),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255),B.push(O[0]/255,O[1]/255,O[2]/255))}),this.loadTexture(),this.index=E,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(C)),this.indexBuffer.updateData(new Uint32Array(E)),x&&this.pickBuffer.updateData(new Float32Array(B))}},{key:"createMapbox",value:function(n,l,v){function d(H){var V=H.point,G=H.item;H=H.index;var j=yi(V,3);j=Ni.clone([j[0],j[1],j[2],1]),Ni.transformMat4(j,j,v),Ni.scale(j,j,1/j[3]);var Y=(j[0]+1)/2*C,$=(-j[1]+1)/2*E;j=this.computeTextWH(G,n,M,U);var it=yi(j,2);j=it[0],it=it[1],Y-=j/2,$-=it/2;var nt=Y+j,pt=$+it;if(!(0>nt||0>pt||Y>C||$>E)){if(D){if(Y={minX:Y,maxX:nt,minY:$,maxY:pt},B.collides(Y))return;B.insert(Y)}O.push({w:j,h:it+this.arrowHeight,point:V,item:G,dataIndex:H})}}var x=this,y=this.getOptions(),M=y.padding,D=y.collides,U=y.fontSize,C=l.canvas.width/window.devicePixelRatio,E=l.canvas.height/window.devicePixelRatio,B=new Os,O=[];return this.cachedData[this.pickedIndex]&&d.bind(this)(this.cachedData[this.pickedIndex]),this.cachedData.forEach(function(H){x.pickedIndex!==H.index&&d.bind(x)(H)}),O}},{key:"computeTextWH",value:function(n,l){var v=this.getOptions(),d=v.padding,x=v.fontSize,y=v.borderRadius,M=v.fontFamily;return v=v.lineHeight,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),l.font=x+"px "+M,n=n.properties.text.split(`
`),x=n.reduce(function(D,U){return U=l.measureText(U),D<U.width?U.width:D},0),l.restore(),[x+2*(d[1]+y),2*(d[0]+y)+v*n.length]}},{key:"drawItem",value:function(n,l){var v=this.getOptions(),d=v.padding,x=v.backgroundColor,y=v.textColor,M=v.fontSize,D=v.borderColor,U=v.borderRadius,C=v.fontFamily,E=v.lineHeight,B=v.textAlign,O=v.pickedTextColor,H=v.pickedBorderColor,V=v.pickedBackgroundColor,G=v.shadow,j=v.stroke,Y=U-1,$=l.x,it=l.y;v=l.w;var nt=l.h,pt=l.item;l=l.dataIndex;var Rt="";Qr(pt.properties)==="object"&&(pt=pt.properties,Rt=pt.text||"",G=pt.shadow||G,j=pt.stroke||j,M=pt.fontSize||M,B=pt.textAlign||B,E=pt.lineHeight||E,y=pt.textColor||y,C=pt.fontFamily||C,D=pt.borderColor||D,x=pt.backgroundColor||x),this.pickedIndex===l&&(y=O,D=H,x=V),O=Rt.split(`
`),H=nt-this.arrowHeight,n.save(),n.scale(window.devicePixelRatio,window.devicePixelRatio),n.textBaseline="top",n.font=M+"px "+C,n.translate($,it),n.fillStyle=x,n.strokeStyle=D,n.beginPath(),n.arc(U,U,Y,Math.PI,1.5*Math.PI),n.lineTo(v-U,1),n.arc(v-U,U,Y,1.5*Math.PI,0),n.lineTo(v-1,H-U),n.arc(v-U,H-U,Y,0*Math.PI,.5*Math.PI),n.lineTo(U,H-1),n.arc(U,H-U,Y,.5*Math.PI,1*Math.PI),n.lineTo(1,U),n.closePath(),n.fill(),n.stroke(),n.beginPath(),x=this.arrowHeight,C=v/2,Y=x/2,n.moveTo(C-Y,H-1),n.lineTo(C+Y,H-1),n.lineTo(C,H+.8*x),n.fillStyle=D,n.fill(),n.fillStyle=y,G&&(n.shadowColor=G.color,n.shadowOffsetX=G.offsetX,n.shadowOffsetY=G.offsetY,n.shadowBlur=G.blur);var Et=B==="center"?C:B==="right"?v-U-d[1]:U+d[1];n.textAlign=B,O.forEach(function(Jt,oe){oe=U+d[0]+(oe+.5)*E-.5*M,0<j.width&&(n.lineWidth=j.width,n.strokeStyle=j.color,n.strokeText(Jt,Et,oe)),n.fillText(Jt,Et,oe)}),n.restore()}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ti);Rn.prototype.parseColors=function(a){this.arrFeatureStyles=[[2,a[0]||"rgba(79,210,125,1)",2,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",3,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",5,2,0,[],0,0],[2,a[0]||"rgba(79,210,125,1)",6,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",2,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",3,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",5,2,0,[],0,0],[2,a[2]||"rgba(255,208,69,1)",6,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",2,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",3,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",5,2,0,[],0,0],[2,a[1]||"rgba(232,14,14,1)",6,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",2,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",3,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",5,2,0,[],0,0],[2,a[3]||"rgba(181,0,0,1)",6,2,0,[],0,0],[2,"rgba(255,255,255,1)",4,0,0,[],0,0],[2,"rgba(255,255,255,1)",5.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",7,0,0,[],0,0],[2,"rgba(255,255,255,1)",8.5,0,0,[],0,0],[2,"rgba(255,255,255,1)",10,0,0,[],0,0]]},Rn.prototype.setColors=function(a){this.parseColors(a)},Rn.prototype.initialize=function(a){this._initialize||(this._initialize=!0)},Rn.prototype.clearCache=function(a){this.cache={}},Rn.prototype.setMap=function(a){a?(this.map=a,this._initialize?this.canvaslayer.show():this.initialize(a)):this.canvaslayer.hide()},Rn.prototype.draw=function(a){a=a||{},a.clearCache&&this.clearCache(),this.canvaslayer.draw()},Rn.prototype.clear=function(){},Rn.prototype.update=function(){var a=this.map,u=this.getDataZoom(),n=Math.pow(2,18-u),l=256*n,v=Yr.convertLL2MC(a.getCenter()),d=Math.ceil(v.lng/l),x=Math.ceil(v.lat/l),y=this.tileSize,M=u-Math.round(a.getZoom());for(0<M&&(y/=Math.pow(2,M)),l=[d,x,(v.lng-d*l)/l*y,(v.lat-x*l)/l*y],d=a.getBounds(),v=d.getNorthEast(),d=d.getSouthWest(),a.getSize(),a.getSize(),a=(v.lng-d.lng)/n,n=(v.lat-d.lat)/n,v=l[1]-Math.ceil((n/2-l[3])/y),d=l[0]+Math.ceil((a/2+l[2])/y),x=l[1]+Math.ceil((n/2+l[3])/y),n=[],y=l[0]-Math.ceil((a/2-l[2])/y);y<d;y++)for(l=v;l<x;l++)n.push([y,l,u]);for(this.tilesOrder=n,this._loadCount={},y=0;y<n.length;y++)l=n[y][0],a=n[y][1],this._loadCount[l+"_"+a+"_"+n[y][2]]=!1;for(y=0;y<n.length;y++)l=n[y][0],a=n[y][1],this.showTile(l,a,u)},Rn.prototype.showTile=function(a,u,n){this._parseDataAndDraw(a,u,n)},Rn.prototype.drawCurrentData=function(){this.clear();for(var a=[],u=0;u<this.tilesOrder.length;u++){var n=this.tilesOrder[u][0],l=this.tilesOrder[u][1],v=this.tilesOrder[u][2],d=this.cache[this.getCacheKey(n,l,v)];if(d)for(n=this._drawFeatures(d,n,l,v),l=0;l<n.length;l++)a.push(n[l])}this.lineLayer.setData(a)},Rn.prototype.isAllLoaded=function(){var a=!0,u;for(u in this._loadCount)if(!this._loadCount[u]){a=!1;break}return a},Rn.prototype.getCacheKey=function(a,u,n){return a+"_"+u+"_"+n},Rn.prototype.getDataZoom=function(){var a=Math.round(this.map.getZoom());return 19<a&&(a=19),a},Rn.prototype._parseDataAndDraw=function(a,u,n){var l=this,v=l.map,d=v.getCenter(),x=Math.round(v.getZoom()),y=this.getCacheKey(a,u,n),M="_cbk"+(1e5*Math.random()).toFixed(0),D=this.getTileUrl(a,u,n,"BMapGL."+M);BMapGL[M]=function(U){l._loadCount[a+"_"+u+"_"+n]=!0;var C=v.getCenter(),E=Math.round(v.getZoom());C.equals(d)&&E===x?(C=U.content&&U.content.tf,U.data&&(C=U.data),l.cache[y]=C?{traffic:C,precision:U.precision}:null,l.drawTogether&&l.isAllLoaded()&&l.drawCurrentData()):E!==x&&l.clear(),delete BMapGL[M]},l.cache[y]!==void 0?(l._loadCount[a+"_"+u+"_"+n]=!0,l.drawTogether&&l.isAllLoaded()&&l.drawCurrentData()):this.request(D)},Rn.prototype.getTileUrl=function(a,u,n,l){return"https://sp3.baidu.com/7_AZsjOpB1gCo2Kml5_Y_DAcsMJiwa/traffic/?qt=vtraffic&x="+a+"&y="+u+"&z="+n+"&fn="+l+"&t="+new Date().getTime()},Rn.prototype._drawFeatures=function(a,u,n,l){var v=10;l=Math.pow(2,18-l),this.map.getCenter();var d=this.tileSize;if(u=[u*d*l,(n+1)*d*l],n=[],a&&a.traffic){v*=a.precision,a=a.traffic,d=0;for(var x=a.length;d<x;d++){var y=a[d],M=y[1];y=this.arrFeatureStyles[y[3]];var D=M[0]/v,U=-M[1]/v,C=[];C.push([u[0]+D*l,u[1]+U*l,1]);for(var E=2,B=M.length;E<B;E+=2)D+=M[E]/v,U-=M[E+1]/v,C.push([u[0]+D*l,u[1]+U*l,1]);n.push({color:y[1],geometry:{type:"LineString",coordinates:C}})}}return n},Rn.prototype.request=function(a,u){if(u){var n=(1e5*Math.random()).toFixed(0);BMapGL._rd["_cbk"+n]=function(v){u&&u(v),delete BMapGL._rd["_cbk"+n]},a+="&callback=BMapGL._rd._cbk"+n}var l=document.createElement("script");l.type="text/javascript",l.charset="utf-8",l.src=a,l.addEventListener?l.addEventListener("load",function(v){v=v.target,v.parentNode.removeChild(v)},!1):l.attachEvent&&l.attachEvent("onreadystatechange",function(v){v=window.event.srcElement,!v||v.readyState!=="loaded"&&v.readyState!=="complete"||v.parentNode.removeChild(v)}),setTimeout(function(){document.getElementsByTagName("head")[0].appendChild(l),l=null},1)},Rn.prototype.getRGBA=function(a){return a>>>=0,"rgba("+(a>>24&255)+","+(a>>16&255)+","+(a>>8&255)+","+(a&255)/256+")"},Rn.prototype.getLineCap=function(a){return["butt","square","round"][a]},Rn.prototype.getLineJoin=function(a){return["miter","bevel","round"][a]};var Qu=function(a){function u(n){Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n)),n.autoUpdate=!0,n.getOptions();var l=new O1({color:"rgba(257, 254, 47, 0.9)",minZoom:18,duration:.8,interval:.2,trailLength:.4});return n.lineLayer=l,n.children=[l],n}return Pr(u,a),Qe(u,[{key:"initialize",value:function(n){Ds(u.prototype.__proto__||fr(u.prototype),"initialize",this).call(this,n),n=this.map.map;var l=new Rn({});l.lineLayer=this.lineLayer,this.trafficTileManager=l,l.setMap(n),l.update(),n.addEventListener("moveend",function(){l.update()}),n.addEventListener("zoomend",function(){l.update()}),n.addEventListener("ondraw",function(){})}},{key:"onOptionsChanged",value:function(n){}},{key:"onDataChanged",value:function(n){}},{key:"getDefaultOptions",value:function(){return{}}}]),u}(Aa),Kl=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="HeatmapLayer",n.bufferData=[],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{size:13,unit:"px",height:0,max:100,min:0,opacity:1,minOpacity:0,maxOpacity:1,blend:"normal"}}},{key:"initialize",value:function(n){var l=this;this.gl=n;var v=this.getOptions();this.inverseMatrix=or.create(Float64Array),this.frameBuffer=new zn(n),this.webglLayer.map.onResize(function(){l.frameBuffer=new zn(n)}),this.circle=Oc(64),this.circleTexture=Ge(n,this.circle,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.intensity=new _i({gradient:v.gradient}),this.paletteTexture=Ge(n,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture,this.offlineProgram=new qr(this.gl,{vertexShader:"uniform mat4 u_matrix;uniform mat4 pointToPixelMatrix;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform int unit;uniform float size;uniform float max;uniform float min;attribute vec3 aPos;attribute vec2 aOffset;attribute float aCount;varying vec2 vOffset;varying float vCount;varying vec3 vPosition;void main(){vOffset=aOffset;vCount=(aCount-min)/(max-min);if(unit==1){vec2 pos=(pointToPixelMatrix*vec4(aPos.xy,0.0,1.0)).xy+aOffset.xy*size/2.0;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pos,0.0,1.0);}else{vec2 pos=aPos.xy+aOffset.xy*size;gl_Position=u_matrix*vec4(pos,0.0,1.0);}vPosition=vec3(gl_Position.z/gl_Position.w);}",fragmentShader:"varying vec2 vOffset;varying float vCount;varying vec3 vPosition;uniform sampler2D uCircle;void main(){vec4 circle=texture2D(uCircle,(vOffset+1.0)/2.0);float intensity=circle.a*vCount;if(intensity<=0.0){discard;}gl_FragColor=vec4(vPosition,intensity);}"},this),this.offlineBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineIndexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.offlineVertexArray=new bi({gl:n,program:this.offlineProgram,attributes:[{stride:24,name:"aPos",buffer:this.offlineBuffer,size:3,type:"FLOAT",offset:0},{stride:24,name:"aOffset",buffer:this.offlineBuffer,size:2,type:"FLOAT",offset:12},{stride:24,name:"aCount",buffer:this.offlineBuffer,size:1,type:"FLOAT",offset:20}]}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.program=new qr(this.gl,{vertexShader:"attribute vec2 aPos;varying vec2 vPos;uniform float uHeight;uniform mat4 pixelToViewMatrix;uniform mat4 projectionMatrix;uniform sampler2D u_sampler;uniform mat4 inverseMatrix;void main(){vPos=aPos;if(uHeight<=0.0){gl_Position=vec4(aPos,0.0,1.0);}else{vec4 gray=texture2D(u_sampler,(aPos+1.0)/2.0);vec4 m0=inverseMatrix*vec4(aPos.xy,0.0,1.0);vec4 m1=inverseMatrix*vec4(aPos.xy,1.0,1.0);m0/=m0.w;m1/=m1.w;vec4 pixel=m0+(-m0.z/(m1.z-m0.z))*(m1-m0);pixel.z=uHeight*gray.a;gl_Position=projectionMatrix*pixelToViewMatrix*vec4(pixel.xyz,1.0);}}",fragmentShader:"uniform sampler2D u_sampler;uniform sampler2D u_samplerPalette;uniform float uHeight;uniform float opacity;uniform float minOpacity;uniform float maxOpacity;uniform bool u_strict;varying vec2 vPos;void main(){vec4 gray=texture2D(u_sampler,(vPos+1.0)/2.0);float grayAlpha=gray.a;if(grayAlpha<=0.0){discard;}gl_FragColor=texture2D(u_samplerPalette,vec2(grayAlpha,1.0));float addAlpha=1.0;if(gray.a<0.3){addAlpha=gray.a*3.3;}gl_FragColor.a*=addAlpha;gl_FragColor.a=max(gl_FragColor.a,minOpacity);gl_FragColor.a=min(gl_FragColor.a,maxOpacity);gl_FragColor.a*=opacity;}"},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:n,program:this.program,attributes:[{stride:8,name:"aPos",buffer:this.buffer,size:2,type:"FLOAT",offset:0}]}),v=[];for(var d=[],x=Math.floor(n.canvas.width/4),y=Math.floor(n.canvas.height/4),M=x+1,D=0;D<=y;D++)for(var U=0;U<=x;U++)if(v.push(2*U/x-1,2*D/y-1),U<x&&D<y){var C=M*D+U,E=M*(D+1)+U;d.push(C,C+1,E+1),d.push(C,E+1,E)}this.bufferData=v,this.buffer.updateData(new Float32Array(v)),this.indexData=d,this.indexBuffer.updateData(new Uint32Array(d))}},{key:"onDestroy",value:function(){this.bufferData=[]}},{key:"onOptionsChanged",value:function(n,l){var v=this.gl;v&&n.gradient!==l.gradient&&(this.intensity=new _i({gradient:n.gradient}),this.paletteTexture=Ge(v,this.intensity.paletteCtx.canvas,{TEXTURE_MAG_FILTER:"LINEAR",TEXTURE_MIN_FILTER:"LINEAR",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}).texture)}},{key:"onDataChanged",value:function(n){if(this.gl){var l=[],v=[];this.getOptions();for(var d=0;d<n.length;d++){var x=n[d],y=this.normizedPoint(n[d].geometry.coordinates),M=x.count===void 0?1:x.count;"properties"in x&&"count"in x.properties&&(M=x.properties.count),l.push(y[0],y[1],y[2]),l.push(-1,-1),l.push(M),l.push(y[0],y[1],y[2]),l.push(-1,1),l.push(M),l.push(y[0],y[1],y[2]),l.push(1,1),l.push(M),l.push(y[0],y[1],y[2]),l.push(1,-1),l.push(M),x=4*d,v.push(x+0,x+2,x+1),v.push(x+0,x+3,x+2)}this.offlineBufferData=l,this.offlineIndexData=v,this.offlineBuffer.updateData(new Float32Array(l)),this.offlineIndexBuffer.updateData(new Uint32Array(v))}}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.pointToPixelMatrix,x=n.pixelToViewMatrix;if(n=n.projectionMatrix,this.offlineBufferData&&!(0>=this.offlineBufferData.length)){var y=this.getOptions();this.setGLState({blend:!0,blendFunc:[l.ONE,l.ONE],depthTest:!1}),l.bindFramebuffer(l.FRAMEBUFFER,this.frameBuffer.framebuffer),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),this.offlineProgram.use(l),this.offlineProgram.setUniforms({u_matrix:v,uCircle:this.circleTexture,pointToPixelMatrix:d,pixelToViewMatrix:x,projectionMatrix:n,unit:y.unit==="px"?1:0,size:y.size,max:y.max,min:y.min}),this.offlineVertexArray.bind(),this.offlineIndexBuffer.bind(),l.drawElements(l.TRIANGLES,this.offlineIndexData.length,l.UNSIGNED_INT,0),l.bindFramebuffer(l.FRAMEBUFFER,null),this.program.use(l),this.vertexArray.bind(),v=this.inverseMatrix,or.identity(v),or.multiply(v,n,x),or.invert(v,v),this.setGLState({blend:!0,blendFunc:so(l,y.blend),depthTest:!!y.height}),this.program.setUniforms({u_sampler:this.frameBuffer.framebuffer.texture,u_samplerPalette:this.paletteTexture,uHeight:y.height,opacity:y.opacity,minOpacity:y.minOpacity,maxOpacity:y.maxOpacity,pixelToViewMatrix:x,inverseMatrix:v,projectionMatrix:n}),this.indexBuffer.bind(),l.drawElements(l.TRIANGLES,this.indexData.length,l.UNSIGNED_INT,0)}}}]),u}(Ti),Lf=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="BarLayer",n.selectedColor=[-1,-1,-1],n.textureCache={},n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{color:"rgba(0, 180, 0, 1.0)",edgeCount:4,unit:"m",height:1e5,type:"normal",size:5e4}}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions(),v={normal:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float r=vSize/cos(b);if(aEdgeIndex<0.0){float index=aPointIndex;float angle=0.0;if(mod(index,2.0)==0.0){angle=a*(index/2.0)-b;}else{angle=-a*((index-1.0)/2.0)-b;}y=y+r*sin(angle);x=x+r*cos(angle);}else{float i=aEdgeIndex-1.0;float j=aPointIndex;float angle=a*i+b;y=y+r*sin(angle);x=x+r*cos(angle);}vPosition=vec4(aPos,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;if(aEdgeIndex==1.0&&aPointIndex==1.0){gl_PointSize=20.0;}else{gl_PointSize=10.0;}
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;if(vEdgeIndex<0.0){color.r+=0.2;color.g+=0.2;color.b+=0.2;}else{float i=ceil(vEdgeIndex);;float d=i/vEdgeCount*0.5;if(i<=vEdgeCount/2.0){d=0.2*(i/vEdgeCount*0.5)-0.1;}else{d=0.2*(vEdgeCount-i)/vEdgeCount*0.5-0.1;}color.r+=d;color.g+=d;color.b+=d;}gl_FragColor=color;}"],light:[`attribute vec3 aPos;attribute vec4 aColor;attribute float aSize;attribute float aEdgeIndex;attribute float aPointIndex;attribute float aEdgeCount;varying vec4 vColor;varying vec4 vPosition;varying vec4 vFragPosition;varying float vSize;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;uniform mat4 uMatrix;uniform float uZoomUnits;uniform vec4 uSelectedColor;void main(){vColor=aColor;vEdgeIndex=aEdgeIndex;vEdgeCount=aEdgeCount;vPointIndex=aPointIndex;float z=aPos.z*uZoomUnits;float x=aPos.x;float y=aPos.y;vSize=aSize*uZoomUnits;float a=radians(360.0/aEdgeCount);float b=a/2.0;float i=aEdgeIndex;float j=aPointIndex;float angle=a*(i-1.0)+b;float r=vSize/cos(b);y=y+r*sin(angle);x=x+r*cos(angle);if(j==1.0){z=0.0;}vPosition=vec4(aPos.xyz,1.0);vFragPosition=vec4(x,y,z,1.0);gl_Position=uMatrix*vFragPosition;
#if defined(PICK)
if(mapvIsPicked()){vColor=uSelectedColor;}
#endif
}`,"varying vec4 vColor;varying float vEdgeIndex;varying float vPointIndex;varying float vEdgeCount;varying vec4 vPosition;varying vec4 vFragPosition;uniform mat4 uMatrix;void main(){vec4 color=vColor;color.a=1.0-vFragPosition.z/vPosition.z;gl_FragColor=color;}"]};v=v[l.type]||v.normal,this.program=new qr(this.gl,{vertexShader:v[0],fragmentShader:v[1],defines:l.enablePicked?["PICK"]:[]},this),this.buffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{stride:44,name:"aPos",buffer:this.buffer,size:3,type:"FLOAT",offset:0},{stride:44,name:"aSize",buffer:this.buffer,size:1,type:"FLOAT",offset:12},{stride:44,name:"aEdgeIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:16},{stride:44,name:"aPointIndex",buffer:this.buffer,size:1,type:"FLOAT",offset:20},{stride:44,name:"aEdgeCount",buffer:this.buffer,size:1,type:"FLOAT",offset:24},{stride:44,name:"aColor",buffer:this.buffer,size:4,type:"FLOAT",offset:28}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onChanged",value:function(n,l){this.gl&&l&&(this.uniforms={},this.data=l,this.options=n,this.processData(),n.enablePicked&&this.parsePickData(l))}},{key:"processData",value:function(){var n=[],l=[];this.options.type==="light"?this.createLightBuffer(this.data,n,l):this.createNormalBuffer(this.data,n,l),this.bufferData=n,this.indexData=l,this.buffer.updateData(new Float32Array(n)),this.indexBuffer.updateData(new Uint32Array(l))}},{key:"createNormalBuffer",value:function(n,l,v){var d=this,x=parseInt(this.options.edgeCount,10)||4;n.forEach(function(y,M){var D=y.color||d.options.color,U=y.size||d.options.size,C=Array.isArray(y.value)?y.value:typeof y.value=="number"?[y.value]:[1],E=d.normizedPoint(y.geometry.coordinates),B=y.height||d.options.height,O=C.reduce(function(G,j){return Number(G)+Number(j)}),H=0,V="blue";for(C.forEach(function(G,j){V=d.normizedColor(typeof D=="function"?D(G,j,C):Array.isArray(D)?D[j]:D),G=typeof B=="function"?B(G,j,C):Array.isArray(B)?B[j]:B/O*G;var Y=v[v.length-1],$=l.length/11;for(0<$&&(x%2===1&&j===0?v.push(Y,Y,$):v.push(Y,$)),j=1;j<=2*x;j++)j%2===0?l.push.apply(l,[E[0],E[1],H,U,j/2,2,x].concat(Jr(V))):l.push.apply(l,[E[0],E[1],H+G,U,(j+1)/2,1,x].concat(Jr(V))),v.push($+j-1),j===2*x&&(l.push.apply(l,[E[0],E[1],H+G,U,j/2+1,1,x].concat(Jr(V))),l.push.apply(l,[E[0],E[1],H,U,j/2+1,2,x].concat(Jr(V))),v.push($+j,$+j+1));H+=G}),M=v[v.length-1],y=l.length/11,0<y&&v.push(M,y),M=1;M<=x;M++)l.push.apply(l,[E[0],E[1],H,U,-1,M,x].concat(Jr(V))),v.push(y+M-1)})}},{key:"createLightBuffer",value:function(n,l,v){var d=this,x=parseInt(this.options.edgeCount,10)||4;n.forEach(function(y,M){M=y.color||d.options.color,M=d.normizedColor(typeof M=="function"?M(y.value):typeof M=="string"?M:"blue");var D=y.size||d.options.size,U=d.normizedPoint(y.geometry.coordinates),C=y.height||d.options.height;for(C=typeof C=="function"?C(y.value):C,y=1;y<=x;y++){var E=v[v.length-1],B=l.length/11;for(0<B&&v.push(E,B),E=1;E<=2*x;E++)E%2===0?l.push.apply(l,[U[0],U[1],C,D,E/2,1,x].concat(Jr(M))):l.push.apply(l,[U[0],U[1],C,D,(E+1)/2,2,x].concat(Jr(M))),v.push(B+E-1),E===2*x&&v.push(B,B+1)}})}},{key:"render",value:function(n){var l=this.program,v=n.gl,d=n.matrix;this.setGLState({cullFace:this.options.type==="normal"}),l.use(v),this.vertexArray.bind(),this.indexBuffer.bind();var x=this.map.getZoomUnits();Nr(this.uniforms,this.getCommonUniforms(n),{uZoomUnits:this.options.unit==="px"?x:1,uMatrix:d}),l.setUniforms(this.uniforms),v.drawElements(v.TRIANGLE_STRIP,this.indexData.length,v.UNSIGNED_INT,0)}}]),u}(Ti),Id=function(a){function u(n){Ke(this,u);var l=Dr(this,(u.__proto__||fr(u)).call(this,n));return n=l.getOptions(),l.fillPoint=new Oo({enablePicked:n.enablePicked,autoSelect:n.autoSelect}),l.shadowPoint=new Oo,l.textPoint=new Ja,l.children=[l.shadowPoint,l.fillPoint,l.textPoint],l}return Pr(u,a),Qe(u,[{key:"pick",value:function(n,l){return this.fillPoint.pick(n,l)}},{key:"onOptionsChanged",value:function(n){this.shadowPoint.setOptions({depthTest:!1,polygonOffset:[1,1],color:n.shadowColor,size:n.shadowSize,borderWidth:n.shadowBorderWidth,borderColor:n.shadowBorderColor}),this.fillPoint.setOptions({onClick:function(l){n.onClick&&n.onClick(l)},selectedIndex:n.selectedIndex,selectedColor:n.selectedColor,depthTest:!1,color:n.fillColor,size:n.fillSize,borderWidth:n.fillBorderWidth,borderColor:n.fillBorderColor}),this.textPoint.setOptions({collides:!1,polygonOffset:[-1,-1],color:n.fontColor,fontFamily:n.fontFamily,fontSize:n.fontSize})}},{key:"onDataChanged",value:function(n){var l=this,v=this.getOptions(),d=JSON.parse(Dl(n)).map(function(y){return y.properties.size=l.getProperty("shadowSize",v.shadowSize,y),y.properties.color=l.getProperty("shadowColor",v.shadowColor,y),y.properties.borderColor=l.getProperty("shadowBorderColor",v.shadowBorderColor,y),y.properties.borderWidth=l.getProperty("shadowBorderWidth",v.shadowBorderWidth,y),y}),x=JSON.parse(Dl(n)).map(function(y){return y.properties.size=l.getProperty("fillSize",v.fillSize,y),y.properties.color=l.getProperty("fillColor",v.fillColor,y),y.properties.borderColor=l.getProperty("fillBorderColor",v.fillBorderColor,y),y.properties.borderWidth=l.getProperty("fillBorderWidth",v.fillBorderWidth,y),y});this.shadowPoint.setData(d),this.fillPoint.setData(x),this.textPoint.setData(n)}},{key:"getProperty",value:function(n,l,v){return Object.prototype.toString.call(l)==="[object Function]"?l(v):(l=v[n]||l,"properties"in v&&n in v.properties&&(l=v.properties[n]),l)}},{key:"getDefaultOptions",value:function(){return{enablePicked:!1,selectedIndex:-1,selectedColor:"#ffff00",autoSelect:!0,fillColor:"rgba(255, 50, 10, 1)",fillSize:20,fillBorderColor:"#ffffff",fillBorderWidth:1.2,shadowColor:"rgba(255, 80, 110, 0.7)",shadowSize:40,shadowBorderColor:"rgba(255, 80, 110, 1)",shadowBorderWidth:1.2,fontSize:12,fontFamily:"Microsoft Yahei",fontColor:"#ffffff"}}}]),u}(Aa),Ed=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="MaskLayer",n.bufferData=[],n.indices=[],n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{blend:"deeper",color:"rgba(100, 100, 100, 0.6)",height:0,polygonOffset:[0,0],depthTest:!1,depthWrite:!1}}},{key:"initialize",value:function(n){this.gl=n,this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"});var l=[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}];l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"onChanged",value:function(n,l){var v=this;if(this.gl){n=[];for(var d=[],x=0;x<l.length;x++)if(l[x].geometry.coordinates){var y=[[this.normizedPoint([-180,-90]),this.normizedPoint([180,-90]),this.normizedPoint([180,90]),this.normizedPoint([-180,90])]],M=[];if(l[x].geometry.type==="LineString"&&(M=[l[x].geometry.coordinates.map(function(C){return v.normizedPoint(C)})]),l[x].geometry.type==="MultiPolygon")for(var D=l[x].geometry.coordinates,U=0;U<D.length;U++)M=M.concat(D[U].map(function(C){return C.map(function(E){return v.normizedPoint(E)})}));else for(D=0;D<l[x].geometry.coordinates.length;D++)M.push(l[x].geometry.coordinates[D].map(function(C){return v.normizedPoint(C)}));for(M=We.flatten(y.concat(M)),y=M.vertices,M=M.holes,D=[],U=0;U<y.length;U+=3)D.push(y[U+0],y[U+1]);this.parseBufferData(n,d,D,M)}this.bufferData=n,this.index=d,this.vertexBuffer.updateData(new Float32Array(n)),this.indexBuffer.updateData(new Uint32Array(d))}}},{key:"parseBufferData",value:function(n,l,v,d){var x=n.length/2;for(d=d&&d.length?We(v,d,2):We(v),n.push.apply(n,Jr(v)),n=0;n<d.length;n++)l.push(d[n]+x)}},{key:"render",value:function(n){if(this.index&&this.index.length){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),n=Nr(this.getCommonUniforms(n),{u_matrix:v,u_height:d.height,u_color:this.normizedColor(d.color)}),x.setUniforms(n),this.setGLState({blend:!0,blendFunc:so(l,d.blend),polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite}),this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)}}}]),u}(Ti),Ql=function(a){function u(){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).apply(this,arguments))}return Pr(u,a),Qe(u,[{key:"toBBox",value:function(n){var l=yi(n.item.geometry.coordinates,2);return n=l[0],l=l[1],{minX:n,minY:l,maxX:n,maxY:l}}},{key:"compareMinX",value:function(n,l){return n.item.geometry.coordinates[0]-l.item.geometry.coordinates[0]}},{key:"compareMinY",value:function(n,l){return n.item.geometry.coordinates[1]-l.item.geometry.coordinates[1]}}]),u}(Os),NA=function(a){function u(n,l){return Ke(this,u),n=Dr(this,(u.__proto__||fr(u)).call(this,n,l)),n.name="PointCanvasCustomLayer",l=n.canvas=document.createElement("canvas"),n.ctx=l.getContext("2d"),n.geoRBush=new Ql,n}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{depthWrite:!1,depthTest:!0,color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,flat:!1,collides:!0,unit:"px",angle:0,offset:[0,0],padding:[2,2],margin:[0,0],polygonOffset:[0,0],itemDimension:[20,20],renderItem:this.defaultOptionRenderItem}}},{key:"defaultOptionRenderItem",value:function(n,l,v){v.fillStyle="red",v.fillRect(l.x,l.y,l.w,l.h)}},{key:"initialize",value:function(n){this.gl=n;var l=this.getOptions();this.texture=null,this.lastUpdateTime=0,this.program=new qr(this.gl,{vertexShader:"precision highp float;uniform mat4 matrix;uniform bool uFlat;uniform bool uUnitPx;uniform float zoomUnits;uniform float devicePixelRatio;uniform float zIndex;uniform vec2 offset;attribute vec3 position;attribute float corner;attribute float scale;attribute float rotation;attribute vec2 size;attribute vec2 aTextCoord;varying vec2 vTextCoord;/***\u70B9A(x,y)\uFF0C\u7ED5\u539F\u70B9\u987A\u65F6\u9488\u65CB\u8F6C\u89D2\u5EA6a\u65B0\u5750\u6807\u7684\u8BA1\u7B97\u516C\u5F0F*x1=x*cos(a)+y*sin(a)*y1=y*cos(a)-x*sin(a)*/vec3 transformCoord(vec3 coord,vec2 size,float corner){float x=coord.x;float y=coord.y;if(corner==1.0){x+=-size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)+size.x*sin(rotation);}else if(corner==2.0){x+=size.x*cos(rotation)+size.y*sin(rotation);y+=size.y*cos(rotation)-size.x*sin(rotation);}else if(corner==3.0){x+=size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)-size.x*sin(rotation);}else{x+=-size.x*cos(rotation)-size.y*sin(rotation);y+=-size.y*cos(rotation)+size.x*sin(rotation);}return vec3(x,y,coord.z);}void main(){vTextCoord=aTextCoord;if(uFlat){vec2 pixelOffset=offset;vec2 halfSize=size/2.0*scale;if(uUnitPx){halfSize*=zoomUnits;pixelOffset*=zoomUnits;}vec3 current=transformCoord(position,halfSize,corner);current.z+=zIndex;gl_Position=matrix*vec4(current.x+pixelOffset[0],current.y-pixelOffset[1],current.z,1.0);}else{vec2 pixelOffset=offset*zoomUnits;vec4 projection=matrix*vec4(position.x+pixelOffset[0],position.y-pixelOffset[1],position.z,1.0);vec3 screen=projection.xyz/projection.w;vec2 halfSize=size/MAPV_resolution*devicePixelRatio*scale;vec3 current=transformCoord(screen,halfSize,corner);current.z+=zIndex;gl_Position=vec4(current,1.0);}}",fragmentShader:`precision highp float;uniform sampler2D textureImage;uniform vec4 uSelectedColor;varying vec2 vTextCoord;void main(){gl_FragColor=texture2D(textureImage,vec2(vTextCoord.x,1.0-vTextCoord.y));
#if defined(PICK)
if(mapvIsPicked()){gl_FragColor=vec4(uSelectedColor.rgb,gl_FragColor.a);}
#endif
}`,defines:l.enablePicked?["PICK"]:[]},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.uvBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),l=[{name:"position",buffer:this.vertexBuffer,size:3,stride:32,type:"FLOAT",offset:0},{name:"corner",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:12},{name:"size",buffer:this.vertexBuffer,size:2,stride:32,type:"FLOAT",offset:16},{name:"scale",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:24},{name:"rotation",buffer:this.vertexBuffer,size:1,stride:32,type:"FLOAT",offset:28},{name:"aTextCoord",buffer:this.uvBuffer,size:2,stride:8,type:"FLOAT",offset:0}],l=l.concat(this.getCommonAttributes()),this.vertexArray=new bi({gl:n,program:this.program,attributes:l})}},{key:"onDestroy",value:function(){}},{key:"onChanged",value:function(n,l){this.gl&&this.processCache(n,l)}},{key:"processCache",value:function(n,l){for(this.cachedData=[],this.geoRBush.clear(),n=0;n<l.length;n++){var v=l[n],d=this.normizedPoint(v.geometry.coordinates);d&&this.cachedData.push({point:d,item:v,extra:{},index:n})}this.geoRBush.load(this.cachedData)}},{key:"render",value:function(n){if(this.cachedData&&this.cachedData.length&&this.map){var l=n.gl,v=n.matrix,d=this.getOptions(),x=this.program;x.use(l),this.throttleUpdate(n),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],polygonOffset:d.polygonOffset,depthTest:d.depthTest,depthMask:d.depthWrite});var y=this.map.getZoomUnits();x.setUniforms(Nr(this.getCommonUniforms(n),{matrix:v,devicePixelRatio:window.devicePixelRatio,textureImage:this.texture,uFlat:d.flat,offset:d.offset,zoomUnits:y,zIndex:d.zIndex,uUnitPx:d.unit==="px"})),0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0))}}},{key:"throttleUpdate",value:function(n){this.updateText(n)}},{key:"updateText",value:function(n){var l=n.gl,v=n.matrix,d=this.getOptions(),x=d.padding,y=d.margin,M=d.collides;n=d.enablePicked;var D=d.itemDimension,U=d.beforeRenderAll,C=d.beforeComputeDimension;d=d.renderItem;var E=this.map.getBounds(),B=l.canvas.width/window.devicePixelRatio,O=l.canvas.height/window.devicePixelRatio,H=this.canvas;l=this.ctx,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),C&&C(l),E=this.geoRBush.search({minX:E.sw.lng,minY:E.sw.lat,maxX:E.ne.lng,maxY:E.ne.lat});var V=new Os;C=[];for(var G=0;G<E.length;G++){var j=E[G],Y=j.point,$=j.item,it=j.extra;j=j.index;var nt=yi(Y,3);nt=Ni.clone([nt[0],nt[1],nt[2],1]),Ni.transformMat4(nt,nt,v),Ni.scale(nt,nt,1/nt[3]);var pt=(nt[0]+1)/2*B,Rt=(-nt[1]+1)/2*O,Et=Array.isArray(D)?D:D($,l,it);nt=Et[0]+2*x[0],Et=Et[1]+2*x[1];var Jt=nt+y[0],oe=Et+y[1];if(pt-=Jt/2,Rt-=oe/2,Jt=pt+Jt,oe=Rt+oe,!(0>Jt||0>oe||pt>B||Rt>O)){if(M){if(oe={minX:pt,maxX:Jt,minY:Rt,maxY:oe},V.collides(oe))continue;V.insert(oe)}C.push({w:nt,h:Et,point:Y,item:$,extra:it,dataIndex:j})}}for(l.restore(),x=xu(C),v=x.w,x=x.h,0>=v&&(v=1),0>=x&&(x=1),H.width=v*window.devicePixelRatio,H.height=x*window.devicePixelRatio,l.save(),l.scale(window.devicePixelRatio,window.devicePixelRatio),U&&U(l),U=[],H=[],y=[],M=[],D=0,B=C.length;D<B;++D){for(O=C[D],d(O.item,O,l,O.extra),G=yi(O.point,3),E=G[0],V=G[1],G=G[2],Y=0;4>Y;Y++)U.push(E,V,G),U.push(Y),U.push(O.w,O.h),U.push(1,0);E=O.x/v,V=(O.x+O.w)/v,G=(O.y+O.h)/x,Y=O.y/x,H.push(E,G,E,Y,V,Y,V,G),E=4*D,y.push(E,E+2,E+1,E,E+3,E+2),n&&(O=this.indexToRgb(O.dataIndex),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255),M.push(O[0]/255,O[1]/255,O[2]/255))}l.restore(),this.loadTexture(),this.index=y,this.vertexBuffer.updateData(new Float32Array(U)),this.uvBuffer.updateData(new Float32Array(H)),this.indexBuffer.updateData(new Uint32Array(y)),n&&this.pickBuffer.updateData(new Float32Array(M))}},{key:"loadTexture",value:function(){var n=this;this.canvas?sn(this.gl,this.canvas,function(l){n.texture=l},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}):this.texture=null}}]),u}(Ti),$a=function(){function a(u,n){Ke(this,a),this.name="Mask",this.webglLayer=u,this.options=n||{},this.bufferData=[],this.indices=[]}return Qe(a,[{key:"initialize",value:function(u){return this.gl=u,this.program=new qr(this.gl,{vertexShader:"precision highp float;attribute vec2 a_position;uniform mat4 u_matrix;uniform float u_height;void main(){vec4 position=u_matrix*vec4(a_position.xy,u_height,1.0);gl_Position=position;}",fragmentShader:"precision highp float;uniform vec4 u_color;void main(){gl_FragColor=u_color;}",defines:[]},this),this.vertexBuffer=new $e({gl:u,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:u,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:u,program:this.program,attributes:[{stride:8,name:"a_position",buffer:this.vertexBuffer,size:2,type:"FLOAT",offset:0}]}),this}},{key:"onDestroy",value:function(){this.bufferData=[],this.index=[]}},{key:"setData",value:function(u){var n=this;if(this.gl){for(var l=[],v=[],d=0;d<u.length;d++)if(u[d].geometry.coordinates){var x=[];if(u[d].geometry.type==="LineString"&&(x=[u[d].geometry.coordinates.map(function(U){return n.normizedPoint(U)})]),u[d].geometry.type==="MultiPolygon")for(var y=u[d].geometry.coordinates,M=0;M<y.length;M++)x=x.concat(y[M].map(function(U){return U.map(function(C){return n.normizedPoint(C)})}));else for(y=0;y<u[d].geometry.coordinates.length;y++)x.push(u[d].geometry.coordinates[y].map(function(U){return n.normizedPoint(U)}));y=We.flatten(x),x=y.vertices,y=y.holes,M=[];for(var D=0;D<x.length;D+=3)M.push(x[D+0],x[D+1]);this.parseBufferData(l,v,M,y)}return this.bufferData=l,this.index=v,this.vertexBuffer.updateData(new Float32Array(l)),this.indexBuffer.updateData(new Uint32Array(v)),this}}},{key:"parseBufferData",value:function(u,n,l,v){var d=u.length/2;for(v=v&&v.length?We(l,v,2):We(l),u.push.apply(u,Jr(l)),u=0;u<v.length;u++)n.push(v[u]+d)}},{key:"render",value:function(u){if(this.index&&this.index.length){var n=u.gl,l=u.matrix,v=this.options;u=this.program,u.use(n),l={u_matrix:l,u_height:v.height||0,u_color:this.normizedColor(v.color)},u.setUniforms(l),this.indexBuffer.bind(),this.vertexArray.bind(),n.drawElements(n.TRIANGLES,this.index.length,n.UNSIGNED_INT,0)}}},{key:"normizedColor",value:function(u){var n=u;return u instanceof Array||(n=Ot(u).unitArray()),n[3]===void 0&&(n[3]=1),n}},{key:"normizedPoint",value:function(u){var n=this.getPointOffset();if(!u||!u[0]||!u[1])return[n[0],n[1],0];var l=Number(u[0]),v=Number(u[1]);-180<=l&&180>=l&&-90<=v&&90>=v&&(v=this.webglLayer.map.lnglatToMercator(l,v),l=v[0],v=v[1]);var d=Number(u[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(l=this.convertLngLat([l,v]),d=window.Cesium.Cartesian3.fromDegrees(l[0],l[1],d),l=d.x,v=d.y,d=d.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(l=this.convertLngLat([l,v]),d=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:l[0],lat:l[1]}),l=d.x,v=d.y,d=d.z),3<u.length?[l-n[0],v-n[1],d].concat(Jr(u.slice(3))):[l-n[0],v-n[1],d]}},{key:"convertLngLat",value:function(u){return[u[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(u[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var u=[0,0],n=this.options;return this.webglLayer&&this.webglLayer.options.pointOffset?u=this.webglLayer.options.pointOffset:n.pointOffset&&(u=n.pointOffset),u}}]),a}(),km=function(a){function u(n,l){return Ke(this,u),Dr(this,(u.__proto__||fr(u)).call(this,n,l))}return Pr(u,a),Qe(u,[{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(n){var l=this.getOptions();if(l.source&&l.source.image&&l.domain&&(typeof l.source.image=="string"||l.source.width&&l.source.height)){var v=l.refColors,d=l.refImage;if((v||d)&&(!v||v.colors&&v.positions)&&(!d||typeof d.url=="string")){this.gl=n;var x=[];v?this.imageData=xh(v.colors,v.positions,v.clamp,v.color,v.height):(this.imageData={data:d.url},x.push("USE_IMAGE_TEXTURE"),this.imageTexture=!0),l.isTerrain&&(this.isTerrain=l.isTerrain,x.push("USE_TERRAIN"),this.gridRowMax=1600,l.gridRowMax&&(this.gridRowMax=l.gridRowMax),this.gridColMax=1600,l.gridColMax&&(this.gridColMax=l.gridColMax)),this.texture=null,v=`
        float generateValue(vec4 rgba){
            return rgba.r;
        }`,l.fomularC&&(v=l.fomularC),l=`precision highp float;attribute vec3 a_pos;attribute vec2 a_texture_coord;uniform mat4 u_proj_matrix;uniform mat4 u_mv_matrix;uniform sampler2D uTile;uniform float u_baseLine;uniform float u_elevationScale;varying vec2 v_texture_coord;void main(){v_texture_coord=a_texture_coord;vec3 pos=a_pos.xyz;
#if defined(USE_TERRAIN)
vec4 terrainColor=texture2D(uTile,vec2(a_texture_coord.s,a_texture_coord.t));float value=generateValue(terrainColor);float h=(value-u_baseLine)*u_elevationScale;pos.z=max(0.,h);
#endif
vec4 position=u_proj_matrix*u_mv_matrix*vec4(pos,1.0);gl_Position=position;}`.replace("void main()",v+`
void main()`),v=`precision highp float;varying vec2 v_texture_coord;uniform sampler2D uTile;uniform sampler2D uColorRamp;uniform bool uUseFilter;uniform vec4 uFilterColor;uniform float u_opacity;uniform float u_noData;uniform vec3 u_noTextureData;uniform vec2 u_clamp;uniform vec2 u_domain;uniform vec3 u_linearOpacity;uniform bool u_isOneBand;uniform float u_brightness;uniform float u_contrast;uniform float u_exposure;uniform float u_saturation;vec4 indexToRgba(float value){float index=value;float b=floor(index/65536.);index-=b*65536.;float g=floor(index/256.);index-=g*256.;float r=index;return vec4(r,g,b,255.);}vec3 adjustBrightness(vec3 color,float value){return color+value;}vec3 adjustContrast(vec3 color,float value){return 0.5+(1.0+value)*(color-0.5);}vec3 adjustExposure(vec3 color,float value){return color*(1.0+value);}vec3 adjustSaturation(vec3 color,float value){const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);vec3 grayscale=vec3(dot(color,luminosityFactor));return mix(grayscale,color,1.0+value);}void main(){vec4 data=texture2D(uTile,vec2(v_texture_coord.s,v_texture_coord.t));float value=generateValue(data);vec4 textureColor=vec4(0,0,0,0);if(value>=u_clamp.s&&value<=u_clamp.t){float normalisedValue=(value-u_domain.s)/(u_domain.t-u_domain.s);
#if defined(USE_IMAGE_TEXTURE)
vec4 color=texture2D(uColorRamp,vec2(v_texture_coord.s,v_texture_coord.t));if(vec3(color.rgb)==u_noTextureData){color=vec4(0,0,0,0);}
#else
vec4 color=texture2D(uColorRamp,vec2(normalisedValue,0));
#endif
color.a=smoothstep(u_linearOpacity.s,u_linearOpacity.t,color.a*normalisedValue)+u_linearOpacity.p;textureColor=color;textureColor.a=textureColor.a*u_opacity;vec3 mixColor=adjustBrightness(textureColor.rgb,u_brightness);mixColor=adjustContrast(mixColor,u_contrast);mixColor=adjustExposure(mixColor,u_exposure);mixColor=adjustSaturation(mixColor,u_saturation);textureColor=vec4(mixColor,textureColor.a);if(uIsPickRender&&u_isOneBand){textureColor=indexToRgba(value)/255.;}if(uIsPickRender&&!u_isOneBand){textureColor=data;}}if(value==u_noData){textureColor=vec4(0,0,0,0);}if(uUseFilter){textureColor=textureColor*uFilterColor;}gl_FragColor=textureColor;}`.replace("void main()",v+`
void main()`),this.program=new qr(this.gl,{vertexShader:l,fragmentShader:v,defines:x},this),this.vertexBuffer=new $e({gl:n,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.indexBuffer=new $e({gl:n,target:"ELEMENT_ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexArray=new bi({gl:n,program:this.program,attributes:[{name:"a_pos",buffer:this.vertexBuffer,stride:20,size:3,type:"FLOAT",offset:0},{name:"a_texture_coord",buffer:this.vertexBuffer,size:2,stride:20,type:"FLOAT",offset:12}]})}}}},{key:"onChanged",value:function(n,l){var v=this;this.gl&&(this.loadDataTexture&&clearTimeout(this.loadDataTexture),this.loadDataTexture=setTimeout(function(){v.loadTexture(function(){v.parseData(l),v.webglLayer.render()})},0))}},{key:"drawMask",value:function(n){var l=n.gl,v=n.matrix,d=n.projectionMatrix,x=n.viewMatrix;if(n=n.polygons){var y=new $a(this.webglLayer,{color:"rgba(19, 14, 7, 0.8)"});this.setGLState({stencilTest:!0,depthTest:!1,depthMask:!1}),l.clear(l.STENCIL_BUFFER_BIT),l.stencilFunc(l.ALWAYS,1,255),l.stencilOp(l.KEEP,l.KEEP,l.REPLACE),l.colorMask(!1,!1,!1,!1),y.initialize(l).setData(n).render({gl:l,matrix:v,projectionMatrix:d,viewMatrix:x})}}},{key:"onOptionsChanged",value:function(n,l){this.gl&&(this.initialize(this.gl),this.loadTexture(),this.webglLayer.render())}},{key:"render",value:function(n){var l=n.gl,v=n.matrix,d=n.projectionMatrix,x=n.viewMatrix,y=n.isPickRender;n=this.getOptions();var M=this.program;(M||this.texture)&&(n.stencilData&&this.drawMask({gl:l,matrix:v,projectionMatrix:d,viewMatrix:x,polygons:n.stencilData}),this.setGLState({blend:!0,blendEquation:l.FUNC_ADD,blendFunc:[l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA],stencilTest:!!n.stencilData,depthTest:n.depthTest,depthMask:n.depthMask}),M.use(l),n.stencilData&&(l.stencilFunc(l.EQUAL,1,1),l.stencilOp(l.KEEP,l.KEEP,l.KEEP),l.colorMask(!0,!0,!0,!0)),this.colorRamp&&this.texture&&(v=[0,0,0],n.linearOpacity&&this.formaLinear(n.linearOpacity,v),d={uColorRamp:this.colorRamp,uTile:this.texture,u_proj_matrix:d,uUseFilter:!!n.filterColor,uFilterColor:this.normizedColor(n.filterColor||"rgba(0, 0, 100, 1.0)"),u_mv_matrix:x,uIsPickRender:!!y,u_noData:n.noData||-99999,u_domain:n.domain,u_clamp:n.clamp?n.clamp:n.domain,u_linearOpacity:v,u_opacity:n.opacity||1,u_isOneBand:!!this.isOneBand,u_brightness:n.brightness||0,u_contrast:n.contrast||0,u_exposure:n.exposure||0,u_saturation:n.saturation||0},this.isTerrain&&(d.u_baseLine=n.baseLine||0,d.u_elevationScale=n.elevationScale||1),this.imageTexture&&(d.u_noTextureData=n.baseLine||0),M.setUniforms(d),this.index&&0<this.index.length&&(this.indexBuffer.bind(),this.vertexArray.bind(),l.drawElements(l.TRIANGLES,this.index.length,l.UNSIGNED_INT,0)),n.stencilData&&!n.stencilAfter&&(l.clear(l.STENCIL_BUFFER_BIT),l.stencilMask(255),l.stencilFunc(l.ALWAYS,1,255))))}},{key:"onDestroy",value:function(){this.texturePixels=this.texture=this.colorRamp=this.indexBuffer=this.vertexBuffer=this.index=this.program=null}},{key:"pickAfter",value:function(n,l){var v,d;return this.isOneBand?(l=v=d=l,n=1):(l=n[0],v=n[1],d=n[2],n=n[3]),this.getOptions().fomularJS?this.getOptions().fomularJS({r:l,g:v,b:d,a:n}):l}},{key:"formaLinear",value:function(n,l){n.start&&(l[0]=n.start||0),n.end&&(l[1]=n.end||0),n.base&&(l[2]=n.base||0)}},{key:"loadTexture",value:function(n){var l=this,v=this.getOptions();v.source.image&&this.imageData?sn(this.gl,this.imageData.data,function(d,x){l.colorRamp=d,Qr(v.source.image)==="object"?(l.isOneBand=!0,sn(l.gl,v.source.image,function(y,M,D){l.texture=y,l.texturePixels=D,l.textureWidth=D.width,l.textureHeight=D.height,n&&n(),l.webglLayer.render()},{TEXTURE_MIN_FILTER:"NEAREST",TEXTURE_MAG_FILTER:"NEAREST",TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:v.source.width,height:v.source.height,format:"LUMINANCE",type:"FLOAT"})):(l.isOneBand=!1,sn(l.gl,v.source.image,function(y,M,D){l.texture=y,l.texturePixels=D,l.textureWidth=D.width,l.textureHeight=D.height,n&&n(),l.webglLayer.render()},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"}))},{TEXTURE_WRAP_S:"CLAMP_TO_EDGE",TEXTURE_WRAP_T:"CLAMP_TO_EDGE"},{width:this.imageData.width,height:this.imageData.height,flipY:!0,format:"RGBA",type:"UNSIGNED_BYTE"}):(this.texture=null,n&&n())}},{key:"parseData",value:function(n){var l=this;if(this.vertexBuffer){var v=[],d=[];if(n&&n[0]){var x=n[0].geometry.coordinates[0];x=x.map(function(V){return l.normizedPoint(V)}),n=x[0][0];var y=x[0][1],M=x[2][0],D=x[2][1];this.bound=[n,y,M,D],this.gridRowMax>this.textureHeight&&(this.gridRowMax=this.textureHeight),this.gridColMax>this.textureWidth&&(this.gridColMax=this.textureWidth),x=this.isTerrain?this.gridColMax:1;var U=this.isTerrain?this.gridRowMax:1,C=x+1;M=(M-n)/x,D=(D-y)/U;for(var E=0;E<=U;E++)for(var B=0;B<=x;B++)if(v.push(n+M*B,y+D*E,0),v.push(B/x,E/U),B<x&&E<U){var O=C*E+B,H=C*(E+1)+B;d.push(O,H+1,O+1),d.push(O,H,H+1)}}this.index=d,this.vertexBuffer.updateData(new Float32Array(v)),this.indexBuffer.updateData(new Uint32Array(d))}}},{key:"getValue",value:function(n,l){return this.isTerrain&&n&&this.bound&&(n=this.normizedPoint(n),this.containsPoint(n,this.bound)&&(n=this.uvPoint(n,this.bound),l=this.pixelByUV(n,l,this.getOptions().fomularJS),l.result))?l:0}},{key:"containsPoint",value:function(n,l){if(n)return n[0]>=l[0]&&n[0]<=l[2]&&n[1]>=l[1]&&n[1]<=l[3]}},{key:"uvPoint",value:function(n,l){if(n)return[(n[0]-l[0])/(l[2]-l[0]),(l[3]-n[1])/(l[3]-l[1])]}},{key:"pixelByUV",value:function(n,l,v){if(this.texturePixels){var d=this.texturePixels,x=d.width,y=d.height,M=d.data,D=Math.floor(n[0]*(x-1));n=Math.floor(n[1]*(y-1));var U=1;return d.type==="RGBA"&&(U=4),this._getPixelBound(D,n,l,x,y,M,U,v)}return null}},{key:"_getPixelBound",value:function(n,l,v,d,x,y,M,D){var U=n-v;0>U&&(U=0),n+=v,n>d-1&&(n=d-1);var C=l-v;0>C&&(C=0),l+=v,l>x-1&&(l=x-1),v=x=0;for(var E=[0,0,0,1],B=U;B<=n;B++)for(var O=C;O<=l;O++){var H=(O*d+B)*M,V=y[H],G=y[H+this.min(0,M-3)],j=y[H+this.min(0,M-2)];H=M===4?y[H+3]:1;var Y=D?D({r:V,g:G,b:j,a:H}):V;Y>x&&(x=Y,E=[V,G,j,H]),v+=Y}return{result:v/((n-U+1)*(l-C+1)),pixel:E,max:x}}},{key:"min",value:function(n,l){return l<n?n:l}}]),u}(Ti);window._hmt_private||(window._hmt=window._hmt||[],function(){var a=document.createElement("script");a.src="https://hm.baidu.com/hm.js?e8002ef3d9e0d8274b5b74cc4a027d08";var u=document.getElementsByTagName("script")[0];u.parentNode.insertBefore(a,u)}()),Pt.version="1.0.0-beta.181",Pt.View=wm,Pt.CanvasLayer=ee,Pt.CircleLayer=function a(){var u=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};return Ke(this,a),ud.includes(u.type)?new mf(u):new ad(u)},Pt.GridLayer=v1,Pt.HeatGridLayer=Gu,Pt.ShapeLayer=xi,Pt.SimpleLineLayer=cd,Pt.LineLayer3D=dd,Pt.LineLayer=qa,Pt.LineRainbowLayer=w1,Pt.WallSpriteLayer=md,Pt.LinePointLayer=Zl,Pt.WallLayer=AA,Pt.WallTripLayer=Pi,Pt.HeatLineLayer=P1,Pt.HoneycombLayer=wA,Pt.WebglLayer=Vl,Pt.PointLayer=Oo,Pt.GroundRippleLayer=MA,Pt.RippleLayer=CA,Pt.SparkLayer=TA,Pt.ClusterLayer=SA,Pt.IconClusterLayer=IA,Pt.HeatPointLayer=Zu,Pt.ShapeLineLayer=EA,Pt.PointTripLayer=LA,Pt.LineTripLayer=Jh,Pt.IconCollidesLayer=RA,Pt.LineFlowLayer=O1,Pt.TileLayer=hn,Pt.IconLayer=Gr,Pt.BoardLayer=po,Pt.PolygonLayer=If,Pt.CarLineLayer=Qh,Pt.Layer=Ti,Pt.TextLayer=Ja,Pt.BoardTextLayer=$h,Pt.LabelLayer=Ku,Pt.TrafficLayer=Qu,Pt.GltfLayer=Sd,Pt.HeatmapLayer=Kl,Pt.BarLayer=Lf,Pt.MarkerListLayer=Id,Pt.MaskLayer=Ed,Pt.PointCanvasCustomLayer=NA,Pt.PixelLayer=km,Pt.FXAA=Am,Pt.SMAA=_m,Pt.BlurEffect=o1,Pt.BloomEffect=nd,Pt.BrightEffect=od,Pt.DepthEffect=s1,Pt.EffectManager=a1,Pt.getContext=_s,Pt.createTexture=Ge,Pt.loadTextureImage=sn,Pt.getBlend=so,Pt.FrameBufferObject=zn,Pt.Program=qr,Pt.StateManager=xm,Pt.Buffer=$e,Pt.VertexArray=bi,Pt.CommonLayer=Ps,Pt.MercatorProjection=Yr,Pt.Canvas=fn,Pt.Intensity=_i,Pt.BezierCurve=Ci,Pt.GeodesicCurve=Re,Pt.OdCurve=U0,Pt.utilCity={getProvinceNameByCityName:function(a){for(var u=0;u<ka.length;u++)for(var n=ka[u].n,l=ka[u].cities,v=0;v<l.length;v++)if(l[v].n==a)return n;return null},getCenterByCityName:function(a){a=a.replace("\u5E02","");for(var u=0;u<bp.length;u++)if(bp[u].n==a)return ze(bp[u].g);for(u=0;u<Vp.length;u++)if(Vp[u].n==a)return ze(Vp[u].g);for(u=0;u<ka.length;u++){if(ka[u].n==a)return ze(ka[u].g);for(var n=ka[u].cities,l=0;l<n.length;l++)if(n[l].n==a)return ze(n[l].g)}return null}},Pt.isMobile=Kg,Pt.isIOSMobile=Qg,Pt.Encryptor={encode:function(a){a=gm.deflateRaw(a);for(var u=[],n=0;n<a.length;n++)u.push(a[n]^23);return new Uint8Array(u)},decode:function(a){a=new Uint8Array(a);for(var u=[],n=0;n<a.length;n++)u.push(a[n]^23);a=new Uint8Array(u);try{var l=window.flate.deflate_decode_raw(a);return new TextDecoder("utf-8").decode(l)}catch(v){return console.warn("inflate by pako!"),gm.inflateRaw(a,{to:"string"})}},download:function(a,u){var n=new Blob([a],{type:"application/octet-binary"});a=document.createElement("a"),n=window.URL.createObjectURL(n),a.href=n,a.download=u||"mapvgl_download",a.click()}},Pt.createFusionView=function(a,u){var n=void 0,l=!1;a.addEventListener("glmoduleloaded",function(v){l||(l=!0,setTimeout(function(){n=new wm({cameraNear:10,cameraFar:4e3,gl:a._webglPainter.gl,canvas:a._webglPainter.gl.canvas,autoUpdate:!1,map:a}),n.webglLayer.canvas.style.zIndex=1;var d=n.webglLayer.stateManager;a.insertRender=function(){d.setState({blend:!0,depthTest:!1}),n.render()},u&&u(n)},3e3))}),setTimeout(function(){if(!l&&a._webglMapScene&&a._webglPainter&&a._webglPainter.gl&&a._webglPainter.gl.canvas){l=!0,n=new wm({cameraNear:10,cameraFar:4e3,gl:a._webglPainter.gl,canvas:a._webglPainter.gl.canvas,autoUpdate:!1,map:a}),n.webglLayer.canvas.style.zIndex=1;var v=n.webglLayer.stateManager;a.insertRender=function(){v.setState({blend:!0,depthTest:!1}),n.render()},u&&u(n)}},4e3)},Pt.toRadian=jt,Pt.toAngle=ot,Pt.ceilPowerOfTwo=Ie,Pt.floorPowerOfTwo=Mr,Pt.approximatelyEqual=Lr,Pt.isClosed=Ee,Pt.generateColorRamp=xh,Pt.__moduleExports=Mo,Pt.vec4=Ni,Pt.vec3=Or,Pt.vec2=ii,Pt.quat2=oA,Pt.quat=gf,Pt.mat4=or,Pt.mat3=r1,Pt.mat2d=i1,Pt.mat2=vm,Pt.glMatrix=ym,Object.defineProperty(Pt,"__esModule",{value:!0})})},27599:function(er,Yt,Dt){function ie(Pt,ee,zt){for(var It=ee.length,ue=new Uint8Array(3*It/4-(ee[It-2]=="="?2:ee[It-1]=="="?1:0)),se=new Uint8Array(130),vt=0;64>vt;vt++)se["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charCodeAt(vt)]=vt;for(var Ot=vt=0;vt<It;vt+=4){var Lt=se[ee.charCodeAt(vt+1)],_t=se[ee.charCodeAt(vt+2)];ue[Ot++]=se[ee.charCodeAt(vt)]<<2|Lt>>4,ue[Ot++]=(Lt&15)<<4|_t>>2,ue[Ot++]=(_t&3)<<6|se[ee.charCodeAt(vt+3)]&63}return zt&&!Pt?WebAssembly.instantiate(ue,zt):zt||Pt?(Pt=new WebAssembly.Module(ue),zt?new WebAssembly.Instance(Pt,zt):Pt):WebAssembly.compile(ue)}(function(Pt,ee){ee(Yt)})(this,function(Pt){function ee(){throw Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function zt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function It(t,r){return r={exports:{}},t(r,r.exports),r.exports}function ue(t){var r,i;this.promise=new t(function(s,f){if(r!==void 0||i!==void 0)throw TypeError("Bad Promise constructor");r=s,i=f}),this.resolve=zl(r),this.reject=zl(i)}function se(){}function vt(t,r){this.x=t||0,this.y=r||0}function Ot(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function Lt(t,r,i,s,f,c,g,p,A,S){Object.defineProperty(this,"id",{value:PA++}),this.uuid=Tr.generateUUID(),this.name="",this.image=t!==void 0?t:Lt.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=r!==void 0?r:Lt.DEFAULT_MAPPING,this.wrapS=i!==void 0?i:1001,this.wrapT=s!==void 0?s:1001,this.magFilter=f!==void 0?f:1006,this.minFilter=c!==void 0?c:1008,this.anisotropy=A!==void 0?A:1,this.format=g!==void 0?g:1023,this.internalFormat=null,this.type=p!==void 0?p:1009,this.offset=new vt(0,0),this.repeat=new vt(1,1),this.center=new vt(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ot,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=S!==void 0?S:3e3,this.version=0,this.onUpdate=null}function _t(t,r,i,s){this.x=t||0,this.y=r||0,this.z=i||0,this.w=s!==void 0?s:1}function Ft(t,r,i){this.width=t,this.height=r,this.scissor=new _t(0,0,t,r),this.scissorTest=!1,this.viewport=new _t(0,0,t,r),i=i||{},this.texture=new Lt(void 0,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.image={},this.texture.image.width=t,this.texture.image.height=r,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:1006,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!0,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null}function $t(t,r,i){Ft.call(this,t,r,i),this.samples=4}function jt(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._w=s!==void 0?s:1}function ot(t,r,i){this.x=t||0,this.y=r||0,this.z=i||0}function Ie(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Mr(t,r,i,s){this._x=t||0,this._y=r||0,this._z=i||0,this._order=s||Mr.DefaultOrder}function Lr(){this.mask=1}function Ee(){Object.defineProperty(this,"id",{value:B1++}),this.uuid=Tr.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Ee.DefaultUp.clone();var t=new ot,r=new Mr,i=new jt,s=new ot(1,1,1);r._onChange(function(){i.setFromEuler(r,!1)}),i._onChange(function(){r.setFromQuaternion(i,void 0,!1)}),Gr(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new Ie},normalMatrix:{value:new Ot}}),this.matrix=new Ie,this.matrixWorld=new Ie,this.matrixAutoUpdate=Ee.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Lr,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function Yr(){Ee.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function li(t,r){this.min=t!==void 0?t:new ot(1/0,1/0,1/0),this.max=r!==void 0?r:new ot(-1/0,-1/0,-1/0)}function hi(t,r,i,s,f){var c,g=0;for(c=t.length-3;g<=c;g+=3){Ql.fromArray(t,g);var p=f.x*Math.abs(Ql.x)+f.y*Math.abs(Ql.y)+f.z*Math.abs(Ql.z),A=r.dot(Ql),S=i.dot(Ql),N=s.dot(Ql);if(Math.max(-Math.max(A,S,N),Math.min(A,S,N))>p)return!1}return!0}function Bi(t,r){this.center=t!==void 0?t:new ot,this.radius=r!==void 0?r:-1}function fn(t,r){this.origin=t!==void 0?t:new ot,this.direction=r!==void 0?r:new ot(0,0,-1)}function _i(t,r){this.normal=t!==void 0?t:new ot(1,0,0),this.constant=r!==void 0?r:0}function Ci(t,r,i){this.a=t!==void 0?t:new ot,this.b=r!==void 0?r:new ot,this.c=i!==void 0?i:new ot}function Vt(t,r,i){return r===void 0&&i===void 0?this.set(t):this.setRGB(t,r,i)}function Re(t,r,i){return 0>i&&(i+=1),1<i&&--i,i<1/6?t+6*(r-t)*i:.5>i?r:i<2/3?t+6*(r-t)*(2/3-i):t}function _e(t){return .04045>t?.0773993808*t:Math.pow(.9478672986*t+.0521327014,2.4)}function ze(t){return .0031308>t?12.92*t:1.055*Math.pow(t,.41666)-.055}function nr(t,r,i,s,f,c){this.a=t,this.b=r,this.c=i,this.normal=s&&s.isVector3?s:new ot,this.vertexNormals=Array.isArray(s)?s:[],this.color=f&&f.isColor?f:new Vt,this.vertexColors=Array.isArray(f)?f:[],this.materialIndex=c!==void 0?c:0}function de(){Object.defineProperty(this,"id",{value:it++}),this.uuid=Tr.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function Rr(t){de.call(this),this.type="MeshBasicMaterial",this.color=new Vt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(t)}function He(t,r,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=r,this.count=t!==void 0?t.length/r:0,this.normalized=i===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function Di(t,r,i){He.call(this,new Int8Array(t),r,i)}function Cr(t,r,i){He.call(this,new Uint8Array(t),r,i)}function Oi(t,r,i){He.call(this,new Uint8ClampedArray(t),r,i)}function As(t,r,i){He.call(this,new Int16Array(t),r,i)}function Vi(t,r,i){He.call(this,new Uint16Array(t),r,i)}function Ln(t,r,i){He.call(this,new Int32Array(t),r,i)}function _s(t,r,i){He.call(this,new Uint32Array(t),r,i)}function Ge(t,r,i){He.call(this,new Float32Array(t),r,i)}function sn(t,r,i){He.call(this,new Float64Array(t),r,i)}function so(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function xh(t){if(t.length===0)return-1/0;for(var r=t[0],i=1,s=t.length;i<s;++i)t[i]>r&&(r=t[i]);return r}function We(){Object.defineProperty(this,"id",{value:pt+=2}),this.uuid=Tr.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function Wi(t,r){Ee.call(this),this.type="Mesh",this.geometry=t!==void 0?t:new We,this.material=r!==void 0?r:new Rr,this.updateMorphTargets()}function So(t,r,i,s,f,c,g,p){return(r.side===1?s.intersectTriangle(g,c,f,!0,p):s.intersectTriangle(f,c,g,r.side!==2,p))===null?null:(z1.copy(p),z1.applyMatrix4(t.matrixWorld),r=i.ray.origin.distanceTo(z1),r<i.near||r>i.far?null:{distance:r,point:z1.clone(),object:t})}function ws(t,r,i,s,f,c,g,p,A,S,N,w){if(Ue.fromBufferAttribute(f,S),Sr.fromBufferAttribute(f,N),Ir.fromBufferAttribute(f,w),f=t.morphTargetInfluences,r.morphTargets&&c&&f){qi.set(0,0,0),tc.set(0,0,0),wn.set(0,0,0);for(var I=0,L=c.length;I<L;I++){var P=f[I],F=c[I];P!==0&&(je.fromBufferAttribute(F,S),ts.fromBufferAttribute(F,N),Ji.fromBufferAttribute(F,w),g?(qi.addScaledVector(je,P),tc.addScaledVector(ts,P),wn.addScaledVector(Ji,P)):(qi.addScaledVector(je.sub(Ue),P),tc.addScaledVector(ts.sub(Sr),P),wn.addScaledVector(Ji.sub(Ir),P)))}Ue.add(qi),Sr.add(tc),Ir.add(wn)}return t.isSkinnedMesh&&(t.boneTransform(S,Ue),t.boneTransform(N,Sr),t.boneTransform(w,Ir)),(t=So(t,r,i,s,Ue,Sr,Ir,Gm))&&(p&&($u.fromBufferAttribute(p,S),ec.fromBufferAttribute(p,N),Ma.fromBufferAttribute(p,w),t.uv=Ci.getUV(Gm,Ue,Sr,Ir,$u,ec,Ma,new vt)),A&&($u.fromBufferAttribute(A,S),ec.fromBufferAttribute(A,N),Ma.fromBufferAttribute(A,w),t.uv2=Ci.getUV(Gm,Ue,Sr,Ir,$u,ec,Ma,new vt)),p=new nr(S,N,w),Ci.getNormal(Ue,Sr,Ir,p.normal),t.face=p),t}function Fr(){Object.defineProperty(this,"id",{value:nC+=2}),this.uuid=Tr.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function Pa(t){var r={},i;for(i in t){r[i]={};for(var s in t[i]){var f=t[i][s];f&&(f.isColor||f.isMatrix3||f.isMatrix4||f.isVector2||f.isVector3||f.isVector4||f.isTexture)?r[i][s]=f.clone():Array.isArray(f)?r[i][s]=f.slice():r[i][s]=f}}return r}function Bn(t){for(var r={},i=0;i<t.length;i++){var s=Pa(t[i]),f;for(f in s)r[f]=s[f]}return r}function ki(t){de.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Da(){Ee.call(this),this.type="Camera",this.matrixWorldInverse=new Ie,this.projectionMatrix=new Ie,this.projectionMatrixInverse=new Ie}function un(t,r,i,s){Da.call(this),this.type="PerspectiveCamera",this.fov=t!==void 0?t:50,this.zoom=1,this.near=i!==void 0?i:.1,this.far=s!==void 0?s:2e3,this.focus=10,this.aspect=r!==void 0?r:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Qi(t,r,i){if(Ee.call(this),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=i;var s=new un(90,1,t,r);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new ot(1,0,0)),this.add(s);var f=new un(90,1,t,r);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new ot(-1,0,0)),this.add(f);var c=new un(90,1,t,r);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new ot(0,1,0)),this.add(c);var g=new un(90,1,t,r);g.layers=this.layers,g.up.set(0,0,-1),g.lookAt(new ot(0,-1,0)),this.add(g);var p=new un(90,1,t,r);p.layers=this.layers,p.up.set(0,-1,0),p.lookAt(new ot(0,0,1)),this.add(p);var A=new un(90,1,t,r);A.layers=this.layers,A.up.set(0,-1,0),A.lookAt(new ot(0,0,-1)),this.add(A),this.update=function(S,N){this.parent===null&&this.updateMatrixWorld();var w=S.xr.enabled,I=S.getRenderTarget();S.xr.enabled=!1;var L=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,S.setRenderTarget(i,0),S.render(N,s),S.setRenderTarget(i,1),S.render(N,f),S.setRenderTarget(i,2),S.render(N,c),S.setRenderTarget(i,3),S.render(N,g),S.setRenderTarget(i,4),S.render(N,p),i.texture.generateMipmaps=L,S.setRenderTarget(i,5),S.render(N,A),S.setRenderTarget(I),S.xr.enabled=w},this.clear=function(S,N,w,I){for(var L=S.getRenderTarget(),P=0;6>P;P++)S.setRenderTarget(i,P),S.clear(N,w,I);S.setRenderTarget(L)}}}function vu(t,r,i){Jh(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=i),Ft.call(this,t,t,r)}function dl(t,r,i,s,f,c,g,p,A,S,N,w){Lt.call(this,null,c,g,p,A,S,s,f,N,w),this.image={data:t||null,width:r||1,height:i||1},this.magFilter=A!==void 0?A:1003,this.minFilter=S!==void 0?S:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function yu(t,r,i,s,f,c){this.planes=[t!==void 0?t:new _i,r!==void 0?r:new _i,i!==void 0?i:new _i,s!==void 0?s:new _i,f!==void 0?f:new _i,c!==void 0?c:new _i]}function Ic(){function t(f,c){i!==!1&&(s(f,c),r.requestAnimationFrame(t))}var r=null,i=!1,s=null;return{start:function(){i!==!0&&s!==null&&(r.requestAnimationFrame(t),i=!0)},stop:function(){i=!1},setAnimationLoop:function(f){s=f},setContext:function(f){r=f}}}function Ec(t,r){function i(c,g){var p=c.array,A=c.usage,S=t.createBuffer();return t.bindBuffer(g,S),t.bufferData(g,p,A),c.onUploadCallback(),g=5126,p instanceof Float32Array?g=5126:p instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):p instanceof Uint16Array?g=5123:p instanceof Int16Array?g=5122:p instanceof Uint32Array?g=5125:p instanceof Int32Array?g=5124:p instanceof Int8Array?g=5120:p instanceof Uint8Array&&(g=5121),{buffer:S,type:g,bytesPerElement:p.BYTES_PER_ELEMENT,version:c.version}}var s=r.isWebGL2,f=new Zi;return{get:function(c){return c.isInterleavedBufferAttribute&&(c=c.data),f.get(c)},remove:function(c){c.isInterleavedBufferAttribute&&(c=c.data);var g=f.get(c);g&&(t.deleteBuffer(g.buffer),f.delete(c))},update:function(c,g){c.isInterleavedBufferAttribute&&(c=c.data);var p=f.get(c);if(p===void 0)f.set(c,i(c,g));else if(p.version<c.version){var A=c.array,S=c.updateRange;t.bindBuffer(g,p.buffer),S.count===-1?t.bufferSubData(g,0,A):(s?t.bufferSubData(g,S.offset*A.BYTES_PER_ELEMENT,A,S.offset,S.count):t.bufferSubData(g,S.offset*A.BYTES_PER_ELEMENT,A.subarray(S.offset,S.offset+S.count)),S.count=-1),p.version=c.version}}}}function Lc(t,r,i,s){Fr.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},this.fromBufferGeometry(new Oa(t,r,i,s)),this.mergeVertices()}function Oa(t,r,i,s){We.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:r,widthSegments:i,heightSegments:s},t=t||1,r=r||1;var f=t/2,c=r/2;i=Math.floor(i)||1,s=Math.floor(s)||1;var g=i+1,p=s+1,A=t/i,S=r/s,N=[],w=[],I=[],L=[];for(t=0;t<p;t++){var P=t*S-c;for(r=0;r<g;r++)w.push(r*A-f,-P,0),I.push(0,0,1),L.push(r/i),L.push(1-t/s)}for(t=0;t<s;t++)for(r=0;r<i;r++)f=r+g*(t+1),c=r+1+g*(t+1),p=r+1+g*t,N.push(r+g*t,f,p),N.push(f,c,p);this.setIndex(N),this.setAttribute("position",new Ge(w,3)),this.setAttribute("normal",new Ge(I,3)),this.setAttribute("uv",new Ge(L,2))}function Rc(t,r,i,s){function f(I,L){r.buffers.color.setClear(I.r,I.g,I.b,L,s)}var c=new Vt(0),g=0,p,A,S=null,N=0,w=null;return{getClearColor:function(){return c},setClearColor:function(I,L){c.set(I),g=L!==void 0?L:1,f(c,g)},getClearAlpha:function(){return g},setClearAlpha:function(I){g=I,f(c,g)},render:function(I,L,P,F){L=L.background,P=t.xr,(P=P.getSession&&P.getSession())&&P.environmentBlendMode==="additive"&&(L=null),L===null?f(c,g):L&&L.isColor&&(f(L,1),F=!0),(t.autoClear||F)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),L&&(L.isCubeTexture||L.isWebGLCubeRenderTarget||L.mapping===306)?(A===void 0&&(A=new Wi(new H1(1,1,1),new ki({type:"BackgroundCubeMaterial",uniforms:Pa($l.cube.uniforms),vertexShader:$l.cube.vertexShader,fragmentShader:$l.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),A.geometry.deleteAttribute("normal"),A.geometry.deleteAttribute("uv"),A.onBeforeRender=function(W,X,Z){this.matrixWorld.copyPosition(Z.matrixWorld)},Object.defineProperty(A.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(A)),F=L.isWebGLCubeRenderTarget?L.texture:L,A.material.uniforms.envMap.value=F,A.material.uniforms.flipEnvMap.value=F.isCubeTexture?-1:1,(S!==L||N!==F.version||w!==t.toneMapping)&&(A.material.needsUpdate=!0,S=L,N=F.version,w=t.toneMapping),I.unshift(A,A.geometry,A.material,0,0,null)):L&&L.isTexture&&(p===void 0&&(p=new Wi(new Oa(2,2),new ki({type:"BackgroundMaterial",uniforms:Pa($l.background.uniforms),vertexShader:$l.background.vertexShader,fragmentShader:$l.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),p.geometry.deleteAttribute("normal"),Object.defineProperty(p.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(p)),p.material.uniforms.t2D.value=L,L.matrixAutoUpdate===!0&&L.updateMatrix(),p.material.uniforms.uvTransform.value.copy(L.matrix),(S!==L||N!==L.version||w!==t.toneMapping)&&(p.material.needsUpdate=!0,S=L,N=L.version,w=t.toneMapping),I.unshift(p,p.geometry,p.material,0,0,null))}}}function Fg(t,r,i,s){var f=s.isWebGL2,c;this.setMode=function(g){c=g},this.render=function(g,p){t.drawArrays(c,g,p),i.update(p,c)},this.renderInstances=function(g,p,A,S){if(S!==0){if(f){g=t;var N="drawArraysInstanced"}else if(g=r.get("ANGLE_instanced_arrays"),N="drawArraysInstancedANGLE",g===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}g[N](c,p,A,S),i.update(A,c,S)}}}function Bg(t,r,i){function s(tt){if(tt==="highp"){if(0<t.getShaderPrecisionFormat(35633,36338).precision&&0<t.getShaderPrecisionFormat(35632,36338).precision)return"highp";tt="mediump"}return tt==="mediump"&&0<t.getShaderPrecisionFormat(35633,36337).precision&&0<t.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var f,c=typeof WebGL2RenderingContext!="undefined"&&t instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&t instanceof WebGL2ComputeRenderingContext,g=i.precision!==void 0?i.precision:"highp",p=s(g);p!==g&&(console.warn("THREE.WebGLRenderer:",g,"not supported, using",p,"instead."),g=p),i=i.logarithmicDepthBuffer===!0,p=t.getParameter(34930);var A=t.getParameter(35660),S=t.getParameter(3379),N=t.getParameter(34076),w=t.getParameter(34921),I=t.getParameter(36347),L=t.getParameter(36348),P=t.getParameter(36349),F=0<A,W=c||!!r.get("OES_texture_float"),X=F&&W,Z=c?t.getParameter(36183):0;return{isWebGL2:c,getMaxAnisotropy:function(){if(f!==void 0)return f;var tt=r.get("EXT_texture_filter_anisotropic");return f=tt!==null?t.getParameter(tt.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:s,precision:g,logarithmicDepthBuffer:i,maxTextures:p,maxVertexTextures:A,maxTextureSize:S,maxCubemapSize:N,maxAttributes:w,maxVertexUniforms:I,maxVaryings:L,maxFragmentUniforms:P,vertexTextures:F,floatFragmentTextures:W,floatVertexTextures:X,maxSamples:Z}}function qv(){function t(){S.value!==s&&(S.value=s,S.needsUpdate=0<f),i.numPlanes=f,i.numIntersection=0}function r(N,w,I,L){var P=N!==null?N.length:0,F=null;if(P!==0){if(F=S.value,L!==!0||F===null)for(L=I+4*P,w=w.matrixWorldInverse,A.getNormalMatrix(w),(F===null||F.length<L)&&(F=new Float32Array(L)),L=0;L!==P;++L,I+=4)p.copy(N[L]).applyMatrix4(w,A),p.normal.toArray(F,I),F[I+3]=p.constant;S.value=F,S.needsUpdate=!0}return i.numPlanes=P,i.numIntersection=0,F}var i=this,s=null,f=0,c=!1,g=!1,p=new _i,A=new Ot,S={value:null,needsUpdate:!1};this.uniform=S,this.numIntersection=this.numPlanes=0,this.init=function(N,w,I){var L=N.length!==0||w||f!==0||c;return c=w,s=r(N,I,0),f=N.length,L},this.beginShadows=function(){g=!0,r(null)},this.endShadows=function(){g=!1,t()},this.setState=function(N,w,I,L,P,F){if(!c||N===null||N.length===0||g&&!I)g?r(null):t();else{I=g?0:f;var W=4*I,X=P.clippingState||null;for(S.value=X,X=r(N,L,W,F),N=0;N!==W;++N)X[N]=s[N];P.clippingState=X,this.numIntersection=w?this.numPlanes:0,this.numPlanes+=I}}}function gl(t){var r={};return{get:function(i){if(r[i]!==void 0)return r[i];switch(i){case"WEBGL_depth_texture":var s=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":s=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":s=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":s=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:s=t.getExtension(i)}return s===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),r[i]=s}}}function Kv(t,r,i){function s(p){var A=p.target;p=c.get(A),p.index!==null&&r.remove(p.index);for(var S in p.attributes)r.remove(p.attributes[S]);A.removeEventListener("dispose",s),c.delete(A),(S=g.get(p))&&(r.remove(S),g.delete(p)),i.memory.geometries--}function f(p){var A=[],S=p.index,N=p.attributes.position;if(S!==null){var w=S.array;S=S.version,N=0;for(var I=w.length;N<I;N+=3){var L=w[N+0],P=w[N+1],F=w[N+2];A.push(L,P,P,F,F,L)}}else for(w=N.array,S=N.version,N=0,I=w.length/3-1;N<I;N+=3)L=N+0,P=N+1,F=N+2,A.push(L,P,P,F,F,L);A=new(65535<xh(A)?_s:Vi)(A,1),A.version=S,r.update(A,34963),(w=g.get(p))&&r.remove(w),g.set(p,A)}var c=new Zi,g=new Zi;return{get:function(p,A){var S=c.get(A);return S||(A.addEventListener("dispose",s),A.isBufferGeometry?S=A:A.isGeometry&&(A._bufferGeometry===void 0&&(A._bufferGeometry=new We().setFromObject(p)),S=A._bufferGeometry),c.set(A,S),i.memory.geometries++,S)},update:function(p){var A=p.index,S=p.attributes;A!==null&&r.update(A,34963);for(var N in S)r.update(S[N],34962);p=p.morphAttributes;for(N in p){A=p[N],S=0;for(var w=A.length;S<w;S++)r.update(A[S],34962)}},getWireframeAttribute:function(p){var A=g.get(p);if(A){var S=p.index;S!==null&&A.version<S.version&&f(p)}else f(p);return g.get(p)}}}function xu(t,r,i,s){var f=s.isWebGL2,c,g,p;this.setMode=function(A){c=A},this.setIndex=function(A){g=A.type,p=A.bytesPerElement},this.render=function(A,S){t.drawElements(c,S,g,A*p),i.update(S,c)},this.renderInstances=function(A,S,N,w){if(w!==0){if(f){A=t;var I="drawElementsInstanced"}else if(A=r.get("ANGLE_instanced_arrays"),I="drawElementsInstancedANGLE",A===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}A[I](c,N,g,S*p,w),i.update(N,c,w)}}}function Qv(t){var r={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:r,programs:null,autoReset:!0,reset:function(){r.frame++,r.calls=0,r.triangles=0,r.points=0,r.lines=0},update:function(i,s,f){switch(f=f||1,r.calls++,s){case 4:r.triangles+=i/3*f;break;case 1:r.lines+=i/2*f;break;case 3:r.lines+=f*(i-1);break;case 2:r.lines+=f*i;break;case 0:r.points+=f*i;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",s)}}}}function Dx(t,r){return Math.abs(r[1])-Math.abs(t[1])}function $v(t){var r={},i=new Float32Array(8);return{update:function(s,f,c,g){var p=s.morphTargetInfluences,A=p===void 0?0:p.length;if(s=r[f.id],s===void 0){s=[];for(var S=0;S<A;S++)s[S]=[S,0];r[f.id]=s}var N=c.morphTargets&&f.morphAttributes.position;for(c=c.morphNormals&&f.morphAttributes.normal,S=0;S<A;S++){var w=s[S];w[1]!==0&&(N&&f.deleteAttribute("morphTarget"+S),c&&f.deleteAttribute("morphNormal"+S))}for(S=0;S<A;S++)w=s[S],w[0]=S,w[1]=p[S];for(s.sort(Dx),S=p=0;8>S;S++){if((w=s[S])&&(A=w[0],w=w[1])){N&&f.setAttribute("morphTarget"+S,N[A]),c&&f.setAttribute("morphNormal"+S,c[A]),i[S]=w,p+=w;continue}i[S]=0}f=f.morphTargetsRelative?1:1-p,g.getUniforms().setValue(t,"morphTargetBaseInfluence",f),g.getUniforms().setValue(t,"morphTargetInfluences",i)}}}function pp(t,r,i,s){var f=new Zi;return{update:function(c){var g=s.render.frame,p=c.geometry,A=r.get(c,p);return f.get(A)!==g&&(p.isGeometry&&A.updateFromObject(c),r.update(A),f.set(A,g)),c.isInstancedMesh&&i.update(c.instanceMatrix,34962),A},dispose:function(){f=new Zi}}}function Fa(t,r,i,s,f,c,g,p,A,S){t=t!==void 0?t:[],Lt.call(this,t,r!==void 0?r:301,i,s,f,c,g!==void 0?g:1022,p,A,S),this.flipY=!1}function os(t,r,i,s){Lt.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function Be(t,r,i,s){Lt.call(this,null),this.image={data:t||null,width:r||1,height:i||1,depth:s||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function ml(t,r,i){var s=t[0];if(0>=s||0<s)return t;var f=r*i,c=I_[f];if(c===void 0&&(c=new Float32Array(f),I_[f]=c),r!==0)for(s.toArray(c,0),s=1,f=0;s!==r;++s)f+=i,t[s].toArray(c,f);return c}function ss(t,r){if(t.length!==r.length)return!1;for(var i=0,s=t.length;i<s;i++)if(t[i]!==r[i])return!1;return!0}function Io(t,r){for(var i=0,s=r.length;i<s;i++)t[i]=r[i]}function dp(t,r){var i=E_[r];i===void 0&&(i=new Int32Array(r),E_[r]=i);for(var s=0;s!==r;++s)i[s]=t.allocateTextureUnit();return i}function Ox(t,r){var i=this.cache;i[0]!==r&&(t.uniform1f(this.addr,r),i[0]=r)}function Ng(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y)&&(t.uniform2f(this.addr,r.x,r.y),i[0]=r.x,i[1]=r.y):ss(i,r)||(t.uniform2fv(this.addr,r),Io(i,r))}function sa(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z)&&(t.uniform3f(this.addr,r.x,r.y,r.z),i[0]=r.x,i[1]=r.y,i[2]=r.z):r.r!==void 0?(i[0]!==r.r||i[1]!==r.g||i[2]!==r.b)&&(t.uniform3f(this.addr,r.r,r.g,r.b),i[0]=r.r,i[1]=r.g,i[2]=r.b):ss(i,r)||(t.uniform3fv(this.addr,r),Io(i,r))}function t0(t,r){var i=this.cache;r.x!==void 0?(i[0]!==r.x||i[1]!==r.y||i[2]!==r.z||i[3]!==r.w)&&(t.uniform4f(this.addr,r.x,r.y,r.z,r.w),i[0]=r.x,i[1]=r.y,i[2]=r.z,i[3]=r.w):ss(i,r)||(t.uniform4fv(this.addr,r),Io(i,r))}function Fx(t,r){var i=this.cache,s=r.elements;s===void 0?ss(i,r)||(t.uniformMatrix2fv(this.addr,!1,r),Io(i,r)):ss(i,s)||(P_.set(s),t.uniformMatrix2fv(this.addr,!1,P_),Io(i,s))}function vl(t,r){var i=this.cache,s=r.elements;s===void 0?ss(i,r)||(t.uniformMatrix3fv(this.addr,!1,r),Io(i,r)):ss(i,s)||(R_.set(s),t.uniformMatrix3fv(this.addr,!1,R_),Io(i,s))}function e0(t,r){var i=this.cache,s=r.elements;s===void 0?ss(i,r)||(t.uniformMatrix4fv(this.addr,!1,r),Io(i,r)):ss(i,s)||(L_.set(s),t.uniformMatrix4fv(this.addr,!1,L_),Io(i,s))}function r0(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTexture2D(r||T_,f)}function i0(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture2DArray(r||sC,f)}function qn(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.setTexture3D(r||aC,f)}function Uo(t,r,i){var s=this.cache,f=i.allocateTextureUnit();s[0]!==f&&(t.uniform1i(this.addr,f),s[0]=f),i.safeSetTextureCube(r||S_,f)}function gp(t,r){var i=this.cache;i[0]!==r&&(t.uniform1i(this.addr,r),i[0]=r)}function mp(t,r){var i=this.cache;ss(i,r)||(t.uniform2iv(this.addr,r),Io(i,r))}function n0(t,r){var i=this.cache;ss(i,r)||(t.uniform3iv(this.addr,r),Io(i,r))}function o0(t,r){var i=this.cache;ss(i,r)||(t.uniform4iv(this.addr,r),Io(i,r))}function s0(t,r){var i=this.cache;i[0]!==r&&(t.uniform1ui(this.addr,r),i[0]=r)}function vp(t){switch(t){case 5126:return Ox;case 35664:return Ng;case 35665:return sa;case 35666:return t0;case 35674:return Fx;case 35675:return vl;case 35676:return e0;case 5124:case 35670:return gp;case 35667:case 35671:return mp;case 35668:case 35672:return n0;case 35669:case 35673:return o0;case 5125:return s0;case 35678:case 36198:case 36298:case 36306:case 35682:return r0;case 35679:case 36299:case 36307:return qn;case 35680:case 36300:case 36308:case 36293:return Uo;case 36289:case 36303:case 36311:case 36292:return i0}}function a0(t,r){t.uniform1fv(this.addr,r)}function u0(t,r){t.uniform1iv(this.addr,r)}function Pc(t,r){t.uniform2iv(this.addr,r)}function l0(t,r){t.uniform3iv(this.addr,r)}function Ms(t,r){t.uniform4iv(this.addr,r)}function h0(t,r){r=ml(r,this.size,2),t.uniform2fv(this.addr,r)}function yp(t,r){r=ml(r,this.size,3),t.uniform3fv(this.addr,r)}function aa(t,r){r=ml(r,this.size,4),t.uniform4fv(this.addr,r)}function c0(t,r){r=ml(r,this.size,4),t.uniformMatrix2fv(this.addr,!1,r)}function f0(t,r){r=ml(r,this.size,9),t.uniformMatrix3fv(this.addr,!1,r)}function p0(t,r){r=ml(r,this.size,16),t.uniformMatrix4fv(this.addr,!1,r)}function xp(t,r,i){var s=r.length,f=dp(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTexture2D(r[t]||T_,f[t])}function d0(t,r,i){var s=r.length,f=dp(i,s);for(t.uniform1iv(this.addr,f),t=0;t!==s;++t)i.safeSetTextureCube(r[t]||S_,f[t])}function Bx(t){switch(t){case 5126:return a0;case 35664:return h0;case 35665:return yp;case 35666:return aa;case 35674:return c0;case 35675:return f0;case 35676:return p0;case 5124:case 35670:return u0;case 35667:case 35671:return Pc;case 35668:case 35672:return l0;case 35669:case 35673:return Ms;case 35678:case 36198:case 36298:case 36306:case 35682:return xp;case 35680:case 36300:case 36308:case 36293:return d0}}function Nx(t,r,i){this.id=t,this.addr=i,this.cache=[],this.setValue=vp(r.type)}function g0(t,r,i){this.id=t,this.addr=i,this.cache=[],this.size=r.size,this.setValue=Bx(r.type)}function m0(t){this.id=t,this.seq=[],this.map={}}function ks(t,r){this.seq=[],this.map={};for(var i=t.getProgramParameter(r,35718),s=0;s<i;++s){var f=t.getActiveUniform(r,s),c=t.getUniformLocation(r,f.name),g=this,p=f.name,A=p.length;for(UA.lastIndex=0;;){var S=UA.exec(p),N=UA.lastIndex,w=S[1],I=S[3];if(S[2]==="]"&&(w|=0),I===void 0||I==="["&&N+2===A){p=g,f=I===void 0?new Nx(w,f,c):new g0(w,f,c),p.seq.push(f),p.map[f.id]=f;break}else I=g.map[w],I===void 0&&(I=new m0(w),w=g,g=I,w.seq.push(g),w.map[g.id]=g),g=I}}}function v0(t,r,i){return r=t.createShader(r),t.shaderSource(r,i),t.compileShader(r),r}function y0(t){switch(t){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+t)}}function x0(t,r,i){var s=t.getShaderParameter(r,35713),f=t.getShaderInfoLog(r).trim();if(s&&f==="")return"";for(t=t.getShaderSource(r).split(`
`),r=0;r<t.length;r++)t[r]=r+1+": "+t[r];return t=t.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+i+`
`+f+t}function Dc(t,r){return r=y0(r),"vec4 "+t+"( vec4 value ) { return "+r[0]+"ToLinear"+r[1]+"; }"}function zx(t,r){return r=y0(r),"vec4 "+t+"( vec4 value ) { return LinearTo"+r[0]+r[1]+"; }"}function Ux(t,r){switch(r){case 1:r="Linear";break;case 2:r="Reinhard";break;case 3:r="Uncharted2";break;case 4:r="OptimizedCineon";break;case 5:r="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+r)}return"vec3 "+t+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}function Rn(t){var r=[],i;for(i in t){var s=t[i];s!==!1&&r.push("#define "+i+" "+s)}return r.join(`
`)}function Oc(t){return t!==""}function Ap(t,r){return t.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function zg(t,r){return t.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}function Ug(t,r){if(t=Ii[r],t===void 0)throw Error("Can not resolve #include <"+r+">");return t.replace(HA,Ug)}function Ke(t,r,i,s){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ua(t,r,i,s)}function ua(t,r,i,s){for(t="",r=parseInt(r);r<parseInt(i);r++)t+=s.replace(/\[ i \]/g,"[ "+r+" ]").replace(/UNROLLED_LOOP_INDEX/g,r);return t}function A0(t){var r="precision "+t.precision+` float;
precision `+t.precision+" int;";return t.precision==="highp"?r+=`
#define HIGH_PRECISION`:t.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:t.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function $i(t){var r="SHADOWMAP_TYPE_BASIC";return t.shadowMapType===1?r="SHADOWMAP_TYPE_PCF":t.shadowMapType===2?r="SHADOWMAP_TYPE_PCF_SOFT":t.shadowMapType===3&&(r="SHADOWMAP_TYPE_VSM"),r}function Hx(t){var r="ENVMAP_TYPE_CUBE";if(t.envMap)switch(t.envMapMode){case 301:case 302:r="ENVMAP_TYPE_CUBE";break;case 306:case 307:r="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:r="ENVMAP_TYPE_EQUIREC";break;case 305:r="ENVMAP_TYPE_SPHERE"}return r}function yl(t){var r="ENVMAP_MODE_REFLECTION";if(t.envMap)switch(t.envMapMode){case 302:case 304:r="ENVMAP_MODE_REFRACTION"}return r}function Hg(t){var r="ENVMAP_BLENDING_NONE";if(t.envMap)switch(t.combine){case 0:r="ENVMAP_BLENDING_MULTIPLY";break;case 1:r="ENVMAP_BLENDING_MIX";break;case 2:r="ENVMAP_BLENDING_ADD"}return r}function la(t,r,i){var s=t.getContext(),f=i.defines,c=i.vertexShader,g=i.fragmentShader,p=$i(i),A=Hx(i),S=yl(i),N=Hg(i),w=0<t.gammaFactor?t.gammaFactor:1,I=i.isWebGL2?"":[i.extensionDerivatives||i.envMapCubeUV||i.bumpMap||i.tangentSpaceNormalMap||i.clearcoatNormalMap||i.flatShading||i.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(i.extensionFragDepth||i.logarithmicDepthBuffer)&&i.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",i.extensionDrawBuffers&&i.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Oc).join(`
`),L=Rn(f),P=s.createProgram();i.isRawShaderMaterial?(f=[L].filter(Oc).join(`
`),0<f.length&&(f+=`
`),p=[I,L].filter(Oc).join(`
`),0<p.length&&(p+=`
`)):(f=[A0(i),"#define SHADER_NAME "+i.shaderName,L,i.instancing?"#define USE_INSTANCING":"",i.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+w,"#define MAX_BONES "+i.maxBones,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+S:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.displacementMap&&i.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.flatShading?"#define FLAT_SHADED":"",i.skinning?"#define USE_SKINNING":"",i.useVertexTexture?"#define BONE_TEXTURE":"",i.morphTargets?"#define USE_MORPHTARGETS":"",i.morphNormals&&i.flatShading===!1?"#define USE_MORPHNORMALS":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.sizeAttenuation?"#define USE_SIZEATTENUATION":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(Oc).join(`
`),p=[I,A0(i),"#define SHADER_NAME "+i.shaderName,L,i.alphaTest?"#define ALPHATEST "+i.alphaTest+(i.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+w,i.useFog&&i.fog?"#define USE_FOG":"",i.useFog&&i.fogExp2?"#define FOG_EXP2":"",i.map?"#define USE_MAP":"",i.matcap?"#define USE_MATCAP":"",i.envMap?"#define USE_ENVMAP":"",i.envMap?"#define "+A:"",i.envMap?"#define "+S:"",i.envMap?"#define "+N:"",i.lightMap?"#define USE_LIGHTMAP":"",i.aoMap?"#define USE_AOMAP":"",i.emissiveMap?"#define USE_EMISSIVEMAP":"",i.bumpMap?"#define USE_BUMPMAP":"",i.normalMap?"#define USE_NORMALMAP":"",i.normalMap&&i.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",i.normalMap&&i.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",i.clearcoatMap?"#define USE_CLEARCOATMAP":"",i.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",i.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",i.specularMap?"#define USE_SPECULARMAP":"",i.roughnessMap?"#define USE_ROUGHNESSMAP":"",i.metalnessMap?"#define USE_METALNESSMAP":"",i.alphaMap?"#define USE_ALPHAMAP":"",i.sheen?"#define USE_SHEEN":"",i.vertexTangents?"#define USE_TANGENT":"",i.vertexColors?"#define USE_COLOR":"",i.vertexUvs?"#define USE_UV":"",i.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",i.gradientMap?"#define USE_GRADIENTMAP":"",i.flatShading?"#define FLAT_SHADED":"",i.doubleSided?"#define DOUBLE_SIDED":"",i.flipSided?"#define FLIP_SIDED":"",i.shadowMapEnabled?"#define USE_SHADOWMAP":"",i.shadowMapEnabled?"#define "+p:"",i.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",i.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",i.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",i.logarithmicDepthBuffer&&i.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(i.extensionShaderTextureLOD||i.envMap)&&i.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",i.toneMapping!==0?"#define TONE_MAPPING":"",i.toneMapping!==0?Ii.tonemapping_pars_fragment:"",i.toneMapping!==0?Ux("toneMapping",i.toneMapping):"",i.dithering?"#define DITHERING":"",i.outputEncoding||i.mapEncoding||i.matcapEncoding||i.envMapEncoding||i.emissiveMapEncoding||i.lightMapEncoding?Ii.encodings_pars_fragment:"",i.mapEncoding?Dc("mapTexelToLinear",i.mapEncoding):"",i.matcapEncoding?Dc("matcapTexelToLinear",i.matcapEncoding):"",i.envMapEncoding?Dc("envMapTexelToLinear",i.envMapEncoding):"",i.emissiveMapEncoding?Dc("emissiveMapTexelToLinear",i.emissiveMapEncoding):"",i.lightMapEncoding?Dc("lightMapTexelToLinear",i.lightMapEncoding):"",i.outputEncoding?zx("linearToOutputTexel",i.outputEncoding):"",i.depthPacking?"#define DEPTH_PACKING "+i.depthPacking:"",`
`].filter(Oc).join(`
`)),c=c.replace(HA,Ug),c=Ap(c,i),c=zg(c,i),g=g.replace(HA,Ug),g=Ap(g,i),g=zg(g,i),c=c.replace(O_,ua).replace(D_,Ke),g=g.replace(O_,ua).replace(D_,Ke),i.isWebGL2&&!i.isRawShaderMaterial&&(A=!1,S=/^\s*#version\s+300\s+es\s*\n/,i.isShaderMaterial&&c.match(S)!==null&&g.match(S)!==null&&(A=!0,c=c.replace(S,""),g=g.replace(S,"")),f=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+f,p=[`#version 300 es

#define varying in`,A?"":"out highp vec4 pc_fragColor;",A?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+p),g=p+g,c=v0(s,35633,f+c),g=v0(s,35632,g),s.attachShader(P,c),s.attachShader(P,g),i.index0AttributeName!==void 0?s.bindAttribLocation(P,0,i.index0AttributeName):i.morphTargets===!0&&s.bindAttribLocation(P,0,"position"),s.linkProgram(P),t.debug.checkShaderErrors&&(t=s.getProgramInfoLog(P).trim(),A=s.getShaderInfoLog(c).trim(),S=s.getShaderInfoLog(g).trim(),w=N=!0,s.getProgramParameter(P,35714)===!1?(N=!1,I=x0(s,c,"vertex"),L=x0(s,g,"fragment"),console.error("THREE.WebGLProgram: shader error: ",s.getError(),"35715",s.getProgramParameter(P,35715),"gl.getProgramInfoLog",t,I,L)):t!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",t):(A===""||S==="")&&(w=!1),w&&(this.diagnostics={runnable:N,programLog:t,vertexShader:{log:A,prefix:f},fragmentShader:{log:S,prefix:p}})),s.deleteShader(c),s.deleteShader(g);var F;this.getUniforms=function(){return F===void 0&&(F=new ks(s,P)),F};var W;return this.getAttributes=function(){if(W===void 0){for(var X={},Z=s.getProgramParameter(P,35721),tt=0;tt<Z;tt++){var st=s.getActiveAttrib(P,tt).name;X[st]=s.getAttribLocation(P,st)}W=X}return W},this.destroy=function(){s.deleteProgram(P),this.program=void 0},this.name=i.shaderName,this.id=uC++,this.cacheKey=r,this.usedTimes=1,this.program=P,this.vertexShader=c,this.fragmentShader=g,this}function kx(t,r,i){function s(L){if(L)L.isTexture?P=L.encoding:L.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),P=L.texture.encoding);else var P=3e3;return P}var f=[],c=i.isWebGL2,g=i.logarithmicDepthBuffer,p=i.floatVertexTextures,A=i.precision,S=i.maxVertexUniforms,N=i.vertexTextures,w={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},I="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(L,P,F,W,X,Z,tt){var st=W.fog;W=L.isMeshStandardMaterial?W.environment:null,W=L.envMap||W;var xt=w[L.type];if(tt.isSkinnedMesh){var At=tt.skeleton.bones;if(p)At=1024;else{var yt=Math.min(Math.floor((S-20)/4),At.length);yt<At.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+At.length+" bones. This GPU supports "+yt+"."),At=0):At=yt}}else At=0;L.precision!==null&&(A=i.getMaxPrecision(L.precision),A!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",A,"instead.")),xt?(yt=$l[xt],yt={name:L.type,uniforms:Rf.clone(yt.uniforms),vertexShader:yt.vertexShader,fragmentShader:yt.fragmentShader}):yt={name:L.type,uniforms:L.uniforms,vertexShader:L.vertexShader,fragmentShader:L.fragmentShader},L.onBeforeCompile(yt,t);var Ut=t.getRenderTarget();return{isWebGL2:c,shaderID:xt,shaderName:yt.name,uniforms:yt.uniforms,vertexShader:yt.vertexShader,fragmentShader:yt.fragmentShader,defines:L.defines,isRawShaderMaterial:L.isRawShaderMaterial,isShaderMaterial:L.isShaderMaterial,precision:A,instancing:tt.isInstancedMesh===!0,supportsVertexTextures:N,outputEncoding:Ut!==null?s(Ut.texture):t.outputEncoding,map:!!L.map,mapEncoding:s(L.map),matcap:!!L.matcap,matcapEncoding:s(L.matcap),envMap:!!W,envMapMode:W&&W.mapping,envMapEncoding:s(W),envMapCubeUV:!!W&&(W.mapping===306||W.mapping===307),lightMap:!!L.lightMap,lightMapEncoding:s(L.lightMap),aoMap:!!L.aoMap,emissiveMap:!!L.emissiveMap,emissiveMapEncoding:s(L.emissiveMap),bumpMap:!!L.bumpMap,normalMap:!!L.normalMap,objectSpaceNormalMap:L.normalMapType===1,tangentSpaceNormalMap:L.normalMapType===0,clearcoatMap:!!L.clearcoatMap,clearcoatRoughnessMap:!!L.clearcoatRoughnessMap,clearcoatNormalMap:!!L.clearcoatNormalMap,displacementMap:!!L.displacementMap,roughnessMap:!!L.roughnessMap,metalnessMap:!!L.metalnessMap,specularMap:!!L.specularMap,alphaMap:!!L.alphaMap,gradientMap:!!L.gradientMap,sheen:!!L.sheen,combine:L.combine,vertexTangents:L.normalMap&&L.vertexTangents,vertexColors:L.vertexColors,vertexUvs:!!L.map||!!L.bumpMap||!!L.normalMap||!!L.specularMap||!!L.alphaMap||!!L.emissiveMap||!!L.roughnessMap||!!L.metalnessMap||!!L.clearcoatMap||!!L.clearcoatRoughnessMap||!!L.clearcoatNormalMap||!!L.displacementMap,uvsVertexOnly:!(L.map||L.bumpMap||L.normalMap||L.specularMap||L.alphaMap||L.emissiveMap||L.roughnessMap||L.metalnessMap||L.clearcoatNormalMap)&&!!L.displacementMap,fog:!!st,useFog:L.fog,fogExp2:st&&st.isFogExp2,flatShading:L.flatShading,sizeAttenuation:L.sizeAttenuation,logarithmicDepthBuffer:g,skinning:L.skinning&&0<At,maxBones:At,useVertexTexture:p,morphTargets:L.morphTargets,morphNormals:L.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:P.directional.length,numPointLights:P.point.length,numSpotLights:P.spot.length,numRectAreaLights:P.rectArea.length,numHemiLights:P.hemi.length,numDirLightShadows:P.directionalShadowMap.length,numPointLightShadows:P.pointShadowMap.length,numSpotLightShadows:P.spotShadowMap.length,numClippingPlanes:X,numClipIntersection:Z,dithering:L.dithering,shadowMapEnabled:t.shadowMap.enabled&&0<F.length,shadowMapType:t.shadowMap.type,toneMapping:L.toneMapped?t.toneMapping:0,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:L.premultipliedAlpha,alphaTest:L.alphaTest,doubleSided:L.side===2,flipSided:L.side===1,depthPacking:L.depthPacking!==void 0?L.depthPacking:!1,index0AttributeName:L.index0AttributeName,extensionDerivatives:L.extensions&&L.extensions.derivatives,extensionFragDepth:L.extensions&&L.extensions.fragDepth,extensionDrawBuffers:L.extensions&&L.extensions.drawBuffers,extensionShaderTextureLOD:L.extensions&&L.extensions.shaderTextureLOD,rendererExtensionFragDepth:c||r.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:c||r.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:c||r.get("EXT_shader_texture_lod")!==null,onBeforeCompile:L.onBeforeCompile}},this.getProgramCacheKey=function(L){var P=[];if(L.shaderID?P.push(L.shaderID):(P.push(L.fragmentShader),P.push(L.vertexShader)),L.defines!==void 0)for(var F in L.defines)P.push(F),P.push(L.defines[F]);if(L.isRawShaderMaterial===void 0){for(F=0;F<I.length;F++)P.push(L[I[F]]);P.push(t.outputEncoding),P.push(t.gammaFactor)}return P.push(L.onBeforeCompile.toString()),P.join()},this.acquireProgram=function(L,P){for(var F,W=0,X=f.length;W<X;W++){var Z=f[W];if(Z.cacheKey===P){F=Z,++F.usedTimes;break}}return F===void 0&&(F=new la(t,P,L),f.push(F)),F},this.releaseProgram=function(L){if(--L.usedTimes===0){var P=f.indexOf(L);f[P]=f[f.length-1],f.pop(),L.destroy()}},this.programs=f}function Gx(){var t=new Zi;return{get:function(r){var i=t.get(r);return i===void 0&&(i={},t.set(r,i)),i},remove:function(r){t.delete(r)},update:function(r,i,s){t.get(r)[i]=s},dispose:function(){t=new Zi}}}function kg(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.program!==r.program?t.program.id-r.program.id:t.material.id!==r.material.id?t.material.id-r.material.id:t.z!==r.z?t.z-r.z:t.id-r.id}function bx(t,r){return t.groupOrder!==r.groupOrder?t.groupOrder-r.groupOrder:t.renderOrder!==r.renderOrder?t.renderOrder-r.renderOrder:t.z!==r.z?r.z-t.z:t.id-r.id}function Fc(){function t(g,p,A,S,N,w){var I=r[i];return I===void 0?(I={id:g.id,object:g,geometry:p,material:A,program:A.program||c,groupOrder:S,renderOrder:g.renderOrder,z:N,group:w},r[i]=I):(I.id=g.id,I.object=g,I.geometry=p,I.material=A,I.program=A.program||c,I.groupOrder=S,I.renderOrder=g.renderOrder,I.z=N,I.group=w),i++,I}var r=[],i=0,s=[],f=[],c={id:-1};return{opaque:s,transparent:f,init:function(){i=0,s.length=0,f.length=0},push:function(g,p,A,S,N,w){g=t(g,p,A,S,N,w),(A.transparent===!0?f:s).push(g)},unshift:function(g,p,A,S,N,w){g=t(g,p,A,S,N,w),(A.transparent===!0?f:s).unshift(g)},finish:function(){for(var g=i,p=r.length;g<p;g++){var A=r[g];if(A.id===null)break;A.id=null,A.object=null,A.geometry=null,A.material=null,A.program=null,A.group=null}},sort:function(g,p){1<s.length&&s.sort(g||kg),1<f.length&&f.sort(p||bx)}}}function Vx(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new Zi;return{get:function(i,s){var f=r.get(i);if(f===void 0){var c=new Fc;r.set(i,new Zi),r.get(i).set(s,c),i.addEventListener("dispose",t)}else c=f.get(s),c===void 0&&(c=new Fc,f.set(s,c));return c},dispose:function(){r=new Zi}}}function Wx(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={direction:new ot,color:new Vt};break;case"SpotLight":i={position:new ot,direction:new ot,color:new Vt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":i={position:new ot,color:new Vt,distance:0,decay:0};break;case"HemisphereLight":i={direction:new ot,skyColor:new Vt,groundColor:new Vt};break;case"RectAreaLight":i={color:new Vt,position:new ot,halfWidth:new ot,halfHeight:new ot}}return t[r.id]=i}}}function ji(){var t={};return{get:function(r){if(t[r.id]!==void 0)return t[r.id];switch(r.type){case"DirectionalLight":var i={shadowBias:0,shadowRadius:1,shadowMapSize:new vt};break;case"SpotLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new vt};break;case"PointLight":i={shadowBias:0,shadowRadius:1,shadowMapSize:new vt,shadowCameraNear:1,shadowCameraFar:1e3}}return t[r.id]=i}}}function si(t,r){return(r.castShadow?1:0)-(t.castShadow?1:0)}function Bc(){for(var t=new Wx,r=ji(),i={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},s=0;9>s;s++)i.probe.push(new ot);var f=new ot,c=new Ie,g=new Ie;return{setup:function(p,A,S){for(var N=0,w=0,I=0,L=0;9>L;L++)i.probe[L].set(0,0,0);var P=A=0,F=0,W=0,X=0,Z=0,tt=0,st=0;S=S.matrixWorldInverse,p.sort(si),L=0;for(var xt=p.length;L<xt;L++){var At=p[L],yt=At.color,Ut=At.intensity,kt=At.distance,ne=At.shadow&&At.shadow.map?At.shadow.map.texture:null;if(At.isAmbientLight)N+=yt.r*Ut,w+=yt.g*Ut,I+=yt.b*Ut;else if(At.isLightProbe)for(ne=0;9>ne;ne++)i.probe[ne].addScaledVector(At.sh.coefficients[ne],Ut);else if(At.isDirectionalLight){var Wt=t.get(At);Wt.color.copy(At.color).multiplyScalar(At.intensity),Wt.direction.setFromMatrixPosition(At.matrixWorld),f.setFromMatrixPosition(At.target.matrixWorld),Wt.direction.sub(f),Wt.direction.transformDirection(S),At.castShadow&&(Ut=At.shadow,yt=r.get(At),yt.shadowBias=Ut.bias,yt.shadowRadius=Ut.radius,yt.shadowMapSize=Ut.mapSize,i.directionalShadow[A]=yt,i.directionalShadowMap[A]=ne,i.directionalShadowMatrix[A]=At.shadow.matrix,Z++),i.directional[A]=Wt,A++}else At.isSpotLight?(Wt=t.get(At),Wt.position.setFromMatrixPosition(At.matrixWorld),Wt.position.applyMatrix4(S),Wt.color.copy(yt).multiplyScalar(Ut),Wt.distance=kt,Wt.direction.setFromMatrixPosition(At.matrixWorld),f.setFromMatrixPosition(At.target.matrixWorld),Wt.direction.sub(f),Wt.direction.transformDirection(S),Wt.coneCos=Math.cos(At.angle),Wt.penumbraCos=Math.cos(At.angle*(1-At.penumbra)),Wt.decay=At.decay,At.castShadow&&(Ut=At.shadow,yt=r.get(At),yt.shadowBias=Ut.bias,yt.shadowRadius=Ut.radius,yt.shadowMapSize=Ut.mapSize,i.spotShadow[F]=yt,i.spotShadowMap[F]=ne,i.spotShadowMatrix[F]=At.shadow.matrix,st++),i.spot[F]=Wt,F++):At.isRectAreaLight?(Wt=t.get(At),Wt.color.copy(yt).multiplyScalar(Ut),Wt.position.setFromMatrixPosition(At.matrixWorld),Wt.position.applyMatrix4(S),g.identity(),c.copy(At.matrixWorld),c.premultiply(S),g.extractRotation(c),Wt.halfWidth.set(.5*At.width,0,0),Wt.halfHeight.set(0,.5*At.height,0),Wt.halfWidth.applyMatrix4(g),Wt.halfHeight.applyMatrix4(g),i.rectArea[W]=Wt,W++):At.isPointLight?(Wt=t.get(At),Wt.position.setFromMatrixPosition(At.matrixWorld),Wt.position.applyMatrix4(S),Wt.color.copy(At.color).multiplyScalar(At.intensity),Wt.distance=At.distance,Wt.decay=At.decay,At.castShadow&&(Ut=At.shadow,yt=r.get(At),yt.shadowBias=Ut.bias,yt.shadowRadius=Ut.radius,yt.shadowMapSize=Ut.mapSize,yt.shadowCameraNear=Ut.camera.near,yt.shadowCameraFar=Ut.camera.far,i.pointShadow[P]=yt,i.pointShadowMap[P]=ne,i.pointShadowMatrix[P]=At.shadow.matrix,tt++),i.point[P]=Wt,P++):At.isHemisphereLight&&(Wt=t.get(At),Wt.direction.setFromMatrixPosition(At.matrixWorld),Wt.direction.transformDirection(S),Wt.direction.normalize(),Wt.skyColor.copy(At.color).multiplyScalar(Ut),Wt.groundColor.copy(At.groundColor).multiplyScalar(Ut),i.hemi[X]=Wt,X++)}i.ambient[0]=N,i.ambient[1]=w,i.ambient[2]=I,p=i.hash,(p.directionalLength!==A||p.pointLength!==P||p.spotLength!==F||p.rectAreaLength!==W||p.hemiLength!==X||p.numDirectionalShadows!==Z||p.numPointShadows!==tt||p.numSpotShadows!==st)&&(i.directional.length=A,i.spot.length=F,i.rectArea.length=W,i.point.length=P,i.hemi.length=X,i.directionalShadow.length=Z,i.directionalShadowMap.length=Z,i.pointShadow.length=tt,i.pointShadowMap.length=tt,i.spotShadow.length=st,i.spotShadowMap.length=st,i.directionalShadowMatrix.length=Z,i.pointShadowMatrix.length=tt,i.spotShadowMatrix.length=st,p.directionalLength=A,p.pointLength=P,p.spotLength=F,p.rectAreaLength=W,p.hemiLength=X,p.numDirectionalShadows=Z,p.numPointShadows=tt,p.numSpotShadows=st,i.version=lC++)},state:i}}function _0(){var t=new Bc,r=[],i=[];return{init:function(){r.length=0,i.length=0},state:{lightsArray:r,shadowsArray:i,lights:t},setupLights:function(s){t.setup(r,i,s)},pushLight:function(s){r.push(s)},pushShadow:function(s){i.push(s)}}}function jx(){function t(i){i=i.target,i.removeEventListener("dispose",t),r.delete(i)}var r=new Zi;return{get:function(i,s){if(r.has(i)===!1){var f=new _0;r.set(i,new Zi),r.get(i).set(s,f),i.addEventListener("dispose",t)}else r.get(i).has(s)===!1?(f=new _0,r.get(i).set(s,f)):f=r.get(i).get(s);return f},dispose:function(){r=new Zi}}}function ha(t){de.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(t)}function Au(t){de.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new ot,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(t)}function _p(t,r,i){function s(st,xt,At){At=st<<0|xt<<1|At<<2;var yt=w[At];return yt===void 0&&(yt=new ha({depthPacking:3201,morphTargets:st,skinning:xt}),w[At]=yt),yt}function f(st,xt,At){At=st<<0|xt<<1|At<<2;var yt=I[At];return yt===void 0&&(yt=new Au({morphTargets:st,skinning:xt}),I[At]=yt),yt}function c(st,xt,At,yt,Ut,kt,ne){var Wt=s,re=st.customDepthMaterial;return yt.isPointLight===!0&&(Wt=f,re=st.customDistanceMaterial),re===void 0?(re=!1,At.morphTargets===!0&&(re=xt.morphAttributes&&xt.morphAttributes.position&&0<xt.morphAttributes.position.length),xt=!1,st.isSkinnedMesh===!0&&(At.skinning===!0?xt=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",st)),st=Wt(re,xt,st.isInstancedMesh===!0)):st=re,t.localClippingEnabled&&At.clipShadows===!0&&At.clippingPlanes.length!==0&&(re=st.uuid,Wt=At.uuid,xt=L[re],xt===void 0&&(xt={},L[re]=xt),re=xt[Wt],re===void 0&&(re=st.clone(),xt[Wt]=re),st=re),st.visible=At.visible,st.wireframe=At.wireframe,st.side=ne===3?At.shadowSide!==null?At.shadowSide:At.side:At.shadowSide!==null?At.shadowSide:P[At.side],st.clipShadows=At.clipShadows,st.clippingPlanes=At.clippingPlanes,st.clipIntersection=At.clipIntersection,st.wireframeLinewidth=At.wireframeLinewidth,st.linewidth=At.linewidth,yt.isPointLight===!0&&st.isMeshDistanceMaterial===!0&&(st.referencePosition.setFromMatrixPosition(yt.matrixWorld),st.nearDistance=Ut,st.farDistance=kt),st}function g(st,xt,At,yt,Ut){if(st.visible!==!1){if(st.layers.test(xt.layers)&&(st.isMesh||st.isLine||st.isPoints)&&(st.castShadow||st.receiveShadow&&Ut===3)&&(!st.frustumCulled||p.intersectsObject(st))){st.modelViewMatrix.multiplyMatrices(At.matrixWorldInverse,st.matrixWorld);var kt=r.update(st),ne=st.material;if(Array.isArray(ne))for(var Wt=kt.groups,re=0,be=Wt.length;re<be;re++){var ce=Wt[re],tr=ne[ce.materialIndex];tr&&tr.visible&&(tr=c(st,kt,tr,yt,At.near,At.far,Ut),t.renderBufferDirect(At,null,kt,tr,st,ce))}else ne.visible&&(tr=c(st,kt,ne,yt,At.near,At.far,Ut),t.renderBufferDirect(At,null,kt,tr,st,null))}for(st=st.children,kt=0,ne=st.length;kt<ne;kt++)g(st[kt],xt,At,yt,Ut)}}var p=new yu,A=new vt,S=new vt,N=new _t,w=[],I=[],L={},P={0:1,1:0,2:2},F=new ki({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new vt},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),W=F.clone();W.defines.HORIZONAL_PASS=1;var X=new We;X.setAttribute("position",new He(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var Z=new Wi(X,F),tt=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(st,xt,At){if(tt.enabled!==!1&&(tt.autoUpdate!==!1||tt.needsUpdate!==!1)&&st.length!==0){var yt=t.getRenderTarget(),Ut=t.getActiveCubeFace(),kt=t.getActiveMipmapLevel(),ne=t.state;ne.setBlending(0),ne.buffers.color.setClear(1,1,1,1),ne.buffers.depth.setTest(!0),ne.setScissorTest(!1);for(var Wt=0,re=st.length;Wt<re;Wt++){var be=st[Wt],ce=be.shadow;if(ce===void 0)console.warn("THREE.WebGLShadowMap:",be,"has no shadow.");else{A.copy(ce.mapSize);var tr=ce.getFrameExtents();A.multiply(tr),S.copy(ce.mapSize),(A.x>i||A.y>i)&&(A.x>i&&(S.x=Math.floor(i/tr.x),A.x=S.x*tr.x,ce.mapSize.x=S.x),A.y>i&&(S.y=Math.floor(i/tr.y),A.y=S.y*tr.y,ce.mapSize.y=S.y)),ce.map!==null||ce.isPointLightShadow||this.type!==3||(tr={minFilter:1006,magFilter:1006,format:1023},ce.map=new Ft(A.x,A.y,tr),ce.map.texture.name=be.name+".shadowMap",ce.mapPass=new Ft(A.x,A.y,tr),ce.camera.updateProjectionMatrix()),ce.map===null&&(tr={minFilter:1003,magFilter:1003,format:1023},ce.map=new Ft(A.x,A.y,tr),ce.map.texture.name=be.name+".shadowMap",ce.camera.updateProjectionMatrix()),t.setRenderTarget(ce.map),t.clear(),tr=ce.getViewportCount();for(var yr=0;yr<tr;yr++){var sr=ce.getViewport(yr);N.set(S.x*sr.x,S.y*sr.y,S.x*sr.z,S.y*sr.w),ne.viewport(N),ce.updateMatrices(be,yr),p=ce.getFrustum(),g(xt,At,ce.camera,be,this.type)}ce.isPointLightShadow||this.type!==3||(be=ce,ce=At,tr=r.update(Z),F.uniforms.shadow_pass.value=be.map.texture,F.uniforms.resolution.value=be.mapSize,F.uniforms.radius.value=be.radius,t.setRenderTarget(be.mapPass),t.clear(),t.renderBufferDirect(ce,null,tr,F,Z,null),W.uniforms.shadow_pass.value=be.mapPass.texture,W.uniforms.resolution.value=be.mapSize,W.uniforms.radius.value=be.radius,t.setRenderTarget(be.map),t.clear(),t.renderBufferDirect(ce,null,tr,W,Z,null))}}tt.needsUpdate=!1,t.setRenderTarget(yt,Ut,kt)}}}function Xx(t,r,i){function s(ft,ve,xe){var me=new Uint8Array(4),le=t.createTexture();for(t.bindTexture(ft,le),t.texParameteri(ft,10241,9728),t.texParameteri(ft,10240,9728),ft=0;ft<xe;ft++)t.texImage2D(ve+ft,0,6408,1,1,0,6408,5121,me);return le}function f(ft,ve){Z[ft]=1,tt[ft]===0&&(t.enableVertexAttribArray(ft),tt[ft]=1),st[ft]!==ve&&((P?t:r.get("ANGLE_instanced_arrays"))[P?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](ft,ve),st[ft]=ve)}function c(ft){xt[ft]!==!0&&(t.enable(ft),xt[ft]=!0)}function g(ft){xt[ft]!==!1&&(t.disable(ft),xt[ft]=!1)}function p(ft,ve,xe,me,le,Ce,xr,Br){if(ft===0)yt&&(g(3042),yt=!1);else if(yt||(c(3042),yt=!0),ft!==5){if(ft!==Ut||Br!==tr){if((kt!==100||re!==100)&&(t.blendEquation(32774),re=kt=100),Br)switch(ft){case 1:t.blendFuncSeparate(1,771,1,771);break;case 2:t.blendFunc(1,1);break;case 3:t.blendFuncSeparate(0,0,769,771);break;case 4:t.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ft)}else switch(ft){case 1:t.blendFuncSeparate(770,771,1,771);break;case 2:t.blendFunc(770,1);break;case 3:t.blendFunc(0,769);break;case 4:t.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ft)}ce=be=Wt=ne=null,Ut=ft,tr=Br}}else le=le||ve,Ce=Ce||xe,xr=xr||me,(ve!==kt||le!==re)&&(t.blendEquationSeparate(Gt[ve],Gt[le]),kt=ve,re=le),(xe!==ne||me!==Wt||Ce!==be||xr!==ce)&&(t.blendFuncSeparate(Qt[xe],Qt[me],Qt[Ce],Qt[xr]),ne=xe,Wt=me,be=Ce,ce=xr),Ut=ft,tr=null}function A(ft){yr!==ft&&(ft?t.frontFace(2304):t.frontFace(2305),yr=ft)}function S(ft){ft!==0?(c(2884),ft!==sr&&(ft===1?t.cullFace(1029):ft===2?t.cullFace(1028):t.cullFace(1032))):g(2884),sr=ft}function N(ft,ve,xe){ft?(c(32823),(pr!==ve||dt!==xe)&&(t.polygonOffset(ve,xe),pr=ve,dt=xe)):g(32823)}function w(ft){ft===void 0&&(ft=33984+gt-1),Tt!==ft&&(t.activeTexture(ft),Tt=ft)}var I,L,P=i.isWebGL2,F=new function(){var ft=!1,ve=new _t,xe=null,me=new _t(0,0,0,0);return{setMask:function(le){xe===le||ft||(t.colorMask(le,le,le,le),xe=le)},setLocked:function(le){ft=le},setClear:function(le,Ce,xr,Br,Ae){Ae===!0&&(le*=Br,Ce*=Br,xr*=Br),ve.set(le,Ce,xr,Br),me.equals(ve)===!1&&(t.clearColor(le,Ce,xr,Br),me.copy(ve))},reset:function(){ft=!1,xe=null,me.set(-1,0,0,0)}}},W=new function(){var ft=!1,ve=null,xe=null,me=null;return{setTest:function(le){le?c(2929):g(2929)},setMask:function(le){ve===le||ft||(t.depthMask(le),ve=le)},setFunc:function(le){if(xe!==le){if(le)switch(le){case 0:t.depthFunc(512);break;case 1:t.depthFunc(519);break;case 2:t.depthFunc(513);break;case 3:t.depthFunc(515);break;case 4:t.depthFunc(514);break;case 5:t.depthFunc(518);break;case 6:t.depthFunc(516);break;case 7:t.depthFunc(517);break;default:t.depthFunc(515)}else t.depthFunc(515);xe=le}},setLocked:function(le){ft=le},setClear:function(le){me!==le&&(t.clearDepth(le),me=le)},reset:function(){ft=!1,me=xe=ve=null}}},X=new function(){var ft=!1,ve=null,xe=null,me=null,le=null,Ce=null,xr=null,Br=null,Ae=null;return{setTest:function(ar){ft||(ar?c(2960):g(2960))},setMask:function(ar){ve===ar||ft||(t.stencilMask(ar),ve=ar)},setFunc:function(ar,Wr,Ze){(xe!==ar||me!==Wr||le!==Ze)&&(t.stencilFunc(ar,Wr,Ze),xe=ar,me=Wr,le=Ze)},setOp:function(ar,Wr,Ze){(Ce!==ar||xr!==Wr||Br!==Ze)&&(t.stencilOp(ar,Wr,Ze),Ce=ar,xr=Wr,Br=Ze)},setLocked:function(ar){ft=ar},setClear:function(ar){Ae!==ar&&(t.clearStencil(ar),Ae=ar)},reset:function(){ft=!1,Ae=Br=xr=Ce=le=me=xe=ve=null}}};i=t.getParameter(34921);var Z=new Uint8Array(i),tt=new Uint8Array(i),st=new Uint8Array(i),xt={},At=null,yt=null,Ut=null,kt=null,ne=null,Wt=null,re=null,be=null,ce=null,tr=!1,yr=null,sr=null,ni=null,pr=null,dt=null,gt=t.getParameter(35661),mt=!1;i=0,i=t.getParameter(7938),i.indexOf("WebGL")!==-1?(i=parseFloat(/^WebGL ([0-9])/.exec(i)[1]),mt=1<=i):i.indexOf("OpenGL ES")!==-1&&(i=parseFloat(/^OpenGL ES ([0-9])/.exec(i)[1]),mt=2<=i);var Tt=null,et={},ht=new _t,ct=new _t,St={};St[3553]=s(3553,3553,1),St[34067]=s(34067,34069,6),F.setClear(0,0,0,1),W.setClear(1),X.setClear(0),c(2929),W.setFunc(3),A(!1),S(1),c(2884),p(0);var Gt=(I={},zi(I,100,32774),zi(I,101,32778),zi(I,102,32779),I);P?(Gt[103]=32775,Gt[104]=32776):(I=r.get("EXT_blend_minmax"),I!==null&&(Gt[103]=I.MIN_EXT,Gt[104]=I.MAX_EXT));var Qt=(L={},zi(L,200,0),zi(L,201,1),zi(L,202,768),zi(L,204,770),zi(L,210,776),zi(L,208,774),zi(L,206,772),zi(L,203,769),zi(L,205,771),zi(L,209,775),zi(L,207,773),L);return{buffers:{color:F,depth:W,stencil:X},initAttributes:function(){for(var ft=0,ve=Z.length;ft<ve;ft++)Z[ft]=0},enableAttribute:function(ft){f(ft,0)},enableAttributeAndDivisor:f,disableUnusedAttributes:function(){for(var ft=0,ve=tt.length;ft!==ve;++ft)tt[ft]!==Z[ft]&&(t.disableVertexAttribArray(ft),tt[ft]=0)},vertexAttribPointer:function(ft,ve,xe,me,le,Ce){P!==!0||xe!==5124&&xe!==5125?t.vertexAttribPointer(ft,ve,xe,me,le,Ce):t.vertexAttribIPointer(ft,ve,xe,me,le,Ce)},enable:c,disable:g,useProgram:function(ft){return At!==ft?(t.useProgram(ft),At=ft,!0):!1},setBlending:p,setMaterial:function(ft,ve){ft.side===2?g(2884):c(2884);var xe=ft.side===1;ve&&(xe=!xe),A(xe),ft.blending===1&&ft.transparent===!1?p(0):p(ft.blending,ft.blendEquation,ft.blendSrc,ft.blendDst,ft.blendEquationAlpha,ft.blendSrcAlpha,ft.blendDstAlpha,ft.premultipliedAlpha),W.setFunc(ft.depthFunc),W.setTest(ft.depthTest),W.setMask(ft.depthWrite),F.setMask(ft.colorWrite),ve=ft.stencilWrite,X.setTest(ve),ve&&(X.setMask(ft.stencilWriteMask),X.setFunc(ft.stencilFunc,ft.stencilRef,ft.stencilFuncMask),X.setOp(ft.stencilFail,ft.stencilZFail,ft.stencilZPass)),N(ft.polygonOffset,ft.polygonOffsetFactor,ft.polygonOffsetUnits)},setFlipSided:A,setCullFace:S,setLineWidth:function(ft){ft!==ni&&(mt&&t.lineWidth(ft),ni=ft)},setPolygonOffset:N,setScissorTest:function(ft){ft?c(3089):g(3089)},activeTexture:w,bindTexture:function(ft,ve){Tt===null&&w();var xe=et[Tt];xe===void 0&&(xe={type:void 0,texture:void 0},et[Tt]=xe),(xe.type!==ft||xe.texture!==ve)&&(t.bindTexture(ft,ve||St[ft]),xe.type=ft,xe.texture=ve)},unbindTexture:function(){var ft=et[Tt];ft!==void 0&&ft.type!==void 0&&(t.bindTexture(ft.type,null),ft.type=void 0,ft.texture=void 0)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},texImage3D:function(){try{t.texImage3D.apply(t,arguments)}catch(ft){console.error("THREE.WebGLState:",ft)}},scissor:function(ft){ht.equals(ft)===!1&&(t.scissor(ft.x,ft.y,ft.z,ft.w),ht.copy(ft))},viewport:function(ft){ct.equals(ft)===!1&&(t.viewport(ft.x,ft.y,ft.z,ft.w),ct.copy(ft))},reset:function(){for(var ft=0;ft<tt.length;ft++)tt[ft]===1&&(t.disableVertexAttribArray(ft),tt[ft]=0);xt={},Tt=null,et={},sr=yr=Ut=At=null,F.reset(),W.reset(),X.reset()}}}function Yx(t,r,i,s,f,c,g){function p(et,ht){return ni?new OffscreenCanvas(et,ht):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function A(et,ht,ct,St){var Gt=1;if((et.width>St||et.height>St)&&(Gt=St/Math.max(et.width,et.height)),1>Gt||ht===!0){if(typeof HTMLImageElement!="undefined"&&et instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&et instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&et instanceof ImageBitmap)return St=ht?Tr.floorPowerOfTwo:Math.floor,ht=St(Gt*et.width),Gt=St(Gt*et.height),sr===void 0&&(sr=p(ht,Gt)),ct=ct?p(ht,Gt):sr,ct.width=ht,ct.height=Gt,ct.getContext("2d").drawImage(et,0,0,ht,Gt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+et.width+"x"+et.height+") to ("+ht+"x"+Gt+")."),ct;"data"in et&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+et.width+"x"+et.height+").")}return et}function S(et){return Tr.isPowerOfTwo(et.width)&&Tr.isPowerOfTwo(et.height)}function N(et,ht){return et.generateMipmaps&&ht&&et.minFilter!==1003&&et.minFilter!==1006}function w(et,ht,ct,St){t.generateMipmap(et),s.get(ht).__maxMipLevel=Math.log(Math.max(ct,St))*Math.LOG2E}function I(et,ht,ct){if(Wt===!1)return ht;if(et!==null){if(t[et]!==void 0)return t[et];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+et+"'")}return et=ht,ht===6403&&(ct===5126&&(et=33326),ct===5131&&(et=33325),ct===5121&&(et=33321)),ht===6407&&(ct===5126&&(et=34837),ct===5131&&(et=34843),ct===5121&&(et=32849)),ht===6408&&(ct===5126&&(et=34836),ct===5131&&(et=34842),ct===5121&&(et=32856)),et!==33325&&et!==33326&&et!==34842&&et!==34836||r.get("EXT_color_buffer_float"),et}function L(et){return et===1003||et===1004||et===1005?9728:9729}function P(et){et=et.target,et.removeEventListener("dispose",P);var ht=s.get(et);ht.__webglInit!==void 0&&(t.deleteTexture(ht.__webglTexture),s.remove(et)),et.isVideoTexture&&yr.delete(et),g.memory.textures--}function F(et){et=et.target,et.removeEventListener("dispose",F);var ht=s.get(et),ct=s.get(et.texture);if(et){if(ct.__webglTexture!==void 0&&t.deleteTexture(ct.__webglTexture),et.depthTexture&&et.depthTexture.dispose(),et.isWebGLCubeRenderTarget)for(ct=0;6>ct;ct++)t.deleteFramebuffer(ht.__webglFramebuffer[ct]),ht.__webglDepthbuffer&&t.deleteRenderbuffer(ht.__webglDepthbuffer[ct]);else t.deleteFramebuffer(ht.__webglFramebuffer),ht.__webglDepthbuffer&&t.deleteRenderbuffer(ht.__webglDepthbuffer),ht.__webglMultisampledFramebuffer&&t.deleteFramebuffer(ht.__webglMultisampledFramebuffer),ht.__webglColorRenderbuffer&&t.deleteRenderbuffer(ht.__webglColorRenderbuffer),ht.__webglDepthRenderbuffer&&t.deleteRenderbuffer(ht.__webglDepthRenderbuffer);s.remove(et.texture),s.remove(et)}g.memory.textures--}function W(et,ht){var ct=s.get(et);if(et.isVideoTexture){var St=g.render.frame;yr.get(et)!==St&&(yr.set(et,St),et.update())}if(0<et.version&&ct.__version!==et.version)if(St=et.image,St===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(St.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{xt(ct,et,ht);return}i.activeTexture(33984+ht),i.bindTexture(3553,ct.__webglTexture)}function X(et,ht){if(et.image.length===6){var ct=s.get(et);if(0<et.version&&ct.__version!==et.version){st(ct,et),i.activeTexture(33984+ht),i.bindTexture(34067,ct.__webglTexture),t.pixelStorei(37440,et.flipY);var St=et&&(et.isCompressedTexture||et.image[0].isCompressedTexture);ht=et.image[0]&&et.image[0].isDataTexture;for(var Gt=[],Qt=0;6>Qt;Qt++)Gt[Qt]=St||ht?ht?et.image[Qt].image:et.image[Qt]:A(et.image[Qt],!1,!0,be);var ft=Gt[0],ve=S(ft)||Wt,xe=c.convert(et.format),me=c.convert(et.type),le=I(et.internalFormat,xe,me);if(tt(34067,et,ve),St){for(Qt=0;6>Qt;Qt++){var Ce=Gt[Qt].mipmaps;for(St=0;St<Ce.length;St++){var xr=Ce[St];et.format!==1023&&et.format!==1022?xe!==null?i.compressedTexImage2D(34069+Qt,St,le,xr.width,xr.height,0,xr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(34069+Qt,St,le,xr.width,xr.height,0,xe,me,xr.data)}}ct.__maxMipLevel=Ce.length-1}else{for(Ce=et.mipmaps,Qt=0;6>Qt;Qt++)if(ht)for(i.texImage2D(34069+Qt,0,le,Gt[Qt].width,Gt[Qt].height,0,xe,me,Gt[Qt].data),St=0;St<Ce.length;St++)xr=Ce[St],xr=xr.image[Qt].image,i.texImage2D(34069+Qt,St+1,le,xr.width,xr.height,0,xe,me,xr.data);else for(i.texImage2D(34069+Qt,0,le,xe,me,Gt[Qt]),St=0;St<Ce.length;St++)xr=Ce[St],i.texImage2D(34069+Qt,St+1,le,xe,me,xr.image[Qt]);ct.__maxMipLevel=Ce.length}N(et,ve)&&w(34067,et,ft.width,ft.height),ct.__version=et.version,et.onUpdate&&et.onUpdate(et)}else i.activeTexture(33984+ht),i.bindTexture(34067,ct.__webglTexture)}}function Z(et,ht){i.activeTexture(33984+ht),i.bindTexture(34067,s.get(et).__webglTexture)}function tt(et,ht,ct){ct?(t.texParameteri(et,10242,dt[ht.wrapS]),t.texParameteri(et,10243,dt[ht.wrapT]),et!==32879&&et!==35866||t.texParameteri(et,32882,dt[ht.wrapR]),t.texParameteri(et,10240,gt[ht.magFilter]),t.texParameteri(et,10241,gt[ht.minFilter])):(t.texParameteri(et,10242,33071),t.texParameteri(et,10243,33071),et!==32879&&et!==35866||t.texParameteri(et,32882,33071),ht.wrapS===1001&&ht.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),t.texParameteri(et,10240,L(ht.magFilter)),t.texParameteri(et,10241,L(ht.minFilter)),ht.minFilter!==1003&&ht.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(ct=r.get("EXT_texture_filter_anisotropic"))||ht.type===1015&&r.get("OES_texture_float_linear")===null||ht.type===1016&&(Wt||r.get("OES_texture_half_float_linear"))===null||!(1<ht.anisotropy||s.get(ht).__currentAnisotropy)||(t.texParameterf(et,ct.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(ht.anisotropy,f.getMaxAnisotropy())),s.get(ht).__currentAnisotropy=ht.anisotropy)}function st(et,ht){et.__webglInit===void 0&&(et.__webglInit=!0,ht.addEventListener("dispose",P),et.__webglTexture=t.createTexture(),g.memory.textures++)}function xt(et,ht,ct){var St=3553;ht.isDataTexture2DArray&&(St=35866),ht.isDataTexture3D&&(St=32879),st(et,ht),i.activeTexture(33984+ct),i.bindTexture(St,et.__webglTexture),t.pixelStorei(37440,ht.flipY),t.pixelStorei(37441,ht.premultiplyAlpha),t.pixelStorei(3317,ht.unpackAlignment),ct=Wt?!1:ht.wrapS!==1001||ht.wrapT!==1001||ht.minFilter!==1003&&ht.minFilter!==1006,ct=ct&&S(ht.image)===!1,ct=A(ht.image,ct,!1,ce);var Gt=S(ct)||Wt,Qt=c.convert(ht.format),ft=c.convert(ht.type),ve=I(ht.internalFormat,Qt,ft);tt(St,ht,Gt);var xe=ht.mipmaps;if(ht.isDepthTexture)ve=6402,Wt?ve=ht.type===1015?36012:ht.type===1014?33190:ht.type===1020?35056:33189:ht.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),ht.format===1026&&ve===6402&&ht.type!==1012&&ht.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),ht.type=1012,ft=c.convert(ht.type)),ht.format===1027&&ve===6402&&(ve=34041,ht.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),ht.type=1020,ft=c.convert(ht.type))),i.texImage2D(3553,0,ve,ct.width,ct.height,0,Qt,ft,null);else if(ht.isDataTexture)if(0<xe.length&&Gt){for(var me=0,le=xe.length;me<le;me++){var Ce=xe[me];i.texImage2D(3553,me,ve,Ce.width,Ce.height,0,Qt,ft,Ce.data)}ht.generateMipmaps=!1,et.__maxMipLevel=xe.length-1}else i.texImage2D(3553,0,ve,ct.width,ct.height,0,Qt,ft,ct.data),et.__maxMipLevel=0;else if(ht.isCompressedTexture){for(me=0,le=xe.length;me<le;me++)Ce=xe[me],ht.format!==1023&&ht.format!==1022?Qt!==null?i.compressedTexImage2D(3553,me,ve,Ce.width,Ce.height,0,Ce.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(3553,me,ve,Ce.width,Ce.height,0,Qt,ft,Ce.data);et.__maxMipLevel=xe.length-1}else if(ht.isDataTexture2DArray)i.texImage3D(35866,0,ve,ct.width,ct.height,ct.depth,0,Qt,ft,ct.data),et.__maxMipLevel=0;else if(ht.isDataTexture3D)i.texImage3D(32879,0,ve,ct.width,ct.height,ct.depth,0,Qt,ft,ct.data),et.__maxMipLevel=0;else if(0<xe.length&&Gt){for(me=0,le=xe.length;me<le;me++)Ce=xe[me],i.texImage2D(3553,me,ve,Qt,ft,Ce);ht.generateMipmaps=!1,et.__maxMipLevel=xe.length-1}else i.texImage2D(3553,0,ve,Qt,ft,ct),et.__maxMipLevel=0;N(ht,Gt)&&w(St,ht,ct.width,ct.height),et.__version=ht.version,ht.onUpdate&&ht.onUpdate(ht)}function At(et,ht,ct,St){var Gt=c.convert(ht.texture.format),Qt=c.convert(ht.texture.type),ft=I(ht.texture.internalFormat,Gt,Qt);i.texImage2D(St,0,ft,ht.width,ht.height,0,Gt,Qt,null),t.bindFramebuffer(36160,et),t.framebufferTexture2D(36160,ct,St,s.get(ht.texture).__webglTexture,0),t.bindFramebuffer(36160,null)}function yt(et,ht,ct){if(t.bindRenderbuffer(36161,et),ht.depthBuffer&&!ht.stencilBuffer){var St=33189;ct?((ct=ht.depthTexture)&&ct.isDepthTexture&&(ct.type===1015?St=36012:ct.type===1014&&(St=33190)),ct=Ut(ht),t.renderbufferStorageMultisample(36161,ct,St,ht.width,ht.height)):t.renderbufferStorage(36161,St,ht.width,ht.height),t.framebufferRenderbuffer(36160,36096,36161,et)}else ht.depthBuffer&&ht.stencilBuffer?(ct?(ct=Ut(ht),t.renderbufferStorageMultisample(36161,ct,35056,ht.width,ht.height)):t.renderbufferStorage(36161,34041,ht.width,ht.height),t.framebufferRenderbuffer(36160,33306,36161,et)):(et=c.convert(ht.texture.format),St=c.convert(ht.texture.type),St=I(ht.texture.internalFormat,et,St),ct?(ct=Ut(ht),t.renderbufferStorageMultisample(36161,ct,St,ht.width,ht.height)):t.renderbufferStorage(36161,St,ht.width,ht.height));t.bindRenderbuffer(36161,null)}function Ut(et){return Wt&&et.isWebGLMultisampleRenderTarget?Math.min(tr,et.samples):0}var kt,ne,Wt=f.isWebGL2,re=f.maxTextures,be=f.maxCubemapSize,ce=f.maxTextureSize,tr=f.maxSamples,yr=new Zi,sr,ni=!1;try{ni=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(et){}var pr=0,dt=(kt={},zi(kt,1e3,10497),zi(kt,1001,33071),zi(kt,1002,33648),kt),gt=(ne={},zi(ne,1003,9728),zi(ne,1004,9984),zi(ne,1005,9986),zi(ne,1006,9729),zi(ne,1007,9985),zi(ne,1008,9987),ne),mt=!1,Tt=!1;this.allocateTextureUnit=function(){var et=pr;return et>=re&&console.warn("THREE.WebGLTextures: Trying to use "+et+" texture units while this GPU supports only "+re),pr+=1,et},this.resetTextureUnits=function(){pr=0},this.setTexture2D=W,this.setTexture2DArray=function(et,ht){var ct=s.get(et);0<et.version&&ct.__version!==et.version?xt(ct,et,ht):(i.activeTexture(33984+ht),i.bindTexture(35866,ct.__webglTexture))},this.setTexture3D=function(et,ht){var ct=s.get(et);0<et.version&&ct.__version!==et.version?xt(ct,et,ht):(i.activeTexture(33984+ht),i.bindTexture(32879,ct.__webglTexture))},this.setTextureCube=X,this.setTextureCubeDynamic=Z,this.setupRenderTarget=function(et){var ht=s.get(et),ct=s.get(et.texture);et.addEventListener("dispose",F),ct.__webglTexture=t.createTexture(),g.memory.textures++;var St=et.isWebGLCubeRenderTarget===!0,Gt=et.isWebGLMultisampleRenderTarget===!0,Qt=S(et)||Wt;if(!Wt||et.texture.format!==1022||et.texture.type!==1015&&et.texture.type!==1016||(et.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),St)for(ht.__webglFramebuffer=[],Gt=0;6>Gt;Gt++)ht.__webglFramebuffer[Gt]=t.createFramebuffer();else if(ht.__webglFramebuffer=t.createFramebuffer(),Gt)if(Wt){ht.__webglMultisampledFramebuffer=t.createFramebuffer(),ht.__webglColorRenderbuffer=t.createRenderbuffer(),t.bindRenderbuffer(36161,ht.__webglColorRenderbuffer),Gt=c.convert(et.texture.format);var ft=c.convert(et.texture.type);Gt=I(et.texture.internalFormat,Gt,ft),ft=Ut(et),t.renderbufferStorageMultisample(36161,ft,Gt,et.width,et.height),t.bindFramebuffer(36160,ht.__webglMultisampledFramebuffer),t.framebufferRenderbuffer(36160,36064,36161,ht.__webglColorRenderbuffer),t.bindRenderbuffer(36161,null),et.depthBuffer&&(ht.__webglDepthRenderbuffer=t.createRenderbuffer(),yt(ht.__webglDepthRenderbuffer,et,!0)),t.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(St){for(i.bindTexture(34067,ct.__webglTexture),tt(34067,et.texture,Qt),Gt=0;6>Gt;Gt++)At(ht.__webglFramebuffer[Gt],et,36064,34069+Gt);N(et.texture,Qt)&&w(34067,et.texture,et.width,et.height),i.bindTexture(34067,null)}else i.bindTexture(3553,ct.__webglTexture),tt(3553,et.texture,Qt),At(ht.__webglFramebuffer,et,36064,3553),N(et.texture,Qt)&&w(3553,et.texture,et.width,et.height),i.bindTexture(3553,null);if(et.depthBuffer){if(ht=s.get(et),ct=et.isWebGLCubeRenderTarget===!0,et.depthTexture){if(ct)throw Error("target.depthTexture not supported in Cube render targets");if(et&&et.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(36160,ht.__webglFramebuffer),!et.depthTexture||!et.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(s.get(et.depthTexture).__webglTexture&&et.depthTexture.image.width===et.width&&et.depthTexture.image.height===et.height||(et.depthTexture.image.width=et.width,et.depthTexture.image.height=et.height,et.depthTexture.needsUpdate=!0),W(et.depthTexture,0),ht=s.get(et.depthTexture).__webglTexture,et.depthTexture.format===1026)t.framebufferTexture2D(36160,36096,3553,ht,0);else if(et.depthTexture.format===1027)t.framebufferTexture2D(36160,33306,3553,ht,0);else throw Error("Unknown depthTexture format")}else if(ct)for(ht.__webglDepthbuffer=[],ct=0;6>ct;ct++)t.bindFramebuffer(36160,ht.__webglFramebuffer[ct]),ht.__webglDepthbuffer[ct]=t.createRenderbuffer(),yt(ht.__webglDepthbuffer[ct],et,!1);else t.bindFramebuffer(36160,ht.__webglFramebuffer),ht.__webglDepthbuffer=t.createRenderbuffer(),yt(ht.__webglDepthbuffer,et,!1);t.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(et){var ht=et.texture,ct=S(et)||Wt;if(N(ht,ct)){ct=et.isWebGLCubeRenderTarget?34067:3553;var St=s.get(ht).__webglTexture;i.bindTexture(ct,St),w(ct,ht,et.width,et.height),i.bindTexture(ct,null)}},this.updateMultisampleRenderTarget=function(et){if(et.isWebGLMultisampleRenderTarget)if(Wt){var ht=s.get(et);t.bindFramebuffer(36008,ht.__webglMultisampledFramebuffer),t.bindFramebuffer(36009,ht.__webglFramebuffer);var ct=et.width,St=et.height,Gt=16384;et.depthBuffer&&(Gt|=256),et.stencilBuffer&&(Gt|=1024),t.blitFramebuffer(0,0,ct,St,0,0,ct,St,Gt,9728),t.bindFramebuffer(36160,ht.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(et,ht){et&&et.isWebGLRenderTarget&&(mt===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),mt=!0),et=et.texture),W(et,ht)},this.safeSetTextureCube=function(et,ht){et&&et.isWebGLCubeRenderTarget&&(Tt===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),Tt=!0),et=et.texture),et&&et.isCubeTexture||Array.isArray(et.image)&&et.image.length===6?X(et,ht):Z(et,ht)}}function w0(t,r,i){var s=i.isWebGL2;return{convert:function(f){if(f===1009)return 5121;if(f===1017)return 32819;if(f===1018)return 32820;if(f===1019)return 33635;if(f===1010)return 5120;if(f===1011)return 5122;if(f===1012)return 5123;if(f===1013)return 5124;if(f===1014)return 5125;if(f===1015)return 5126;if(f===1016){if(s)return 5131;var c=r.get("OES_texture_half_float");return c!==null?c.HALF_FLOAT_OES:null}if(f===1021)return 6406;if(f===1022)return 6407;if(f===1023)return 6408;if(f===1024)return 6409;if(f===1025)return 6410;if(f===1026)return 6402;if(f===1027)return 34041;if(f===1028)return 6403;if(f===1029)return 36244;if(f===1030)return 33319;if(f===1031)return 33320;if(f===1032)return 36248;if(f===1033)return 36249;if(f===33776||f===33777||f===33778||f===33779)if(c=r.get("WEBGL_compressed_texture_s3tc"),c!==null){if(f===33776)return c.COMPRESSED_RGB_S3TC_DXT1_EXT;if(f===33777)return c.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(f===33778)return c.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(f===33779)return c.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(f===35840||f===35841||f===35842||f===35843)if(c=r.get("WEBGL_compressed_texture_pvrtc"),c!==null){if(f===35840)return c.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(f===35841)return c.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(f===35842)return c.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(f===35843)return c.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(f===36196)return c=r.get("WEBGL_compressed_texture_etc1"),c!==null?c.COMPRESSED_RGB_ETC1_WEBGL:null;if((f===37492||f===37496)&&(c=r.get("WEBGL_compressed_texture_etc"),c!==null)){if(f===37492)return c.COMPRESSED_RGB8_ETC2;if(f===37496)return c.COMPRESSED_RGBA8_ETC2_EAC}if(f===37808||f===37809||f===37810||f===37811||f===37812||f===37813||f===37814||f===37815||f===37816||f===37817||f===37818||f===37819||f===37820||f===37821||f===37840||f===37841||f===37842||f===37843||f===37844||f===37845||f===37846||f===37847||f===37848||f===37849||f===37850||f===37851||f===37852||f===37853)return c=r.get("WEBGL_compressed_texture_astc"),c!==null?f:null;if(f===36492)return c=r.get("EXT_texture_compression_bptc"),c!==null?f:null;if(f===1020)return s?34042:(c=r.get("WEBGL_depth_texture"),c!==null?c.UNSIGNED_INT_24_8_WEBGL:null)}}}function Ah(t){un.call(this),this.cameras=t||[]}function Ho(){Ee.call(this),this.type="Group"}function ca(){this._grip=this._targetRay=null}function Vn(t,r){function i(kt){var ne=P.get(kt.inputSource);ne&&ne.dispatchEvent({type:kt.type})}function s(){P.forEach(function(kt,ne){kt.disconnect(ne)}),P.clear(),t.setFramebuffer(null),t.setRenderTarget(t.getRenderTarget()),Ut.stop(),p.isPresenting=!1,p.dispatchEvent({type:"sessionend"})}function f(kt){N=kt,Ut.setContext(A),Ut.start(),p.isPresenting=!0,p.dispatchEvent({type:"sessionstart"})}function c(kt){for(var ne=A.inputSources,Wt=0;Wt<L.length;Wt++)P.set(ne[Wt],L[Wt]);for(Wt=0;Wt<kt.removed.length;Wt++){ne=kt.removed[Wt];var re=P.get(ne);re&&(re.dispatchEvent({type:"disconnected",data:ne}),P.delete(ne))}for(Wt=0;Wt<kt.added.length;Wt++)ne=kt.added[Wt],(re=P.get(ne))&&re.dispatchEvent({type:"connected",data:ne})}function g(kt,ne){ne===null?kt.matrixWorld.copy(kt.matrix):kt.matrixWorld.multiplyMatrices(ne.matrixWorld,kt.matrix),kt.matrixWorldInverse.getInverse(kt.matrixWorld)}var p=this,A=null,S=1,N=null,w="local-floor",I=null,L=[],P=new Pm,F=new un;F.layers.enable(1),F.viewport=new _t;var W=new un;W.layers.enable(2),W.viewport=new _t;var X=[F,W],Z=new Ah;Z.layers.enable(1),Z.layers.enable(2);var tt=null,st=null;this.isPresenting=this.enabled=!1,this.getController=function(kt){var ne=L[kt];return ne===void 0&&(ne=new ca,L[kt]=ne),ne.getTargetRaySpace()},this.getControllerGrip=function(kt){var ne=L[kt];return ne===void 0&&(ne=new ca,L[kt]=ne),ne.getGripSpace()},this.setFramebufferScaleFactor=function(kt){S=kt,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(kt){w=kt,p.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return N},this.getSession=function(){return A},this.setSession=function(kt){A=kt,A!==null&&(A.addEventListener("select",i),A.addEventListener("selectstart",i),A.addEventListener("selectend",i),A.addEventListener("squeeze",i),A.addEventListener("squeezestart",i),A.addEventListener("squeezeend",i),A.addEventListener("end",s),kt=r.getContextAttributes(),kt.xrCompatible!==!0&&r.makeXRCompatible(),kt=new XRWebGLLayer(A,r,{antialias:kt.antialias,alpha:kt.alpha,depth:kt.depth,stencil:kt.stencil,framebufferScaleFactor:S}),A.updateRenderState({baseLayer:kt}),A.requestReferenceSpace(w).then(f),A.addEventListener("inputsourceschange",c))};var xt=new ot,At=new ot;this.getCamera=function(kt){Z.near=W.near=F.near=kt.near,Z.far=W.far=F.far=kt.far,(tt!==Z.near||st!==Z.far)&&(A.updateRenderState({depthNear:Z.near,depthFar:Z.far}),tt=Z.near,st=Z.far);var ne=kt.parent,Wt=Z.cameras;g(Z,ne);for(var re=0;re<Wt.length;re++)g(Wt[re],ne);for(kt.matrixWorld.copy(Z.matrixWorld),kt=kt.children,re=0,ne=kt.length;re<ne;re++)kt[re].updateMatrixWorld(!0);if(Wt.length===2){xt.setFromMatrixPosition(F.matrixWorld),At.setFromMatrixPosition(W.matrixWorld),Wt=xt.distanceTo(At);var be=F.projectionMatrix.elements,ce=W.projectionMatrix.elements,tr=be[14]/(be[10]-1);re=be[14]/(be[10]+1),kt=(be[9]+1)/be[5],ne=(be[9]-1)/be[5];var yr=(be[8]-1)/be[0],sr=(ce[8]+1)/ce[0];ce=tr*yr,be=tr*sr,sr=Wt/(-yr+sr),yr=sr*-yr,F.matrixWorld.decompose(Z.position,Z.quaternion,Z.scale),Z.translateX(yr),Z.translateZ(sr),Z.matrixWorld.compose(Z.position,Z.quaternion,Z.scale),Z.matrixWorldInverse.getInverse(Z.matrixWorld),tr+=sr,sr=re+sr,Z.projectionMatrix.makePerspective(ce-yr,be+(Wt-yr),kt*re/sr*tr,ne*re/sr*tr,tr,sr)}else Z.projectionMatrix.copy(F.projectionMatrix);return Z};var yt=null,Ut=new Ic;Ut.setAnimationLoop(function(kt,ne){if(I=ne.getViewerPose(N),I!==null){var Wt=I.views,re=A.renderState.baseLayer;t.setFramebuffer(re.framebuffer);var be=!1;Wt.length!==Z.cameras.length&&(Z.cameras.length=0,be=!0);for(var ce=0;ce<Wt.length;ce++){var tr=Wt[ce],yr=re.getViewport(tr),sr=X[ce];sr.matrix.fromArray(tr.transform.matrix),sr.projectionMatrix.fromArray(tr.projectionMatrix),sr.viewport.set(yr.x,yr.y,yr.width,yr.height),ce===0&&Z.matrix.copy(sr.matrix),be===!0&&Z.cameras.push(sr)}}for(Wt=A.inputSources,ce=0;ce<L.length;ce++)L[ce].update(Wt[ce],ne,N);yt&&yt(kt,ne)}),this.setAnimationLoop=function(kt){yt=kt},this.dispose=function(){}}function mo(t){function r(s,f,c){if(s.opacity.value=f.opacity,f.color&&s.diffuse.value.copy(f.color),f.emissive&&s.emissive.value.copy(f.emissive).multiplyScalar(f.emissiveIntensity),f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.specularMap&&(s.specularMap.value=f.specularMap),(c=f.envMap||c)&&(s.envMap.value=c,s.flipEnvMap.value=c.isCubeTexture?-1:1,s.reflectivity.value=f.reflectivity,s.refractionRatio.value=f.refractionRatio,s.maxMipLevel.value=t.get(c).__maxMipLevel),f.lightMap&&(s.lightMap.value=f.lightMap,s.lightMapIntensity.value=f.lightMapIntensity),f.aoMap&&(s.aoMap.value=f.aoMap,s.aoMapIntensity.value=f.aoMapIntensity),f.map)var g=f.map;else f.specularMap?g=f.specularMap:f.displacementMap?g=f.displacementMap:f.normalMap?g=f.normalMap:f.bumpMap?g=f.bumpMap:f.roughnessMap?g=f.roughnessMap:f.metalnessMap?g=f.metalnessMap:f.alphaMap?g=f.alphaMap:f.emissiveMap&&(g=f.emissiveMap);if(g!==void 0&&(g.isWebGLRenderTarget&&(g=g.texture),g.matrixAutoUpdate===!0&&g.updateMatrix(),s.uvTransform.value.copy(g.matrix)),f.aoMap)var p=f.aoMap;else f.lightMap&&(p=f.lightMap);p!==void 0&&(p.isWebGLRenderTarget&&(p=p.texture),p.matrixAutoUpdate===!0&&p.updateMatrix(),s.uv2Transform.value.copy(p.matrix))}function i(s,f,c){s.roughness.value=f.roughness,s.metalness.value=f.metalness,f.roughnessMap&&(s.roughnessMap.value=f.roughnessMap),f.metalnessMap&&(s.metalnessMap.value=f.metalnessMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),(f.envMap||c)&&(s.envMapIntensity.value=f.envMapIntensity)}return{refreshFogUniforms:function(s,f){s.fogColor.value.copy(f.color),f.isFog?(s.fogNear.value=f.near,s.fogFar.value=f.far):f.isFogExp2&&(s.fogDensity.value=f.density)},refreshMaterialUniforms:function(s,f,c,g,p){if(f.isMeshBasicMaterial)r(s,f);else if(f.isMeshLambertMaterial)r(s,f),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap);else if(f.isMeshToonMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.gradientMap&&(s.gradientMap.value=f.gradientMap),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshPhongMaterial)r(s,f),s.specular.value.copy(f.specular),s.shininess.value=Math.max(f.shininess,1e-4),f.emissiveMap&&(s.emissiveMap.value=f.emissiveMap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshStandardMaterial)r(s,f,c),f.isMeshPhysicalMaterial?(i(s,f,c),s.reflectivity.value=f.reflectivity,s.clearcoat.value=f.clearcoat,s.clearcoatRoughness.value=f.clearcoatRoughness,f.sheen&&s.sheen.value.copy(f.sheen),f.clearcoatMap&&(s.clearcoatMap.value=f.clearcoatMap),f.clearcoatRoughnessMap&&(s.clearcoatRoughnessMap.value=f.clearcoatRoughnessMap),f.clearcoatNormalMap&&(s.clearcoatNormalScale.value.copy(f.clearcoatNormalScale),s.clearcoatNormalMap.value=f.clearcoatNormalMap,f.side===1&&s.clearcoatNormalScale.value.negate()),s.transparency.value=f.transparency):i(s,f,c);else if(f.isMeshMatcapMaterial)r(s,f),f.matcap&&(s.matcap.value=f.matcap),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDepthMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isMeshDistanceMaterial)r(s,f),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias),s.referencePosition.value.copy(f.referencePosition),s.nearDistance.value=f.nearDistance,s.farDistance.value=f.farDistance;else if(f.isMeshNormalMaterial)r(s,f),f.bumpMap&&(s.bumpMap.value=f.bumpMap,s.bumpScale.value=f.bumpScale,f.side===1&&(s.bumpScale.value*=-1)),f.normalMap&&(s.normalMap.value=f.normalMap,s.normalScale.value.copy(f.normalScale),f.side===1&&s.normalScale.value.negate()),f.displacementMap&&(s.displacementMap.value=f.displacementMap,s.displacementScale.value=f.displacementScale,s.displacementBias.value=f.displacementBias);else if(f.isLineBasicMaterial)s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,f.isLineDashedMaterial&&(s.dashSize.value=f.dashSize,s.totalSize.value=f.dashSize+f.gapSize,s.scale.value=f.scale);else if(f.isPointsMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.size.value=f.size*g,s.scale.value=.5*p,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var A=f.map;else f.alphaMap&&(A=f.alphaMap);A!==void 0&&(A.matrixAutoUpdate===!0&&A.updateMatrix(),s.uvTransform.value.copy(A.matrix))}else if(f.isSpriteMaterial){if(s.diffuse.value.copy(f.color),s.opacity.value=f.opacity,s.rotation.value=f.rotation,f.map&&(s.map.value=f.map),f.alphaMap&&(s.alphaMap.value=f.alphaMap),f.map)var S=f.map;else f.alphaMap&&(S=f.alphaMap);S!==void 0&&(S.matrixAutoUpdate===!0&&S.updateMatrix(),s.uvTransform.value.copy(S.matrix))}else f.isShadowMaterial?(s.color.value.copy(f.color),s.opacity.value=f.opacity):f.isShaderMaterial&&(f.uniformsNeedUpdate=!1)}}}function vo(t){var r;function i(){ar=new gl(Ae),Wr=new Bg(Ae,ar,t),Wr.isWebGL2===!1&&(ar.get("WEBGL_depth_texture"),ar.get("OES_texture_float"),ar.get("OES_texture_half_float"),ar.get("OES_texture_half_float_linear"),ar.get("OES_standard_derivatives"),ar.get("OES_element_index_uint"),ar.get("ANGLE_instanced_arrays")),ar.get("OES_texture_float_linear"),es=new w0(Ae,ar,Wr),Ze=new Xx(Ae,ar,Wr),Ze.scissor(mt.copy(ft).multiplyScalar(ct).floor()),Ze.viewport(gt.copy(Qt).multiplyScalar(ct).floor()),Sn=new Qv(Ae),Ai=new Gx,Fo=new Yx(Ae,ar,Ze,Ai,Wr,es,Sn),Ta=new Ec(Ae,Wr),eh=new Kv(Ae,Ta,Sn),Ns=new pp(Ae,eh,Ta,Sn),hy=new $v(Ae),el=new kx(kt,ar,Wr),rl=new mo(Ai),vs=new Vx,iu=new jx,To=new Rc(kt,Ze,Ns,tt),cy=new Fg(Ae,ar,Sn,Wr),Sa=new xu(Ae,ar,Sn,Wr),Sn.programs=el.programs,kt.capabilities=Wr,kt.extensions=ar,kt.properties=Ai,kt.renderLists=vs,kt.state=Ze,kt.info=Sn}function s(Mt){Mt.preventDefault(),ne=!0}function f(){ne=!1,i()}function c(Mt){Mt=Mt.target,Mt.removeEventListener("dispose",c),g(Mt),Ai.remove(Mt)}function g(Mt){var we=Ai.get(Mt).program;Mt.program=void 0,we!==void 0&&el.releaseProgram(we)}function p(Mt,we){Mt.render(function(qt){kt.renderBufferImmediate(qt,we)})}function A(Mt,we,qt,Pe){if(Mt.visible!==!1){if(Mt.layers.test(we.layers)){if(Mt.isGroup)qt=Mt.renderOrder;else if(Mt.isLOD)Mt.autoUpdate===!0&&Mt.update(we);else if(Mt.isLight)Ut.pushLight(Mt),Mt.castShadow&&Ut.pushShadow(Mt);else if(Mt.isSprite){if(!Mt.frustumCulled||xe.intersectsSprite(Mt)){Pe&&Br.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(xr);var qe=Ns.update(Mt),ai=Mt.material;ai.visible&&yt.push(Mt,qe,ai,qt,Br.z,null)}}else if(Mt.isImmediateRenderObject)Pe&&Br.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(xr),yt.push(Mt,null,Mt.material,qt,Br.z,null);else if((Mt.isMesh||Mt.isLine||Mt.isPoints)&&(Mt.isSkinnedMesh&&Mt.skeleton.frame!==Sn.render.frame&&(Mt.skeleton.update(),Mt.skeleton.frame=Sn.render.frame),!Mt.frustumCulled||xe.intersectsObject(Mt)))if(Pe&&Br.setFromMatrixPosition(Mt.matrixWorld).applyMatrix4(xr),qe=Ns.update(Mt),ai=Mt.material,Array.isArray(ai))for(var hr=qe.groups,Hr=0,oi=hr.length;Hr<oi;Hr++){var Li=hr[Hr],wi=ai[Li.materialIndex];wi&&wi.visible&&yt.push(Mt,qe,wi,qt,Br.z,Li)}else ai.visible&&yt.push(Mt,qe,ai,qt,Br.z,null)}for(Mt=Mt.children,Hr=0,oi=Mt.length;Hr<oi;Hr++)A(Mt[Hr],we,qt,Pe)}}function S(Mt,we,qt,Pe){for(var qe=0,ai=Mt.length;qe<ai;qe++){var hr=Mt[qe],Hr=hr.object,oi=hr.geometry,Li=Pe===void 0?hr.material:Pe;if(hr=hr.group,qt.isArrayCamera){dt=qt;for(var wi=qt.cameras,Ia=0,an=wi.length;Ia<an;Ia++){var Gn=wi[Ia];Hr.layers.test(Gn.layers)&&(Ze.viewport(gt.copy(Gn.viewport)),Ut.setupLights(Gn),N(Hr,we,Gn,oi,Li,hr))}}else dt=null,N(Hr,we,qt,oi,Li,hr)}}function N(Mt,we,qt,Pe,qe,ai){if(Mt.onBeforeRender(kt,we,qt,Pe,qe,ai),Ut=iu.get(we,dt||qt),Mt.modelViewMatrix.multiplyMatrices(qt.matrixWorldInverse,Mt.matrixWorld),Mt.normalMatrix.getNormalMatrix(Mt.modelViewMatrix),Mt.isImmediateRenderObject){var hr=I(qt,we,qe,Mt);Ze.setMaterial(qe),sr=r=null,ni=!1,p(Mt,hr)}else kt.renderBufferDirect(qt,we,Pe,qe,Mt,ai);Mt.onAfterRender(kt,we,qt,Pe,qe,ai),Ut=iu.get(we,dt||qt)}function w(Mt,we,qt){var Pe=Ai.get(Mt),qe=Ut.state.lights,ai=qe.state.version;qt=el.getParameters(Mt,qe.state,Ut.state.shadowsArray,we,me.numPlanes,me.numIntersection,qt);var hr=el.getProgramCacheKey(qt),Hr=Pe.program,oi=!0;if(Hr===void 0)Mt.addEventListener("dispose",c);else if(Hr.cacheKey!==hr)g(Mt);else{if(Pe.lightsStateVersion!==ai)Pe.lightsStateVersion=ai;else if(qt.shaderID!==void 0)return;oi=!1}if(oi&&(Hr=el.acquireProgram(qt,hr),Pe.program=Hr,Pe.uniforms=qt.uniforms,Pe.outputEncoding=qt.outputEncoding,Mt.program=Hr),qt=Hr.getAttributes(),Mt.morphTargets)for(hr=Mt.numSupportedMorphTargets=0;hr<kt.maxMorphTargets;hr++)0<=qt["morphTarget"+hr]&&Mt.numSupportedMorphTargets++;if(Mt.morphNormals)for(hr=Mt.numSupportedMorphNormals=0;hr<kt.maxMorphNormals;hr++)0<=qt["morphNormal"+hr]&&Mt.numSupportedMorphNormals++;qt=Pe.uniforms,(!Mt.isShaderMaterial&&!Mt.isRawShaderMaterial||Mt.clipping===!0)&&(Pe.numClippingPlanes=me.numPlanes,Pe.numIntersection=me.numIntersection,qt.clippingPlanes=me.uniform),Pe.environment=Mt.isMeshStandardMaterial?we.environment:null,Pe.fog=we.fog,Pe.needsLights=Mt.isMeshLambertMaterial||Mt.isMeshToonMaterial||Mt.isMeshPhongMaterial||Mt.isMeshStandardMaterial||Mt.isShadowMaterial||Mt.isShaderMaterial&&Mt.lights===!0,Pe.lightsStateVersion=ai,Pe.needsLights&&(qt.ambientLightColor.value=qe.state.ambient,qt.lightProbe.value=qe.state.probe,qt.directionalLights.value=qe.state.directional,qt.directionalLightShadows.value=qe.state.directionalShadow,qt.spotLights.value=qe.state.spot,qt.spotLightShadows.value=qe.state.spotShadow,qt.rectAreaLights.value=qe.state.rectArea,qt.pointLights.value=qe.state.point,qt.pointLightShadows.value=qe.state.pointShadow,qt.hemisphereLights.value=qe.state.hemi,qt.directionalShadowMap.value=qe.state.directionalShadowMap,qt.directionalShadowMatrix.value=qe.state.directionalShadowMatrix,qt.spotShadowMap.value=qe.state.spotShadowMap,qt.spotShadowMatrix.value=qe.state.spotShadowMatrix,qt.pointShadowMap.value=qe.state.pointShadowMap,qt.pointShadowMatrix.value=qe.state.pointShadowMatrix),Mt=Pe.program.getUniforms(),Mt=ks.seqWithValue(Mt.seq,qt),Pe.uniformsList=Mt}function I(Mt,we,qt,Pe){Fo.resetTextureUnits();var qe=we.fog,ai=qt.isMeshStandardMaterial?we.environment:null,hr=ce===null?kt.outputEncoding:ce.texture.encoding,Hr=Ai.get(qt),oi=Ut.state.lights;le&&(Ce||Mt!==pr)&&me.setState(qt.clippingPlanes,qt.clipIntersection,qt.clipShadows,Mt,Hr,Mt===pr&&qt.id===yr),qt.version===Hr.__version?Hr.program===void 0||qt.fog&&Hr.fog!==qe||Hr.environment!==ai||Hr.needsLights&&Hr.lightsStateVersion!==oi.state.version?w(qt,we,Pe):Hr.numClippingPlanes===void 0||Hr.numClippingPlanes===me.numPlanes&&Hr.numIntersection===me.numIntersection?Hr.outputEncoding!==hr&&w(qt,we,Pe):w(qt,we,Pe):(w(qt,we,Pe),Hr.__version=qt.version);var Li=!1,wi=!1,Ia=!1;if(we=Hr.program,hr=we.getUniforms(),oi=Hr.uniforms,Ze.useProgram(we.program)&&(Ia=wi=Li=!0),qt.id!==yr&&(yr=qt.id,wi=!0),(Li||pr!==Mt)&&(hr.setValue(Ae,"projectionMatrix",Mt.projectionMatrix),Wr.logarithmicDepthBuffer&&hr.setValue(Ae,"logDepthBufFC",2/(Math.log(Mt.far+1)/Math.LN2)),pr!==Mt&&(pr=Mt,Ia=wi=!0),(qt.isShaderMaterial||qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshStandardMaterial||qt.envMap)&&(Li=hr.map.cameraPosition,Li!==void 0&&Li.setValue(Ae,Br.setFromMatrixPosition(Mt.matrixWorld))),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial)&&hr.setValue(Ae,"isOrthographic",Mt.isOrthographicCamera===!0),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial||qt.skinning)&&hr.setValue(Ae,"viewMatrix",Mt.matrixWorldInverse)),qt.skinning&&(hr.setOptional(Ae,Pe,"bindMatrix"),hr.setOptional(Ae,Pe,"bindMatrixInverse"),Mt=Pe.skeleton))if(Li=Mt.bones,Wr.floatVertexTextures){if(Mt.boneTexture===void 0){Li=Math.sqrt(4*Li.length),Li=Tr.ceilPowerOfTwo(Li),Li=Math.max(Li,4);var an=new Float32Array(Li*Li*4);an.set(Mt.boneMatrices);var Gn=new dl(an,Li,Li,1023,1015);Mt.boneMatrices=an,Mt.boneTexture=Gn,Mt.boneTextureSize=Li}hr.setValue(Ae,"boneTexture",Mt.boneTexture,Fo),hr.setValue(Ae,"boneTextureSize",Mt.boneTextureSize)}else hr.setOptional(Ae,Mt,"boneMatrices");return(wi||Hr.receiveShadow!==Pe.receiveShadow)&&(Hr.receiveShadow=Pe.receiveShadow,hr.setValue(Ae,"receiveShadow",Pe.receiveShadow)),wi&&(hr.setValue(Ae,"toneMappingExposure",kt.toneMappingExposure),hr.setValue(Ae,"toneMappingWhitePoint",kt.toneMappingWhitePoint),Hr.needsLights&&(wi=Ia,oi.ambientLightColor.needsUpdate=wi,oi.lightProbe.needsUpdate=wi,oi.directionalLights.needsUpdate=wi,oi.directionalLightShadows.needsUpdate=wi,oi.pointLights.needsUpdate=wi,oi.pointLightShadows.needsUpdate=wi,oi.spotLights.needsUpdate=wi,oi.spotLightShadows.needsUpdate=wi,oi.rectAreaLights.needsUpdate=wi,oi.hemisphereLights.needsUpdate=wi),qe&&qt.fog&&rl.refreshFogUniforms(oi,qe),rl.refreshMaterialUniforms(oi,qt,ai,ct,ht),oi.ltc_1!==void 0&&(oi.ltc_1.value=gr.LTC_1),oi.ltc_2!==void 0&&(oi.ltc_2.value=gr.LTC_2),ks.upload(Ae,Hr.uniformsList,oi,Fo)),qt.isShaderMaterial&&qt.uniformsNeedUpdate===!0&&(ks.upload(Ae,Hr.uniformsList,oi,Fo),qt.uniformsNeedUpdate=!1),qt.isSpriteMaterial&&hr.setValue(Ae,"center",Pe.center),hr.setValue(Ae,"modelViewMatrix",Pe.modelViewMatrix),hr.setValue(Ae,"normalMatrix",Pe.normalMatrix),hr.setValue(Ae,"modelMatrix",Pe.matrixWorld),we}t=t||{};var L=t.canvas!==void 0?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),P=t.context!==void 0?t.context:null,F=t.alpha!==void 0?t.alpha:!1,W=t.depth!==void 0?t.depth:!0,X=t.stencil!==void 0?t.stencil:!0,Z=t.antialias!==void 0?t.antialias:!1,tt=t.premultipliedAlpha!==void 0?t.premultipliedAlpha:!0,st=t.preserveDrawingBuffer!==void 0?t.preserveDrawingBuffer:!1,xt=t.powerPreference!==void 0?t.powerPreference:"default",At=t.failIfMajorPerformanceCaveat!==void 0?t.failIfMajorPerformanceCaveat:!1,yt=null,Ut=null;this.domElement=L,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var kt=this,ne=!1,Wt=null,re=0,be=0,ce=null,tr=null,yr=-1,sr=r=null,ni=!1,pr=null,dt=null,gt=new _t,mt=new _t,Tt=null,et=L.width,ht=L.height,ct=1,St=null,Gt=null,Qt=new _t(0,0,et,ht),ft=new _t(0,0,et,ht),ve=!1,xe=new yu,me=new qv,le=!1,Ce=!1,xr=new Ie,Br=new ot;try{F={alpha:F,depth:W,stencil:X,antialias:Z,premultipliedAlpha:tt,preserveDrawingBuffer:st,powerPreference:xt,failIfMajorPerformanceCaveat:At},L.addEventListener("webglcontextlost",s,!1),L.addEventListener("webglcontextrestored",f,!1);var Ae=P||L.getContext("webgl",F)||L.getContext("experimental-webgl",F);if(Ae===null)throw L.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");Ae.getShaderPrecisionFormat===void 0&&(Ae.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Mt){throw console.error("THREE.WebGLRenderer: "+Mt.message),Mt}var ar,Wr,Ze,Sn,Ai,Fo,Ta,eh,Ns,el,rl,vs,iu,To,hy,cy,Sa,es;i();var ys=new Vn(kt,Ae);this.xr=ys;var rh=new _p(kt,Ns,Wr.maxTextureSize);this.shadowMap=rh,this.getContext=function(){return Ae},this.getContextAttributes=function(){return Ae.getContextAttributes()},this.forceContextLoss=function(){var Mt=ar.get("WEBGL_lose_context");Mt&&Mt.loseContext()},this.forceContextRestore=function(){var Mt=ar.get("WEBGL_lose_context");Mt&&Mt.restoreContext()},this.getPixelRatio=function(){return ct},this.setPixelRatio=function(Mt){Mt!==void 0&&(ct=Mt,this.setSize(et,ht,!1))},this.getSize=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Mt=new vt),Mt.set(et,ht)},this.setSize=function(Mt,we,qt){ys.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(et=Mt,ht=we,L.width=Math.floor(Mt*ct),L.height=Math.floor(we*ct),qt!==!1&&(L.style.width=Mt+"px",L.style.height=we+"px"),this.setViewport(0,0,Mt,we))},this.getDrawingBufferSize=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Mt=new vt),Mt.set(et*ct,ht*ct).floor()},this.setDrawingBufferSize=function(Mt,we,qt){et=Mt,ht=we,ct=qt,L.width=Math.floor(Mt*qt),L.height=Math.floor(we*qt),this.setViewport(0,0,Mt,we)},this.getCurrentViewport=function(Mt){return Mt===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Mt=new _t),Mt.copy(gt)},this.getViewport=function(Mt){return Mt.copy(Qt)},this.setViewport=function(Mt,we,qt,Pe){Mt.isVector4?Qt.set(Mt.x,Mt.y,Mt.z,Mt.w):Qt.set(Mt,we,qt,Pe),Ze.viewport(gt.copy(Qt).multiplyScalar(ct).floor())},this.getScissor=function(Mt){return Mt.copy(ft)},this.setScissor=function(Mt,we,qt,Pe){Mt.isVector4?ft.set(Mt.x,Mt.y,Mt.z,Mt.w):ft.set(Mt,we,qt,Pe),Ze.scissor(mt.copy(ft).multiplyScalar(ct).floor())},this.getScissorTest=function(){return ve},this.setScissorTest=function(Mt){Ze.setScissorTest(ve=Mt)},this.setOpaqueSort=function(Mt){St=Mt},this.setTransparentSort=function(Mt){Gt=Mt},this.getClearColor=function(){return To.getClearColor()},this.setClearColor=function(){To.setClearColor.apply(To,arguments)},this.getClearAlpha=function(){return To.getClearAlpha()},this.setClearAlpha=function(){To.setClearAlpha.apply(To,arguments)},this.clear=function(Mt,we,qt){var Pe=0;(Mt===void 0||Mt)&&(Pe|=16384),(we===void 0||we)&&(Pe|=256),(qt===void 0||qt)&&(Pe|=1024),Ae.clear(Pe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){L.removeEventListener("webglcontextlost",s,!1),L.removeEventListener("webglcontextrestored",f,!1),vs.dispose(),iu.dispose(),Ai.dispose(),Ns.dispose(),ys.dispose(),Hf.stop()},this.renderBufferImmediate=function(Mt,we){Ze.initAttributes();var qt=Ai.get(Mt);Mt.hasPositions&&!qt.position&&(qt.position=Ae.createBuffer()),Mt.hasNormals&&!qt.normal&&(qt.normal=Ae.createBuffer()),Mt.hasUvs&&!qt.uv&&(qt.uv=Ae.createBuffer()),Mt.hasColors&&!qt.color&&(qt.color=Ae.createBuffer()),we=we.getAttributes(),Mt.hasPositions&&(Ae.bindBuffer(34962,qt.position),Ae.bufferData(34962,Mt.positionArray,35048),Ze.enableAttribute(we.position),Ae.vertexAttribPointer(we.position,3,5126,!1,0,0)),Mt.hasNormals&&(Ae.bindBuffer(34962,qt.normal),Ae.bufferData(34962,Mt.normalArray,35048),Ze.enableAttribute(we.normal),Ae.vertexAttribPointer(we.normal,3,5126,!1,0,0)),Mt.hasUvs&&(Ae.bindBuffer(34962,qt.uv),Ae.bufferData(34962,Mt.uvArray,35048),Ze.enableAttribute(we.uv),Ae.vertexAttribPointer(we.uv,2,5126,!1,0,0)),Mt.hasColors&&(Ae.bindBuffer(34962,qt.color),Ae.bufferData(34962,Mt.colorArray,35048),Ze.enableAttribute(we.color),Ae.vertexAttribPointer(we.color,3,5126,!1,0,0)),Ze.disableUnusedAttributes(),Ae.drawArrays(4,0,Mt.count),Mt.count=0};var zs=new Yr;this.renderBufferDirect=function(Mt,we,qt,Pe,qe,ai){we===null&&(we=zs);var hr=qe.isMesh&&0>qe.matrixWorld.determinant(),Hr=I(Mt,we,Pe,qe);Ze.setMaterial(Pe,hr);var oi=!1;if((r!==qt.id||sr!==Hr.id||ni!==(Pe.wireframe===!0))&&(r=qt.id,sr=Hr.id,ni=Pe.wireframe===!0,oi=!0),(Pe.morphTargets||Pe.morphNormals)&&(hy.update(qe,qt,Pe,Hr),oi=!0),qe.isInstancedMesh===!0&&(oi=!0),Mt=qt.index,we=qt.attributes.position,Mt===null){if(we===void 0||we.count===0)return}else if(Mt.count===0)return;var Li=1;if(Pe.wireframe===!0&&(Mt=eh.getWireframeAttribute(qt),Li=2),hr=cy,Mt!==null){var wi=Ta.get(Mt);hr=Sa,hr.setIndex(wi)}if(oi){if(Wr.isWebGL2!==!1||!qe.isInstancedMesh&&!qt.isInstancedBufferGeometry||ar.get("ANGLE_instanced_arrays")!==null){Ze.initAttributes(),oi=qt.attributes,Hr=Hr.getAttributes();var Ia=Pe.defaultAttributeValues;for(nh in Hr){var an=Hr[nh];if(0<=an){var Gn=oi[nh];if(Gn!==void 0){var nu=Gn.normalized,fy=Gn.itemSize,ta=Ta.get(Gn);if(ta!==void 0){var Ud=ta.buffer,ih=ta.type;if(ta=ta.bytesPerElement,Gn.isInterleavedBufferAttribute){var uc=Gn.data,a2=uc.stride;Gn=Gn.offset,uc&&uc.isInstancedInterleavedBuffer?(Ze.enableAttributeAndDivisor(an,uc.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=uc.meshPerAttribute*uc.count)):Ze.enableAttribute(an),Ae.bindBuffer(34962,Ud),Ze.vertexAttribPointer(an,fy,ih,nu,a2*ta,Gn*ta)}else Gn.isInstancedBufferAttribute?(Ze.enableAttributeAndDivisor(an,Gn.meshPerAttribute),qt._maxInstanceCount===void 0&&(qt._maxInstanceCount=Gn.meshPerAttribute*Gn.count)):Ze.enableAttribute(an),Ae.bindBuffer(34962,Ud),Ze.vertexAttribPointer(an,fy,ih,nu,0,0)}}else if(nh==="instanceMatrix")ta=Ta.get(qe.instanceMatrix),ta!==void 0&&(Ud=ta.buffer,ih=ta.type,Ze.enableAttributeAndDivisor(an+0,1),Ze.enableAttributeAndDivisor(an+1,1),Ze.enableAttributeAndDivisor(an+2,1),Ze.enableAttributeAndDivisor(an+3,1),Ae.bindBuffer(34962,Ud),Ae.vertexAttribPointer(an+0,4,ih,!1,64,0),Ae.vertexAttribPointer(an+1,4,ih,!1,64,16),Ae.vertexAttribPointer(an+2,4,ih,!1,64,32),Ae.vertexAttribPointer(an+3,4,ih,!1,64,48));else if(Ia!==void 0&&(nu=Ia[nh],nu!==void 0))switch(nu.length){case 2:Ae.vertexAttrib2fv(an,nu);break;case 3:Ae.vertexAttrib3fv(an,nu);break;case 4:Ae.vertexAttrib4fv(an,nu);break;default:Ae.vertexAttrib1fv(an,nu)}}}Ze.disableUnusedAttributes()}Mt!==null&&Ae.bindBuffer(34963,wi.buffer)}var nh=qt.drawRange.start*Li;oi=ai!==null?ai.start*Li:0,wi=Math.max(nh,oi),ai=Math.max(0,Math.min(Mt!==null?Mt.count:we.count,nh+qt.drawRange.count*Li,oi+(ai!==null?ai.count*Li:1/0))-1-wi+1),ai!==0&&(qe.isMesh?Pe.wireframe===!0?(Ze.setLineWidth(Pe.wireframeLinewidth*(ce===null?ct:1)),hr.setMode(1)):hr.setMode(4):qe.isLine?(Pe=Pe.linewidth,Pe===void 0&&(Pe=1),Ze.setLineWidth(Pe*(ce===null?ct:1)),qe.isLineSegments?hr.setMode(1):qe.isLineLoop?hr.setMode(2):hr.setMode(3)):qe.isPoints?hr.setMode(0):qe.isSprite&&hr.setMode(4),qe.isInstancedMesh?hr.renderInstances(qt,wi,ai,qe.count):qt.isInstancedBufferGeometry?hr.renderInstances(qt,wi,ai,Math.min(qt.instanceCount,qt._maxInstanceCount)):hr.render(wi,ai))},this.compile=function(Mt,we){Ut=iu.get(Mt,we),Ut.init(),Mt.traverse(function(Pe){Pe.isLight&&(Ut.pushLight(Pe),Pe.castShadow&&Ut.pushShadow(Pe))}),Ut.setupLights(we);var qt={};Mt.traverse(function(Pe){var qe=Pe.material;if(qe)if(Array.isArray(qe))for(var ai=0;ai<qe.length;ai++){var hr=qe[ai];!(hr.uuid in qt)&&(w(hr,Mt,Pe),qt[hr.uuid]=!0)}else!(qe.uuid in qt)&&(w(qe,Mt,Pe),qt[qe.uuid]=!0)})};var Bo=null,Hf=new Ic;Hf.setAnimationLoop(function(Mt){ys.isPresenting||Bo&&Bo(Mt)}),typeof window!="undefined"&&Hf.setContext(window),this.setAnimationLoop=function(Mt){Bo=Mt,ys.setAnimationLoop(Mt),Hf.start()},this.render=function(Mt,we,qt,Pe){if(qt!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var qe=qt}if(Pe!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var ai=Pe}we&&we.isCamera?ne||(sr=r=null,ni=!1,yr=-1,pr=null,Mt.autoUpdate===!0&&Mt.updateMatrixWorld(),we.parent===null&&we.updateMatrixWorld(),ys.enabled&&ys.isPresenting&&(we=ys.getCamera(we)),Mt.onBeforeRender(kt,Mt,we,qe||ce),Ut=iu.get(Mt,we),Ut.init(),xr.multiplyMatrices(we.projectionMatrix,we.matrixWorldInverse),xe.setFromProjectionMatrix(xr),Ce=this.localClippingEnabled,le=me.init(this.clippingPlanes,Ce,we),yt=vs.get(Mt,we),yt.init(),A(Mt,we,0,kt.sortObjects),yt.finish(),kt.sortObjects===!0&&yt.sort(St,Gt),le&&me.beginShadows(),rh.render(Ut.state.shadowsArray,Mt,we),Ut.setupLights(we),le&&me.endShadows(),this.info.autoReset&&this.info.reset(),qe!==void 0&&this.setRenderTarget(qe),To.render(yt,Mt,we,ai),qt=yt.opaque,Pe=yt.transparent,Mt.overrideMaterial?(qe=Mt.overrideMaterial,qt.length&&S(qt,Mt,we,qe),Pe.length&&S(Pe,Mt,we,qe)):(qt.length&&S(qt,Mt,we),Pe.length&&S(Pe,Mt,we)),Mt.onAfterRender(kt,Mt,we),ce!==null&&(Fo.updateRenderTargetMipmap(ce),Fo.updateMultisampleRenderTarget(ce)),Ze.buffers.depth.setTest(!0),Ze.buffers.depth.setMask(!0),Ze.buffers.color.setMask(!0),Ze.setPolygonOffset(!1),Ut=yt=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(Mt){Wt!==Mt&&ce===null&&Ae.bindFramebuffer(36160,Mt),Wt=Mt},this.getActiveCubeFace=function(){return re},this.getActiveMipmapLevel=function(){return be},this.getRenderTarget=function(){return ce},this.setRenderTarget=function(Mt,we,qt){ce=Mt,re=we,be=qt,Mt&&Ai.get(Mt).__webglFramebuffer===void 0&&Fo.setupRenderTarget(Mt);var Pe=Wt,qe=!1;Mt?(Pe=Ai.get(Mt).__webglFramebuffer,Mt.isWebGLCubeRenderTarget?(Pe=Pe[we||0],qe=!0):Pe=Mt.isWebGLMultisampleRenderTarget?Ai.get(Mt).__webglMultisampledFramebuffer:Pe,gt.copy(Mt.viewport),mt.copy(Mt.scissor),Tt=Mt.scissorTest):(gt.copy(Qt).multiplyScalar(ct).floor(),mt.copy(ft).multiplyScalar(ct).floor(),Tt=ve),tr!==Pe&&(Ae.bindFramebuffer(36160,Pe),tr=Pe),Ze.viewport(gt),Ze.scissor(mt),Ze.setScissorTest(Tt),qe&&(Mt=Ai.get(Mt.texture),Ae.framebufferTexture2D(36160,36064,34069+(we||0),Mt.__webglTexture,qt||0))},this.readRenderTargetPixels=function(Mt,we,qt,Pe,qe,ai,hr){if(Mt&&Mt.isWebGLRenderTarget){var Hr=Ai.get(Mt).__webglFramebuffer;if(Mt.isWebGLCubeRenderTarget&&hr!==void 0&&(Hr=Hr[hr]),Hr){hr=!1,Hr!==tr&&(Ae.bindFramebuffer(36160,Hr),hr=!0);try{var oi=Mt.texture,Li=oi.format,wi=oi.type;Li!==1023&&es.convert(Li)!==Ae.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):wi===1009||es.convert(wi)===Ae.getParameter(35738)||wi===1015&&(Wr.isWebGL2||ar.get("OES_texture_float")||ar.get("WEBGL_color_buffer_float"))||wi===1016&&(Wr.isWebGL2?ar.get("EXT_color_buffer_float"):ar.get("EXT_color_buffer_half_float"))?Ae.checkFramebufferStatus(36160)===36053?0<=we&&we<=Mt.width-Pe&&0<=qt&&qt<=Mt.height-qe&&Ae.readPixels(we,qt,Pe,qe,es.convert(Li),es.convert(wi),ai):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{hr&&Ae.bindFramebuffer(36160,tr)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(Mt,we,qt){qt===void 0&&(qt=0);var Pe=Math.pow(2,-qt),qe=Math.floor(we.image.width*Pe);Pe=Math.floor(we.image.height*Pe);var ai=es.convert(we.format);Fo.setTexture2D(we,0),Ae.copyTexImage2D(3553,qt,ai,Mt.x,Mt.y,qe,Pe,0),Ze.unbindTexture()},this.copyTextureToTexture=function(Mt,we,qt,Pe){Pe===void 0&&(Pe=0);var qe=we.image.width,ai=we.image.height,hr=es.convert(qt.format),Hr=es.convert(qt.type);Fo.setTexture2D(qt,0),we.isDataTexture?Ae.texSubImage2D(3553,Pe,Mt.x,Mt.y,qe,ai,hr,Hr,we.image.data):we.isCompressedTexture?Ae.compressedTexSubImage2D(3553,Pe,Mt.x,Mt.y,we.mipmaps[0].width,we.mipmaps[0].height,hr,we.mipmaps[0].data):Ae.texSubImage2D(3553,Pe,Mt.x,Mt.y,hr,Hr,we.image),Pe===0&&qt.generateMipmaps&&Ae.generateMipmap(3553),Ze.unbindTexture()},this.initTexture=function(Mt){Fo.setTexture2D(Mt,0),Ze.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function fa(t,r){this.name="",this.color=new Vt(t),this.density=r!==void 0?r:25e-5}function ko(t,r,i){this.name="",this.color=new Vt(t),this.near=r!==void 0?r:1,this.far=i!==void 0?i:1e3}function Go(t,r){this.array=t,this.stride=r,this.count=t!==void 0?t.length/r:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function _u(t,r,i,s){this.name="",this.data=t,this.itemSize=r,this.offset=i,this.normalized=s===!0}function wu(t){de.call(this),this.type="SpriteMaterial",this.color=new Vt(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(t)}function xl(t){if(Ee.call(this),this.type="Sprite",Rd===void 0){Rd=new We;var r=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);r=new Go(r,5),Rd.setIndex([0,1,2,0,2,3]),Rd.setAttribute("position",new _u(r,3,0,!1)),Rd.setAttribute("uv",new _u(r,2,3,!1))}this.geometry=Rd,this.material=t!==void 0?t:new wu,this.center=new vt(.5,.5)}function wp(t,r,i,s,f,c){Od.subVectors(t,i).addScalar(.5).multiply(s),f!==void 0?(Vm.x=c*Od.x-f*Od.y,Vm.y=f*Od.x+c*Od.y):Vm.copy(Od),t.copy(r),t.x+=Vm.x,t.y+=Vm.y,t.applyMatrix4(F_)}function yo(){Ee.call(this),this._currentLevel=0,this.type="LOD",Gr(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function Gs(t,r){t&&t.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),Wi.call(this,t,r),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ie,this.bindMatrixInverse=new Ie}function Cs(t,r){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,r===void 0)this.calculateInverses();else if(this.bones.length===r.length)this.boneInverses=r.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],t=0,r=this.bones.length;t<r;t++)this.boneInverses.push(new Ie)}function Kn(){Ee.call(this),this.type="Bone"}function Er(t,r,i){Wi.call(this,t,r),this.instanceMatrix=new He(new Float32Array(16*i),16),this.count=i,this.frustumCulled=!1}function Xi(t){de.call(this),this.type="LineBasicMaterial",this.color=new Vt(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(t)}function as(t,r,i){i===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),Ee.call(this),this.type="Line",this.geometry=t!==void 0?t:new We,this.material=r!==void 0?r:new Xi,this.updateMorphTargets()}function pn(t,r){as.call(this,t,r),this.type="LineSegments"}function dn(t,r){as.call(this,t,r),this.type="LineLoop"}function us(t){de.call(this),this.type="PointsMaterial",this.color=new Vt(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(t)}function Ba(t,r){Ee.call(this),this.type="Points",this.geometry=t!==void 0?t:new We,this.material=r!==void 0?r:new us,this.updateMorphTargets()}function _h(t,r,i,s,f,c,g){var p=GA.distanceSqToPoint(t);p<i&&(i=new ot,GA.closestPointToPoint(t,i),i.applyMatrix4(s),t=f.ray.origin.distanceTo(i),t<f.near||t>f.far||c.push({distance:t,distanceToRay:Math.sqrt(p),point:i,index:r,face:null,object:g}))}function M0(t,r,i,s,f,c,g,p,A){Lt.call(this,t,r,i,s,f,c,g,p,A),this.format=g!==void 0?g:1022,this.minFilter=c!==void 0?c:1006,this.magFilter=f!==void 0?f:1006,this.generateMipmaps=!1}function Nc(t,r,i,s,f,c,g,p,A,S,N,w){Lt.call(this,null,c,g,p,A,S,s,f,N,w),this.image={width:r,height:i},this.mipmaps=t,this.generateMipmaps=this.flipY=!1}function Mp(t,r,i,s,f,c,g,p,A){Lt.call(this,t,r,i,s,f,c,g,p,A),this.needsUpdate=!0}function Nr(t,r,i,s,f,c,g,p,A,S){if(S=S!==void 0?S:1026,S!==1026&&S!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&S===1026&&(i=1012),i===void 0&&S===1027&&(i=1020),Lt.call(this,null,s,f,c,g,p,S,i,A),this.image={width:t,height:r},this.magFilter=g!==void 0?g:1003,this.minFilter=p!==void 0?p:1003,this.generateMipmaps=this.flipY=!1}function zc(t){We.call(this),this.type="WireframeGeometry";var r=[],i,s,f,c=[0,0],g={},p=["a","b","c"];if(t&&t.isGeometry){var A=t.faces,S=0;for(s=A.length;S<s;S++){var N=A[S];for(i=0;3>i;i++){var w=N[p[i]],I=N[p[(i+1)%3]];c[0]=Math.min(w,I),c[1]=Math.max(w,I),w=c[0]+","+c[1],g[w]===void 0&&(g[w]={index1:c[0],index2:c[1]})}}for(w in g)S=g[w],p=t.vertices[S.index1],r.push(p.x,p.y,p.z),p=t.vertices[S.index2],r.push(p.x,p.y,p.z)}else if(t&&t.isBufferGeometry)if(p=new ot,t.index!==null){A=t.attributes.position,N=t.index;var L=t.groups;for(L.length===0&&(L=[{start:0,count:N.count,materialIndex:0}]),t=0,f=L.length;t<f;++t)for(S=L[t],i=S.start,s=S.count,S=i,s=i+s;S<s;S+=3)for(i=0;3>i;i++)w=N.getX(S+i),I=N.getX(S+(i+1)%3),c[0]=Math.min(w,I),c[1]=Math.max(w,I),w=c[0]+","+c[1],g[w]===void 0&&(g[w]={index1:c[0],index2:c[1]});for(w in g)S=g[w],p.fromBufferAttribute(A,S.index1),r.push(p.x,p.y,p.z),p.fromBufferAttribute(A,S.index2),r.push(p.x,p.y,p.z)}else for(A=t.attributes.position,S=0,s=A.count/3;S<s;S++)for(i=0;3>i;i++)g=3*S+i,p.fromBufferAttribute(A,g),r.push(p.x,p.y,p.z),g=3*S+(i+1)%3,p.fromBufferAttribute(A,g),r.push(p.x,p.y,p.z);this.setAttribute("position",new Ge(r,3))}function Cp(t,r,i){Fr.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:r,stacks:i},this.fromBufferGeometry(new wh(t,r,i)),this.mergeVertices()}function wh(t,r,i){We.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:r,stacks:i};var s=[],f=[],c=[],g=[],p=new ot,A=new ot,S=new ot,N=new ot,w=new ot,I,L;3>t.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var P=r+1;for(I=0;I<=i;I++){var F=I/i;for(L=0;L<=r;L++){var W=L/r;t(W,F,A),f.push(A.x,A.y,A.z),0<=W-1e-5?(t(W-1e-5,F,S),N.subVectors(A,S)):(t(W+1e-5,F,S),N.subVectors(S,A)),0<=F-1e-5?(t(W,F-1e-5,S),w.subVectors(A,S)):(t(W,F+1e-5,S),w.subVectors(S,A)),p.crossVectors(N,w).normalize(),c.push(p.x,p.y,p.z),g.push(W,F)}}for(I=0;I<i;I++)for(L=0;L<r;L++)t=I*P+L+1,p=(I+1)*P+L+1,A=(I+1)*P+L,s.push(I*P+L,t,A),s.push(t,p,A);this.setIndex(s),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(g,2))}function Tp(t,r,i,s){Fr.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},this.fromBufferGeometry(new ao(t,r,i,s)),this.mergeVertices()}function ao(t,r,i,s){function f(S){p.push(S.x,S.y,S.z)}function c(S,N){S*=3,N.x=t[S+0],N.y=t[S+1],N.z=t[S+2]}function g(S,N,w,I){0>I&&S.x===1&&(A[N]=S.x-1),w.x===0&&w.z===0&&(A[N]=I/2/Math.PI+.5)}We.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:r,radius:i,detail:s},i=i||1,s=s||0;var p=[],A=[];(function(S){for(var N=new ot,w=new ot,I=new ot,L=0;L<r.length;L+=3){c(r[L+0],N),c(r[L+1],w),c(r[L+2],I);var P,F,W=N,X=w,Z=I,tt=Math.pow(2,S),st=[];for(F=0;F<=tt;F++){st[F]=[];var xt=W.clone().lerp(Z,F/tt),At=X.clone().lerp(Z,F/tt),yt=tt-F;for(P=0;P<=yt;P++)st[F][P]=P===0&&F===tt?xt:xt.clone().lerp(At,P/yt)}for(F=0;F<tt;F++)for(P=0;P<2*(tt-F)-1;P++)W=Math.floor(P/2),P%2===0?(f(st[F][W+1]),f(st[F+1][W]),f(st[F][W])):(f(st[F][W+1]),f(st[F+1][W+1]),f(st[F+1][W]))}})(s),function(S){for(var N=new ot,w=0;w<p.length;w+=3)N.x=p[w+0],N.y=p[w+1],N.z=p[w+2],N.normalize().multiplyScalar(S),p[w+0]=N.x,p[w+1]=N.y,p[w+2]=N.z}(i),function(){for(var S=new ot,N=0;N<p.length;N+=3)S.x=p[N+0],S.y=p[N+1],S.z=p[N+2],A.push(Math.atan2(S.z,-S.x)/2/Math.PI+.5,1-(Math.atan2(-S.y,Math.sqrt(S.x*S.x+S.z*S.z))/Math.PI+.5));S=new ot,N=new ot;for(var w=new ot,I=new ot,L=new vt,P=new vt,F=new vt,W=0,X=0;W<p.length;W+=9,X+=6){S.set(p[W+0],p[W+1],p[W+2]),N.set(p[W+3],p[W+4],p[W+5]),w.set(p[W+6],p[W+7],p[W+8]),L.set(A[X+0],A[X+1]),P.set(A[X+2],A[X+3]),F.set(A[X+4],A[X+5]),I.copy(S).add(N).add(w).divideScalar(3);var Z=Math.atan2(I.z,-I.x);g(L,X+0,S,Z),g(P,X+2,N,Z),g(F,X+4,w,Z)}for(S=0;S<A.length;S+=6)N=A[S+0],w=A[S+2],I=A[S+4],L=Math.min(N,w,I),.9<Math.max(N,w,I)&&.1>L&&(.2>N&&(A[S+0]+=1),.2>w&&(A[S+2]+=1),.2>I&&(A[S+4]+=1))}(),this.setAttribute("position",new Ge(p,3)),this.setAttribute("normal",new Ge(p.slice(),3)),this.setAttribute("uv",new Ge(A,2)),s===0?this.computeVertexNormals():this.normalizeNormals()}function fr(t,r){Fr.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Uc(t,r)),this.mergeVertices()}function Uc(t,r){ao.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,r),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:r}}function Sp(t,r){Fr.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new bo(t,r)),this.mergeVertices()}function bo(t,r){ao.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,r),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:r}}function gn(t,r){Fr.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Hc(t,r)),this.mergeVertices()}function Hc(t,r){var i=(1+Math.sqrt(5))/2;ao.call(this,[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,r),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:r}}function Qe(t,r){Fr.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:r},this.fromBufferGeometry(new Vo(t,r)),this.mergeVertices()}function Vo(t,r){var i=(1+Math.sqrt(5))/2,s=1/i;ao.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-s,-i,0,-s,i,0,s,-i,0,s,i,-s,-i,0,-s,i,0,s,-i,0,s,i,0,-i,0,-s,i,0,-s,-i,0,s,i,0,s],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,r),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:r}}function Ip(t,r,i,s,f,c){Fr.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},c!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),t=new Al(t,r,i,s,f),this.tangents=t.tangents,this.normals=t.normals,this.binormals=t.binormals,this.fromBufferGeometry(t),this.mergeVertices()}function Al(t,r,i,s,f){function c(X){N=t.getPointAt(X/r,N);var Z=g.normals[X];for(X=g.binormals[X],I=0;I<=s;I++){var tt=I/s*Math.PI*2,st=Math.sin(tt);tt=-Math.cos(tt),A.x=tt*Z.x+st*X.x,A.y=tt*Z.y+st*X.y,A.z=tt*Z.z+st*X.z,A.normalize(),P.push(A.x,A.y,A.z),p.x=N.x+i*A.x,p.y=N.y+i*A.y,p.z=N.z+i*A.z,L.push(p.x,p.y,p.z)}}We.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:r,radius:i,radialSegments:s,closed:f},r=r||64,i=i||1,s=s||8,f=f||!1;var g=t.computeFrenetFrames(r,f);this.tangents=g.tangents,this.normals=g.normals,this.binormals=g.binormals;var p=new ot,A=new ot,S=new vt,N=new ot,w,I,L=[],P=[],F=[],W=[];for(w=0;w<r;w++)c(w);for(c(f===!1?r:0),w=0;w<=r;w++)for(I=0;I<=s;I++)S.x=w/r,S.y=I/s,F.push(S.x,S.y);(function(){for(I=1;I<=r;I++)for(w=1;w<=s;w++){var X=(s+1)*I+(w-1),Z=(s+1)*I+w,tt=(s+1)*(I-1)+w;W.push((s+1)*(I-1)+(w-1),X,tt),W.push(X,Z,tt)}})(),this.setIndex(W),this.setAttribute("position",new Ge(L,3)),this.setAttribute("normal",new Ge(P,3)),this.setAttribute("uv",new Ge(F,2))}function Mh(t,r,i,s,f,c,g){Fr.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},g!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new kc(t,r,i,s,f,c)),this.mergeVertices()}function kc(t,r,i,s,f,c){function g(At,yt,Ut,kt,ne){var Wt=Math.sin(At);yt=Ut/yt*At,Ut=Math.cos(yt),ne.x=kt*(2+Ut)*.5*Math.cos(At),ne.y=kt*(2+Ut)*Wt*.5,ne.z=kt*Math.sin(yt)*.5}We.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:r,tubularSegments:i,radialSegments:s,p:f,q:c},t=t||1,r=r||.4,i=Math.floor(i)||64,s=Math.floor(s)||8,f=f||2,c=c||3;var p=[],A=[],S=[],N=[],w,I=new ot,L=new ot,P=new ot,F=new ot,W=new ot,X=new ot,Z=new ot;for(w=0;w<=i;++w){var tt=w/i*f*Math.PI*2;for(g(tt,f,c,t,P),g(tt+.01,f,c,t,F),X.subVectors(F,P),Z.addVectors(F,P),W.crossVectors(X,Z),Z.crossVectors(W,X),W.normalize(),Z.normalize(),tt=0;tt<=s;++tt){var st=tt/s*Math.PI*2,xt=-r*Math.cos(st);st=r*Math.sin(st),I.x=P.x+(xt*Z.x+st*W.x),I.y=P.y+(xt*Z.y+st*W.y),I.z=P.z+(xt*Z.z+st*W.z),A.push(I.x,I.y,I.z),L.subVectors(I,P).normalize(),S.push(L.x,L.y,L.z),N.push(w/i),N.push(tt/s)}}for(tt=1;tt<=i;tt++)for(w=1;w<=s;w++)t=(s+1)*tt+(w-1),r=(s+1)*tt+w,f=(s+1)*(tt-1)+w,p.push((s+1)*(tt-1)+(w-1),t,f),p.push(t,r,f);this.setIndex(p),this.setAttribute("position",new Ge(A,3)),this.setAttribute("normal",new Ge(S,3)),this.setAttribute("uv",new Ge(N,2))}function Ch(t,r,i,s,f){Fr.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},this.fromBufferGeometry(new Mu(t,r,i,s,f)),this.mergeVertices()}function Mu(t,r,i,s,f){We.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:r,radialSegments:i,tubularSegments:s,arc:f},t=t||1,r=r||.4,i=Math.floor(i)||8,s=Math.floor(s)||6,f=f||2*Math.PI;var c=[],g=[],p=[],A=[],S=new ot,N=new ot,w=new ot,I,L;for(I=0;I<=i;I++)for(L=0;L<=s;L++){var P=L/s*f,F=I/i*Math.PI*2;N.x=(t+r*Math.cos(F))*Math.cos(P),N.y=(t+r*Math.cos(F))*Math.sin(P),N.z=r*Math.sin(F),g.push(N.x,N.y,N.z),S.x=t*Math.cos(P),S.y=t*Math.sin(P),w.subVectors(N,S).normalize(),p.push(w.x,w.y,w.z),A.push(L/s),A.push(I/i)}for(I=1;I<=i;I++)for(L=1;L<=s;L++)t=(s+1)*(I-1)+L-1,r=(s+1)*(I-1)+L,f=(s+1)*I+L,c.push((s+1)*I+L-1,t,f),c.push(t,r,f);this.setIndex(c),this.setAttribute("position",new Ge(g,3)),this.setAttribute("normal",new Ge(p,3)),this.setAttribute("uv",new Ge(A,2))}function Na(t,r,i,s,f){for(var c,g=0,p=r,A=i-s;p<i;p+=s)g+=(t[A]-t[p])*(t[p+1]+t[A+1]),A=p;if(f===0<g)for(f=r;f<i;f+=s)c=Lp(f,t[f],t[f+1],c);else for(f=i-s;f>=r;f-=s)c=Lp(f,t[f],t[f+1],c);return c&&Th(c,c.next)&&(Ih(c),c=c.next),c}function rn(t,r){if(!t)return t;r||(r=t);do{var i=!1;if(t.steiner||!Th(t,t.next)&&mn(t.prev,t,t.next)!==0)t=t.next;else{if(Ih(t),t=r=t.prev,t===t.next)break;i=!0}}while(i||t!==r);return r}function Gc(t,r,i,s,f,c,g){if(t){if(!g&&c){var p=t,A=p;do A.z===null&&(A.z=Gg(A.x,A.y,s,f,c)),A.prevZ=A.prev,A=A.nextZ=A.next;while(A!==p);A.prevZ.nextZ=null,A.prevZ=null,p=A;var S,N,w,I,L=1;do{A=p;var P=p=null;for(N=0;A;){N++;var F=A;for(S=w=0;S<L&&(w++,F=F.nextZ,F);S++);for(I=L;0<w||0<I&&F;)w!==0&&(I===0||!F||A.z<=F.z)?(S=A,A=A.nextZ,w--):(S=F,F=F.nextZ,I--),P?P.nextZ=S:p=S,S.prevZ=P,P=S;A=F}P.nextZ=null,L*=2}while(1<N)}for(p=t;t.prev!==t.next;){if(A=t.prev,F=t.next,c)P=C0(t,s,f,c);else t:if(P=t,N=P.prev,w=P,L=P.next,0<=mn(N,w,L))P=!1;else{for(S=P.next.next;S!==P.prev;){if(Cu(N.x,N.y,w.x,w.y,L.x,L.y,S.x,S.y)&&0<=mn(S.prev,S,S.next)){P=!1;break t}S=S.next}P=!0}if(P)r.push(A.i/i),r.push(t.i/i),r.push(F.i/i),Ih(t),p=t=F.next;else if(t=F,t===p){if(!g)Gc(rn(t),r,i,s,f,c,1);else if(g===1){t=rn(t),g=r,p=i,A=t;do F=A.prev,P=A.next.next,!Th(F,P)&&S0(F,A,A.next,P)&&Sh(F,P)&&Sh(P,F)&&(g.push(F.i/p),g.push(A.i/p),g.push(P.i/p),Ih(A),Ih(A.next),A=t=P),A=A.next;while(A!==t);t=rn(A),Gc(t,r,i,s,f,c,2)}else if(g===2)t:{g=t;do{for(p=g.next.next;p!==g.prev;){if(A=g.i!==p.i){if(A=g,F=p,P=A.next.i!==F.i&&A.prev.i!==F.i){e:{P=A;do{if(P.i!==A.i&&P.next.i!==A.i&&P.i!==F.i&&P.next.i!==F.i&&S0(P,P.next,A,F)){P=!0;break e}P=P.next}while(P!==A);P=!1}P=!P}if(P){if(P=Sh(A,F)&&Sh(F,A)){P=A,N=!1,w=(A.x+F.x)/2,L=(A.y+F.y)/2;do P.y>L!=P.next.y>L&&P.next.y!==P.y&&w<(P.next.x-P.x)*(L-P.y)/(P.next.y-P.y)+P.x&&(N=!N),P=P.next;while(P!==A);P=N}P=P&&(mn(A.prev,A,F.prev)||mn(A,F.prev,F))||Th(A,F)&&0<mn(A.prev,A,A.next)&&0<mn(F.prev,F,F.next)}A=P}if(A){t=Ep(g,p),g=rn(g,g.next),t=rn(t,t.next),Gc(g,r,i,s,f,c),Gc(t,r,i,s,f,c);break t}p=p.next}g=g.next}while(g!==t)}break}}}}function C0(t,r,i,s){var f=t.prev,c=t.next;if(0<=mn(f,t,c))return!1;var g=f.x>t.x?f.x>c.x?f.x:c.x:t.x>c.x?t.x:c.x,p=f.y>t.y?f.y>c.y?f.y:c.y:t.y>c.y?t.y:c.y,A=Gg(f.x<t.x?f.x<c.x?f.x:c.x:t.x<c.x?t.x:c.x,f.y<t.y?f.y<c.y?f.y:c.y:t.y<c.y?t.y:c.y,r,i,s);for(r=Gg(g,p,r,i,s),i=t.prevZ,s=t.nextZ;i&&i.z>=A&&s&&s.z<=r;){if(i!==t.prev&&i!==t.next&&Cu(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=mn(i.prev,i,i.next)||(i=i.prevZ,s!==t.prev&&s!==t.next&&Cu(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=mn(s.prev,s,s.next)))return!1;s=s.nextZ}for(;i&&i.z>=A;){if(i!==t.prev&&i!==t.next&&Cu(f.x,f.y,t.x,t.y,c.x,c.y,i.x,i.y)&&0<=mn(i.prev,i,i.next))return!1;i=i.prevZ}for(;s&&s.z<=r;){if(s!==t.prev&&s!==t.next&&Cu(f.x,f.y,t.x,t.y,c.x,c.y,s.x,s.y)&&0<=mn(s.prev,s,s.next))return!1;s=s.nextZ}return!0}function _l(t,r){return t.x-r.x}function T0(t,r){var i=r,s=t.x,f=t.y,c=-1/0;do{if(f<=i.y&&f>=i.next.y&&i.next.y!==i.y){var g=i.x+(f-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(g<=s&&g>c){if(c=g,g===s){if(f===i.y)return i;if(f===i.next.y)return i.next}var p=i.x<i.next.x?i:i.next}}i=i.next}while(i!==r);if(!p)return null;if(s===c)return p;r=p,g=p.x;var A=p.y,S=1/0;i=p;do{if(s>=i.x&&i.x>=g&&s!==i.x&&Cu(f<A?s:c,f,g,A,f<A?c:s,f,i.x,i.y)){var N=Math.abs(f-i.y)/(s-i.x),w;if((w=Sh(i,t))&&!(w=N<S)&&(w=N===S)&&!(w=i.x>p.x)&&(w=i.x===p.x)){w=p;var I=i;w=0>mn(w.prev,w,I.prev)&&0>mn(I.next,w,w.next)}w&&(p=i,S=N)}i=i.next}while(i!==r);return p}function Gg(t,r,i,s,f){return t=32767*(t-i)*f,r=32767*(r-s)*f,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,(t|t<<1)&1431655765|((r|r<<1)&1431655765)<<1}function bg(t){var r=t,i=t;do(r.x<i.x||r.x===i.x&&r.y<i.y)&&(i=r),r=r.next;while(r!==t);return i}function Cu(t,r,i,s,f,c,g,p){return 0<=(f-g)*(r-p)-(t-g)*(c-p)&&0<=(t-g)*(s-p)-(i-g)*(r-p)&&0<=(i-g)*(c-p)-(f-g)*(s-p)}function mn(t,r,i){return(r.y-t.y)*(i.x-r.x)-(r.x-t.x)*(i.y-r.y)}function Th(t,r){return t.x===r.x&&t.y===r.y}function S0(t,r,i,s){var f=bc(mn(t,r,i)),c=bc(mn(t,r,s)),g=bc(mn(i,s,t)),p=bc(mn(i,s,r));return!!(f!==c&&g!==p||f===0&&bs(t,i,r)||c===0&&bs(t,s,r)||g===0&&bs(i,t,s)||p===0&&bs(i,r,s))}function bs(t,r,i){return r.x<=Math.max(t.x,i.x)&&r.x>=Math.min(t.x,i.x)&&r.y<=Math.max(t.y,i.y)&&r.y>=Math.min(t.y,i.y)}function bc(t){return 0<t?1:0>t?-1:0}function Sh(t,r){return 0>mn(t.prev,t,t.next)?0<=mn(t,r,t.next)&&0<=mn(t,t.prev,r):0>mn(t,r,t.prev)||0>mn(t,t.next,r)}function Ep(t,r){var i=new Vc(t.i,t.x,t.y),s=new Vc(r.i,r.x,r.y),f=t.next,c=r.prev;return t.next=r,r.prev=t,i.next=f,f.prev=i,s.next=i,i.prev=s,c.next=s,s.prev=c,s}function Lp(t,r,i,s){return t=new Vc(t,r,i),s?(t.next=s.next,t.prev=s,s.next.prev=t,s.next=t):(t.prev=t,t.next=t),t}function Ih(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Vc(t,r,i){this.i=t,this.x=r,this.y=i,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Wc(t){var r=t.length;2<r&&t[r-1].equals(t[0])&&t.pop()}function I0(t,r){for(var i=0;i<r.length;i++)t.push(r[i].x),t.push(r[i].y)}function pa(t,r){Fr.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:r},this.fromBufferGeometry(new Ts(t,r)),this.mergeVertices()}function Ts(t,r){function i(A){function S(le,Ce,xr){return Ce||console.error("THREE.ExtrudeGeometry: vec does not exist"),Ce.clone().multiplyScalar(xr).add(le)}function N(le,Ce,xr){var Br=le.x-Ce.x,Ae=le.y-Ce.y,ar=xr.x-le.x,Wr=xr.y-le.y,Ze=Br*Br+Ae*Ae;if(Math.abs(Br*Wr-Ae*ar)>hn){var Sn=Math.sqrt(Ze),Ai=Math.sqrt(ar*ar+Wr*Wr);if(Ze=Ce.x-Ae/Sn,Ce=Ce.y+Br/Sn,Wr=((xr.x-Wr/Ai-Ze)*Wr-(xr.y+ar/Ai-Ce)*ar)/(Br*Wr-Ae*ar),ar=Ze+Br*Wr-le.x,Br=Ce+Ae*Wr-le.y,Ae=ar*ar+Br*Br,2>=Ae)return new vt(ar,Br);Ae=Math.sqrt(Ae/2)}else le=!1,Br>hn?ar>hn&&(le=!0):Br<-hn?ar<-hn&&(le=!0):Zu(Ae)===Zu(Wr)&&(le=!0),le?(ar=-Ae,Ae=Math.sqrt(Ze)):(ar=Br,Br=Ae,Ae=Math.sqrt(Ze/2));return new vt(ar/Ae,Br/Ae)}function w(le,Ce){for(St=le.length;0<=--St;){var xr=St,Br=St-1;0>Br&&(Br=le.length-1);var Ae,ar=Z+2*Ut;for(Ae=0;Ae<ar;Ae++){var Wr=et*Ae,Ze=et*(Ae+1),Sn=Ce+Br+Wr,Ai=Ce+Br+Ze;Ze=Ce+xr+Ze,P(Ce+xr+Wr),P(Sn),P(Ze),P(Sn),P(Ai),P(Ze),Wr=f.length/3,Wr=ne.generateSideWallUV(s,f,Wr-6,Wr-3,Wr-2,Wr-1),F(Wr[0]),F(Wr[1]),F(Wr[3]),F(Wr[1]),F(Wr[2]),F(Wr[3])}}}function I(le,Ce,xr){W.push(le),W.push(Ce),W.push(xr)}function L(le,Ce,xr){P(le),P(Ce),P(xr),le=f.length/3,le=ne.generateTopUV(s,f,le-3,le-2,le-1),F(le[0]),F(le[1]),F(le[2])}function P(le){f.push(W[3*le]),f.push(W[3*le+1]),f.push(W[3*le+2])}function F(le){c.push(le.x),c.push(le.y)}var W=[],X=r.curveSegments!==void 0?r.curveSegments:12,Z=r.steps!==void 0?r.steps:1,tt=r.depth!==void 0?r.depth:100,st=r.bevelEnabled!==void 0?r.bevelEnabled:!0,xt=r.bevelThickness!==void 0?r.bevelThickness:6,At=r.bevelSize!==void 0?r.bevelSize:xt-2,yt=r.bevelOffset!==void 0?r.bevelOffset:0,Ut=r.bevelSegments!==void 0?r.bevelSegments:3,kt=r.extrudePath,ne=r.UVGenerator!==void 0?r.UVGenerator:fC;r.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),tt=r.amount);var Wt=!1;if(kt){var re=kt.getSpacedPoints(Z);Wt=!0,st=!1;var be=kt.computeFrenetFrames(Z,!1),ce=new ot,tr=new ot,yr=new ot}st||(yt=At=xt=Ut=0);var sr;X=A.extractPoints(X),A=X.shape;var ni=X.holes;if(!rc.isClockWise(A)){A=A.reverse();var pr=0;for(sr=ni.length;pr<sr;pr++){var dt=ni[pr];rc.isClockWise(dt)&&(ni[pr]=dt.reverse())}}var gt=rc.triangulateShape(A,ni),mt=A;for(pr=0,sr=ni.length;pr<sr;pr++)dt=ni[pr],A=A.concat(dt);var Tt,et=A.length,ht,ct=gt.length;X=[];var St=0,Gt=mt.length,Qt=Gt-1;for(Tt=St+1;St<Gt;St++,Qt++,Tt++)Qt===Gt&&(Qt=0),Tt===Gt&&(Tt=0),X[St]=N(mt[St],mt[Qt],mt[Tt]);kt=[];var ft=X.concat();for(pr=0,sr=ni.length;pr<sr;pr++){dt=ni[pr];var ve=[];for(St=0,Gt=dt.length,Qt=Gt-1,Tt=St+1;St<Gt;St++,Qt++,Tt++)Qt===Gt&&(Qt=0),Tt===Gt&&(Tt=0),ve[St]=N(dt[St],dt[Qt],dt[Tt]);kt.push(ve),ft=ft.concat(ve)}for(Qt=0;Qt<Ut;Qt++){Gt=Qt/Ut;var xe=xt*Math.cos(Gt*Math.PI/2);for(Tt=At*Math.sin(Gt*Math.PI/2)+yt,St=0,Gt=mt.length;St<Gt;St++){var me=S(mt[St],X[St],Tt);I(me.x,me.y,-xe)}for(pr=0,sr=ni.length;pr<sr;pr++)for(dt=ni[pr],ve=kt[pr],St=0,Gt=dt.length;St<Gt;St++)me=S(dt[St],ve[St],Tt),I(me.x,me.y,-xe)}for(Tt=At+yt,St=0;St<et;St++)me=st?S(A[St],ft[St],Tt):A[St],Wt?(tr.copy(be.normals[0]).multiplyScalar(me.x),ce.copy(be.binormals[0]).multiplyScalar(me.y),yr.copy(re[0]).add(tr).add(ce),I(yr.x,yr.y,yr.z)):I(me.x,me.y,0);for(Gt=1;Gt<=Z;Gt++)for(St=0;St<et;St++)me=st?S(A[St],ft[St],Tt):A[St],Wt?(tr.copy(be.normals[Gt]).multiplyScalar(me.x),ce.copy(be.binormals[Gt]).multiplyScalar(me.y),yr.copy(re[Gt]).add(tr).add(ce),I(yr.x,yr.y,yr.z)):I(me.x,me.y,tt/Z*Gt);for(Qt=Ut-1;0<=Qt;Qt--){for(Gt=Qt/Ut,xe=xt*Math.cos(Gt*Math.PI/2),Tt=At*Math.sin(Gt*Math.PI/2)+yt,St=0,Gt=mt.length;St<Gt;St++)me=S(mt[St],X[St],Tt),I(me.x,me.y,tt+xe);for(pr=0,sr=ni.length;pr<sr;pr++)for(dt=ni[pr],ve=kt[pr],St=0,Gt=dt.length;St<Gt;St++)me=S(dt[St],ve[St],Tt),Wt?I(me.x,me.y+re[Z-1].y,re[Z-1].x+xe):I(me.x,me.y,tt+xe)}(function(){var le=f.length/3;if(st){var Ce=0*et;for(St=0;St<ct;St++)ht=gt[St],L(ht[2]+Ce,ht[1]+Ce,ht[0]+Ce);for(Ce=et*(Z+2*Ut),St=0;St<ct;St++)ht=gt[St],L(ht[0]+Ce,ht[1]+Ce,ht[2]+Ce)}else{for(St=0;St<ct;St++)ht=gt[St],L(ht[2],ht[1],ht[0]);for(St=0;St<ct;St++)ht=gt[St],L(ht[0]+et*Z,ht[1]+et*Z,ht[2]+et*Z)}s.addGroup(le,f.length/3-le,0)})(),function(){var le=f.length/3,Ce=0;for(w(mt,Ce),Ce+=mt.length,pr=0,sr=ni.length;pr<sr;pr++)dt=ni[pr],w(dt,Ce),Ce+=dt.length;s.addGroup(le,f.length/3-le,1)}()}We.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:r},t=Array.isArray(t)?t:[t];for(var s=this,f=[],c=[],g=0,p=t.length;g<p;g++)i(t[g]);this.setAttribute("position",new Ge(f,3)),this.setAttribute("uv",new Ge(c,2)),this.computeVertexNormals()}function E0(t,r,i){if(i.shapes=[],Array.isArray(t))for(var s=0,f=t.length;s<f;s++)i.shapes.push(t[s].uuid);else i.shapes.push(t.uuid);return r.extrudePath!==void 0&&(i.options.extrudePath=r.extrudePath.toJSON()),i}function Eh(t,r){Fr.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:r},this.fromBufferGeometry(new wl(t,r)),this.mergeVertices()}function wl(t,r){r=r||{};var i=r.font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new Fr;t=i.generateShapes(t,r.size),r.depth=r.height!==void 0?r.height:50,r.bevelThickness===void 0&&(r.bevelThickness=10),r.bevelSize===void 0&&(r.bevelSize=8),r.bevelEnabled===void 0&&(r.bevelEnabled=!1),Ts.call(this,t,r),this.type="TextBufferGeometry"}function Rp(t,r,i,s,f,c,g){Fr.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:g},this.fromBufferGeometry(new Ml(t,r,i,s,f,c,g)),this.mergeVertices()}function Ml(t,r,i,s,f,c,g){We.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:r,heightSegments:i,phiStart:s,phiLength:f,thetaStart:c,thetaLength:g},t=t||1,r=Math.max(3,Math.floor(r)||8),i=Math.max(2,Math.floor(i)||6),s=s!==void 0?s:0,f=f!==void 0?f:2*Math.PI,c=c!==void 0?c:0,g=g!==void 0?g:Math.PI;var p=Math.min(c+g,Math.PI),A,S,N=0,w=[],I=new ot,L=new ot,P=[],F=[],W=[],X=[];for(S=0;S<=i;S++){var Z=[],tt=S/i,st=0;for(S==0&&c==0?st=.5/r:S==i&&p==Math.PI&&(st=-.5/r),A=0;A<=r;A++){var xt=A/r;I.x=-t*Math.cos(s+xt*f)*Math.sin(c+tt*g),I.y=t*Math.cos(c+tt*g),I.z=t*Math.sin(s+xt*f)*Math.sin(c+tt*g),F.push(I.x,I.y,I.z),L.copy(I).normalize(),W.push(L.x,L.y,L.z),X.push(xt+st,1-tt),Z.push(N++)}w.push(Z)}for(S=0;S<i;S++)for(A=0;A<r;A++)t=w[S][A+1],s=w[S][A],f=w[S+1][A],g=w[S+1][A+1],(S!==0||0<c)&&P.push(t,s,g),(S!==i-1||p<Math.PI)&&P.push(s,f,g);this.setIndex(P),this.setAttribute("position",new Ge(F,3)),this.setAttribute("normal",new Ge(W,3)),this.setAttribute("uv",new Ge(X,2))}function jc(t,r,i,s,f,c){Fr.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},this.fromBufferGeometry(new Xc(t,r,i,s,f,c)),this.mergeVertices()}function Xc(t,r,i,s,f,c){We.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:r,thetaSegments:i,phiSegments:s,thetaStart:f,thetaLength:c},t=t||.5,r=r||1,f=f!==void 0?f:0,c=c!==void 0?c:2*Math.PI,i=i!==void 0?Math.max(3,i):8,s=s!==void 0?Math.max(1,s):1;var g=[],p=[],A=[],S=[],N=t,w=(r-t)/s,I=new ot,L=new vt,P,F;for(P=0;P<=s;P++){for(F=0;F<=i;F++)t=f+F/i*c,I.x=N*Math.cos(t),I.y=N*Math.sin(t),p.push(I.x,I.y,I.z),A.push(0,0,1),L.x=(I.x/r+1)/2,L.y=(I.y/r+1)/2,S.push(L.x,L.y);N+=w}for(P=0;P<s;P++)for(r=P*(i+1),F=0;F<i;F++)t=F+r,f=t+i+1,c=t+i+2,N=t+1,g.push(t,f,N),g.push(f,c,N);this.setIndex(g),this.setAttribute("position",new Ge(p,3)),this.setAttribute("normal",new Ge(A,3)),this.setAttribute("uv",new Ge(S,2))}function Yc(t,r,i,s){Fr.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},this.fromBufferGeometry(new Lh(t,r,i,s)),this.mergeVertices()}function Lh(t,r,i,s){We.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:r,phiStart:i,phiLength:s},r=Math.floor(r)||12,i=i||0,s=s||2*Math.PI,s=Tr.clamp(s,0,2*Math.PI);var f=[],c=[],g=[],p=1/r,A=new ot,S=new vt,N;for(N=0;N<=r;N++){var w=i+N*p*s,I=Math.sin(w),L=Math.cos(w);for(w=0;w<=t.length-1;w++)A.x=t[w].x*I,A.y=t[w].y,A.z=t[w].x*L,c.push(A.x,A.y,A.z),S.x=N/r,S.y=w/(t.length-1),g.push(S.x,S.y)}for(N=0;N<r;N++)for(w=0;w<t.length-1;w++)i=w+N*t.length,p=i+t.length,A=i+t.length+1,S=i+1,f.push(i,p,S),f.push(p,A,S);if(this.setIndex(f),this.setAttribute("position",new Ge(c,3)),this.setAttribute("uv",new Ge(g,2)),this.computeVertexNormals(),s===2*Math.PI)for(s=this.attributes.normal.array,f=new ot,c=new ot,g=new ot,i=r*t.length*3,w=N=0;N<t.length;N++,w+=3)f.x=s[w+0],f.y=s[w+1],f.z=s[w+2],c.x=s[i+w+0],c.y=s[i+w+1],c.z=s[i+w+2],g.addVectors(f,c).normalize(),s[w+0]=s[i+w+0]=g.x,s[w+1]=s[i+w+1]=g.y,s[w+2]=s[i+w+2]=g.z}function Cl(t,r){Fr.call(this),this.type="ShapeGeometry",(typeof r=="undefined"?"undefined":Zs(r))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),r=r.curveSegments),this.parameters={shapes:t,curveSegments:r},this.fromBufferGeometry(new za(t,r)),this.mergeVertices()}function za(t,r){function i(N){var w,I=f.length/3;N=N.extractPoints(r);var L=N.shape,P=N.holes;for(rc.isClockWise(L)===!1&&(L=L.reverse()),N=0,w=P.length;N<w;N++){var F=P[N];rc.isClockWise(F)===!0&&(P[N]=F.reverse())}var W=rc.triangulateShape(L,P);for(N=0,w=P.length;N<w;N++)F=P[N],L=L.concat(F);for(N=0,w=L.length;N<w;N++)F=L[N],f.push(F.x,F.y,0),c.push(0,0,1),g.push(F.x,F.y);for(N=0,w=W.length;N<w;N++)L=W[N],s.push(L[0]+I,L[1]+I,L[2]+I),A+=3}We.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:r},r=r||12;var s=[],f=[],c=[],g=[],p=0,A=0;if(Array.isArray(t)===!1)i(t);else for(var S=0;S<t.length;S++)i(t[S]),this.addGroup(p,A,S),p+=A,A=0;this.setIndex(s),this.setAttribute("position",new Ge(f,3)),this.setAttribute("normal",new Ge(c,3)),this.setAttribute("uv",new Ge(g,2))}function L0(t,r){if(r.shapes=[],Array.isArray(t))for(var i=0,s=t.length;i<s;i++)r.shapes.push(t[i].uuid);else r.shapes.push(t.uuid);return r}function Zc(t,r){We.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:r};var i=[];r=Math.cos(Tr.DEG2RAD*(r!==void 0?r:1));var s=[0,0],f={},c=["a","b","c"];if(t.isBufferGeometry){var g=new Fr;g.fromBufferGeometry(t)}else g=t.clone();g.mergeVertices(),g.computeFaceNormals(),t=g.vertices,g=g.faces;for(var p=0,A=g.length;p<A;p++)for(var S=g[p],N=0;3>N;N++){var w=S[c[N]],I=S[c[(N+1)%3]];s[0]=Math.min(w,I),s[1]=Math.max(w,I),w=s[0]+","+s[1],f[w]===void 0?f[w]={index1:s[0],index2:s[1],face1:p,face2:void 0}:f[w].face2=p}for(w in f)s=f[w],(s.face2===void 0||g[s.face1].normal.dot(g[s.face2].normal)<=r)&&(c=t[s.index1],i.push(c.x,c.y,c.z),c=t[s.index2],i.push(c.x,c.y,c.z));this.setAttribute("position",new Ge(i,3))}function Ss(t,r,i,s,f,c,g,p){Fr.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:g,thetaLength:p},this.fromBufferGeometry(new Ua(t,r,i,s,f,c,g,p)),this.mergeVertices()}function Ua(t,r,i,s,f,c,g,p){function A(Z){var tt,st=new vt,xt=new ot,At=0,yt=Z===!0?t:r,Ut=Z===!0?1:-1,kt=P;for(tt=1;tt<=s;tt++)w.push(0,W*Ut,0),I.push(0,Ut,0),L.push(.5,.5),P++;var ne=P;for(tt=0;tt<=s;tt++){var Wt=tt/s*p+g,re=Math.cos(Wt);Wt=Math.sin(Wt),xt.x=yt*Wt,xt.y=W*Ut,xt.z=yt*re,w.push(xt.x,xt.y,xt.z),I.push(0,Ut,0),st.x=.5*re+.5,st.y=.5*Wt*Ut+.5,L.push(st.x,st.y),P++}for(tt=0;tt<s;tt++)st=kt+tt,xt=ne+tt,Z===!0?N.push(xt,xt+1,st):N.push(xt+1,xt,st),At+=3;S.addGroup(X,At,Z===!0?1:2),X+=At}We.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:r,height:i,radialSegments:s,heightSegments:f,openEnded:c,thetaStart:g,thetaLength:p};var S=this;t=t!==void 0?t:1,r=r!==void 0?r:1,i=i||1,s=Math.floor(s)||8,f=Math.floor(f)||1,c=c!==void 0?c:!1,g=g!==void 0?g:0,p=p!==void 0?p:2*Math.PI;var N=[],w=[],I=[],L=[],P=0,F=[],W=i/2,X=0;(function(){var Z,tt,st=new ot,xt=new ot,At=0,yt=(r-t)/i;for(tt=0;tt<=f;tt++){var Ut=[],kt=tt/f,ne=kt*(r-t)+t;for(Z=0;Z<=s;Z++){var Wt=Z/s,re=Wt*p+g,be=Math.sin(re);re=Math.cos(re),xt.x=ne*be,xt.y=-kt*i+W,xt.z=ne*re,w.push(xt.x,xt.y,xt.z),st.set(be,yt,re).normalize(),I.push(st.x,st.y,st.z),L.push(Wt,1-kt),Ut.push(P++)}F.push(Ut)}for(Z=0;Z<s;Z++)for(tt=0;tt<f;tt++)st=F[tt+1][Z],xt=F[tt+1][Z+1],yt=F[tt][Z+1],N.push(F[tt][Z],st,yt),N.push(st,xt,yt),At+=6;S.addGroup(X,At,0),X+=At})(),c===!1&&(0<t&&A(!0),0<r&&A(!1)),this.setIndex(N),this.setAttribute("position",new Ge(w,3)),this.setAttribute("normal",new Ge(I,3)),this.setAttribute("uv",new Ge(L,2))}function uo(t,r,i,s,f,c,g){Ss.call(this,0,t,r,i,s,f,c,g),this.type="ConeGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:g}}function Tl(t,r,i,s,f,c,g){Ua.call(this,0,t,r,i,s,f,c,g),this.type="ConeBufferGeometry",this.parameters={radius:t,height:r,radialSegments:i,heightSegments:s,openEnded:f,thetaStart:c,thetaLength:g}}function Sl(t,r,i,s){Fr.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},this.fromBufferGeometry(new Qn(t,r,i,s)),this.mergeVertices()}function Qn(t,r,i,s){We.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:r,thetaStart:i,thetaLength:s},t=t||1,r=r!==void 0?Math.max(3,r):8,i=i!==void 0?i:0,s=s!==void 0?s:2*Math.PI;var f=[],c=[],g=[],p=[],A,S=new ot,N=new vt;c.push(0,0,0),g.push(0,0,1),p.push(.5,.5);var w=0;for(A=3;w<=r;w++,A+=3){var I=i+w/r*s;S.x=t*Math.cos(I),S.y=t*Math.sin(I),c.push(S.x,S.y,S.z),g.push(0,0,1),N.x=(c[A]/t+1)/2,N.y=(c[A+1]/t+1)/2,p.push(N.x,N.y)}for(A=1;A<=r;A++)f.push(A,A+1,0);this.setIndex(f),this.setAttribute("position",new Ge(c,3)),this.setAttribute("normal",new Ge(g,3)),this.setAttribute("uv",new Ge(p,2))}function Il(t){de.call(this),this.type="ShadowMaterial",this.color=new Vt(0),this.transparent=!0,this.setValues(t)}function Jc(t){ki.call(this,t),this.type="RawShaderMaterial"}function $n(t){de.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Vt(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Eo(t){$n.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new vt(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(t)}function ls(t){de.call(this),this.type="MeshPhongMaterial",this.color=new Vt(16777215),this.specular=new Vt(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function xo(t){de.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Vt(16777215),this.specular=new Vt(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Vs(t){de.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(t)}function Tu(t){de.call(this),this.type="MeshLambertMaterial",this.color=new Vt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Vt(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Su(t){de.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Vt(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new vt(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(t)}function Iu(t){Xi.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function Lo(t,r,i,s){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=s!==void 0?s:new r.constructor(i),this.sampleValues=r,this.valueSize=i}function qc(t,r,i,s){Lo.call(this,t,r,i,s),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function El(t,r,i,s){Lo.call(this,t,r,i,s)}function Pp(t,r,i,s){Lo.call(this,t,r,i,s)}function Ao(t,r,i,s){if(t===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(r===void 0||r.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Dn.convertArray(r,this.TimeBufferType),this.values=Dn.convertArray(i,this.ValueBufferType),this.setInterpolation(s||this.DefaultInterpolation)}function Dp(t,r,i){Ao.call(this,t,r,i)}function Op(t,r,i,s){Ao.call(this,t,r,i,s)}function Ll(t,r,i,s){Ao.call(this,t,r,i,s)}function Fp(t,r,i,s){Lo.call(this,t,r,i,s)}function Rh(t,r,i,s){Ao.call(this,t,r,i,s)}function Bp(t,r,i,s){Ao.call(this,t,r,i,s)}function Rl(t,r,i,s){Ao.call(this,t,r,i,s)}function Is(t,r,i,s){this.name=t,this.tracks=i,this.duration=r!==void 0?r:-1,this.blendMode=s!==void 0?s:2500,this.uuid=Tr.generateUUID(),0>this.duration&&this.resetDuration()}function Kc(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ll;case"vector":case"vector2":case"vector3":case"vector4":return Rl;case"color":return Op;case"quaternion":return Rh;case"bool":case"boolean":return Dp;case"string":return Bp}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}function R0(t){if(t.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var r=Kc(t.type);if(t.times===void 0){var i=[],s=[];Dn.flattenJSON(t.keys,i,s,"value"),t.times=i,t.values=s}return r.parse!==void 0?r.parse(t):new r(t.name,t.times,t.values,t.interpolation)}function Pl(t,r,i){var s=this,f=!1,c=0,g=0,p=void 0,A=[];this.onStart=void 0,this.onLoad=t,this.onProgress=r,this.onError=i,this.itemStart=function(S){g++,f===!1&&s.onStart!==void 0&&s.onStart(S,c,g),f=!0},this.itemEnd=function(S){c++,s.onProgress!==void 0&&s.onProgress(S,c,g),c===g&&(f=!1,s.onLoad!==void 0)&&s.onLoad()},this.itemError=function(S){s.onError!==void 0&&s.onError(S)},this.resolveURL=function(S){return p?p(S):S},this.setURLModifier=function(S){return p=S,this},this.addHandler=function(S,N){return A.push(S,N),this},this.removeHandler=function(S){return S=A.indexOf(S),S!==-1&&A.splice(S,2),this},this.getHandler=function(S){for(var N=0,w=A.length;N<w;N+=2){var I=A[N],L=A[N+1];if(I.global&&(I.lastIndex=0),I.test(S))return L}return null}}function Qr(t){this.manager=t!==void 0?t:j_,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function Wo(t){Qr.call(this,t)}function Dr(t){Qr.call(this,t)}function P0(t){Qr.call(this,t)}function D0(t){Qr.call(this,t)}function Ph(t){Qr.call(this,t)}function Vg(t){Qr.call(this,t)}function Qc(t){Qr.call(this,t)}function Ur(){this.type="Curve",this.arcLengthDivisions=200}function Es(t,r,i,s,f,c,g,p){Ur.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=r||0,this.xRadius=i||1,this.yRadius=s||1,this.aStartAngle=f||0,this.aEndAngle=c||2*Math.PI,this.aClockwise=g||!1,this.aRotation=p||0}function $c(t,r,i,s,f,c){Es.call(this,t,r,i,i,s,f,c),this.type="ArcCurve"}function Pr(){var t=0,r=0,i=0,s=0;return{initCatmullRom:function(f,c,g,p,A){f=A*(g-f),p=A*(p-c),t=c,r=f,i=-3*c+3*g-2*f-p,s=2*c-2*g+f+p},initNonuniformCatmullRom:function(f,c,g,p,A,S,N){f=((c-f)/A-(g-f)/(A+S)+(g-c)/S)*S,p=((g-c)/S-(p-c)/(S+N)+(p-g)/N)*S,t=c,r=f,i=-3*c+3*g-2*f-p,s=2*c-2*g+f+p},calc:function(f){var c=f*f;return t+r*f+i*c+s*c*f}}}function Ro(t,r,i,s){Ur.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=r||!1,this.curveType=i||"centripetal",this.tension=s||.5}function O0(t,r,i,s,f){r=.5*(s-r),f=.5*(f-i);var c=t*t;return(2*i-2*s+r+f)*t*c+(-3*i+3*s-2*r-f)*c+r*t+i}function Eu(t,r,i,s){var f=1-t;return f*f*r+2*(1-t)*t*i+t*t*s}function tf(t,r,i,s,f){var c=1-t,g=1-t;return c*c*c*r+3*g*g*t*i+3*(1-t)*t*t*s+t*t*t*f}function da(t,r,i,s){Ur.call(this),this.type="CubicBezierCurve",this.v0=t||new vt,this.v1=r||new vt,this.v2=i||new vt,this.v3=s||new vt}function hs(t,r,i,s){Ur.call(this),this.type="CubicBezierCurve3",this.v0=t||new ot,this.v1=r||new ot,this.v2=i||new ot,this.v3=s||new ot}function cs(t,r){Ur.call(this),this.type="LineCurve",this.v1=t||new vt,this.v2=r||new vt}function Ls(t,r){Ur.call(this),this.type="LineCurve3",this.v1=t||new ot,this.v2=r||new ot}function ga(t,r,i){Ur.call(this),this.type="QuadraticBezierCurve",this.v0=t||new vt,this.v1=r||new vt,this.v2=i||new vt}function fs(t,r,i){Ur.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new ot,this.v1=r||new ot,this.v2=i||new ot}function Po(t){Ur.call(this),this.type="SplineCurve",this.points=t||[]}function Lu(){Ur.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function yi(t){Lu.call(this),this.type="Path",this.currentPoint=new vt,t&&this.setFromPoints(t)}function Ru(t){yi.call(this,t),this.uuid=Tr.generateUUID(),this.type="Shape",this.holes=[]}function nn(t,r){Ee.call(this),this.type="Light",this.color=new Vt(t),this.intensity=r!==void 0?r:1,this.receiveShadow=void 0}function Np(t,r,i){nn.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Ee.DefaultUp),this.updateMatrix(),this.groundColor=new Vt(r)}function Ws(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new vt(512,512),this.mapPass=this.map=null,this.matrix=new Ie,this._frustum=new yu,this._frameExtents=new vt(1,1),this._viewportCount=1,this._viewports=[new _t(0,0,1,1)]}function zp(){Ws.call(this,new un(50,1,.5,500))}function ef(t,r,i,s,f,c){nn.call(this,t,r),this.type="SpotLight",this.position.copy(Ee.DefaultUp),this.updateMatrix(),this.target=new Ee,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(g){this.intensity=g/Math.PI}}),this.distance=i!==void 0?i:0,this.angle=s!==void 0?s:Math.PI/3,this.penumbra=f!==void 0?f:0,this.decay=c!==void 0?c:1,this.shadow=new zp}function Wg(){Ws.call(this,new un(90,1,.5,500)),this._frameExtents=new vt(4,2),this._viewportCount=6,this._viewports=[new _t(2,1,1,1),new _t(0,1,1,1),new _t(3,1,1,1),new _t(1,1,1,1),new _t(3,0,1,1),new _t(1,0,1,1)],this._cubeDirections=[new ot(1,0,0),new ot(-1,0,0),new ot(0,0,1),new ot(0,0,-1),new ot(0,1,0),new ot(0,-1,0)],this._cubeUps=[new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,1,0),new ot(0,0,1),new ot(0,0,-1)]}function Pu(t,r,i,s){nn.call(this,t,r),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(f){this.intensity=f/(4*Math.PI)}}),this.distance=i!==void 0?i:0,this.decay=s!==void 0?s:1,this.shadow=new Wg}function js(t,r,i,s,f,c){Da.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t!==void 0?t:-1,this.right=r!==void 0?r:1,this.top=i!==void 0?i:1,this.bottom=s!==void 0?s:-1,this.near=f!==void 0?f:.1,this.far=c!==void 0?c:2e3,this.updateProjectionMatrix()}function jg(){Ws.call(this,new js(-5,5,5,-5,.5,500))}function Jr(t,r){nn.call(this,t,r),this.type="DirectionalLight",this.position.copy(Ee.DefaultUp),this.updateMatrix(),this.target=new Ee,this.shadow=new jg}function Xg(t,r){nn.call(this,t,r),this.type="AmbientLight",this.castShadow=void 0}function Yg(t,r,i,s){nn.call(this,t,r),this.type="RectAreaLight",this.width=i!==void 0?i:10,this.height=s!==void 0?s:10}function Zg(){this.coefficients=[];for(var t=0;9>t;t++)this.coefficients.push(new ot)}function Rs(t,r){nn.call(this,void 0,r),this.type="LightProbe",this.sh=t!==void 0?t:new Zg}function Up(t){Qr.call(this,t),this.textures={}}function Hp(){We.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Jg(t,r,i,s){typeof i=="number"&&(s=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),He.call(this,t,r,i),this.meshPerAttribute=s||1}function Dl(t){Qr.call(this,t)}function ps(t){Qr.call(this,t)}function F0(t){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Qr.call(this,t),this.options=void 0}function B0(){this.type="ShapePath",this.color=new Vt,this.subPaths=[],this.currentPath=null}function N0(t){this.type="Font",this.data=t}function Dh(t){Qr.call(this,t)}function vn(t){Qr.call(this,t)}function Oh(t,r,i){Rs.call(this,void 0,i),t=new Vt().set(t),i=new Vt().set(r),r=new ot(t.r,t.g,t.b),t=new ot(i.r,i.g,i.b),i=Math.sqrt(Math.PI);var s=i*Math.sqrt(.75);this.sh.coefficients[0].copy(r).add(t).multiplyScalar(i),this.sh.coefficients[1].copy(r).sub(t).multiplyScalar(s)}function Fh(t,r){Rs.call(this,void 0,r),t=new Vt().set(t),this.sh.coefficients[0].set(t.r,t.g,t.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Ha(t){this.autoStart=t!==void 0?t:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function z0(){Ee.call(this),this.type="AudioListener",this.context=Z_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new Ha}function ma(t){Ee.call(this),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function jo(t){ma.call(this,t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function kp(t,r){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=r!==void 0?r:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function qg(t,r,i){switch(this.binding=t,this.valueSize=i,r){case"quaternion":t=this._slerp,r=this._slerpAdditive;var s=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*i),this._workIndex=5;break;case"string":case"bool":r=t=this._select,s=this._setAdditiveIdentityOther,this.buffer=Array(5*i);break;default:t=this._lerp,r=this._lerpAdditive,s=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*i)}this._mixBufferRegion=t,this._mixBufferRegionAdditive=r,this._setIdentity=s,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function Gp(t,r,i){i=i||Wn.parseTrackName(r),this._targetGroup=t,this._bindings=t.subscribe_(r,i)}function Wn(t,r,i){this.path=r,this.parsedPath=i||Wn.parseTrackName(r),this.node=Wn.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function U0(t,r,i,s){this._mixer=t,this._clip=r,this._localRoot=i||null,this.blendMode=s||r.blendMode,t=r.tracks,r=t.length,i=Array(r),s={endingStart:2400,endingEnd:2400};for(var f=0;f!==r;++f){var c=t[f].createInterpolant(null);i[f]=c,c.settings=s}this._interpolantSettings=s,this._interpolants=i,this._propertyBindings=Array(r),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function bp(t){this._root=t,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function ka(t,r){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=r),this.value=t}function Vp(t,r,i){Go.call(this,t,r),this.meshPerAttribute=i||1}function Bh(t,r,i,s){this.ray=new fn(t,r),this.near=i||0,this.far=s||1/0,this.camera=null,this.layers=new Lr,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Gr(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Kg(t,r){return t.distance-r.distance}function Ol(t,r,i,s){if(t.layers.test(r.layers)&&t.raycast(r,i),s===!0){t=t.children,s=0;for(var f=t.length;s<f;s++)Ol(t[s],r,i,!0)}}function Qg(t,r){this.min=t!==void 0?t:new vt(1/0,1/0),this.max=r!==void 0?r:new vt(-1/0,-1/0)}function Wp(t,r){this.start=t!==void 0?t:new ot,this.end=r!==void 0?r:new ot}function Fl(t){Ee.call(this),this.material=t,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function rf(t,r){Ee.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=r,t=new We,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var i=0,s=1;32>i;i++,s++){var f=i/32*Math.PI*2,c=s/32*Math.PI*2;r.push(Math.cos(f),Math.sin(f),1,Math.cos(c),Math.sin(c),1)}t.setAttribute("position",new Ge(r,3)),r=new Xi({fog:!1,toneMapped:!1}),this.cone=new pn(t,r),this.add(this.cone),this.update()}function $g(t){var r=[];t&&t.isBone&&r.push(t);for(var i=0;i<t.children.length;i++)r.push.apply(r,$g(t.children[i]));return r}function Xo(t){for(var r=$g(t),i=new We,s=[],f=[],c=new Vt(0,0,1),g=new Vt(0,1,0),p=0;p<r.length;p++){var A=r[p];A.parent&&A.parent.isBone&&(s.push(0,0,0),s.push(0,0,0),f.push(c.r,c.g,c.b),f.push(g.r,g.g,g.b))}i.setAttribute("position",new Ge(s,3)),i.setAttribute("color",new Ge(f,3)),s=new Xi({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),pn.call(this,i,s),this.type="SkeletonHelper",this.root=t,this.bones=r,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Ga(t,r,i){this.light=t,this.light.updateMatrixWorld(),this.color=i,t=new Ml(r,4,2),r=new Rr({wireframe:!0,fog:!1,toneMapped:!1}),Wi.call(this,t,r),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Xs(t,r,i){Ee.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,t=new bo(r),t.rotateY(.5*Math.PI),this.material=new Rr({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),r=t.getAttribute("position"),r=new Float32Array(3*r.count),t.setAttribute("color",new He(r,3)),this.add(new Wi(t,this.material)),this.update()}function Bl(t,r,i,s){t=t||10,r=r||10,i=new Vt(i!==void 0?i:4473924),s=new Vt(s!==void 0?s:8947848);var f=r/2,c=t/r,g=t/2;t=[];for(var p=[],A=0,S=0,N=-g;A<=r;A++,N+=c){t.push(-g,0,N,g,0,N),t.push(N,0,-g,N,0,g);var w=A===f?i:s;w.toArray(p,S),S+=3,w.toArray(p,S),S+=3,w.toArray(p,S),S+=3,w.toArray(p,S),S+=3}r=new We,r.setAttribute("position",new Ge(t,3)),r.setAttribute("color",new Ge(p,3)),i=new Xi({vertexColors:!0,toneMapped:!1}),pn.call(this,r,i),this.type="GridHelper"}function nf(t,r,i,s,f,c){t=t||10,r=r||16,i=i||8,s=s||64,f=new Vt(f!==void 0?f:4473924),c=new Vt(c!==void 0?c:8947848);var g=[],p=[],A;for(A=0;A<=r;A++){var S=A/r*2*Math.PI,N=Math.sin(S)*t;S=Math.cos(S)*t,g.push(0,0,0),g.push(N,0,S);var w=A&1?f:c;p.push(w.r,w.g,w.b),p.push(w.r,w.g,w.b)}for(A=0;A<=i;A++){w=A&1?f:c;var I=t-t/i*A;for(r=0;r<s;r++)S=r/s*2*Math.PI,N=Math.sin(S)*I,S=Math.cos(S)*I,g.push(N,0,S),p.push(w.r,w.g,w.b),S=(r+1)/s*2*Math.PI,N=Math.sin(S)*I,S=Math.cos(S)*I,g.push(N,0,S),p.push(w.r,w.g,w.b)}t=new We,t.setAttribute("position",new Ge(g,3)),t.setAttribute("color",new Ge(p,3)),g=new Xi({vertexColors:!0,toneMapped:!1}),pn.call(this,t,g),this.type="PolarGridHelper"}function Du(t,r,i){Ee.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,r===void 0&&(r=1),t=new We,t.setAttribute("position",new Ge([-r,r,0,r,r,0,r,-r,0,-r,-r,0,-r,r,0],3)),r=new Xi({fog:!1,toneMapped:!1}),this.lightPlane=new as(t,r),this.add(this.lightPlane),t=new We,t.setAttribute("position",new Ge([0,0,0,0,0,1],3)),this.targetLine=new as(t,r),this.add(this.targetLine),this.update()}function of(t){function r(L,P,F){i(L,F),i(P,F)}function i(L,P){c.push(0,0,0),g.push(P.r,P.g,P.b),p[L]===void 0&&(p[L]=[]),p[L].push(c.length/3-1)}var s=new We,f=new Xi({color:16777215,vertexColors:!0,toneMapped:!1}),c=[],g=[],p={},A=new Vt(16755200),S=new Vt(16711680),N=new Vt(43775),w=new Vt(16777215),I=new Vt(3355443);r("n1","n2",A),r("n2","n4",A),r("n4","n3",A),r("n3","n1",A),r("f1","f2",A),r("f2","f4",A),r("f4","f3",A),r("f3","f1",A),r("n1","f1",A),r("n2","f2",A),r("n3","f3",A),r("n4","f4",A),r("p","n1",S),r("p","n2",S),r("p","n3",S),r("p","n4",S),r("u1","u2",N),r("u2","u3",N),r("u3","u1",N),r("c","t",w),r("p","c",I),r("cn1","cn2",I),r("cn3","cn4",I),r("cf1","cf2",I),r("cf3","cf4",I),s.setAttribute("position",new Ge(c,3)),s.setAttribute("color",new Ge(g,3)),pn.call(this,s,f),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=p,this.update()}function Tn(t,r,i,s,f,c,g){if(ry.set(f,c,g).unproject(s),t=r[t],t!==void 0)for(i=i.getAttribute("position"),r=0,s=t.length;r<s;r++)i.setXYZ(t[r],ry.x,ry.y,ry.z)}function Ou(t,r){this.object=t,r===void 0&&(r=16776960),t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new Float32Array(24),s=new We;s.setIndex(new He(t,1)),s.setAttribute("position",new He(i,3)),pn.call(this,s,new Xi({color:r,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Fu(t,r){this.type="Box3Helper",this.box=t,r=r||16776960,t=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var i=new We;i.setIndex(new He(t,1)),i.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),pn.call(this,i,new Xi({color:r,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function lo(t,r,i){this.plane=t,this.size=r===void 0?1:r,t=i!==void 0?i:16776960,r=new We,r.setAttribute("position",new Ge([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),as.call(this,r,new Xi({color:t,toneMapped:!1})),this.type="PlaneHelper",r=new We,r.setAttribute("position",new Ge([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),r.computeBoundingSphere(),this.add(new Wi(r,new Rr({color:t,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function ho(t,r,i,s,f,c){Ee.call(this),this.type="ArrowHelper",t===void 0&&(t=new ot(0,0,1)),r===void 0&&(r=new ot(0,0,0)),i===void 0&&(i=1),s===void 0&&(s=16776960),f===void 0&&(f=.2*i),c===void 0&&(c=.2*f),ny===void 0&&(ny=new We,ny.setAttribute("position",new Ge([0,0,0,0,1,0],3)),ZA=new Ua(0,.5,1,5,1),ZA.translate(0,-.5,0)),this.position.copy(r),this.line=new as(ny,new Xi({color:s,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Wi(ZA,new Rr({color:s,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,f,c)}function jp(t){t=t||1;var r=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t];t=new We,t.setAttribute("position",new Ge(r,3)),t.setAttribute("color",new Ge([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),r=new Xi({vertexColors:!0,toneMapped:!1}),pn.call(this,t,r),this.type="AxesHelper"}function tm(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Ro.call(this,t),this.type="catmullrom"}function ba(){}function Xp(t,r){for(var i in r)t[i]=r[i]}function Do(t,r){this.lng=t,this.lat=r}function Yp(t,r){this.x=t,this.y=r}function Nl(t){for(var r=t.length;0<=--r;)t[r]=0}function em(t,r){return function(i){return r(t(i))}}function H0(t){var r=function(i){return i==null?i:(1<arguments.length&&(i=Array.prototype.slice.call(arguments)),t(i))};return"conversion"in t&&(r.conversion=t.conversion),r}function k0(t){var r=function(i){if(i==null)return i;1<arguments.length&&(i=Array.prototype.slice.call(arguments));var s=t(i);if((typeof s=="undefined"?"undefined":Zs(s))==="object")for(var f=s.length,c=0;c<f;c++)s[c]=Math.round(s[c]);return s};return"conversion"in t&&(r.conversion=t.conversion),r}function to(t,r){if(!(this instanceof to))return new to(t,r);if(r&&r in lw&&(r=null),r&&!(r in $s))throw Error("Unknown model: "+r);if(typeof t=="undefined")this.model="rgb",this.color=[0,0,0],this.valpha=1;else if(t instanceof to)this.model=t.model,this.color=t.color.slice(),this.valpha=t.valpha;else if(typeof t=="string"){if(r=Jm.get(t),r===null)throw Error("Unable to parse color from string: "+t);this.model=r.model;var i=$s[this.model].channels;this.color=r.value.slice(0,i),this.valpha=typeof r.value[i]=="number"?r.value[i]:1}else if(t.length)this.model=r||"rgb",i=$s[this.model].channels,r=qA.call(t,0,i),this.color=rm(r,i),this.valpha=typeof t[i]=="number"?t[i]:1;else if(typeof t=="number")t&=16777215,this.model="rgb",this.color=[t>>16&255,t>>8&255,t&255],this.valpha=1;else{if(this.valpha=1,r=Pi(t),"alpha"in t&&(r.splice(r.indexOf("alpha"),1),this.valpha=typeof t.alpha=="number"?t.alpha:0),r=r.sort().join(""),!(r in KA))throw Error("Unable to parse color from object: "+Oo(t));this.model=KA[r],i=$s[this.model].labels;var s=[];for(r=0;r<i.length;r++)s.push(t[i[r]]);this.color=rm(s)}if(oy[this.model])for(i=$s[this.model].channels,r=0;r<i;r++)(t=oy[this.model][r])&&(this.color[r]=t(this.color[r]));this.valpha=Math.max(0,Math.min(1,this.valpha)),Gu&&Gu(this)}function G0(t){return function(r){return Number(r.toFixed(t))}}function yn(t,r,i){return t=Array.isArray(t)?t:[t],t.forEach(function(s){(oy[s]||(oy[s]=[]))[r]=i}),t=t[0],function(s){if(arguments.length){i&&(s=i(s));var f=this[t]();return f.color[r]=s,f}return f=this[t]().color[r],i&&(f=i(f)),f}}function xn(t){return function(r){return Math.max(0,Math.min(t,r))}}function rm(t,r){for(var i=0;i<r;i++)typeof t[i]!="number"&&(t[i]=0);return t}function eo(t,r){for(var i=["webgl2","experimental-webgl2","webgl","experimental-webgl"],s=void 0,f=0;f<i.length;f++)try{if(s=t.getContext(i[f],{stencil:!0,alpha:!0,premultipliedAlpha:!1,antialias:r.antialias||!0,preserveDrawingBuffer:r.preserveDrawingBuffer||!1}))break}catch(c){}return s}function An(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1}var $r=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof Dt.g!="undefined"?Dt.g:typeof self!="undefined"?self:{},Zr=It(function(t){t=t.exports=typeof window!="undefined"&&Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")(),typeof __g=="number"&&(__g=t)}),vi=It(function(t){t=t.exports={version:"2.6.5"},typeof __e=="number"&&(__e=t)}),zl=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t},ro=function(t,r,i){if(zl(t),r===void 0)return t;switch(i){case 1:return function(s){return t.call(r,s)};case 2:return function(s,f){return t.call(r,s,f)};case 3:return function(s,f,c){return t.call(r,s,f,c)}}return function(){return t.apply(r,arguments)}},Yi=function(t){return typeof t=="object"?t!==null:typeof t=="function"},co=function(t){if(!Yi(t))throw TypeError(t+" is not an object!");return t},fo=function(t){try{return!!t()}catch(r){return!0}},Yo=!fo(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7}),_o=Zr.document,Zp=Yi(_o)&&Yi(_o.createElement),Jp=!Yo&&!fo(function(){return Object.defineProperty(Zp?_o.createElement("div"):{},"a",{get:function(){return 7}}).a!=7}),sf=function(t,r){if(!Yi(t))return t;var i,s;if(r&&typeof(i=t.toString)=="function"&&!Yi(s=i.call(t))||typeof(i=t.valueOf)=="function"&&!Yi(s=i.call(t))||!r&&typeof(i=t.toString)=="function"&&!Yi(s=i.call(t)))return s;throw TypeError("Can't convert object to primitive value")},Zx=Object.defineProperty,wo={f:Yo?Object.defineProperty:function(t,r,i){if(co(t),r=sf(r,!0),co(i),Jp)try{return Zx(t,r,i)}catch(s){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(t[r]=i.value),t}},Bu=function(t,r){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:r}},va=Yo?function(t,r,i){return wo.f(t,r,Bu(1,i))}:function(t,r,i){return t[r]=i,t},Jx={}.hasOwnProperty,Gi=function(t,r){return Jx.call(t,r)},jn=function(t,r,i){var s=t&jn.F,f=t&jn.G,c=t&jn.S,g=t&jn.P,p=t&jn.B,A=t&jn.W,S=f?vi:vi[r]||(vi[r]={}),N=S.prototype;c=f?Zr:c?Zr[r]:(Zr[r]||{}).prototype;var w;f&&(i=r);for(w in i)if(r=!s&&c&&c[w]!==void 0,!r||!Gi(S,w)){var I=r?c[w]:i[w];S[w]=f&&typeof c[w]!="function"?i[w]:p&&r?ro(I,Zr):A&&c[w]==I?function(L){var P=function(F,W,X){if(this instanceof L){switch(arguments.length){case 0:return new L;case 1:return new L(F);case 2:return new L(F,W)}return new L(F,W,X)}return L.apply(this,arguments)};return P.prototype=L.prototype,P}(I):g&&typeof I=="function"?ro(Function.call,I):I,g&&((S.virtual||(S.virtual={}))[w]=I,t&jn.R&&N&&!N[w]&&va(N,w,I))}};jn.F=1,jn.G=2,jn.S=4,jn.P=8,jn.B=16,jn.W=32,jn.U=64,jn.R=128;var Je=jn,Nu={}.toString,Zo=function(t){return Nu.call(t).slice(8,-1)},ya=Object("z").propertyIsEnumerable(0)?Object:function(t){return Zo(t)=="String"?t.split(""):Object(t)},ln=function(t){if(t==null)throw TypeError("Can't call method on  "+t);return t},ci=function(t){return ya(ln(t))},af=Math.ceil,b0=Math.floor,Va=function(t){return isNaN(t=+t)?0:(0<t?b0:af)(t)},im=Math.min,Wa=function(t){return 0<t?im(Va(t),9007199254740991):0},qx=Math.max,Kx=Math.min,ja=It(function(t){var r=Zr["__core-js_shared__"]||(Zr["__core-js_shared__"]={});(t.exports=function(i,s){return r[i]||(r[i]=s!==void 0?s:{})})("versions",[]).push({version:vi.version,mode:"pure",copyright:"\xA9 2019 Denis Pushkarev (zloirock.ru)"})}),V0=0,W0=Math.random(),uf=function(t){return"Symbol(".concat(t===void 0?"":t,")_",(++V0+W0).toString(36))},Nh=ja("keys"),zh=function(t){return Nh[t]||(Nh[t]=uf(t))},j0=function(t){return function(r,i,s){r=ci(r);var f=Wa(r.length);if(s=Va(s),s=0>s?qx(s+f,0):Kx(s,f),t&&i!=i){for(;f>s;)if(i=r[s++],i!=i)return!0}else for(;f>s;s++)if((t||s in r)&&r[s]===i)return t||s||0;return!t&&-1}}(!1),lf=zh("IE_PROTO"),Xa=function(t,r){t=ci(t);var i=0,s=[],f;for(f in t)f!=lf&&Gi(t,f)&&s.push(f);for(;r.length>i;)Gi(t,f=r[i++])&&(~j0(s,f)||s.push(f));return s},zu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Ul=Object.keys||function(t){return Xa(t,zu)},nm=Yo?Object.defineProperties:function(t,r){co(t);for(var i=Ul(r),s=i.length,f=0,c;s>f;)wo.f(t,c=i[f++],r[c]);return t},X0=Zr.document,om=X0&&X0.documentElement,Qx=zh("IE_PROTO"),sm=function(){},Hl=function(){var t=Zp?_o.createElement("iframe"):{},r=zu.length;for(t.style.display="none",om.appendChild(t),t.src="javascript:",t=t.contentWindow.document,t.open(),t.write("<script>document.F=Object<\/script>"),t.close(),Hl=t.F;r--;)delete Hl.prototype[zu[r]];return Hl()},Uu=Object.create||function(t,r){if(t!==null){sm.prototype=co(t);var i=new sm;sm.prototype=null,i[Qx]=t}else i=Hl();return r===void 0?i:nm(i,r)};Je(Je.S,"Object",{create:Uu});var $x=vi.Object,tA=function(t,r){return $x.create(t,r)},Y0=It(function(t){t.exports={default:tA,__esModule:!0}}),at=zt(Y0),am=Object.getOwnPropertySymbols,qp={}.propertyIsEnumerable,Kp=Object.assign,Uh=!Kp||fo(function(){var t={},r={},i=Symbol();return t[i]=7,"abcdefghijklmnopqrst".split("").forEach(function(s){r[s]=s}),Kp({},t)[i]!=7||Object.keys(Kp({},r)).join("")!="abcdefghijklmnopqrst"})?function(t,r){for(var i=Object(ln(t)),s=arguments.length,f=1,c=am,g=qp;s>f;)for(var p=ya(arguments[f++]),A=c?Ul(p).concat(c(p)):Ul(p),S=A.length,N=0,w;S>N;)g.call(p,w=A[N++])&&(i[w]=p[w]);return i}:Kp;Je(Je.S+Je.F,"Object",{assign:Uh});var Z0=vi.Object.assign,eA=It(function(t){t.exports={default:Z0,__esModule:!0}}),ut=zt(eA);Je(Je.S,"Math",{log2:function(t){return Math.log(t)/Math.LN2}});var kl=vi.Math.log2,rA=It(function(t){t.exports={default:kl,__esModule:!0}}),iA=zt(rA),Pn={},Nn=It(function(t){var r=ja("wks"),i=Zr.Symbol,s=typeof i=="function";(t.exports=function(f){return r[f]||(r[f]=s&&i[f]||(s?i:uf)("Symbol."+f))}).store=r}),J0=wo.f,q0=Nn("toStringTag"),Hu=function(t,r,i){t&&!Gi(t=i?t:t.prototype,q0)&&J0(t,q0,{configurable:!0,value:r})},um={};va(um,Nn("iterator"),function(){return this});var K0=function(t,r,i){t.prototype=Uu(um,{next:Bu(1,i)}),Hu(t,r+" Iterator")},lm=zh("IE_PROTO"),Q0=Object.prototype,hm=Object.getPrototypeOf||function(t){return t=Object(ln(t)),Gi(t,lm)?t[lm]:typeof t.constructor=="function"&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?Q0:null},Qp=Nn("iterator"),hf=!([].keys&&"next"in[].keys()),cm=function(){return this},$p=function(t,r,i,s,f,c,g){K0(i,r,s),s=function(X){return!hf&&X in N?N[X]:function(){return new i(this,X)}};var p=r+" Iterator",A=f=="values",S=!1,N=t.prototype,w=N[Qp]||N["@@iterator"]||f&&N[f],I=w||s(f),L=f?A?s("entries"):I:void 0,P=r=="Array"&&N.entries||w,F;if(P&&(t=hm(P.call(new t)),t!==Object.prototype&&t.next&&Hu(t,p,!0)),A&&w&&w.name!=="values"&&(S=!0,I=function(){return w.call(this)}),g&&(hf||S||!N[Qp])&&va(N,Qp,I),Pn[r]=I,Pn[p]=cm,f){var W={values:A?I:s("values"),keys:c?I:s("keys"),entries:L};if(g)for(F in W)F in N||va(N,F,W[F]);else Je(Je.P+Je.F*(hf||S),r,W)}return W},Ya=function(t){return function(r,i){r=String(ln(r)),i=Va(i);var s=r.length,f;if(0>i||i>=s)return t?"":void 0;var c=r.charCodeAt(i);return 55296>c||56319<c||i+1===s||56320>(f=r.charCodeAt(i+1))||57343<f?t?r.charAt(i):c:t?r.slice(i,i+2):(c-55296<<10)+(f-56320)+65536}}(!0);$p(String,"String",function(t){this._t=String(t),this._i=0},function(){var t=this._t,r=this._i;return r>=t.length?{value:void 0,done:!0}:(t=Ya(t,r),this._i+=t.length,{value:t,done:!1})});var $0=function(t,r,i,s){try{return s?r(co(i)[0],i[1]):r(i)}catch(f){throw r=t.return,r!==void 0&&co(r.call(t)),f}},fm=Nn("iterator"),t1=Array.prototype,nA=Nn("toStringTag"),cf=Zo(function(){return arguments}())=="Arguments",Hh=function(t){var r;if(t===void 0)var i="Undefined";else{if(t===null)var s="Null";else{t:{var f=t=Object(t);try{s=f[nA];break t}catch(c){}s=void 0}s=typeof(i=s)=="string"?i:cf?Zo(t):(r=Zo(t))=="Object"&&typeof t.callee=="function"?"Arguments":r}i=s}return i},pm=Nn("iterator"),dm=vi.getIteratorMethod=function(t){if(t!=null)return t[pm]||t["@@iterator"]||Pn[Hh(t)]},td=Nn("iterator"),e1=!1;try{[7][td]().return=function(){e1=!0}}catch(t){}var gm=function(t,r){if(!r&&!e1)return!1;var i=!1;try{r=[7];var s=r[td]();s.next=function(){return{done:i=!0}},r[td]=function(){return s},t(r)}catch(f){}return i};Je(Je.S+Je.F*!gm(function(t){}),"Array",{from:function(t){var r=Object(ln(t)),i=typeof this=="function"?this:Array,s=arguments.length,f=1<s?arguments[1]:void 0,c=f!==void 0,g=0,p=dm(r),A;if(c&&(f=ro(f,2<s?arguments[2]:void 0,2)),p!=null&&(i!=Array||p===void 0||Pn.Array!==p&&t1[fm]!==p))for(r=p.call(r),i=new i;!(A=r.next()).done;g++)s=i,p=g,A=c?$0(r,f,[A.value,g],!0):A.value,p in s?wo.f(s,p,Bu(0,A)):s[p]=A;else for(s=Wa(r.length),i=new i(s);s>g;g++){p=i,A=g;var S=c?f(r[g],g):r[g];A in p?wo.f(p,A,Bu(0,S)):p[A]=S}return i.length=g,i}});var Ys=vi.Array.from,kh=It(function(t){t.exports={default:Ys,__esModule:!0}}),ff=zt(kh),xa=function(t,r){return{value:r,done:!!t}};$p(Array,"Array",function(t,r){this._t=ci(t),this._i=0,this._k=r},function(){var t=this._t,r=this._k,i=this._i++;return!t||i>=t.length?(this._t=void 0,xa(1)):r=="keys"?xa(0,i):r=="values"?xa(0,t[i]):xa(0,[i,t[i]])},"values"),Pn.Arguments=Pn.Array;for(var ed=Nn("toStringTag"),rd="CSSRuleList CSSStyleDeclaration CSSValueList ClientRectList DOMRectList DOMStringList DOMTokenList DataTransferItemList FileList HTMLAllCollection HTMLCollection HTMLFormElement HTMLSelectElement MediaList MimeTypeArray NamedNodeMap NodeList PaintRequestList Plugin PluginArray SVGLengthList SVGNumberList SVGPathSegList SVGPointList SVGStringList SVGTransformList SourceBufferList StyleSheetList TextTrackCueList TextTrackList TouchList".split(" "),pf=0;pf<rd.length;pf++){var df=rd[pf],mm=Zr[df],id=mm&&mm.prototype;id&&!id[ed]&&va(id,ed,df),Pn[df]=Pn.Array}var Mo=function(t,r,i,s){if(!(t instanceof r)||s!==void 0&&s in t)throw TypeError(i+": incorrect invocation!");return t},Ni=It(function(t){var r={},i={};t=t.exports=function(s,f,c,g,p){p=p?function(){return s}:dm(s),c=ro(c,g,f?2:1),g=0;var A,S;if(typeof p!="function")throw TypeError(s+" is not iterable!");if(p===void 0||Pn.Array!==p&&t1[fm]!==p){for(g=p.call(s);!(S=g.next()).done;)if(p=$0(g,c,S.value,f),p===r||p===i)return p}else for(A=Wa(s.length);A>g;g++)if(p=f?c(co(S=s[g])[0],S[1]):c(s[g]),p===r||p===i)return p},t.BREAK=r,t.RETURN=i}),Or=Nn("species"),ii=function(t,r){t=co(t).constructor;var i;return t===void 0||(i=co(t)[Or])==null?r:zl(i)},oA=function(t,r,i){var s=i===void 0;switch(r.length){case 0:return s?t():t.call(i);case 1:return s?t(r[0]):t.call(i,r[0]);case 2:return s?t(r[0],r[1]):t.call(i,r[0],r[1]);case 3:return s?t(r[0],r[1],r[2]):t.call(i,r[0],r[1],r[2]);case 4:return s?t(r[0],r[1],r[2],r[3]):t.call(i,r[0],r[1],r[2],r[3])}return t.apply(i,r)},gf=Zr.process,or=Zr.setImmediate,r1=Zr.clearImmediate,i1=Zr.MessageChannel,vm=Zr.Dispatch,ym=0,qr={},ds=function(){var t=+this;if(qr.hasOwnProperty(t)){var r=qr[t];delete qr[t],r()}},xm=function(t){ds.call(t.data)};if(!or||!r1)if(or=function(t){for(var r=[],i=1;arguments.length>i;)r.push(arguments[i++]);return qr[++ym]=function(){oA(typeof t=="function"?t:Function(t),r)},$e(ym),ym},r1=function(t){delete qr[t]},Zo(gf)=="process")var $e=function(t){gf.nextTick(ro(ds,t,1))};else if(vm&&vm.now)$e=function(t){vm.now(ro(ds,t,1))};else if(i1){var n1=new i1,bi=n1.port2;n1.port1.onmessage=xm,$e=ro(bi.postMessage,bi,1)}else Zr.addEventListener&&typeof postMessage=="function"&&!Zr.importScripts?($e=function(t){Zr.postMessage(t+"","*")},Zr.addEventListener("message",xm,!1)):$e="onreadystatechange"in(Zp?_o.createElement("script"):{})?function(t){om.appendChild(Zp?_o.createElement("script"):{}).onreadystatechange=function(){om.removeChild(this),ds.call(t)}}:function(t){setTimeout(ro(ds,t,1),0)};var zn=or,Gl=Zr.MutationObserver||Zr.WebKitMutationObserver,Am=Zr.process,_m=Zr.Promise,o1=Zo(Am)=="process",nd={f:function(t){return new ue(t)}},od=function(t){try{return{e:!1,v:t()}}catch(r){return{e:!0,v:r}}},s1=Zr.navigator,a1=s1&&s1.userAgent||"",bl=function(t,r){if(co(t),Yi(r)&&r.constructor===t)return r;t=nd.f(t);var i=t.resolve;return i(r),t.promise},sd=function(t,r,i){for(var s in r)i&&t[s]?t[s]=r[s]:va(t,s,r[s]);return t},u1=Nn("species"),l1=function(t){t=typeof vi[t]=="function"?vi[t]:Zr[t],Yo&&t&&!t[u1]&&wo.f(t,u1,{configurable:!0,get:function(){return this}})},h1=function(){var t,r,i=function(){var p;for(o1&&(p=Am.domain)&&p.exit();t;){var A=t.fn;t=t.next;try{A()}catch(S){throw t?s():r=void 0,S}}r=void 0,p&&p.enter()};if(o1)var s=function(){Am.nextTick(i)};else if(!Gl||Zr.navigator&&Zr.navigator.standalone)if(_m&&_m.resolve){var f=_m.resolve(void 0);s=function(){f.then(i)}}else s=function(){zn.call(Zr,i)};else{var c=!0,g=document.createTextNode("");new Gl(i).observe(g,{characterData:!0}),s=function(){g.data=c=!c}}return function(p){p={fn:p,next:void 0},r&&(r.next=p),t||(t=p,s()),r=p}}(),c1=Zr.TypeError,Vl=Zr.process,f1=Vl&&Vl.versions,wm=f1&&f1.v8||"",Ps=Zr.Promise,Ti=Hh(Vl)=="process",ad=function(){},Mm,mf=Mm=nd.f,ud=!!function(){try{var t=Ps.resolve(1),r=(t.constructor={})[Nn("species")]=function(i){i(ad,ad)};return(Ti||typeof PromiseRejectionEvent=="function")&&t.then(ad)instanceof r&&wm.indexOf("6.6")!==0&&a1.indexOf("Chrome/66")===-1}catch(i){}}(),p1=function(t){var r;return Yi(t)&&typeof(r=t.then)=="function"?r:!1},Ds=function(t,r){if(!t._n){t._n=!0;var i=t._c;h1(function(){for(var s=t._v,f=t._s==1,c=0;i.length>c;){var g=void 0,p=void 0,A=void 0,S=i[c++],N=f?S.ok:S.fail,w=S.resolve,I=S.reject,L=S.domain;try{N?(f||(t._h==2&&sA(t),t._h=1),N===!0?A=s:(L&&L.enter(),A=N(s),L&&(L.exit(),g=!0)),A===S.promise?I(c1("Promise-chain cycle")):(p=p1(A))?p.call(A,w,I):w(A)):I(s)}catch(P){L&&!g&&L.exit(),I(P)}}t._c=[],t._n=!1,r&&!t._h&&d1(t)})}},d1=function(t){zn.call(Zr,function(){var r=t._v,i=t._h!==1&&(t._a||t._c).length===0,s,f;if(i){var c=od(function(){Ti?Vl.emit("unhandledRejection",r,t):(s=Zr.onunhandledrejection)?s({promise:t,reason:r}):(f=Zr.console)&&f.error&&f.error("Unhandled promise rejection",r)});t._h=Ti||t._h!==1&&(t._a||t._c).length===0?2:1}if(t._a=void 0,i&&c.e)throw c.v})},sA=function(t){zn.call(Zr,function(){var r;Ti?Vl.emit("rejectionHandled",t):(r=Zr.onrejectionhandled)&&r({promise:t,reason:t._v})})},Za=function(t){var r=this;r._d||(r._d=!0,r=r._w||r,r._v=t,r._s=2,r._a||(r._a=r._c.slice()),Ds(r,!0))},ku=function(t){var r=this,i;if(!r._d){r._d=!0,r=r._w||r;try{if(r===t)throw c1("Promise can't be resolved itself");(i=p1(t))?h1(function(){var s={_w:r,_d:!1};try{i.call(t,ro(ku,s,1),ro(Za,s,1))}catch(f){Za.call(s,f)}}):(r._v=t,r._s=1,Ds(r,!1))}catch(s){Za.call({_w:r,_d:!1},s)}}};if(!ud){Ps=function(t){Mo(this,Ps,"Promise","_h"),zl(t),ld.call(this);try{t(ro(ku,this,1),ro(Za,this,1))}catch(r){Za.call(this,r)}};var ld=function(t){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1};ld.prototype=sd(Ps.prototype,{then:function(t,r){var i=mf(ii(this,Ps));return i.ok=typeof t=="function"?t:!0,i.fail=typeof r=="function"&&r,i.domain=Ti?Vl.domain:void 0,this._c.push(i),this._a&&this._a.push(i),this._s&&Ds(this,!1),i.promise},catch:function(t){return this.then(void 0,t)}});var g1=function(){var t=new ld;this.promise=t,this.resolve=ro(ku,t,1),this.reject=ro(Za,t,1)};nd.f=mf=function(t){return t===Ps||t===hd?new g1(t):Mm(t)}}Je(Je.G+Je.W+Je.F*!ud,{Promise:Ps}),Hu(Ps,"Promise"),l1("Promise");var hd=vi.Promise;Je(Je.S+Je.F*!ud,"Promise",{reject:function(t){var r=mf(this),i=r.reject;return i(t),r.promise}}),Je(Je.S+1*Je.F,"Promise",{resolve:function(t){return bl(this===hd?Ps:this,t)}}),Je(Je.S+Je.F*!(ud&&gm(function(t){Ps.all(t).catch(ad)})),"Promise",{all:function(t){var r=this,i=mf(r),s=i.resolve,f=i.reject,c=od(function(){var g=[],p=0,A=1;Ni(t,!1,function(S){var N=p++,w=!1;g.push(void 0),A++,r.resolve(S).then(function(I){w||(w=!0,g[N]=I,--A||s(g))},f)}),--A||s(g)});return c.e&&f(c.v),i.promise},race:function(t){var r=this,i=mf(r),s=i.reject,f=od(function(){Ni(t,!1,function(c){r.resolve(c).then(i.resolve,s)})});return f.e&&s(f.v),i.promise}}),Je(Je.P+Je.R,"Promise",{finally:function(t){var r=ii(this,vi.Promise||Zr.Promise),i=typeof t=="function";return this.then(i?function(s){return bl(r,t()).then(function(){return s})}:t,i?function(s){return bl(r,t()).then(function(){throw s})}:t)}}),Je(Je.S,"Promise",{try:function(t){var r=nd.f(this);return t=od(t),(t.e?r.reject:r.resolve)(t.v),r.promise}});var aA=vi.Promise,m1=It(function(t){t.exports={default:aA,__esModule:!0}}),xi=zt(m1),Os=It(function(t){var r=uf("meta"),i=wo.f,s=0,f=Object.isExtensible||function(){return!0},c=!fo(function(){return f(Object.preventExtensions({}))}),g=function(A){i(A,r,{value:{i:"O"+ ++s,w:{}}})},p=t.exports={KEY:r,NEED:!1,fastKey:function(A,S){if(!Yi(A))return typeof A=="symbol"?A:(typeof A=="string"?"S":"P")+A;if(!Gi(A,r)){if(!f(A))return"F";if(!S)return"E";g(A)}return A[r].i},getWeak:function(A,S){if(!Gi(A,r)){if(!f(A))return!0;if(!S)return!1;g(A)}return A[r].w},onFreeze:function(A){return c&&p.NEED&&f(A)&&!Gi(A,r)&&g(A),A}}}),Ja=function(t,r){var i=(vi.Object||{})[t]||Object[t],s={};s[t]=r(i),Je(Je.S+Je.F*fo(function(){i(1)}),"Object",s)},Aa=Os.onFreeze;Ja("freeze",function(t){return function(r){return t&&Yi(r)?t(Aa(r)):r}});var uA=vi.Object.freeze,v1=It(function(t){t.exports={default:uA,__esModule:!0}}),Gu=zt(v1),cd={f:Nn},lA=cd.f("iterator"),vf=It(function(t){t.exports={default:lA,__esModule:!0}});zt(vf);var y1=wo.f,Fs=function(t){var r=vi.Symbol||(vi.Symbol={});t.charAt(0)=="_"||t in r||y1(r,t,{value:cd.f(t)})},Jo=Array.isArray||function(t){return Zo(t)=="Array"},hA=zu.concat("length","prototype"),fd=Object.getOwnPropertyNames||function(t){return Xa(t,hA)},x1=fd,A1={}.toString,Cm=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],_1=function(t){if(Cm&&A1.call(t)=="[object Window]")try{var r=x1(t)}catch(i){r=Cm.slice()}else r=x1(ci(t));return r},pd=Object.getOwnPropertyDescriptor,dd={f:Yo?pd:function(t,r){if(t=ci(t),r=sf(r,!0),Jp)try{return pd(t,r)}catch(i){}if(Gi(t,r))return Bu(!qp.call(t,r),t[r])}},cA=Os.KEY,gd=dd.f,qa=wo.f,w1=_1,qo=Zr.Symbol,md=Zr.JSON,Wl=md&&md.stringify,Un=Nn("_hidden"),M1=Nn("toPrimitive"),C1={}.propertyIsEnumerable,yf=ja("symbol-registry"),_a=ja("symbols"),jl=ja("op-symbols"),Bs=Object.prototype,Xl=typeof qo=="function",xf=Zr.QObject,Af=!xf||!xf.prototype||!xf.prototype.findChild,Yl=Yo&&fo(function(){return Uu(qa({},"a",{get:function(){return qa(this,"a",{value:7}).a}})).a!=7})?function(t,r,i){var s=gd(Bs,r);s&&delete Bs[r],qa(t,r,i),s&&t!==Bs&&qa(Bs,r,s)}:qa,Gh=function(t){var r=_a[t]=Uu(qo.prototype);return r._k=t,r},vd=Xl&&typeof qo.iterator=="symbol"?function(t){return typeof t=="symbol"}:function(t){return t instanceof qo},bu=function(t,r,i){return t===Bs&&bu(jl,r,i),co(t),r=sf(r,!0),co(i),Gi(_a,r)?(i.enumerable?(Gi(t,Un)&&t[Un][r]&&(t[Un][r]=!1),i=Uu(i,{enumerable:Bu(0,!1)})):(Gi(t,Un)||qa(t,Un,Bu(1,{})),t[Un][r]=!0),Yl(t,r,i)):qa(t,r,i)},Tm=function(t,r){co(t);var i=r=ci(r),s=Ul(i),f=am;if(f){f=f(i);for(var c=qp,g=0,p;f.length>g;)c.call(i,p=f[g++])&&s.push(p)}i=0,p=s.length;for(var A;p>i;)bu(t,A=s[i++],r[A]);return t},T1=function(t){var r=C1.call(this,t=sf(t,!0));return this===Bs&&Gi(_a,t)&&!Gi(jl,t)?!1:r||!Gi(this,t)||!Gi(_a,t)||Gi(this,Un)&&this[Un][t]?r:!0},yd=function(t,r){if(t=ci(t),r=sf(r,!0),t!==Bs||!Gi(_a,r)||Gi(jl,r)){var i=gd(t,r);return!i||!Gi(_a,r)||Gi(t,Un)&&t[Un][r]||(i.enumerable=!0),i}},Sm=function(t){t=w1(ci(t));for(var r=[],i=0,s;t.length>i;)Gi(_a,s=t[i++])||s==Un||s==cA||r.push(s);return r},xd=function(t){var r=t===Bs;t=w1(r?jl:ci(t));for(var i=[],s=0,f;t.length>s;)Gi(_a,f=t[s++])&&(!r||Gi(Bs,f))&&i.push(_a[f]);return i};Xl||(qo=function(){if(this instanceof qo)throw TypeError("Symbol is not a constructor!");var t=uf(0<arguments.length?arguments[0]:void 0),r=function(i){this===Bs&&r.call(jl,i),Gi(this,Un)&&Gi(this[Un],t)&&(this[Un][t]=!1),Yl(this,t,Bu(1,i))};return Yo&&Af&&Yl(Bs,t,{configurable:!0,set:r}),Gh(t)},va(qo.prototype,"toString",function(){return this._k}),dd.f=yd,wo.f=bu,fd=_1=Sm,qp=T1,am=xd,cd.f=function(t){return Gh(Nn(t))}),Je(Je.G+Je.W+Je.F*!Xl,{Symbol:qo});for(var Ad="hasInstance isConcatSpreadable iterator match replace search species split toPrimitive toStringTag unscopables".split(" "),Im=0;Ad.length>Im;)Nn(Ad[Im++]);for(var _f=Ul(Nn.store),wf=0;_f.length>wf;)Fs(_f[wf++]);Je(Je.S+Je.F*!Xl,"Symbol",{for:function(t){return Gi(yf,t+="")?yf[t]:yf[t]=qo(t)},keyFor:function(t){if(!vd(t))throw TypeError(t+" is not a symbol!");for(var r in yf)if(yf[r]===t)return r},useSetter:function(){Af=!0},useSimple:function(){Af=!1}}),Je(Je.S+Je.F*!Xl,"Object",{create:function(t,r){return r===void 0?Uu(t):Tm(Uu(t),r)},defineProperty:bu,defineProperties:Tm,getOwnPropertyDescriptor:yd,getOwnPropertyNames:Sm,getOwnPropertySymbols:xd}),md&&Je(Je.S+Je.F*(!Xl||fo(function(){var t=qo();return Wl([t])!="[null]"||Wl({a:t})!="{}"||Wl(Object(t))!="{}"})),"JSON",{stringify:function(t){for(var r=[t],i=1,s;arguments.length>i;)r.push(arguments[i++]);if(s=i=r[1],(Yi(i)||t!==void 0)&&!vd(t))return Jo(i)||(i=function(f,c){if(typeof s=="function"&&(c=s.call(this,f,c)),!vd(c))return c}),r[1]=i,Wl.apply(md,r)}}),qo.prototype[M1]||va(qo.prototype,M1,qo.prototype.valueOf),Hu(qo,"Symbol"),Hu(Math,"Math",!0),Hu(Zr.JSON,"JSON",!0),Fs("asyncIterator"),Fs("observable");var S1=vi.Symbol,Mf=It(function(t){t.exports={default:S1,__esModule:!0}});zt(Mf);var Vu=It(function(t,r){r.__esModule=!0,t=vf&&vf.__esModule?vf:{default:vf};var i=Mf&&Mf.__esModule?Mf:{default:Mf},s=typeof i.default=="function"&&typeof t.default=="symbol"?function(f){return typeof f}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f};r.default=typeof i.default=="function"&&s(t.default)==="symbol"?function(f){return typeof f=="undefined"?"undefined":s(f)}:function(f){return f&&typeof i.default=="function"&&f.constructor===i.default&&f!==i.default.prototype?"symbol":typeof f=="undefined"?"undefined":s(f)}}),Zs=zt(Vu),Ko=function(t,r){if(!Yi(t)||t._t!==r)throw TypeError("Incompatible receiver, "+r+" required!");return t},I1=wo.f,Em=Os.fastKey,bh=Yo?"_s":"size",Ka=function(t,r){var i=Em(r);if(i!=="F")return t._i[i];for(t=t._f;t;t=t.n)if(t.k==r)return t},_d={getConstructor:function(t,r,i,s){var f=t(function(c,g){Mo(c,f,r,"_i"),c._t=r,c._i=Uu(null),c._f=void 0,c._l=void 0,c[bh]=0,g!=null&&Ni(g,i,c[s],c)});return sd(f.prototype,{clear:function(){for(var c=Ko(this,r),g=c._i,p=c._f;p;p=p.n)p.r=!0,p.p&&(p.p=p.p.n=void 0),delete g[p.i];c._f=c._l=void 0,c[bh]=0},delete:function(c){var g=Ko(this,r);if(c=Ka(g,c)){var p=c.n,A=c.p;delete g._i[c.i],c.r=!0,A&&(A.n=p),p&&(p.p=A),g._f==c&&(g._f=p),g._l==c&&(g._l=A),g[bh]--}return!!c},forEach:function(c){Ko(this,r);for(var g=ro(c,1<arguments.length?arguments[1]:void 0,3),p;p=p?p.n:this._f;)for(g(p.v,p.k,this);p&&p.r;)p=p.p},has:function(c){return!!Ka(Ko(this,r),c)}}),Yo&&I1(f.prototype,"size",{get:function(){return Ko(this,r)[bh]}}),f},def:function(t,r,i){var s=Ka(t,r),f;return s?s.v=i:(t._l=s={i:f=Em(r,!0),k:r,v:i,p:r=t._l,n:void 0,r:!1},t._f||(t._f=s),r&&(r.n=s),t[bh]++,f!=="F"&&(t._i[f]=s)),t},getEntry:Ka,setStrong:function(t,r,i){$p(t,r,function(s,f){this._t=Ko(s,r),this._k=f,this._l=void 0},function(){for(var s=this._k,f=this._l;f&&f.r;)f=f.p;return this._t&&(this._l=f=f?f.n:this._t._f)?s=="keys"?xa(0,f.k):s=="values"?xa(0,f.v):xa(0,[f.k,f.v]):(this._t=void 0,xa(1))},i?"entries":"values",!i,!0),l1(r)}},fA=Nn("species"),wa=function(t,r){if(Jo(t)){var i=t.constructor;typeof i!="function"||i!==Array&&!Jo(i.prototype)||(i=void 0),Yi(i)&&(i=i[fA],i===null&&(i=void 0))}return new(i===void 0?Array:i)(r)},Wu=function(t,r){var i=t==1,s=t==2,f=t==3,c=t==4,g=t==6,p=t==5||g,A=r||wa;return function(S,N,w){var I=Object(ln(S)),L=ya(I);N=ro(N,w,3),w=Wa(L.length);var P=0;S=i?A(S,w):s?A(S,0):void 0;for(var F,W;w>P;P++)if((p||P in L)&&(F=L[P],W=N(F,P,I),t)){if(i)S[P]=W;else if(W)switch(t){case 3:return!0;case 5:return F;case 6:return P;case 2:S.push(F)}else if(c)return!1}return g?-1:f||c?c:S}},wd=wo.f,E1=Wu(0),Vh=function(t,r,i,s,f,c){var g=Zr[t],p=g,A=f?"set":"add",S=p&&p.prototype,N={};return Yo&&typeof p=="function"&&(c||S.forEach&&!fo(function(){new p().entries().next()}))?(p=r(function(w,I){Mo(w,p,t,"_c"),w._c=new g,I!=null&&Ni(I,f,w[A],w)}),E1("add clear delete forEach get has set keys values entries toJSON".split(" "),function(w){var I=w=="add"||w=="set";w in S&&(!c||w!="clear")&&va(p.prototype,w,function(L,P){return Mo(this,p,w),!I&&c&&!Yi(L)?w=="get"?void 0:!1:(L=this._c[w](L===0?0:L,P),I?this:L)})}),c||wd(p.prototype,"size",{get:function(){return this._c.size}})):(p=s.getConstructor(r,t,f,A),sd(p.prototype,i),Os.NEED=!0),Hu(p,t),N[t]=p,Je(Je.G+Je.W+Je.F,N),c||s.setStrong(p,t,f),p};Vh("Map",function(t){return function(){return t(this,0<arguments.length?arguments[0]:void 0)}},{get:function(t){return(t=_d.getEntry(Ko(this,"Map"),t))&&t.v},set:function(t,r){return _d.def(Ko(this,"Map"),t===0?0:t,r)}},_d,!0),Je(Je.P+Je.R,"Map",{toJSON:function(t){return function(){if(Hh(this)!=t)throw TypeError(t+"#toJSON isn't generic");var r=[];return Ni(this,!1,r.push,r,void 0),r}}("Map")});var Cf=function(t){Je(Je.S,t,{of:function(){for(var r=arguments.length,i=Array(r);r--;)i[r]=arguments[r];return new this(i)}})};Cf("Map");var Lm=function(t){Je(Je.S,t,{from:function(r,i,s){var f;if(zl(this),(f=i!==void 0)&&zl(i),r==null)return new this;var c=[];if(f){var g=0,p=ro(i,s,2);Ni(r,!1,function(A){c.push(p(A,g++))})}else Ni(r,!1,c.push,c);return new this(c)}})};Lm("Map");var Rm=vi.Map,pA=It(function(t){t.exports={default:Rm,__esModule:!0}}),Pm=zt(pA);Je(Je.S+Je.F*!Yo,"Object",{defineProperty:wo.f});var Wh=vi.Object,Dm=function(t,r,i){return Wh.defineProperty(t,r,i)},Js=It(function(t){t.exports={default:Dm,__esModule:!0}}),Hn=zt(Js),L1=It(function(t,r){r.__esModule=!0;var i=Js&&Js.__esModule?Js:{default:Js};r.default=function(s,f,c){return f in s?(0,i.default)(s,f,{value:c,enumerable:!0,configurable:!0,writable:!0}):s[f]=c,s}}),zi=zt(L1),Om=Os.getWeak,ju=Wu(5),Xu=Wu(6),dA=0,Tf=function(t){return t._l||(t._l=new jh)},jh=function(){this.a=[]},Xh=function(t,r){return ju(t.a,function(i){return i[0]===r})};jh.prototype={get:function(t){if(t=Xh(this,t))return t[1]},has:function(t){return!!Xh(this,t)},set:function(t,r){var i=Xh(this,t);i?i[1]=r:this.a.push([t,r])},delete:function(t){var r=Xu(this.a,function(i){return i[0]===t});return~r&&this.a.splice(r,1),!!~r}};var Yh={getConstructor:function(t,r,i,s){var f=t(function(c,g){Mo(c,f,r,"_i"),c._t=r,c._i=dA++,c._l=void 0,g!=null&&Ni(g,i,c[s],c)});return sd(f.prototype,{delete:function(c){if(!Yi(c))return!1;var g=Om(c);return g===!0?Tf(Ko(this,r)).delete(c):g&&Gi(g,this._i)&&delete g[this._i]},has:function(c){if(!Yi(c))return!1;var g=Om(c);return g===!0?Tf(Ko(this,r)).has(c):g&&Gi(g,this._i)}}),f},def:function(t,r,i){var s=Om(co(r),!0);return s===!0?Tf(t).set(r,i):s[t._i]=i,t},ufstore:Tf};It(function(t){var r=Wu(0),i=!Zr.ActiveXObject&&"ActiveXObject"in Zr,s=Os.getWeak,f=Object.isExtensible,c=Yh.ufstore,g=function(N){return function(){return N(this,0<arguments.length?arguments[0]:void 0)}},p={get:function(N){if(Yi(N)){var w=s(N);return w===!0?c(Ko(this,"WeakMap")).get(N):w?w[this._i]:void 0}},set:function(N,w){return Yh.def(Ko(this,"WeakMap"),N,w)}},A=t.exports=Vh("WeakMap",g,p,Yh,!0,!0);if(Ko&&i){var S=Yh.getConstructor(g,"WeakMap");Uh(S.prototype,p),Os.NEED=!0,r(["delete","has","get","set"],function(N){var w=A.prototype,I=w[N];va(w,N,function(L,P){return Yi(L)&&!f(L)?(this._f||(this._f=new S),L=this._f[N](L,P),N=="set"?this:L):I.call(this,L,P)})})}}),Cf("WeakMap"),Lm("WeakMap");var gA=vi.WeakMap,mA=It(function(t){t.exports={default:gA,__esModule:!0}}),Zi=zt(mA);Ja("getPrototypeOf",function(){return function(t){return hm(Object(ln(t)))}});var vA=vi.Object.getPrototypeOf,yA=It(function(t){t.exports={default:vA,__esModule:!0}}),Xn=zt(yA),Yu=It(function(t,r){r.__esModule=!0,r.default=function(i,s){if(!(i instanceof s))throw new TypeError("Cannot call a class as a function")}}),Ri=zt(Yu),Zh=It(function(t,r){r.__esModule=!0;var i=Vu&&Vu.__esModule?Vu:{default:Vu};r.default=function(s,f){if(!s)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!f||(typeof f=="undefined"?"undefined":(0,i.default)(f))!=="object"&&typeof f!="function"?s:f}}),_n=zt(Zh),Sf=Object.setPrototypeOf||("__proto__"in{}?function(t,r,i){try{i=ro(Function.call,dd.f(Object.prototype,"__proto__").set,2),i(t,[]),r=!(t instanceof Array)}catch(s){r=!0}return function(s,f){if(co(s),!Yi(f)&&f!==null)throw TypeError(f+": can't set as prototype!");return r?s.__proto__=f:i(s,f),s}}({},!1):void 0);Je(Je.S,"Object",{setPrototypeOf:Sf});var xA=vi.Object.setPrototypeOf,R1=It(function(t){t.exports={default:xA,__esModule:!0}});zt(R1);var Zl=It(function(t,r){function i(g){return g&&g.__esModule?g:{default:g}}r.__esModule=!0;var s=i(R1),f=i(Y0),c=i(Vu);r.default=function(g,p){if(typeof p!="function"&&p!==null)throw new TypeError("Super expression must either be null or a function, not "+(typeof p=="undefined"?"undefined":(0,c.default)(p)));g.prototype=(0,f.default)(p&&p.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),p&&(s.default?(0,s.default)(g,p):g.__proto__=p)}}),Yn=zt(Zl);Ja("keys",function(){return function(t){return Ul(Object(ln(t)))}});var AA=vi.Object.keys,_A=It(function(t){t.exports={default:AA,__esModule:!0}}),Pi=zt(_A),P1=vi.JSON||(vi.JSON={stringify:JSON.stringify}),Fm=function(t){return P1.stringify.apply(P1,arguments)},wA=It(function(t){t.exports={default:Fm,__esModule:!0}}),Oo=zt(wA);Je(Je.S+Je.F*!Yo,"Object",{defineProperties:nm});var MA=vi.Object,CA=function(t,r){return MA.defineProperties(t,r)},TA=It(function(t){t.exports={default:CA,__esModule:!0}}),Gr=zt(TA);Je(Je.S,"Math",{sign:Math.sign||function(t){return(t=+t)==0||t!=t?t:0>t?-1:1}});var SA=vi.Math.sign,IA=It(function(t){t.exports={default:SA,__esModule:!0}}),Zu=zt(IA),EA=Math.floor;Je(Je.S,"Number",{isInteger:function(t){return!Yi(t)&&isFinite(t)&&EA(t)===t}});var D1=vi.Number.isInteger,LA=It(function(t){t.exports={default:D1,__esModule:!0}}),Jh=zt(LA);Je(Je.S,"Number",{EPSILON:Math.pow(2,-52)});var RA=Math.pow(2,-52),O1=It(function(t){t.exports={default:RA,__esModule:!0}}),hn=zt(O1);hn===void 0&&(Number.EPSILON=Math.pow(2,-52)),Jh===void 0&&(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t}),Zu===void 0&&(Math.sign=function(t){return 0>t?-1:0<t?1:+t}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),ut===void 0&&(Object.assign=function(t){if(t==null)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(t),i=1;i<arguments.length;i++){var s=arguments[i];if(s!=null)for(var f in s)Object.prototype.hasOwnProperty.call(s,f)&&(r[f]=s[f])}return r}),ut(se.prototype,{addEventListener:function(t,r){this._listeners===void 0&&(this._listeners={});var i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(r)===-1&&i[t].push(r)},hasEventListener:function(t,r){if(this._listeners===void 0)return!1;var i=this._listeners;return i[t]!==void 0&&i[t].indexOf(r)!==-1},removeEventListener:function(t,r){this._listeners!==void 0&&(t=this._listeners[t],t!==void 0&&(r=t.indexOf(r),r!==-1&&t.splice(r,1)))},dispatchEvent:function(t){if(this._listeners!==void 0){var r=this._listeners[t.type];if(r!==void 0){t.target=this,r=r.slice(0);for(var i=0,s=r.length;i<s;i++)r[i].call(this,t)}}}});for(var po=[],If=0;256>If;If++)po[If]=(16>If?"0":"")+If.toString(16);var Tr={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var t=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0;return(po[t&255]+po[t>>8&255]+po[t>>16&255]+po[t>>24&255]+"-"+po[r&255]+po[r>>8&255]+"-"+po[r>>16&15|64]+po[r>>24&255]+"-"+po[i&63|128]+po[i>>8&255]+"-"+po[i>>16&255]+po[i>>24&255]+po[s&255]+po[s>>8&255]+po[s>>16&255]+po[s>>24&255]).toUpperCase()},clamp:function(t,r,i){return Math.max(r,Math.min(i,t))},euclideanModulo:function(t,r){return(t%r+r)%r},mapLinear:function(t,r,i,s,f){return s+(t-r)*(f-s)/(i-r)},lerp:function(t,r,i){return(1-i)*t+i*r},smoothstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*(3-2*t))},smootherstep:function(t,r,i){return t<=r?0:t>=i?1:(t=(t-r)/(i-r),t*t*t*(t*(6*t-15)+10))},randInt:function(t,r){return t+Math.floor(Math.random()*(r-t+1))},randFloat:function(t,r){return t+Math.random()*(r-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Tr.DEG2RAD},radToDeg:function(t){return t*Tr.RAD2DEG},isPowerOfTwo:function(t){return(t&t-1)===0&&t!==0},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},setQuaternionFromProperEuler:function(t,r,i,s,f){var c=Math.cos,g=Math.sin,p=c(i/2);i=g(i/2);var A=c((r+s)/2),S=g((r+s)/2),N=c((r-s)/2),w=g((r-s)/2);switch(c=c((s-r)/2),r=g((s-r)/2),f){case"XYX":t.set(p*S,i*N,i*w,p*A);break;case"YZY":t.set(i*w,p*S,i*N,p*A);break;case"ZXZ":t.set(i*N,i*w,p*S,p*A);break;case"XZX":t.set(p*S,i*r,i*c,p*A);break;case"YXY":t.set(i*c,p*S,i*r,p*A);break;case"ZYZ":t.set(i*r,i*c,p*S,p*A);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+f)}}};Gr(vt.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),ut(vt.prototype,{isVector2:!0,set:function(t,r){return this.x=t,this.y=r,this},setScalar:function(t){return this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var r=this.x,i=this.y;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6],this.y=t[1]*r+t[4]*i+t[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},cross:function(t){return this.x*t.y-this.y*t.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x;return t=this.y-t.y,r*r+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this},rotateAround:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=this.x-t.x,f=this.y-t.y;return this.x=s*i-f*r+t.x,this.y=s*r+f*i+t.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),ut(Ot.prototype,{isMatrix3:!0,set:function(t,r,i,s,f,c,g,p,A){var S=this.elements;return S[0]=t,S[1]=s,S[2]=g,S[3]=r,S[4]=f,S[5]=p,S[6]=i,S[7]=c,S[8]=A,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],this},extractBasis:function(t,r,i){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this},setFromMatrix4:function(t){return t=t.elements,this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this},multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[3],c=i[6],g=i[1],p=i[4],A=i[7],S=i[2],N=i[5];i=i[8];var w=s[0],I=s[3],L=s[6],P=s[1],F=s[4],W=s[7],X=s[2],Z=s[5];return s=s[8],r[0]=t*w+f*P+c*X,r[3]=t*I+f*F+c*Z,r[6]=t*L+f*W+c*s,r[1]=g*w+p*P+A*X,r[4]=g*I+p*F+A*Z,r[7]=g*L+p*W+A*s,r[2]=S*w+N*P+i*X,r[5]=S*I+N*F+i*Z,r[8]=S*L+N*W+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[1],s=t[2],f=t[3],c=t[4],g=t[5],p=t[6],A=t[7];return t=t[8],r*c*t-r*g*A-i*f*t+i*g*p+s*f*A-s*c*p},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var i=t.elements;t=this.elements,r=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7];i=i[8];var N=i*g-p*S,w=p*A-i*c,I=S*c-g*A,L=r*N+s*w+f*I;return L===0?this.set(0,0,0,0,0,0,0,0,0):(L=1/L,t[0]=N*L,t[1]=(f*S-i*s)*L,t[2]=(p*s-f*g)*L,t[3]=w*L,t[4]=(i*r-f*A)*L,t[5]=(f*c-p*r)*L,t[6]=I*L,t[7]=(s*A-S*r)*L,t[8]=(g*r-s*c)*L,this)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[3],t[3]=r,r=t[2],t[2]=t[6],t[6]=r,r=t[5],t[5]=t[7],t[7]=r,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this},setUvTransform:function(t,r,i,s,f,c,g){var p=Math.cos(f);f=Math.sin(f),this.set(i*p,i*f,-i*(p*c+f*g)+c+t,-s*f,s*p,-s*(-f*c+p*g)+g+r,0,0,1)},scale:function(t,r){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=r,i[4]*=r,i[7]*=r,this},rotate:function(t){var r=Math.cos(t);t=Math.sin(t);var i=this.elements,s=i[0],f=i[3],c=i[6],g=i[1],p=i[4],A=i[7];return i[0]=r*s+t*g,i[3]=r*f+t*p,i[6]=r*c+t*A,i[1]=-t*s+r*g,i[4]=-t*f+r*p,i[7]=-t*c+r*A,this},translate:function(t,r){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=r*i[2],i[4]+=r*i[5],i[7]+=r*i[8],this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;9>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;9>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t}});var Jl,go={getDataURL:function(t){if(typeof HTMLCanvasElement=="undefined")return t.src;if(!(t instanceof HTMLCanvasElement)){Jl===void 0&&(Jl=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Jl.width=t.width,Jl.height=t.height;var r=Jl.getContext("2d");t instanceof ImageData?r.putImageData(t,0,0):r.drawImage(t,0,0,t.width,t.height),t=Jl}return 2048<t.width||2048<t.height?t.toDataURL("image/jpeg",.6):t.toDataURL("image/png")}},PA=0;Lt.DEFAULT_IMAGE=void 0,Lt.DEFAULT_MAPPING=300,Lt.prototype=ut(at(se.prototype),{constructor:Lt,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var r=t===void 0||typeof t=="string";if(!r&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var s=this.image;if(s.uuid===void 0&&(s.uuid=Tr.generateUUID()),!r&&t.images[s.uuid]===void 0){if(Array.isArray(s))for(var f=[],c=0,g=s.length;c<g;c++)f.push(go.getDataURL(s[c]));else f=go.getDataURL(s);t.images[s.uuid]={uuid:s.uuid,url:f}}i.image=s.uuid}return r||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping!==300)return t;if(t.applyMatrix3(this.matrix),0>t.x||1<t.x)switch(this.wrapS){case 1e3:t.x-=Math.floor(t.x);break;case 1001:t.x=0>t.x?0:1;break;case 1002:t.x=Math.abs(Math.floor(t.x)%2)===1?Math.ceil(t.x)-t.x:t.x-Math.floor(t.x)}if(0>t.y||1<t.y)switch(this.wrapT){case 1e3:t.y-=Math.floor(t.y);break;case 1001:t.y=0>t.y?0:1;break;case 1002:t.y=Math.abs(Math.floor(t.y)%2)===1?Math.ceil(t.y)-t.y:t.y-Math.floor(t.y)}return this.flipY&&(t.y=1-t.y),t}}),Object.defineProperty(Lt.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Gr(_t.prototype,{width:{get:function(){return this.z},set:function(t){this.z=t}},height:{get:function(){return this.w},set:function(t){this.w=t}}}),ut(_t.prototype,{isVector4:!0,set:function(t,r,i,s){return this.x=t,this.y=r,this.z=i,this.w=s,this},setScalar:function(t){return this.w=this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z,f=this.w;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s+t[12]*f,this.y=t[1]*r+t[5]*i+t[9]*s+t[13]*f,this.z=t[2]*r+t[6]*i+t[10]*s+t[14]*f,this.w=t[3]*r+t[7]*i+t[11]*s+t[15]*f,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var r=Math.sqrt(1-t.w*t.w);return 1e-4>r?(this.x=1,this.z=this.y=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this},setAxisAngleFromRotationMatrix:function(t){t=t.elements;var r=t[0],i=t[4],s=t[8],f=t[1],c=t[5],g=t[9],p=t[2],A=t[6],S=t[10];return .01>Math.abs(i-f)&&.01>Math.abs(s-p)&&.01>Math.abs(g-A)?.1>Math.abs(i+f)&&.1>Math.abs(s+p)&&.1>Math.abs(g+A)&&.1>Math.abs(r+c+S-3)?(this.set(1,0,0,0),this):(t=Math.PI,r=(r+1)/2,c=(c+1)/2,S=(S+1)/2,i=(i+f)/4,s=(s+p)/4,g=(g+A)/4,r>c&&r>S?.01>r?(A=0,i=p=.707106781):(A=Math.sqrt(r),p=i/A,i=s/A):c>S?.01>c?(A=.707106781,p=0,i=.707106781):(p=Math.sqrt(c),A=i/p,i=g/p):.01>S?(p=A=.707106781,i=0):(i=Math.sqrt(S),A=s/i,p=g/i),this.set(A,p,i,t),this):(t=Math.sqrt((A-g)*(A-g)+(s-p)*(s-p)+(f-i)*(f-i)),.001>Math.abs(t)&&(t=1),this.x=(A-g)/t,this.y=(s-p)/t,this.z=(f-i)/t,this.w=Math.acos((r+c+S-1)/2),this)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this.w=Math.max(t.w,Math.min(r.w,this.w)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this.w=Math.max(t,Math.min(r,this.w)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this.w=t.w+(r.w-t.w)*i,this},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),Ft.prototype=ut(at(se.prototype),{constructor:Ft,isWebGLRenderTarget:!0,setSize:function(t,r){(this.width!==t||this.height!==r)&&(this.width=t,this.height=r,this.texture.image.width=t,this.texture.image.height=r,this.dispose()),this.viewport.set(0,0,t,r),this.scissor.set(0,0,t,r)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),$t.prototype=ut(at(Ft.prototype),{constructor:$t,isWebGLMultisampleRenderTarget:!0,copy:function(t){return Ft.prototype.copy.call(this,t),this.samples=t.samples,this}}),ut(jt,{slerp:function(t,r,i,s){return i.copy(t).slerp(r,s)},slerpFlat:function(t,r,i,s,f,c,g){var p=i[s+0],A=i[s+1],S=i[s+2];i=i[s+3],s=f[c+0];var N=f[c+1],w=f[c+2];if(f=f[c+3],i!==f||p!==s||A!==N||S!==w){c=1-g;var I=p*s+A*N+S*w+i*f,L=0<=I?1:-1,P=1-I*I;P>hn&&(P=Math.sqrt(P),I=Math.atan2(P,I*L),c=Math.sin(c*I)/P,g=Math.sin(g*I)/P),L*=g,p=p*c+s*L,A=A*c+N*L,S=S*c+w*L,i=i*c+f*L,c===1-g&&(g=1/Math.sqrt(p*p+A*A+S*S+i*i),p*=g,A*=g,S*=g,i*=g)}t[r]=p,t[r+1]=A,t[r+2]=S,t[r+3]=i},multiplyQuaternionsFlat:function(t,r,i,s,f,c){var g=i[s],p=i[s+1],A=i[s+2];i=i[s+3],s=f[c];var S=f[c+1],N=f[c+2];return f=f[c+3],t[r]=g*f+i*s+p*N-A*S,t[r+1]=p*f+i*S+A*s-g*N,t[r+2]=A*f+i*N+g*S-p*s,t[r+3]=i*f-g*s-p*S-A*N,t}}),Gr(jt.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this._onChangeCallback()}}}),ut(jt.prototype,{isQuaternion:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._w=s,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this},setFromEuler:function(t,r){if(!t||!t.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,s=t._y,f=t._z;t=t.order;var c=Math.cos,g=Math.sin,p=c(i/2),A=c(s/2);switch(c=c(f/2),i=g(i/2),s=g(s/2),f=g(f/2),t){case"XYZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"YXZ":this._x=i*A*c+p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"ZXY":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c-i*s*f;break;case"ZYX":this._x=i*A*c-p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c+i*s*f;break;case"YZX":this._x=i*A*c+p*s*f,this._y=p*s*c+i*A*f,this._z=p*A*f-i*s*c,this._w=p*A*c-i*s*f;break;case"XZY":this._x=i*A*c-p*s*f,this._y=p*s*c-i*A*f,this._z=p*A*f+i*s*c,this._w=p*A*c+i*s*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+t)}return r!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(t,r){r/=2;var i=Math.sin(r);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(r),this._onChangeCallback(),this},setFromRotationMatrix:function(t){var r=t.elements,i=r[0];t=r[4];var s=r[8],f=r[1],c=r[5],g=r[9],p=r[2],A=r[6];r=r[10];var S=i+c+r;return 0<S?(i=.5/Math.sqrt(S+1),this._w=.25/i,this._x=(A-g)*i,this._y=(s-p)*i,this._z=(f-t)*i):i>c&&i>r?(i=2*Math.sqrt(1+i-c-r),this._w=(A-g)/i,this._x=.25*i,this._y=(t+f)/i,this._z=(s+p)/i):c>r?(i=2*Math.sqrt(1+c-i-r),this._w=(s-p)/i,this._x=(t+f)/i,this._y=.25*i,this._z=(g+A)/i):(i=2*Math.sqrt(1+r-i-c),this._w=(f-t)/i,this._x=(s+p)/i,this._y=(g+A)/i,this._z=.25*i),this._onChangeCallback(),this},setFromUnitVectors:function(t,r){var i=t.dot(r)+1;return 1e-6>i?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0):(this._x=0,this._y=-t.z,this._z=t.y)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x),this._w=i,this.normalize()},angleTo:function(t){return 2*Math.acos(Math.abs(Tr.clamp(this.dot(t),-1,1)))},rotateTowards:function(t,r){var i=this.angleTo(t);return i===0?this:(this.slerp(t,Math.min(1,r/i)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return t===0?(this._z=this._y=this._x=0,this._w=1):(t=1/t,this._x*=t,this._y*=t,this._z*=t,this._w*=t),this._onChangeCallback(),this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,r)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,r){var i=t._x,s=t._y,f=t._z;t=t._w;var c=r._x,g=r._y,p=r._z;return r=r._w,this._x=i*r+t*c+s*p-f*g,this._y=s*r+t*g+f*c-i*p,this._z=f*r+t*p+i*g-s*c,this._w=t*r-i*c-s*g-f*p,this._onChangeCallback(),this},slerp:function(t,r){if(r===0)return this;if(r===1)return this.copy(t);var i=this._x,s=this._y,f=this._z,c=this._w,g=c*t._w+i*t._x+s*t._y+f*t._z;if(0>g?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,g=-g):this.copy(t),1<=g)return this._w=c,this._x=i,this._y=s,this._z=f,this;if(t=1-g*g,t<=hn)return g=1-r,this._w=g*c+r*this._w,this._x=g*i+r*this._x,this._y=g*s+r*this._y,this._z=g*f+r*this._z,this.normalize(),this._onChangeCallback(),this;t=Math.sqrt(t);var p=Math.atan2(t,g);return g=Math.sin((1-r)*p)/t,r=Math.sin(r*p)/t,this._w=c*g+this._w*r,this._x=i*g+this._x*r,this._y=s*g+this._y*r,this._z=f*g+this._z*r,this._onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,r){return r===void 0&&(r=0),this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t},fromBufferAttribute:function(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}});var qs=new ot,Bm=new jt;ut(ot.prototype,{isVector3:!0,set:function(t,r,i){return this.x=t,this.y=r,this.z=i,this},setScalar:function(t){return this.z=this.y=this.x=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,r)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this},addScaledVector:function(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this},sub:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,r)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,r)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this},applyEuler:function(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Bm.setFromEuler(t))},applyAxisAngle:function(t,r){return this.applyQuaternion(Bm.setFromAxisAngle(t,r))},applyMatrix3:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[3]*i+t[6]*s,this.y=t[1]*r+t[4]*i+t[7]*s,this.z=t[2]*r+t[5]*i+t[8]*s,this},applyNormalMatrix:function(t){return this.applyMatrix3(t).normalize()},applyMatrix4:function(t){var r=this.x,i=this.y,s=this.z;t=t.elements;var f=1/(t[3]*r+t[7]*i+t[11]*s+t[15]);return this.x=(t[0]*r+t[4]*i+t[8]*s+t[12])*f,this.y=(t[1]*r+t[5]*i+t[9]*s+t[13])*f,this.z=(t[2]*r+t[6]*i+t[10]*s+t[14])*f,this},applyQuaternion:function(t){var r=this.x,i=this.y,s=this.z,f=t.x,c=t.y,g=t.z;t=t.w;var p=t*r+c*s-g*i,A=t*i+g*r-f*s,S=t*s+f*i-c*r;return r=-f*r-c*i-g*s,this.x=p*t+r*-f+A*-g-S*-c,this.y=A*t+r*-c+S*-f-p*-g,this.z=S*t+r*-g+p*-c-A*-f,this},project:function(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)},unproject:function(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)},transformDirection:function(t){var r=this.x,i=this.y,s=this.z;return t=t.elements,this.x=t[0]*r+t[4]*i+t[8]*s,this.y=t[1]*r+t[5]*i+t[9]*s,this.z=t[2]*r+t[6]*i+t[10]*s,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,r){return this.x=Math.max(t.x,Math.min(r.x,this.x)),this.y=Math.max(t.y,Math.min(r.y,this.y)),this.z=Math.max(t.z,Math.min(r.z,this.z)),this},clampScalar:function(t,r){return this.x=Math.max(t,Math.min(r,this.x)),this.y=Math.max(t,Math.min(r,this.y)),this.z=Math.max(t,Math.min(r,this.z)),this},clampLength:function(t,r){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(r,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this},lerpVectors:function(t,r,i){return this.x=t.x+(r.x-t.x)*i,this.y=t.y+(r.y-t.y)*i,this.z=t.z+(r.z-t.z)*i,this},cross:function(t,r){return r!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,r)):this.crossVectors(this,t)},crossVectors:function(t,r){var i=t.x,s=t.y;t=t.z;var f=r.x,c=r.y;return r=r.z,this.x=s*r-t*c,this.y=t*f-i*r,this.z=i*c-s*f,this},projectOnVector:function(t){var r=t.lengthSq();return r===0?this.set(0,0,0):(r=t.dot(this)/r,this.copy(t).multiplyScalar(r))},projectOnPlane:function(t){return qs.copy(this).projectOnVector(t),this.sub(qs)},reflect:function(t){return this.sub(qs.copy(t).multiplyScalar(2*this.dot(t)))},angleTo:function(t){var r=Math.sqrt(this.lengthSq()*t.lengthSq());return r===0?Math.PI/2:(t=this.dot(t)/r,Math.acos(Tr.clamp(t,-1,1)))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var r=this.x-t.x,i=this.y-t.y;return t=this.z-t.z,r*r+i*i+t*t},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)},setFromSphericalCoords:function(t,r,i){var s=Math.sin(r)*t;return this.x=s*Math.sin(i),this.y=Math.cos(r)*t,this.z=s*Math.cos(i),this},setFromCylindrical:function(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)},setFromCylindricalCoords:function(t,r,i){return this.x=t*Math.sin(r),this.y=i,this.z=t*Math.cos(r),this},setFromMatrixPosition:function(t){return t=t.elements,this.x=t[12],this.y=t[13],this.z=t[14],this},setFromMatrixScale:function(t){var r=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length();return t=this.setFromMatrixColumn(t,2).length(),this.x=r,this.y=i,this.z=t,this},setFromMatrixColumn:function(t,r){return this.fromArray(t.elements,4*r)},setFromMatrix3Column:function(t,r){return this.fromArray(t.elements,3*r)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,r){return r===void 0&&(r=0),this.x=t[r],this.y=t[r+1],this.z=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t},fromBufferAttribute:function(t,r,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var Ju=new ot,Ks=new Ie,qh=new ot(0,0,0),F1=new ot(1,1,1),qu=new ot,Md=new ot,Qo=new ot;ut(Ie.prototype,{isMatrix4:!0,set:function(t,r,i,s,f,c,g,p,A,S,N,w,I,L,P,F){var W=this.elements;return W[0]=t,W[4]=r,W[8]=i,W[12]=s,W[1]=f,W[5]=c,W[9]=g,W[13]=p,W[2]=A,W[6]=S,W[10]=N,W[14]=w,W[3]=I,W[7]=L,W[11]=P,W[15]=F,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new Ie().fromArray(this.elements)},copy:function(t){var r=this.elements;return t=t.elements,r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15],this},copyPosition:function(t){var r=this.elements;return t=t.elements,r[12]=t[12],r[13]=t[13],r[14]=t[14],this},extractBasis:function(t,r,i){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,r,i){return this.set(t.x,r.x,i.x,0,t.y,r.y,i.y,0,t.z,r.z,i.z,0,0,0,0,1),this},extractRotation:function(t){var r=this.elements,i=t.elements,s=1/Ju.setFromMatrixColumn(t,0).length(),f=1/Ju.setFromMatrixColumn(t,1).length();return t=1/Ju.setFromMatrixColumn(t,2).length(),r[0]=i[0]*s,r[1]=i[1]*s,r[2]=i[2]*s,r[3]=0,r[4]=i[4]*f,r[5]=i[5]*f,r[6]=i[6]*f,r[7]=0,r[8]=i[8]*t,r[9]=i[9]*t,r[10]=i[10]*t,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var r=this.elements,i=t.x,s=t.y,f=t.z,c=Math.cos(i);i=Math.sin(i);var g=Math.cos(s);s=Math.sin(s);var p=Math.cos(f);if(f=Math.sin(f),t.order==="XYZ"){t=c*p;var A=c*f,S=i*p,N=i*f;r[0]=g*p,r[4]=-g*f,r[8]=s,r[1]=A+S*s,r[5]=t-N*s,r[9]=-i*g,r[2]=N-t*s,r[6]=S+A*s,r[10]=c*g}else t.order==="YXZ"?(t=g*p,A=g*f,S=s*p,N=s*f,r[0]=t+N*i,r[4]=S*i-A,r[8]=c*s,r[1]=c*f,r[5]=c*p,r[9]=-i,r[2]=A*i-S,r[6]=N+t*i,r[10]=c*g):t.order==="ZXY"?(t=g*p,A=g*f,S=s*p,N=s*f,r[0]=t-N*i,r[4]=-c*f,r[8]=S+A*i,r[1]=A+S*i,r[5]=c*p,r[9]=N-t*i,r[2]=-c*s,r[6]=i,r[10]=c*g):t.order==="ZYX"?(t=c*p,A=c*f,S=i*p,N=i*f,r[0]=g*p,r[4]=S*s-A,r[8]=t*s+N,r[1]=g*f,r[5]=N*s+t,r[9]=A*s-S,r[2]=-s,r[6]=i*g,r[10]=c*g):t.order==="YZX"?(t=c*g,A=c*s,S=i*g,N=i*s,r[0]=g*p,r[4]=N-t*f,r[8]=S*f+A,r[1]=f,r[5]=c*p,r[9]=-i*p,r[2]=-s*p,r[6]=A*f+S,r[10]=t-N*f):t.order==="XZY"&&(t=c*g,A=c*s,S=i*g,N=i*s,r[0]=g*p,r[4]=-f,r[8]=s*p,r[1]=t*f+N,r[5]=c*p,r[9]=A*f-S,r[2]=S*f-A,r[6]=i*p,r[10]=N*f+t);return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this},makeRotationFromQuaternion:function(t){return this.compose(qh,t,F1)},lookAt:function(t,r,i){var s=this.elements;return Qo.subVectors(t,r),Qo.lengthSq()===0&&(Qo.z=1),Qo.normalize(),qu.crossVectors(i,Qo),qu.lengthSq()===0&&(Math.abs(i.z)===1?Qo.x+=1e-4:Qo.z+=1e-4,Qo.normalize(),qu.crossVectors(i,Qo)),qu.normalize(),Md.crossVectors(Qo,qu),s[0]=qu.x,s[4]=Md.x,s[8]=Qo.x,s[1]=qu.y,s[5]=Md.y,s[9]=Qo.y,s[2]=qu.z,s[6]=Md.z,s[10]=Qo.z,this},multiply:function(t,r){return r!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,r)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,r){var i=t.elements,s=r.elements;r=this.elements,t=i[0];var f=i[4],c=i[8],g=i[12],p=i[1],A=i[5],S=i[9],N=i[13],w=i[2],I=i[6],L=i[10],P=i[14],F=i[3],W=i[7],X=i[11];i=i[15];var Z=s[0],tt=s[4],st=s[8],xt=s[12],At=s[1],yt=s[5],Ut=s[9],kt=s[13],ne=s[2],Wt=s[6],re=s[10],be=s[14],ce=s[3],tr=s[7],yr=s[11];return s=s[15],r[0]=t*Z+f*At+c*ne+g*ce,r[4]=t*tt+f*yt+c*Wt+g*tr,r[8]=t*st+f*Ut+c*re+g*yr,r[12]=t*xt+f*kt+c*be+g*s,r[1]=p*Z+A*At+S*ne+N*ce,r[5]=p*tt+A*yt+S*Wt+N*tr,r[9]=p*st+A*Ut+S*re+N*yr,r[13]=p*xt+A*kt+S*be+N*s,r[2]=w*Z+I*At+L*ne+P*ce,r[6]=w*tt+I*yt+L*Wt+P*tr,r[10]=w*st+I*Ut+L*re+P*yr,r[14]=w*xt+I*kt+L*be+P*s,r[3]=F*Z+W*At+X*ne+i*ce,r[7]=F*tt+W*yt+X*Wt+i*tr,r[11]=F*st+W*Ut+X*re+i*yr,r[15]=F*xt+W*kt+X*be+i*s,this},multiplyScalar:function(t){var r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this},determinant:function(){var t=this.elements,r=t[0],i=t[4],s=t[8],f=t[12],c=t[1],g=t[5],p=t[9],A=t[13],S=t[2],N=t[6],w=t[10],I=t[14];return t[3]*(+f*p*N-s*A*N-f*g*w+i*A*w+s*g*I-i*p*I)+t[7]*(+r*p*I-r*A*w+f*c*w-s*c*I+s*A*S-f*p*S)+t[11]*(+r*A*N-r*g*I-f*c*N+i*c*I+f*g*S-i*A*S)+t[15]*(-s*g*S-r*p*N+r*g*w+s*c*N-i*c*w+i*p*S)},transpose:function(){var t=this.elements,r=t[1];return t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this},setPosition:function(t,r,i){var s=this.elements;return t.isVector3?(s[12]=t.x,s[13]=t.y,s[14]=t.z):(s[12]=t,s[13]=r,s[14]=i),this},getInverse:function(t,r){r!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),r=this.elements;var i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7],N=i[8],w=i[9],I=i[10],L=i[11],P=i[12],F=i[13],W=i[14];i=i[15];var X=w*W*S-F*I*S+F*A*L-p*W*L-w*A*i+p*I*i,Z=P*I*S-N*W*S-P*A*L+g*W*L+N*A*i-g*I*i,tt=N*F*S-P*w*S+P*p*L-g*F*L-N*p*i+g*w*i,st=P*w*A-N*F*A-P*p*I+g*F*I+N*p*W-g*w*W,xt=t*X+s*Z+f*tt+c*st;return xt===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(xt=1/xt,r[0]=X*xt,r[1]=(F*I*c-w*W*c-F*f*L+s*W*L+w*f*i-s*I*i)*xt,r[2]=(p*W*c-F*A*c+F*f*S-s*W*S-p*f*i+s*A*i)*xt,r[3]=(w*A*c-p*I*c-w*f*S+s*I*S+p*f*L-s*A*L)*xt,r[4]=Z*xt,r[5]=(N*W*c-P*I*c+P*f*L-t*W*L-N*f*i+t*I*i)*xt,r[6]=(P*A*c-g*W*c-P*f*S+t*W*S+g*f*i-t*A*i)*xt,r[7]=(g*I*c-N*A*c+N*f*S-t*I*S-g*f*L+t*A*L)*xt,r[8]=tt*xt,r[9]=(P*w*c-N*F*c-P*s*L+t*F*L+N*s*i-t*w*i)*xt,r[10]=(g*F*c-P*p*c+P*s*S-t*F*S-g*s*i+t*p*i)*xt,r[11]=(N*p*c-g*w*c-N*s*S+t*w*S+g*s*L-t*p*L)*xt,r[12]=st*xt,r[13]=(N*F*f-P*w*f+P*s*I-t*F*I-N*s*W+t*w*W)*xt,r[14]=(P*p*f-g*F*f-P*s*A+t*F*A+g*s*W-t*p*W)*xt,r[15]=(g*w*f-N*p*f+N*s*A-t*w*A-g*s*I+t*p*I)*xt,this)},scale:function(t){var r=this.elements,i=t.x,s=t.y;return t=t.z,r[0]*=i,r[4]*=s,r[8]*=t,r[1]*=i,r[5]*=s,r[9]*=t,r[2]*=i,r[6]*=s,r[10]*=t,r[3]*=i,r[7]*=s,r[11]*=t,this},getMaxScaleOnAxis:function(){var t=this.elements;return Math.sqrt(Math.max(t[0]*t[0]+t[1]*t[1]+t[2]*t[2],t[4]*t[4]+t[5]*t[5]+t[6]*t[6],t[8]*t[8]+t[9]*t[9]+t[10]*t[10]))},makeTranslation:function(t,r,i){return this.set(1,0,0,t,0,1,0,r,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(1,0,0,0,0,r,-t,0,0,t,r,0,0,0,0,1),this},makeRotationY:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,0,t,0,0,1,0,0,-t,0,r,0,0,0,0,1),this},makeRotationZ:function(t){var r=Math.cos(t);return t=Math.sin(t),this.set(r,-t,0,0,t,r,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,r){var i=Math.cos(r);r=Math.sin(r);var s=1-i,f=t.x,c=t.y;t=t.z;var g=s*f,p=s*c;return this.set(g*f+i,g*c-r*t,g*t+r*c,0,g*c+r*t,p*c+i,p*t-r*f,0,g*t-r*c,p*t+r*f,s*t*t+i,0,0,0,0,1),this},makeScale:function(t,r,i){return this.set(t,0,0,0,0,r,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,r,i){return this.set(1,r,i,0,t,1,i,0,t,r,1,0,0,0,0,1),this},compose:function(t,r,i){var s=this.elements,f=r._x,c=r._y,g=r._z,p=r._w,A=f+f,S=c+c,N=g+g;r=f*A;var w=f*S;f*=N;var I=c*S;c*=N,g*=N,A*=p,S*=p,p*=N,N=i.x;var L=i.y;return i=i.z,s[0]=(1-(I+g))*N,s[1]=(w+p)*N,s[2]=(f-S)*N,s[3]=0,s[4]=(w-p)*L,s[5]=(1-(r+g))*L,s[6]=(c+A)*L,s[7]=0,s[8]=(f+S)*i,s[9]=(c-A)*i,s[10]=(1-(r+I))*i,s[11]=0,s[12]=t.x,s[13]=t.y,s[14]=t.z,s[15]=1,this},decompose:function(t,r,i){var s=this.elements,f=Ju.set(s[0],s[1],s[2]).length(),c=Ju.set(s[4],s[5],s[6]).length(),g=Ju.set(s[8],s[9],s[10]).length();0>this.determinant()&&(f=-f),t.x=s[12],t.y=s[13],t.z=s[14],Ks.copy(this),t=1/f,s=1/c;var p=1/g;return Ks.elements[0]*=t,Ks.elements[1]*=t,Ks.elements[2]*=t,Ks.elements[4]*=s,Ks.elements[5]*=s,Ks.elements[6]*=s,Ks.elements[8]*=p,Ks.elements[9]*=p,Ks.elements[10]*=p,r.setFromRotationMatrix(Ks),i.x=f,i.y=c,i.z=g,this},makePerspective:function(t,r,i,s,f,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var g=this.elements;return g[0]=2*f/(r-t),g[4]=0,g[8]=(r+t)/(r-t),g[12]=0,g[1]=0,g[5]=2*f/(i-s),g[9]=(i+s)/(i-s),g[13]=0,g[2]=0,g[6]=0,g[10]=-(c+f)/(c-f),g[14]=-2*c*f/(c-f),g[3]=0,g[7]=0,g[11]=-1,g[15]=0,this},makeOrthographic:function(t,r,i,s,f,c){var g=this.elements,p=1/(r-t),A=1/(i-s),S=1/(c-f);return g[0]=2*p,g[4]=0,g[8]=0,g[12]=-((r+t)*p),g[1]=0,g[5]=2*A,g[9]=0,g[13]=-((i+s)*A),g[2]=0,g[6]=0,g[10]=-2*S,g[14]=-((c+f)*S),g[3]=0,g[7]=0,g[11]=0,g[15]=1,this},equals:function(t){var r=this.elements;t=t.elements;for(var i=0;16>i;i++)if(r[i]!==t[i])return!1;return!0},fromArray:function(t,r){r===void 0&&(r=0);for(var i=0;16>i;i++)this.elements[i]=t[i+r];return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);var i=this.elements;return t[r]=i[0],t[r+1]=i[1],t[r+2]=i[2],t[r+3]=i[3],t[r+4]=i[4],t[r+5]=i[5],t[r+6]=i[6],t[r+7]=i[7],t[r+8]=i[8],t[r+9]=i[9],t[r+10]=i[10],t[r+11]=i[11],t[r+12]=i[12],t[r+13]=i[13],t[r+14]=i[14],t[r+15]=i[15],t}});var Nm=new Ie,Cd=new jt;Mr.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),Mr.DefaultOrder="XYZ",Gr(Mr.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this._onChangeCallback()}}}),ut(Mr.prototype,{isEuler:!0,set:function(t,r,i,s){return this._x=t,this._y=r,this._z=i,this._order=s||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this},setFromRotationMatrix:function(t,r,i){var s=Tr.clamp,f=t.elements;t=f[0];var c=f[4],g=f[8],p=f[1],A=f[5],S=f[9],N=f[2],w=f[6];switch(f=f[10],r=r||this._order,r){case"XYZ":this._y=Math.asin(s(g,-1,1)),.9999999>Math.abs(g)?(this._x=Math.atan2(-S,f),this._z=Math.atan2(-c,t)):(this._x=Math.atan2(w,A),this._z=0);break;case"YXZ":this._x=Math.asin(-s(S,-1,1)),.9999999>Math.abs(S)?(this._y=Math.atan2(g,f),this._z=Math.atan2(p,A)):(this._y=Math.atan2(-N,t),this._z=0);break;case"ZXY":this._x=Math.asin(s(w,-1,1)),.9999999>Math.abs(w)?(this._y=Math.atan2(-N,f),this._z=Math.atan2(-c,A)):(this._y=0,this._z=Math.atan2(p,t));break;case"ZYX":this._y=Math.asin(-s(N,-1,1)),.9999999>Math.abs(N)?(this._x=Math.atan2(w,f),this._z=Math.atan2(p,t)):(this._x=0,this._z=Math.atan2(-c,A));break;case"YZX":this._z=Math.asin(s(p,-1,1)),.9999999>Math.abs(p)?(this._x=Math.atan2(-S,A),this._y=Math.atan2(-N,t)):(this._x=0,this._y=Math.atan2(g,f));break;case"XZY":this._z=Math.asin(-s(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(w,A),this._y=Math.atan2(g,t)):(this._x=Math.atan2(-S,f),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,i!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(t,r,i){return Nm.makeRotationFromQuaternion(t),this.setFromRotationMatrix(Nm,r,i)},setFromVector3:function(t,r){return this.set(t.x,t.y,t.z,r||this._order)},reorder:function(t){return Cd.setFromEuler(this),this.setFromQuaternion(Cd,t)},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new ot(this._x,this._y,this._z)},_onChange:function(t){return this._onChangeCallback=t,this},_onChangeCallback:function(){}}),ut(Lr.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask=this.mask|1<<t|0},enableAll:function(){this.mask=-1},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},disableAll:function(){this.mask=0},test:function(t){return(this.mask&t.mask)!==0}});var B1=0,N1=new ot,Kh=new jt,Qa=new Ie,Td=new ot,Ef=new ot,DA=new ot,OA=new jt,zm=new ot(1,0,0),Um=new ot(0,1,0),Hm=new ot(0,0,1),FA={type:"added"},BA={type:"removed"};Ee.DefaultUp=new ot(0,1,0),Ee.DefaultMatrixAutoUpdate=!0,Ee.prototype=ut(at(se.prototype),{constructor:Ee,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,r){this.quaternion.setFromAxisAngle(t,r)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(t,r){return Kh.setFromAxisAngle(t,r),this.quaternion.multiply(Kh),this},rotateOnWorldAxis:function(t,r){return Kh.setFromAxisAngle(t,r),this.quaternion.premultiply(Kh),this},rotateX:function(t){return this.rotateOnAxis(zm,t)},rotateY:function(t){return this.rotateOnAxis(Um,t)},rotateZ:function(t){return this.rotateOnAxis(Hm,t)},translateOnAxis:function(t,r){return N1.copy(t).applyQuaternion(this.quaternion),this.position.add(N1.multiplyScalar(r)),this},translateX:function(t){return this.translateOnAxis(zm,t)},translateY:function(t){return this.translateOnAxis(Um,t)},translateZ:function(t){return this.translateOnAxis(Hm,t)},localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(t){return t.applyMatrix4(Qa.getInverse(this.matrixWorld))},lookAt:function(t,r,i){t.isVector3?Td.copy(t):Td.set(t,r,i),t=this.parent,this.updateWorldMatrix(!0,!1),Ef.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Qa.lookAt(Ef,Td,this.up):Qa.lookAt(Td,Ef,this.up),this.quaternion.setFromRotationMatrix(Qa),t&&(Qa.extractRotation(t.matrixWorld),Kh.setFromRotationMatrix(Qa),this.quaternion.premultiply(Kh.inverse()))},add:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(FA)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(1<arguments.length){for(var r=0;r<arguments.length;r++)this.remove(arguments[r]);return this}return r=this.children.indexOf(t),r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(BA)),this},attach:function(t){return this.updateWorldMatrix(!0,!1),Qa.getInverse(this.matrixWorld),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Qa.multiply(t.parent.matrixWorld)),t.applyMatrix4(Qa),t.updateWorldMatrix(!1,!1),this.add(t),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,r){if(this[t]===r)return this;for(var i=0,s=this.children.length;i<s;i++){var f=this.children[i].getObjectByProperty(t,r);if(f!==void 0)return f}},getWorldPosition:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new ot),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),t=new jt),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ef,t,DA),t},getWorldScale:function(t){return t===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),t=new ot),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Ef,OA,t),t},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()},raycast:function(){},traverse:function(t){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverse(t)},traverseVisible:function(t){if(this.visible!==!1){t(this);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].traverseVisible(t)}},traverseAncestors:function(t){var r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var r=this.children,i=0,s=r.length;i<s;i++)r[i].updateMatrixWorld(t)},updateWorldMatrix:function(t,r){var i=this.parent;if(t===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),r===!0)for(t=this.children,r=0,i=t.length;r<i;r++)t[r].updateWorldMatrix(!1,!0)},toJSON:function(t){function r(N,w){return N[w.uuid]===void 0&&(N[w.uuid]=w.toJSON(t)),w.uuid}function i(N){var w=[],I;for(I in N){var L=N[I];delete L.metadata,w.push(L)}return w}var s=t===void 0||typeof t=="string",f={};s&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},f.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var c={};if(c.uuid=this.uuid,c.type=this.type,this.name!==""&&(c.name=this.name),this.castShadow===!0&&(c.castShadow=!0),this.receiveShadow===!0&&(c.receiveShadow=!0),this.visible===!1&&(c.visible=!1),this.frustumCulled===!1&&(c.frustumCulled=!1),this.renderOrder!==0&&(c.renderOrder=this.renderOrder),Oo(this.userData)!=="{}"&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){c.geometry=r(t.geometries,this.geometry);var g=this.geometry.parameters;if(g!==void 0&&g.shapes!==void 0)if(g=g.shapes,Array.isArray(g))for(var p=0,A=g.length;p<A;p++)r(t.shapes,g[p]);else r(t.shapes,g)}if(this.material!==void 0)if(Array.isArray(this.material)){for(g=[],p=0,A=this.material.length;p<A;p++)g.push(r(t.materials,this.material[p]));c.material=g}else c.material=r(t.materials,this.material);if(0<this.children.length)for(c.children=[],p=0;p<this.children.length;p++)c.children.push(this.children[p].toJSON(t).object);if(s){s=i(t.geometries),p=i(t.materials),A=i(t.textures);var S=i(t.images);g=i(t.shapes),0<s.length&&(f.geometries=s),0<p.length&&(f.materials=p),0<A.length&&(f.textures=A),0<S.length&&(f.images=S),0<g.length&&(f.shapes=g)}return f.object=c,f},clone:function(t){return new this.constructor().copy(this,t)},copy:function(t,r){if(r===void 0&&(r=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(Oo(t.userData)),r===!0)for(r=0;r<t.children.length;r++)this.add(t.children[r].clone());return this}}),Yr.prototype=ut(at(Ee.prototype),{constructor:Yr,isScene:!0,copy:function(t,r){return Ee.prototype.copy.call(this,t,r),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var r=Ee.prototype.toJSON.call(this,t);return this.background!==null&&(r.object.background=this.background.toJSON(t)),this.environment!==null&&(r.object.environment=this.environment.toJSON(t)),this.fog!==null&&(r.object.fog=this.fog.toJSON()),r},dispose:function(){this.dispatchEvent({type:"dispose"})}});var $o=[new ot,new ot,new ot,new ot,new ot,new ot,new ot,new ot],ql=new ot,Sd=new li,Qs=new ot,Qh=new ot,$h=new ot,Ku=new ot,Qu=new ot,Kl=new ot,Lf=new ot,Id=new ot,Ed=new ot,Ql=new ot;ut(li.prototype,{isBox3:!0,set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromArray:function(t){for(var r=1/0,i=1/0,s=1/0,f=-1/0,c=-1/0,g=-1/0,p=0,A=t.length;p<A;p+=3){var S=t[p],N=t[p+1],w=t[p+2];S<r&&(r=S),N<i&&(i=N),w<s&&(s=w),S>f&&(f=S),N>c&&(c=N),w>g&&(g=w)}return this.min.set(r,i,s),this.max.set(f,c,g),this},setFromBufferAttribute:function(t){for(var r=1/0,i=1/0,s=1/0,f=-1/0,c=-1/0,g=-1/0,p=0,A=t.count;p<A;p++){var S=t.getX(p),N=t.getY(p),w=t.getZ(p);S<r&&(r=S),N<i&&(i=N),w<s&&(s=w),S>f&&(f=S),N>c&&(c=N),w>g&&(g=w)}return this.min.set(r,i,s),this.max.set(f,c,g),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=ql.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new ot),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(t){t.updateWorldMatrix(!1,!1);var r=t.geometry;r!==void 0&&(r.boundingBox===null&&r.computeBoundingBox(),Sd.copy(r.boundingBox),Sd.applyMatrix4(t.matrixWorld),this.union(Sd)),t=t.children,r=0;for(var i=t.length;r<i;r++)this.expandByObject(t[r]);return this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),r=new ot),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(t){return this.clampPoint(t.center,ql),ql.distanceToSquared(t.center)<=t.radius*t.radius},intersectsPlane:function(t){if(0<t.normal.x)var r=t.normal.x*this.min.x,i=t.normal.x*this.max.x;else r=t.normal.x*this.max.x,i=t.normal.x*this.min.x;return 0<t.normal.y?(r+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),0<t.normal.z?(r+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),r<=-t.constant&&i>=-t.constant},intersectsTriangle:function(t){return this.isEmpty()||(this.getCenter(Lf),Id.subVectors(this.max,Lf),Qs.subVectors(t.a,Lf),Qh.subVectors(t.b,Lf),$h.subVectors(t.c,Lf),Ku.subVectors(Qh,Qs),Qu.subVectors($h,Qh),Kl.subVectors(Qs,$h),t=[0,-Ku.z,Ku.y,0,-Qu.z,Qu.y,0,-Kl.z,Kl.y,Ku.z,0,-Ku.x,Qu.z,0,-Qu.x,Kl.z,0,-Kl.x,-Ku.y,Ku.x,0,-Qu.y,Qu.x,0,-Kl.y,Kl.x,0],!hi(t,Qs,Qh,$h,Id))||(t=[1,0,0,0,1,0,0,0,1],!hi(t,Qs,Qh,$h,Id))?!1:(Ed.crossVectors(Ku,Qu),t=[Ed.x,Ed.y,Ed.z],hi(t,Qs,Qh,$h,Id))},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),r=new ot),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return ql.copy(t).clamp(this.min,this.max).sub(t).length()},getBoundingSphere:function(t){return t===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(t.center),t.radius=.5*this.getSize(ql).length(),t},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(t){return this.isEmpty()?this:($o[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),$o[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),$o[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),$o[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),$o[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),$o[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),$o[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),$o[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints($o),this)},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var NA=new li;ut(Bi.prototype,{set:function(t,r){return this.center.copy(t),this.radius=r,this},setFromPoints:function(t,r){var i=this.center;r!==void 0?i.copy(r):NA.setFromPoints(t).getCenter(i);for(var s=r=0,f=t.length;s<f;s++)r=Math.max(r,i.distanceToSquared(t[s]));return this.radius=Math.sqrt(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,r){var i=this.center.distanceToSquared(t);return r===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),r=new ot),r.copy(t),i>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r},getBoundingBox:function(t){return t===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new li),this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius*=t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}});var $a=new ot,km=new ot,a=new ot,u=new ot,n=new ot,l=new ot,v=new ot;ut(fn.prototype,{set:function(t,r){return this.origin.copy(t),this.direction.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .at() target is now required"),r=new ot),r.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(t){return this.origin.copy(this.at(t,$a)),this},closestPointToPoint:function(t,r){return r===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),r=new ot),r.subVectors(t,this.origin),t=r.dot(this.direction),0>t?r.copy(this.origin):r.copy(this.direction).multiplyScalar(t).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(t){var r=$a.subVectors(t,this.origin).dot(this.direction);return 0>r?this.origin.distanceToSquared(t):($a.copy(this.direction).multiplyScalar(r).add(this.origin),$a.distanceToSquared(t))},distanceSqToSegment:function(t,r,i,s){km.copy(t).add(r).multiplyScalar(.5),a.copy(r).sub(t).normalize(),u.copy(this.origin).sub(km);var f=.5*t.distanceTo(r),c=-this.direction.dot(a),g=u.dot(this.direction),p=-u.dot(a),A=u.lengthSq(),S=Math.abs(1-c*c);if(0<S){t=c*p-g,r=c*g-p;var N=f*S;0<=t?r>=-N?r<=N?(f=1/S,t*=f,r*=f,c=t*(t+c*r+2*g)+r*(c*t+r+2*p)+A):(r=f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A):(r=-f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A):r<=-N?(t=Math.max(0,-(-c*f+g)),r=0<t?-f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A):r<=N?(t=0,r=Math.min(Math.max(-f,-p),f),c=r*(r+2*p)+A):(t=Math.max(0,-(c*f+g)),r=0<t?f:Math.min(Math.max(-f,-p),f),c=-t*t+r*(r+2*p)+A)}else r=0<c?-f:f,t=Math.max(0,-(c*r+g)),c=-t*t+r*(r+2*p)+A;return i&&i.copy(this.direction).multiplyScalar(t).add(this.origin),s&&s.copy(a).multiplyScalar(r).add(km),c},intersectSphere:function(t,r){$a.subVectors(t.center,this.origin);var i=$a.dot(this.direction),s=$a.dot($a)-i*i;return t=t.radius*t.radius,s>t?null:(t=Math.sqrt(t-s),s=i-t,i+=t,0>s&&0>i?null:0>s?this.at(i,r):this.at(s,r))},intersectsSphere:function(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius},distanceToPlane:function(t){var r=t.normal.dot(this.direction);return r===0?t.distanceToPoint(this.origin)===0?0:null:(t=-(this.origin.dot(t.normal)+t.constant)/r,0<=t?t:null)},intersectPlane:function(t,r){return t=this.distanceToPlane(t),t===null?null:this.at(t,r)},intersectsPlane:function(t){var r=t.distanceToPoint(this.origin);return r===0||0>t.normal.dot(this.direction)*r},intersectBox:function(t,r){var i=1/this.direction.x,s=1/this.direction.y,f=1/this.direction.z,c=this.origin;if(0<=i){var g=(t.min.x-c.x)*i;i*=t.max.x-c.x}else g=(t.max.x-c.x)*i,i*=t.min.x-c.x;if(0<=s){var p=(t.min.y-c.y)*s;s*=t.max.y-c.y}else p=(t.max.y-c.y)*s,s*=t.min.y-c.y;return g>s||p>i||((p>g||g!==g)&&(g=p),(s<i||i!==i)&&(i=s),0<=f?(p=(t.min.z-c.z)*f,t=(t.max.z-c.z)*f):(p=(t.max.z-c.z)*f,t=(t.min.z-c.z)*f),g>t||p>i)?null:((p>g||g!==g)&&(g=p),(t<i||i!==i)&&(i=t),0>i?null:this.at(0<=g?g:i,r))},intersectsBox:function(t){return this.intersectBox(t,$a)!==null},intersectTriangle:function(t,r,i,s,f){if(n.subVectors(r,t),l.subVectors(i,t),v.crossVectors(n,l),r=this.direction.dot(v),0<r){if(s)return null;s=1}else if(0>r)s=-1,r=-r;else return null;return u.subVectors(this.origin,t),t=s*this.direction.dot(l.crossVectors(u,l)),0>t||(i=s*this.direction.dot(n.cross(u)),0>i||t+i>r)?null:(t=-s*u.dot(v),0>t?null:this.at(t/r,f))},applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}});var d=new ot,x=new ot,y=new Ot;ut(_i.prototype,{isPlane:!0,set:function(t,r){return this.normal.copy(t),this.constant=r,this},setComponents:function(t,r,i,s){return this.normal.set(t,r,i),this.constant=s,this},setFromNormalAndCoplanarPoint:function(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this},setFromCoplanarPoints:function(t,r,i){return r=d.subVectors(i,r).cross(x.subVectors(t,r)).normalize(),this.setFromNormalAndCoplanarPoint(r,t),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,r){return r===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),r=new ot),r.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(t,r){r===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),r=new ot);var i=t.delta(d),s=this.normal.dot(i);if(s===0){if(this.distanceToPoint(t.start)===0)return r.copy(t.start)}else if(s=-(t.start.dot(this.normal)+this.constant)/s,!(0>s||1<s))return r.copy(i).multiplyScalar(s).add(t.start)},intersectsLine:function(t){var r=this.distanceToPoint(t.start);return t=this.distanceToPoint(t.end),0>r&&0<t||0>t&&0<r},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return t===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new ot),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(t,r){return r=r||y.getNormalMatrix(t),t=this.coplanarPoint(d).applyMatrix4(t),r=this.normal.applyMatrix3(r).normalize(),this.constant=-t.dot(r),this},translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}});var M=new ot,D=new ot,U=new ot,C=new ot,E=new ot,B=new ot,O=new ot,H=new ot,V=new ot,G=new ot;ut(Ci,{getNormal:function(t,r,i,s){return s===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),s=new ot),s.subVectors(i,r),M.subVectors(t,r),s.cross(M),t=s.lengthSq(),0<t?s.multiplyScalar(1/Math.sqrt(t)):s.set(0,0,0)},getBarycoord:function(t,r,i,s,f){M.subVectors(s,r),D.subVectors(i,r),U.subVectors(t,r),t=M.dot(M),r=M.dot(D),i=M.dot(U);var c=D.dot(D);s=D.dot(U);var g=t*c-r*r;return f===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),f=new ot),g===0?f.set(-2,-1,-1):(g=1/g,c=(c*i-r*s)*g,t=(t*s-r*i)*g,f.set(1-c-t,t,c))},containsPoint:function(t,r,i,s){return Ci.getBarycoord(t,r,i,s,C),0<=C.x&&0<=C.y&&1>=C.x+C.y},getUV:function(t,r,i,s,f,c,g,p){return this.getBarycoord(t,r,i,s,C),p.set(0,0),p.addScaledVector(f,C.x),p.addScaledVector(c,C.y),p.addScaledVector(g,C.z),p},isFrontFacing:function(t,r,i,s){return M.subVectors(i,r),D.subVectors(t,r),0>M.cross(D).dot(s)}}),ut(Ci.prototype,{set:function(t,r,i){return this.a.copy(t),this.b.copy(r),this.c.copy(i),this},setFromPointsAndIndices:function(t,r,i,s){return this.a.copy(t[r]),this.b.copy(t[i]),this.c.copy(t[s]),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){return M.subVectors(this.c,this.b),D.subVectors(this.a,this.b),.5*M.cross(D).length()},getMidpoint:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new ot),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Ci.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return t===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new _i),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,r){return Ci.getBarycoord(t,this.a,this.b,this.c,r)},getUV:function(t,r,i,s,f){return Ci.getUV(t,this.a,this.b,this.c,r,i,s,f)},containsPoint:function(t){return Ci.containsPoint(t,this.a,this.b,this.c)},isFrontFacing:function(t){return Ci.isFrontFacing(this.a,this.b,this.c,t)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(t,r){r===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),r=new ot);var i=this.a,s=this.b,f=this.c;E.subVectors(s,i),B.subVectors(f,i),H.subVectors(t,i);var c=E.dot(H),g=B.dot(H);if(0>=c&&0>=g)return r.copy(i);V.subVectors(t,s);var p=E.dot(V),A=B.dot(V);if(0<=p&&A<=p)return r.copy(s);var S=c*A-p*g;if(0>=S&&0<=c&&0>=p)return s=c/(c-p),r.copy(i).addScaledVector(E,s);G.subVectors(t,f),t=E.dot(G);var N=B.dot(G);return 0<=N&&t<=N?r.copy(f):(c=t*g-c*N,0>=c&&0<=g&&0>=N?(S=g/(g-N),r.copy(i).addScaledVector(B,S)):(g=p*N-t*A,0>=g&&0<=A-p&&0<=t-N?(O.subVectors(f,s),S=(A-p)/(A-p+(t-N)),r.copy(s).addScaledVector(O,S)):(f=1/(g+c+S),s=c*f,S*=f,r.copy(i).addScaledVector(E,s).addScaledVector(B,S))))},equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}});var j={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Y={h:0,s:0,l:0},$={h:0,s:0,l:0};ut(Vt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this},setScalar:function(t){return this.b=this.g=this.r=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,this},setRGB:function(t,r,i){return this.r=t,this.g=r,this.b=i,this},setHSL:function(t,r,i){return t=Tr.euclideanModulo(t,1),r=Tr.clamp(r,0,1),i=Tr.clamp(i,0,1),r===0?this.r=this.g=this.b=i:(r=.5>=i?i*(1+r):i+r-i*r,i=2*i-r,this.r=Re(i,r,t+1/3),this.g=Re(i,r,t),this.b=Re(i,r,t-1/3)),this},setStyle:function(t){function r(g){g!==void 0&&1>parseFloat(g)&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var s=i[2];switch(i[1]){case"rgb":case"rgba":if(i=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(255,parseInt(i[1],10))/255,this.g=Math.min(255,parseInt(i[2],10))/255,this.b=Math.min(255,parseInt(i[3],10))/255,r(i[5]),this;if(i=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s))return this.r=Math.min(100,parseInt(i[1],10))/100,this.g=Math.min(100,parseInt(i[2],10))/100,this.b=Math.min(100,parseInt(i[3],10))/100,r(i[5]),this;break;case"hsl":case"hsla":if(i=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(s)){s=parseFloat(i[1])/360;var f=parseInt(i[2],10)/100,c=parseInt(i[3],10)/100;return r(i[5]),this.setHSL(s,f,c)}}}else if(i=/^#([A-Fa-f0-9]+)$/.exec(t)){if(i=i[1],s=i.length,s===3)return this.r=parseInt(i.charAt(0)+i.charAt(0),16)/255,this.g=parseInt(i.charAt(1)+i.charAt(1),16)/255,this.b=parseInt(i.charAt(2)+i.charAt(2),16)/255,this;if(s===6)return this.r=parseInt(i.charAt(0)+i.charAt(1),16)/255,this.g=parseInt(i.charAt(2)+i.charAt(3),16)/255,this.b=parseInt(i.charAt(4)+i.charAt(5),16)/255,this}return t&&0<t.length?this.setColorName(t):this},setColorName:function(t){var r=j[t];return r!==void 0?this.setHex(r):console.warn("THREE.Color: Unknown color "+t),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,r){return r===void 0&&(r=2),this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},copyLinearToGamma:function(t,r){return r===void 0&&(r=2),r=0<r?1/r:1,this.r=Math.pow(t.r,r),this.g=Math.pow(t.g,r),this.b=Math.pow(t.b,r),this},convertGammaToLinear:function(t){return this.copyGammaToLinear(this,t),this},convertLinearToGamma:function(t){return this.copyLinearToGamma(this,t),this},copySRGBToLinear:function(t){return this.r=_e(t.r),this.g=_e(t.g),this.b=_e(t.b),this},copyLinearToSRGB:function(t){return this.r=ze(t.r),this.g=ze(t.g),this.b=ze(t.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){t===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var r=this.r,i=this.g,s=this.b,f=Math.max(r,i,s),c=Math.min(r,i,s),g,p=(c+f)/2;if(c===f)c=g=0;else{var A=f-c;switch(c=.5>=p?A/(f+c):A/(2-f-c),f){case r:g=(i-s)/A+(i<s?6:0);break;case i:g=(s-r)/A+2;break;case s:g=(r-i)/A+4}g/=6}return t.h=g,t.s=c,t.l=p,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,r,i){return this.getHSL(Y),Y.h+=t,Y.s+=r,Y.l+=i,this.setHSL(Y.h,Y.s,Y.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this},lerpHSL:function(t,r){this.getHSL(Y),t.getHSL($),t=Tr.lerp(Y.h,$.h,r);var i=Tr.lerp(Y.s,$.s,r);return r=Tr.lerp(Y.l,$.l,r),this.setHSL(t,i,r),this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,r){return r===void 0&&(r=0),this.r=t[r],this.g=t[r+1],this.b=t[r+2],this},toArray:function(t,r){return t===void 0&&(t=[]),r===void 0&&(r=0),t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t},toJSON:function(){return this.getHex()}}),Vt.NAMES=j,ut(nr.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var r=0,i=t.vertexNormals.length;r<i;r++)this.vertexNormals[r]=t.vertexNormals[r].clone();for(r=0,i=t.vertexColors.length;r<i;r++)this.vertexColors[r]=t.vertexColors[r].clone();return this}});var it=0;de.prototype=ut(at(se.prototype),{constructor:de,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(t!==void 0)for(var r in t){var i=t[r];if(i===void 0)console.warn("THREE.Material: '"+r+"' parameter is undefined.");else if(r==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===1;else{var s=this[r];s===void 0?console.warn("THREE."+this.type+": '"+r+"' is not a property of this material."):s&&s.isColor?s.set(i):s&&s.isVector3&&i&&i.isVector3?s.copy(i):this[r]=i}}},toJSON:function(t){function r(f){var c=[],g;for(g in f){var p=f[g];delete p.metadata,c.push(p)}return c}var i=t===void 0||typeof t=="string";i&&(t={textures:{},images:{}});var s={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return s.uuid=this.uuid,s.type=this.type,this.name!==""&&(s.name=this.name),this.color&&this.color.isColor&&(s.color=this.color.getHex()),this.roughness!==void 0&&(s.roughness=this.roughness),this.metalness!==void 0&&(s.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(s.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(s.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(s.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(s.specular=this.specular.getHex()),this.shininess!==void 0&&(s.shininess=this.shininess),this.clearcoat!==void 0&&(s.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(s.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(s.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(s.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,s.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(s.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(s.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(s.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(s.lightMap=this.lightMap.toJSON(t).uuid),this.aoMap&&this.aoMap.isTexture&&(s.aoMap=this.aoMap.toJSON(t).uuid,s.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(s.bumpMap=this.bumpMap.toJSON(t).uuid,s.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(s.normalMap=this.normalMap.toJSON(t).uuid,s.normalMapType=this.normalMapType,s.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(s.displacementMap=this.displacementMap.toJSON(t).uuid,s.displacementScale=this.displacementScale,s.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(s.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(s.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(s.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(s.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(s.envMap=this.envMap.toJSON(t).uuid,s.reflectivity=this.reflectivity,s.refractionRatio=this.refractionRatio,this.combine!==void 0&&(s.combine=this.combine),this.envMapIntensity!==void 0&&(s.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(s.gradientMap=this.gradientMap.toJSON(t).uuid),this.size!==void 0&&(s.size=this.size),this.sizeAttenuation!==void 0&&(s.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(s.blending=this.blending),this.flatShading===!0&&(s.flatShading=this.flatShading),this.side!==0&&(s.side=this.side),this.vertexColors&&(s.vertexColors=!0),1>this.opacity&&(s.opacity=this.opacity),this.transparent===!0&&(s.transparent=this.transparent),s.depthFunc=this.depthFunc,s.depthTest=this.depthTest,s.depthWrite=this.depthWrite,s.stencilWrite=this.stencilWrite,s.stencilWriteMask=this.stencilWriteMask,s.stencilFunc=this.stencilFunc,s.stencilRef=this.stencilRef,s.stencilFuncMask=this.stencilFuncMask,s.stencilFail=this.stencilFail,s.stencilZFail=this.stencilZFail,s.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(s.rotation=this.rotation),this.polygonOffset===!0&&(s.polygonOffset=!0),this.polygonOffsetFactor!==0&&(s.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(s.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(s.linewidth=this.linewidth),this.dashSize!==void 0&&(s.dashSize=this.dashSize),this.gapSize!==void 0&&(s.gapSize=this.gapSize),this.scale!==void 0&&(s.scale=this.scale),this.dithering===!0&&(s.dithering=!0),0<this.alphaTest&&(s.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(s.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(s.wireframe=this.wireframe),1<this.wireframeLinewidth&&(s.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(s.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(s.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(s.morphTargets=!0),this.morphNormals===!0&&(s.morphNormals=!0),this.skinning===!0&&(s.skinning=!0),this.visible===!1&&(s.visible=!1),this.toneMapped===!1&&(s.toneMapped=!1),Oo(this.userData)!=="{}"&&(s.userData=this.userData),i&&(i=r(t.textures),t=r(t.images),0<i.length&&(s.textures=i),0<t.length&&(s.images=t)),s},clone:function(){return new this.constructor().copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;var r=t.clippingPlanes,i=null;if(r!==null){var s=r.length;i=Array(s);for(var f=0;f!==s;++f)i[f]=r[f].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(Oo(t.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(de.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),Rr.prototype=at(de.prototype),Rr.prototype.constructor=Rr,Rr.prototype.isMeshBasicMaterial=!0,Rr.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this};var nt=new ot;Object.defineProperty(He.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),ut(He.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.itemSize,i*=r.itemSize;for(var s=0,f=this.itemSize;s<f;s++)this.array[t+s]=r.array[i+s];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",s),c=new Vt),r[i++]=c.r,r[i++]=c.g,r[i++]=c.b}return this},copyVector2sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",s),c=new vt),r[i++]=c.x,r[i++]=c.y}return this},copyVector3sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",s),c=new ot),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z}return this},copyVector4sArray:function(t){for(var r=this.array,i=0,s=0,f=t.length;s<f;s++){var c=t[s];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",s),c=new _t),r[i++]=c.x,r[i++]=c.y,r[i++]=c.z,r[i++]=c.w}return this},applyMatrix3:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyMatrix3(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},applyMatrix4:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyMatrix4(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},applyNormalMatrix:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.applyNormalMatrix(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},transformDirection:function(t){for(var r=0,i=this.count;r<i;r++)nt.x=this.getX(r),nt.y=this.getY(r),nt.z=this.getZ(r),nt.transformDirection(t),this.setXYZ(r,nt.x,nt.y,nt.z);return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,r){return this.array[t*this.itemSize]=r,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,r){return this.array[t*this.itemSize+1]=r,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,r){return this.array[t*this.itemSize+2]=r,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,r){return this.array[t*this.itemSize+3]=r,this},setXY:function(t,r,i){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t*=this.itemSize,this.array[t+0]=r,this.array[t+1]=i,this.array[t+2]=s,this.array[t+3]=f,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),Di.prototype=at(He.prototype),Di.prototype.constructor=Di,Cr.prototype=at(He.prototype),Cr.prototype.constructor=Cr,Oi.prototype=at(He.prototype),Oi.prototype.constructor=Oi,As.prototype=at(He.prototype),As.prototype.constructor=As,Vi.prototype=at(He.prototype),Vi.prototype.constructor=Vi,Ln.prototype=at(He.prototype),Ln.prototype.constructor=Ln,_s.prototype=at(He.prototype),_s.prototype.constructor=_s,Ge.prototype=at(He.prototype),Ge.prototype.constructor=Ge,sn.prototype=at(He.prototype),sn.prototype.constructor=sn,ut(so.prototype,{computeGroups:function(t){var r=[],i=void 0;t=t.faces;for(var s=0;s<t.length;s++){var f=t[s];if(f.materialIndex!==i){i=f.materialIndex,c!==void 0&&(c.count=3*s-c.start,r.push(c));var c={start:3*s,materialIndex:i}}}c!==void 0&&(c.count=3*s-c.start,r.push(c)),this.groups=r},fromGeometry:function(t){var r=t.faces,i=t.vertices,s=t.faceVertexUvs,f=s[0]&&0<s[0].length,c=s[1]&&0<s[1].length,g=t.morphTargets,p=g.length;if(0<p){for(var A=[],S=0;S<p;S++)A[S]={name:g[S].name,data:[]};this.morphTargets.position=A}var N=t.morphNormals,w=N.length;if(0<w){var I=[];for(S=0;S<w;S++)I[S]={name:N[S].name,data:[]};this.morphTargets.normal=I}var L=t.skinIndices,P=t.skinWeights,F=L.length===i.length,W=P.length===i.length;for(0<i.length&&r.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),S=0;S<r.length;S++){var X=r[S];this.vertices.push(i[X.a],i[X.b],i[X.c]);var Z=X.vertexNormals;for(Z.length===3?this.normals.push(Z[0],Z[1],Z[2]):(Z=X.normal,this.normals.push(Z,Z,Z)),Z=X.vertexColors,Z.length===3?this.colors.push(Z[0],Z[1],Z[2]):(Z=X.color,this.colors.push(Z,Z,Z)),f===!0&&(Z=s[0][S],Z!==void 0?this.uvs.push(Z[0],Z[1],Z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",S),this.uvs.push(new vt,new vt,new vt))),c===!0&&(Z=s[1][S],Z!==void 0?this.uvs2.push(Z[0],Z[1],Z[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",S),this.uvs2.push(new vt,new vt,new vt))),Z=0;Z<p;Z++){var tt=g[Z].vertices;A[Z].data.push(tt[X.a],tt[X.b],tt[X.c])}for(Z=0;Z<w;Z++)tt=N[Z].vertexNormals[S],I[Z].data.push(tt.a,tt.b,tt.c);F&&this.skinIndices.push(L[X.a],L[X.b],L[X.c]),W&&this.skinWeights.push(P[X.a],P[X.b],P[X.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this}});var pt=1,Rt=new Ie,Et=new Ee,Jt=new ot,oe=new li,Se=new li,ge=new ot;We.prototype=ut(at(se.prototype),{constructor:We,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(65535<xh(t)?_s:Vi)(t,1):this.index=t},getAttribute:function(t){return this.attributes[t]},setAttribute:function(t,r){return this.attributes[t]=r,this},deleteAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,r,i){this.groups.push({start:t,count:r,materialIndex:i!==void 0?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,r){this.drawRange.start=t,this.drawRange.count=r},applyMatrix4:function(t){var r=this.attributes.position;if(r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0),r=this.attributes.normal,r!==void 0){var i=new Ot().getNormalMatrix(t);r.applyNormalMatrix(i),r.needsUpdate=!0}return r=this.attributes.tangent,r!==void 0&&(r.transformDirection(t),r.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(t){return Rt.makeRotationX(t),this.applyMatrix4(Rt),this},rotateY:function(t){return Rt.makeRotationY(t),this.applyMatrix4(Rt),this},rotateZ:function(t){return Rt.makeRotationZ(t),this.applyMatrix4(Rt),this},translate:function(t,r,i){return Rt.makeTranslation(t,r,i),this.applyMatrix4(Rt),this},scale:function(t,r,i){return Rt.makeScale(t,r,i),this.applyMatrix4(Rt),this},lookAt:function(t){return Et.lookAt(t),Et.updateMatrix(),this.applyMatrix4(Et.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Jt).negate(),this.translate(Jt.x,Jt.y,Jt.z),this},setFromObject:function(t){var r=t.geometry;if(t.isPoints||t.isLine){t=new Ge(3*r.vertices.length,3);var i=new Ge(3*r.colors.length,3);this.setAttribute("position",t.copyVector3sArray(r.vertices)),this.setAttribute("color",i.copyColorsArray(r.colors)),r.lineDistances&&r.lineDistances.length===r.vertices.length&&(t=new Ge(r.lineDistances.length,1),this.setAttribute("lineDistance",t.copyArray(r.lineDistances))),r.boundingSphere!==null&&(this.boundingSphere=r.boundingSphere.clone()),r.boundingBox!==null&&(this.boundingBox=r.boundingBox.clone())}else t.isMesh&&r&&r.isGeometry&&this.fromGeometry(r);return this},setFromPoints:function(t){for(var r=[],i=0,s=t.length;i<s;i++){var f=t[i];r.push(f.x,f.y,f.z||0)}return this.setAttribute("position",new Ge(r,3)),this},updateFromObject:function(t){var r=t.geometry;if(t.isMesh){var i=r.__directGeometry;if(r.elementsNeedUpdate===!0&&(i=void 0,r.elementsNeedUpdate=!1),i===void 0)return this.fromGeometry(r);i.verticesNeedUpdate=r.verticesNeedUpdate,i.normalsNeedUpdate=r.normalsNeedUpdate,i.colorsNeedUpdate=r.colorsNeedUpdate,i.uvsNeedUpdate=r.uvsNeedUpdate,i.groupsNeedUpdate=r.groupsNeedUpdate,r.verticesNeedUpdate=!1,r.normalsNeedUpdate=!1,r.colorsNeedUpdate=!1,r.uvsNeedUpdate=!1,r.groupsNeedUpdate=!1,r=i}return r.verticesNeedUpdate===!0&&(i=this.attributes.position,i!==void 0&&(i.copyVector3sArray(r.vertices),i.needsUpdate=!0),r.verticesNeedUpdate=!1),r.normalsNeedUpdate===!0&&(i=this.attributes.normal,i!==void 0&&(i.copyVector3sArray(r.normals),i.needsUpdate=!0),r.normalsNeedUpdate=!1),r.colorsNeedUpdate===!0&&(i=this.attributes.color,i!==void 0&&(i.copyColorsArray(r.colors),i.needsUpdate=!0),r.colorsNeedUpdate=!1),r.uvsNeedUpdate&&(i=this.attributes.uv,i!==void 0&&(i.copyVector2sArray(r.uvs),i.needsUpdate=!0),r.uvsNeedUpdate=!1),r.lineDistancesNeedUpdate&&(i=this.attributes.lineDistance,i!==void 0&&(i.copyArray(r.lineDistances),i.needsUpdate=!0),r.lineDistancesNeedUpdate=!1),r.groupsNeedUpdate&&(r.computeGroups(t.geometry),this.groups=r.groups,r.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=new so().fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var r=new Float32Array(3*t.vertices.length);this.setAttribute("position",new He(r,3).copyVector3sArray(t.vertices)),0<t.normals.length&&(r=new Float32Array(3*t.normals.length),this.setAttribute("normal",new He(r,3).copyVector3sArray(t.normals))),0<t.colors.length&&(r=new Float32Array(3*t.colors.length),this.setAttribute("color",new He(r,3).copyColorsArray(t.colors))),0<t.uvs.length&&(r=new Float32Array(2*t.uvs.length),this.setAttribute("uv",new He(r,2).copyVector2sArray(t.uvs))),0<t.uvs2.length&&(r=new Float32Array(2*t.uvs2.length),this.setAttribute("uv2",new He(r,2).copyVector2sArray(t.uvs2))),this.groups=t.groups;for(var i in t.morphTargets){r=[];for(var s=t.morphTargets[i],f=0,c=s.length;f<c;f++){var g=s[f],p=new Ge(3*g.data.length,3);p.name=g.name,r.push(p.copyVector3sArray(g.data))}this.morphAttributes[i]=r}return 0<t.skinIndices.length&&(i=new Ge(4*t.skinIndices.length,4),this.setAttribute("skinIndex",i.copyVector4sArray(t.skinIndices))),0<t.skinWeights.length&&(i=new Ge(4*t.skinWeights.length,4),this.setAttribute("skinWeight",i.copyVector4sArray(t.skinWeights))),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new li);var t=this.attributes.position,r=this.morphAttributes.position;if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r){t=0;for(var i=r.length;t<i;t++)oe.setFromBufferAttribute(r[t]),this.morphTargetsRelative?(ge.addVectors(this.boundingBox.min,oe.min),this.boundingBox.expandByPoint(ge),ge.addVectors(this.boundingBox.max,oe.max),this.boundingBox.expandByPoint(ge)):(this.boundingBox.expandByPoint(oe.min),this.boundingBox.expandByPoint(oe.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Bi);var t=this.attributes.position,r=this.morphAttributes.position;if(t){var i=this.boundingSphere.center;if(oe.setFromBufferAttribute(t),r)for(var s=0,f=r.length;s<f;s++){var c=r[s];Se.setFromBufferAttribute(c),this.morphTargetsRelative?(ge.addVectors(oe.min,Se.min),oe.expandByPoint(ge),ge.addVectors(oe.max,Se.max),oe.expandByPoint(ge)):(oe.expandByPoint(Se.min),oe.expandByPoint(Se.max))}oe.getCenter(i);var g=0;for(s=0,f=t.count;s<f;s++)ge.fromBufferAttribute(t,s),g=Math.max(g,i.distanceToSquared(ge));if(r)for(s=0,f=r.length;s<f;s++){c=r[s];for(var p=this.morphTargetsRelative,A=0,S=c.count;A<S;A++)ge.fromBufferAttribute(c,A),p&&(Jt.fromBufferAttribute(t,A),ge.add(Jt)),g=Math.max(g,i.distanceToSquared(ge))}this.boundingSphere.radius=Math.sqrt(g),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,r=this.attributes;if(r.position){var i=r.position.array;if(r.normal===void 0)this.setAttribute("normal",new He(new Float32Array(i.length),3));else for(var s=r.normal.array,f=0,c=s.length;f<c;f++)s[f]=0;s=r.normal.array;var g=new ot,p=new ot,A=new ot,S=new ot,N=new ot;if(t){var w=t.array;for(f=0,c=t.count;f<c;f+=3){t=3*w[f+0];var I=3*w[f+1],L=3*w[f+2];g.fromArray(i,t),p.fromArray(i,I),A.fromArray(i,L),S.subVectors(A,p),N.subVectors(g,p),S.cross(N),s[t]+=S.x,s[t+1]+=S.y,s[t+2]+=S.z,s[I]+=S.x,s[I+1]+=S.y,s[I+2]+=S.z,s[L]+=S.x,s[L+1]+=S.y,s[L+2]+=S.z}}else for(f=0,c=i.length;f<c;f+=9)g.fromArray(i,f),p.fromArray(i,f+3),A.fromArray(i,f+6),S.subVectors(A,p),N.subVectors(g,p),S.cross(N),s[f]=S.x,s[f+1]=S.y,s[f+2]=S.z,s[f+3]=S.x,s[f+4]=S.y,s[f+5]=S.z,s[f+6]=S.x,s[f+7]=S.y,s[f+8]=S.z;this.normalizeNormals(),r.normal.needsUpdate=!0}},merge:function(t,r){if(t&&t.isBufferGeometry){r===void 0&&(r=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var i=this.attributes,s;for(s in i)if(t.attributes[s]!==void 0){var f=i[s].array,c=t.attributes[s],g=c.array,p=c.itemSize*r;c=Math.min(g.length,f.length-p);for(var A=0;A<c;A++,p++)f[p]=g[A]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){for(var t=this.attributes.normal,r=0,i=t.count;r<i;r++)ge.x=t.getX(r),ge.y=t.getY(r),ge.z=t.getZ(r),ge.normalize(),t.setXYZ(r,ge.x,ge.y,ge.z)},toNonIndexed:function(){function t(N,w){var I=N.array,L=N.itemSize;N=N.normalized;for(var P=new I.constructor(w.length*L),F,W=0,X=0,Z=w.length;X<Z;X++){F=w[X]*L;for(var tt=0;tt<L;tt++)P[W++]=I[F++]}return new He(P,L,N)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var r=new We,i=this.index.array,s=this.attributes,f;for(f in s){var c=s[f];c=t(c,i),r.setAttribute(f,c)}var g=this.morphAttributes;for(f in g){var p=[],A=g[f];s=0;for(var S=A.length;s<S;s++)c=A[s],c=t(c,i),p.push(c);r.morphAttributes[f]=p}for(r.morphTargetsRelative=this.morphTargetsRelative,i=this.groups,s=0,f=i.length;s<f;s++)c=i[s],r.addGroup(c.start,c.count,c.materialIndex);return r},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),0<Pi(this.userData).length&&(t.userData=this.userData),this.parameters!==void 0){var r=this.parameters;for(S in r)r[S]!==void 0&&(t[S]=r[S]);return t}t.data={attributes:{}},r=this.index,r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var i=this.attributes;for(S in i){r=i[S];var s=r.toJSON();r.name!==""&&(s.name=r.name),t.data.attributes[S]=s}i={};var f=!1;for(S in this.morphAttributes){for(var c=this.morphAttributes[S],g=[],p=0,A=c.length;p<A;p++)r=c[p],s=r.toJSON(),r.name!==""&&(s.name=r.name),g.push(s);0<g.length&&(i[S]=g,f=!0)}f&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);var S=this.groups;return 0<S.length&&(t.data.groups=JSON.parse(Oo(S))),S=this.boundingSphere,S!==null&&(t.data.boundingSphere={center:S.center.toArray(),radius:S.radius}),t},clone:function(){return new We().copy(this)},copy:function(t){var r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var i=t.index;i!==null&&this.setIndex(i.clone()),i=t.attributes;for(g in i)this.setAttribute(g,i[g].clone());var s=t.morphAttributes;for(g in s){var f=[],c=s[g];for(i=0,r=c.length;i<r;i++)f.push(c[i].clone());this.morphAttributes[g]=f}this.morphTargetsRelative=t.morphTargetsRelative;var g=t.groups;for(i=0,r=g.length;i<r;i++)s=g[i],this.addGroup(s.start,s.count,s.materialIndex);return g=t.boundingBox,g!==null&&(this.boundingBox=g.clone()),g=t.boundingSphere,g!==null&&(this.boundingSphere=g.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var Xe=new Ie,_r=new fn,he=new Bi,Ue=new ot,Sr=new ot,Ir=new ot,je=new ot,ts=new ot,Ji=new ot,qi=new ot,tc=new ot,wn=new ot,$u=new vt,ec=new vt,Ma=new vt,Gm=new ot,z1=new ot;Wi.prototype=ut(at(Ee.prototype),{constructor:Wi,isMesh:!0,copy:function(t){return Ee.prototype.copy.call(this,t),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=ut({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Pi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(t,r){var i=this.geometry,s=this.material,f=this.matrixWorld;if(s!==void 0&&(i.boundingSphere===null&&i.computeBoundingSphere(),he.copy(i.boundingSphere),he.applyMatrix4(f),t.ray.intersectsSphere(he)!==!1&&(Xe.getInverse(f),_r.copy(t.ray).applyMatrix4(Xe),i.boundingBox===null||_r.intersectsBox(i.boundingBox)!==!1))){if(i.isBufferGeometry){var c=i.index;f=i.attributes.position;var g=i.morphAttributes.position,p=i.morphTargetsRelative,A=i.attributes.uv,S=i.attributes.uv2,N=i.groups,w=i.drawRange,I,L;if(c!==null)if(Array.isArray(s)){var P=0;for(I=N.length;P<I;P++){var F=N[P],W=s[F.materialIndex],X=Math.max(F.start,w.start);for(L=i=Math.min(F.start+F.count,w.start+w.count);X<L;X+=3){i=c.getX(X);var Z=c.getX(X+1),tt=c.getX(X+2);(i=ws(this,W,t,_r,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(X/3),i.face.materialIndex=F.materialIndex,r.push(i))}}}else for(X=Math.max(0,w.start),i=Math.min(c.count,w.start+w.count),P=X,I=i;P<I;P+=3)i=c.getX(P),Z=c.getX(P+1),tt=c.getX(P+2),(i=ws(this,s,t,_r,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(P/3),r.push(i));else if(f!==void 0)if(Array.isArray(s))for(P=0,I=N.length;P<I;P++)for(F=N[P],W=s[F.materialIndex],X=Math.max(F.start,w.start),L=i=Math.min(F.start+F.count,w.start+w.count);X<L;X+=3)i=X,Z=X+1,tt=X+2,(i=ws(this,W,t,_r,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(X/3),i.face.materialIndex=F.materialIndex,r.push(i));else for(X=Math.max(0,w.start),i=Math.min(f.count,w.start+w.count),P=X,I=i;P<I;P+=3)i=P,Z=P+1,tt=P+2,(i=ws(this,s,t,_r,f,g,p,A,S,i,Z,tt))&&(i.faceIndex=Math.floor(P/3),r.push(i))}else if(i.isGeometry)for(f=Array.isArray(s),g=i.vertices,p=i.faces,i=i.faceVertexUvs[0],0<i.length&&(c=i),w=0,P=p.length;w<P;w++)I=p[w],i=f?s[I.materialIndex]:s,i!==void 0&&(A=g[I.a],S=g[I.b],N=g[I.c],i=So(this,i,t,_r,A,S,N,Gm))&&(c&&c[w]&&(F=c[w],$u.copy(F[0]),ec.copy(F[1]),Ma.copy(F[2]),i.uv=Ci.getUV(Gm,A,S,N,$u,ec,Ma,new vt)),i.face=I,i.faceIndex=w,r.push(i))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var nC=0,tl=new Ie,zA=new Ee,U1=new ot;Fr.prototype=ut(at(se.prototype),{constructor:Fr,isGeometry:!0,applyMatrix4:function(t){for(var r=new Ot().getNormalMatrix(t),i=0,s=this.vertices.length;i<s;i++)this.vertices[i].applyMatrix4(t);for(i=0,s=this.faces.length;i<s;i++){t=this.faces[i],t.normal.applyMatrix3(r).normalize();for(var f=0,c=t.vertexNormals.length;f<c;f++)t.vertexNormals[f].applyMatrix3(r).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(t){return tl.makeRotationX(t),this.applyMatrix4(tl),this},rotateY:function(t){return tl.makeRotationY(t),this.applyMatrix4(tl),this},rotateZ:function(t){return tl.makeRotationZ(t),this.applyMatrix4(tl),this},translate:function(t,r,i){return tl.makeTranslation(t,r,i),this.applyMatrix4(tl),this},scale:function(t,r,i){return tl.makeScale(t,r,i),this.applyMatrix4(tl),this},lookAt:function(t){return zA.lookAt(t),zA.updateMatrix(),this.applyMatrix4(zA.matrix),this},fromBufferGeometry:function(t){function r(L,P,F,W){var X=p===void 0?[]:[i.colors[L].clone(),i.colors[P].clone(),i.colors[F].clone()],Z=g===void 0?[]:[new ot().fromArray(g,3*L),new ot().fromArray(g,3*P),new ot().fromArray(g,3*F)];W=new nr(L,P,F,Z,X,W),i.faces.push(W),A!==void 0&&i.faceVertexUvs[0].push([new vt().fromArray(A,2*L),new vt().fromArray(A,2*P),new vt().fromArray(A,2*F)]),S!==void 0&&i.faceVertexUvs[1].push([new vt().fromArray(S,2*L),new vt().fromArray(S,2*P),new vt().fromArray(S,2*F)])}var i=this,s=t.index!==null?t.index.array:void 0,f=t.attributes;if(f.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var c=f.position.array,g=f.normal!==void 0?f.normal.array:void 0,p=f.color!==void 0?f.color.array:void 0,A=f.uv!==void 0?f.uv.array:void 0,S=f.uv2!==void 0?f.uv2.array:void 0;for(S!==void 0&&(this.faceVertexUvs[1]=[]),f=0;f<c.length;f+=3)i.vertices.push(new ot().fromArray(c,f)),p!==void 0&&i.colors.push(new Vt().fromArray(p,f));var N=t.groups;if(0<N.length)for(f=0;f<N.length;f++){c=N[f];var w=c.start,I=w;for(w+=c.count;I<w;I+=3)s!==void 0?r(s[I],s[I+1],s[I+2],c.materialIndex):r(I,I+1,I+2,c.materialIndex)}else if(s!==void 0)for(f=0;f<s.length;f+=3)r(s[f],s[f+1],s[f+2]);else for(f=0;f<c.length/3;f+=3)r(f,f+1,f+2);return this.computeFaceNormals(),t.boundingBox!==null&&(this.boundingBox=t.boundingBox.clone()),t.boundingSphere!==null&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(U1).negate(),this.translate(U1.x,U1.y,U1.z),this},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,r=this.boundingSphere.radius;r=r===0?1:1/r;var i=new Ie;return i.set(r,0,0,-r*t.x,0,r,0,-r*t.y,0,0,r,-r*t.z,0,0,0,1),this.applyMatrix4(i),this},computeFaceNormals:function(){for(var t=new ot,r=new ot,i=0,s=this.faces.length;i<s;i++){var f=this.faces[i],c=this.vertices[f.a],g=this.vertices[f.b];t.subVectors(this.vertices[f.c],g),r.subVectors(c,g),t.cross(r),t.normalize(),f.normal.copy(t)}},computeVertexNormals:function(t){t===void 0&&(t=!0);var r,i=Array(this.vertices.length),s=0;for(r=this.vertices.length;s<r;s++)i[s]=new ot;if(t){var f=new ot,c=new ot;for(t=0,s=this.faces.length;t<s;t++){r=this.faces[t];var g=this.vertices[r.a],p=this.vertices[r.b],A=this.vertices[r.c];f.subVectors(A,p),c.subVectors(g,p),f.cross(c),i[r.a].add(f),i[r.b].add(f),i[r.c].add(f)}}else for(this.computeFaceNormals(),t=0,s=this.faces.length;t<s;t++)r=this.faces[t],i[r.a].add(r.normal),i[r.b].add(r.normal),i[r.c].add(r.normal);for(s=0,r=this.vertices.length;s<r;s++)i[s].normalize();for(t=0,s=this.faces.length;t<s;t++)r=this.faces[t],g=r.vertexNormals,g.length===3?(g[0].copy(i[r.a]),g[1].copy(i[r.b]),g[2].copy(i[r.c])):(g[0]=i[r.a].clone(),g[1]=i[r.b].clone(),g[2]=i[r.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t;this.computeFaceNormals();var r=0;for(t=this.faces.length;r<t;r++){var i=this.faces[r],s=i.vertexNormals;s.length===3?(s[0].copy(i.normal),s[1].copy(i.normal),s[2].copy(i.normal)):(s[0]=i.normal.clone(),s[1]=i.normal.clone(),s[2]=i.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,r,i=0;for(r=this.faces.length;i<r;i++){var s=this.faces[i];s.__originalFaceNormal?s.__originalFaceNormal.copy(s.normal):s.__originalFaceNormal=s.normal.clone(),s.__originalVertexNormals||(s.__originalVertexNormals=[]);var f=0;for(t=s.vertexNormals.length;f<t;f++)s.__originalVertexNormals[f]?s.__originalVertexNormals[f].copy(s.vertexNormals[f]):s.__originalVertexNormals[f]=s.vertexNormals[f].clone()}var c=new Fr;for(c.faces=this.faces,f=0,t=this.morphTargets.length;f<t;f++){if(!this.morphNormals[f]){this.morphNormals[f]={},this.morphNormals[f].faceNormals=[],this.morphNormals[f].vertexNormals=[],s=this.morphNormals[f].faceNormals;var g=this.morphNormals[f].vertexNormals;for(i=0,r=this.faces.length;i<r;i++){var p=new ot,A={a:new ot,b:new ot,c:new ot};s.push(p),g.push(A)}}for(g=this.morphNormals[f],c.vertices=this.morphTargets[f].vertices,c.computeFaceNormals(),c.computeVertexNormals(),i=0,r=this.faces.length;i<r;i++)s=this.faces[i],p=g.faceNormals[i],A=g.vertexNormals[i],p.copy(s.normal),A.a.copy(s.vertexNormals[0]),A.b.copy(s.vertexNormals[1]),A.c.copy(s.vertexNormals[2])}for(i=0,r=this.faces.length;i<r;i++)s=this.faces[i],s.normal=s.__originalFaceNormal,s.vertexNormals=s.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new li),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new Bi),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,r,i){if(t&&t.isGeometry){var s,f=this.vertices.length,c=this.vertices,g=t.vertices,p=this.faces,A=t.faces,S=this.colors,N=t.colors;i===void 0&&(i=0),r!==void 0&&(s=new Ot().getNormalMatrix(r));for(var w=0,I=g.length;w<I;w++){var L=g[w].clone();r!==void 0&&L.applyMatrix4(r),c.push(L)}for(w=0,I=N.length;w<I;w++)S.push(N[w].clone());for(w=0,I=A.length;w<I;w++){g=A[w];var P=g.vertexNormals;for(N=g.vertexColors,S=new nr(g.a+f,g.b+f,g.c+f),S.normal.copy(g.normal),s!==void 0&&S.normal.applyMatrix3(s).normalize(),r=0,c=P.length;r<c;r++)L=P[r].clone(),s!==void 0&&L.applyMatrix3(s).normalize(),S.vertexNormals.push(L);for(S.color.copy(g.color),r=0,c=N.length;r<c;r++)L=N[r],S.vertexColors.push(L.clone());S.materialIndex=g.materialIndex+i,p.push(S)}for(w=0,I=t.faceVertexUvs.length;w<I;w++)for(i=t.faceVertexUvs[w],this.faceVertexUvs[w]===void 0&&(this.faceVertexUvs[w]=[]),r=0,c=i.length;r<c;r++){for(s=i[r],f=[],p=0,A=s.length;p<A;p++)f.push(s[p].clone());this.faceVertexUvs[w].push(f)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t={},r=[],i=[],s=Math.pow(10,4),f,c=0;for(f=this.vertices.length;c<f;c++){var g=this.vertices[c];g=Math.round(g.x*s)+"_"+Math.round(g.y*s)+"_"+Math.round(g.z*s),t[g]===void 0?(t[g]=c,r.push(this.vertices[c]),i[c]=r.length-1):i[c]=i[t[g]]}for(t=[],c=0,f=this.faces.length;c<f;c++)for(s=this.faces[c],s.a=i[s.a],s.b=i[s.b],s.c=i[s.c],s=[s.a,s.b,s.c],g=0;3>g;g++)if(s[g]===s[(g+1)%3]){t.push(c);break}for(c=t.length-1;0<=c;c--)for(s=t[c],this.faces.splice(s,1),i=0,f=this.faceVertexUvs.length;i<f;i++)this.faceVertexUvs[i].splice(s,1);return c=this.vertices.length-r.length,this.vertices=r,c},setFromPoints:function(t){this.vertices=[];for(var r=0,i=t.length;r<i;r++){var s=t[r];this.vertices.push(new ot(s.x,s.y,s.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,r=t.length,i=0;i<r;i++)t[i]._id=i;t.sort(function(A,S){return A.materialIndex-S.materialIndex});var s=this.faceVertexUvs[0],f=this.faceVertexUvs[1],c,g;for(s&&s.length===r&&(c=[]),f&&f.length===r&&(g=[]),i=0;i<r;i++){var p=t[i]._id;c&&c.push(s[p]),g&&g.push(f[p])}c&&(this.faceVertexUvs[0]=c),g&&(this.faceVertexUvs[1]=g)},toJSON:function(){function t(xt,At,yt){return yt?xt|1<<At:xt&~(1<<At)}function r(xt){var At=xt.x.toString()+xt.y.toString()+xt.z.toString();return S[At]!==void 0||(S[At]=A.length/3,A.push(xt.x,xt.y,xt.z)),S[At]}function i(xt){var At=xt.r.toString()+xt.g.toString()+xt.b.toString();return w[At]!==void 0||(w[At]=N.length,N.push(xt.getHex())),w[At]}function s(xt){var At=xt.x.toString()+xt.y.toString();return L[At]!==void 0||(L[At]=I.length/2,I.push(xt.x,xt.y)),L[At]}var f={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(f.uuid=this.uuid,f.type=this.type,this.name!==""&&(f.name=this.name),this.parameters!==void 0){var c=this.parameters,g;for(g in c)c[g]!==void 0&&(f[g]=c[g]);return f}for(c=[],g=0;g<this.vertices.length;g++){var p=this.vertices[g];c.push(p.x,p.y,p.z)}p=[];var A=[],S={},N=[],w={},I=[],L={};for(g=0;g<this.faces.length;g++){var P=this.faces[g],F=this.faceVertexUvs[0][g]!==void 0,W=0<P.normal.length(),X=0<P.vertexNormals.length,Z=P.color.r!==1||P.color.g!==1||P.color.b!==1,tt=0<P.vertexColors.length,st=0;st=t(st,0,0),st=t(st,1,!0),st=t(st,2,!1),st=t(st,3,F),st=t(st,4,W),st=t(st,5,X),st=t(st,6,Z),st=t(st,7,tt),p.push(st),p.push(P.a,P.b,P.c),p.push(P.materialIndex),F&&(F=this.faceVertexUvs[0][g],p.push(s(F[0]),s(F[1]),s(F[2]))),W&&p.push(r(P.normal)),X&&(W=P.vertexNormals,p.push(r(W[0]),r(W[1]),r(W[2]))),Z&&p.push(i(P.color)),tt&&(P=P.vertexColors,p.push(i(P[0]),i(P[1]),i(P[2])))}return f.data={},f.data.vertices=c,f.data.normals=A,0<N.length&&(f.data.colors=N),0<I.length&&(f.data.uvs=[I]),f.data.faces=p,f},clone:function(){return new Fr().copy(this)},copy:function(t){var r,i,s;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=t.name;var f=t.vertices,c=0;for(r=f.length;c<r;c++)this.vertices.push(f[c].clone());for(f=t.colors,c=0,r=f.length;c<r;c++)this.colors.push(f[c].clone());for(f=t.faces,c=0,r=f.length;c<r;c++)this.faces.push(f[c].clone());for(c=0,r=t.faceVertexUvs.length;c<r;c++){var g=t.faceVertexUvs[c];for(this.faceVertexUvs[c]===void 0&&(this.faceVertexUvs[c]=[]),f=0,i=g.length;f<i;f++){var p=g[f],A=[],S=0;for(s=p.length;S<s;S++)A.push(p[S].clone());this.faceVertexUvs[c].push(A)}}for(S=t.morphTargets,c=0,r=S.length;c<r;c++){if(s={},s.name=S[c].name,S[c].vertices!==void 0)for(s.vertices=[],f=0,i=S[c].vertices.length;f<i;f++)s.vertices.push(S[c].vertices[f].clone());if(S[c].normals!==void 0)for(s.normals=[],f=0,i=S[c].normals.length;f<i;f++)s.normals.push(S[c].normals[f].clone());this.morphTargets.push(s)}for(S=t.morphNormals,c=0,r=S.length;c<r;c++){if(s={},S[c].vertexNormals!==void 0)for(s.vertexNormals=[],f=0,i=S[c].vertexNormals.length;f<i;f++)g=S[c].vertexNormals[f],p={},p.a=g.a.clone(),p.b=g.b.clone(),p.c=g.c.clone(),s.vertexNormals.push(p);if(S[c].faceNormals!==void 0)for(s.faceNormals=[],f=0,i=S[c].faceNormals.length;f<i;f++)s.faceNormals.push(S[c].faceNormals[f].clone());this.morphNormals.push(s)}for(f=t.skinWeights,c=0,r=f.length;c<r;c++)this.skinWeights.push(f[c].clone());for(f=t.skinIndices,c=0,r=f.length;c<r;c++)this.skinIndices.push(f[c].clone());for(f=t.lineDistances,c=0,r=f.length;c<r;c++)this.lineDistances.push(f[c]);return c=t.boundingBox,c!==null&&(this.boundingBox=c.clone()),c=t.boundingSphere,c!==null&&(this.boundingSphere=c.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var oC=function(t){function r(i,s,f,c,g,p){Ri(this,r);var A=_n(this,(r.__proto__||Xn(r)).call(this));return A.type="BoxGeometry",A.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:g,depthSegments:p},A.fromBufferGeometry(new H1(i,s,f,c,g,p)),A.mergeVertices(),A}return Yn(r,t),r}(Fr),H1=function(t){function r(i,s,f,c,g,p){function A(X,Z,tt,st,xt,At,yt,Ut,kt,ne,Wt){var re=At/kt,be=yt/ne,ce=At/2,tr=yt/2,yr=Ut/2;yt=kt+1;for(var sr=ne+1,ni=At=0,pr=new ot,dt=0;dt<sr;dt++)for(var gt=dt*be-tr,mt=0;mt<yt;mt++)pr[X]=(mt*re-ce)*st,pr[Z]=gt*xt,pr[tt]=yr,I.push(pr.x,pr.y,pr.z),pr[X]=0,pr[Z]=0,pr[tt]=0<Ut?1:-1,L.push(pr.x,pr.y,pr.z),P.push(mt/kt),P.push(1-dt/ne),At+=1;for(X=0;X<ne;X++)for(Z=0;Z<kt;Z++)tt=F+Z+yt*(X+1),st=F+(Z+1)+yt*(X+1),xt=F+(Z+1)+yt*X,w.push(F+Z+yt*X,tt,xt),w.push(tt,st,xt),ni+=6;N.addGroup(W,ni,Wt),W+=ni,F+=At}Ri(this,r);var S=_n(this,(r.__proto__||Xn(r)).call(this));S.type="BoxBufferGeometry",S.parameters={width:i,height:s,depth:f,widthSegments:c,heightSegments:g,depthSegments:p};var N=S;i=i||1,s=s||1,f=f||1,c=Math.floor(c)||1,g=Math.floor(g)||1,p=Math.floor(p)||1;var w=[],I=[],L=[],P=[],F=0,W=0;return A("z","y","x",-1,-1,f,s,i,p,g,0),A("z","y","x",1,-1,f,s,-i,p,g,1),A("x","z","y",1,1,i,f,s,c,p,2),A("x","z","y",1,-1,i,f,-s,c,p,3),A("x","y","z",1,-1,i,s,f,c,g,4),A("x","y","z",-1,-1,i,s,-f,c,g,5),S.setIndex(w),S.setAttribute("position",new Ge(I,3)),S.setAttribute("normal",new Ge(L,3)),S.setAttribute("uv",new Ge(P,2)),S}return Yn(r,t),r}(We),Rf={clone:Pa,merge:Bn};ki.prototype=at(de.prototype),ki.prototype.constructor=ki,ki.prototype.isShaderMaterial=!0,ki.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Pa(t.uniforms),this.defines=ut({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=ut({},t.extensions),this},ki.prototype.toJSON=function(t){var r=de.prototype.toJSON.call(this,t);r.uniforms={};for(var i in this.uniforms){var s=this.uniforms[i].value;r.uniforms[i]=s&&s.isTexture?{type:"t",value:s.toJSON(t).uuid}:s&&s.isColor?{type:"c",value:s.getHex()}:s&&s.isVector2?{type:"v2",value:s.toArray()}:s&&s.isVector3?{type:"v3",value:s.toArray()}:s&&s.isVector4?{type:"v4",value:s.toArray()}:s&&s.isMatrix3?{type:"m3",value:s.toArray()}:s&&s.isMatrix4?{type:"m4",value:s.toArray()}:{value:s}}0<Pi(this.defines).length&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,t={};for(var f in this.extensions)this.extensions[f]===!0&&(t[f]=!0);return 0<Pi(t).length&&(r.extensions=t),r},Da.prototype=ut(at(Ee.prototype),{constructor:Da,isCamera:!0,copy:function(t,r){return Ee.prototype.copy.call(this,t,r),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this},getWorldDirection:function(t){t===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),t=new ot),this.updateMatrixWorld(!0);var r=this.matrixWorld.elements;return t.set(-r[8],-r[9],-r[10]).normalize()},updateMatrixWorld:function(t){Ee.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(t,r){Ee.prototype.updateWorldMatrix.call(this,t,r),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),un.prototype=ut(at(Da.prototype),{constructor:un,isPerspectiveCamera:!0,copy:function(t,r){return Da.prototype.copy.call(this,t,r),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:ut({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){t=.5*this.getFilmHeight()/t,this.fov=2*Tr.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Tr.DEG2RAD*this.fov);return .5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Tr.RAD2DEG*Math.atan(Math.tan(.5*Tr.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,r,i,s,f,c){this.aspect=t/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,r=t*Math.tan(.5*Tr.DEG2RAD*this.fov)/this.zoom,i=2*r,s=this.aspect*i,f=-.5*s,c=this.view;if(this.view!==null&&this.view.enabled){var g=c.fullWidth,p=c.fullHeight;f+=c.offsetX*s/g,r-=c.offsetY*i/p,s*=c.width/g,i*=c.height/p}c=this.filmOffset,c!==0&&(f+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(f,f+s,r,r-i,t,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=Ee.prototype.toJSON.call(this,t),t.object.fov=this.fov,t.object.zoom=this.zoom,t.object.near=this.near,t.object.far=this.far,t.object.focus=this.focus,t.object.aspect=this.aspect,this.view!==null&&(t.object.view=ut({},this.view)),t.object.filmGauge=this.filmGauge,t.object.filmOffset=this.filmOffset,t}}),Qi.prototype=at(Ee.prototype),Qi.prototype.constructor=Qi,vu.prototype=at(Ft.prototype),vu.prototype.constructor=vu,vu.prototype.isWebGLCubeRenderTarget=!0,vu.prototype.fromEquirectangularTexture=function(t,r){this.texture.type=r.type,this.texture.format=r.format,this.texture.encoding=r.encoding;var i=new Yr,s=new ki({type:"CubemapFromEquirect",uniforms:Pa({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return s.uniforms.tEquirect.value=r,r=new Wi(new H1(5,5,5),s),i.add(r),new Qi(1,10,this).update(t,i),r.geometry.dispose(),r.material.dispose(),this},dl.prototype=at(Lt.prototype),dl.prototype.constructor=dl,dl.prototype.isDataTexture=!0;var Ld=new Bi,k1=new ot;ut(yu.prototype,{set:function(t,r,i,s,f,c){var g=this.planes;return g[0].copy(t),g[1].copy(r),g[2].copy(i),g[3].copy(s),g[4].copy(f),g[5].copy(c),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){for(var r=this.planes,i=0;6>i;i++)r[i].copy(t.planes[i]);return this},setFromProjectionMatrix:function(t){var r=this.planes,i=t.elements;t=i[0];var s=i[1],f=i[2],c=i[3],g=i[4],p=i[5],A=i[6],S=i[7],N=i[8],w=i[9],I=i[10],L=i[11],P=i[12],F=i[13],W=i[14];return i=i[15],r[0].setComponents(c-t,S-g,L-N,i-P).normalize(),r[1].setComponents(c+t,S+g,L+N,i+P).normalize(),r[2].setComponents(c+s,S+p,L+w,i+F).normalize(),r[3].setComponents(c-s,S-p,L-w,i-F).normalize(),r[4].setComponents(c-f,S-A,L-I,i-W).normalize(),r[5].setComponents(c+f,S+A,L+I,i+W).normalize(),this},intersectsObject:function(t){var r=t.geometry;return r.boundingSphere===null&&r.computeBoundingSphere(),Ld.copy(r.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Ld)},intersectsSprite:function(t){return Ld.center.set(0,0,0),Ld.radius=.7071067811865476,Ld.applyMatrix4(t.matrixWorld),this.intersectsSphere(Ld)},intersectsSphere:function(t){var r=this.planes,i=t.center;t=-t.radius;for(var s=0;6>s;s++)if(r[s].distanceToPoint(i)<t)return!1;return!0},intersectsBox:function(t){for(var r=this.planes,i=0;6>i;i++){var s=r[i];if(k1.x=0<s.normal.x?t.max.x:t.min.x,k1.y=0<s.normal.y?t.max.y:t.min.y,k1.z=0<s.normal.z?t.max.z:t.min.z,0>s.distanceToPoint(k1))return!1}return!0},containsPoint:function(t){for(var r=this.planes,i=0;6>i;i++)if(0>r[i].distanceToPoint(t))return!1;return!0}});var gr={common:{diffuse:{value:new Vt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ot},uv2Transform:{value:new Ot},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new vt(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Vt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Vt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ot}},sprite:{diffuse:{value:new Vt(15658734)},opacity:{value:1},center:{value:new vt(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Ot}}};Lc.prototype=at(Fr.prototype),Lc.prototype.constructor=Lc,Oa.prototype=at(We.prototype),Oa.prototype.constructor=Oa;var Ii={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},$l={basic:{uniforms:Bn([gr.common,gr.specularmap,gr.envmap,gr.aomap,gr.lightmap,gr.fog]),vertexShader:Ii.meshbasic_vert,fragmentShader:Ii.meshbasic_frag},lambert:{uniforms:Bn([gr.common,gr.specularmap,gr.envmap,gr.aomap,gr.lightmap,gr.emissivemap,gr.fog,gr.lights,{emissive:{value:new Vt(0)}}]),vertexShader:Ii.meshlambert_vert,fragmentShader:Ii.meshlambert_frag},phong:{uniforms:Bn([gr.common,gr.specularmap,gr.envmap,gr.aomap,gr.lightmap,gr.emissivemap,gr.bumpmap,gr.normalmap,gr.displacementmap,gr.fog,gr.lights,{emissive:{value:new Vt(0)},specular:{value:new Vt(1118481)},shininess:{value:30}}]),vertexShader:Ii.meshphong_vert,fragmentShader:Ii.meshphong_frag},standard:{uniforms:Bn([gr.common,gr.envmap,gr.aomap,gr.lightmap,gr.emissivemap,gr.bumpmap,gr.normalmap,gr.displacementmap,gr.roughnessmap,gr.metalnessmap,gr.fog,gr.lights,{emissive:{value:new Vt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ii.meshphysical_vert,fragmentShader:Ii.meshphysical_frag},toon:{uniforms:Bn([gr.common,gr.specularmap,gr.aomap,gr.lightmap,gr.emissivemap,gr.bumpmap,gr.normalmap,gr.displacementmap,gr.gradientmap,gr.fog,gr.lights,{emissive:{value:new Vt(0)},specular:{value:new Vt(1118481)},shininess:{value:30}}]),vertexShader:Ii.meshtoon_vert,fragmentShader:Ii.meshtoon_frag},matcap:{uniforms:Bn([gr.common,gr.bumpmap,gr.normalmap,gr.displacementmap,gr.fog,{matcap:{value:null}}]),vertexShader:Ii.meshmatcap_vert,fragmentShader:Ii.meshmatcap_frag},points:{uniforms:Bn([gr.points,gr.fog]),vertexShader:Ii.points_vert,fragmentShader:Ii.points_frag},dashed:{uniforms:Bn([gr.common,gr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ii.linedashed_vert,fragmentShader:Ii.linedashed_frag},depth:{uniforms:Bn([gr.common,gr.displacementmap]),vertexShader:Ii.depth_vert,fragmentShader:Ii.depth_frag},normal:{uniforms:Bn([gr.common,gr.bumpmap,gr.normalmap,gr.displacementmap,{opacity:{value:1}}]),vertexShader:Ii.normal_vert,fragmentShader:Ii.normal_frag},sprite:{uniforms:Bn([gr.sprite,gr.fog]),vertexShader:Ii.sprite_vert,fragmentShader:Ii.sprite_frag},background:{uniforms:{uvTransform:{value:new Ot},t2D:{value:null}},vertexShader:Ii.background_vert,fragmentShader:Ii.background_frag},cube:{uniforms:Bn([gr.envmap,{opacity:{value:1}}]),vertexShader:Ii.cube_vert,fragmentShader:Ii.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ii.equirect_vert,fragmentShader:Ii.equirect_frag},distanceRGBA:{uniforms:Bn([gr.common,gr.displacementmap,{referencePosition:{value:new ot},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ii.distanceRGBA_vert,fragmentShader:Ii.distanceRGBA_frag},shadow:{uniforms:Bn([gr.lights,gr.fog,{color:{value:new Vt(0)},opacity:{value:1}}]),vertexShader:Ii.shadow_vert,fragmentShader:Ii.shadow_frag}};$l.physical={uniforms:Bn([$l.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new vt(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new Vt(0)},transparency:{value:0}}]),vertexShader:Ii.meshphysical_vert,fragmentShader:Ii.meshphysical_frag},Fa.prototype=at(Lt.prototype),Fa.prototype.constructor=Fa,Fa.prototype.isCubeTexture=!0,Object.defineProperty(Fa.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}}),os.prototype=at(Lt.prototype),os.prototype.constructor=os,os.prototype.isDataTexture2DArray=!0,Be.prototype=at(Lt.prototype),Be.prototype.constructor=Be,Be.prototype.isDataTexture3D=!0;var T_=new Lt,sC=new os,aC=new Be,S_=new Fa,I_=[],E_=[],L_=new Float32Array(16),R_=new Float32Array(9),P_=new Float32Array(4);g0.prototype.updateCache=function(t){var r=this.cache;t instanceof Float32Array&&r.length!==t.length&&(this.cache=new Float32Array(t.length)),Io(r,t)},m0.prototype.setValue=function(t,r,i){for(var s=this.seq,f=0,c=s.length;f!==c;++f){var g=s[f];g.setValue(t,r[g.id],i)}};var UA=/([\w\d_]+)(\])?(\[|\.)?/g;ks.prototype.setValue=function(t,r,i,s){r=this.map[r],r!==void 0&&r.setValue(t,i,s)},ks.prototype.setOptional=function(t,r,i){r=r[i],r!==void 0&&this.setValue(t,i,r)},ks.upload=function(t,r,i,s){for(var f=0,c=r.length;f!==c;++f){var g=r[f],p=i[g.id];p.needsUpdate!==!1&&g.setValue(t,p.value,s)}},ks.seqWithValue=function(t,r){for(var i=[],s=0,f=t.length;s!==f;++s){var c=t[s];c.id in r&&i.push(c)}return i};var uC=0,HA=/^[ \t]*#include +<([\w\d./]+)>/gm,D_=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,O_=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,lC=0;ha.prototype=at(de.prototype),ha.prototype.constructor=ha,ha.prototype.isMeshDepthMaterial=!0,ha.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Au.prototype=at(de.prototype),Au.prototype.constructor=Au,Au.prototype.isMeshDistanceMaterial=!0,Au.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Ah.prototype=ut(at(un.prototype),{constructor:Ah,isArrayCamera:!0}),Ho.prototype=ut(at(Ee.prototype),{constructor:Ho,isGroup:!0}),ut(ca.prototype,{constructor:ca,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Ho,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Ho,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this},disconnect:function(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(t,r,i){var s=null,f=null,c=this._targetRay,g=this._grip;return t&&(c!==null&&(s=r.getPose(t.targetRaySpace,i),s!==null&&(c.matrix.fromArray(s.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale))),g!==null&&t.gripSpace&&(f=r.getPose(t.gripSpace,i),f!==null&&(g.matrix.fromArray(f.transform.matrix),g.matrix.decompose(g.position,g.rotation,g.scale)))),c!==null&&(c.visible=s!==null),g!==null&&(g.visible=f!==null),this}}),ut(Vn.prototype,se.prototype),ut(fa.prototype,{isFogExp2:!0,clone:function(){return new fa(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),ut(ko.prototype,{isFog:!0,clone:function(){return new ko(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(Go.prototype,"needsUpdate",{set:function(t){t===!0&&this.version++}}),ut(Go.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(t){return this.usage=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this},copyAt:function(t,r,i){t*=this.stride,i*=r.stride;for(var s=0,f=this.stride;s<f;s++)this.array[t+s]=r.array[i+s];return this},set:function(t,r){return r===void 0&&(r=0),this.array.set(t,r),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}});var Pf=new ot;Gr(_u.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),ut(_u.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(t){for(var r=0,i=this.data.count;r<i;r++)Pf.x=this.getX(r),Pf.y=this.getY(r),Pf.z=this.getZ(r),Pf.applyMatrix4(t),this.setXYZ(r,Pf.x,Pf.y,Pf.z);return this},setX:function(t,r){return this.data.array[t*this.data.stride+this.offset]=r,this},setY:function(t,r){return this.data.array[t*this.data.stride+this.offset+1]=r,this},setZ:function(t,r){return this.data.array[t*this.data.stride+this.offset+2]=r,this},setW:function(t,r){return this.data.array[t*this.data.stride+this.offset+3]=r,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this},setXYZ:function(t,r,i,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this},setXYZW:function(t,r,i,s,f){return t=t*this.data.stride+this.offset,this.data.array[t+0]=r,this.data.array[t+1]=i,this.data.array[t+2]=s,this.data.array[t+3]=f,this},clone:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return new He(new this.array.constructor(t),this.itemSize,this.normalized)},toJSON:function(){for(var t=[],r=0;r<this.count;r++)for(var i=r*this.data.stride+this.offset,s=0;s<this.itemSize;s++)t.push(this.data.array[i+s]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:t,normalized:this.normalized}}}),wu.prototype=at(de.prototype),wu.prototype.constructor=wu,wu.prototype.isSpriteMaterial=!0,wu.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this};var Rd,bm=new ot,Pd=new ot,Dd=new ot,Od=new vt,Vm=new vt,F_=new Ie,G1=new ot,Wm=new ot,b1=new ot,B_=new vt,kA=new vt,N_=new vt;xl.prototype=ut(at(Ee.prototype),{constructor:xl,isSprite:!0,raycast:function(t,r){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Pd.setFromMatrixScale(this.matrixWorld),F_.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Dd.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Pd.multiplyScalar(-Dd.z);var i=this.material.rotation;if(i!==0)var s=Math.cos(i),f=Math.sin(i);i=this.center,wp(G1.set(-.5,-.5,0),Dd,i,Pd,f,s),wp(Wm.set(.5,-.5,0),Dd,i,Pd,f,s),wp(b1.set(.5,.5,0),Dd,i,Pd,f,s),B_.set(0,0),kA.set(1,0),N_.set(1,1);var c=t.ray.intersectTriangle(G1,Wm,b1,!1,bm);c===null&&(wp(Wm.set(-.5,.5,0),Dd,i,Pd,f,s),kA.set(0,1),c=t.ray.intersectTriangle(G1,b1,Wm,!1,bm),c===null)||(f=t.ray.origin.distanceTo(bm),f<t.near||f>t.far||r.push({distance:f,point:bm.clone(),uv:Ci.getUV(bm,G1,Wm,b1,B_,kA,N_,new vt),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Ee.prototype.copy.call(this,t),t.center!==void 0&&this.center.copy(t.center),this}});var V1=new ot,z_=new ot;yo.prototype=ut(at(Ee.prototype),{constructor:yo,isLOD:!0,copy:function(t){Ee.prototype.copy.call(this,t,!1);for(var r=t.levels,i=0,s=r.length;i<s;i++){var f=r[i];this.addLevel(f.object.clone(),f.distance)}return this.autoUpdate=t.autoUpdate,this},addLevel:function(t,r){r===void 0&&(r=0),r=Math.abs(r);for(var i=this.levels,s=0;s<i.length&&!(r<i[s].distance);s++);return i.splice(s,0,{distance:r,object:t}),this.add(t),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(t){var r=this.levels;if(0<r.length){for(var i=1,s=r.length;i<s&&!(t<r[i].distance);i++);return r[i-1].object}return null},raycast:function(t,r){if(0<this.levels.length){V1.setFromMatrixPosition(this.matrixWorld);var i=t.ray.origin.distanceTo(V1);this.getObjectForDistance(i).raycast(t,r)}},update:function(t){var r=this.levels;if(1<r.length){V1.setFromMatrixPosition(t.matrixWorld),z_.setFromMatrixPosition(this.matrixWorld),t=V1.distanceTo(z_)/t.zoom,r[0].object.visible=!0;for(var i=1,s=r.length;i<s&&t>=r[i].distance;i++)r[i-1].object.visible=!1,r[i].object.visible=!0;for(this._currentLevel=i-1;i<s;i++)r[i].object.visible=!1}},toJSON:function(t){t=Ee.prototype.toJSON.call(this,t),this.autoUpdate===!1&&(t.object.autoUpdate=!1),t.object.levels=[];for(var r=this.levels,i=0,s=r.length;i<s;i++){var f=r[i];t.object.levels.push({object:f.object.uuid,distance:f.distance})}return t}}),Gs.prototype=ut(at(Wi.prototype),{constructor:Gs,isSkinnedMesh:!0,bind:function(t,r){this.skeleton=t,r===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),r=this.matrixWorld),this.bindMatrix.copy(r),this.bindMatrixInverse.getInverse(r)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var t=new _t,r=this.geometry.attributes.skinWeight,i=0,s=r.count;i<s;i++){t.x=r.getX(i),t.y=r.getY(i),t.z=r.getZ(i),t.w=r.getW(i);var f=1/t.manhattanLength();f!==1/0?t.multiplyScalar(f):t.set(1,0,0,0),r.setXYZW(i,t.x,t.y,t.z,t.w)}},updateMatrixWorld:function(t){Wi.prototype.updateMatrixWorld.call(this,t),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var t=new ot,r=new _t,i=new _t,s=new ot,f=new Ie;return function(c,g){var p=this.skeleton,A=this.geometry;for(r.fromBufferAttribute(A.attributes.skinIndex,c),i.fromBufferAttribute(A.attributes.skinWeight,c),t.fromBufferAttribute(A.attributes.position,c).applyMatrix4(this.bindMatrix),g.set(0,0,0),c=0;4>c;c++)if(A=i.getComponent(c),A!==0){var S=r.getComponent(c);f.multiplyMatrices(p.bones[S].matrixWorld,p.boneInverses[S]),g.addScaledVector(s.copy(t).applyMatrix4(f),A)}return g.applyMatrix4(this.bindMatrixInverse)}}()});var U_=new Ie,hC=new Ie;ut(Cs.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,r=this.bones.length;t<r;t++){var i=new Ie;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,r,i=0;for(r=this.bones.length;i<r;i++)(t=this.bones[i])&&t.matrixWorld.getInverse(this.boneInverses[i]);for(i=0,r=this.bones.length;i<r;i++)(t=this.bones[i])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){for(var t=this.bones,r=this.boneInverses,i=this.boneMatrices,s=this.boneTexture,f=0,c=t.length;f<c;f++)U_.multiplyMatrices(t[f]?t[f].matrixWorld:hC,r[f]),U_.toArray(i,16*f);s!==void 0&&(s.needsUpdate=!0)},clone:function(){return new Cs(this.bones,this.boneInverses)},getBoneByName:function(t){for(var r=0,i=this.bones.length;r<i;r++){var s=this.bones[r];if(s.name===t)return s}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),Kn.prototype=ut(at(Ee.prototype),{constructor:Kn,isBone:!0});var H_=new Ie,k_=new Ie,W1=[],jm=new Wi;Er.prototype=ut(at(Wi.prototype),{constructor:Er,isInstancedMesh:!0,getMatrixAt:function(t,r){r.fromArray(this.instanceMatrix.array,16*t)},raycast:function(t,r){var i=this.matrixWorld,s=this.count;if(jm.geometry=this.geometry,jm.material=this.material,jm.material!==void 0)for(var f=0;f<s;f++){this.getMatrixAt(f,H_),k_.multiplyMatrices(i,H_),jm.matrixWorld=k_,jm.raycast(t,W1);for(var c=0,g=W1.length;c<g;c++){var p=W1[c];p.instanceId=f,p.object=this,r.push(p)}W1.length=0}},setMatrixAt:function(t,r){r.toArray(this.instanceMatrix.array,16*t)},updateMorphTargets:function(){}}),Xi.prototype=at(de.prototype),Xi.prototype.constructor=Xi,Xi.prototype.isLineBasicMaterial=!0,Xi.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.morphTargets=t.morphTargets,this};var G_=new ot,b_=new ot,V_=new Ie,j1=new fn,X1=new Bi;as.prototype=ut(at(Ee.prototype),{constructor:as,isLine:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[0],s=1,f=r.count;s<f;s++)G_.fromBufferAttribute(r,s-1),b_.fromBufferAttribute(r,s),i[s]=i[s-1],i[s]+=G_.distanceTo(b_);t.setAttribute("lineDistance",new Ge(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,i[0]=0,s=1,f=r.length;s<f;s++)i[s]=i[s-1],i[s]+=r[s-1].distanceTo(r[s]);return this},raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Line.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),X1.copy(i.boundingSphere),X1.applyMatrix4(s),X1.radius+=f,t.ray.intersectsSphere(X1)!==!1){V_.getInverse(s),j1.copy(t.ray).applyMatrix4(V_),s=f/((this.scale.x+this.scale.y+this.scale.z)/3),s*=s;var c=new ot,g=new ot;f=new ot;var p=new ot,A=this&&this.isLineSegments?2:1;if(i.isBufferGeometry){var S=i.index,N=i.attributes.position.array;if(S!==null){S=S.array,i=0;for(var w=S.length-1;i<w;i+=A){var I=S[i+1];c.fromArray(N,3*S[i]),g.fromArray(N,3*I),I=j1.distanceSqToSegment(c,g,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}}else for(i=0,w=N.length/3-1;i<w;i+=A)c.fromArray(N,3*i),g.fromArray(N,3*i+3),I=j1.distanceSqToSegment(c,g,p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}else if(i.isGeometry)for(c=i.vertices,g=c.length,i=0;i<g-1;i+=A)I=j1.distanceSqToSegment(c[i],c[i+1],p,f),I>s||(p.applyMatrix4(this.matrixWorld),I=t.ray.origin.distanceTo(p),I<t.near||I>t.far||r.push({distance:I,point:f.clone().applyMatrix4(this.matrixWorld),index:i,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Pi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var Y1=new ot,Z1=new ot;pn.prototype=ut(at(as.prototype),{constructor:pn,isLineSegments:!0,computeLineDistances:function(){var t=this.geometry;if(t.isBufferGeometry)if(t.index===null){for(var r=t.attributes.position,i=[],s=0,f=r.count;s<f;s+=2)Y1.fromBufferAttribute(r,s),Z1.fromBufferAttribute(r,s+1),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+Y1.distanceTo(Z1);t.setAttribute("lineDistance",new Ge(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(t.isGeometry)for(r=t.vertices,i=t.lineDistances,s=0,f=r.length;s<f;s+=2)Y1.copy(r[s]),Z1.copy(r[s+1]),i[s]=s===0?0:i[s-1],i[s+1]=i[s]+Y1.distanceTo(Z1);return this}}),dn.prototype=ut(at(as.prototype),{constructor:dn,isLineLoop:!0}),us.prototype=at(de.prototype),us.prototype.constructor=us,us.prototype.isPointsMaterial=!0,us.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.morphTargets=t.morphTargets,this};var W_=new Ie,GA=new fn,J1=new Bi,q1=new ot;Ba.prototype=ut(at(Ee.prototype),{constructor:Ba,isPoints:!0,raycast:function(t,r){var i=this.geometry,s=this.matrixWorld,f=t.params.Points.threshold;if(i.boundingSphere===null&&i.computeBoundingSphere(),J1.copy(i.boundingSphere),J1.applyMatrix4(s),J1.radius+=f,t.ray.intersectsSphere(J1)!==!1)if(W_.getInverse(s),GA.copy(t.ray).applyMatrix4(W_),f/=(this.scale.x+this.scale.y+this.scale.z)/3,f*=f,i.isBufferGeometry){var c=i.index;if(i=i.attributes.position.array,c!==null){var g=c.array;c=0;for(var p=g.length;c<p;c++){var A=g[c];q1.fromArray(i,3*A),_h(q1,A,f,s,t,r,this)}}else for(c=0,g=i.length/3;c<g;c++)q1.fromArray(i,3*c),_h(q1,c,f,s,t,r,this)}else for(i=i.vertices,c=0,g=i.length;c<g;c++)_h(i[c],c,f,s,t,r,this)},updateMorphTargets:function(){var t=this.geometry;if(t.isBufferGeometry){t=t.morphAttributes;var r=Pi(t);if(0<r.length){var i=t[r[0]];if(i!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,r=i.length;t<r;t++){var s=i[t].name||String(t);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=t}}}else t=t.morphTargets,t!==void 0&&0<t.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),M0.prototype=ut(at(Lt.prototype),{constructor:M0,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Nc.prototype=at(Lt.prototype),Nc.prototype.constructor=Nc,Nc.prototype.isCompressedTexture=!0,Mp.prototype=at(Lt.prototype),Mp.prototype.constructor=Mp,Mp.prototype.isCanvasTexture=!0,Nr.prototype=at(Lt.prototype),Nr.prototype.constructor=Nr,Nr.prototype.isDepthTexture=!0,zc.prototype=at(We.prototype),zc.prototype.constructor=zc,Cp.prototype=at(Fr.prototype),Cp.prototype.constructor=Cp,wh.prototype=at(We.prototype),wh.prototype.constructor=wh,Tp.prototype=at(Fr.prototype),Tp.prototype.constructor=Tp,ao.prototype=at(We.prototype),ao.prototype.constructor=ao,fr.prototype=at(Fr.prototype),fr.prototype.constructor=fr,Uc.prototype=at(ao.prototype),Uc.prototype.constructor=Uc,Sp.prototype=at(Fr.prototype),Sp.prototype.constructor=Sp,bo.prototype=at(ao.prototype),bo.prototype.constructor=bo,gn.prototype=at(Fr.prototype),gn.prototype.constructor=gn,Hc.prototype=at(ao.prototype),Hc.prototype.constructor=Hc,Qe.prototype=at(Fr.prototype),Qe.prototype.constructor=Qe,Vo.prototype=at(ao.prototype),Vo.prototype.constructor=Vo,Ip.prototype=at(Fr.prototype),Ip.prototype.constructor=Ip,Al.prototype=at(We.prototype),Al.prototype.constructor=Al,Al.prototype.toJSON=function(){var t=We.prototype.toJSON.call(this);return t.path=this.parameters.path.toJSON(),t},Mh.prototype=at(Fr.prototype),Mh.prototype.constructor=Mh,kc.prototype=at(We.prototype),kc.prototype.constructor=kc,Ch.prototype=at(Fr.prototype),Ch.prototype.constructor=Ch,Mu.prototype=at(We.prototype),Mu.prototype.constructor=Mu;var cC={triangulate:function(t,r,i){i=i||2;var s=r&&r.length,f=s?r[0]*i:t.length,c=Na(t,0,f,i,!0),g=[];if(!c||c.next===c.prev)return g;var p;if(s){var A=i;s=[];var S,N=0;for(S=r.length;N<S;N++){var w=r[N]*A,I=N<S-1?r[N+1]*A:t.length;w=Na(t,w,I,A,!1),w===w.next&&(w.steiner=!0),s.push(bg(w))}for(s.sort(_l),N=0;N<s.length;N++)A=s[N],r=c,(r=T0(A,r))&&(A=Ep(r,A),rn(r,r.next),rn(A,A.next)),c=rn(c,c.next)}if(t.length>80*i){var L=p=t[0],P=s=t[1];for(A=i;A<f;A+=i)N=t[A],r=t[A+1],N<L&&(L=N),r<P&&(P=r),N>p&&(p=N),r>s&&(s=r);p=Math.max(p-L,s-P),p=p!==0?1/p:0}return Gc(c,g,i,L,P,p),g}},rc={area:function(t){for(var r=t.length,i=0,s=r-1,f=0;f<r;s=f++)i+=t[s].x*t[f].y-t[f].x*t[s].y;return .5*i},isClockWise:function(t){return 0>rc.area(t)},triangulateShape:function(t,r){var i=[],s=[],f=[];Wc(t),I0(i,t);var c=t.length;for(r.forEach(Wc),t=0;t<r.length;t++)s.push(c),c+=r[t].length,I0(i,r[t]);for(r=cC.triangulate(i,s),t=0;t<r.length;t+=3)f.push(r.slice(t,t+3));return f}};pa.prototype=at(Fr.prototype),pa.prototype.constructor=pa,pa.prototype.toJSON=function(){var t=Fr.prototype.toJSON.call(this);return E0(this.parameters.shapes,this.parameters.options,t)},Ts.prototype=at(We.prototype),Ts.prototype.constructor=Ts,Ts.prototype.toJSON=function(){var t=We.prototype.toJSON.call(this);return E0(this.parameters.shapes,this.parameters.options,t)};var fC={generateTopUV:function(t,r,i,s,f){t=r[3*s],s=r[3*s+1];var c=r[3*f];return f=r[3*f+1],[new vt(r[3*i],r[3*i+1]),new vt(t,s),new vt(c,f)]},generateSideWallUV:function(t,r,i,s,f,c){t=r[3*i];var g=r[3*i+1];i=r[3*i+2];var p=r[3*s],A=r[3*s+1];s=r[3*s+2];var S=r[3*f],N=r[3*f+1];f=r[3*f+2];var w=r[3*c],I=r[3*c+1];return r=r[3*c+2],.01>Math.abs(g-A)?[new vt(t,1-i),new vt(p,1-s),new vt(S,1-f),new vt(w,1-r)]:[new vt(g,1-i),new vt(A,1-s),new vt(N,1-f),new vt(I,1-r)]}};Eh.prototype=at(Fr.prototype),Eh.prototype.constructor=Eh,wl.prototype=at(Ts.prototype),wl.prototype.constructor=wl,Rp.prototype=at(Fr.prototype),Rp.prototype.constructor=Rp,Ml.prototype=at(We.prototype),Ml.prototype.constructor=Ml,jc.prototype=at(Fr.prototype),jc.prototype.constructor=jc,Xc.prototype=at(We.prototype),Xc.prototype.constructor=Xc,Yc.prototype=at(Fr.prototype),Yc.prototype.constructor=Yc,Lh.prototype=at(We.prototype),Lh.prototype.constructor=Lh,Cl.prototype=at(Fr.prototype),Cl.prototype.constructor=Cl,Cl.prototype.toJSON=function(){var t=Fr.prototype.toJSON.call(this);return L0(this.parameters.shapes,t)},za.prototype=at(We.prototype),za.prototype.constructor=za,za.prototype.toJSON=function(){var t=We.prototype.toJSON.call(this);return L0(this.parameters.shapes,t)},Zc.prototype=at(We.prototype),Zc.prototype.constructor=Zc,Ss.prototype=at(Fr.prototype),Ss.prototype.constructor=Ss,Ua.prototype=at(We.prototype),Ua.prototype.constructor=Ua,uo.prototype=at(Ss.prototype),uo.prototype.constructor=uo,Tl.prototype=at(Ua.prototype),Tl.prototype.constructor=Tl,Sl.prototype=at(Fr.prototype),Sl.prototype.constructor=Sl,Qn.prototype=at(We.prototype),Qn.prototype.constructor=Qn;var gs=Gu({__proto__:null,WireframeGeometry:zc,ParametricGeometry:Cp,ParametricBufferGeometry:wh,TetrahedronGeometry:fr,TetrahedronBufferGeometry:Uc,OctahedronGeometry:Sp,OctahedronBufferGeometry:bo,IcosahedronGeometry:gn,IcosahedronBufferGeometry:Hc,DodecahedronGeometry:Qe,DodecahedronBufferGeometry:Vo,PolyhedronGeometry:Tp,PolyhedronBufferGeometry:ao,TubeGeometry:Ip,TubeBufferGeometry:Al,TorusKnotGeometry:Mh,TorusKnotBufferGeometry:kc,TorusGeometry:Ch,TorusBufferGeometry:Mu,TextGeometry:Eh,TextBufferGeometry:wl,SphereGeometry:Rp,SphereBufferGeometry:Ml,RingGeometry:jc,RingBufferGeometry:Xc,PlaneGeometry:Lc,PlaneBufferGeometry:Oa,LatheGeometry:Yc,LatheBufferGeometry:Lh,ShapeGeometry:Cl,ShapeBufferGeometry:za,ExtrudeGeometry:pa,ExtrudeBufferGeometry:Ts,EdgesGeometry:Zc,ConeGeometry:uo,ConeBufferGeometry:Tl,CylinderGeometry:Ss,CylinderBufferGeometry:Ua,CircleGeometry:Sl,CircleBufferGeometry:Qn,BoxGeometry:oC,BoxBufferGeometry:H1});Il.prototype=at(de.prototype),Il.prototype.constructor=Il,Il.prototype.isShadowMaterial=!0,Il.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this},Jc.prototype=at(ki.prototype),Jc.prototype.constructor=Jc,Jc.prototype.isRawShaderMaterial=!0,$n.prototype=at(de.prototype),$n.prototype.constructor=$n,$n.prototype.isMeshStandardMaterial=!0,$n.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.vertexTangents=t.vertexTangents,this},Eo.prototype=at($n.prototype),Eo.prototype.constructor=Eo,Eo.prototype.isMeshPhysicalMaterial=!0,Eo.prototype.copy=function(t){return $n.prototype.copy.call(this,t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.reflectivity=t.reflectivity,this.sheen=t.sheen?(this.sheen||new Vt).copy(t.sheen):null,this.transparency=t.transparency,this},ls.prototype=at(de.prototype),ls.prototype.constructor=ls,ls.prototype.isMeshPhongMaterial=!0,ls.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},xo.prototype=at(de.prototype),xo.prototype.constructor=xo,xo.prototype.isMeshToonMaterial=!0,xo.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Vs.prototype=at(de.prototype),Vs.prototype.constructor=Vs,Vs.prototype.isMeshNormalMaterial=!0,Vs.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Tu.prototype=at(de.prototype),Tu.prototype.constructor=Tu,Tu.prototype.isMeshLambertMaterial=!0,Tu.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Su.prototype=at(de.prototype),Su.prototype.constructor=Su,Su.prototype.isMeshMatcapMaterial=!0,Su.prototype.copy=function(t){return de.prototype.copy.call(this,t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Iu.prototype=at(Xi.prototype),Iu.prototype.constructor=Iu,Iu.prototype.isLineDashedMaterial=!0,Iu.prototype.copy=function(t){return Xi.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var pC=Gu({__proto__:null,ShadowMaterial:Il,SpriteMaterial:wu,RawShaderMaterial:Jc,ShaderMaterial:ki,PointsMaterial:us,MeshPhysicalMaterial:Eo,MeshStandardMaterial:$n,MeshPhongMaterial:ls,MeshToonMaterial:xo,MeshNormalMaterial:Vs,MeshLambertMaterial:Tu,MeshDepthMaterial:ha,MeshDistanceMaterial:Au,MeshBasicMaterial:Rr,MeshMatcapMaterial:Su,LineDashedMaterial:Iu,LineBasicMaterial:Xi,Material:de}),Dn={arraySlice:function(t,r,i){return Dn.isTypedArray(t)?new t.constructor(t.subarray(r,i!==void 0?i:t.length)):t.slice(r,i)},convertArray:function(t,r,i){return!t||!i&&t.constructor===r?t:typeof r.BYTES_PER_ELEMENT=="number"?new r(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var r=t.length,i=Array(r),s=0;s!==r;++s)i[s]=s;return i.sort(function(f,c){return t[f]-t[c]}),i},sortedArray:function(t,r,i){for(var s=t.length,f=new t.constructor(s),c=0,g=0;g!==s;++c)for(var p=i[c]*r,A=0;A!==r;++A)f[g++]=t[p+A];return f},flattenJSON:function(t,r,i,s){for(var f=1,c=t[0];c!==void 0&&c[s]===void 0;)c=t[f++];if(c!==void 0){var g=c[s];if(g!==void 0)if(Array.isArray(g))do g=c[s],g!==void 0&&(r.push(c.time),i.push.apply(i,g)),c=t[f++];while(c!==void 0);else if(g.toArray!==void 0)do g=c[s],g!==void 0&&(r.push(c.time),g.toArray(i,i.length)),c=t[f++];while(c!==void 0);else do g=c[s],g!==void 0&&(r.push(c.time),i.push(g)),c=t[f++];while(c!==void 0)}},subclip:function(t,r,i,s,f){f=f||30,t=t.clone(),t.name=r;var c=[];for(r=0;r<t.tracks.length;++r){for(var g=t.tracks[r],p=g.getValueSize(),A=[],S=[],N=0;N<g.times.length;++N){var w=g.times[N]*f;if(!(w<i||w>=s))for(A.push(g.times[N]),w=0;w<p;++w)S.push(g.values[N*p+w])}A.length!==0&&(g.times=Dn.convertArray(A,g.times.constructor),g.values=Dn.convertArray(S,g.values.constructor),c.push(g))}for(t.tracks=c,i=1/0,r=0;r<t.tracks.length;++r)i>t.tracks[r].times[0]&&(i=t.tracks[r].times[0]);for(r=0;r<t.tracks.length;++r)t.tracks[r].shift(-1*i);return t.resetDuration(),t},makeClipAdditive:function(t,r,i,s){r===void 0&&(r=0),i===void 0&&(i=t),(s===void 0||0>=s)&&(s=30);var f=t.tracks.length;for(r/=s,s=0;s<f;++s){var c=i.tracks[s],g=c.ValueTypeName;if(g!=="bool"&&g!=="string"){var p=t.tracks.find(function(P){return P.name===c.name&&P.ValueTypeName===g});if(p!==void 0){var A=c.getValueSize(),S=c.times.length-1;r<=c.times[0]?S=Dn.arraySlice(c.values,0,c.valueSize):r>=c.times[S]?S=Dn.arraySlice(c.values,S*A):(S=c.createInterpolant(),S.evaluate(r),S=S.resultBuffer),g==="quaternion"&&new jt(S[0],S[1],S[2],S[3]).normalize().conjugate().toArray(S);for(var N=p.times.length,w=0;w<N;++w){var I=w*A;if(g==="quaternion")jt.multiplyQuaternionsFlat(p.values,I,S,0,p.values,I);else for(var L=0;L<A;++L)p.values[I+L]-=S[L]}}}}return t.blendMode=2501,t}};ut(Lo.prototype,{evaluate:function(t){var r=this.parameterPositions,i=this._cachedIndex,s=r[i],f=r[i-1];t:{e:{r:{i:if(!(t<s)){for(var c=i+2;;){if(s===void 0){if(t<f)break i;return this._cachedIndex=i=r.length,this.afterEnd_(i-1,t,f)}if(i===c)break;if(f=s,s=r[++i],t<s)break e}s=r.length;break r}if(t>=f)break t;for(c=r[1],t<c&&(i=2,f=c),c=i-2;;){if(f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(i===c)break;if(s=f,f=r[--i-1],t>=f)break e}s=i,i=0}for(;i<s;)f=i+s>>>1,t<r[f]?s=f:i=f+1;if(s=r[i],f=r[i-1],f===void 0)return this._cachedIndex=0,this.beforeStart_(0,t,s);if(s===void 0)return this._cachedIndex=i=r.length,this.afterEnd_(i-1,f,t)}this._cachedIndex=i,this.intervalChanged_(i,f,s)}return this.interpolate_(i,f,t,s)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){var r=this.resultBuffer,i=this.sampleValues,s=this.valueSize;t*=s;for(var f=0;f!==s;++f)r[f]=i[t+f];return r},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),ut(Lo.prototype,{beforeStart_:Lo.prototype.copySampleValue_,afterEnd_:Lo.prototype.copySampleValue_}),qc.prototype=ut(at(Lo.prototype),{constructor:qc,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(t,r,i){var s=this.parameterPositions,f=t-2,c=t+1,g=s[f],p=s[c];if(g===void 0)switch(this.getSettings_().endingStart){case 2401:f=t,g=2*r-i;break;case 2402:f=s.length-2,g=r+s[f]-s[f+1];break;default:f=t,g=i}if(p===void 0)switch(this.getSettings_().endingEnd){case 2401:c=t,p=2*i-r;break;case 2402:c=1,p=i+s[1]-s[0];break;default:c=t-1,p=r}t=.5*(i-r),s=this.valueSize,this._weightPrev=t/(r-g),this._weightNext=t/(p-i),this._offsetPrev=f*s,this._offsetNext=c*s},interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;t*=g;var p=t-g,A=this._offsetPrev,S=this._offsetNext,N=this._weightPrev,w=this._weightNext,I=(i-r)/(s-r);for(i=I*I,s=i*I,r=-N*s+2*N*i-N*I,N=(1+N)*s+(-1.5-2*N)*i+(-.5+N)*I+1,I=(-1-w)*s+(1.5+w)*i+.5*I,w=w*s-w*i,i=0;i!==g;++i)f[i]=r*c[A+i]+N*c[p+i]+I*c[t+i]+w*c[S+i];return f}}),El.prototype=ut(at(Lo.prototype),{constructor:El,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;t*=g;var p=t-g;for(r=(i-r)/(s-r),i=1-r,s=0;s!==g;++s)f[s]=c[p+s]*i+c[t+s]*r;return f}}),Pp.prototype=ut(at(Lo.prototype),{constructor:Pp,interpolate_:function(t){return this.copySampleValue_(t-1)}}),ut(Ao,{toJSON:function(t){var r=t.constructor;if(r.toJSON!==void 0)r=r.toJSON(t);else{r={name:t.name,times:Dn.convertArray(t.times,Array),values:Dn.convertArray(t.values,Array)};var i=t.getInterpolation();i!==t.DefaultInterpolation&&(r.interpolation=i)}return r.type=t.ValueTypeName,r}}),ut(Ao.prototype,{constructor:Ao,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(t){return new Pp(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new El(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new qc(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){switch(t){case 2300:var r=this.InterpolantFactoryMethodDiscrete;break;case 2301:r=this.InterpolantFactoryMethodLinear;break;case 2302:r=this.InterpolantFactoryMethodSmooth}if(r===void 0){if(r="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(r);return console.warn("THREE.KeyframeTrack:",r),this}return this.createInterpolant=r,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(t!==0)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]+=t;return this},scale:function(t){if(t!==1)for(var r=this.times,i=0,s=r.length;i!==s;++i)r[i]*=t;return this},trim:function(t,r){for(var i=this.times,s=i.length,f=0,c=s-1;f!==s&&i[f]<t;)++f;for(;c!==-1&&i[c]>r;)--c;return++c,(f!==0||c!==s)&&(f>=c&&(c=Math.max(c,1),f=c-1),t=this.getValueSize(),this.times=Dn.arraySlice(i,f,c),this.values=Dn.arraySlice(this.values,f*t,c*t)),this},validate:function(){var t=!0,r=this.getValueSize();r-Math.floor(r)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times;r=this.values;var s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var f=null,c=0;c!==s;c++){var g=i[c];if(typeof g=="number"&&isNaN(g)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,g),t=!1;break}if(f!==null&&f>g){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,g,f),t=!1;break}f=g}if(r!==void 0&&Dn.isTypedArray(r)){for(c=0,i=r.length;c!==i;++c)if(s=r[c],isNaN(s)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,c,s),t=!1;break}}return t},optimize:function(){for(var t=Dn.arraySlice(this.times),r=Dn.arraySlice(this.values),i=this.getValueSize(),s=this.getInterpolation()===2302,f=1,c=t.length-1,g=1;g<c;++g){var p=!1,A=t[g];if(A!==t[g+1]&&(g!==1||A!==A[0]))if(s)p=!0;else{var S=g*i,N=S-i,w=S+i;for(A=0;A!==i;++A){var I=r[S+A];if(I!==r[N+A]||I!==r[w+A]){p=!0;break}}}if(p){if(g!==f)for(t[f]=t[g],p=g*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}}if(0<c){for(t[f]=t[c],p=c*i,S=f*i,A=0;A!==i;++A)r[S+A]=r[p+A];++f}return f!==t.length?(this.times=Dn.arraySlice(t,0,f),this.values=Dn.arraySlice(r,0,f*i)):(this.times=t,this.values=r),this},clone:function(){var t=Dn.arraySlice(this.times,0),r=Dn.arraySlice(this.values,0);return t=new this.constructor(this.name,t,r),t.createInterpolant=this.createInterpolant,t}}),Dp.prototype=ut(at(Ao.prototype),{constructor:Dp,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Op.prototype=ut(at(Ao.prototype),{constructor:Op,ValueTypeName:"color"}),Ll.prototype=ut(at(Ao.prototype),{constructor:Ll,ValueTypeName:"number"}),Fp.prototype=ut(at(Lo.prototype),{constructor:Fp,interpolate_:function(t,r,i,s){var f=this.resultBuffer,c=this.sampleValues,g=this.valueSize;for(t*=g,r=(i-r)/(s-r),i=t+g;t!==i;t+=4)jt.slerpFlat(f,0,c,t-g,c,t,r);return f}}),Rh.prototype=ut(at(Ao.prototype),{constructor:Rh,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(t){return new Fp(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Bp.prototype=ut(at(Ao.prototype),{constructor:Bp,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Rl.prototype=ut(at(Ao.prototype),{constructor:Rl,ValueTypeName:"vector"}),ut(Is,{parse:function(t){for(var r=[],i=t.tracks,s=1/(t.fps||1),f=0,c=i.length;f!==c;++f)r.push(R0(i[f]).scale(s));return new Is(t.name,t.duration,r,t.blendMode)},toJSON:function(t){var r=[],i=t.tracks;t={name:t.name,duration:t.duration,tracks:r,uuid:t.uuid,blendMode:t.blendMode};for(var s=0,f=i.length;s!==f;++s)r.push(Ao.toJSON(i[s]));return t},CreateFromMorphTargetSequence:function(t,r,i,s){for(var f=r.length,c=[],g=0;g<f;g++){var p=[],A=[];p.push((g+f-1)%f,g,(g+1)%f),A.push(0,1,0);var S=Dn.getKeyframeOrder(p);p=Dn.sortedArray(p,1,S),A=Dn.sortedArray(A,1,S),s||p[0]!==0||(p.push(f),A.push(A[0])),c.push(new Ll(".morphTargetInfluences["+r[g].name+"]",p,A).scale(1/i))}return new Is(t,-1,c)},findByName:function(t,r){var i=t;for(Array.isArray(t)||(i=t.geometry&&t.geometry.animations||t.animations),t=0;t<i.length;t++)if(i[t].name===r)return i[t];return null},CreateClipsFromMorphTargetSequences:function(t,r,i){for(var s={},f=/^([\w-]*?)([\d]+)$/,c=0,g=t.length;c<g;c++){var p=t[c],A=p.name.match(f);if(A&&1<A.length){var S=A[1];(A=s[S])||(s[S]=A=[]),A.push(p)}}t=[];for(S in s)t.push(Is.CreateFromMorphTargetSequence(S,s[S],r,i));return t},parseAnimation:function(t,r){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var i=function(W,X,Z,tt,st){if(Z.length!==0){var xt=[],At=[];Dn.flattenJSON(Z,xt,At,tt),xt.length!==0&&st.push(new W(X,xt,At))}},s=[],f=t.name||"default",c=t.length||-1,g=t.fps||30,p=t.blendMode;t=t.hierarchy||[];for(var A=0;A<t.length;A++){var S=t[A].keys;if(S&&S.length!==0)if(S[0].morphTargets){c={};for(var N=0;N<S.length;N++)if(S[N].morphTargets)for(var w=0;w<S[N].morphTargets.length;w++)c[S[N].morphTargets[w]]=-1;for(var I in c){var L=[],P=[];for(w=0;w!==S[N].morphTargets.length;++w){var F=S[N];L.push(F.time),P.push(F.morphTarget===I?1:0)}s.push(new Ll(".morphTargetInfluence["+I+"]",L,P))}c=c.length*(g||1)}else N=".bones["+r[A].name+"]",i(Rl,N+".position",S,"pos",s),i(Rh,N+".quaternion",S,"rot",s),i(Rl,N+".scale",S,"scl",s)}return s.length===0?null:new Is(f,c,s,p)}}),ut(Is.prototype,{resetDuration:function(){for(var t=0,r=0,i=this.tracks.length;r!==i;++r){var s=this.tracks[r];t=Math.max(t,s.times[s.times.length-1])}return this.duration=t,this},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},validate:function(){for(var t=!0,r=0;r<this.tracks.length;r++)t=t&&this.tracks[r].validate();return t},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this},clone:function(){for(var t=[],r=0;r<this.tracks.length;r++)t.push(this.tracks[r].clone());return new Is(this.name,this.duration,t,this.blendMode)}});var Fd={enabled:!1,files:{},add:function(t,r){this.enabled!==!1&&(this.files[t]=r)},get:function(t){if(this.enabled!==!1)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},j_=new Pl;ut(Qr.prototype,{load:function(){},loadAsync:function(t,r){var i=this;return new xi(function(s,f){i.load(t,s,r,f)})},parse:function(){},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this},setResourcePath:function(t){return this.resourcePath=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}});var tu={};Wo.prototype=ut(at(Qr.prototype),{constructor:Wo,load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=Fd.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;if(tu[t]!==void 0)tu[t].push({onLoad:r,onProgress:i,onError:s});else{var g=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(g){i=g[1];var p=!!g[2];g=g[3],g=decodeURIComponent(g),p&&(g=atob(g));try{var A=(this.responseType||"").toLowerCase();switch(A){case"arraybuffer":case"blob":var S=new Uint8Array(g.length);for(p=0;p<g.length;p++)S[p]=g.charCodeAt(p);var N=A==="blob"?new Blob([S.buffer],{type:i}):S.buffer;break;case"document":N=new DOMParser().parseFromString(g,i);break;case"json":N=JSON.parse(g);break;default:N=g}setTimeout(function(){r&&r(N),f.manager.itemEnd(t)},0)}catch(I){setTimeout(function(){s&&s(I),f.manager.itemError(t),f.manager.itemEnd(t)},0)}}else{tu[t]=[],tu[t].push({onLoad:r,onProgress:i,onError:s});var w=new XMLHttpRequest;w.open("GET",t,!0),w.addEventListener("load",function(I){var L=this.response,P=tu[t];if(delete tu[t],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),Fd.add(t,L);for(var F=0,W=P.length;F<W;F++){var X=P[F];X.onLoad&&X.onLoad(L)}}else{for(F=0,W=P.length;F<W;F++)X=P[F],X.onError&&X.onError(I);f.manager.itemError(t)}f.manager.itemEnd(t)},!1),w.addEventListener("progress",function(I){for(var L=tu[t],P=0,F=L.length;P<F;P++){var W=L[P];W.onProgress&&W.onProgress(I)}},!1),w.addEventListener("error",function(I){var L=tu[t];delete tu[t];for(var P=0,F=L.length;P<F;P++){var W=L[P];W.onError&&W.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),w.addEventListener("abort",function(I){var L=tu[t];delete tu[t];for(var P=0,F=L.length;P<F;P++){var W=L[P];W.onError&&W.onError(I)}f.manager.itemError(t),f.manager.itemEnd(t)},!1),this.responseType!==void 0&&(w.responseType=this.responseType),this.withCredentials!==void 0&&(w.withCredentials=this.withCredentials),w.overrideMimeType&&w.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(p in this.requestHeader)w.setRequestHeader(p,this.requestHeader[p]);w.send(null)}return f.manager.itemStart(t),w}},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this}}),Dr.prototype=ut(at(Qr.prototype),{constructor:Dr,load:function(t,r,i,s){var f=this,c=new Wo(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){for(var r=[],i=0;i<t.length;i++){var s=Is.parse(t[i]);r.push(s)}return r}}),P0.prototype=ut(at(Qr.prototype),{constructor:P0,load:function(t,r,i,s){function f(I){A.load(t[I],function(L){L=c.parse(L,!0),g[I]={width:L.width,height:L.height,format:L.format,mipmaps:L.mipmaps},S+=1,S===6&&(L.mipmapCount===1&&(p.minFilter=1006),p.format=L.format,p.needsUpdate=!0,r&&r(p))},i,s)}var c=this,g=[],p=new Nc;p.image=g;var A=new Wo(this.manager);if(A.setPath(this.path),A.setResponseType("arraybuffer"),Array.isArray(t))for(var S=0,N=0,w=t.length;N<w;++N)f(N);else A.load(t,function(I){if(I=c.parse(I,!0),I.isCubemap)for(var L=I.mipmaps.length/I.mipmapCount,P=0;P<L;P++){g[P]={mipmaps:[]};for(var F=0;F<I.mipmapCount;F++)g[P].mipmaps.push(I.mipmaps[P*I.mipmapCount+F]),g[P].format=I.format,g[P].width=I.width,g[P].height=I.height}else p.image.width=I.width,p.image.height=I.height,p.mipmaps=I.mipmaps;I.mipmapCount===1&&(p.minFilter=1006),p.format=I.format,p.needsUpdate=!0,r&&r(p)},i,s);return p}}),D0.prototype=ut(at(Qr.prototype),{constructor:D0,load:function(t,r,i,s){var f=this,c=new dl,g=new Wo(this.manager);return g.setResponseType("arraybuffer"),g.setPath(this.path),g.load(t,function(p){(p=f.parse(p))&&(p.image!==void 0?c.image=p.image:p.data!==void 0&&(c.image.width=p.width,c.image.height=p.height,c.image.data=p.data),c.wrapS=p.wrapS!==void 0?p.wrapS:1001,c.wrapT=p.wrapT!==void 0?p.wrapT:1001,c.magFilter=p.magFilter!==void 0?p.magFilter:1006,c.minFilter=p.minFilter!==void 0?p.minFilter:1006,c.anisotropy=p.anisotropy!==void 0?p.anisotropy:1,p.format!==void 0&&(c.format=p.format),p.type!==void 0&&(c.type=p.type),p.mipmaps!==void 0&&(c.mipmaps=p.mipmaps,c.minFilter=1008),p.mipmapCount===1&&(c.minFilter=1006),c.needsUpdate=!0,r&&r(c,p))},i,s),c}}),Ph.prototype=ut(at(Qr.prototype),{constructor:Ph,load:function(t,r,i,s){function f(){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),Fd.add(t,this),r&&r(this),g.manager.itemEnd(t)}function c(S){A.removeEventListener("load",f,!1),A.removeEventListener("error",c,!1),s&&s(S),g.manager.itemError(t),g.manager.itemEnd(t)}this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var g=this,p=Fd.get(t);if(p!==void 0)return g.manager.itemStart(t),setTimeout(function(){r&&r(p),g.manager.itemEnd(t)},0),p;var A=document.createElementNS("http://www.w3.org/1999/xhtml","img");return A.addEventListener("load",f,!1),A.addEventListener("error",c,!1),t.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(A.crossOrigin=this.crossOrigin),g.manager.itemStart(t),A.src=t,A}}),Vg.prototype=ut(at(Qr.prototype),{constructor:Vg,load:function(t,r,i,s){function f(A){g.load(t[A],function(S){c.images[A]=S,p++,p===6&&(c.needsUpdate=!0,r&&r(c))},void 0,s)}var c=new Fa,g=new Ph(this.manager);g.setCrossOrigin(this.crossOrigin),g.setPath(this.path);var p=0;for(i=0;i<t.length;++i)f(i);return c}}),Qc.prototype=ut(at(Qr.prototype),{constructor:Qc,load:function(t,r,i,s){var f=new Lt,c=new Ph(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(t,function(g){f.image=g,g=0<t.search(/\.jpe?g($|\?)/i)||t.search(/^data:image\/jpeg/)===0,f.format=g?1022:1023,f.needsUpdate=!0,r!==void 0&&r(f)},i,s),f}}),ut(Ur.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,r){return t=this.getUtoTmapping(t),this.getPoint(t,r)},getPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return r},getSpacedPoints:function(t){t===void 0&&(t=5);for(var r=[],i=0;i<=t;i++)r.push(this.getPointAt(i/t));return r},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(t===void 0&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var r=[],i=this.getPoint(0),s,f=0;for(r.push(0),s=1;s<=t;s++){var c=this.getPoint(s/t);f+=c.distanceTo(i),r.push(f),i=c}return this.cacheArcLengths=r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,r){var i=this.getLengths(),s=i.length;r=r||t*i[s-1];for(var f=0,c=s-1,g;f<=c;)if(t=Math.floor(f+(c-f)/2),g=i[t]-r,0>g)f=t+1;else if(0<g)c=t-1;else{c=t;break}return t=c,i[t]===r?t/(s-1):(f=i[t],(t+(r-f)/(i[t+1]-f))/(s-1))},getTangent:function(t,r){var i=t-1e-4;return t+=1e-4,0>i&&(i=0),1<t&&(t=1),i=this.getPoint(i),t=this.getPoint(t),r=r||(i.isVector2?new vt:new ot),r.copy(t).sub(i).normalize(),r},getTangentAt:function(t,r){return t=this.getUtoTmapping(t),this.getTangent(t,r)},computeFrenetFrames:function(t,r){var i=new ot,s=[],f=[],c=[],g=new ot,p=new Ie,A;for(A=0;A<=t;A++){var S=A/t;s[A]=this.getTangentAt(S,new ot),s[A].normalize()}f[0]=new ot,c[0]=new ot,A=Number.MAX_VALUE,S=Math.abs(s[0].x);var N=Math.abs(s[0].y),w=Math.abs(s[0].z);for(S<=A&&(A=S,i.set(1,0,0)),N<=A&&(A=N,i.set(0,1,0)),w<=A&&i.set(0,0,1),g.crossVectors(s[0],i).normalize(),f[0].crossVectors(s[0],g),c[0].crossVectors(s[0],f[0]),A=1;A<=t;A++)f[A]=f[A-1].clone(),c[A]=c[A-1].clone(),g.crossVectors(s[A-1],s[A]),g.length()>hn&&(g.normalize(),i=Math.acos(Tr.clamp(s[A-1].dot(s[A]),-1,1)),f[A].applyMatrix4(p.makeRotationAxis(g,i))),c[A].crossVectors(s[A],f[A]);if(r===!0)for(i=Math.acos(Tr.clamp(f[0].dot(f[t]),-1,1)),i/=t,0<s[0].dot(g.crossVectors(f[0],f[t]))&&(i=-i),A=1;A<=t;A++)f[A].applyMatrix4(p.makeRotationAxis(s[A],i*A)),c[A].crossVectors(s[A],f[A]);return{tangents:s,normals:f,binormals:c}},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Es.prototype=at(Ur.prototype),Es.prototype.constructor=Es,Es.prototype.isEllipseCurve=!0,Es.prototype.getPoint=function(t,r){r=r||new vt;for(var i=2*Math.PI,s=this.aEndAngle-this.aStartAngle,f=Math.abs(s)<hn;0>s;)s+=i;for(;s>i;)s-=i;s<hn&&(s=f?0:i),this.aClockwise!==!0||f||(s=s===i?-i:s-i),i=this.aStartAngle+t*s,t=this.aX+this.xRadius*Math.cos(i);var c=this.aY+this.yRadius*Math.sin(i);return this.aRotation!==0&&(i=Math.cos(this.aRotation),s=Math.sin(this.aRotation),f=t-this.aX,c-=this.aY,t=f*i-c*s+this.aX,c=f*s+c*i+this.aY),r.set(t,c)},Es.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Es.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Es.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},$c.prototype=at(Es.prototype),$c.prototype.constructor=$c,$c.prototype.isArcCurve=!0;var K1=new ot,bA=new Pr,VA=new Pr,WA=new Pr;Ro.prototype=at(Ur.prototype),Ro.prototype.constructor=Ro,Ro.prototype.isCatmullRomCurve3=!0,Ro.prototype.getPoint=function(t,r){r=r||new ot;var i=this.points,s=i.length;t*=s-(this.closed?0:1);var f=Math.floor(t);if(t-=f,this.closed?f+=0<f?0:(Math.floor(Math.abs(f)/s)+1)*s:t===0&&f===s-1&&(f=s-2,t=1),this.closed||0<f)var c=i[(f-1)%s];else K1.subVectors(i[0],i[1]).add(i[0]),c=K1;var g=i[f%s],p=i[(f+1)%s];if(this.closed||f+2<s?i=i[(f+2)%s]:(K1.subVectors(i[s-1],i[s-2]).add(i[s-1]),i=K1),this.curveType==="centripetal"||this.curveType==="chordal"){var A=this.curveType==="chordal"?.5:.25;s=Math.pow(c.distanceToSquared(g),A),f=Math.pow(g.distanceToSquared(p),A),A=Math.pow(p.distanceToSquared(i),A),1e-4>f&&(f=1),1e-4>s&&(s=f),1e-4>A&&(A=f),bA.initNonuniformCatmullRom(c.x,g.x,p.x,i.x,s,f,A),VA.initNonuniformCatmullRom(c.y,g.y,p.y,i.y,s,f,A),WA.initNonuniformCatmullRom(c.z,g.z,p.z,i.z,s,f,A)}else this.curveType==="catmullrom"&&(bA.initCatmullRom(c.x,g.x,p.x,i.x,this.tension),VA.initCatmullRom(c.y,g.y,p.y,i.y,this.tension),WA.initCatmullRom(c.z,g.z,p.z,i.z,this.tension));return r.set(bA.calc(t),VA.calc(t),WA.calc(t)),r},Ro.prototype.copy=function(t){Ur.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Ro.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Ro.prototype.fromJSON=function(t){Ur.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new ot().fromArray(s))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},da.prototype=at(Ur.prototype),da.prototype.constructor=da,da.prototype.isCubicBezierCurve=!0,da.prototype.getPoint=function(t,r){r=r||new vt;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(tf(t,i.x,s.x,f.x,c.x),tf(t,i.y,s.y,f.y,c.y)),r},da.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},da.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},da.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},hs.prototype=at(Ur.prototype),hs.prototype.constructor=hs,hs.prototype.isCubicBezierCurve3=!0,hs.prototype.getPoint=function(t,r){r=r||new ot;var i=this.v0,s=this.v1,f=this.v2,c=this.v3;return r.set(tf(t,i.x,s.x,f.x,c.x),tf(t,i.y,s.y,f.y,c.y),tf(t,i.z,s.z,f.z,c.z)),r},hs.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},hs.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},hs.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},cs.prototype=at(Ur.prototype),cs.prototype.constructor=cs,cs.prototype.isLineCurve=!0,cs.prototype.getPoint=function(t,r){return r=r||new vt,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},cs.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},cs.prototype.getTangent=function(t,r){return t=r||new vt,t=t.copy(this.v2).sub(this.v1).normalize()},cs.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},cs.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},cs.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Ls.prototype=at(Ur.prototype),Ls.prototype.constructor=Ls,Ls.prototype.isLineCurve3=!0,Ls.prototype.getPoint=function(t,r){return r=r||new ot,t===1?r.copy(this.v2):(r.copy(this.v2).sub(this.v1),r.multiplyScalar(t).add(this.v1)),r},Ls.prototype.getPointAt=function(t,r){return this.getPoint(t,r)},Ls.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Ls.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Ls.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ga.prototype=at(Ur.prototype),ga.prototype.constructor=ga,ga.prototype.isQuadraticBezierCurve=!0,ga.prototype.getPoint=function(t,r){r=r||new vt;var i=this.v0,s=this.v1,f=this.v2;return r.set(Eu(t,i.x,s.x,f.x),Eu(t,i.y,s.y,f.y)),r},ga.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ga.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ga.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},fs.prototype=at(Ur.prototype),fs.prototype.constructor=fs,fs.prototype.isQuadraticBezierCurve3=!0,fs.prototype.getPoint=function(t,r){r=r||new ot;var i=this.v0,s=this.v1,f=this.v2;return r.set(Eu(t,i.x,s.x,f.x),Eu(t,i.y,s.y,f.y),Eu(t,i.z,s.z,f.z)),r},fs.prototype.copy=function(t){return Ur.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},fs.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},fs.prototype.fromJSON=function(t){return Ur.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Po.prototype=at(Ur.prototype),Po.prototype.constructor=Po,Po.prototype.isSplineCurve=!0,Po.prototype.getPoint=function(t,r){r=r||new vt;var i=this.points,s=(i.length-1)*t;t=Math.floor(s),s-=t;var f=i[t===0?t:t-1],c=i[t],g=i[t>i.length-2?i.length-1:t+1];return i=i[t>i.length-3?i.length-1:t+2],r.set(O0(s,f.x,c.x,g.x,i.x),O0(s,f.y,c.y,g.y,i.y)),r},Po.prototype.copy=function(t){Ur.prototype.copy.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++)this.points.push(t.points[r].clone());return this},Po.prototype.toJSON=function(){var t=Ur.prototype.toJSON.call(this);t.points=[];for(var r=0,i=this.points.length;r<i;r++)t.points.push(this.points[r].toArray());return t},Po.prototype.fromJSON=function(t){Ur.prototype.fromJSON.call(this,t),this.points=[];for(var r=0,i=t.points.length;r<i;r++){var s=t.points[r];this.points.push(new vt().fromArray(s))}return this};var jA=Gu({__proto__:null,ArcCurve:$c,CatmullRomCurve3:Ro,CubicBezierCurve:da,CubicBezierCurve3:hs,EllipseCurve:Es,LineCurve:cs,LineCurve3:Ls,QuadraticBezierCurve:ga,QuadraticBezierCurve3:fs,SplineCurve:Po});Lu.prototype=ut(at(Ur.prototype),{constructor:Lu,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),r=this.curves[this.curves.length-1].getPoint(1);t.equals(r)||this.curves.push(new cs(r,t))},getPoint:function(t){var r=t*this.getLength(),i=this.getCurveLengths();for(t=0;t<i.length;){if(i[t]>=r)return r=i[t]-r,t=this.curves[t],i=t.getLength(),t.getPointAt(i===0?0:1-r/i);t++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],r=0,i=0,s=this.curves.length;i<s;i++)r+=this.curves[i].getLength(),t.push(r);return this.cacheLengths=t},getSpacedPoints:function(t){t===void 0&&(t=40);for(var r=[],i=0;i<=t;i++)r.push(this.getPoint(i/t));return this.autoClose&&r.push(r[0]),r},getPoints:function(t){t=t||12;for(var r=[],i,s=0,f=this.curves;s<f.length;s++){var c=f[s];c=c.getPoints(c&&c.isEllipseCurve?2*t:c&&(c.isLineCurve||c.isLineCurve3)?1:c&&c.isSplineCurve?t*c.points.length:t);for(var g=0;g<c.length;g++){var p=c[g];i&&i.equals(p)||(r.push(p),i=p)}}return this.autoClose&&1<r.length&&!r[r.length-1].equals(r[0])&&r.push(r[0]),r},copy:function(t){Ur.prototype.copy.call(this,t),this.curves=[];for(var r=0,i=t.curves.length;r<i;r++)this.curves.push(t.curves[r].clone());return this.autoClose=t.autoClose,this},toJSON:function(){var t=Ur.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var r=0,i=this.curves.length;r<i;r++)t.curves.push(this.curves[r].toJSON());return t},fromJSON:function(t){Ur.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var r=0,i=t.curves.length;r<i;r++){var s=t.curves[r];this.curves.push(new jA[s.type]().fromJSON(s))}return this}}),yi.prototype=ut(at(Lu.prototype),{constructor:yi,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var r=1,i=t.length;r<i;r++)this.lineTo(t[r].x,t[r].y);return this},moveTo:function(t,r){return this.currentPoint.set(t,r),this},lineTo:function(t,r){var i=new cs(this.currentPoint.clone(),new vt(t,r));return this.curves.push(i),this.currentPoint.set(t,r),this},quadraticCurveTo:function(t,r,i,s){return t=new ga(this.currentPoint.clone(),new vt(t,r),new vt(i,s)),this.curves.push(t),this.currentPoint.set(i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return t=new da(this.currentPoint.clone(),new vt(t,r),new vt(i,s),new vt(f,c)),this.curves.push(t),this.currentPoint.set(f,c),this},splineThru:function(t){var r=[this.currentPoint.clone()].concat(t);return r=new Po(r),this.curves.push(r),this.currentPoint.copy(t[t.length-1]),this},arc:function(t,r,i,s,f,c){return this.absarc(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c),this},absarc:function(t,r,i,s,f,c){return this.absellipse(t,r,i,i,s,f,c),this},ellipse:function(t,r,i,s,f,c,g,p){return this.absellipse(t+this.currentPoint.x,r+this.currentPoint.y,i,s,f,c,g,p),this},absellipse:function(t,r,i,s,f,c,g,p){return t=new Es(t,r,i,s,f,c,g,p),0<this.curves.length&&(r=t.getPoint(0),r.equals(this.currentPoint)||this.lineTo(r.x,r.y)),this.curves.push(t),t=t.getPoint(1),this.currentPoint.copy(t),this},copy:function(t){return Lu.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Lu.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Lu.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Ru.prototype=ut(at(yi.prototype),{constructor:Ru,getPointsHoles:function(t){for(var r=[],i=0,s=this.holes.length;i<s;i++)r[i]=this.holes[i].getPoints(t);return r},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){yi.prototype.copy.call(this,t),this.holes=[];for(var r=0,i=t.holes.length;r<i;r++)this.holes.push(t.holes[r].clone());return this},toJSON:function(){var t=yi.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var r=0,i=this.holes.length;r<i;r++)t.holes.push(this.holes[r].toJSON());return t},fromJSON:function(t){yi.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var r=0,i=t.holes.length;r<i;r++){var s=t.holes[r];this.holes.push(new yi().fromJSON(s))}return this}}),nn.prototype=ut(at(Ee.prototype),{constructor:nn,isLight:!0,copy:function(t){return Ee.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){return t=Ee.prototype.toJSON.call(this,t),t.object.color=this.color.getHex(),t.object.intensity=this.intensity,this.groundColor!==void 0&&(t.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(t.object.distance=this.distance),this.angle!==void 0&&(t.object.angle=this.angle),this.decay!==void 0&&(t.object.decay=this.decay),this.penumbra!==void 0&&(t.object.penumbra=this.penumbra),this.shadow!==void 0&&(t.object.shadow=this.shadow.toJSON()),t}}),Np.prototype=ut(at(nn.prototype),{constructor:Np,isHemisphereLight:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),ut(Ws.prototype,{_projScreenMatrix:new Ie,_lightPositionWorld:new ot,_lookTarget:new ot,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(t){var r=this.camera,i=this.matrix,s=this._projScreenMatrix,f=this._lookTarget,c=this._lightPositionWorld;c.setFromMatrixPosition(t.matrixWorld),r.position.copy(c),f.setFromMatrixPosition(t.target.matrixWorld),r.lookAt(f),r.updateMatrixWorld(),s.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(s),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(r.projectionMatrix),i.multiply(r.matrixWorldInverse)},getViewport:function(t){return this._viewports[t]},getFrameExtents:function(){return this._frameExtents},copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t={};return this.bias!==0&&(t.bias=this.bias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),zp.prototype=ut(at(Ws.prototype),{constructor:zp,isSpotLightShadow:!0,updateMatrices:function(t){var r=this.camera,i=2*Tr.RAD2DEG*t.angle,s=this.mapSize.width/this.mapSize.height,f=t.distance||r.far;(i!==r.fov||s!==r.aspect||f!==r.far)&&(r.fov=i,r.aspect=s,r.far=f,r.updateProjectionMatrix()),Ws.prototype.updateMatrices.call(this,t)}}),ef.prototype=ut(at(nn.prototype),{constructor:ef,isSpotLight:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Wg.prototype=ut(at(Ws.prototype),{constructor:Wg,isPointLightShadow:!0,updateMatrices:function(t,r){r===void 0&&(r=0);var i=this.camera,s=this.matrix,f=this._lightPositionWorld,c=this._lookTarget,g=this._projScreenMatrix;f.setFromMatrixPosition(t.matrixWorld),i.position.copy(f),c.copy(i.position),c.add(this._cubeDirections[r]),i.up.copy(this._cubeUps[r]),i.lookAt(c),i.updateMatrixWorld(),s.makeTranslation(-f.x,-f.y,-f.z),g.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(g)}}),Pu.prototype=ut(at(nn.prototype),{constructor:Pu,isPointLight:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),js.prototype=ut(at(Da.prototype),{constructor:js,isOrthographicCamera:!0,copy:function(t,r){return Da.prototype.copy.call(this,t,r),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:ut({},t.view),this},setViewOffset:function(t,r,i,s,f,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=i,this.view.offsetY=s,this.view.width=f,this.view.height=c,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,s=(this.top+this.bottom)/2,f=i-t;i+=t,t=s+r,r=s-r,this.view!==null&&this.view.enabled&&(s=(this.right-this.left)/this.view.fullWidth/this.zoom,r=(this.top-this.bottom)/this.view.fullHeight/this.zoom,f+=s*this.view.offsetX,i=f+s*this.view.width,t-=r*this.view.offsetY,r=t-r*this.view.height),this.projectionMatrix.makeOrthographic(f,i,t,r,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(t){return t=Ee.prototype.toJSON.call(this,t),t.object.zoom=this.zoom,t.object.left=this.left,t.object.right=this.right,t.object.top=this.top,t.object.bottom=this.bottom,t.object.near=this.near,t.object.far=this.far,this.view!==null&&(t.object.view=ut({},this.view)),t}}),jg.prototype=ut(at(Ws.prototype),{constructor:jg,isDirectionalLightShadow:!0,updateMatrices:function(t){Ws.prototype.updateMatrices.call(this,t)}}),Jr.prototype=ut(at(nn.prototype),{constructor:Jr,isDirectionalLight:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Xg.prototype=ut(at(nn.prototype),{constructor:Xg,isAmbientLight:!0}),Yg.prototype=ut(at(nn.prototype),{constructor:Yg,isRectAreaLight:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){return t=nn.prototype.toJSON.call(this,t),t.object.width=this.width,t.object.height=this.height,t}}),ut(Zg.prototype,{isSphericalHarmonics3:!0,set:function(t){for(var r=0;9>r;r++)this.coefficients[r].copy(t[r]);return this},zero:function(){for(var t=0;9>t;t++)this.coefficients[t].set(0,0,0);return this},getAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.282095),r.addScaledVector(f[1],.488603*s),r.addScaledVector(f[2],.488603*t),r.addScaledVector(f[3],.488603*i),r.addScaledVector(f[4],1.092548*i*s),r.addScaledVector(f[5],1.092548*s*t),r.addScaledVector(f[6],.315392*(3*t*t-1)),r.addScaledVector(f[7],1.092548*i*t),r.addScaledVector(f[8],.546274*(i*i-s*s)),r},getIrradianceAt:function(t,r){var i=t.x,s=t.y;t=t.z;var f=this.coefficients;return r.copy(f[0]).multiplyScalar(.886227),r.addScaledVector(f[1],1.023328*s),r.addScaledVector(f[2],1.023328*t),r.addScaledVector(f[3],1.023328*i),r.addScaledVector(f[4],.858086*i*s),r.addScaledVector(f[5],.858086*s*t),r.addScaledVector(f[6],.743125*t*t-.247708),r.addScaledVector(f[7],.858086*i*t),r.addScaledVector(f[8],.429043*(i*i-s*s)),r},add:function(t){for(var r=0;9>r;r++)this.coefficients[r].add(t.coefficients[r]);return this},addScaledSH:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].addScaledVector(t.coefficients[i],r);return this},scale:function(t){for(var r=0;9>r;r++)this.coefficients[r].multiplyScalar(t);return this},lerp:function(t,r){for(var i=0;9>i;i++)this.coefficients[i].lerp(t.coefficients[i],r);return this},equals:function(t){for(var r=0;9>r;r++)if(!this.coefficients[r].equals(t.coefficients[r]))return!1;return!0},copy:function(t){return this.set(t.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(t,r){r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].fromArray(t,r+3*s);return this},toArray:function(t,r){t===void 0&&(t=[]),r===void 0&&(r=0);for(var i=this.coefficients,s=0;9>s;s++)i[s].toArray(t,r+3*s);return t}}),ut(Zg,{getBasisAt:function(t,r){var i=t.x,s=t.y;t=t.z,r[0]=.282095,r[1]=.488603*s,r[2]=.488603*t,r[3]=.488603*i,r[4]=1.092548*i*s,r[5]=1.092548*s*t,r[6]=.315392*(3*t*t-1),r[7]=1.092548*i*t,r[8]=.546274*(i*i-s*s)}}),Rs.prototype=ut(at(nn.prototype),{constructor:Rs,isLightProbe:!0,copy:function(t){return nn.prototype.copy.call(this,t),this.sh.copy(t.sh),this},fromJSON:function(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this},toJSON:function(t){return t=nn.prototype.toJSON.call(this,t),t.object.sh=this.sh.toArray(),t}}),Up.prototype=ut(at(Qr.prototype),{constructor:Up,load:function(t,r,i,s){var f=this,c=new Wo(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){function r(p){return i[p]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",p),i[p]}var i=this.textures,s=new pC[t.type];if(t.uuid!==void 0&&(s.uuid=t.uuid),t.name!==void 0&&(s.name=t.name),t.color!==void 0&&s.color.setHex(t.color),t.roughness!==void 0&&(s.roughness=t.roughness),t.metalness!==void 0&&(s.metalness=t.metalness),t.sheen!==void 0&&(s.sheen=new Vt().setHex(t.sheen)),t.emissive!==void 0&&s.emissive.setHex(t.emissive),t.specular!==void 0&&s.specular.setHex(t.specular),t.shininess!==void 0&&(s.shininess=t.shininess),t.clearcoat!==void 0&&(s.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(s.clearcoatRoughness=t.clearcoatRoughness),t.fog!==void 0&&(s.fog=t.fog),t.flatShading!==void 0&&(s.flatShading=t.flatShading),t.blending!==void 0&&(s.blending=t.blending),t.combine!==void 0&&(s.combine=t.combine),t.side!==void 0&&(s.side=t.side),t.opacity!==void 0&&(s.opacity=t.opacity),t.transparent!==void 0&&(s.transparent=t.transparent),t.alphaTest!==void 0&&(s.alphaTest=t.alphaTest),t.depthTest!==void 0&&(s.depthTest=t.depthTest),t.depthWrite!==void 0&&(s.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(s.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(s.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(s.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(s.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(s.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(s.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(s.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(s.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(s.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(s.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(s.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(s.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(s.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(s.rotation=t.rotation),t.linewidth!==1&&(s.linewidth=t.linewidth),t.dashSize!==void 0&&(s.dashSize=t.dashSize),t.gapSize!==void 0&&(s.gapSize=t.gapSize),t.scale!==void 0&&(s.scale=t.scale),t.polygonOffset!==void 0&&(s.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(s.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(s.polygonOffsetUnits=t.polygonOffsetUnits),t.skinning!==void 0&&(s.skinning=t.skinning),t.morphTargets!==void 0&&(s.morphTargets=t.morphTargets),t.morphNormals!==void 0&&(s.morphNormals=t.morphNormals),t.dithering!==void 0&&(s.dithering=t.dithering),t.vertexTangents!==void 0&&(s.vertexTangents=t.vertexTangents),t.visible!==void 0&&(s.visible=t.visible),t.toneMapped!==void 0&&(s.toneMapped=t.toneMapped),t.userData!==void 0&&(s.userData=t.userData),t.vertexColors!==void 0&&(s.vertexColors=typeof t.vertexColors=="number"?0<t.vertexColors:t.vertexColors),t.uniforms!==void 0)for(var f in t.uniforms){var c=t.uniforms[f];switch(s.uniforms[f]={},c.type){case"t":s.uniforms[f].value=r(c.value);break;case"c":s.uniforms[f].value=new Vt().setHex(c.value);break;case"v2":s.uniforms[f].value=new vt().fromArray(c.value);break;case"v3":s.uniforms[f].value=new ot().fromArray(c.value);break;case"v4":s.uniforms[f].value=new _t().fromArray(c.value);break;case"m3":s.uniforms[f].value=new Ot().fromArray(c.value);case"m4":s.uniforms[f].value=new Ie().fromArray(c.value);break;default:s.uniforms[f].value=c.value}}if(t.defines!==void 0&&(s.defines=t.defines),t.vertexShader!==void 0&&(s.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(s.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(var g in t.extensions)s.extensions[g]=t.extensions[g];return t.shading!==void 0&&(s.flatShading=t.shading===1),t.size!==void 0&&(s.size=t.size),t.sizeAttenuation!==void 0&&(s.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(s.map=r(t.map)),t.matcap!==void 0&&(s.matcap=r(t.matcap)),t.alphaMap!==void 0&&(s.alphaMap=r(t.alphaMap)),t.bumpMap!==void 0&&(s.bumpMap=r(t.bumpMap)),t.bumpScale!==void 0&&(s.bumpScale=t.bumpScale),t.normalMap!==void 0&&(s.normalMap=r(t.normalMap)),t.normalMapType!==void 0&&(s.normalMapType=t.normalMapType),t.normalScale!==void 0&&(f=t.normalScale,Array.isArray(f)===!1&&(f=[f,f]),s.normalScale=new vt().fromArray(f)),t.displacementMap!==void 0&&(s.displacementMap=r(t.displacementMap)),t.displacementScale!==void 0&&(s.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(s.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(s.roughnessMap=r(t.roughnessMap)),t.metalnessMap!==void 0&&(s.metalnessMap=r(t.metalnessMap)),t.emissiveMap!==void 0&&(s.emissiveMap=r(t.emissiveMap)),t.emissiveIntensity!==void 0&&(s.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(s.specularMap=r(t.specularMap)),t.envMap!==void 0&&(s.envMap=r(t.envMap)),t.envMapIntensity!==void 0&&(s.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(s.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(s.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(s.lightMap=r(t.lightMap)),t.lightMapIntensity!==void 0&&(s.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(s.aoMap=r(t.aoMap)),t.aoMapIntensity!==void 0&&(s.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(s.gradientMap=r(t.gradientMap)),t.clearcoatMap!==void 0&&(s.clearcoatMap=r(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(s.clearcoatRoughnessMap=r(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(s.clearcoatNormalMap=r(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(s.clearcoatNormalScale=new vt().fromArray(t.clearcoatNormalScale)),s},setTextures:function(t){return this.textures=t,this}});var ic={decodeText:function(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);for(var r="",i=0,s=t.length;i<s;i++)r+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(r))}catch(f){return r}},extractUrlBase:function(t){var r=t.lastIndexOf("/");return r===-1?"./":t.substr(0,r+1)}};Hp.prototype=ut(at(We.prototype),{constructor:Hp,isInstancedBufferGeometry:!0,copy:function(t){return We.prototype.copy.call(this,t),this.instanceCount=t.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var t=We.prototype.toJSON.call(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}),Jg.prototype=ut(at(He.prototype),{constructor:Jg,isInstancedBufferAttribute:!0,copy:function(t){return He.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this},toJSON:function(){var t=He.prototype.toJSON.call(this);return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}),Dl.prototype=ut(at(Qr.prototype),{constructor:Dl,load:function(t,r,i,s){var f=this,c=new Wo(f.manager);c.setPath(f.path),c.load(t,function(g){try{r(f.parse(JSON.parse(g)))}catch(p){s?s(p):console.error(p),f.manager.itemError(t)}},i,s)},parse:function(t){var r=t.isInstancedBufferGeometry?new Hp:new We,i=t.data.index;if(i!==void 0){var s=new XA[i.type](i.array);r.setIndex(new He(s,1))}i=t.data.attributes;for(var f in i){var c=i[f];s=new XA[c.type](c.array),s=new(c.isInstancedBufferAttribute?Jg:He)(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),r.setAttribute(f,s)}var g=t.data.morphAttributes;if(g)for(f in g){var p=g[f],A=[];i=0;for(var S=p.length;i<S;i++)c=p[i],s=new XA[c.type](c.array),s=new He(s,c.itemSize,c.normalized),c.name!==void 0&&(s.name=c.name),A.push(s);r.morphAttributes[f]=A}if(t.data.morphTargetsRelative&&(r.morphTargetsRelative=!0),f=t.data.groups||t.data.drawcalls||t.data.offsets,f!==void 0)for(i=0,c=f.length;i!==c;++i)s=f[i],r.addGroup(s.start,s.count,s.materialIndex);return i=t.data.boundingSphere,i!==void 0&&(f=new ot,i.center!==void 0&&f.fromArray(i.center),r.boundingSphere=new Bi(f,i.radius)),t.name&&(r.name=t.name),t.userData&&(r.userData=t.userData),r}});var XA={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};ps.prototype=ut(at(Qr.prototype),{constructor:ps,load:function(t,r,i,s){var f=this,c=this.path===""?ic.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||c,c=new Wo(f.manager),c.setPath(this.path),c.load(t,function(g){var p=null;try{p=JSON.parse(g)}catch(A){s!==void 0&&s(A),console.error("THREE:ObjectLoader: Can't parse "+t+".",A.message);return}g=p.metadata,g===void 0||g.type===void 0||g.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+t):f.parse(p,r)},i,s)},parse:function(t,r){var i=this.parseShape(t.shapes);i=this.parseGeometries(t.geometries,i);var s=this.parseImages(t.images,function(){r!==void 0&&r(f)});s=this.parseTextures(t.textures,s),s=this.parseMaterials(t.materials,s);var f=this.parseObject(t.object,i,s);return t.animations&&(f.animations=this.parseAnimations(t.animations)),t.images!==void 0&&t.images.length!==0||r===void 0||r(f),f},parseShape:function(t){var r={};if(t!==void 0)for(var i=0,s=t.length;i<s;i++){var f=new Ru().fromJSON(t[i]);r[f.uuid]=f}return r},parseGeometries:function(t,r){var i={};if(t!==void 0)for(var s=new Dl,f=0,c=t.length;f<c;f++){var g=t[f];switch(g.type){case"PlaneGeometry":case"PlaneBufferGeometry":var p=new gs[g.type](g.width,g.height,g.widthSegments,g.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":p=new gs[g.type](g.width,g.height,g.depth,g.widthSegments,g.heightSegments,g.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":p=new gs[g.type](g.radius,g.segments,g.thetaStart,g.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":p=new gs[g.type](g.radiusTop,g.radiusBottom,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":p=new gs[g.type](g.radius,g.height,g.radialSegments,g.heightSegments,g.openEnded,g.thetaStart,g.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":p=new gs[g.type](g.radius,g.widthSegments,g.heightSegments,g.phiStart,g.phiLength,g.thetaStart,g.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":p=new gs[g.type](g.radius,g.detail);break;case"RingGeometry":case"RingBufferGeometry":p=new gs[g.type](g.innerRadius,g.outerRadius,g.thetaSegments,g.phiSegments,g.thetaStart,g.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":p=new gs[g.type](g.radius,g.tube,g.radialSegments,g.tubularSegments,g.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":p=new gs[g.type](g.radius,g.tube,g.tubularSegments,g.radialSegments,g.p,g.q);break;case"TubeGeometry":case"TubeBufferGeometry":p=new gs[g.type](new jA[g.path.type]().fromJSON(g.path),g.tubularSegments,g.radius,g.radialSegments,g.closed);break;case"LatheGeometry":case"LatheBufferGeometry":p=new gs[g.type](g.points,g.segments,g.phiStart,g.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":p=new gs[g.type](g.vertices,g.indices,g.radius,g.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":p=[];for(var A=0,S=g.shapes.length;A<S;A++){var N=r[g.shapes[A]];p.push(N)}p=new gs[g.type](p,g.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(p=[],A=0,S=g.shapes.length;A<S;A++)N=r[g.shapes[A]],p.push(N);A=g.options.extrudePath,A!==void 0&&(g.options.extrudePath=new jA[A.type]().fromJSON(A)),p=new gs[g.type](p,g.options);break;case"BufferGeometry":case"InstancedBufferGeometry":p=s.parse(g);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+g.type+'"');continue}p.uuid=g.uuid,g.name!==void 0&&(p.name=g.name),p.isBufferGeometry===!0&&g.userData!==void 0&&(p.userData=g.userData),i[g.uuid]=p}return i},parseMaterials:function(t,r){var i={},s={};if(t!==void 0){var f=new Up;f.setTextures(r),r=0;for(var c=t.length;r<c;r++){var g=t[r];if(g.type==="MultiMaterial"){for(var p=[],A=0;A<g.materials.length;A++){var S=g.materials[A];i[S.uuid]===void 0&&(i[S.uuid]=f.parse(S)),p.push(i[S.uuid])}s[g.uuid]=p}else i[g.uuid]===void 0&&(i[g.uuid]=f.parse(g)),s[g.uuid]=i[g.uuid]}}return s},parseAnimations:function(t){for(var r=[],i=0;i<t.length;i++){var s=t[i],f=Is.parse(s);s.uuid!==void 0&&(f.uuid=s.uuid),r.push(f)}return r},parseImages:function(t,r){function i(I){return s.manager.itemStart(I),c.load(I,function(){s.manager.itemEnd(I)},void 0,function(){s.manager.itemError(I),s.manager.itemEnd(I)})}var s=this,f={};if(t!==void 0&&0<t.length){r=new Pl(r);var c=new Ph(r);c.setCrossOrigin(this.crossOrigin),r=0;for(var g=t.length;r<g;r++){var p=t[r],A=p.url;if(Array.isArray(A)){f[p.uuid]=[];for(var S=0,N=A.length;S<N;S++){var w=A[S];w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(w)?w:s.resourcePath+w,f[p.uuid].push(i(w))}}else w=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(p.url)?p.url:s.resourcePath+p.url,f[p.uuid]=i(w)}}return f},parseTextures:function(t,r){function i(A,S){return typeof A=="number"?A:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",A),S[A])}var s={};if(t!==void 0)for(var f=0,c=t.length;f<c;f++){var g=t[f];g.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',g.uuid),r[g.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",g.image);var p=Array.isArray(r[g.image])?new Fa(r[g.image]):new Lt(r[g.image]);p.needsUpdate=!0,p.uuid=g.uuid,g.name!==void 0&&(p.name=g.name),g.mapping!==void 0&&(p.mapping=i(g.mapping,dC)),g.offset!==void 0&&p.offset.fromArray(g.offset),g.repeat!==void 0&&p.repeat.fromArray(g.repeat),g.center!==void 0&&p.center.fromArray(g.center),g.rotation!==void 0&&(p.rotation=g.rotation),g.wrap!==void 0&&(p.wrapS=i(g.wrap[0],X_),p.wrapT=i(g.wrap[1],X_)),g.format!==void 0&&(p.format=g.format),g.type!==void 0&&(p.type=g.type),g.encoding!==void 0&&(p.encoding=g.encoding),g.minFilter!==void 0&&(p.minFilter=i(g.minFilter,Y_)),g.magFilter!==void 0&&(p.magFilter=i(g.magFilter,Y_)),g.anisotropy!==void 0&&(p.anisotropy=g.anisotropy),g.flipY!==void 0&&(p.flipY=g.flipY),g.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=g.premultiplyAlpha),g.unpackAlignment!==void 0&&(p.unpackAlignment=g.unpackAlignment),s[g.uuid]=p}return s},parseObject:function(t,r,i){function s(S){return r[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",S),r[S]}function f(S){if(S!==void 0){if(Array.isArray(S)){for(var N=[],w=0,I=S.length;w<I;w++){var L=S[w];i[L]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",L),N.push(i[L])}return N}return i[S]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",S),i[S]}}switch(t.type){case"Scene":var c=new Yr;t.background!==void 0&&Jh(t.background)&&(c.background=new Vt(t.background)),t.fog!==void 0&&(t.fog.type==="Fog"?c.fog=new ko(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(c.fog=new fa(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":c=new un(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(c.focus=t.focus),t.zoom!==void 0&&(c.zoom=t.zoom),t.filmGauge!==void 0&&(c.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(c.filmOffset=t.filmOffset),t.view!==void 0&&(c.view=ut({},t.view));break;case"OrthographicCamera":c=new js(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(c.zoom=t.zoom),t.view!==void 0&&(c.view=ut({},t.view));break;case"AmbientLight":c=new Xg(t.color,t.intensity);break;case"DirectionalLight":c=new Jr(t.color,t.intensity);break;case"PointLight":c=new Pu(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":c=new Yg(t.color,t.intensity,t.width,t.height);break;case"SpotLight":c=new ef(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":c=new Np(t.color,t.groundColor,t.intensity);break;case"LightProbe":c=new Rs().fromJSON(t);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":c=s(t.geometry);var g=f(t.material);c=new Wi(c,g);break;case"InstancedMesh":c=s(t.geometry),g=f(t.material);var p=t.instanceMatrix;c=new Er(c,g,t.count),c.instanceMatrix=new He(new Float32Array(p.array),16);break;case"LOD":c=new yo;break;case"Line":c=new as(s(t.geometry),f(t.material),t.mode);break;case"LineLoop":c=new dn(s(t.geometry),f(t.material));break;case"LineSegments":c=new pn(s(t.geometry),f(t.material));break;case"PointCloud":case"Points":c=new Ba(s(t.geometry),f(t.material));break;case"Sprite":c=new xl(f(t.material));break;case"Group":c=new Ho;break;default:c=new Ee}if(c.uuid=t.uuid,t.name!==void 0&&(c.name=t.name),t.matrix!==void 0?(c.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=t.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(t.position!==void 0&&c.position.fromArray(t.position),t.rotation!==void 0&&c.rotation.fromArray(t.rotation),t.quaternion!==void 0&&c.quaternion.fromArray(t.quaternion),t.scale!==void 0&&c.scale.fromArray(t.scale)),t.castShadow!==void 0&&(c.castShadow=t.castShadow),t.receiveShadow!==void 0&&(c.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(c.shadow.bias=t.shadow.bias),t.shadow.radius!==void 0&&(c.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(c.visible=t.visible),t.frustumCulled!==void 0&&(c.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(c.renderOrder=t.renderOrder),t.userData!==void 0&&(c.userData=t.userData),t.layers!==void 0&&(c.layers.mask=t.layers),t.children!==void 0)for(p=t.children,g=0;g<p.length;g++)c.add(this.parseObject(p[g],r,i));if(t.type==="LOD")for(t.autoUpdate!==void 0&&(c.autoUpdate=t.autoUpdate),t=t.levels,p=0;p<t.length;p++){g=t[p];var A=c.getObjectByProperty("uuid",g.object);A!==void 0&&c.addLevel(A,g.distance)}return c}});var dC={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},X_={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},Y_={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};F0.prototype=ut(at(Qr.prototype),{constructor:F0,setOptions:function(t){return this.options=t,this},load:function(t,r,i,s){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);var f=this,c=Fd.get(t);if(c!==void 0)return f.manager.itemStart(t),setTimeout(function(){r&&r(c),f.manager.itemEnd(t)},0),c;fetch(t).then(function(g){return g.blob()}).then(function(g){return f.options===void 0?createImageBitmap(g):createImageBitmap(g,f.options)}).then(function(g){Fd.add(t,g),r&&r(g),f.manager.itemEnd(t)}).catch(function(g){s&&s(g),f.manager.itemError(t),f.manager.itemEnd(t)}),f.manager.itemStart(t)}}),ut(B0.prototype,{moveTo:function(t,r){return this.currentPath=new yi,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,r),this},lineTo:function(t,r){return this.currentPath.lineTo(t,r),this},quadraticCurveTo:function(t,r,i,s){return this.currentPath.quadraticCurveTo(t,r,i,s),this},bezierCurveTo:function(t,r,i,s,f,c){return this.currentPath.bezierCurveTo(t,r,i,s,f,c),this},splineThru:function(t){return this.currentPath.splineThru(t),this},toShapes:function(t,r){function i(W){for(var X=[],Z=0,tt=W.length;Z<tt;Z++){var st=W[Z],xt=new Ru;xt.curves=st.curves,X.push(xt)}return X}function s(W,X){for(var Z=X.length,tt=!1,st=Z-1,xt=0;xt<Z;st=xt++){var At=X[st],yt=X[xt],Ut=yt.x-At.x,kt=yt.y-At.y;if(Math.abs(kt)>hn){if(0>kt&&(At=X[xt],Ut=-Ut,yt=X[st],kt=-kt),!(W.y<At.y||W.y>yt.y))if(W.y===At.y){if(W.x===At.x)return!0}else{if(st=kt*(W.x-At.x)-Ut*(W.y-At.y),st===0)return!0;0>st||(tt=!tt)}}else if(W.y===At.y&&(yt.x<=W.x&&W.x<=At.x||At.x<=W.x&&W.x<=yt.x))return!0}return tt}var f=rc.isClockWise,c=this.subPaths;if(c.length===0)return[];if(r===!0)return i(c);if(r=[],c.length===1){var g=c[0],p=new Ru;return p.curves=g.curves,r.push(p),r}var A=!f(c[0].getPoints());A=t?!A:A,p=[];var S=[],N=[],w=0;S[w]=void 0,N[w]=[];for(var I=0,L=c.length;I<L;I++){g=c[I];var P=g.getPoints(),F=f(P);(F=t?!F:F)?(!A&&S[w]&&w++,S[w]={s:new Ru,p:P},S[w].s.curves=g.curves,A&&w++,N[w]=[]):N[w].push({h:g,p:P[0]})}if(!S[0])return i(c);if(1<S.length){for(I=!1,t=[],f=0,c=S.length;f<c;f++)p[f]=[];for(f=0,c=S.length;f<c;f++)for(g=N[f],F=0;F<g.length;F++){for(A=g[F],w=!0,P=0;P<S.length;P++)s(A.p,S[P].p)&&(f!==P&&t.push({froms:f,tos:P,hole:F}),w?(w=!1,p[P].push(A)):I=!0);w&&p[f].push(A)}0<t.length&&(I||(N=p))}for(I=0,f=S.length;I<f;I++)for(p=S[I].s,r.push(p),t=N[I],c=0,g=t.length;c<g;c++)p.holes.push(t[c].h);return r}}),ut(N0.prototype,{isFont:!0,generateShapes:function(t,r){r===void 0&&(r=100);var i=[],s=r;r=this.data;var f=ff?ff(t):String(t).split("");s/=r.resolution;var c=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*s;t=[];for(var g=0,p=0,A=0;A<f.length;A++){var S=f[A];if(S===`
`)g=0,p-=c;else{var N=S;S=s;var w=g,I=p,L=r,P=L.glyphs[N]||L.glyphs["?"];if(P){if(N=new B0,P.o){L=P._cachedOutline||(P._cachedOutline=P.o.split(" "));for(var F=0,W=L.length;F<W;)switch(L[F++]){case"m":var X=L[F++]*S+w,Z=L[F++]*S+I;N.moveTo(X,Z);break;case"l":X=L[F++]*S+w,Z=L[F++]*S+I,N.lineTo(X,Z);break;case"q":var tt=L[F++]*S+w,st=L[F++]*S+I,xt=L[F++]*S+w,At=L[F++]*S+I;N.quadraticCurveTo(xt,At,tt,st);break;case"b":tt=L[F++]*S+w,st=L[F++]*S+I,xt=L[F++]*S+w,At=L[F++]*S+I,X=L[F++]*S+w,Z=L[F++]*S+I,N.bezierCurveTo(xt,At,X,Z,tt,st)}}S={offsetX:P.ha*S,path:N}}else console.error('THREE.Font: character "'+N+'" does not exists in font family '+L.familyName+"."),S=void 0;g+=S.offsetX,t.push(S.path)}}for(r=0,f=t.length;r<f;r++)Array.prototype.push.apply(i,t[r].toShapes());return i}}),Dh.prototype=ut(at(Qr.prototype),{constructor:Dh,load:function(t,r,i,s){var f=this,c=new Wo(this.manager);c.setPath(this.path),c.load(t,function(g){try{var p=JSON.parse(g)}catch(A){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),p=JSON.parse(g.substring(65,g.length-2))}g=f.parse(p),r&&r(g)},i,s)},parse:function(t){return new N0(t)}});var Q1,Z_={getContext:function(){return Q1===void 0&&(Q1=new(window.AudioContext||window.webkitAudioContext)),Q1},setContext:function(t){Q1=t}};vn.prototype=ut(at(Qr.prototype),{constructor:vn,load:function(t,r,i,s){var f=this,c=new Wo(f.manager);c.setResponseType("arraybuffer"),c.setPath(f.path),c.load(t,function(g){try{var p=g.slice(0);Z_.getContext().decodeAudioData(p,function(A){r(A)})}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)}}),Oh.prototype=ut(at(Rs.prototype),{constructor:Oh,isHemisphereLightProbe:!0,copy:function(t){return Rs.prototype.copy.call(this,t),this},toJSON:function(t){return Rs.prototype.toJSON.call(this,t)}}),Fh.prototype=ut(at(Rs.prototype),{constructor:Fh,isAmbientLightProbe:!0,copy:function(t){return Rs.prototype.copy.call(this,t),this},toJSON:function(t){return Rs.prototype.toJSON.call(this,t)}});var J_=new Ie,q_=new Ie;ut(function(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new un,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new un,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}.prototype,{update:function(t){var r=this._cache;if(r.focus!==t.focus||r.fov!==t.fov||r.aspect!==t.aspect*this.aspect||r.near!==t.near||r.far!==t.far||r.zoom!==t.zoom||r.eyeSep!==this.eyeSep){r.focus=t.focus,r.fov=t.fov,r.aspect=t.aspect*this.aspect,r.near=t.near,r.far=t.far,r.zoom=t.zoom,r.eyeSep=this.eyeSep;var i=t.projectionMatrix.clone(),s=r.eyeSep/2,f=s*r.near/r.focus,c=r.near*Math.tan(Tr.DEG2RAD*r.fov*.5)/r.zoom;q_.elements[12]=-s,J_.elements[12]=s,s=-c*r.aspect+f;var g=c*r.aspect+f;i.elements[0]=2*r.near/(g-s),i.elements[8]=(g+s)/(g-s),this.cameraL.projectionMatrix.copy(i),s=-c*r.aspect-f,g=c*r.aspect-f,i.elements[0]=2*r.near/(g-s),i.elements[8]=(g+s)/(g-s),this.cameraR.projectionMatrix.copy(i)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(q_),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(J_)}}),ut(Ha.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var r=(typeof performance=="undefined"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}});var Df=new ot,K_=new jt,gC=new ot,Of=new ot;z0.prototype=ut(at(Ee.prototype),{constructor:z0,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this},updateMatrixWorld:function(t){Ee.prototype.updateMatrixWorld.call(this,t),t=this.context.listener;var r=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Df,K_,gC),Of.set(0,0,-1).applyQuaternion(K_),t.positionX){var i=this.context.currentTime+this.timeDelta;t.positionX.linearRampToValueAtTime(Df.x,i),t.positionY.linearRampToValueAtTime(Df.y,i),t.positionZ.linearRampToValueAtTime(Df.z,i),t.forwardX.linearRampToValueAtTime(Of.x,i),t.forwardY.linearRampToValueAtTime(Of.y,i),t.forwardZ.linearRampToValueAtTime(Of.z,i),t.upX.linearRampToValueAtTime(r.x,i),t.upY.linearRampToValueAtTime(r.y,i),t.upZ.linearRampToValueAtTime(r.z,i)}else t.setPosition(Df.x,Df.y,Df.z),t.setOrientation(Of.x,Of.y,Of.z,r.x,r.y,r.z)}}),ma.prototype=ut(at(Ee.prototype),{constructor:ma,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setMediaElementSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this},setMediaStreamSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(t){if(t===void 0&&(t=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+t,t=this.context.createBufferSource(),t.buffer=this.buffer,t.loop=this.loop,t.loopStart=this.loopStart,t.loopEnd=this.loopEnd,t.onended=this.onEnded.bind(this),t.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=t,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var t=1,r=this.filters.length;t<r;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),this.isPlaying===!0?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},setDetune:function(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(t){return this.loopStart=t,this},setLoopEnd:function(t){return this.loopEnd=t,this},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}});var Ff=new ot,Q_=new jt,mC=new ot,Bf=new ot;jo.prototype=ut(at(ma.prototype),{constructor:jo,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){return this.panner.refDistance=t,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){return this.panner.rolloffFactor=t,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){return this.panner.distanceModel=t,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){return this.panner.maxDistance=t,this},setDirectionalCone:function(t,r,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=r,this.panner.coneOuterGain=i,this},updateMatrixWorld:function(t){if(Ee.prototype.updateMatrixWorld.call(this,t),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(Ff,Q_,mC),Bf.set(0,0,1).applyQuaternion(Q_),t=this.panner,t.positionX){var r=this.context.currentTime+this.listener.timeDelta;t.positionX.linearRampToValueAtTime(Ff.x,r),t.positionY.linearRampToValueAtTime(Ff.y,r),t.positionZ.linearRampToValueAtTime(Ff.z,r),t.orientationX.linearRampToValueAtTime(Bf.x,r),t.orientationY.linearRampToValueAtTime(Bf.y,r),t.orientationZ.linearRampToValueAtTime(Bf.z,r)}else t.setPosition(Ff.x,Ff.y,Ff.z),t.setOrientation(Bf.x,Bf.y,Bf.z)}}),ut(kp.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,r=this.getFrequencyData(),i=0;i<r.length;i++)t+=r[i];return t/r.length}}),ut(qg.prototype,{accumulate:function(t,r){var i=this.buffer,s=this.valueSize;t=t*s+s;var f=this.cumulativeWeight;if(f===0){for(f=0;f!==s;++f)i[t+f]=i[f];f=r}else f+=r,this._mixBufferRegion(i,t,0,r/f,s);this.cumulativeWeight=f},accumulateAdditive:function(t){var r=this.buffer,i=this.valueSize,s=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(r,s,0,t,i),this.cumulativeWeightAdditive+=t},apply:function(t){var r=this.valueSize,i=this.buffer;t=t*r+r;var s=this.cumulativeWeight,f=this.cumulativeWeightAdditive,c=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>s&&this._mixBufferRegion(i,t,r*this._origIndex,1-s,r),0<f&&this._mixBufferRegionAdditive(i,t,this._addIndex*r,1,r),s=r,f=r+r;s!==f;++s)if(i[s]!==i[s+r]){c.setValue(i,t);break}},saveOriginalState:function(){var t=this.buffer,r=this.valueSize,i=r*this._origIndex;this.binding.getValue(t,i);for(var s=r;s!==i;++s)t[s]=t[i+s%r];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var t=this._addIndex*this.valueSize,r=t+this.valueSize;t<r;t++)this.buffer[t]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var t=this._origIndex*this.valueSize,r=this._addIndex*this.valueSize,i=0;i<this.valueSize;i++)this.buffer[r+i]=this.buffer[t+i]},_select:function(t,r,i,s,f){if(.5<=s)for(s=0;s!==f;++s)t[r+s]=t[i+s]},_slerp:function(t,r,i,s){jt.slerpFlat(t,r,t,r,t,i,s)},_slerpAdditive:function(t,r,i,s,f){f*=this._workIndex,jt.multiplyQuaternionsFlat(t,f,t,r,t,i),jt.slerpFlat(t,r,t,r,t,f,s)},_lerp:function(t,r,i,s,f){for(var c=1-s,g=0;g!==f;++g){var p=r+g;t[p]=t[p]*c+t[i+g]*s}},_lerpAdditive:function(t,r,i,s,f){for(var c=0;c!==f;++c){var g=r+c;t[g]+=t[i+c]*s}}});var vC=/[\[\]\.:\/]/g,yC="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",xC=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),AC=/(WCOD+)?/.source.replace("WCOD",yC),_C=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),wC=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),MC=new RegExp("^"+xC+AC+_C+wC+"$"),CC=["material","materials","bones"];ut(Gp.prototype,{getValue:function(t,r){this.bind();var i=this._bindings[this._targetGroup.nCachedObjects_];i!==void 0&&i.getValue(t,r)},setValue:function(t,r){for(var i=this._bindings,s=this._targetGroup.nCachedObjects_,f=i.length;s!==f;++s)i[s].setValue(t,r)},bind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].bind()},unbind:function(){for(var t=this._bindings,r=this._targetGroup.nCachedObjects_,i=t.length;r!==i;++r)t[r].unbind()}}),ut(Wn,{Composite:Gp,create:function(t,r,i){return t&&t.isAnimationObjectGroup?new Wn.Composite(t,r,i):new Wn(t,r,i)},sanitizeNodeName:function(t){return t.replace(/\s/g,"_").replace(vC,"")},parseTrackName:function(t){var r=MC.exec(t);if(!r)throw Error("PropertyBinding: Cannot parse trackName: "+t);r={nodeName:r[2],objectName:r[3],objectIndex:r[4],propertyName:r[5],propertyIndex:r[6]};var i=r.nodeName&&r.nodeName.lastIndexOf(".");if(i!==void 0&&i!==-1){var s=r.nodeName.substring(i+1);CC.indexOf(s)!==-1&&(r.nodeName=r.nodeName.substring(0,i),r.objectName=s)}if(r.propertyName===null||r.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+t);return r},findNode:function(t,r){if(!r||r===""||r==="."||r===-1||r===t.name||r===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(r);if(i!==void 0)return i}return t.children&&(t=function s(f){for(var c=0;c<f.length;c++){var g=f[c];if(g.name===r||g.uuid===r||(g=s(g.children)))return g}return null}(t.children))?t:null}}),ut(Wn.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,r){t[r]=this.node[this.propertyName]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)t[r++]=i[s]},function(t,r){t[r]=this.resolvedProperty[this.propertyIndex]},function(t,r){this.resolvedProperty.toArray(t,r)}],SetterByBindingTypeAndVersioning:[[function(t,r){this.targetObject[this.propertyName]=t[r]},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.targetObject[this.propertyName]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++]},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.needsUpdate=!0},function(t,r){for(var i=this.resolvedProperty,s=0,f=i.length;s!==f;++s)i[s]=t[r++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty[this.propertyIndex]=t[r]},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty[this.propertyIndex]=t[r],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,r){this.resolvedProperty.fromArray(t,r)},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.needsUpdate=!0},function(t,r){this.resolvedProperty.fromArray(t,r),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,r){this.bind(),this.getValue(t,r)},setValue:function(t,r){this.bind(),this.setValue(t,r)},bind:function(){var t=this.node,r=this.parsedPath,i=r.objectName,s=r.propertyName,f=r.propertyIndex;if(t||(this.node=t=Wn.findNode(this.rootNode,r.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var c=r.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(t=t.skeleton.bones,i=0;i<t.length;i++)if(t[i].name===c){c=i;break}break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(c!==void 0){if(t[c]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[c]}}if(c=t[s],c===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+s+" but it wasn't found.",t);else{if(r=this.Versioning.None,this.targetObject=t,t.needsUpdate!==void 0?r=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(r=this.Versioning.MatrixWorldNeedsUpdate),i=this.BindingType.Direct,f!==void 0){if(s==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[f]!==void 0&&(f=t.morphTargetDictionary[f])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}i=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=f}else c.fromArray!==void 0&&c.toArray!==void 0?(i=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(i=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=s;this.getValue=this.GetterByBindingType[i],this.setValue=this.SetterByBindingTypeAndVersioning[i][r]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),ut(Wn.prototype,{_getValue_unbound:Wn.prototype.getValue,_setValue_unbound:Wn.prototype.setValue}),ut(function(){this.uuid=Tr.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var r=0,i=arguments.length;r!==i;++r)t[arguments[r].uuid]=r;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var s=this;this.stats={objects:{get total(){return s._objects.length},get inUse(){return this.total-s.nCachedObjects_}},get bindingsPerObject(){return s._bindings.length}}}.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._paths,c=this._parsedPaths,g=this._bindings,p=g.length,A=void 0,S=0,N=arguments.length;S!==N;++S){var w=arguments[S],I=w.uuid,L=s[I];if(L===void 0){L=r++,s[I]=L,t.push(w),I=0;for(var P=p;I!==P;++I)g[I].push(new Wn(w,f[I],c[I]))}else if(L<i){A=t[L];var F=--i;for(P=t[F],s[P.uuid]=L,t[L]=P,s[I]=F,t[F]=w,I=0,P=p;I!==P;++I){var W=g[I],X=W[L];W[L]=W[F],X===void 0&&(X=new Wn(w,f[I],c[I])),W[F]=X}}else t[L]!==A&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,r=this.nCachedObjects_,i=this._indicesByUUID,s=this._bindings,f=s.length,c=0,g=arguments.length;c!==g;++c){var p=arguments[c],A=p.uuid,S=i[A];if(S!==void 0&&S>=r){var N=r++,w=t[N];for(i[w.uuid]=S,t[S]=w,i[A]=N,t[N]=p,p=0,A=f;p!==A;++p){w=s[p];var I=w[S];w[S]=w[N],w[N]=I}}}this.nCachedObjects_=r},uncache:function(){for(var t=this._objects,r=t.length,i=this.nCachedObjects_,s=this._indicesByUUID,f=this._bindings,c=f.length,g=0,p=arguments.length;g!==p;++g){var A=arguments[g].uuid,S=s[A];if(S!==void 0)if(delete s[A],S<i){A=--i;var N=t[A],w=--r,I=t[w];for(s[N.uuid]=S,t[S]=N,s[I.uuid]=A,t[A]=I,t.pop(),N=0,I=c;N!==I;++N){var L=f[N],P=L[w];L[S]=L[A],L[A]=P,L.pop()}}else for(w=--r,I=t[w],s[I.uuid]=S,t[S]=I,t.pop(),N=0,I=c;N!==I;++N)L=f[N],L[S]=L[w],L.pop()}this.nCachedObjects_=i},subscribe_:function(t,r){var i=this._bindingsIndicesByPath,s=i[t],f=this._bindings;if(s!==void 0)return f[s];var c=this._paths,g=this._parsedPaths,p=this._objects,A=this.nCachedObjects_,S=Array(p.length);for(s=f.length,i[t]=s,c.push(t),g.push(r),f.push(S),i=A,s=p.length;i!==s;++i)S[i]=new Wn(p[i],t,r);return S},unsubscribe_:function(t){var r=this._bindingsIndicesByPath,i=r[t];if(i!==void 0){var s=this._paths,f=this._parsedPaths,c=this._bindings,g=c.length-1,p=c[g];r[t[g]]=i,c[i]=p,c.pop(),f[i]=f[g],f.pop(),s[i]=s[g],s.pop()}}}),ut(U0.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,r){return this.loop=t,this.repetitions=r,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,r,i){if(t.fadeOut(r),this.fadeIn(r),i){i=this._clip.duration;var s=t._clip.duration,f=i/s;t.warp(1,s/i,r),this.warp(f,1,r)}return this},crossFadeTo:function(t,r,i){return t.crossFadeFrom(this,r,i)},stopFading:function(){var t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,r,i){var s=this._mixer,f=s.time,c=this._timeScaleInterpolant,g=this.timeScale;return c===null&&(this._timeScaleInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,s[1]=f+i,c[0]=t/g,c[1]=r/g,this},stopWarping:function(){var t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,r,i,s){if(this.enabled){var f=this._startTime;if(f!==null){if(r=(t-f)*i,0>r||i===0)return;this._startTime=null,r*=i}if(r*=this._updateTimeScale(t),i=this._updateTime(r),t=this._updateWeight(t),0<t)switch(r=this._interpolants,f=this._propertyBindings,this.blendMode){case 2501:for(var c=0,g=r.length;c!==g;++c)r[c].evaluate(i),f[c].accumulateAdditive(t);break;default:for(c=0,g=r.length;c!==g;++c)r[c].evaluate(i),f[c].accumulate(s,t)}}else this._updateWeight(t)},_updateWeight:function(t){var r=0;if(this.enabled){r=this.weight;var i=this._weightInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopFading(),s===0&&(this.enabled=!1))}}return this._effectiveWeight=r},_updateTimeScale:function(t){var r=0;if(!this.paused){r=this.timeScale;var i=this._timeScaleInterpolant;if(i!==null){var s=i.evaluate(t)[0];r*=s,t>i.parameterPositions[1]&&(this.stopWarping(),r===0?this.paused=!0:this.timeScale=r)}}return this._effectiveTimeScale=r},_updateTime:function(t){var r=this.time+t,i=this._clip.duration,s=this.loop,f=this._loopCount,c=s===2202;if(t===0)return f===-1?r:c&&(f&1)===1?i-r:r;if(s===2200)t:{if(f===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),r>=i)r=i;else if(0>r)r=0;else{this.time=r;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>t?-1:1})}else{if(f===-1&&(0<=t?(f=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),r>=i||0>r){s=Math.floor(r/i),r-=i*s,f+=Math.abs(s);var g=this.repetitions-f;0>=g?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=r=0<t?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<t?1:-1})):(g===1?(t=0>t,this._setEndings(t,!t,c)):this._setEndings(!1,!1,c),this._loopCount=f,this.time=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:s}))}else this.time=r;if(c&&(f&1)===1)return i-r}return r},_setEndings:function(t,r,i){var s=this._interpolantSettings;i?(s.endingStart=2401,s.endingEnd=2401):(s.endingStart=t?this.zeroSlopeAtStart?2401:2400:2402,s.endingEnd=r?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(t,r,i){var s=this._mixer,f=s.time,c=this._weightInterpolant;return c===null&&(this._weightInterpolant=c=s._lendControlInterpolant()),s=c.parameterPositions,c=c.sampleValues,s[0]=f,c[0]=r,s[1]=f+t,c[1]=i,this}}),bp.prototype=ut(at(se.prototype),{constructor:bp,_bindAction:function(t,r){var i=t._localRoot||this._root,s=t._clip.tracks,f=s.length,c=t._propertyBindings;t=t._interpolants;var g=i.uuid,p=this._bindingsByRootAndName,A=p[g];for(A===void 0&&(A={},p[g]=A),p=0;p!==f;++p){var S=s[p],N=S.name,w=A[N];if(w===void 0){if(w=c[p],w!==void 0){w._cacheIndex===null&&(++w.referenceCount,this._addInactiveBinding(w,g,N));continue}w=new qg(Wn.create(i,N,r&&r._propertyBindings[p].binding.parsedPath),S.ValueTypeName,S.getValueSize()),++w.referenceCount,this._addInactiveBinding(w,g,N)}c[p]=w,t[p].resultBuffer=w.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){var r=(t._localRoot||this._root).uuid,i=t._clip.uuid,s=this._actionsByClip[i];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,i,r)}for(r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];f.useCount++===0&&(this._lendBinding(f),f.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var r=t._propertyBindings,i=0,s=r.length;i!==s;++i){var f=r[i];--f.useCount===0&&(f.restoreOriginalState(),this._takeBackBinding(f))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){return t=t._cacheIndex,t!==null&&t<this._nActiveActions},_addInactiveAction:function(t,r,i){var s=this._actions,f=this._actionsByClip,c=f[r];c===void 0?(c={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,f[r]=c):(r=c.knownActions,t._byClipCacheIndex=r.length,r.push(t)),t._cacheIndex=s.length,s.push(t),c.actionByRoot[i]=t},_removeInactiveAction:function(t){var r=this._actions,i=r[r.length-1],s=t._cacheIndex;i._cacheIndex=s,r[s]=i,r.pop(),t._cacheIndex=null,r=t._clip.uuid,i=this._actionsByClip,s=i[r];var f=s.knownActions,c=f[f.length-1],g=t._byClipCacheIndex;c._byClipCacheIndex=g,f[g]=c,f.pop(),t._byClipCacheIndex=null,delete s.actionByRoot[(t._localRoot||this._root).uuid],f.length===0&&delete i[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){t=t._propertyBindings;for(var r=0,i=t.length;r!==i;++r){var s=t[r];--s.referenceCount===0&&this._removeInactiveBinding(s)}},_lendAction:function(t){var r=this._actions,i=t._cacheIndex,s=this._nActiveActions++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackAction:function(t){var r=this._actions,i=t._cacheIndex,s=--this._nActiveActions,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_addInactiveBinding:function(t,r,i){var s=this._bindingsByRootAndName,f=s[r],c=this._bindings;f===void 0&&(f={},s[r]=f),f[i]=t,t._cacheIndex=c.length,c.push(t)},_removeInactiveBinding:function(t){var r=this._bindings,i=t.binding,s=i.rootNode.uuid;i=i.path;var f=this._bindingsByRootAndName,c=f[s],g=r[r.length-1];t=t._cacheIndex,g._cacheIndex=t,r[t]=g,r.pop(),delete c[i],Pi(c).length===0&&delete f[s]},_lendBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=this._nActiveBindings++,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_takeBackBinding:function(t){var r=this._bindings,i=t._cacheIndex,s=--this._nActiveBindings,f=r[s];t._cacheIndex=s,r[s]=t,f._cacheIndex=i,r[i]=f},_lendControlInterpolant:function(){var t=this._controlInterpolants,r=this._nActiveControlInterpolants++,i=t[r];return i===void 0&&(i=new El(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),i.__cacheIndex=r,t[r]=i),i},_takeBackControlInterpolant:function(t){var r=this._controlInterpolants,i=t.__cacheIndex,s=--this._nActiveControlInterpolants,f=r[s];t.__cacheIndex=s,r[s]=t,f.__cacheIndex=i,r[i]=f},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,r,i){var s=r||this._root,f=s.uuid;s=typeof t=="string"?Is.findByName(s,t):t,t=s!==null?s.uuid:t;var c=this._actionsByClip[t],g=null;if(i===void 0&&(i=s!==null?s.blendMode:2500),c!==void 0){if(g=c.actionByRoot[f],g!==void 0&&g.blendMode===i)return g;g=c.knownActions[0],s===null&&(s=g._clip)}return s===null?null:(r=new U0(this,s,r,i),this._bindAction(r,g),this._addInactiveAction(r,t,f),r)},existingAction:function(t,r){var i=r||this._root;return r=i.uuid,i=typeof t=="string"?Is.findByName(i,t):t,t=this._actionsByClip[i?i.uuid:t],t!==void 0&&t.actionByRoot[r]||null},stopAllAction:function(){for(var t=this._actions,r=this._nActiveActions-1;0<=r;--r)t[r].stop();return this},update:function(t){t*=this.timeScale;for(var r=this._actions,i=this._nActiveActions,s=this.time+=t,f=Zu(t),c=this._accuIndex^=1,g=0;g!==i;++g)r[g]._update(s,t,f,c);for(t=this._bindings,r=this._nActiveBindings,g=0;g!==r;++g)t[g].apply(c);return this},setTime:function(t){for(var r=this.time=0;r<this._actions.length;r++)this._actions[r].time=0;return this.update(t)},getRoot:function(){return this._root},uncacheClip:function(t){var r=this._actions;t=t.uuid;var i=this._actionsByClip,s=i[t];if(s!==void 0){s=s.knownActions;for(var f=0,c=s.length;f!==c;++f){var g=s[f];this._deactivateAction(g);var p=g._cacheIndex,A=r[r.length-1];g._cacheIndex=null,g._byClipCacheIndex=null,A._cacheIndex=p,r[p]=A,r.pop(),this._removeInactiveBindingsForAction(g)}delete i[t]}},uncacheRoot:function(t){t=t.uuid;var r=this._actionsByClip;for(s in r){var i=r[s].actionByRoot[t];i!==void 0&&(this._deactivateAction(i),this._removeInactiveAction(i))}var s=this._bindingsByRootAndName[t];if(s!==void 0)for(var f in s)t=s[f],t.restoreOriginalState(),this._removeInactiveBinding(t)},uncacheAction:function(t,r){t=this.existingAction(t,r),t!==null&&(this._deactivateAction(t),this._removeInactiveAction(t))}}),ka.prototype.clone=function(){return new ka(this.value.clone===void 0?this.value:this.value.clone())},Vp.prototype=ut(at(Go.prototype),{constructor:Vp,isInstancedInterleavedBuffer:!0,copy:function(t){return Go.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),ut(Bh.prototype,{set:function(t,r){this.ray.set(t,r)},setFromCamera:function(t,r){r&&r.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(r.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(r).sub(this.ray.origin).normalize(),this.camera=r):r&&r.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(r.near+r.far)/(r.near-r.far)).unproject(r),this.ray.direction.set(0,0,-1).transformDirection(r.matrixWorld),this.camera=r):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,r,i){return i=i||[],Ol(t,this,i,r),i.sort(Kg),i},intersectObjects:function(t,r,i){if(i=i||[],Array.isArray(t)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var s=0,f=t.length;s<f;s++)Ol(t[s],this,i,r);return i.sort(Kg),i}}),ut(function(t,r,i){return this.radius=t!==void 0?t:1,this.phi=r!==void 0?r:0,this.theta=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.phi=r,this.theta=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+r*r+i*i),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(t,i),this.phi=Math.acos(Tr.clamp(r/this.radius,-1,1))),this}}),ut(function(t,r,i){return this.radius=t!==void 0?t:1,this.theta=r!==void 0?r:0,this.y=i!==void 0?i:0,this}.prototype,{set:function(t,r,i){return this.radius=t,this.theta=r,this.y=i,this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.setFromCartesianCoords(t.x,t.y,t.z)},setFromCartesianCoords:function(t,r,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=r,this}});var $_=new vt;ut(Qg.prototype,{set:function(t,r){return this.min.copy(t),this.max.copy(r),this},setFromPoints:function(t){this.makeEmpty();for(var r=0,i=t.length;r<i;r++)this.expandByPoint(t[r]);return this},setFromCenterAndSize:function(t,r){return r=$_.copy(r).multiplyScalar(.5),this.min.copy(t).sub(r),this.max.copy(t).add(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return t===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new vt),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return t===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new vt),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),r=new vt),r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,r){return r===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),r=new vt),r.copy(t).clamp(this.min,this.max)},distanceToPoint:function(t){return $_.copy(t).clamp(this.min,this.max).sub(t).length()},intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}});var tw=new ot,$1=new ot;ut(Wp.prototype,{set:function(t,r){return this.start.copy(t),this.end.copy(r),this},clone:function(){return new this.constructor().copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return t===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new ot),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return t===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),t=new ot),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,r){return r===void 0&&(console.warn("THREE.Line3: .at() target is now required"),r=new ot),this.delta(r).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(t,r){return tw.subVectors(t,this.start),$1.subVectors(this.end,this.start),t=$1.dot($1),t=$1.dot(tw)/t,r&&(t=Tr.clamp(t,0,1)),t},closestPointToPoint:function(t,r,i){return t=this.closestPointToPointParameter(t,r),i===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),i=new ot),this.delta(i).multiplyScalar(t).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Fl.prototype=at(Ee.prototype),Fl.prototype.constructor=Fl,Fl.prototype.isImmediateRenderObject=!0;var ew=new ot;rf.prototype=at(Ee.prototype),rf.prototype.constructor=rf,rf.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},rf.prototype.update=function(){this.light.updateMatrixWorld();var t=this.light.distance?this.light.distance:1e3,r=t*Math.tan(this.light.angle);this.cone.scale.set(r,r,t),ew.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ew),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var nc=new ot,ty=new Ie,YA=new Ie;Xo.prototype=at(pn.prototype),Xo.prototype.constructor=Xo,Xo.prototype.isSkeletonHelper=!0,Xo.prototype.updateMatrixWorld=function(t){var r=this.bones,i=this.geometry,s=i.getAttribute("position");YA.getInverse(this.root.matrixWorld);for(var f=0,c=0;f<r.length;f++){var g=r[f];g.parent&&g.parent.isBone&&(ty.multiplyMatrices(YA,g.matrixWorld),nc.setFromMatrixPosition(ty),s.setXYZ(c,nc.x,nc.y,nc.z),ty.multiplyMatrices(YA,g.parent.matrixWorld),nc.setFromMatrixPosition(ty),s.setXYZ(c+1,nc.x,nc.y,nc.z),c+=2)}i.getAttribute("position").needsUpdate=!0,Ee.prototype.updateMatrixWorld.call(this,t)},Ga.prototype=at(Wi.prototype),Ga.prototype.constructor=Ga,Ga.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ga.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var TC=new ot,rw=new Vt,iw=new Vt;Xs.prototype=at(Ee.prototype),Xs.prototype.constructor=Xs,Xs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Xs.prototype.update=function(){var t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var r=t.geometry.getAttribute("color");rw.copy(this.light.color),iw.copy(this.light.groundColor);for(var i=0,s=r.count;i<s;i++){var f=i<s/2?rw:iw;r.setXYZ(i,f.r,f.g,f.b)}r.needsUpdate=!0}t.lookAt(TC.setFromMatrixPosition(this.light.matrixWorld).negate())},Bl.prototype=ut(at(pn.prototype),{constructor:Bl,copy:function(t){return pn.prototype.copy.call(this,t),this.geometry.copy(t.geometry),this.material.copy(t.material),this},clone:function(){return new this.constructor().copy(this)}}),nf.prototype=at(pn.prototype),nf.prototype.constructor=nf;var nw=new ot,ey=new ot,ow=new ot;Du.prototype=at(Ee.prototype),Du.prototype.constructor=Du,Du.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},Du.prototype.update=function(){nw.setFromMatrixPosition(this.light.matrixWorld),ey.setFromMatrixPosition(this.light.target.matrixWorld),ow.subVectors(ey,nw),this.lightPlane.lookAt(ey),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(ey),this.targetLine.scale.z=ow.length()};var ry=new ot,kn=new Da;of.prototype=at(pn.prototype),of.prototype.constructor=of,of.prototype.update=function(){var t=this.geometry,r=this.pointMap;kn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Tn("c",r,t,kn,0,0,-1),Tn("t",r,t,kn,0,0,1),Tn("n1",r,t,kn,-1,-1,-1),Tn("n2",r,t,kn,1,-1,-1),Tn("n3",r,t,kn,-1,1,-1),Tn("n4",r,t,kn,1,1,-1),Tn("f1",r,t,kn,-1,-1,1),Tn("f2",r,t,kn,1,-1,1),Tn("f3",r,t,kn,-1,1,1),Tn("f4",r,t,kn,1,1,1),Tn("u1",r,t,kn,.7,1.1,-1),Tn("u2",r,t,kn,-.7,1.1,-1),Tn("u3",r,t,kn,0,2,-1),Tn("cf1",r,t,kn,-1,0,1),Tn("cf2",r,t,kn,1,0,1),Tn("cf3",r,t,kn,0,-1,1),Tn("cf4",r,t,kn,0,1,1),Tn("cn1",r,t,kn,-1,0,-1),Tn("cn2",r,t,kn,1,0,-1),Tn("cn3",r,t,kn,0,-1,-1),Tn("cn4",r,t,kn,0,1,-1),t.getAttribute("position").needsUpdate=!0};var iy=new li;Ou.prototype=at(pn.prototype),Ou.prototype.constructor=Ou,Ou.prototype.update=function(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&iy.setFromObject(this.object),!iy.isEmpty()){t=iy.min;var r=iy.max,i=this.geometry.attributes.position,s=i.array;s[0]=r.x,s[1]=r.y,s[2]=r.z,s[3]=t.x,s[4]=r.y,s[5]=r.z,s[6]=t.x,s[7]=t.y,s[8]=r.z,s[9]=r.x,s[10]=t.y,s[11]=r.z,s[12]=r.x,s[13]=r.y,s[14]=t.z,s[15]=t.x,s[16]=r.y,s[17]=t.z,s[18]=t.x,s[19]=t.y,s[20]=t.z,s[21]=r.x,s[22]=t.y,s[23]=t.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}},Ou.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Ou.prototype.copy=function(t){return pn.prototype.copy.call(this,t),this.object=t.object,this},Ou.prototype.clone=function(){return new this.constructor().copy(this)},Fu.prototype=at(pn.prototype),Fu.prototype.constructor=Fu,Fu.prototype.updateMatrixWorld=function(t){var r=this.box;r.isEmpty()||(r.getCenter(this.position),r.getSize(this.scale),this.scale.multiplyScalar(.5),Ee.prototype.updateMatrixWorld.call(this,t))},lo.prototype=at(as.prototype),lo.prototype.constructor=lo,lo.prototype.updateMatrixWorld=function(t){var r=-this.plane.constant;1e-8>Math.abs(r)&&(r=1e-8),this.scale.set(.5*this.size,.5*this.size,r),this.children[0].material.side=0>r?1:0,this.lookAt(this.plane.normal),Ee.prototype.updateMatrixWorld.call(this,t)};var sw=new ot,ny,ZA;ho.prototype=at(Ee.prototype),ho.prototype.constructor=ho,ho.prototype.setDirection=function(t){.99999<t.y?this.quaternion.set(0,0,0,1):-.99999>t.y?this.quaternion.set(1,0,0,0):(sw.set(t.z,0,-t.x).normalize(),this.quaternion.setFromAxisAngle(sw,Math.acos(t.y)))},ho.prototype.setLength=function(t,r,i){r===void 0&&(r=.2*t),i===void 0&&(i=.2*r),this.line.scale.set(1,Math.max(1e-4,t-r),1),this.line.updateMatrix(),this.cone.scale.set(i,r,i),this.cone.position.y=t,this.cone.updateMatrix()},ho.prototype.setColor=function(t){this.line.material.color.set(t),this.cone.material.color.set(t)},ho.prototype.copy=function(t){return Ee.prototype.copy.call(this,t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this},ho.prototype.clone=function(){return new this.constructor().copy(this)},jp.prototype=at(pn.prototype),jp.prototype.constructor=jp;var aw=[.125,.215,.35,.446,.526,.582],SC=5+aw.length,Nf={};zi(Nf,3e3,0),zi(Nf,3001,1),zi(Nf,3002,2),zi(Nf,3004,3),zi(Nf,3005,4),zi(Nf,3006,5),zi(Nf,3007,6),new js,function(){for(var t=[],r=[],i=[],s=8,f=0;f<SC;f++){var c=Math.pow(2,s);r.push(c);var g=1/c;4<f?g=aw[f-8+4-1]:f==0&&(g=0),i.push(g),g=1/(c-1),c=-g/2,g=1+g/2;var p=[c,c,g,c,g,g,c,c,g,g,c,g];c=new Float32Array(108),g=new Float32Array(72);for(var A=new Float32Array(36),S=0;6>S;S++){var N=S%3*2/3-1,w=2<S?0:-1;c.set([N,w,0,N+2/3,w,0,N+2/3,w+1,0,N,w,0,N+2/3,w+1,0,N,w+1,0],18*S),g.set(p,12*S),A.set([S,S,S,S,S,S],6*S)}p=new We,p.setAttribute("position",new He(c,3)),p.setAttribute("uv",new He(g,2)),p.setAttribute("faceIndex",new He(A,1)),t.push(p),4<s&&s--}return{_lodPlanes:t,_sizeLods:r,_sigmas:i}}(),Ur.create=function(t,r){return t.prototype=at(Ur.prototype),t.prototype.constructor=t,t.prototype.getPoint=r,t},ut(Lu.prototype,{createPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getPoints(t),this.createGeometry(t)},createSpacedPointsGeometry:function(t){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),t=this.getSpacedPoints(t),this.createGeometry(t)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var r=new Fr,i=0,s=t.length;i<s;i++){var f=t[i];r.vertices.push(new ot(f.x,f.y,f.z||0))}return r}}),ut(yi.prototype,{fromPoints:function(t){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),function(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ro.call(this,t),this.type="catmullrom",this.closed=!0}.prototype=at(Ro.prototype),function(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Ro.call(this,t),this.type="catmullrom"}.prototype=at(Ro.prototype),tm.prototype=at(Ro.prototype),ut(tm.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Bl.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Xo.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ut(Qr.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),ic.extractUrlBase(t)}}),Qr.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ut(ps.prototype,{setTexturePath:function(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}),ut(Qg.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),ut(li.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),ut(Bi.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),yu.prototype.setFromMatrix=function(t){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(t)},Wp.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},ut(Tr,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Tr.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Tr.ceilPowerOfTwo(t)}}),ut(Ot.prototype,{flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),ut(Ie.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,r){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,r)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new ot().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(t){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,r,i,s,f,c){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,r,s,i,f,c)}}),_i.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},jt.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},ut(fn.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),ut(Ci.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,r)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),ut(Ci,{barycoordFromPoint:function(t,r,i,s,f){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ci.getBarycoord(t,r,i,s,f)},normal:function(t,r,i,s){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ci.getNormal(t,r,i,s)}}),ut(Ru.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new pa(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Cl(this,t)}}),ut(vt.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(ot.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,r){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(r,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,r,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(_t.prototype,{fromAttribute:function(t,r,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,r,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(Fr.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(t){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),ut(Ee.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,r){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(r,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(t){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Gr(Ee.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ut(Wi.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Gr(Wi.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Gr(yo.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Cs.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Gs.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Ur.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),un.prototype.setLens=function(t,r){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),r!==void 0&&(this.filmGauge=r),this.setFocalLength(t)},Gr(nn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Gr(He.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),ut(He.prototype,{setDynamic:function(t){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(We.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addAttribute:function(t,r,i){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),r&&r.isBufferAttribute||r&&r.isInterleavedBufferAttribute?t==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(r),this):this.setAttribute(t,r):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(t,new He(r,i)))},addDrawCall:function(t,r,i){i!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,r)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(t){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(t)},applyMatrix:function(t){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(t)}}),Gr(We.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Gr(Hp.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(t){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=t}}}),Gr(Bh.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(t){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=t}}}),Gr(Go.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(t){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(t)}}}),ut(Go.prototype,{setDynamic:function(t){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(t===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(Ts.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Gr(ka.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Gr(de.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Vt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(t){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=t}}}),Gr(ls.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Gr(ki.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),ut(vo.prototype,{clearTarget:function(t,r,i,s){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(t),this.clear(r,i,s)},animate:function(t){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(t)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Gr(vo.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(t){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=t===!0?3001:3e3}}}),Gr(_p.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Gr(Ft.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Gr(ma.prototype,{load:{value:function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var r=this;return new vn().load(t,function(i){r.setBuffer(i)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),kp.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Qi.prototype.updateCubeMap=function(t,r){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,r)},go.crossOrigin=void 0,go.loadTexture=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var f=new Qc;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},go.loadTextureCube=function(t,r,i,s){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var f=new Vg;return f.setCrossOrigin(this.crossOrigin),t=f.load(t,i,void 0,s),r&&(t.mapping=r),t},go.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},go.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}}));var zf=function(t){Qr.call(this,t)};zf.prototype=ut(at(Qr.prototype),{constructor:zf,load:function(t,r,i,s){var f=this,c=this.path===""?ic.extractUrlBase(t):this.path,g=new Wo(this.manager);g.setPath(this.path),g.load(t,function(p){try{r(f.parse(p,c))}catch(A){s?s(A):console.error(A),f.manager.itemError(t)}},i,s)},setMaterialOptions:function(t){return this.materialOptions=t,this},parse:function(t,r){var i=t.split(`
`),s={},f=/\s+/;t={};for(var c=0;c<i.length;c++){var g=i[c];if(g=g.trim(),g.length!==0&&g.charAt(0)!=="#"){var p=g.indexOf(" "),A=0<=p?g.substring(0,p):g;A=A.toLowerCase(),g=0<=p?g.substring(p+1):"",g=g.trim(),A==="newmtl"?(s={name:g},t[g]=s):A==="ka"||A==="kd"||A==="ks"||A==="ke"?(g=g.split(f,3),s[A]=[parseFloat(g[0]),parseFloat(g[1]),parseFloat(g[2])]):s[A]=g}}return r=new zf.MaterialCreator(this.resourcePath||r,this.materialOptions),r.setCrossOrigin(this.crossOrigin),r.setManager(this.manager),r.setMaterials(t),r}}),zf.MaterialCreator=function(t,r){this.baseUrl=t||"",this.options=r,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:0,this.wrap=this.options&&this.options.wrap?this.options.wrap:1e3},zf.MaterialCreator.prototype={constructor:zf.MaterialCreator,crossOrigin:"anonymous",setCrossOrigin:function(t){return this.crossOrigin=t,this},setManager:function(t){this.manager=t},setMaterials:function(t){this.materialsInfo=this.convert(t),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(t){if(!this.options)return t;var r={},i;for(i in t){var s=t[i],f={};r[i]=f;for(var c in s){var g=!0,p=s[c],A=c.toLowerCase();switch(A){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(p=[p[0]/255,p[1]/255,p[2]/255]),this.options&&this.options.ignoreZeroRGBs&&p[0]===0&&p[1]===0&&p[2]===0&&(g=!1)}g&&(f[A]=p)}}return r},preload:function(){for(var t in this.materialsInfo)this.create(t)},getIndex:function(t){return this.nameLookup[t]},getAsArray:function(){var t=0,r;for(r in this.materialsInfo)this.materialsArray[t]=this.create(r),this.nameLookup[r]=t,t++;return this.materialsArray},create:function(t){return this.materials[t]===void 0&&this.createMaterial_(t),this.materials[t]},createMaterial_:function(t){function r(A,S){return typeof S!="string"||S===""?"":/^https?:\/\//i.test(S)?S:A+S}function i(A,S){if(!c[A]){S=s.getTextureParams(S,c);var N=s.loadTexture(r(s.baseUrl,S.url));N.repeat.copy(S.scale),N.offset.copy(S.offset),N.wrapS=s.wrap,N.wrapT=s.wrap,c[A]=N}}var s=this,f=this.materialsInfo[t],c={name:t,side:this.side},g;for(g in f){var p=f[g];if(p!=="")switch(g.toLowerCase()){case"kd":c.color=new Vt().fromArray(p);break;case"ks":c.specular=new Vt().fromArray(p);break;case"ke":c.emissive=new Vt().fromArray(p);break;case"map_kd":i("map",p);break;case"map_ks":i("specularMap",p);break;case"map_ke":i("emissiveMap",p);break;case"norm":i("normalMap",p);break;case"map_bump":case"bump":i("bumpMap",p);break;case"map_d":i("alphaMap",p),c.transparent=!0;break;case"ns":c.shininess=parseFloat(p);break;case"d":p=parseFloat(p),1>p&&(c.opacity=p,c.transparent=!0);break;case"tr":p=parseFloat(p),this.options&&this.options.invertTrProperty&&(p=1-p),0<p&&(c.opacity=1-p,c.transparent=!0)}}return this.materials[t]=new ls(c),this.materials[t]},getTextureParams:function(t,r){var i={scale:new vt(1,1),offset:new vt(0,0)};t=t.split(/\s+/);var s=t.indexOf("-bm");return 0<=s&&(r.bumpScale=parseFloat(t[s+1]),t.splice(s,2)),s=t.indexOf("-s"),0<=s&&(i.scale.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),s=t.indexOf("-o"),0<=s&&(i.offset.set(parseFloat(t[s+1]),parseFloat(t[s+2])),t.splice(s,4)),i.url=t.join(" ").trim(),i},loadTexture:function(t,r,i,s,f){var c=this.manager!==void 0?this.manager:j_,g=c.getHandler(t);return g===null&&(g=new Qc(c)),g.setCrossOrigin&&g.setCrossOrigin(this.crossOrigin),t=g.load(t,i,s,f),r!==void 0&&(t.mapping=r),t}};var IC=function(){function t(){var w={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(I,L){if(this.object&&this.object.fromDeclaration===!1)this.object.name=I,this.object.fromDeclaration=L!==!1;else{var P=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:I||"",fromDeclaration:L!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasNormalIndices:!1,hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(F,W){var X=this._finalize(!1);return X&&(X.inherited||0>=X.groupCount)&&this.materials.splice(X.index,1),F={index:this.materials.length,name:F||"",mtllib:Array.isArray(W)&&0<W.length?W[W.length-1]:"",smooth:X!==void 0?X.smooth:this.smooth,groupStart:X!==void 0?X.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(Z){return Z={index:typeof Z=="number"?Z:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1},Z.clone=this.clone.bind(Z),Z}},this.materials.push(F),F},currentMaterial:function(){if(0<this.materials.length)return this.materials[this.materials.length-1]},_finalize:function(F){var W=this.currentMaterial();if(W&&W.groupEnd===-1&&(W.groupEnd=this.geometry.vertices.length/3,W.groupCount=W.groupEnd-W.groupStart,W.inherited=!1),F&&1<this.materials.length)for(var X=this.materials.length-1;0<=X;X--)0>=this.materials[X].groupCount&&this.materials.splice(X,1);return F&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),W}},P&&P.name&&typeof P.clone=="function"&&(I=P.clone(0),I.inherited=!0,this.object.materials.push(I)),this.objects.push(this.object)}},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(I,L){return I=parseInt(I,10),3*(0<=I?I-1:I+L/3)},parseNormalIndex:function(I,L){return I=parseInt(I,10),3*(0<=I?I-1:I+L/3)},parseUVIndex:function(I,L){return I=parseInt(I,10),2*(0<=I?I-1:I+L/2)},addVertex:function(I,L,P){var F=this.vertices,W=this.object.geometry.vertices;W.push(F[I+0],F[I+1],F[I+2]),W.push(F[L+0],F[L+1],F[L+2]),W.push(F[P+0],F[P+1],F[P+2])},addVertexPoint:function(I){var L=this.vertices;this.object.geometry.vertices.push(L[I+0],L[I+1],L[I+2])},addVertexLine:function(I){var L=this.vertices;this.object.geometry.vertices.push(L[I+0],L[I+1],L[I+2])},addNormal:function(I,L,P){var F=this.normals,W=this.object.geometry.normals;W.push(F[I+0],F[I+1],F[I+2]),W.push(F[L+0],F[L+1],F[L+2]),W.push(F[P+0],F[P+1],F[P+2])},addFaceNormal:function(I,L,P){var F=this.vertices,W=this.object.geometry.normals;g.fromArray(F,I),p.fromArray(F,L),A.fromArray(F,P),N.subVectors(A,p),S.subVectors(g,p),N.cross(S),N.normalize(),W.push(N.x,N.y,N.z),W.push(N.x,N.y,N.z),W.push(N.x,N.y,N.z)},addColor:function(I,L,P){var F=this.colors,W=this.object.geometry.colors;F[I]!==void 0&&W.push(F[I+0],F[I+1],F[I+2]),F[L]!==void 0&&W.push(F[L+0],F[L+1],F[L+2]),F[P]!==void 0&&W.push(F[P+0],F[P+1],F[P+2])},addUV:function(I,L,P){var F=this.uvs,W=this.object.geometry.uvs;W.push(F[I+0],F[I+1]),W.push(F[L+0],F[L+1]),W.push(F[P+0],F[P+1])},addDefaultUV:function(){var I=this.object.geometry.uvs;I.push(0,0),I.push(0,0),I.push(0,0)},addUVLine:function(I){var L=this.uvs;this.object.geometry.uvs.push(L[I+0],L[I+1])},addFace:function(I,L,P,F,W,X,Z,tt,st){var xt=this.vertices.length;I=this.parseVertexIndex(I,xt),L=this.parseVertexIndex(L,xt),P=this.parseVertexIndex(P,xt),this.addVertex(I,L,P),this.addColor(I,L,P),Z!==void 0&&Z!==""?(P=this.normals.length,I=this.parseNormalIndex(Z,P),L=this.parseNormalIndex(tt,P),P=this.parseNormalIndex(st,P),this.addNormal(I,L,P),this.object.geometry.hasNormalIndices=!0):this.addFaceNormal(I,L,P),F!==void 0&&F!==""?(Z=this.uvs.length,I=this.parseUVIndex(F,Z),L=this.parseUVIndex(W,Z),P=this.parseUVIndex(X,Z),this.addUV(I,L,P),this.object.geometry.hasUVIndices=!0):this.addDefaultUV()},addPointGeometry:function(I){this.object.geometry.type="Points";for(var L=this.vertices.length,P=0,F=I.length;P<F;P++)this.addVertexPoint(this.parseVertexIndex(I[P],L))},addLineGeometry:function(I,L){this.object.geometry.type="Line";for(var P=this.vertices.length,F=this.uvs.length,W=0,X=I.length;W<X;W++)this.addVertexLine(this.parseVertexIndex(I[W],P));for(I=0,X=L.length;I<X;I++)this.addUVLine(this.parseUVIndex(L[I],F))}};return w.startObject("",!1),w}function r(w){Qr.call(this,w),this.materials=null}var i=/^[og]\s*(.+)?/,s=/^mtllib /,f=/^usemtl /,c=/^usemap /,g=new ot,p=new ot,A=new ot,S=new ot,N=new ot;return r.prototype=ut(at(Qr.prototype),{constructor:r,load:function(w,I,L,P){var F=this,W=new Wo(F.manager);W.setPath(this.path),W.load(w,function(X){try{I(F.parse(X))}catch(Z){P?P(Z):console.error(Z),F.manager.itemError(w)}},L,P)},setMaterials:function(w){return this.materials=w,this},parse:function(w){var I=new t;w.indexOf(`\r
`)!==-1&&(w=w.replace(/\r\n/g,`
`)),w.indexOf(`\\
`)!==-1&&(w=w.replace(/\\\n/g,""));var L=w.split(`
`),P,F=typeof"".trimLeft=="function";w=0;for(var W=L.length;w<W;w++){var X=L[w];X=F?X.trimLeft():X.trim();var Z=X.length;if(Z!==0&&(Z=X.charAt(0),Z!=="#"))if(Z==="v")switch(X=X.split(/\s+/),X[0]){case"v":I.vertices.push(parseFloat(X[1]),parseFloat(X[2]),parseFloat(X[3])),7<=X.length?I.colors.push(parseFloat(X[4]),parseFloat(X[5]),parseFloat(X[6])):I.colors.push(void 0,void 0,void 0);break;case"vn":I.normals.push(parseFloat(X[1]),parseFloat(X[2]),parseFloat(X[3]));break;case"vt":I.uvs.push(parseFloat(X[1]),parseFloat(X[2]))}else if(Z==="f"){X=X.substr(1).trim();var tt=X.split(/\s+/);for(X=[],Z=0,P=tt.length;Z<P;Z++){var st=tt[Z];0<st.length&&(st=st.split("/"),X.push(st))}for(tt=X[0],Z=1,P=X.length-1;Z<P;Z++){st=X[Z];var xt=X[Z+1];I.addFace(tt[0],st[0],xt[0],tt[1],st[1],xt[1],tt[2],st[2],xt[2])}}else if(Z==="l"){if(Z=X.substring(1).trim().split(" "),P=[],tt=[],X.indexOf("/")===-1)P=Z;else for(X=0,st=Z.length;X<st;X++)xt=Z[X].split("/"),xt[0]!==""&&P.push(xt[0]),xt[1]!==""&&tt.push(xt[1]);I.addLineGeometry(P,tt)}else Z==="p"?(X=X.substr(1).trim(),X=X.split(" "),I.addPointGeometry(X)):(P=i.exec(X))!==null?(X=(" "+P[0].substr(1).trim()).substr(1),I.startObject(X)):f.test(X)?I.object.startMaterial(X.substring(7).trim(),I.materialLibraries):s.test(X)?I.materialLibraries.push(X.substring(7).trim()):c.test(X)?console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.'):Z==="s"?(P=X.split(" "),1<P.length?(X=P[1].trim().toLowerCase(),I.object.smooth=X!=="0"&&X!=="off"):I.object.smooth=!0,(X=I.object.currentMaterial())&&(X.smooth=I.object.smooth)):X!=="\0"&&console.warn('THREE.OBJLoader: Unexpected line: "'+X+'"')}for(I.finalize(),L=new Ho,L.materialLibraries=[].concat(I.materialLibraries),w=0,W=I.objects.length;w<W;w++)if(F=I.objects[w],X=F.geometry,Z=F.materials,P=X.type==="Line",tt=X.type==="Points",st=!1,X.vertices.length!==0){xt=new We,xt.setAttribute("position",new Ge(X.vertices,3)),X.hasNormalIndices===!0&&xt.setAttribute("normal",new Ge(X.normals,3)),0<X.colors.length&&(st=!0,xt.setAttribute("color",new Ge(X.colors,3))),X.hasUVIndices===!0&&xt.setAttribute("uv",new Ge(X.uvs,2));for(var At=[],yt=0,Ut=Z.length;yt<Ut;yt++){var kt=Z[yt],ne=kt.name+"_"+kt.smooth+"_"+st;if(X=I.materials[ne],this.materials!==null)if(X=this.materials.create(kt.name),!P||!X||X instanceof Xi)!tt||!X||X instanceof us||(Wt=new us({size:10,sizeAttenuation:!1}),de.prototype.copy.call(Wt,X),Wt.color.copy(X.color),Wt.map=X.map,X=Wt);else{var Wt=new Xi;de.prototype.copy.call(Wt,X),Wt.color.copy(X.color),X=Wt}X===void 0&&(X=P?new Xi:tt?new us({size:1,sizeAttenuation:!1}):new ls,X.name=kt.name,X.flatShading=!kt.smooth,X.vertexColors=st,I.materials[ne]=X),At.push(X)}if(1<At.length){for(yt=0,Ut=Z.length;yt<Ut;yt++)kt=Z[yt],xt.addGroup(kt.groupStart,kt.groupCount,yt);X=P?new pn(xt,At):tt?new Ba(xt,At):new Wi(xt,At)}else X=P?new pn(xt,At[0]):tt?new Ba(xt,At[0]):new Wi(xt,At[0]);X.name=F.name,L.add(X)}return L}}),r}(),EC=function(){function t(dt){Qr.call(this,dt),this.ddsLoader=this.dracoLoader=null}function r(){var dt={};return{get:function(gt){return dt[gt]},add:function(gt,mt){dt[gt]=mt},remove:function(gt){delete dt[gt]},removeAll:function(){dt={}}}}function i(dt){if(!dt)throw Error("THREE.GLTFLoader: Attempting to load .dds texture without importing DDSLoader");this.name=Ut.MSFT_TEXTURE_DDS,this.ddsLoader=dt}function s(dt){this.name=Ut.KHR_LIGHTS_PUNCTUAL,this.lightDefs=(dt.extensions&&dt.extensions[Ut.KHR_LIGHTS_PUNCTUAL]||{}).lights||[]}function f(){this.name=Ut.KHR_MATERIALS_UNLIT}function c(){this.name=Ut.KHR_MATERIALS_CLEARCOAT}function g(dt){this.name=Ut.KHR_BINARY_GLTF,this.body=this.content=null;var gt=new DataView(dt,0,ne);if(this.header={magic:ic.decodeText(new Uint8Array(dt.slice(0,4))),version:gt.getUint32(4,!0),length:gt.getUint32(8,!0)},this.header.magic!==kt)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(2>this.header.version)throw Error("THREE.GLTFLoader: Legacy binary file detected.");gt=new DataView(dt,ne);for(var mt=0;mt<gt.byteLength;){var Tt=gt.getUint32(mt,!0);mt+=4;var et=gt.getUint32(mt,!0);mt+=4,et===Wt.JSON?(et=new Uint8Array(dt,ne+mt,Tt),this.content=ic.decodeText(et)):et===Wt.BIN&&(et=ne+mt,this.body=dt.slice(et,et+Tt)),mt+=Tt}if(this.content===null)throw Error("THREE.GLTFLoader: JSON content not found.")}function p(dt,gt){if(!gt)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Ut.KHR_DRACO_MESH_COMPRESSION,this.json=dt,this.dracoLoader=gt,this.dracoLoader.preload()}function A(){this.name=Ut.KHR_TEXTURE_TRANSFORM}function S(dt){$n.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var gt={specular:{value:new Vt().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=gt,this.onBeforeCompile=function(mt){for(var Tt in gt)mt.uniforms[Tt]=gt[Tt];mt.fragmentShader=mt.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;"),mt.fragmentShader=mt.fragmentShader.replace("uniform float metalness;","uniform float glossiness;"),mt.fragmentShader=mt.fragmentShader.replace("#include <roughnessmap_pars_fragment>",`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`),mt.fragmentShader=mt.fragmentShader.replace("#include <metalnessmap_pars_fragment>",`#ifdef USE_GLOSSINESSMAP
	uniform sampler2D glossinessMap;
#endif`),mt.fragmentShader=mt.fragmentShader.replace("#include <roughnessmap_fragment>",`vec3 specularFactor = specular;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	texelSpecular = sRGBToLinear( texelSpecular );
	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture
	specularFactor *= texelSpecular.rgb;
#endif`),mt.fragmentShader=mt.fragmentShader.replace("#include <metalnessmap_fragment>",`float glossinessFactor = glossiness;
#ifdef USE_GLOSSINESSMAP
	vec4 texelGlossiness = texture2D( glossinessMap, vUv );
	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture
	glossinessFactor *= texelGlossiness.a;
#endif`),mt.fragmentShader=mt.fragmentShader.replace("#include <lights_physical_fragment>",`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb;
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 );// 0.0525 corresponds to the base mip of a 256 cubemap.
material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
material.specularColor = specularFactor.rgb;`)},Gr(this,{specular:{get:function(){return gt.specular.value},set:function(mt){gt.specular.value=mt}},specularMap:{get:function(){return gt.specularMap.value},set:function(mt){gt.specularMap.value=mt}},glossiness:{get:function(){return gt.glossiness.value},set:function(mt){gt.glossiness.value=mt}},glossinessMap:{get:function(){return gt.glossinessMap.value},set:function(mt){(gt.glossinessMap.value=mt)?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_ROUGHNESSMAP=""):(delete this.defines.USE_ROUGHNESSMAP,delete this.defines.USE_GLOSSINESSMAP)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(dt)}function N(){return{name:Ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:"color map lightMap lightMapIntensity aoMap aoMapIntensity emissive emissiveIntensity emissiveMap bumpMap bumpScale normalMap normalMapType displacementMap displacementScale displacementBias specularMap specular glossinessMap glossiness alphaMap envMap envMapIntensity refractionRatio".split(" "),getMaterialType:function(){return S},extendParams:function(dt,gt,mt){var Tt=gt.extensions[this.name];if(dt.color=new Vt(1,1,1),dt.opacity=1,gt=[],Array.isArray(Tt.diffuseFactor)){var et=Tt.diffuseFactor;dt.color.fromArray(et),dt.opacity=et[3]}return Tt.diffuseTexture!==void 0&&gt.push(mt.assignTexture(dt,"map",Tt.diffuseTexture)),dt.emissive=new Vt(0,0,0),dt.glossiness=Tt.glossinessFactor!==void 0?Tt.glossinessFactor:1,dt.specular=new Vt(1,1,1),Array.isArray(Tt.specularFactor)&&dt.specular.fromArray(Tt.specularFactor),Tt.specularGlossinessTexture!==void 0&&(Tt=Tt.specularGlossinessTexture,gt.push(mt.assignTexture(dt,"glossinessMap",Tt)),gt.push(mt.assignTexture(dt,"specularMap",Tt))),xi.all(gt)},createMaterial:function(dt){var gt=new S(dt);return gt.fog=!0,gt.color=dt.color,gt.map=dt.map===void 0?null:dt.map,gt.lightMap=null,gt.lightMapIntensity=1,gt.aoMap=dt.aoMap===void 0?null:dt.aoMap,gt.aoMapIntensity=1,gt.emissive=dt.emissive,gt.emissiveIntensity=1,gt.emissiveMap=dt.emissiveMap===void 0?null:dt.emissiveMap,gt.bumpMap=dt.bumpMap===void 0?null:dt.bumpMap,gt.bumpScale=1,gt.normalMap=dt.normalMap===void 0?null:dt.normalMap,gt.normalMapType=0,dt.normalScale&&(gt.normalScale=dt.normalScale),gt.displacementMap=null,gt.displacementScale=1,gt.displacementBias=0,gt.specularMap=dt.specularMap===void 0?null:dt.specularMap,gt.specular=dt.specular,gt.glossinessMap=dt.glossinessMap===void 0?null:dt.glossinessMap,gt.glossiness=dt.glossiness,gt.alphaMap=null,gt.envMap=dt.envMap===void 0?null:dt.envMap,gt.envMapIntensity=1,gt.refractionRatio=.98,gt}}}function w(){this.name=Ut.KHR_MESH_QUANTIZATION}function I(dt,gt,mt,Tt){Lo.call(this,dt,gt,mt,Tt)}function L(dt,gt){return typeof dt!="string"||dt===""?"":(/^https?:\/\//i.test(gt)&&/^\//.test(dt)&&(gt=gt.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(dt)||/^data:.*,.*$/i.test(dt)||/^blob:.*$/i.test(dt)?dt:gt+dt)}function P(dt){return dt.DefaultMaterial===void 0&&(dt.DefaultMaterial=new $n({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),dt.DefaultMaterial}function F(dt,gt,mt){for(var Tt in mt.extensions)dt[Tt]===void 0&&(gt.userData.gltfExtensions=gt.userData.gltfExtensions||{},gt.userData.gltfExtensions[Tt]=mt.extensions[Tt])}function W(dt,gt){gt.extras!==void 0&&(Zs(gt.extras)==="object"?ut(dt.userData,gt.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+gt.extras))}function X(dt,gt,mt){for(var Tt=!1,et=!1,ht=0,ct=gt.length;ht<ct;ht++){var St=gt[ht];if(St.POSITION!==void 0&&(Tt=!0),St.NORMAL!==void 0&&(et=!0),Tt&&et)break}if(!Tt&&!et)return xi.resolve(dt);var Gt=[],Qt=[];for(ht=0,ct=gt.length;ht<ct;ht++){if(St=gt[ht],Tt){var ft=St.POSITION!==void 0?mt.getDependency("accessor",St.POSITION):dt.attributes.position;Gt.push(ft)}et&&(ft=St.NORMAL!==void 0?mt.getDependency("accessor",St.NORMAL):dt.attributes.normal,Qt.push(ft))}return xi.all([xi.all(Gt),xi.all(Qt)]).then(function(ve){var xe=ve[0];return ve=ve[1],Tt&&(dt.morphAttributes.position=xe),et&&(dt.morphAttributes.normal=ve),dt.morphTargetsRelative=!0,dt})}function Z(dt){var gt=dt.extensions&&dt.extensions[Ut.KHR_DRACO_MESH_COMPRESSION];return gt?"draco:"+gt.bufferView+":"+gt.indices+":"+tt(gt.attributes):dt.indices+":"+tt(dt.attributes)+":"+dt.mode}function tt(dt){for(var gt="",mt=Pi(dt).sort(),Tt=0,et=mt.length;Tt<et;Tt++)gt+=mt[Tt]+":"+dt[mt[Tt]]+";";return gt}function st(dt,gt,mt){this.json=dt||{},this.extensions=gt||{},this.options=mt||{},this.cache=new r,this.associations=new Pm,this.primitiveCache={},this.textureLoader=new Qc(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new Wo(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}function xt(dt,gt,mt){var Tt=gt.attributes,et=new li;if(Tt.POSITION!==void 0){var ht=mt.json.accessors[Tt.POSITION];if(Tt=ht.min,ht=ht.max,Tt!==void 0&&ht!==void 0){if(et.set(new ot(Tt[0],Tt[1],Tt[2]),new ot(ht[0],ht[1],ht[2])),gt=gt.targets,gt!==void 0){for(var ct=new ot,St=new ot,Gt=0,Qt=gt.length;Gt<Qt;Gt++)Tt=gt[Gt],Tt.POSITION!==void 0&&(ht=mt.json.accessors[Tt.POSITION],Tt=ht.min,ht=ht.max,Tt!==void 0&&ht!==void 0?(St.setX(Math.max(Math.abs(Tt[0]),Math.abs(ht[0]))),St.setY(Math.max(Math.abs(Tt[1]),Math.abs(ht[1]))),St.setZ(Math.max(Math.abs(Tt[2]),Math.abs(ht[2]))),ct.max(St)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION."));et.expandByVector(ct)}dt.boundingBox=et,mt=new Bi,et.getCenter(mt.center),mt.radius=et.min.distanceTo(et.max)/2,dt.boundingSphere=mt}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}function At(dt,gt,mt){function Tt(Gt,Qt){return mt.getDependency("accessor",Gt).then(function(ft){dt.setAttribute(Qt,ft)})}var et=gt.attributes,ht=[],ct;for(ct in et){var St=yr[ct]||ct.toLowerCase();St in dt.attributes||ht.push(Tt(et[ct],St))}return gt.indices===void 0||dt.index||(et=mt.getDependency("accessor",gt.indices).then(function(Gt){dt.setIndex(Gt)}),ht.push(et)),W(dt,gt),xt(dt,gt,mt),xi.all(ht).then(function(){return gt.targets!==void 0?X(dt,gt.targets,mt):dt})}function yt(dt,gt){var mt=dt.getIndex();if(mt===null){var Tt=[];if(mt=dt.getAttribute("position"),mt!==void 0){for(var et=0;et<mt.count;et++)Tt.push(et);dt.setIndex(Tt),mt=dt.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),dt}var ht=mt.count-2;if(Tt=[],gt===2)for(et=1;et<=ht;et++)Tt.push(mt.getX(0)),Tt.push(mt.getX(et)),Tt.push(mt.getX(et+1));else for(et=0;et<ht;et++)et%2===0?(Tt.push(mt.getX(et)),Tt.push(mt.getX(et+1)),Tt.push(mt.getX(et+2))):(Tt.push(mt.getX(et+2)),Tt.push(mt.getX(et+1)),Tt.push(mt.getX(et)));return Tt.length/3!==ht&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles."),dt=dt.clone(),dt.setIndex(Tt),dt}t.prototype=ut(at(Qr.prototype),{constructor:t,load:function(dt,gt,mt,Tt){var et=this,ht=this.resourcePath!==""?this.resourcePath:this.path!==""?this.path:ic.extractUrlBase(dt);et.manager.itemStart(dt);var ct=function(Gt){Tt?Tt(Gt):console.error(Gt),et.manager.itemError(dt),et.manager.itemEnd(dt)},St=new Wo(et.manager);St.setPath(this.path),St.setResponseType("arraybuffer"),St.setRequestHeader(this.requestHeader),et.crossOrigin==="use-credentials"&&St.setWithCredentials(!0),St.load(dt,function(Gt){try{et.parse(Gt,ht,function(Qt){gt(Qt),et.manager.itemEnd(dt)},ct)}catch(Qt){ct(Qt)}},mt,ct)},setDRACOLoader:function(dt){return this.dracoLoader=dt,this},setDDSLoader:function(dt){return this.ddsLoader=dt,this},parse:function(dt,gt,mt,Tt){var et={};if(typeof dt!="string")if(ic.decodeText(new Uint8Array(dt,0,4))===kt){try{et[Ut.KHR_BINARY_GLTF]=new g(dt)}catch(Gt){Tt&&Tt(Gt);return}dt=et[Ut.KHR_BINARY_GLTF].content}else dt=ic.decodeText(new Uint8Array(dt));if(dt=JSON.parse(dt),dt.asset===void 0||2>dt.asset.version[0])Tt&&Tt(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{if(dt.extensionsUsed)for(var ht=0;ht<dt.extensionsUsed.length;++ht){var ct=dt.extensionsUsed[ht],St=dt.extensionsRequired||[];switch(ct){case Ut.KHR_LIGHTS_PUNCTUAL:et[ct]=new s(dt);break;case Ut.KHR_MATERIALS_CLEARCOAT:et[ct]=new c;break;case Ut.KHR_MATERIALS_UNLIT:et[ct]=new f;break;case Ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:et[ct]=new N;break;case Ut.KHR_DRACO_MESH_COMPRESSION:et[ct]=new p(dt,this.dracoLoader);break;case Ut.MSFT_TEXTURE_DDS:et[ct]=new i(this.ddsLoader);break;case Ut.KHR_TEXTURE_TRANSFORM:et[ct]=new A;break;case Ut.KHR_MESH_QUANTIZATION:et[ct]=new w;break;default:0<=St.indexOf(ct)&&console.warn('THREE.GLTFLoader: Unknown extension "'+ct+'".')}}gt=new st(dt,et,{path:gt||this.resourcePath||"",crossOrigin:this.crossOrigin,manager:this.manager}),gt.fileLoader.setRequestHeader(this.requestHeader),gt.parse(mt,Tt)}}});var Ut={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};s.prototype.loadLight=function(dt){var gt=this.lightDefs[dt],mt=new Vt(16777215);gt.color!==void 0&&mt.fromArray(gt.color);var Tt=gt.range!==void 0?gt.range:0;switch(gt.type){case"directional":mt=new Jr(mt),mt.target.position.set(0,0,-1),mt.add(mt.target);break;case"point":mt=new Pu(mt),mt.distance=Tt;break;case"spot":mt=new ef(mt),mt.distance=Tt,gt.spot=gt.spot||{},gt.spot.innerConeAngle=gt.spot.innerConeAngle!==void 0?gt.spot.innerConeAngle:0,gt.spot.outerConeAngle=gt.spot.outerConeAngle!==void 0?gt.spot.outerConeAngle:Math.PI/4,mt.angle=gt.spot.outerConeAngle,mt.penumbra=1-gt.spot.innerConeAngle/gt.spot.outerConeAngle,mt.target.position.set(0,0,-1),mt.add(mt.target);break;default:throw Error('THREE.GLTFLoader: Unexpected light type, "'+gt.type+'".')}return mt.position.set(0,0,0),mt.decay=2,gt.intensity!==void 0&&(mt.intensity=gt.intensity),mt.name=gt.name||"light_"+dt,xi.resolve(mt)},f.prototype.getMaterialType=function(){return Rr},f.prototype.extendParams=function(dt,gt,mt){var Tt=[];if(dt.color=new Vt(1,1,1),dt.opacity=1,gt=gt.pbrMetallicRoughness){if(Array.isArray(gt.baseColorFactor)){var et=gt.baseColorFactor;dt.color.fromArray(et),dt.opacity=et[3]}gt.baseColorTexture!==void 0&&Tt.push(mt.assignTexture(dt,"map",gt.baseColorTexture))}return xi.all(Tt)},c.prototype.getMaterialType=function(){return Eo},c.prototype.extendParams=function(dt,gt,mt){var Tt=[];return gt=gt.extensions[this.name],gt.clearcoatFactor!==void 0&&(dt.clearcoat=gt.clearcoatFactor),gt.clearcoatTexture!==void 0&&Tt.push(mt.assignTexture(dt,"clearcoatMap",gt.clearcoatTexture)),gt.clearcoatRoughnessFactor!==void 0&&(dt.clearcoatRoughness=gt.clearcoatRoughnessFactor),gt.clearcoatRoughnessTexture!==void 0&&Tt.push(mt.assignTexture(dt,"clearcoatRoughnessMap",gt.clearcoatRoughnessTexture)),gt.clearcoatNormalTexture!==void 0&&(Tt.push(mt.assignTexture(dt,"clearcoatNormalMap",gt.clearcoatNormalTexture)),gt.clearcoatNormalTexture.scale!==void 0&&(mt=gt.clearcoatNormalTexture.scale,dt.clearcoatNormalScale=new vt(mt,mt))),xi.all(Tt)};var kt="glTF",ne=12,Wt={JSON:1313821514,BIN:5130562};p.prototype.decodePrimitive=function(dt,gt){var mt=this.json,Tt=this.dracoLoader,et=dt.extensions[this.name].bufferView,ht=dt.extensions[this.name].attributes,ct={},St={},Gt={},Qt;for(Qt in ht){var ft=yr[Qt]||Qt.toLowerCase();ct[ft]=ht[Qt]}for(Qt in dt.attributes)if(ft=yr[Qt]||Qt.toLowerCase(),ht[Qt]!==void 0){var ve=mt.accessors[dt.attributes[Qt]];Gt[ft]=re[ve.componentType],St[ft]=ve.normalized===!0}return gt.getDependency("bufferView",et).then(function(xe){return new xi(function(me){Tt.decodeDracoFile(xe,function(le){for(var Ce in le.attributes){var xr=le.attributes[Ce],Br=St[Ce];Br!==void 0&&(xr.normalized=Br)}me(le)},ct,Gt)})})},A.prototype.extendTexture=function(dt,gt){return dt=dt.clone(),gt.offset!==void 0&&dt.offset.fromArray(gt.offset),gt.rotation!==void 0&&(dt.rotation=gt.rotation),gt.scale!==void 0&&dt.repeat.fromArray(gt.scale),gt.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),dt.needsUpdate=!0,dt},S.prototype=at($n.prototype),S.prototype.constructor=S,S.prototype.copy=function(dt){return $n.prototype.copy.call(this,dt),this.specularMap=dt.specularMap,this.specular.copy(dt.specular),this.glossinessMap=dt.glossinessMap,this.glossiness=dt.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},I.prototype=at(Lo.prototype),I.prototype.constructor=I,I.prototype.copySampleValue_=function(dt){var gt=this.resultBuffer,mt=this.sampleValues,Tt=this.valueSize;dt=dt*Tt*3+Tt;for(var et=0;et!==Tt;et++)gt[et]=mt[dt+et];return gt},I.prototype.beforeStart_=I.prototype.copySampleValue_,I.prototype.afterEnd_=I.prototype.copySampleValue_,I.prototype.interpolate_=function(dt,gt,mt,Tt){var et=this.resultBuffer,ht=this.sampleValues,ct=this.valueSize,St=2*ct,Gt=3*ct;Tt-=gt,gt=(mt-gt)/Tt,mt=gt*gt;var Qt=mt*gt;dt*=Gt,Gt=dt-Gt;var ft=-2*Qt+3*mt;Qt-=mt;var ve=1-ft;for(gt=Qt-mt+gt,mt=0;mt!==ct;mt++)et[mt]=ve*ht[Gt+mt+ct]+gt*ht[Gt+mt+St]*Tt+ft*ht[dt+mt+ct]+Qt*ht[dt+mt]*Tt;return et};var re={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},be={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},ce={33071:1001,33648:1002,10497:1e3},tr={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},yr={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},sr={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ni={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},pr={"image/png":1023,"image/jpeg":1022};return st.prototype.parse=function(dt,gt){var mt=this,Tt=this.json,et=this.extensions;this.cache.removeAll(),this.markDefs(),xi.all([this.getDependencies("scene"),this.getDependencies("animation"),this.getDependencies("camera")]).then(function(ht){ht={scene:ht[0][Tt.scene||0],scenes:ht[0],animations:ht[1],cameras:ht[2],asset:Tt.asset,parser:mt,userData:{}},F(et,ht,Tt),W(ht,Tt),dt(ht)}).catch(gt)},st.prototype.markDefs=function(){for(var dt=this.json.nodes||[],gt=this.json.skins||[],mt=this.json.meshes||[],Tt={},et={},ht=0,ct=gt.length;ht<ct;ht++)for(var St=gt[ht].joints,Gt=0,Qt=St.length;Gt<Qt;Gt++)dt[St[Gt]].isBone=!0;for(gt=0,ht=dt.length;gt<ht;gt++)ct=dt[gt],ct.mesh!==void 0&&(Tt[ct.mesh]===void 0&&(Tt[ct.mesh]=et[ct.mesh]=0),Tt[ct.mesh]++,ct.skin!==void 0&&(mt[ct.mesh].isSkinnedMesh=!0));this.json.meshReferences=Tt,this.json.meshUses=et},st.prototype.getDependency=function(dt,gt){var mt=dt+":"+gt,Tt=this.cache.get(mt);if(!Tt){switch(dt){case"scene":Tt=this.loadScene(gt);break;case"node":Tt=this.loadNode(gt);break;case"mesh":Tt=this.loadMesh(gt);break;case"accessor":Tt=this.loadAccessor(gt);break;case"bufferView":Tt=this.loadBufferView(gt);break;case"buffer":Tt=this.loadBuffer(gt);break;case"material":Tt=this.loadMaterial(gt);break;case"texture":Tt=this.loadTexture(gt);break;case"skin":Tt=this.loadSkin(gt);break;case"animation":Tt=this.loadAnimation(gt);break;case"camera":Tt=this.loadCamera(gt);break;case"light":Tt=this.extensions[Ut.KHR_LIGHTS_PUNCTUAL].loadLight(gt);break;default:throw Error("Unknown type: "+dt)}this.cache.add(mt,Tt)}return Tt},st.prototype.getDependencies=function(dt){var gt=this.cache.get(dt);if(!gt){var mt=this;gt=xi.all((this.json[dt+(dt==="mesh"?"es":"s")]||[]).map(function(Tt,et){return mt.getDependency(dt,et)})),this.cache.add(dt,gt)}return gt},st.prototype.loadBuffer=function(dt){var gt=this.json.buffers[dt],mt=this.fileLoader;if(gt.type&&gt.type!=="arraybuffer")throw Error("THREE.GLTFLoader: "+gt.type+" buffer type is not supported.");if(gt.uri===void 0&&dt===0)return xi.resolve(this.extensions[Ut.KHR_BINARY_GLTF].body);var Tt=this.options;return new xi(function(et,ht){mt.load(L(gt.uri,Tt.path),et,void 0,function(){ht(Error('THREE.GLTFLoader: Failed to load buffer "'+gt.uri+'".'))})})},st.prototype.loadBufferView=function(dt){var gt=this.json.bufferViews[dt];return this.getDependency("buffer",gt.buffer).then(function(mt){var Tt=gt.byteOffset||0;return mt.slice(Tt,Tt+(gt.byteLength||0))})},st.prototype.loadAccessor=function(dt){var gt=this,mt=this.json,Tt=this.json.accessors[dt];return Tt.bufferView===void 0&&Tt.sparse===void 0?xi.resolve(null):(dt=[],Tt.bufferView!==void 0?dt.push(this.getDependency("bufferView",Tt.bufferView)):dt.push(null),Tt.sparse!==void 0&&(dt.push(this.getDependency("bufferView",Tt.sparse.indices.bufferView)),dt.push(this.getDependency("bufferView",Tt.sparse.values.bufferView))),xi.all(dt).then(function(et){var ht=et[0],ct=tr[Tt.type],St=re[Tt.componentType],Gt=St.BYTES_PER_ELEMENT,Qt=Tt.byteOffset||0,ft=Tt.bufferView!==void 0?mt.bufferViews[Tt.bufferView].byteStride:void 0,ve=Tt.normalized===!0;if(ft&&ft!==Gt*ct){var xe=Math.floor(Qt/ft),me="InterleavedBuffer:"+Tt.bufferView+":"+Tt.componentType+":"+xe+":"+Tt.count,le=gt.cache.get(me);le||(xe=new St(ht,xe*ft,Tt.count*ft/Gt),le=new Go(xe,ft/Gt),gt.cache.add(me,le)),Gt=new _u(le,ct,Qt%ft/Gt,ve)}else xe=ht===null?new St(Tt.count*ct):new St(ht,Qt,Tt.count*ct),Gt=new He(xe,ct,ve);if(Tt.sparse!==void 0){for(ft=Tt.sparse.values.byteOffset||0,Qt=new re[Tt.sparse.indices.componentType](et[1],Tt.sparse.indices.byteOffset||0,Tt.sparse.count*tr.SCALAR),et=new St(et[2],ft,Tt.sparse.count*ct),ht!==null&&(Gt=new He(Gt.array.slice(),Gt.itemSize,Gt.normalized)),ht=0,St=Qt.length;ht<St;ht++)if(ft=Qt[ht],Gt.setX(ft,et[ht*ct]),2<=ct&&Gt.setY(ft,et[ht*ct+1]),3<=ct&&Gt.setZ(ft,et[ht*ct+2]),4<=ct&&Gt.setW(ft,et[ht*ct+3]),5<=ct)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}return Gt}))},st.prototype.loadTexture=function(dt){var gt=this,mt=this.json,Tt=this.options,et=this.textureLoader,ht=self.URL||self.webkitURL,ct=mt.textures[dt],St=ct.extensions||{},Gt=St[Ut.MSFT_TEXTURE_DDS]?mt.images[St[Ut.MSFT_TEXTURE_DDS].source]:mt.images[ct.source],Qt=Gt.uri,ft=!1;return Gt.bufferView!==void 0&&(Qt=gt.getDependency("bufferView",Gt.bufferView).then(function(ve){return ft=!0,ve=new Blob([ve],{type:Gt.mimeType}),Qt=ht.createObjectURL(ve)})),xi.resolve(Qt).then(function(ve){var xe=Tt.manager.getHandler(ve);return xe||(xe=St[Ut.MSFT_TEXTURE_DDS]?gt.extensions[Ut.MSFT_TEXTURE_DDS].ddsLoader:et),new xi(function(me,le){xe.load(L(ve,Tt.path),me,void 0,le)})}).then(function(ve){ft===!0&&ht.revokeObjectURL(Qt),ve.flipY=!1,ct.name&&(ve.name=ct.name),Gt.mimeType in pr&&(ve.format=pr[Gt.mimeType]);var xe=(mt.samplers||{})[ct.sampler]||{};return ve.magFilter=be[xe.magFilter]||1006,ve.minFilter=be[xe.minFilter]||1008,ve.wrapS=ce[xe.wrapS]||1e3,ve.wrapT=ce[xe.wrapT]||1e3,gt.associations.set(ve,{type:"textures",index:dt}),ve})},st.prototype.assignTexture=function(dt,gt,mt){var Tt=this;return this.getDependency("texture",mt.index).then(function(et){if(!et.isCompressedTexture)switch(gt){case"aoMap":case"emissiveMap":case"metalnessMap":case"normalMap":case"roughnessMap":et.format=1022}if(mt.texCoord===void 0||mt.texCoord==0||gt==="aoMap"&&mt.texCoord==1||console.warn("THREE.GLTFLoader: Custom UV set "+mt.texCoord+" for texture "+gt+" not yet supported."),Tt.extensions[Ut.KHR_TEXTURE_TRANSFORM]){var ht=mt.extensions!==void 0?mt.extensions[Ut.KHR_TEXTURE_TRANSFORM]:void 0;if(ht){var ct=Tt.associations.get(et);et=Tt.extensions[Ut.KHR_TEXTURE_TRANSFORM].extendTexture(et,ht),Tt.associations.set(et,ct)}}dt[gt]=et})},st.prototype.assignFinalMaterial=function(dt){var gt=dt.geometry,mt=dt.material,Tt=gt.attributes.tangent!==void 0,et=gt.attributes.color!==void 0,ht=gt.attributes.normal===void 0,ct=dt.isSkinnedMesh===!0,St=0<Pi(gt.morphAttributes).length,Gt=St&&gt.morphAttributes.normal!==void 0;if(dt.isPoints){var Qt="PointsMaterial:"+mt.uuid,ft=this.cache.get(Qt);ft||(ft=new us,de.prototype.copy.call(ft,mt),ft.color.copy(mt.color),ft.map=mt.map,ft.sizeAttenuation=!1,this.cache.add(Qt,ft)),mt=ft}else dt.isLine&&(Qt="LineBasicMaterial:"+mt.uuid,ft=this.cache.get(Qt),ft||(ft=new Xi,de.prototype.copy.call(ft,mt),ft.color.copy(mt.color),this.cache.add(Qt,ft)),mt=ft);(Tt||et||ht||ct||St)&&(Qt="ClonedMaterial:"+mt.uuid+":",mt.isGLTFSpecularGlossinessMaterial&&(Qt+="specular-glossiness:"),ct&&(Qt+="skinning:"),Tt&&(Qt+="vertex-tangents:"),et&&(Qt+="vertex-colors:"),ht&&(Qt+="flat-shading:"),St&&(Qt+="morph-targets:"),Gt&&(Qt+="morph-normals:"),ft=this.cache.get(Qt),ft||(ft=mt.clone(),ct&&(ft.skinning=!0),Tt&&(ft.vertexTangents=!0),et&&(ft.vertexColors=!0),ht&&(ft.flatShading=!0),St&&(ft.morphTargets=!0),Gt&&(ft.morphNormals=!0),this.cache.add(Qt,ft),this.associations.set(ft,this.associations.get(mt))),mt=ft),mt.aoMap&&gt.attributes.uv2===void 0&&gt.attributes.uv!==void 0&&gt.setAttribute("uv2",gt.attributes.uv),mt.normalScale&&!Tt&&(mt.normalScale.y=-mt.normalScale.y),mt.clearcoatNormalScale&&!Tt&&(mt.clearcoatNormalScale.y=-mt.clearcoatNormalScale.y),dt.material=mt},st.prototype.loadMaterial=function(dt){var gt=this,mt=this.extensions,Tt=this.json.materials[dt],et={},ht=Tt.extensions||{},ct=[];if(ht[Ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var St=mt[Ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS],Gt=St.getMaterialType();ct.push(St.extendParams(et,Tt,gt))}else if(ht[Ut.KHR_MATERIALS_UNLIT])St=mt[Ut.KHR_MATERIALS_UNLIT],Gt=St.getMaterialType(),ct.push(St.extendParams(et,Tt,gt));else{if(Gt=$n,St=Tt.pbrMetallicRoughness||{},et.color=new Vt(1,1,1),et.opacity=1,Array.isArray(St.baseColorFactor)){var Qt=St.baseColorFactor;et.color.fromArray(Qt),et.opacity=Qt[3]}St.baseColorTexture!==void 0&&ct.push(gt.assignTexture(et,"map",St.baseColorTexture)),et.metalness=St.metallicFactor!==void 0?St.metallicFactor:1,et.roughness=St.roughnessFactor!==void 0?St.roughnessFactor:1,St.metallicRoughnessTexture!==void 0&&(ct.push(gt.assignTexture(et,"metalnessMap",St.metallicRoughnessTexture)),ct.push(gt.assignTexture(et,"roughnessMap",St.metallicRoughnessTexture)))}return Tt.doubleSided===!0&&(et.side=2),St=Tt.alphaMode||"OPAQUE",St==="BLEND"?(et.transparent=!0,et.depthWrite=!1):(et.transparent=!1,St==="MASK"&&(et.alphaTest=Tt.alphaCutoff!==void 0?Tt.alphaCutoff:.5)),Tt.normalTexture!==void 0&&Gt!==Rr&&(ct.push(gt.assignTexture(et,"normalMap",Tt.normalTexture)),et.normalScale=new vt(1,1),Tt.normalTexture.scale!==void 0&&et.normalScale.set(Tt.normalTexture.scale,Tt.normalTexture.scale)),Tt.occlusionTexture!==void 0&&Gt!==Rr&&(ct.push(gt.assignTexture(et,"aoMap",Tt.occlusionTexture)),Tt.occlusionTexture.strength!==void 0&&(et.aoMapIntensity=Tt.occlusionTexture.strength)),Tt.emissiveFactor!==void 0&&Gt!==Rr&&(et.emissive=new Vt().fromArray(Tt.emissiveFactor)),Tt.emissiveTexture!==void 0&&Gt!==Rr&&ct.push(gt.assignTexture(et,"emissiveMap",Tt.emissiveTexture)),ht[Ut.KHR_MATERIALS_CLEARCOAT]&&(St=mt[Ut.KHR_MATERIALS_CLEARCOAT],Gt=St.getMaterialType(),ct.push(St.extendParams(et,{extensions:ht},gt))),xi.all(ct).then(function(){var ft=Gt===S?mt[Ut.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(et):new Gt(et);return Tt.name&&(ft.name=Tt.name),ft.map&&(ft.map.encoding=3001),ft.emissiveMap&&(ft.emissiveMap.encoding=3001),W(ft,Tt),gt.associations.set(ft,{type:"materials",index:dt}),Tt.extensions&&F(mt,ft,Tt),ft})},st.prototype.loadGeometries=function(dt){function gt(ve){return Tt[Ut.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ve,mt).then(function(xe){return At(xe,ve,mt)})}for(var mt=this,Tt=this.extensions,et=this.primitiveCache,ht=[],ct=0,St=dt.length;ct<St;ct++){var Gt=dt[ct],Qt=Z(Gt),ft=et[Qt];ft?ht.push(ft.promise):(ft=Gt.extensions&&Gt.extensions[Ut.KHR_DRACO_MESH_COMPRESSION]?gt(Gt):At(new We,Gt,mt),et[Qt]={primitive:Gt,promise:ft},ht.push(ft))}return xi.all(ht)},st.prototype.loadMesh=function(dt){for(var gt=this,mt=this.json.meshes[dt],Tt=mt.primitives,et=[],ht=0,ct=Tt.length;ht<ct;ht++){var St=Tt[ht].material===void 0?P(this.cache):this.getDependency("material",Tt[ht].material);et.push(St)}return et.push(gt.loadGeometries(Tt)),xi.all(et).then(function(Gt){var Qt=Gt.slice(0,Gt.length-1),ft=Gt[Gt.length-1];Gt=[];for(var ve=0,xe=ft.length;ve<xe;ve++){var me=ft[ve],le=Tt[ve],Ce=Qt[ve];if(le.mode===4||le.mode===5||le.mode===6||le.mode===void 0)me=mt.isSkinnedMesh===!0?new Gs(me,Ce):new Wi(me,Ce),me.isSkinnedMesh!==!0||me.geometry.attributes.skinWeight.normalized||me.normalizeSkinWeights(),le.mode===5?me.geometry=yt(me.geometry,1):le.mode===6&&(me.geometry=yt(me.geometry,2));else if(le.mode===1)me=new pn(me,Ce);else if(le.mode===3)me=new as(me,Ce);else if(le.mode===2)me=new dn(me,Ce);else if(le.mode===0)me=new Ba(me,Ce);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+le.mode);if(0<Pi(me.geometry.morphAttributes).length){le=me;var xr=mt;if(le.updateMorphTargets(),xr.weights!==void 0){Ce=0;for(var Br=xr.weights.length;Ce<Br;Ce++)le.morphTargetInfluences[Ce]=xr.weights[Ce]}if(xr.extras&&Array.isArray(xr.extras.targetNames))if(xr=xr.extras.targetNames,le.morphTargetInfluences.length===xr.length)for(le.morphTargetDictionary={},Ce=0,Br=xr.length;Ce<Br;Ce++)le.morphTargetDictionary[xr[Ce]]=Ce;else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}me.name=mt.name||"mesh_"+dt,1<ft.length&&(me.name+="_"+ve),W(me,mt),gt.assignFinalMaterial(me),Gt.push(me)}if(Gt.length===1)return Gt[0];for(Qt=new Ho,ve=0,xe=Gt.length;ve<xe;ve++)Qt.add(Gt[ve]);return Qt})},st.prototype.loadCamera=function(dt){var gt;dt=this.json.cameras[dt];var mt=dt[dt.type];if(mt)return dt.type==="perspective"?gt=new un(Tr.radToDeg(mt.yfov),mt.aspectRatio||1,mt.znear||1,mt.zfar||2e6):dt.type==="orthographic"&&(gt=new js(-mt.xmag,mt.xmag,mt.ymag,-mt.ymag,mt.znear,mt.zfar)),dt.name&&(gt.name=dt.name),W(gt,dt),xi.resolve(gt);console.warn("THREE.GLTFLoader: Missing camera parameters.")},st.prototype.loadSkin=function(dt){dt=this.json.skins[dt];var gt={joints:dt.joints};return dt.inverseBindMatrices===void 0?xi.resolve(gt):this.getDependency("accessor",dt.inverseBindMatrices).then(function(mt){return gt.inverseBindMatrices=mt,gt})},st.prototype.loadAnimation=function(dt){for(var gt=this.json.animations[dt],mt=[],Tt=[],et=[],ht=[],ct=[],St=0,Gt=gt.channels.length;St<Gt;St++){var Qt=gt.channels[St],ft=gt.samplers[Qt.sampler];Qt=Qt.target;var ve=gt.parameters!==void 0?gt.parameters[ft.input]:ft.input,xe=gt.parameters!==void 0?gt.parameters[ft.output]:ft.output;mt.push(this.getDependency("node",Qt.node!==void 0?Qt.node:Qt.id)),Tt.push(this.getDependency("accessor",ve)),et.push(this.getDependency("accessor",xe)),ht.push(ft),ct.push(Qt)}return xi.all([xi.all(mt),xi.all(Tt),xi.all(et),xi.all(ht),xi.all(ct)]).then(function(me){var le=me[0],Ce=me[1],xr=me[2],Br=me[3];me=me[4];for(var Ae=[],ar=0,Wr=le.length;ar<Wr;ar++){var Ze=le[ar],Sn=Ce[ar],Ai=xr[ar],Fo=Br[ar],Ta=me[ar];if(Ze!==void 0){switch(Ze.updateMatrix(),Ze.matrixAutoUpdate=!0,sr[Ta.path]){case sr.weights:var eh=Ll;break;case sr.rotation:eh=Rh;break;default:eh=Rl}var Ns=Ze.name?Ze.name:Ze.uuid,el=Fo.interpolation!==void 0?ni[Fo.interpolation]:2301,rl=[];if(sr[Ta.path]===sr.weights?Ze.traverse(function(To){To.isMesh===!0&&To.morphTargetInfluences&&rl.push(To.name?To.name:To.uuid)}):rl.push(Ns),Ze=Ai.array,Ai.normalized){if(Ze.constructor===Int8Array)var vs=1/127;else if(Ze.constructor===Uint8Array)vs=1/255;else if(Ze.constructor==Int16Array)vs=1/32767;else if(Ze.constructor===Uint16Array)vs=1/65535;else throw Error("THREE.GLTFLoader: Unsupported output accessor component type.");var iu=new Float32Array(Ze.length);for(Ai=0,Ns=Ze.length;Ai<Ns;Ai++)iu[Ai]=Ze[Ai]*vs;Ze=iu}for(Ai=0,Ns=rl.length;Ai<Ns;Ai++)vs=new eh(rl[Ai]+"."+sr[Ta.path],Sn.array,Ze,el),Fo.interpolation==="CUBICSPLINE"&&(vs.createInterpolant=function(To){return new I(this.times,this.values,this.getValueSize()/3,To)},vs.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Ae.push(vs)}}return new Is(gt.name?gt.name:"animation_"+dt,void 0,Ae)})},st.prototype.loadNode=function(dt){var gt=this.json,mt=this.extensions,Tt=this,et=gt.meshReferences,ht=gt.meshUses,ct=gt.nodes[dt];return function(){var St=[];return ct.mesh!==void 0&&St.push(Tt.getDependency("mesh",ct.mesh).then(function(Gt){if(1<et[ct.mesh]){var Qt=ht[ct.mesh]++;Gt=Gt.clone(),Gt.name+="_instance_"+Qt}return ct.weights!==void 0&&Gt.traverse(function(ft){if(ft.isMesh)for(var ve=0,xe=ct.weights.length;ve<xe;ve++)ft.morphTargetInfluences[ve]=ct.weights[ve]}),Gt})),ct.camera!==void 0&&St.push(Tt.getDependency("camera",ct.camera)),ct.extensions&&ct.extensions[Ut.KHR_LIGHTS_PUNCTUAL]&&ct.extensions[Ut.KHR_LIGHTS_PUNCTUAL].light!==void 0&&St.push(Tt.getDependency("light",ct.extensions[Ut.KHR_LIGHTS_PUNCTUAL].light)),xi.all(St)}().then(function(St){var Gt=ct.isBone===!0?new Kn:1<St.length?new Ho:St.length===1?St[0]:new Ee;if(Gt!==St[0])for(var Qt=0,ft=St.length;Qt<ft;Qt++)Gt.add(St[Qt]);return ct.name&&(Gt.userData.name=ct.name,Gt.name=Wn.sanitizeNodeName(ct.name)),W(Gt,ct),ct.extensions&&F(mt,Gt,ct),ct.matrix!==void 0?(St=new Ie,St.fromArray(ct.matrix),Gt.applyMatrix4(St)):(ct.translation!==void 0&&Gt.position.fromArray(ct.translation),ct.rotation!==void 0&&Gt.quaternion.fromArray(ct.rotation),ct.scale!==void 0&&Gt.scale.fromArray(ct.scale)),Tt.associations.set(Gt,{type:"nodes",index:dt}),Gt})},st.prototype.loadScene=function(){function dt(gt,mt,Tt,et){var ht=Tt.nodes[gt];return et.getDependency("node",gt).then(function(ct){if(ht.skin===void 0)return ct;var St;return et.getDependency("skin",ht.skin).then(function(Gt){St=Gt,Gt=[];for(var Qt=0,ft=St.joints.length;Qt<ft;Qt++)Gt.push(et.getDependency("node",St.joints[Qt]));return xi.all(Gt)}).then(function(Gt){return ct.traverse(function(Qt){if(Qt.isMesh){for(var ft=[],ve=[],xe=0,me=Gt.length;xe<me;xe++){var le=Gt[xe];le?(ft.push(le),le=new Ie,St.inverseBindMatrices!==void 0&&le.fromArray(St.inverseBindMatrices.array,16*xe),ve.push(le)):console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',St.joints[xe])}Qt.bind(new Cs(ft,ve),Qt.matrixWorld)}}),ct})}).then(function(ct){mt.add(ct);var St=[];if(ht.children)for(var Gt=ht.children,Qt=0,ft=Gt.length;Qt<ft;Qt++)St.push(dt(Gt[Qt],ct,Tt,et));return xi.all(St)})}return function(gt){var mt=this.json,Tt=this.extensions;gt=this.json.scenes[gt];var et=new Ho;gt.name&&(et.name=gt.name),W(et,gt),gt.extensions&&F(Tt,et,gt),Tt=gt.nodes||[],gt=[];for(var ht=0,ct=Tt.length;ht<ct;ht++)gt.push(dt(Tt[ht],et,mt,this));return xi.all(gt).then(function(){return et})}}(),t}(),oc={};oc.MTLLoader=zf,oc.OBJLoader=IC,oc.GLTFLoader=EC;var LC=It(function(t,r){r.__esModule=!0;var i=Js&&Js.__esModule?Js:{default:Js};r.default=function(){function s(f,c){for(var g=0;g<c.length;g++){var p=c[g];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),(0,i.default)(f,p.key,p)}}return function(f,c,g){return c&&s(f.prototype,c),g&&s(f,g),f}}()}),tn=zt(LC);Xp(Do.prototype,{equals:function(t){return this.lat===t.lat&&this.lng===t.lng},clone:function(){return new Do(this.lat,this.lng)},getLngSpan:function(t){return t=Math.abs(t-this.lng),180<t&&(t=360-t),t},sub:function(t){return new Do(this.lat-t.lat,this.lng-t.lng)},toString:function(){return"Point"}}),Xp(ba,{EARTHRADIUS:637099681e-2,MCBAND:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],LLBAND:[75,60,45,30,15,0],MC2LL:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],LL2MC:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],getDistanceByMC:function(t,r){if(!t||!r||(t=this.convertMC2LL(t),!t))return 0;var i=this.toRadians(t.lng);if(t=this.toRadians(t.lat),r=this.convertMC2LL(r),!r)return 0;var s=this.toRadians(r.lng);return r=this.toRadians(r.lat),this.getDistance(i,s,t,r)},getDistanceByLL:function(t,r){if(!t||!r)return 0;t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),r.lng=this.getLoop(r.lng,-180,180),r.lat=this.getRange(r.lat,-74,74);var i=this.toRadians(t.lng),s=this.toRadians(t.lat);return t=this.toRadians(r.lng),r=this.toRadians(r.lat),this.getDistance(i,t,s,r)},convertMC2LL:function(t){if(t==null)return new Do(0,0);if(180>t.lng&&-180<t.lng&&90>t.lat&&-90<t.lat)return t;if(window.BMAPGL_84)return new Do(180/Math.PI*(2*Math.atan(Math.exp(t.lat/2003750834e-2*180*Math.PI/180))-Math.PI/2),t.lng/2003750834e-2*180);for(var r=new Do(Math.abs(t.lng),Math.abs(t.lat)),i=0;i<this.MCBAND.length;i++)if(r.lat>=this.MCBAND[i]){var s=this.MC2LL[i];break}return t=this.convertor(t,s),t=new Do(t.lng.toFixed(6),t.lat.toFixed(6))},convertLL2MC:function(t){if(t==null)return new Do(0,0);if(180<t.lng||-180>t.lng||90<t.lat||-90>t.lat)return t;if(window.BMAPGL_84){var r=t.lat*Math.PI/180;return new Do(t.lng*Math.PI/180*6378137,31890685e-1*Math.log((1+Math.sin(r))/(1-Math.sin(r))))}t.lng=this.getLoop(t.lng,-180,180),t.lat=this.getRange(t.lat,-74,74),r=new Do(t.lng,t.lat);for(var i=0;i<this.LLBAND.length;i++)if(r.lat>=this.LLBAND[i]){var s=this.LL2MC[i];break}if(!s){for(i=0;i<this.LLBAND.length;i++)if(r.lat<=-this.LLBAND[i]){s=this.LL2MC[i];break}}return t=this.convertor(t,s),t=new Do(Number(t.lng.toFixed(2)),Number(t.lat.toFixed(2)))},convertor:function(t,r){if(t&&r){var i=r[0]+r[1]*Math.abs(t.lng),s=Math.abs(t.lat)/r[9];return r=r[2]+r[3]*s+r[4]*s*s+r[5]*s*s*s+r[6]*s*s*s*s+r[7]*s*s*s*s*s+r[8]*s*s*s*s*s*s,i*=0>t.lng?-1:1,r*=0>t.lat?-1:1,new Do(i,r)}},getDistance:function(t,r,i,s){return this.EARTHRADIUS*Math.acos(Math.sin(i)*Math.sin(s)+Math.cos(i)*Math.cos(s)*Math.cos(r-t))},toRadians:function(t){return Math.PI*t/180},toDegrees:function(t){return 180*t/Math.PI},getRange:function(t,r,i){return r!=null&&(t=Math.max(t,r)),i!=null&&(t=Math.min(t,i)),t},getLoop:function(t,r,i){for(;t>i;)t-=i-r;for(;t<r;)t+=i-r;return t}}),Xp(ba.prototype,{lngLatToMercator:function(t){return ba.convertLL2MC(t)},lngLatToPoint:function(t){return t=ba.convertLL2MC(t),new Yp(t.lng,t.lat)},mercatorToLngLat:function(t){return ba.convertMC2LL(t)},pointToLngLat:function(t){return t=new Do(t.x,t.y),ba.convertMC2LL(t)},pointToPixel:function(t,r,i,s,f){if(t)return t=this.lngLatToMercator(t,f),r=this.getZoomUnits(r),new Yp(Math.round((t.lng-i.lng)/r+s.width/2),Math.round((i.lat-t.lat)/r+s.height/2))},pixelToPoint:function(t,r,i,s,f){if(t)return r=this.getZoomUnits(r),t=new Do(i.lng+r*(t.x-s.width/2),i.lat-r*(t.y-s.height/2)),this.mercatorToLngLat(t,f)},getZoomUnits:function(t){return Math.pow(2,18-t)}});var RC=It(function(t,r){r.__esModule=!0;var i=kh&&kh.__esModule?kh:{default:kh};r.default=function(s){if(Array.isArray(s)){for(var f=0,c=Array(s.length);f<s.length;f++)c[f]=s[f];return c}return(0,i.default)(s)}}),uw=zt(RC);(function(){function t(){var r=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{};Ri(this,t),this.options=r,this._initialize()}return tn(t,[{key:"_initialize",value:function(){this.points=this.options.points}},{key:"_normalizaCoord",value:function(r){return r?(r instanceof Array&&(r={lng:Number(r[0]),lat:Number(r[1])}),ba.convertLL2MC(r)):null}},{key:"setOptions",value:function(){this.options=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},this._initialize()}},{key:"getPoints",value:function(r){for(var i=[],s=this.points,f=0;f<s.length-1;f++){var c=this.getCurveByTwoPoints(this._normalizaCoord(s[f]),this._normalizaCoord(s[f+1]),r);c&&0<c.length&&(i=i.concat(c))}return i}},{key:"getCurveByTwoPoints",value:function(r,i){var s=2<arguments.length&&arguments[2]!==void 0?arguments[2]:20;if(!r||!i)return null;var f=[],c=0;if((typeof i=="undefined"?"undefined":Zs(i))===void 0)typeof f=="undefined"||Zs(f);else{var g=parseFloat(r.lat),p=parseFloat(i.lat),A=parseFloat(r.lng),S=parseFloat(i.lng);S>A&&180<parseFloat(S-A)&&0>A&&(A=parseFloat(360+A),S=parseFloat(360+S));var N=0;if(p===g)var w=0,I=A-S;else S===A?(w=Math.PI/2,I=g-p):(w=Math.atan((p-g)/(S-A)),I=(p-g)/Math.sin(w));for(N===0&&(N=w+Math.PI/5),I/=2,w=I*Math.cos(N)+A,N=I*Math.sin(N)+g,I=0;I<s+1;I++){var L=A*(1-2*c+c*c)+w*(2*c-2*c*c)+S*c*c,P=i.lng;f.push([0>r.lng&&0<P?L-360:L,g*(1-2*c+c*c)+N*(2*c-2*c*c)+p*c*c]),c+=1/s}return f}}}]),t})();var Xm=void 0,PC=function(){if(Xm!==void 0)return Xm;var t=navigator.userAgent,r="Android;iPhone;SymbianOS;Windows Phone;iPad;iPod".split(";");Xm=!1;for(var i=0;i<r.length;i++)if(0<t.indexOf(r[i])){Xm=!0;break}return Xm}(),Ym=void 0;(function(){if(Ym!==void 0)return Ym;var t=navigator.userAgent,r=["iPhone","iPad","iPod"];Ym=!1;for(var i=0;i<r.length;i++)if(0<t.indexOf(r[i])){Ym=!0;break}return Ym})(),Nl(Array(576)),Nl(Array(60)),Nl(Array(512)),Nl(Array(256)),Nl(Array(29)),Nl(Array(30)),new Uint32Array(function(){for(var t,r=[],i=0;256>i;i++){t=i;for(var s=0;8>s;s++)t=t&1?3988292384^t>>>1:t>>>1;r[i]=t}return r}());try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){}for(var JA=new Uint8Array(256),sc=0;256>sc;sc++)JA[sc]=252<=sc?6:248<=sc?5:240<=sc?4:224<=sc?3:192<=sc?2:1;JA[254]=JA[254]=1;var eu={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]},DC=dd.f;Ja("getOwnPropertyDescriptor",function(){return function(t,r){return DC(ci(t),r)}});var OC=vi.Object,FC=function(t,r){return OC.getOwnPropertyDescriptor(t,r)},BC=It(function(t){t.exports={default:FC,__esModule:!0}}),Zn=zt(BC),Zm=It(function(t){var r=Array.prototype.concat,i=Array.prototype.slice,s=t.exports=function(f){for(var c=[],g=0,p=f.length;g<p;g++){var A=f[g],S=(S=A)&&typeof S!="string"?S instanceof Array||Array.isArray(S)||0<=S.length&&(S.splice instanceof Function||Zn(S,S.length-1)&&S.constructor.name!=="String"):!1;S?c=r.call(c,i.call(A)):c.push(A)}return c};s.wrap=function(f){return function(){return f(s(arguments))}}}),Jm=It(function(t){function r(g,p,A){return Math.min(Math.max(p,g),A)}function i(g){return g=g.toString(16).toUpperCase(),2>g.length?"0"+g:g}var s={},f;for(f in eu)eu.hasOwnProperty(f)&&(s[eu[f]]=f);var c=t.exports={to:{},get:{}};c.get=function(g){switch(g.substring(0,3).toLowerCase()){case"hsl":g=c.get.hsl(g);var p="hsl";break;case"hwb":g=c.get.hwb(g),p="hwb";break;default:g=c.get.rgb(g),p="rgb"}return g?{model:p,value:g}:null},c.get.rgb=function(g){if(!g)return null;var p=/^#([a-f0-9]{3,4})$/i,A=/^rgba?\(\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*,\s*([+-]?\d+)\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,S=/^rgba?\(\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/,N=/(\D+)/,w=[0,0,0,1],I;if(I=g.match(/^#([a-f0-9]{6})([a-f0-9]{2})?$/i)){for(p=I[2],I=I[1],g=0;3>g;g++)A=2*g,w[g]=parseInt(I.slice(A,A+2),16);p&&(w[3]=Math.round(parseInt(p,16)/255*100)/100)}else if(I=g.match(p)){for(I=I[1],p=I[3],g=0;3>g;g++)w[g]=parseInt(I[g]+I[g],16);p&&(w[3]=Math.round(parseInt(p+p,16)/255*100)/100)}else if(I=g.match(A)){for(g=0;3>g;g++)w[g]=parseInt(I[g+1],0);I[4]&&(w[3]=parseFloat(I[4]))}else if(I=g.match(S)){for(g=0;3>g;g++)w[g]=Math.round(2.55*parseFloat(I[g+1]));I[4]&&(w[3]=parseFloat(I[4]))}else return(I=g.match(N))?I[1]==="transparent"?[0,0,0,0]:(w=eu[I[1]],w?(w[3]=1,w):null):null;for(g=0;3>g;g++)w[g]=r(w[g],0,255);return w[3]=r(w[3],0,1),w},c.get.hsl=function(g){if(!g)return null;var p=g.match(/^hsla?\(\s*([+-]?(?:\d*\.)?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);g=(parseFloat(p[1])+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[g,S,p,A]}return null},c.get.hwb=function(g){if(!g)return null;var p=g.match(/^hwb\(\s*([+-]?\d*[\.]?\d+)(?:deg)?\s*,\s*([+-]?[\d\.]+)%\s*,\s*([+-]?[\d\.]+)%\s*(?:,\s*([+-]?[\d\.]+)\s*)?\)$/);if(p){var A=parseFloat(p[4]);g=(parseFloat(p[1])%360+360)%360;var S=r(parseFloat(p[2]),0,100);return p=r(parseFloat(p[3]),0,100),A=r(isNaN(A)?1:A,0,1),[g,S,p,A]}return null},c.to.hex=function(){var g=Zm(arguments);return"#"+i(g[0])+i(g[1])+i(g[2])+(1>g[3]?i(Math.round(255*g[3])):"")},c.to.rgb=function(){var g=Zm(arguments);return 4>g.length||g[3]===1?"rgb("+Math.round(g[0])+", "+Math.round(g[1])+", "+Math.round(g[2])+")":"rgba("+Math.round(g[0])+", "+Math.round(g[1])+", "+Math.round(g[2])+", "+g[3]+")"},c.to.rgb.percent=function(){var g=Zm(arguments),p=Math.round(g[0]/255*100),A=Math.round(g[1]/255*100),S=Math.round(g[2]/255*100);return 4>g.length||g[3]===1?"rgb("+p+"%, "+A+"%, "+S+"%)":"rgba("+p+"%, "+A+"%, "+S+"%, "+g[3]+")"},c.to.hsl=function(){var g=Zm(arguments);return 4>g.length||g[3]===1?"hsl("+g[0]+", "+g[1]+"%, "+g[2]+"%)":"hsla("+g[0]+", "+g[1]+"%, "+g[2]+"%, "+g[3]+")"},c.to.hwb=function(){var g=Zm(arguments),p="";return 4<=g.length&&g[3]!==1&&(p=", "+g[3]),"hwb("+g[0]+", "+g[1]+"%, "+g[2]+"%"+p+")"},c.to.keyword=function(g){return s[g.slice(0,3)]}}),Uf=It(function(t){var r={};for(f in eu)eu.hasOwnProperty(f)&&(r[eu[f]]=f);var i=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}},s;for(s in i)if(i.hasOwnProperty(s)){if(!("channels"in i[s]))throw Error("missing channels property: "+s);if(!("labels"in i[s]))throw Error("missing channel labels property: "+s);if(i[s].labels.length!==i[s].channels)throw Error("channel and label counts mismatch: "+s);t=i[s].channels;var f=i[s].labels;delete i[s].channels,delete i[s].labels,Object.defineProperty(i[s],"channels",{value:t}),Object.defineProperty(i[s],"labels",{value:f})}i.rgb.hsl=function(c){var g=c[0]/255,p=c[1]/255,A=c[2]/255;c=Math.min(g,p,A);var S=Math.max(g,p,A),N=S-c,w;return S===c?w=0:g===S?w=(p-A)/N:p===S?w=2+(A-g)/N:A===S&&(w=4+(g-p)/N),w=Math.min(60*w,360),0>w&&(w+=360),g=(c+S)/2,[w,100*(S===c?0:.5>=g?N/(S+c):N/(2-S-c)),100*g]},i.rgb.hsv=function(c){var g,p=c[0]/255,A=c[1]/255,S=c[2]/255,N=Math.max(p,A,S),w=N-Math.min(p,A,S);if(w===0)var I=g=0;else{g=w/N,c=(N-p)/6/w+.5;var L=(N-A)/6/w+.5;w=(N-S)/6/w+.5,p===N?I=w-L:A===N?I=1/3+c-w:S===N&&(I=2/3+L-c),0>I?I+=1:1<I&&--I}return[360*I,100*g,100*N]},i.rgb.hwb=function(c){var g=c[0],p=c[1],A=c[2];c=i.rgb.hsl(c)[0];var S=1/255*Math.min(g,Math.min(p,A));return A=1-1/255*Math.max(g,Math.max(p,A)),[c,100*S,100*A]},i.rgb.cmyk=function(c){var g=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.min(1-g,1-p,1-c);return[100*((1-g-A)/(1-A)||0),100*((1-p-A)/(1-A)||0),100*((1-c-A)/(1-A)||0),100*A]},i.rgb.keyword=function(c){var g=r[c];if(g)return g;g=1/0;var p;for(p in eu)if(eu.hasOwnProperty(p)){var A=eu[p];if(A=Math.pow(c[0]-A[0],2)+Math.pow(c[1]-A[1],2)+Math.pow(c[2]-A[2],2),A<g){g=A;var S=p}}return S},i.keyword.rgb=function(c){return eu[c]},i.rgb.xyz=function(c){var g=c[0]/255,p=c[1]/255;return c=c[2]/255,g=.04045<g?Math.pow((g+.055)/1.055,2.4):g/12.92,p=.04045<p?Math.pow((p+.055)/1.055,2.4):p/12.92,c=.04045<c?Math.pow((c+.055)/1.055,2.4):c/12.92,[100*(.4124*g+.3576*p+.1805*c),100*(.2126*g+.7152*p+.0722*c),100*(.0193*g+.1192*p+.9505*c)]},i.rgb.lab=function(c){var g=i.rgb.xyz(c);c=g[0];var p=g[1];return g=g[2],c/=95.047,p/=100,g/=108.883,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,[116*p-16,500*(c-p),200*(p-g)]},i.hsl.rgb=function(c){var g=c[0]/360,p=c[1]/100;if(c=c[2]/100,p===0){var A=255*c;return[A,A,A]}p=.5>c?c*(1+p):c+p-c*p,c=2*c-p;for(var S=[0,0,0],N=0;3>N;N++)A=g+1/3*-(N-1),0>A&&A++,1<A&&A--,A=1>6*A?c+6*(p-c)*A:1>2*A?p:2>3*A?c+(p-c)*(2/3-A)*6:c,S[N]=255*A;return S},i.hsl.hsv=function(c){var g=c[0],p=c[1]/100;c=c[2]/100;var A=p,S=Math.max(c,.01);return c*=2,p*=1>=c?c:2-c,A*=1>=S?S:2-S,[g,100*(c===0?2*A/(S+A):2*p/(c+p)),(c+p)/2*100]},i.hsv.rgb=function(c){var g=c[0]/60,p=c[1]/100;c=c[2]/100;var A=Math.floor(g)%6,S=g-Math.floor(g);g=255*c*(1-p);var N=255*c*(1-p*S);switch(p=255*c*(1-p*(1-S)),c*=255,A){case 0:return[c,p,g];case 1:return[N,c,g];case 2:return[g,c,p];case 3:return[g,N,c];case 4:return[p,g,c];case 5:return[c,g,N]}},i.hsv.hsl=function(c){var g=c[0],p=c[1]/100;c=c[2]/100;var A=Math.max(c,.01),S=(2-p)*A;return A=p*A/(1>=S?S:2-S)||0,[g,100*A,(2-p)*c/2*100]},i.hwb.rgb=function(c){var g=c[0]/360,p=c[1]/100;c=c[2]/100;var A=p+c;switch(1<A&&(p/=A,c/=A),A=Math.floor(6*g),c=1-c,g=6*g-A,A&1&&(g=1-g),g=p+g*(c-p),A){default:case 6:case 0:A=c;var S=g;break;case 1:A=g,S=c;break;case 2:A=p,S=c,p=g;break;case 3:A=p,S=g,p=c;break;case 4:A=g,S=p,p=c;break;case 5:A=c,S=p,p=g}return[255*A,255*S,255*p]},i.cmyk.rgb=function(c){var g=c[3]/100;return[255*(1-Math.min(1,c[0]/100*(1-g)+g)),255*(1-Math.min(1,c[1]/100*(1-g)+g)),255*(1-Math.min(1,c[2]/100*(1-g)+g))]},i.xyz.rgb=function(c){var g=c[0]/100,p=c[1]/100,A=c[2]/100;c=3.2406*g+-1.5372*p+-.4986*A;var S=-.9689*g+1.8758*p+.0415*A;return g=.0557*g+-.204*p+1.057*A,c=.0031308<c?1.055*Math.pow(c,1/2.4)-.055:12.92*c,S=.0031308<S?1.055*Math.pow(S,1/2.4)-.055:12.92*S,g=.0031308<g?1.055*Math.pow(g,1/2.4)-.055:12.92*g,c=Math.min(Math.max(0,c),1),S=Math.min(Math.max(0,S),1),g=Math.min(Math.max(0,g),1),[255*c,255*S,255*g]},i.xyz.lab=function(c){var g=c[0],p=c[1];return c=c[2],g/=95.047,p/=100,c/=108.883,g=.008856<g?Math.pow(g,1/3):7.787*g+16/116,p=.008856<p?Math.pow(p,1/3):7.787*p+16/116,c=.008856<c?Math.pow(c,1/3):7.787*c+16/116,[116*p-16,500*(g-p),200*(p-c)]},i.lab.xyz=function(c){var g=c[1],p=c[2];c=(c[0]+16)/116,g=g/500+c,p=c-p/200;var A=Math.pow(c,3),S=Math.pow(g,3),N=Math.pow(p,3);return[95.047*(.008856<S?S:(g-16/116)/7.787),100*(.008856<A?A:(c-16/116)/7.787),108.883*(.008856<N?N:(p-16/116)/7.787)]},i.lab.lch=function(c){var g=c[0],p=c[1];c=c[2];var A=360*Math.atan2(c,p)/2/Math.PI;return 0>A&&(A+=360),[g,Math.sqrt(p*p+c*c),A]},i.lch.lab=function(c){var g=c[0],p=c[1];return c=c[2]/360*2*Math.PI,[g,p*Math.cos(c),p*Math.sin(c)]},i.rgb.ansi16=function(c){var g=c[0],p=c[1],A=c[2],S=1 in arguments?arguments[1]:i.rgb.hsv(c)[2];return S=Math.round(S/50),S===0?30:(g=30+(Math.round(A/255)<<2|Math.round(p/255)<<1|Math.round(g/255)),S===2&&(g+=60),g)},i.hsv.ansi16=function(c){return i.rgb.ansi16(i.hsv.rgb(c),c[2])},i.rgb.ansi256=function(c){var g=c[0],p=c[1];return c=c[2],g===p&&p===c?8>g?16:248<g?231:Math.round((g-8)/247*24)+232:16+36*Math.round(g/255*5)+6*Math.round(p/255*5)+Math.round(c/255*5)},i.ansi16.rgb=function(c){var g=c%10;return g===0||g===7?(50<c&&(g+=3.5),g=g/10.5*255,[g,g,g]):(c=.5*(~~(50<c)+1),[(g&1)*c*255,(g>>1&1)*c*255,(g>>2&1)*c*255])},i.ansi256.rgb=function(c){if(232<=c){var g=10*(c-232)+8;return[g,g,g]}c-=16,g=Math.floor(c/36)/5*255;var p=Math.floor((c%=36)/6)/5*255;return[g,p,c%6/5*255]},i.rgb.hex=function(c){return c=(((Math.round(c[0])&255)<<16)+((Math.round(c[1])&255)<<8)+(Math.round(c[2])&255)).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.hex.rgb=function(c){if(c=c.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i),!c)return[0,0,0];var g=c[0];return c[0].length===3&&(g=g.split("").map(function(p){return p+p}).join("")),c=parseInt(g,16),[c>>16&255,c>>8&255,c&255]},i.rgb.hcg=function(c){var g=c[0]/255,p=c[1]/255;c=c[2]/255;var A=Math.max(Math.max(g,p),c),S=Math.min(Math.min(g,p),c),N=A-S;return[(0>=N?0:A===g?(p-c)/N%6:A===p?2+(c-g)/N:(g-p)/N+8)/6%1*360,100*N,100*(1>N?S/(1-N):0)]},i.hsl.hcg=function(c){var g=c[1]/100,p=c[2]/100,A=0;return g=.5>p?2*g*p:2*g*(1-p),1>g&&(A=(p-.5*g)/(1-g)),[c[0],100*g,100*A]},i.hsv.hcg=function(c){var g=c[2]/100,p=c[1]/100*g,A=0;return 1>p&&(A=(g-p)/(1-p)),[c[0],100*p,100*A]},i.hcg.rgb=function(c){var g=c[1]/100,p=c[2]/100;if(g===0)return[255*p,255*p,255*p];var A=[0,0,0];c=c[0]/360%1*6;var S=c%1,N=1-S;switch(Math.floor(c)){case 0:A[0]=1,A[1]=S,A[2]=0;break;case 1:A[0]=N,A[1]=1,A[2]=0;break;case 2:A[0]=0,A[1]=1,A[2]=S;break;case 3:A[0]=0,A[1]=N,A[2]=1;break;case 4:A[0]=S,A[1]=0,A[2]=1;break;default:A[0]=1,A[1]=0,A[2]=N}return p*=1-g,[255*(g*A[0]+p),255*(g*A[1]+p),255*(g*A[2]+p)]},i.hcg.hsv=function(c){var g=c[1]/100,p=g+c[2]/100*(1-g),A=0;return 0<p&&(A=g/p),[c[0],100*A,100*p]},i.hcg.hsl=function(c){var g=c[1]/100,p=c[2]/100*(1-g)+.5*g,A=0;return 0<p&&.5>p?A=g/(2*p):.5<=p&&1>p&&(A=g/(2*(1-p))),[c[0],100*A,100*p]},i.hcg.hwb=function(c){var g=c[1]/100,p=g+c[2]/100*(1-g);return[c[0],100*(p-g),100*(1-p)]},i.hwb.hcg=function(c){var g=1-c[2]/100,p=g-c[1]/100,A=0;return 1>p&&(A=(g-p)/(1-p)),[c[0],100*p,100*A]},i.apple.rgb=function(c){return[c[0]/65535*255,c[1]/65535*255,c[2]/65535*255]},i.rgb.apple=function(c){return[c[0]/255*65535,c[1]/255*65535,c[2]/255*65535]},i.gray.rgb=function(c){return[c[0]/100*255,c[0]/100*255,c[0]/100*255]},i.gray.hsl=i.gray.hsv=function(c){return[0,0,c[0]]},i.gray.hwb=function(c){return[0,100,c[0]]},i.gray.cmyk=function(c){return[0,0,0,c[0]]},i.gray.lab=function(c){return[c[0],0,0]},i.gray.hex=function(c){return c=Math.round(c[0]/100*255)&255,c=((c<<16)+(c<<8)+c).toString(16).toUpperCase(),"000000".substring(c.length)+c},i.rgb.gray=function(c){return[(c[0]+c[1]+c[2])/3/255*100]}}),NC=function(t){for(var r={},i=Pi(Uf),s=i.length,f=0;f<s;f++)r[i[f]]={distance:-1,parent:null};for(i=[t],r[t].distance=0;i.length;){t=i.pop(),s=Pi(Uf[t]),f=s.length;for(var c=0;c<f;c++){var g=s[c],p=r[g];p.distance===-1&&(p.distance=r[t].distance+1,p.parent=t,i.unshift(g))}}for(i={},t=Pi(r),s=t.length,f=0;f<s;f++){var A=t[f];if(r[A].parent!==null){c=A,g=r,p=[g[A].parent,A];var S=Uf[g[A].parent][A];for(A=g[A].parent;g[A].parent;)p.unshift(g[A].parent),S=em(Uf[g[A].parent][A],S),A=g[A].parent;S.conversion=p,i[c]=S}}return i},Bd={};Pi(Uf).forEach(function(t){Bd[t]={},Object.defineProperty(Bd[t],"channels",{value:Uf[t].channels}),Object.defineProperty(Bd[t],"labels",{value:Uf[t].labels});var r=NC(t);Pi(r).forEach(function(i){var s=r[i];Bd[t][i]=k0(s),Bd[t][i].raw=H0(s)})});var $s=Bd,qA=[].slice,lw=["keyword","gray","hex"],KA={};Pi($s).forEach(function(t){KA[qA.call($s[t].labels).sort().join("")]=t});var oy={};to.prototype={toString:function(){return this.string()},toJSON:function(){return this[this.model]()},string:function(t){var r=this.model in Jm.to?this:this.rgb();return r=r.round(typeof t=="number"?t:1),t=r.valpha===1?r.color:r.color.concat(this.valpha),Jm.to[r.model](t)},percentString:function(t){return t=this.rgb().round(typeof t=="number"?t:1),t=t.valpha===1?t.color:t.color.concat(this.valpha),Jm.to.rgb.percent(t)},array:function(){return this.valpha===1?this.color.slice():this.color.concat(this.valpha)},object:function(){for(var t={},r=$s[this.model].channels,i=$s[this.model].labels,s=0;s<r;s++)t[i[s]]=this.color[s];return this.valpha!==1&&(t.alpha=this.valpha),t},unitArray:function(){var t=this.rgb().color;return t[0]/=255,t[1]/=255,t[2]/=255,this.valpha!==1&&t.push(this.valpha),t},unitObject:function(){var t=this.rgb().object();return t.r/=255,t.g/=255,t.b/=255,this.valpha!==1&&(t.alpha=this.valpha),t},round:function(t){return t=Math.max(t||0,0),new to(this.color.map(G0(t)).concat(this.valpha),this.model)},alpha:function(t){return arguments.length?new to(this.color.concat(Math.max(0,Math.min(1,t))),this.model):this.valpha},red:yn("rgb",0,xn(255)),green:yn("rgb",1,xn(255)),blue:yn("rgb",2,xn(255)),hue:yn(["hsl","hsv","hsl","hwb","hcg"],0,function(t){return(t%360+360)%360}),saturationl:yn("hsl",1,xn(100)),lightness:yn("hsl",2,xn(100)),saturationv:yn("hsv",1,xn(100)),value:yn("hsv",2,xn(100)),chroma:yn("hcg",1,xn(100)),gray:yn("hcg",2,xn(100)),white:yn("hwb",1,xn(100)),wblack:yn("hwb",2,xn(100)),cyan:yn("cmyk",0,xn(100)),magenta:yn("cmyk",1,xn(100)),yellow:yn("cmyk",2,xn(100)),black:yn("cmyk",3,xn(100)),x:yn("xyz",0,xn(100)),y:yn("xyz",1,xn(100)),z:yn("xyz",2,xn(100)),l:yn("lab",0,xn(100)),a:yn("lab",1),b:yn("lab",2),keyword:function(t){return arguments.length?new to(t):$s[this.model].keyword(this.color)},hex:function(t){return arguments.length?new to(t):Jm.to.hex(this.rgb().round().color)},rgbNumber:function(){var t=this.rgb().color;return(t[0]&255)<<16|(t[1]&255)<<8|t[2]&255},luminosity:function(){for(var t=this.rgb().color,r=[],i=0;i<t.length;i++){var s=t[i]/255;r[i]=.03928>=s?s/12.92:Math.pow((s+.055)/1.055,2.4)}return .2126*r[0]+.7152*r[1]+.0722*r[2]},contrast:function(t){var r=this.luminosity();return t=t.luminosity(),r>t?(r+.05)/(t+.05):(t+.05)/(r+.05)},level:function(t){return t=this.contrast(t),7.1<=t?"AAA":4.5<=t?"AA":""},isDark:function(){var t=this.rgb().color;return 128>(299*t[0]+587*t[1]+114*t[2])/1e3},isLight:function(){return!this.isDark()},negate:function(){for(var t=this.rgb(),r=0;3>r;r++)t.color[r]=255-t.color[r];return t},lighten:function(t){var r=this.hsl();return r.color[2]+=r.color[2]*t,r},darken:function(t){var r=this.hsl();return r.color[2]-=r.color[2]*t,r},saturate:function(t){var r=this.hsl();return r.color[1]+=r.color[1]*t,r},desaturate:function(t){var r=this.hsl();return r.color[1]-=r.color[1]*t,r},whiten:function(t){var r=this.hwb();return r.color[1]+=r.color[1]*t,r},blacken:function(t){var r=this.hwb();return r.color[2]+=r.color[2]*t,r},grayscale:function(){var t=this.rgb().color;return t=.3*t[0]+.59*t[1]+.11*t[2],to.rgb(t,t,t)},fade:function(t){return this.alpha(this.valpha-this.valpha*t)},opaquer:function(t){return this.alpha(this.valpha+this.valpha*t)},rotate:function(t){var r=this.hsl(),i=r.color[0];return i=(i+t)%360,r.color[0]=0>i?360+i:i,r},mix:function(t,r){if(!t||!t.rgb)throw Error('Argument to "mix" was not a Color instance, but rather an instance of '+(typeof t=="undefined"?"undefined":Zs(t)));t=t.rgb();var i=this.rgb();r=r===void 0?.5:r;var s=2*r-1,f=t.alpha()-i.alpha();return s=((s*f===-1?s:(s+f)/(1+s*f))+1)/2,f=1-s,to.rgb(s*t.red()+f*i.red(),s*t.green()+f*i.green(),s*t.blue()+f*i.blue(),t.alpha()*r+i.alpha()*(1-r))}},Pi($s).forEach(function(t){if(lw.indexOf(t)===-1){var r=$s[t].channels;to.prototype[t]=function(){if(this.model===t)return new to(this);if(arguments.length)return new to(arguments,t);var i=typeof arguments[r]=="number"?r:this.valpha,s=$s[this.model][t].raw(this.color);return s=Array.isArray(s)?s:[s],new to(s.concat(i),t)},to[t]=function(i){return typeof i=="number"&&(i=rm(qA.call(arguments),r)),new to(i,t)}}});var ru=It(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.setMatrixArrayType=function(c){r.ARRAY_TYPE=s=c},r.toRadian=function(c){return c*f},r.equals=function(c,g){return Math.abs(c-g)<=i*Math.max(1,Math.abs(c),Math.abs(g))},r.RANDOM=r.ARRAY_TYPE=r.EPSILON=void 0;var i=1e-6;r.EPSILON=i;var s=typeof Float32Array!="undefined"?Float32Array:Array;r.ARRAY_TYPE=s,r.RANDOM=Math.random;var f=Math.PI/180});zt(ru);var hw=It(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2];g=g[3];var w=p[0],I=p[1],L=p[2];return p=p[3],c[0]=A*w+N*I,c[1]=S*w+g*I,c[2]=A*L+N*p,c[3]=S*L+g*p,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(4);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var g=new f.ARRAY_TYPE(4);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c},r.fromValues=function(c,g,p,A){var S=new f.ARRAY_TYPE(4);return S[0]=c,S[1]=g,S[2]=p,S[3]=A,S},r.set=function(c,g,p,A,S){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c},r.transpose=function(c,g){if(c===g){var p=g[1];c[1]=g[2],c[2]=p}else c[0]=g[0],c[1]=g[2],c[2]=g[1],c[3]=g[3];return c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2];g=g[3];var N=p*g-S*A;return N?(N=1/N,c[0]=g*N,c[1]=-A*N,c[2]=-S*N,c[3]=p*N,c):null},r.adjoint=function(c,g){var p=g[0];return c[0]=g[3],c[1]=-g[1],c[2]=-g[2],c[3]=p,c},r.determinant=function(c){return c[0]*c[3]-c[2]*c[1]},r.multiply=i,r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2];g=g[3];var w=Math.sin(p);return p=Math.cos(p),c[0]=A*p+N*w,c[1]=S*p+g*w,c[2]=A*-w+N*p,c[3]=S*-w+g*p,c},r.scale=function(c,g,p){var A=g[1],S=g[2],N=g[3],w=p[0];return p=p[1],c[0]=g[0]*w,c[1]=A*w,c[2]=S*p,c[3]=N*p,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=-p,c[3]=g,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=g[1],c},r.str=function(c){return"mat2("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2))},r.LDU=function(c,g,p,A){return c[2]=A[2]/A[0],p[0]=A[0],p[1]=A[1],p[3]=A[3]-c[2]*p[1],[c,g,p]},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c},r.subtract=s,r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2];c=c[3];var N=g[0],w=g[1],I=g[2];return g=g[3],Math.abs(p-N)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(N))&&Math.abs(A-w)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(w))&&Math.abs(S-I)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(I))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=Hn&&Zn?Zn(c,p):{};A.get||A.set?Hn(g,p,A):g[p]=c[p]}}return g.default=c,g}(ru);r.mul=i,r.sub=s});zt(hw);var cw=It(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4];g=g[5];var L=p[0],P=p[1],F=p[2],W=p[3],X=p[4];return p=p[5],c[0]=A*L+N*P,c[1]=S*L+w*P,c[2]=A*F+N*W,c[3]=S*F+w*W,c[4]=A*X+N*p+I,c[5]=S*X+w*p+g,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c[4]=g[4]-p[4],c[5]=g[5]-p[5],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(6);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[4]=0,c[5]=0),c[0]=1,c[3]=1,c},r.clone=function(c){var g=new f.ARRAY_TYPE(6);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g[4]=c[4],g[5]=c[5],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c[4]=g[4],c[5]=g[5],c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=0,c[5]=0,c},r.fromValues=function(c,g,p,A,S,N){var w=new f.ARRAY_TYPE(6);return w[0]=c,w[1]=g,w[2]=p,w[3]=A,w[4]=S,w[5]=N,w},r.set=function(c,g,p,A,S,N,w){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c[4]=N,c[5]=w,c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],w=g[4];g=g[5];var I=p*N-A*S;return I?(I=1/I,c[0]=N*I,c[1]=-A*I,c[2]=-S*I,c[3]=p*I,c[4]=(S*g-N*w)*I,c[5]=(A*w-p*g)*I,c):null},r.determinant=function(c){return c[0]*c[3]-c[1]*c[2]},r.multiply=i,r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4];g=g[5];var L=Math.sin(p);return p=Math.cos(p),c[0]=A*p+N*L,c[1]=S*p+w*L,c[2]=A*-L+N*p,c[3]=S*-L+w*p,c[4]=I,c[5]=g,c},r.scale=function(c,g,p){var A=g[1],S=g[2],N=g[3],w=g[4],I=g[5],L=p[0];return p=p[1],c[0]=g[0]*L,c[1]=A*L,c[2]=S*p,c[3]=N*p,c[4]=w,c[5]=I,c},r.translate=function(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4];g=g[5];var L=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=N,c[3]=w,c[4]=A*L+N*p+I,c[5]=S*L+w*p+g,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=-p,c[3]=g,c[4]=0,c[5]=0,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=g[1],c[4]=0,c[5]=0,c},r.fromTranslation=function(c,g){return c[0]=1,c[1]=0,c[2]=0,c[3]=1,c[4]=g[0],c[5]=g[1],c},r.str=function(c){return"mat2d("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+1)},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c[4]=g[4]+p[4],c[5]=g[5]+p[5],c},r.subtract=s,r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c[4]=g[4]*p,c[5]=g[5]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c[4]=g[4]+p[4]*A,c[5]=g[5]+p[5]*A,c},r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]&&c[4]===g[4]&&c[5]===g[5]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2],N=c[3],w=c[4];c=c[5];var I=g[0],L=g[1],P=g[2],F=g[3],W=g[4];return g=g[5],Math.abs(p-I)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(I))&&Math.abs(A-L)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(L))&&Math.abs(S-P)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(P))&&Math.abs(N-F)<=f.EPSILON*Math.max(1,Math.abs(N),Math.abs(F))&&Math.abs(w-W)<=f.EPSILON*Math.max(1,Math.abs(w),Math.abs(W))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=Hn&&Zn?Zn(c,p):{};A.get||A.set?Hn(g,p,A):g[p]=c[p]}}return g.default=c,g}(ru);r.mul=i,r.sub=s});zt(cw);var QA=It(function(t,r){function i(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=p[0],X=p[1],Z=p[2],tt=p[3],st=p[4],xt=p[5],At=p[6],yt=p[7];return p=p[8],c[0]=W*A+X*w+Z*P,c[1]=W*S+X*I+Z*F,c[2]=W*N+X*L+Z*g,c[3]=tt*A+st*w+xt*P,c[4]=tt*S+st*I+xt*F,c[5]=tt*N+st*L+xt*g,c[6]=At*A+yt*w+p*P,c[7]=At*S+yt*I+p*F,c[8]=At*N+yt*L+p*g,c}function s(c,g,p){return c[0]=g[0]-p[0],c[1]=g[1]-p[1],c[2]=g[2]-p[2],c[3]=g[3]-p[3],c[4]=g[4]-p[4],c[5]=g[5]-p[5],c[6]=g[6]-p[6],c[7]=g[7]-p[7],c[8]=g[8]-p[8],c}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var c=new f.ARRAY_TYPE(9);return f.ARRAY_TYPE!=Float32Array&&(c[1]=0,c[2]=0,c[3]=0,c[5]=0,c[6]=0,c[7]=0),c[0]=1,c[4]=1,c[8]=1,c},r.fromMat4=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[4],c[4]=g[5],c[5]=g[6],c[6]=g[8],c[7]=g[9],c[8]=g[10],c},r.clone=function(c){var g=new f.ARRAY_TYPE(9);return g[0]=c[0],g[1]=c[1],g[2]=c[2],g[3]=c[3],g[4]=c[4],g[5]=c[5],g[6]=c[6],g[7]=c[7],g[8]=c[8],g},r.copy=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=g[2],c[3]=g[3],c[4]=g[4],c[5]=g[5],c[6]=g[6],c[7]=g[7],c[8]=g[8],c},r.fromValues=function(c,g,p,A,S,N,w,I,L){var P=new f.ARRAY_TYPE(9);return P[0]=c,P[1]=g,P[2]=p,P[3]=A,P[4]=S,P[5]=N,P[6]=w,P[7]=I,P[8]=L,P},r.set=function(c,g,p,A,S,N,w,I,L,P){return c[0]=g,c[1]=p,c[2]=A,c[3]=S,c[4]=N,c[5]=w,c[6]=I,c[7]=L,c[8]=P,c},r.identity=function(c){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.transpose=function(c,g){if(c===g){var p=g[1],A=g[2],S=g[5];c[1]=g[3],c[2]=g[6],c[3]=p,c[5]=g[7],c[6]=A,c[7]=S}else c[0]=g[0],c[1]=g[3],c[2]=g[6],c[3]=g[1],c[4]=g[4],c[5]=g[7],c[6]=g[2],c[7]=g[5],c[8]=g[8];return c},r.invert=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],w=g[4],I=g[5],L=g[6],P=g[7];g=g[8];var F=g*w-I*P,W=-g*N+I*L,X=P*N-w*L,Z=p*F+A*W+S*X;return Z?(Z=1/Z,c[0]=F*Z,c[1]=(-g*A+S*P)*Z,c[2]=(I*A-S*w)*Z,c[3]=W*Z,c[4]=(g*p-S*L)*Z,c[5]=(-I*p+S*N)*Z,c[6]=X*Z,c[7]=(-P*p+A*L)*Z,c[8]=(w*p-A*N)*Z,c):null},r.adjoint=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],w=g[4],I=g[5],L=g[6],P=g[7];return g=g[8],c[0]=w*g-I*P,c[1]=S*P-A*g,c[2]=A*I-S*w,c[3]=I*L-N*g,c[4]=p*g-S*L,c[5]=S*N-p*I,c[6]=N*P-w*L,c[7]=A*L-p*P,c[8]=p*w-A*N,c},r.determinant=function(c){var g=c[3],p=c[4],A=c[5],S=c[6],N=c[7],w=c[8];return c[0]*(w*p-A*N)+c[1]*(-w*g+A*S)+c[2]*(N*g-p*S)},r.multiply=i,r.translate=function(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=p[0];return p=p[1],c[0]=A,c[1]=S,c[2]=N,c[3]=w,c[4]=I,c[5]=L,c[6]=W*A+p*w+P,c[7]=W*S+p*I+F,c[8]=W*N+p*L+g,c},r.rotate=function(c,g,p){var A=g[0],S=g[1],N=g[2],w=g[3],I=g[4],L=g[5],P=g[6],F=g[7];g=g[8];var W=Math.sin(p);return p=Math.cos(p),c[0]=p*A+W*w,c[1]=p*S+W*I,c[2]=p*N+W*L,c[3]=p*w-W*A,c[4]=p*I-W*S,c[5]=p*L-W*N,c[6]=P,c[7]=F,c[8]=g,c},r.scale=function(c,g,p){var A=p[0];return p=p[1],c[0]=A*g[0],c[1]=A*g[1],c[2]=A*g[2],c[3]=p*g[3],c[4]=p*g[4],c[5]=p*g[5],c[6]=g[6],c[7]=g[7],c[8]=g[8],c},r.fromTranslation=function(c,g){return c[0]=1,c[1]=0,c[2]=0,c[3]=0,c[4]=1,c[5]=0,c[6]=g[0],c[7]=g[1],c[8]=1,c},r.fromRotation=function(c,g){var p=Math.sin(g);return g=Math.cos(g),c[0]=g,c[1]=p,c[2]=0,c[3]=-p,c[4]=g,c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromScaling=function(c,g){return c[0]=g[0],c[1]=0,c[2]=0,c[3]=0,c[4]=g[1],c[5]=0,c[6]=0,c[7]=0,c[8]=1,c},r.fromMat2d=function(c,g){return c[0]=g[0],c[1]=g[1],c[2]=0,c[3]=g[2],c[4]=g[3],c[5]=0,c[6]=g[4],c[7]=g[5],c[8]=1,c},r.fromQuat=function(c,g){var p=g[0],A=g[1],S=g[2];g=g[3];var N=p+p,w=A+A,I=S+S;p*=N;var L=A*N;A*=w;var P=S*N,F=S*w;return S*=I,N*=g,w*=g,g*=I,c[0]=1-A-S,c[3]=L-g,c[6]=P+w,c[1]=L+g,c[4]=1-p-S,c[7]=F-N,c[2]=P-w,c[5]=F+N,c[8]=1-p-A,c},r.normalFromMat4=function(c,g){var p=g[0],A=g[1],S=g[2],N=g[3],w=g[4],I=g[5],L=g[6],P=g[7],F=g[8],W=g[9],X=g[10],Z=g[11],tt=g[12],st=g[13],xt=g[14];g=g[15];var At=p*I-A*w,yt=p*L-S*w,Ut=p*P-N*w,kt=A*L-S*I,ne=A*P-N*I,Wt=S*P-N*L,re=F*st-W*tt,be=F*xt-X*tt;F=F*g-Z*tt;var ce=W*xt-X*st;return W=W*g-Z*st,X=X*g-Z*xt,Z=At*X-yt*W+Ut*ce+kt*F-ne*be+Wt*re,Z?(Z=1/Z,c[0]=(I*X-L*W+P*ce)*Z,c[1]=(L*F-w*X-P*be)*Z,c[2]=(w*W-I*F+P*re)*Z,c[3]=(S*W-A*X-N*ce)*Z,c[4]=(p*X-S*F+N*be)*Z,c[5]=(A*F-p*W-N*re)*Z,c[6]=(st*Wt-xt*ne+g*kt)*Z,c[7]=(xt*Ut-tt*Wt-g*yt)*Z,c[8]=(tt*ne-st*Ut+g*At)*Z,c):null},r.projection=function(c,g,p){return c[0]=2/g,c[1]=0,c[2]=0,c[3]=0,c[4]=-2/p,c[5]=0,c[6]=-1,c[7]=1,c[8]=1,c},r.str=function(c){return"mat3("+c[0]+", "+c[1]+", "+c[2]+", "+c[3]+", "+c[4]+", "+c[5]+", "+c[6]+", "+c[7]+", "+c[8]+")"},r.frob=function(c){return Math.sqrt(Math.pow(c[0],2)+Math.pow(c[1],2)+Math.pow(c[2],2)+Math.pow(c[3],2)+Math.pow(c[4],2)+Math.pow(c[5],2)+Math.pow(c[6],2)+Math.pow(c[7],2)+Math.pow(c[8],2))},r.add=function(c,g,p){return c[0]=g[0]+p[0],c[1]=g[1]+p[1],c[2]=g[2]+p[2],c[3]=g[3]+p[3],c[4]=g[4]+p[4],c[5]=g[5]+p[5],c[6]=g[6]+p[6],c[7]=g[7]+p[7],c[8]=g[8]+p[8],c},r.subtract=s,r.multiplyScalar=function(c,g,p){return c[0]=g[0]*p,c[1]=g[1]*p,c[2]=g[2]*p,c[3]=g[3]*p,c[4]=g[4]*p,c[5]=g[5]*p,c[6]=g[6]*p,c[7]=g[7]*p,c[8]=g[8]*p,c},r.multiplyScalarAndAdd=function(c,g,p,A){return c[0]=g[0]+p[0]*A,c[1]=g[1]+p[1]*A,c[2]=g[2]+p[2]*A,c[3]=g[3]+p[3]*A,c[4]=g[4]+p[4]*A,c[5]=g[5]+p[5]*A,c[6]=g[6]+p[6]*A,c[7]=g[7]+p[7]*A,c[8]=g[8]+p[8]*A,c},r.exactEquals=function(c,g){return c[0]===g[0]&&c[1]===g[1]&&c[2]===g[2]&&c[3]===g[3]&&c[4]===g[4]&&c[5]===g[5]&&c[6]===g[6]&&c[7]===g[7]&&c[8]===g[8]},r.equals=function(c,g){var p=c[0],A=c[1],S=c[2],N=c[3],w=c[4],I=c[5],L=c[6],P=c[7];c=c[8];var F=g[0],W=g[1],X=g[2],Z=g[3],tt=g[4],st=g[5],xt=g[6],At=g[7];return g=g[8],Math.abs(p-F)<=f.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(A-W)<=f.EPSILON*Math.max(1,Math.abs(A),Math.abs(W))&&Math.abs(S-X)<=f.EPSILON*Math.max(1,Math.abs(S),Math.abs(X))&&Math.abs(N-Z)<=f.EPSILON*Math.max(1,Math.abs(N),Math.abs(Z))&&Math.abs(w-tt)<=f.EPSILON*Math.max(1,Math.abs(w),Math.abs(tt))&&Math.abs(I-st)<=f.EPSILON*Math.max(1,Math.abs(I),Math.abs(st))&&Math.abs(L-xt)<=f.EPSILON*Math.max(1,Math.abs(L),Math.abs(xt))&&Math.abs(P-At)<=f.EPSILON*Math.max(1,Math.abs(P),Math.abs(At))&&Math.abs(c-g)<=f.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))},r.sub=r.mul=void 0;var f=function(c){if(c&&c.__esModule)return c;var g={};if(c!=null){for(var p in c)if(Object.prototype.hasOwnProperty.call(c,p)){var A=Hn&&Zn?Zn(c,p):{};A.get||A.set?Hn(g,p,A):g[p]=c[p]}}return g.default=c,g}(ru);r.mul=i,r.sub=s});zt(QA);var $A=It(function(t,r){function i(p){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p}function s(p,A,S){var N=A[0],w=A[1],I=A[2],L=A[3],P=A[4],F=A[5],W=A[6],X=A[7],Z=A[8],tt=A[9],st=A[10],xt=A[11],At=A[12],yt=A[13],Ut=A[14];A=A[15];var kt=S[0],ne=S[1],Wt=S[2],re=S[3];return p[0]=kt*N+ne*P+Wt*Z+re*At,p[1]=kt*w+ne*F+Wt*tt+re*yt,p[2]=kt*I+ne*W+Wt*st+re*Ut,p[3]=kt*L+ne*X+Wt*xt+re*A,kt=S[4],ne=S[5],Wt=S[6],re=S[7],p[4]=kt*N+ne*P+Wt*Z+re*At,p[5]=kt*w+ne*F+Wt*tt+re*yt,p[6]=kt*I+ne*W+Wt*st+re*Ut,p[7]=kt*L+ne*X+Wt*xt+re*A,kt=S[8],ne=S[9],Wt=S[10],re=S[11],p[8]=kt*N+ne*P+Wt*Z+re*At,p[9]=kt*w+ne*F+Wt*tt+re*yt,p[10]=kt*I+ne*W+Wt*st+re*Ut,p[11]=kt*L+ne*X+Wt*xt+re*A,kt=S[12],ne=S[13],Wt=S[14],re=S[15],p[12]=kt*N+ne*P+Wt*Z+re*At,p[13]=kt*w+ne*F+Wt*tt+re*yt,p[14]=kt*I+ne*W+Wt*st+re*Ut,p[15]=kt*L+ne*X+Wt*xt+re*A,p}function f(p,A,S){var N=A[0],w=A[1],I=A[2],L=A[3],P=N+N,F=w+w,W=I+I;A=N*P;var X=N*F;N*=W;var Z=w*F;return w*=W,I*=W,P*=L,F*=L,L*=W,p[0]=1-(Z+I),p[1]=X+L,p[2]=N-F,p[3]=0,p[4]=X-L,p[5]=1-(A+I),p[6]=w+P,p[7]=0,p[8]=N+F,p[9]=w-P,p[10]=1-(A+Z),p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p}function c(p,A,S){return p[0]=A[0]-S[0],p[1]=A[1]-S[1],p[2]=A[2]-S[2],p[3]=A[3]-S[3],p[4]=A[4]-S[4],p[5]=A[5]-S[5],p[6]=A[6]-S[6],p[7]=A[7]-S[7],p[8]=A[8]-S[8],p[9]=A[9]-S[9],p[10]=A[10]-S[10],p[11]=A[11]-S[11],p[12]=A[12]-S[12],p[13]=A[13]-S[13],p[14]=A[14]-S[14],p[15]=A[15]-S[15],p}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var p=new g.ARRAY_TYPE(16);return g.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=0,p[12]=0,p[13]=0,p[14]=0),p[0]=1,p[5]=1,p[10]=1,p[15]=1,p},r.clone=function(p){var A=new g.ARRAY_TYPE(16);return A[0]=p[0],A[1]=p[1],A[2]=p[2],A[3]=p[3],A[4]=p[4],A[5]=p[5],A[6]=p[6],A[7]=p[7],A[8]=p[8],A[9]=p[9],A[10]=p[10],A[11]=p[11],A[12]=p[12],A[13]=p[13],A[14]=p[14],A[15]=p[15],A},r.copy=function(p,A){return p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.fromValues=function(p,A,S,N,w,I,L,P,F,W,X,Z,tt,st,xt,At){var yt=new g.ARRAY_TYPE(16);return yt[0]=p,yt[1]=A,yt[2]=S,yt[3]=N,yt[4]=w,yt[5]=I,yt[6]=L,yt[7]=P,yt[8]=F,yt[9]=W,yt[10]=X,yt[11]=Z,yt[12]=tt,yt[13]=st,yt[14]=xt,yt[15]=At,yt},r.set=function(p,A,S,N,w,I,L,P,F,W,X,Z,tt,st,xt,At,yt){return p[0]=A,p[1]=S,p[2]=N,p[3]=w,p[4]=I,p[5]=L,p[6]=P,p[7]=F,p[8]=W,p[9]=X,p[10]=Z,p[11]=tt,p[12]=st,p[13]=xt,p[14]=At,p[15]=yt,p},r.identity=i,r.transpose=function(p,A){if(p===A){var S=A[1],N=A[2],w=A[3],I=A[6],L=A[7],P=A[11];p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=S,p[6]=A[9],p[7]=A[13],p[8]=N,p[9]=I,p[11]=A[14],p[12]=w,p[13]=L,p[14]=P}else p[0]=A[0],p[1]=A[4],p[2]=A[8],p[3]=A[12],p[4]=A[1],p[5]=A[5],p[6]=A[9],p[7]=A[13],p[8]=A[2],p[9]=A[6],p[10]=A[10],p[11]=A[14],p[12]=A[3],p[13]=A[7],p[14]=A[11],p[15]=A[15];return p},r.invert=function(p,A){var S=A[0],N=A[1],w=A[2],I=A[3],L=A[4],P=A[5],F=A[6],W=A[7],X=A[8],Z=A[9],tt=A[10],st=A[11],xt=A[12],At=A[13],yt=A[14];A=A[15];var Ut=S*P-N*L,kt=S*F-w*L,ne=S*W-I*L,Wt=N*F-w*P,re=N*W-I*P,be=w*W-I*F,ce=X*At-Z*xt,tr=X*yt-tt*xt,yr=X*A-st*xt,sr=Z*yt-tt*At,ni=Z*A-st*At,pr=tt*A-st*yt,dt=Ut*pr-kt*ni+ne*sr+Wt*yr-re*tr+be*ce;return dt?(dt=1/dt,p[0]=(P*pr-F*ni+W*sr)*dt,p[1]=(w*ni-N*pr-I*sr)*dt,p[2]=(At*be-yt*re+A*Wt)*dt,p[3]=(tt*re-Z*be-st*Wt)*dt,p[4]=(F*yr-L*pr-W*tr)*dt,p[5]=(S*pr-w*yr+I*tr)*dt,p[6]=(yt*ne-xt*be-A*kt)*dt,p[7]=(X*be-tt*ne+st*kt)*dt,p[8]=(L*ni-P*yr+W*ce)*dt,p[9]=(N*yr-S*ni-I*ce)*dt,p[10]=(xt*re-At*ne+A*Ut)*dt,p[11]=(Z*ne-X*re-st*Ut)*dt,p[12]=(P*tr-L*sr-F*ce)*dt,p[13]=(S*sr-N*tr+w*ce)*dt,p[14]=(At*kt-xt*Wt-yt*Ut)*dt,p[15]=(X*Wt-Z*kt+tt*Ut)*dt,p):null},r.adjoint=function(p,A){var S=A[0],N=A[1],w=A[2],I=A[3],L=A[4],P=A[5],F=A[6],W=A[7],X=A[8],Z=A[9],tt=A[10],st=A[11],xt=A[12],At=A[13],yt=A[14];return A=A[15],p[0]=P*(tt*A-st*yt)-Z*(F*A-W*yt)+At*(F*st-W*tt),p[1]=-(N*(tt*A-st*yt)-Z*(w*A-I*yt)+At*(w*st-I*tt)),p[2]=N*(F*A-W*yt)-P*(w*A-I*yt)+At*(w*W-I*F),p[3]=-(N*(F*st-W*tt)-P*(w*st-I*tt)+Z*(w*W-I*F)),p[4]=-(L*(tt*A-st*yt)-X*(F*A-W*yt)+xt*(F*st-W*tt)),p[5]=S*(tt*A-st*yt)-X*(w*A-I*yt)+xt*(w*st-I*tt),p[6]=-(S*(F*A-W*yt)-L*(w*A-I*yt)+xt*(w*W-I*F)),p[7]=S*(F*st-W*tt)-L*(w*st-I*tt)+X*(w*W-I*F),p[8]=L*(Z*A-st*At)-X*(P*A-W*At)+xt*(P*st-W*Z),p[9]=-(S*(Z*A-st*At)-X*(N*A-I*At)+xt*(N*st-I*Z)),p[10]=S*(P*A-W*At)-L*(N*A-I*At)+xt*(N*W-I*P),p[11]=-(S*(P*st-W*Z)-L*(N*st-I*Z)+X*(N*W-I*P)),p[12]=-(L*(Z*yt-tt*At)-X*(P*yt-F*At)+xt*(P*tt-F*Z)),p[13]=S*(Z*yt-tt*At)-X*(N*yt-w*At)+xt*(N*tt-w*Z),p[14]=-(S*(P*yt-F*At)-L*(N*yt-w*At)+xt*(N*F-w*P)),p[15]=S*(P*tt-F*Z)-L*(N*tt-w*Z)+X*(N*F-w*P),p},r.determinant=function(p){var A=p[0],S=p[1],N=p[2],w=p[3],I=p[4],L=p[5],P=p[6],F=p[7],W=p[8],X=p[9],Z=p[10],tt=p[11],st=p[12],xt=p[13],At=p[14];return p=p[15],(A*L-S*I)*(Z*p-tt*At)-(A*P-N*I)*(X*p-tt*xt)+(A*F-w*I)*(X*At-Z*xt)+(S*P-N*L)*(W*p-tt*st)-(S*F-w*L)*(W*At-Z*st)+(N*F-w*P)*(W*xt-X*st)},r.multiply=s,r.translate=function(p,A,S){var N=S[0],w=S[1];if(S=S[2],A===p)p[12]=A[0]*N+A[4]*w+A[8]*S+A[12],p[13]=A[1]*N+A[5]*w+A[9]*S+A[13],p[14]=A[2]*N+A[6]*w+A[10]*S+A[14],p[15]=A[3]*N+A[7]*w+A[11]*S+A[15];else{var I=A[0],L=A[1],P=A[2],F=A[3],W=A[4],X=A[5],Z=A[6],tt=A[7],st=A[8],xt=A[9],At=A[10],yt=A[11];p[0]=I,p[1]=L,p[2]=P,p[3]=F,p[4]=W,p[5]=X,p[6]=Z,p[7]=tt,p[8]=st,p[9]=xt,p[10]=At,p[11]=yt,p[12]=I*N+W*w+st*S+A[12],p[13]=L*N+X*w+xt*S+A[13],p[14]=P*N+Z*w+At*S+A[14],p[15]=F*N+tt*w+yt*S+A[15]}return p},r.scale=function(p,A,S){var N=S[0],w=S[1];return S=S[2],p[0]=A[0]*N,p[1]=A[1]*N,p[2]=A[2]*N,p[3]=A[3]*N,p[4]=A[4]*w,p[5]=A[5]*w,p[6]=A[6]*w,p[7]=A[7]*w,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15],p},r.rotate=function(p,A,S,N){var w=N[0],I=N[1];N=N[2];var L=Math.sqrt(w*w+I*I+N*N);if(L<g.EPSILON)return null;L=1/L,w*=L,I*=L,N*=L;var P=Math.sin(S),F=Math.cos(S),W=1-F;S=A[0],L=A[1];var X=A[2],Z=A[3],tt=A[4],st=A[5],xt=A[6],At=A[7],yt=A[8],Ut=A[9],kt=A[10],ne=A[11],Wt=w*w*W+F,re=I*w*W+N*P,be=N*w*W-I*P,ce=w*I*W-N*P,tr=I*I*W+F,yr=N*I*W+w*P,sr=w*N*W+I*P;return w=I*N*W-w*P,I=N*N*W+F,p[0]=S*Wt+tt*re+yt*be,p[1]=L*Wt+st*re+Ut*be,p[2]=X*Wt+xt*re+kt*be,p[3]=Z*Wt+At*re+ne*be,p[4]=S*ce+tt*tr+yt*yr,p[5]=L*ce+st*tr+Ut*yr,p[6]=X*ce+xt*tr+kt*yr,p[7]=Z*ce+At*tr+ne*yr,p[8]=S*sr+tt*w+yt*I,p[9]=L*sr+st*w+Ut*I,p[10]=X*sr+xt*w+kt*I,p[11]=Z*sr+At*w+ne*I,A!==p&&(p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p},r.rotateX=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var w=A[4],I=A[5],L=A[6],P=A[7],F=A[8],W=A[9],X=A[10],Z=A[11];return A!==p&&(p[0]=A[0],p[1]=A[1],p[2]=A[2],p[3]=A[3],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[4]=w*S+F*N,p[5]=I*S+W*N,p[6]=L*S+X*N,p[7]=P*S+Z*N,p[8]=F*S-w*N,p[9]=W*S-I*N,p[10]=X*S-L*N,p[11]=Z*S-P*N,p},r.rotateY=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var w=A[0],I=A[1],L=A[2],P=A[3],F=A[8],W=A[9],X=A[10],Z=A[11];return A!==p&&(p[4]=A[4],p[5]=A[5],p[6]=A[6],p[7]=A[7],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=w*S-F*N,p[1]=I*S-W*N,p[2]=L*S-X*N,p[3]=P*S-Z*N,p[8]=w*N+F*S,p[9]=I*N+W*S,p[10]=L*N+X*S,p[11]=P*N+Z*S,p},r.rotateZ=function(p,A,S){var N=Math.sin(S);S=Math.cos(S);var w=A[0],I=A[1],L=A[2],P=A[3],F=A[4],W=A[5],X=A[6],Z=A[7];return A!==p&&(p[8]=A[8],p[9]=A[9],p[10]=A[10],p[11]=A[11],p[12]=A[12],p[13]=A[13],p[14]=A[14],p[15]=A[15]),p[0]=w*S+F*N,p[1]=I*S+W*N,p[2]=L*S+X*N,p[3]=P*S+Z*N,p[4]=F*S-w*N,p[5]=W*S-I*N,p[6]=X*S-L*N,p[7]=Z*S-P*N,p},r.fromTranslation=function(p,A){return p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=A[0],p[13]=A[1],p[14]=A[2],p[15]=1,p},r.fromScaling=function(p,A){return p[0]=A[0],p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A[1],p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=A[2],p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotation=function(p,A,S){var N=S[0],w=S[1];S=S[2];var I=Math.sqrt(N*N+w*w+S*S);if(I<g.EPSILON)return null;I=1/I,N*=I,w*=I,S*=I,I=Math.sin(A),A=Math.cos(A);var L=1-A;return p[0]=N*N*L+A,p[1]=w*N*L+S*I,p[2]=S*N*L-w*I,p[3]=0,p[4]=N*w*L-S*I,p[5]=w*w*L+A,p[6]=S*w*L+N*I,p[7]=0,p[8]=N*S*L+w*I,p[9]=w*S*L-N*I,p[10]=S*S*L+A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromXRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=1,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=S,p[7]=0,p[8]=0,p[9]=-S,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromYRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=0,p[2]=-S,p[3]=0,p[4]=0,p[5]=1,p[6]=0,p[7]=0,p[8]=S,p[9]=0,p[10]=A,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromZRotation=function(p,A){var S=Math.sin(A);return A=Math.cos(A),p[0]=A,p[1]=S,p[2]=0,p[3]=0,p[4]=-S,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=1,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.fromRotationTranslation=f,r.fromQuat2=function(p,A){var S=new g.ARRAY_TYPE(3),N=-A[0],w=-A[1],I=-A[2],L=A[3],P=A[4],F=A[5],W=A[6],X=A[7],Z=N*N+w*w+I*I+L*L;return 0<Z?(S[0]=2*(P*L+X*N+F*I-W*w)/Z,S[1]=2*(F*L+X*w+W*N-P*I)/Z,S[2]=2*(W*L+X*I+P*w-F*N)/Z):(S[0]=2*(P*L+X*N+F*I-W*w),S[1]=2*(F*L+X*w+W*N-P*I),S[2]=2*(W*L+X*I+P*w-F*N)),f(p,A,S),p},r.getTranslation=function(p,A){return p[0]=A[12],p[1]=A[13],p[2]=A[14],p},r.getScaling=function(p,A){var S=A[0],N=A[1],w=A[2],I=A[4],L=A[5],P=A[6],F=A[8],W=A[9];return A=A[10],p[0]=Math.sqrt(S*S+N*N+w*w),p[1]=Math.sqrt(I*I+L*L+P*P),p[2]=Math.sqrt(F*F+W*W+A*A),p},r.getRotation=function(p,A){var S=A[0]+A[5]+A[10];return 0<S?(S=2*Math.sqrt(S+1),p[3]=.25*S,p[0]=(A[6]-A[9])/S,p[1]=(A[8]-A[2])/S,p[2]=(A[1]-A[4])/S):A[0]>A[5]&&A[0]>A[10]?(S=2*Math.sqrt(1+A[0]-A[5]-A[10]),p[3]=(A[6]-A[9])/S,p[0]=.25*S,p[1]=(A[1]+A[4])/S,p[2]=(A[8]+A[2])/S):A[5]>A[10]?(S=2*Math.sqrt(1+A[5]-A[0]-A[10]),p[3]=(A[8]-A[2])/S,p[0]=(A[1]+A[4])/S,p[1]=.25*S,p[2]=(A[6]+A[9])/S):(S=2*Math.sqrt(1+A[10]-A[0]-A[5]),p[3]=(A[1]-A[4])/S,p[0]=(A[8]+A[2])/S,p[1]=(A[6]+A[9])/S,p[2]=.25*S),p},r.fromRotationTranslationScale=function(p,A,S,N){var w=A[0],I=A[1],L=A[2],P=A[3],F=w+w,W=I+I,X=L+L;A=w*F;var Z=w*W;w*=X;var tt=I*W;I*=X,L*=X,F*=P,W*=P,P*=X,X=N[0];var st=N[1];return N=N[2],p[0]=(1-(tt+L))*X,p[1]=(Z+P)*X,p[2]=(w-W)*X,p[3]=0,p[4]=(Z-P)*st,p[5]=(1-(A+L))*st,p[6]=(I+F)*st,p[7]=0,p[8]=(w+W)*N,p[9]=(I-F)*N,p[10]=(1-(A+tt))*N,p[11]=0,p[12]=S[0],p[13]=S[1],p[14]=S[2],p[15]=1,p},r.fromRotationTranslationScaleOrigin=function(p,A,S,N,w){var I=A[0],L=A[1],P=A[2],F=A[3],W=I+I,X=L+L,Z=P+P;A=I*W;var tt=I*X,st=I*Z;I=L*X,L*=Z;var xt=P*Z;P=F*W,X*=F;var At=F*Z,yt=N[0],Ut=N[1];Z=N[2],N=w[0],F=w[1],w=w[2],W=(1-(I+xt))*yt;var kt=(tt+At)*yt;return yt*=st-X,tt=(tt-At)*Ut,xt=(1-(A+xt))*Ut,Ut*=L+P,st=(st+X)*Z,L=(L-P)*Z,A=(1-(A+I))*Z,p[0]=W,p[1]=kt,p[2]=yt,p[3]=0,p[4]=tt,p[5]=xt,p[6]=Ut,p[7]=0,p[8]=st,p[9]=L,p[10]=A,p[11]=0,p[12]=S[0]+N-(W*N+tt*F+st*w),p[13]=S[1]+F-(kt*N+xt*F+L*w),p[14]=S[2]+w-(yt*N+Ut*F+A*w),p[15]=1,p},r.fromQuat=function(p,A){var S=A[0],N=A[1],w=A[2];A=A[3];var I=S+S,L=N+N,P=w+w;S*=I;var F=N*I;N*=L;var W=w*I,X=w*L;return w*=P,I*=A,L*=A,A*=P,p[0]=1-N-w,p[1]=F+A,p[2]=W-L,p[3]=0,p[4]=F-A,p[5]=1-S-w,p[6]=X+I,p[7]=0,p[8]=W+L,p[9]=X-I,p[10]=1-S-N,p[11]=0,p[12]=0,p[13]=0,p[14]=0,p[15]=1,p},r.frustum=function(p,A,S,N,w,I,L){var P=1/(S-A),F=1/(w-N),W=1/(I-L);return p[0]=2*I*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=2*I*F,p[6]=0,p[7]=0,p[8]=(S+A)*P,p[9]=(w+N)*F,p[10]=(L+I)*W,p[11]=-1,p[12]=0,p[13]=0,p[14]=L*I*2*W,p[15]=0,p},r.perspective=function(p,A,S,N,w){return A=1/Math.tan(A/2),p[0]=A/S,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=A,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[11]=-1,p[12]=0,p[13]=0,p[15]=0,w!=null&&w!==1/0?(S=1/(N-w),p[10]=(w+N)*S,p[14]=2*w*N*S):(p[10]=-1,p[14]=-2*N),p},r.perspectiveFromFieldOfView=function(p,A,S,N){var w=Math.tan(A.upDegrees*Math.PI/180),I=Math.tan(A.downDegrees*Math.PI/180),L=Math.tan(A.leftDegrees*Math.PI/180);A=Math.tan(A.rightDegrees*Math.PI/180);var P=2/(L+A),F=2/(w+I);return p[0]=P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=F,p[6]=0,p[7]=0,p[8]=-((L-A)*P*.5),p[9]=(w-I)*F*.5,p[10]=N/(S-N),p[11]=-1,p[12]=0,p[13]=0,p[14]=N*S/(S-N),p[15]=0,p},r.ortho=function(p,A,S,N,w,I,L){var P=1/(A-S),F=1/(N-w),W=1/(I-L);return p[0]=-2*P,p[1]=0,p[2]=0,p[3]=0,p[4]=0,p[5]=-2*F,p[6]=0,p[7]=0,p[8]=0,p[9]=0,p[10]=2*W,p[11]=0,p[12]=(A+S)*P,p[13]=(w+N)*F,p[14]=(L+I)*W,p[15]=1,p},r.lookAt=function(p,A,S,N){var w=A[0],I=A[1];A=A[2];var L=N[0],P=N[1],F=N[2],W=S[0];N=S[1];var X=S[2];if(Math.abs(w-W)<g.EPSILON&&Math.abs(I-N)<g.EPSILON&&Math.abs(A-X)<g.EPSILON)return i(p);S=w-W,N=I-N,W=A-X;var Z=1/Math.sqrt(S*S+N*N+W*W);S*=Z,N*=Z,W*=Z,X=P*W-F*N,F=F*S-L*W,L=L*N-P*S,(Z=Math.sqrt(X*X+F*F+L*L))?(Z=1/Z,X*=Z,F*=Z,L*=Z):L=F=X=0,P=N*L-W*F;var tt=W*X-S*L,st=S*F-N*X;return(Z=Math.sqrt(P*P+tt*tt+st*st))?(Z=1/Z,P*=Z,tt*=Z,st*=Z):st=tt=P=0,p[0]=X,p[1]=P,p[2]=S,p[3]=0,p[4]=F,p[5]=tt,p[6]=N,p[7]=0,p[8]=L,p[9]=st,p[10]=W,p[11]=0,p[12]=-(X*w+F*I+L*A),p[13]=-(P*w+tt*I+st*A),p[14]=-(S*w+N*I+W*A),p[15]=1,p},r.targetTo=function(p,A,S,N){var w=A[0],I=A[1];A=A[2];var L=N[0],P=N[1],F=N[2];N=w-S[0];var W=I-S[1];S=A-S[2];var X=N*N+W*W+S*S;0<X&&(X=1/Math.sqrt(X),N*=X,W*=X,S*=X);var Z=P*S-F*W;return F=F*N-L*S,L=L*W-P*N,X=Z*Z+F*F+L*L,0<X&&(X=1/Math.sqrt(X),Z*=X,F*=X,L*=X),p[0]=Z,p[1]=F,p[2]=L,p[3]=0,p[4]=W*L-S*F,p[5]=S*Z-N*L,p[6]=N*F-W*Z,p[7]=0,p[8]=N,p[9]=W,p[10]=S,p[11]=0,p[12]=w,p[13]=I,p[14]=A,p[15]=1,p},r.str=function(p){return"mat4("+p[0]+", "+p[1]+", "+p[2]+", "+p[3]+", "+p[4]+", "+p[5]+", "+p[6]+", "+p[7]+", "+p[8]+", "+p[9]+", "+p[10]+", "+p[11]+", "+p[12]+", "+p[13]+", "+p[14]+", "+p[15]+")"},r.frob=function(p){return Math.sqrt(Math.pow(p[0],2)+Math.pow(p[1],2)+Math.pow(p[2],2)+Math.pow(p[3],2)+Math.pow(p[4],2)+Math.pow(p[5],2)+Math.pow(p[6],2)+Math.pow(p[7],2)+Math.pow(p[8],2)+Math.pow(p[9],2)+Math.pow(p[10],2)+Math.pow(p[11],2)+Math.pow(p[12],2)+Math.pow(p[13],2)+Math.pow(p[14],2)+Math.pow(p[15],2))},r.add=function(p,A,S){return p[0]=A[0]+S[0],p[1]=A[1]+S[1],p[2]=A[2]+S[2],p[3]=A[3]+S[3],p[4]=A[4]+S[4],p[5]=A[5]+S[5],p[6]=A[6]+S[6],p[7]=A[7]+S[7],p[8]=A[8]+S[8],p[9]=A[9]+S[9],p[10]=A[10]+S[10],p[11]=A[11]+S[11],p[12]=A[12]+S[12],p[13]=A[13]+S[13],p[14]=A[14]+S[14],p[15]=A[15]+S[15],p},r.subtract=c,r.multiplyScalar=function(p,A,S){return p[0]=A[0]*S,p[1]=A[1]*S,p[2]=A[2]*S,p[3]=A[3]*S,p[4]=A[4]*S,p[5]=A[5]*S,p[6]=A[6]*S,p[7]=A[7]*S,p[8]=A[8]*S,p[9]=A[9]*S,p[10]=A[10]*S,p[11]=A[11]*S,p[12]=A[12]*S,p[13]=A[13]*S,p[14]=A[14]*S,p[15]=A[15]*S,p},r.multiplyScalarAndAdd=function(p,A,S,N){return p[0]=A[0]+S[0]*N,p[1]=A[1]+S[1]*N,p[2]=A[2]+S[2]*N,p[3]=A[3]+S[3]*N,p[4]=A[4]+S[4]*N,p[5]=A[5]+S[5]*N,p[6]=A[6]+S[6]*N,p[7]=A[7]+S[7]*N,p[8]=A[8]+S[8]*N,p[9]=A[9]+S[9]*N,p[10]=A[10]+S[10]*N,p[11]=A[11]+S[11]*N,p[12]=A[12]+S[12]*N,p[13]=A[13]+S[13]*N,p[14]=A[14]+S[14]*N,p[15]=A[15]+S[15]*N,p},r.exactEquals=function(p,A){return p[0]===A[0]&&p[1]===A[1]&&p[2]===A[2]&&p[3]===A[3]&&p[4]===A[4]&&p[5]===A[5]&&p[6]===A[6]&&p[7]===A[7]&&p[8]===A[8]&&p[9]===A[9]&&p[10]===A[10]&&p[11]===A[11]&&p[12]===A[12]&&p[13]===A[13]&&p[14]===A[14]&&p[15]===A[15]},r.equals=function(p,A){var S=p[0],N=p[1],w=p[2],I=p[3],L=p[4],P=p[5],F=p[6],W=p[7],X=p[8],Z=p[9],tt=p[10],st=p[11],xt=p[12],At=p[13],yt=p[14];p=p[15];var Ut=A[0],kt=A[1],ne=A[2],Wt=A[3],re=A[4],be=A[5],ce=A[6],tr=A[7],yr=A[8],sr=A[9],ni=A[10],pr=A[11],dt=A[12],gt=A[13],mt=A[14];return A=A[15],Math.abs(S-Ut)<=g.EPSILON*Math.max(1,Math.abs(S),Math.abs(Ut))&&Math.abs(N-kt)<=g.EPSILON*Math.max(1,Math.abs(N),Math.abs(kt))&&Math.abs(w-ne)<=g.EPSILON*Math.max(1,Math.abs(w),Math.abs(ne))&&Math.abs(I-Wt)<=g.EPSILON*Math.max(1,Math.abs(I),Math.abs(Wt))&&Math.abs(L-re)<=g.EPSILON*Math.max(1,Math.abs(L),Math.abs(re))&&Math.abs(P-be)<=g.EPSILON*Math.max(1,Math.abs(P),Math.abs(be))&&Math.abs(F-ce)<=g.EPSILON*Math.max(1,Math.abs(F),Math.abs(ce))&&Math.abs(W-tr)<=g.EPSILON*Math.max(1,Math.abs(W),Math.abs(tr))&&Math.abs(X-yr)<=g.EPSILON*Math.max(1,Math.abs(X),Math.abs(yr))&&Math.abs(Z-sr)<=g.EPSILON*Math.max(1,Math.abs(Z),Math.abs(sr))&&Math.abs(tt-ni)<=g.EPSILON*Math.max(1,Math.abs(tt),Math.abs(ni))&&Math.abs(st-pr)<=g.EPSILON*Math.max(1,Math.abs(st),Math.abs(pr))&&Math.abs(xt-dt)<=g.EPSILON*Math.max(1,Math.abs(xt),Math.abs(dt))&&Math.abs(At-gt)<=g.EPSILON*Math.max(1,Math.abs(At),Math.abs(gt))&&Math.abs(yt-mt)<=g.EPSILON*Math.max(1,Math.abs(yt),Math.abs(mt))&&Math.abs(p-A)<=g.EPSILON*Math.max(1,Math.abs(p),Math.abs(A))},r.sub=r.mul=void 0;var g=function(p){if(p&&p.__esModule)return p;var A={};if(p!=null){for(var S in p)if(Object.prototype.hasOwnProperty.call(p,S)){var N=Hn&&Zn?Zn(p,S):{};N.get||N.set?Hn(A,S,N):A[S]=p[S]}}return A.default=p,A}(ru);r.mul=s,r.sub=c});zt($A);var t2=It(function(t,r){function i(){var P=new L.ARRAY_TYPE(3);return L.ARRAY_TYPE!=Float32Array&&(P[0]=0,P[1]=0,P[2]=0),P}function s(P){var F=P[0],W=P[1];return P=P[2],Math.sqrt(F*F+W*W+P*P)}function f(P,F,W){var X=new L.ARRAY_TYPE(3);return X[0]=P,X[1]=F,X[2]=W,X}function c(P,F,W){return P[0]=F[0]-W[0],P[1]=F[1]-W[1],P[2]=F[2]-W[2],P}function g(P,F,W){return P[0]=F[0]*W[0],P[1]=F[1]*W[1],P[2]=F[2]*W[2],P}function p(P,F,W){return P[0]=F[0]/W[0],P[1]=F[1]/W[1],P[2]=F[2]/W[2],P}function A(P,F){var W=F[0]-P[0],X=F[1]-P[1];return P=F[2]-P[2],Math.sqrt(W*W+X*X+P*P)}function S(P,F){var W=F[0]-P[0],X=F[1]-P[1];return P=F[2]-P[2],W*W+X*X+P*P}function N(P){var F=P[0],W=P[1];return P=P[2],F*F+W*W+P*P}function w(P,F){var W=F[0],X=F[1],Z=F[2];return W=W*W+X*X+Z*Z,0<W&&(W=1/Math.sqrt(W)),P[0]=F[0]*W,P[1]=F[1]*W,P[2]=F[2]*W,P}function I(P,F){return P[0]*F[0]+P[1]*F[1]+P[2]*F[2]}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(P){var F=new L.ARRAY_TYPE(3);return F[0]=P[0],F[1]=P[1],F[2]=P[2],F},r.length=s,r.fromValues=f,r.copy=function(P,F){return P[0]=F[0],P[1]=F[1],P[2]=F[2],P},r.set=function(P,F,W,X){return P[0]=F,P[1]=W,P[2]=X,P},r.add=function(P,F,W){return P[0]=F[0]+W[0],P[1]=F[1]+W[1],P[2]=F[2]+W[2],P},r.subtract=c,r.multiply=g,r.divide=p,r.ceil=function(P,F){return P[0]=Math.ceil(F[0]),P[1]=Math.ceil(F[1]),P[2]=Math.ceil(F[2]),P},r.floor=function(P,F){return P[0]=Math.floor(F[0]),P[1]=Math.floor(F[1]),P[2]=Math.floor(F[2]),P},r.min=function(P,F,W){return P[0]=Math.min(F[0],W[0]),P[1]=Math.min(F[1],W[1]),P[2]=Math.min(F[2],W[2]),P},r.max=function(P,F,W){return P[0]=Math.max(F[0],W[0]),P[1]=Math.max(F[1],W[1]),P[2]=Math.max(F[2],W[2]),P},r.round=function(P,F){return P[0]=Math.round(F[0]),P[1]=Math.round(F[1]),P[2]=Math.round(F[2]),P},r.scale=function(P,F,W){return P[0]=F[0]*W,P[1]=F[1]*W,P[2]=F[2]*W,P},r.scaleAndAdd=function(P,F,W,X){return P[0]=F[0]+W[0]*X,P[1]=F[1]+W[1]*X,P[2]=F[2]+W[2]*X,P},r.distance=A,r.squaredDistance=S,r.squaredLength=N,r.negate=function(P,F){return P[0]=-F[0],P[1]=-F[1],P[2]=-F[2],P},r.inverse=function(P,F){return P[0]=1/F[0],P[1]=1/F[1],P[2]=1/F[2],P},r.normalize=w,r.dot=I,r.cross=function(P,F,W){var X=F[0],Z=F[1];F=F[2];var tt=W[0],st=W[1];return W=W[2],P[0]=Z*W-F*st,P[1]=F*tt-X*W,P[2]=X*st-Z*tt,P},r.lerp=function(P,F,W,X){var Z=F[0],tt=F[1];return F=F[2],P[0]=Z+X*(W[0]-Z),P[1]=tt+X*(W[1]-tt),P[2]=F+X*(W[2]-F),P},r.hermite=function(P,F,W,X,Z,tt){var st=tt*tt,xt=st*(2*tt-3)+1,At=st*(tt-2)+tt,yt=st*(tt-1);return tt=st*(3-2*tt),P[0]=F[0]*xt+W[0]*At+X[0]*yt+Z[0]*tt,P[1]=F[1]*xt+W[1]*At+X[1]*yt+Z[1]*tt,P[2]=F[2]*xt+W[2]*At+X[2]*yt+Z[2]*tt,P},r.bezier=function(P,F,W,X,Z,tt){var st=1-tt,xt=st*st,At=tt*tt,yt=xt*st;return xt*=3*tt,st*=3*At,tt*=At,P[0]=F[0]*yt+W[0]*xt+X[0]*st+Z[0]*tt,P[1]=F[1]*yt+W[1]*xt+X[1]*st+Z[1]*tt,P[2]=F[2]*yt+W[2]*xt+X[2]*st+Z[2]*tt,P},r.random=function(P,F){F=F||1;var W=2*L.RANDOM()*Math.PI,X=2*L.RANDOM()-1,Z=Math.sqrt(1-X*X)*F;return P[0]=Math.cos(W)*Z,P[1]=Math.sin(W)*Z,P[2]=X*F,P},r.transformMat4=function(P,F,W){var X=F[0],Z=F[1];F=F[2];var tt=W[3]*X+W[7]*Z+W[11]*F+W[15];return tt=tt||1,P[0]=(W[0]*X+W[4]*Z+W[8]*F+W[12])/tt,P[1]=(W[1]*X+W[5]*Z+W[9]*F+W[13])/tt,P[2]=(W[2]*X+W[6]*Z+W[10]*F+W[14])/tt,P},r.transformMat3=function(P,F,W){var X=F[0],Z=F[1];return F=F[2],P[0]=X*W[0]+Z*W[3]+F*W[6],P[1]=X*W[1]+Z*W[4]+F*W[7],P[2]=X*W[2]+Z*W[5]+F*W[8],P},r.transformQuat=function(P,F,W){var X=W[0],Z=W[1],tt=W[2],st=F[0],xt=F[1];F=F[2];var At=Z*F-tt*xt,yt=tt*st-X*F,Ut=X*xt-Z*st;return W=2*W[3],P[0]=st+At*W+2*(Z*Ut-tt*yt),P[1]=xt+yt*W+2*(tt*At-X*Ut),P[2]=F+Ut*W+2*(X*yt-Z*At),P},r.rotateX=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[0],tt[1]=Z[1]*Math.cos(X)-Z[2]*Math.sin(X),tt[2]=Z[1]*Math.sin(X)+Z[2]*Math.cos(X),P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.rotateY=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[2]*Math.sin(X)+Z[0]*Math.cos(X),tt[1]=Z[1],tt[2]=Z[2]*Math.cos(X)-Z[0]*Math.sin(X),P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.rotateZ=function(P,F,W,X){var Z=[],tt=[];return Z[0]=F[0]-W[0],Z[1]=F[1]-W[1],Z[2]=F[2]-W[2],tt[0]=Z[0]*Math.cos(X)-Z[1]*Math.sin(X),tt[1]=Z[0]*Math.sin(X)+Z[1]*Math.cos(X),tt[2]=Z[2],P[0]=tt[0]+W[0],P[1]=tt[1]+W[1],P[2]=tt[2]+W[2],P},r.angle=function(P,F){return P=f(P[0],P[1],P[2]),F=f(F[0],F[1],F[2]),w(P,P),w(F,F),F=I(P,F),1<F?0:-1>F?Math.PI:Math.acos(F)},r.zero=function(P){return P[0]=0,P[1]=0,P[2]=0,P},r.str=function(P){return"vec3("+P[0]+", "+P[1]+", "+P[2]+")"},r.exactEquals=function(P,F){return P[0]===F[0]&&P[1]===F[1]&&P[2]===F[2]},r.equals=function(P,F){var W=P[0],X=P[1];P=P[2];var Z=F[0],tt=F[1];return F=F[2],Math.abs(W-Z)<=L.EPSILON*Math.max(1,Math.abs(W),Math.abs(Z))&&Math.abs(X-tt)<=L.EPSILON*Math.max(1,Math.abs(X),Math.abs(tt))&&Math.abs(P-F)<=L.EPSILON*Math.max(1,Math.abs(P),Math.abs(F))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var L=function(P){if(P&&P.__esModule)return P;var F={};if(P!=null){for(var W in P)if(Object.prototype.hasOwnProperty.call(P,W)){var X=Hn&&Zn?Zn(P,W):{};X.get||X.set?Hn(F,W,X):F[W]=P[W]}}return F.default=P,F}(ru);r.sub=c,r.mul=g,r.div=p,r.dist=A,r.sqrDist=S,r.len=s,r.sqrLen=N,t=function(){var P=i();return function(F,W,X,Z,tt,st){for(W||(W=3),X||(X=0),Z=Z?Math.min(Z*W+X,F.length):F.length;X<Z;X+=W)P[0]=F[X],P[1]=F[X+1],P[2]=F[X+2],tt(P,P,st),F[X]=P[0],F[X+1]=P[1],F[X+2]=P[2];return F}}(),r.forEach=t});zt(t2);var e2=It(function(t,r){function i(){var w=new N.ARRAY_TYPE(4);return N.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[3]=0),w}function s(w,I,L){return w[0]=I[0]-L[0],w[1]=I[1]-L[1],w[2]=I[2]-L[2],w[3]=I[3]-L[3],w}function f(w,I,L){return w[0]=I[0]*L[0],w[1]=I[1]*L[1],w[2]=I[2]*L[2],w[3]=I[3]*L[3],w}function c(w,I,L){return w[0]=I[0]/L[0],w[1]=I[1]/L[1],w[2]=I[2]/L[2],w[3]=I[3]/L[3],w}function g(w,I){var L=I[0]-w[0],P=I[1]-w[1],F=I[2]-w[2];return w=I[3]-w[3],Math.sqrt(L*L+P*P+F*F+w*w)}function p(w,I){var L=I[0]-w[0],P=I[1]-w[1],F=I[2]-w[2];return w=I[3]-w[3],L*L+P*P+F*F+w*w}function A(w){var I=w[0],L=w[1],P=w[2];return w=w[3],Math.sqrt(I*I+L*L+P*P+w*w)}function S(w){var I=w[0],L=w[1],P=w[2];return w=w[3],I*I+L*L+P*P+w*w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(w){var I=new N.ARRAY_TYPE(4);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I},r.fromValues=function(w,I,L,P){var F=new N.ARRAY_TYPE(4);return F[0]=w,F[1]=I,F[2]=L,F[3]=P,F},r.copy=function(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w},r.set=function(w,I,L,P,F){return w[0]=I,w[1]=L,w[2]=P,w[3]=F,w},r.add=function(w,I,L){return w[0]=I[0]+L[0],w[1]=I[1]+L[1],w[2]=I[2]+L[2],w[3]=I[3]+L[3],w},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(w,I){return w[0]=Math.ceil(I[0]),w[1]=Math.ceil(I[1]),w[2]=Math.ceil(I[2]),w[3]=Math.ceil(I[3]),w},r.floor=function(w,I){return w[0]=Math.floor(I[0]),w[1]=Math.floor(I[1]),w[2]=Math.floor(I[2]),w[3]=Math.floor(I[3]),w},r.min=function(w,I,L){return w[0]=Math.min(I[0],L[0]),w[1]=Math.min(I[1],L[1]),w[2]=Math.min(I[2],L[2]),w[3]=Math.min(I[3],L[3]),w},r.max=function(w,I,L){return w[0]=Math.max(I[0],L[0]),w[1]=Math.max(I[1],L[1]),w[2]=Math.max(I[2],L[2]),w[3]=Math.max(I[3],L[3]),w},r.round=function(w,I){return w[0]=Math.round(I[0]),w[1]=Math.round(I[1]),w[2]=Math.round(I[2]),w[3]=Math.round(I[3]),w},r.scale=function(w,I,L){return w[0]=I[0]*L,w[1]=I[1]*L,w[2]=I[2]*L,w[3]=I[3]*L,w},r.scaleAndAdd=function(w,I,L,P){return w[0]=I[0]+L[0]*P,w[1]=I[1]+L[1]*P,w[2]=I[2]+L[2]*P,w[3]=I[3]+L[3]*P,w},r.distance=g,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w[2]=-I[2],w[3]=-I[3],w},r.inverse=function(w,I){return w[0]=1/I[0],w[1]=1/I[1],w[2]=1/I[2],w[3]=1/I[3],w},r.normalize=function(w,I){var L=I[0],P=I[1],F=I[2];I=I[3];var W=L*L+P*P+F*F+I*I;return 0<W&&(W=1/Math.sqrt(W)),w[0]=L*W,w[1]=P*W,w[2]=F*W,w[3]=I*W,w},r.dot=function(w,I){return w[0]*I[0]+w[1]*I[1]+w[2]*I[2]+w[3]*I[3]},r.cross=function(w,I,L,P){var F=L[0]*P[1]-L[1]*P[0],W=L[0]*P[2]-L[2]*P[0],X=L[0]*P[3]-L[3]*P[0],Z=L[1]*P[2]-L[2]*P[1],tt=L[1]*P[3]-L[3]*P[1];L=L[2]*P[3]-L[3]*P[2],P=I[0];var st=I[1],xt=I[2];return I=I[3],w[0]=st*L-xt*tt+I*Z,w[1]=-(P*L)+xt*X-I*W,w[2]=P*tt-st*X+I*F,w[3]=-(P*Z)+st*W-xt*F,w},r.lerp=function(w,I,L,P){var F=I[0],W=I[1],X=I[2];return I=I[3],w[0]=F+P*(L[0]-F),w[1]=W+P*(L[1]-W),w[2]=X+P*(L[2]-X),w[3]=I+P*(L[3]-I),w},r.random=function(w,I){I=I||1;do var L=2*N.RANDOM()-1,P=2*N.RANDOM()-1,F=L*L+P*P;while(1<=F);do var W=2*N.RANDOM()-1,X=2*N.RANDOM()-1,Z=W*W+X*X;while(1<=Z);return F=Math.sqrt((1-F)/Z),w[0]=I*L,w[1]=I*P,w[2]=I*W*F,w[3]=I*X*F,w},r.transformMat4=function(w,I,L){var P=I[0],F=I[1],W=I[2];return I=I[3],w[0]=L[0]*P+L[4]*F+L[8]*W+L[12]*I,w[1]=L[1]*P+L[5]*F+L[9]*W+L[13]*I,w[2]=L[2]*P+L[6]*F+L[10]*W+L[14]*I,w[3]=L[3]*P+L[7]*F+L[11]*W+L[15]*I,w},r.transformQuat=function(w,I,L){var P=I[0],F=I[1],W=I[2],X=L[0],Z=L[1],tt=L[2];L=L[3];var st=L*P+Z*W-tt*F,xt=L*F+tt*P-X*W,At=L*W+X*F-Z*P;return P=-X*P-Z*F-tt*W,w[0]=st*L+P*-X+xt*-tt-At*-Z,w[1]=xt*L+P*-Z+At*-X-st*-tt,w[2]=At*L+P*-tt+st*-Z-xt*-X,w[3]=I[3],w},r.zero=function(w){return w[0]=0,w[1]=0,w[2]=0,w[3]=0,w},r.str=function(w){return"vec4("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]},r.equals=function(w,I){var L=w[0],P=w[1],F=w[2];w=w[3];var W=I[0],X=I[1],Z=I[2];return I=I[3],Math.abs(L-W)<=N.EPSILON*Math.max(1,Math.abs(L),Math.abs(W))&&Math.abs(P-X)<=N.EPSILON*Math.max(1,Math.abs(P),Math.abs(X))&&Math.abs(F-Z)<=N.EPSILON*Math.max(1,Math.abs(F),Math.abs(Z))&&Math.abs(w-I)<=N.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.forEach=r.sqrLen=r.len=r.sqrDist=r.dist=r.div=r.mul=r.sub=void 0;var N=function(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var L in w)if(Object.prototype.hasOwnProperty.call(w,L)){var P=Hn&&Zn?Zn(w,L):{};P.get||P.set?Hn(I,L,P):I[L]=w[L]}}return I.default=w,I}(ru);r.sub=s,r.mul=f,r.div=c,r.dist=g,r.sqrDist=p,r.len=A,r.sqrLen=S,t=function(){var w=i();return function(I,L,P,F,W,X){for(L||(L=4),P||(P=0),F=F?Math.min(F*L+P,I.length):I.length;P<F;P+=L)w[0]=I[P],w[1]=I[P+1],w[2]=I[P+2],w[3]=I[P+3],W(w,w,X),I[P]=w[0],I[P+1]=w[1],I[P+2]=w[2],I[P+3]=w[3];return I}}(),r.forEach=t});zt(e2);var r2=It(function(t,r){function i(L){if(L&&L.__esModule)return L;var P={};if(L!=null){for(var F in L)if(Object.prototype.hasOwnProperty.call(L,F)){var W=Hn&&Zn?Zn(L,F):{};W.get||W.set?Hn(P,F,W):P[F]=L[F]}}return P.default=L,P}function s(){var L=new A.ARRAY_TYPE(4);return A.ARRAY_TYPE!=Float32Array&&(L[0]=0,L[1]=0,L[2]=0),L[3]=1,L}function f(L,P,F){F*=.5;var W=Math.sin(F);return L[0]=W*P[0],L[1]=W*P[1],L[2]=W*P[2],L[3]=Math.cos(F),L}function c(L,P,F){var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=F[0],st=F[1],xt=F[2];return F=F[3],L[0]=W*F+P*tt+X*xt-Z*st,L[1]=X*F+P*st+Z*tt-W*xt,L[2]=Z*F+P*xt+W*st-X*tt,L[3]=P*F-W*tt-X*st-Z*xt,L}function g(L,P,F,W){var X=P[0],Z=P[1],tt=P[2];P=P[3];var st=F[0],xt=F[1],At=F[2];F=F[3];var yt=X*st+Z*xt+tt*At+P*F;if(0>yt&&(yt=-yt,st=-st,xt=-xt,At=-At,F=-F),1-yt>A.EPSILON){var Ut=Math.acos(yt),kt=Math.sin(Ut);yt=Math.sin((1-W)*Ut)/kt,W=Math.sin(W*Ut)/kt}else yt=1-W;return L[0]=yt*X+W*st,L[1]=yt*Z+W*xt,L[2]=yt*tt+W*At,L[3]=yt*P+W*F,L}function p(L,P){var F=P[0]+P[4]+P[8];if(0<F)F=Math.sqrt(F+1),L[3]=.5*F,F=.5/F,L[0]=(P[5]-P[7])*F,L[1]=(P[6]-P[2])*F,L[2]=(P[1]-P[3])*F;else{var W=0;P[4]>P[0]&&(W=1),P[8]>P[3*W+W]&&(W=2);var X=(W+1)%3,Z=(W+2)%3;F=Math.sqrt(P[3*W+W]-P[3*X+X]-P[3*Z+Z]+1),L[W]=.5*F,F=.5/F,L[3]=(P[3*X+Z]-P[3*Z+X])*F,L[X]=(P[3*X+W]+P[3*W+X])*F,L[Z]=(P[3*Z+W]+P[3*W+Z])*F}return L}Object.defineProperty(r,"__esModule",{value:!0}),r.create=s,r.identity=function(L){return L[0]=0,L[1]=0,L[2]=0,L[3]=1,L},r.setAxisAngle=f,r.getAxisAngle=function(L,P){var F=2*Math.acos(P[3]),W=Math.sin(F/2);return W>A.EPSILON?(L[0]=P[0]/W,L[1]=P[1]/W,L[2]=P[2]/W):(L[0]=1,L[1]=0,L[2]=0),F},r.multiply=c,r.rotateX=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F+P*tt,L[1]=X*F+Z*tt,L[2]=Z*F-X*tt,L[3]=P*F-W*tt,L},r.rotateY=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F-Z*tt,L[1]=X*F+P*tt,L[2]=Z*F+W*tt,L[3]=P*F-X*tt,L},r.rotateZ=function(L,P,F){F*=.5;var W=P[0],X=P[1],Z=P[2];P=P[3];var tt=Math.sin(F);return F=Math.cos(F),L[0]=W*F+X*tt,L[1]=X*F-W*tt,L[2]=Z*F+P*tt,L[3]=P*F-Z*tt,L},r.calculateW=function(L,P){var F=P[0],W=P[1];return P=P[2],L[0]=F,L[1]=W,L[2]=P,L[3]=Math.sqrt(Math.abs(1-F*F-W*W-P*P)),L},r.slerp=g,r.random=function(L){var P=A.RANDOM(),F=A.RANDOM(),W=A.RANDOM(),X=Math.sqrt(1-P);return P=Math.sqrt(P),L[0]=X*Math.sin(2*Math.PI*F),L[1]=X*Math.cos(2*Math.PI*F),L[2]=P*Math.sin(2*Math.PI*W),L[3]=P*Math.cos(2*Math.PI*W),L},r.invert=function(L,P){var F=P[0],W=P[1],X=P[2];P=P[3];var Z=F*F+W*W+X*X+P*P;return Z=Z?1/Z:0,L[0]=-F*Z,L[1]=-W*Z,L[2]=-X*Z,L[3]=P*Z,L},r.conjugate=function(L,P){return L[0]=-P[0],L[1]=-P[1],L[2]=-P[2],L[3]=P[3],L},r.fromMat3=p,r.fromEuler=function(L,P,F,W){var X=.5*Math.PI/180;P*=X,F*=X,W*=X,X=Math.sin(P),P=Math.cos(P);var Z=Math.sin(F);F=Math.cos(F);var tt=Math.sin(W);return W=Math.cos(W),L[0]=X*F*W-P*Z*tt,L[1]=P*Z*W+X*F*tt,L[2]=P*F*tt-X*Z*W,L[3]=P*F*W+X*Z*tt,L},r.str=function(L){return"quat("+L[0]+", "+L[1]+", "+L[2]+", "+L[3]+")"},r.setAxes=r.sqlerp=r.rotationTo=r.equals=r.exactEquals=r.normalize=r.sqrLen=r.squaredLength=r.len=r.length=r.lerp=r.dot=r.scale=r.mul=r.add=r.set=r.copy=r.fromValues=r.clone=void 0;var A=i(ru),S=i(QA),N=i(t2);t=i(e2),r.clone=t.clone,r.fromValues=t.fromValues,r.copy=t.copy,r.set=t.set,r.add=t.add,r.mul=c,r.scale=t.scale,r.dot=t.dot,r.lerp=t.lerp;var w=t.length;r.length=w,r.len=w,w=t.squaredLength,r.squaredLength=w,r.sqrLen=w;var I=t.normalize;r.normalize=I,r.exactEquals=t.exactEquals,r.equals=t.equals,t=function(){var L=N.create(),P=N.fromValues(1,0,0),F=N.fromValues(0,1,0);return function(W,X,Z){var tt=N.dot(X,Z);return-.999999>tt?(N.cross(L,P,X),1e-6>N.len(L)&&N.cross(L,F,X),N.normalize(L,L),f(W,L,Math.PI),W):.999999<tt?(W[0]=0,W[1]=0,W[2]=0,W[3]=1,W):(N.cross(L,X,Z),W[0]=L[0],W[1]=L[1],W[2]=L[2],W[3]=1+tt,I(W,W))}}(),r.rotationTo=t,t=function(){var L=s(),P=s();return function(F,W,X,Z,tt,st){return g(L,W,tt,st),g(P,X,Z,st),g(F,L,P,2*st*(1-st)),F}}(),r.sqlerp=t,t=function(){var L=S.create();return function(P,F,W,X){return L[0]=W[0],L[3]=W[1],L[6]=W[2],L[1]=X[0],L[4]=X[1],L[7]=X[2],L[2]=-F[0],L[5]=-F[1],L[8]=-F[2],I(P,p(P,L))}}(),r.setAxes=t});zt(r2);var fw=It(function(t,r){function i(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var L in w)if(Object.prototype.hasOwnProperty.call(w,L)){var P=Hn&&Zn?Zn(w,L):{};P.get||P.set?Hn(I,L,P):I[L]=w[L]}}return I.default=w,I}function s(w,I,L){var P=.5*L[0],F=.5*L[1];L=.5*L[2];var W=I[0],X=I[1],Z=I[2];return I=I[3],w[0]=W,w[1]=X,w[2]=Z,w[3]=I,w[4]=P*I+F*Z-L*X,w[5]=F*I+L*W-P*Z,w[6]=L*I+P*X-F*W,w[7]=-P*W-F*X-L*Z,w}function f(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=I[4],w[5]=I[5],w[6]=I[6],w[7]=I[7],w}function c(w,I,L){var P=I[0],F=I[1],W=I[2],X=I[3],Z=L[4],tt=L[5],st=L[6],xt=L[7],At=I[4],yt=I[5],Ut=I[6];I=I[7];var kt=L[0],ne=L[1],Wt=L[2];return L=L[3],w[0]=P*L+X*kt+F*Wt-W*ne,w[1]=F*L+X*ne+W*kt-P*Wt,w[2]=W*L+X*Wt+P*ne-F*kt,w[3]=X*L-P*kt-F*ne-W*Wt,w[4]=P*xt+X*Z+F*st-W*tt+At*L+I*kt+yt*Wt-Ut*ne,w[5]=F*xt+X*tt+W*Z-P*st+yt*L+I*ne+Ut*kt-At*Wt,w[6]=W*xt+X*st+P*tt-F*Z+Ut*L+I*Wt+At*ne-yt*kt,w[7]=X*xt-P*Z-F*tt-W*st+I*L-At*kt-yt*ne-Ut*Wt,w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=function(){var w=new g.ARRAY_TYPE(8);return g.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0,w[2]=0,w[4]=0,w[5]=0,w[6]=0,w[7]=0),w[3]=1,w},r.clone=function(w){var I=new g.ARRAY_TYPE(8);return I[0]=w[0],I[1]=w[1],I[2]=w[2],I[3]=w[3],I[4]=w[4],I[5]=w[5],I[6]=w[6],I[7]=w[7],I},r.fromValues=function(w,I,L,P,F,W,X,Z){var tt=new g.ARRAY_TYPE(8);return tt[0]=w,tt[1]=I,tt[2]=L,tt[3]=P,tt[4]=F,tt[5]=W,tt[6]=X,tt[7]=Z,tt},r.fromRotationTranslationValues=function(w,I,L,P,F,W,X){var Z=new g.ARRAY_TYPE(8);return Z[0]=w,Z[1]=I,Z[2]=L,Z[3]=P,F*=.5,W*=.5,X*=.5,Z[4]=F*P+W*L-X*I,Z[5]=W*P+X*w-F*L,Z[6]=X*P+F*I-W*w,Z[7]=-F*w-W*I-X*L,Z},r.fromRotationTranslation=s,r.fromTranslation=function(w,I){return w[0]=0,w[1]=0,w[2]=0,w[3]=1,w[4]=.5*I[0],w[5]=.5*I[1],w[6]=.5*I[2],w[7]=0,w},r.fromRotation=function(w,I){return w[0]=I[0],w[1]=I[1],w[2]=I[2],w[3]=I[3],w[4]=0,w[5]=0,w[6]=0,w[7]=0,w},r.fromMat4=function(w,I){var L=p.create();A.getRotation(L,I);var P=new g.ARRAY_TYPE(3);return A.getTranslation(P,I),s(w,L,P),w},r.copy=f,r.identity=function(w){return w[0]=0,w[1]=0,w[2]=0,w[3]=1,w[4]=0,w[5]=0,w[6]=0,w[7]=0,w},r.set=function(w,I,L,P,F,W,X,Z,tt){return w[0]=I,w[1]=L,w[2]=P,w[3]=F,w[4]=W,w[5]=X,w[6]=Z,w[7]=tt,w},r.getDual=function(w,I){return w[0]=I[4],w[1]=I[5],w[2]=I[6],w[3]=I[7],w},r.setDual=function(w,I){return w[4]=I[0],w[5]=I[1],w[6]=I[2],w[7]=I[3],w},r.getTranslation=function(w,I){var L=I[4],P=I[5],F=I[6],W=I[7],X=-I[0],Z=-I[1],tt=-I[2];return I=I[3],w[0]=2*(L*I+W*X+P*tt-F*Z),w[1]=2*(P*I+W*Z+F*X-L*tt),w[2]=2*(F*I+W*tt+L*Z-P*X),w},r.translate=function(w,I,L){var P=I[0],F=I[1],W=I[2],X=I[3],Z=.5*L[0],tt=.5*L[1];L=.5*L[2];var st=I[4],xt=I[5],At=I[6];return I=I[7],w[0]=P,w[1]=F,w[2]=W,w[3]=X,w[4]=X*Z+F*L-W*tt+st,w[5]=X*tt+W*Z-P*L+xt,w[6]=X*L+P*tt-F*Z+At,w[7]=-P*Z-F*tt-W*L+I,w},r.rotateX=function(w,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],st=I[6],xt=I[7],At=Z*X+xt*P+tt*W-st*F,yt=tt*X+xt*F+st*P-Z*W,Ut=st*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-st*W,p.rotateX(w,I,L),P=w[0],F=w[1],W=w[2],X=w[3],w[4]=At*X+Z*P+yt*W-Ut*F,w[5]=yt*X+Z*F+Ut*P-At*W,w[6]=Ut*X+Z*W+At*F-yt*P,w[7]=Z*X-At*P-yt*F-Ut*W,w},r.rotateY=function(w,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],st=I[6],xt=I[7],At=Z*X+xt*P+tt*W-st*F,yt=tt*X+xt*F+st*P-Z*W,Ut=st*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-st*W,p.rotateY(w,I,L),P=w[0],F=w[1],W=w[2],X=w[3],w[4]=At*X+Z*P+yt*W-Ut*F,w[5]=yt*X+Z*F+Ut*P-At*W,w[6]=Ut*X+Z*W+At*F-yt*P,w[7]=Z*X-At*P-yt*F-Ut*W,w},r.rotateZ=function(w,I,L){var P=-I[0],F=-I[1],W=-I[2],X=I[3],Z=I[4],tt=I[5],st=I[6],xt=I[7],At=Z*X+xt*P+tt*W-st*F,yt=tt*X+xt*F+st*P-Z*W,Ut=st*X+xt*W+Z*F-tt*P;return Z=xt*X-Z*P-tt*F-st*W,p.rotateZ(w,I,L),P=w[0],F=w[1],W=w[2],X=w[3],w[4]=At*X+Z*P+yt*W-Ut*F,w[5]=yt*X+Z*F+Ut*P-At*W,w[6]=Ut*X+Z*W+At*F-yt*P,w[7]=Z*X-At*P-yt*F-Ut*W,w},r.rotateByQuatAppend=function(w,I,L){var P=L[0],F=L[1],W=L[2];L=L[3];var X=I[0],Z=I[1],tt=I[2],st=I[3];return w[0]=X*L+st*P+Z*W-tt*F,w[1]=Z*L+st*F+tt*P-X*W,w[2]=tt*L+st*W+X*F-Z*P,w[3]=st*L-X*P-Z*F-tt*W,X=I[4],Z=I[5],tt=I[6],st=I[7],w[4]=X*L+st*P+Z*W-tt*F,w[5]=Z*L+st*F+tt*P-X*W,w[6]=tt*L+st*W+X*F-Z*P,w[7]=st*L-X*P-Z*F-tt*W,w},r.rotateByQuatPrepend=function(w,I,L){var P=I[0],F=I[1],W=I[2];I=I[3];var X=L[0],Z=L[1],tt=L[2],st=L[3];return w[0]=P*st+I*X+F*tt-W*Z,w[1]=F*st+I*Z+W*X-P*tt,w[2]=W*st+I*tt+P*Z-F*X,w[3]=I*st-P*X-F*Z-W*tt,X=L[4],Z=L[5],tt=L[6],st=L[7],w[4]=P*st+I*X+F*tt-W*Z,w[5]=F*st+I*Z+W*X-P*tt,w[6]=W*st+I*tt+P*Z-F*X,w[7]=I*st-P*X-F*Z-W*tt,w},r.rotateAroundAxis=function(w,I,L,P){if(Math.abs(P)<g.EPSILON)return f(w,I);var F=Math.sqrt(L[0]*L[0]+L[1]*L[1]+L[2]*L[2]);P*=.5;var W=Math.sin(P),X=W*L[0]/F,Z=W*L[1]/F;L=W*L[2]/F,P=Math.cos(P),F=I[0],W=I[1];var tt=I[2],st=I[3];return w[0]=F*P+st*X+W*L-tt*Z,w[1]=W*P+st*Z+tt*X-F*L,w[2]=tt*P+st*L+F*Z-W*X,w[3]=st*P-F*X-W*Z-tt*L,F=I[4],W=I[5],tt=I[6],I=I[7],w[4]=F*P+I*X+W*L-tt*Z,w[5]=W*P+I*Z+tt*X-F*L,w[6]=tt*P+I*L+F*Z-W*X,w[7]=I*P-F*X-W*Z-tt*L,w},r.add=function(w,I,L){return w[0]=I[0]+L[0],w[1]=I[1]+L[1],w[2]=I[2]+L[2],w[3]=I[3]+L[3],w[4]=I[4]+L[4],w[5]=I[5]+L[5],w[6]=I[6]+L[6],w[7]=I[7]+L[7],w},r.multiply=c,r.scale=function(w,I,L){return w[0]=I[0]*L,w[1]=I[1]*L,w[2]=I[2]*L,w[3]=I[3]*L,w[4]=I[4]*L,w[5]=I[5]*L,w[6]=I[6]*L,w[7]=I[7]*L,w},r.lerp=function(w,I,L,P){var F=1-P;return 0>S(I,L)&&(P=-P),w[0]=I[0]*F+L[0]*P,w[1]=I[1]*F+L[1]*P,w[2]=I[2]*F+L[2]*P,w[3]=I[3]*F+L[3]*P,w[4]=I[4]*F+L[4]*P,w[5]=I[5]*F+L[5]*P,w[6]=I[6]*F+L[6]*P,w[7]=I[7]*F+L[7]*P,w},r.invert=function(w,I){var L=N(I);return w[0]=-I[0]/L,w[1]=-I[1]/L,w[2]=-I[2]/L,w[3]=I[3]/L,w[4]=-I[4]/L,w[5]=-I[5]/L,w[6]=-I[6]/L,w[7]=I[7]/L,w},r.conjugate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w[2]=-I[2],w[3]=I[3],w[4]=-I[4],w[5]=-I[5],w[6]=-I[6],w[7]=I[7],w},r.normalize=function(w,I){var L=N(I);if(0<L){L=Math.sqrt(L);var P=I[0]/L,F=I[1]/L,W=I[2]/L,X=I[3]/L,Z=I[4],tt=I[5],st=I[6];I=I[7];var xt=P*Z+F*tt+W*st+X*I;w[0]=P,w[1]=F,w[2]=W,w[3]=X,w[4]=(Z-P*xt)/L,w[5]=(tt-F*xt)/L,w[6]=(st-W*xt)/L,w[7]=(I-X*xt)/L}return w},r.str=function(w){return"quat2("+w[0]+", "+w[1]+", "+w[2]+", "+w[3]+", "+w[4]+", "+w[5]+", "+w[6]+", "+w[7]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]&&w[2]===I[2]&&w[3]===I[3]&&w[4]===I[4]&&w[5]===I[5]&&w[6]===I[6]&&w[7]===I[7]},r.equals=function(w,I){var L=w[0],P=w[1],F=w[2],W=w[3],X=w[4],Z=w[5],tt=w[6];w=w[7];var st=I[0],xt=I[1],At=I[2],yt=I[3],Ut=I[4],kt=I[5],ne=I[6];return I=I[7],Math.abs(L-st)<=g.EPSILON*Math.max(1,Math.abs(L),Math.abs(st))&&Math.abs(P-xt)<=g.EPSILON*Math.max(1,Math.abs(P),Math.abs(xt))&&Math.abs(F-At)<=g.EPSILON*Math.max(1,Math.abs(F),Math.abs(At))&&Math.abs(W-yt)<=g.EPSILON*Math.max(1,Math.abs(W),Math.abs(yt))&&Math.abs(X-Ut)<=g.EPSILON*Math.max(1,Math.abs(X),Math.abs(Ut))&&Math.abs(Z-kt)<=g.EPSILON*Math.max(1,Math.abs(Z),Math.abs(kt))&&Math.abs(tt-ne)<=g.EPSILON*Math.max(1,Math.abs(tt),Math.abs(ne))&&Math.abs(w-I)<=g.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.sqrLen=r.squaredLength=r.len=r.length=r.dot=r.mul=r.setReal=r.getReal=void 0;var g=i(ru),p=i(r2),A=i($A);r.getReal=p.copy,r.setReal=p.copy,r.mul=c;var S=p.dot;r.dot=S,t=p.length,r.length=t,r.len=t;var N=p.squaredLength;r.squaredLength=N,r.sqrLen=N});zt(fw);var pw=It(function(t,r){function i(){var w=new N.ARRAY_TYPE(2);return N.ARRAY_TYPE!=Float32Array&&(w[0]=0,w[1]=0),w}function s(w,I,L){return w[0]=I[0]-L[0],w[1]=I[1]-L[1],w}function f(w,I,L){return w[0]=I[0]*L[0],w[1]=I[1]*L[1],w}function c(w,I,L){return w[0]=I[0]/L[0],w[1]=I[1]/L[1],w}function g(w,I){var L=I[0]-w[0];return w=I[1]-w[1],Math.sqrt(L*L+w*w)}function p(w,I){var L=I[0]-w[0];return w=I[1]-w[1],L*L+w*w}function A(w){var I=w[0];return w=w[1],Math.sqrt(I*I+w*w)}function S(w){var I=w[0];return w=w[1],I*I+w*w}Object.defineProperty(r,"__esModule",{value:!0}),r.create=i,r.clone=function(w){var I=new N.ARRAY_TYPE(2);return I[0]=w[0],I[1]=w[1],I},r.fromValues=function(w,I){var L=new N.ARRAY_TYPE(2);return L[0]=w,L[1]=I,L},r.copy=function(w,I){return w[0]=I[0],w[1]=I[1],w},r.set=function(w,I,L){return w[0]=I,w[1]=L,w},r.add=function(w,I,L){return w[0]=I[0]+L[0],w[1]=I[1]+L[1],w},r.subtract=s,r.multiply=f,r.divide=c,r.ceil=function(w,I){return w[0]=Math.ceil(I[0]),w[1]=Math.ceil(I[1]),w},r.floor=function(w,I){return w[0]=Math.floor(I[0]),w[1]=Math.floor(I[1]),w},r.min=function(w,I,L){return w[0]=Math.min(I[0],L[0]),w[1]=Math.min(I[1],L[1]),w},r.max=function(w,I,L){return w[0]=Math.max(I[0],L[0]),w[1]=Math.max(I[1],L[1]),w},r.round=function(w,I){return w[0]=Math.round(I[0]),w[1]=Math.round(I[1]),w},r.scale=function(w,I,L){return w[0]=I[0]*L,w[1]=I[1]*L,w},r.scaleAndAdd=function(w,I,L,P){return w[0]=I[0]+L[0]*P,w[1]=I[1]+L[1]*P,w},r.distance=g,r.squaredDistance=p,r.length=A,r.squaredLength=S,r.negate=function(w,I){return w[0]=-I[0],w[1]=-I[1],w},r.inverse=function(w,I){return w[0]=1/I[0],w[1]=1/I[1],w},r.normalize=function(w,I){var L=I[0],P=I[1];return L=L*L+P*P,0<L&&(L=1/Math.sqrt(L)),w[0]=I[0]*L,w[1]=I[1]*L,w},r.dot=function(w,I){return w[0]*I[0]+w[1]*I[1]},r.cross=function(w,I,L){return I=I[0]*L[1]-I[1]*L[0],w[0]=w[1]=0,w[2]=I,w},r.lerp=function(w,I,L,P){var F=I[0];return I=I[1],w[0]=F+P*(L[0]-F),w[1]=I+P*(L[1]-I),w},r.random=function(w,I){I=I||1;var L=2*N.RANDOM()*Math.PI;return w[0]=Math.cos(L)*I,w[1]=Math.sin(L)*I,w},r.transformMat2=function(w,I,L){var P=I[0];return I=I[1],w[0]=L[0]*P+L[2]*I,w[1]=L[1]*P+L[3]*I,w},r.transformMat2d=function(w,I,L){var P=I[0];return I=I[1],w[0]=L[0]*P+L[2]*I+L[4],w[1]=L[1]*P+L[3]*I+L[5],w},r.transformMat3=function(w,I,L){var P=I[0];return I=I[1],w[0]=L[0]*P+L[3]*I+L[6],w[1]=L[1]*P+L[4]*I+L[7],w},r.transformMat4=function(w,I,L){var P=I[0];return I=I[1],w[0]=L[0]*P+L[4]*I+L[12],w[1]=L[1]*P+L[5]*I+L[13],w},r.rotate=function(w,I,L,P){var F=I[0]-L[0];I=I[1]-L[1];var W=Math.sin(P);return P=Math.cos(P),w[0]=F*P-I*W+L[0],w[1]=F*W+I*P+L[1],w},r.angle=function(w,I){var L=w[0];w=w[1];var P=I[0];I=I[1];var F=L*L+w*w;0<F&&(F=1/Math.sqrt(F));var W=P*P+I*I;return 0<W&&(W=1/Math.sqrt(W)),L=(L*P+w*I)*F*W,1<L?0:-1>L?Math.PI:Math.acos(L)},r.zero=function(w){return w[0]=0,w[1]=0,w},r.str=function(w){return"vec2("+w[0]+", "+w[1]+")"},r.exactEquals=function(w,I){return w[0]===I[0]&&w[1]===I[1]},r.equals=function(w,I){var L=w[0];w=w[1];var P=I[0];return I=I[1],Math.abs(L-P)<=N.EPSILON*Math.max(1,Math.abs(L),Math.abs(P))&&Math.abs(w-I)<=N.EPSILON*Math.max(1,Math.abs(w),Math.abs(I))},r.forEach=r.sqrLen=r.sqrDist=r.dist=r.div=r.mul=r.sub=r.len=void 0;var N=function(w){if(w&&w.__esModule)return w;var I={};if(w!=null){for(var L in w)if(Object.prototype.hasOwnProperty.call(w,L)){var P=Hn&&Zn?Zn(w,L):{};P.get||P.set?Hn(I,L,P):I[L]=w[L]}}return I.default=w,I}(ru);r.len=A,r.sub=s,r.mul=f,r.div=c,r.dist=g,r.sqrDist=p,r.sqrLen=S,t=function(){var w=i();return function(I,L,P,F,W,X){for(L||(L=2),P||(P=0),F=F?Math.min(F*L+P,I.length):I.length;P<F;P+=L)w[0]=I[P],w[1]=I[P+1],W(w,w,X),I[P]=w[0],I[P+1]=w[1];return I}}(),r.forEach=t});zt(pw);var dw=It(function(t,r){function i(s){if(s&&s.__esModule)return s;var f={};if(s!=null){for(var c in s)if(Object.prototype.hasOwnProperty.call(s,c)){var g=Hn&&Zn?Zn(s,c):{};g.get||g.set?Hn(f,c,g):f[c]=s[c]}}return f.default=s,f}Object.defineProperty(r,"__esModule",{value:!0}),r.vec4=r.vec3=r.vec2=r.quat2=r.quat=r.mat4=r.mat3=r.mat2d=r.mat2=r.glMatrix=void 0,t=i(ru),r.glMatrix=t,t=i(hw),r.mat2=t,t=i(cw),r.mat2d=t,t=i(QA),r.mat3=t,t=i($A),r.mat4=t,t=i(r2),r.quat=t,t=i(fw),r.quat2=t,t=i(pw),r.vec2=t,t=i(t2),r.vec3=t,t=i(e2),r.vec4=t});zt(dw);var Co=dw.mat4,Ca=function(){function t(r,i,s){Ri(this,t),this.options=i,this.gl=r,s&&(this.map=s.map),s=this.getVertexShader(i.vertexShader);var f=this.getFragmentShader(i.fragmentShader);i=r.createShader(r.VERTEX_SHADER),r.shaderSource(i,s),r.compileShader(i),r.getShaderParameter(i,r.COMPILE_STATUS)?(s=r.createShader(r.FRAGMENT_SHADER),r.shaderSource(s,f),r.compileShader(s),r.getShaderParameter(s,r.COMPILE_STATUS)?(f=r.createProgram(),r.attachShader(f,i),r.attachShader(f,s),r.deleteShader(i),r.deleteShader(s),r.linkProgram(f),r.getProgramParameter(f,r.LINK_STATUS)?i=f:(i="Shader program failed to link.  The error log is:"+r.getProgramInfoLog(f),console.error(i),i=-1)):(i="Fragment shader failed to compile.  The error log is:"+r.getShaderInfoLog(s),console.error(i),i=-1)):(i="Vertex shader failed to compile.  The error log is:"+r.getShaderInfoLog(i),console.error(i),i=-1),i=this.program=i,s={},f=r.getProgramParameter(i,r.ACTIVE_ATTRIBUTES);for(var c=0;c<f;c++){var g=r.getActiveAttrib(i,c);s[g.name]=r.getAttribLocation(i,g.name)}c={},g={};for(var p=r.getProgramParameter(i,r.ACTIVE_UNIFORMS),A=0;A<p;A++){var S=r.getActiveUniform(i,A);c[S.name]=r.getUniformLocation(i,S.name),g[S.name]=S.type}this.parameter=r={attributes:s,numAttributes:f,uniformsType:g,uniforms:c},this.attributes=r.attributes,this.uniforms=r.uniforms,this.parameter=r}return tn(t,[{key:"getVertexShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#ifdef LOG_DEPTH
uniform float currentFrustumX;varying float v_depthFromNearPlusOne;
#endif
uniform vec2 MAPV_resolution;
#if defined(PICK)
uniform bool uIsPickRender;attribute vec3 aPickColor;uniform vec3 uPickedColor;varying vec4 vPickColor;uniform bool uEnablePicked;bool mapvIsPicked(){return uEnablePicked&&aPickColor==uPickedColor;}
#endif
void afterMain(){
#if defined(LOG_DEPTH)
v_depthFromNearPlusOne=(gl_Position.w-currentFrustumX)+1.0;gl_Position.z=clamp(gl_Position.z/gl_Position.w,-1.0,1.0)*gl_Position.w;
#endif
#if defined(PICK)
vPickColor=vec4(aPickColor,0.0);if(mapvIsPicked()){vPickColor.a=1.0;}
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getFragmentShader",value:function(r){var i="";return this.map&&this.map.type==="cesium"&&(i=`#define LOG_DEPTH
`),i+=`#if defined(LOG_DEPTH)
#extension GL_EXT_frag_depth : enable
#endif
precision highp float;uniform vec2 MAPV_resolution;uniform bool uIsPickRender;
#if defined(PICK)
varying vec4 vPickColor;bool mapvIsPicked(){return vPickColor.a==1.0;}
#endif
#if defined(LOG_DEPTH)
uniform float oneOverLog2FarDepthFromNearPlusOne;uniform float farDepthFromNearPlusOne;varying float v_depthFromNearPlusOne;void writeLogDepth(float depth){if(depth<=0.9999999||depth>farDepthFromNearPlusOne){discard;}gl_FragDepthEXT=log2(depth)*oneOverLog2FarDepthFromNearPlusOne;}
#endif
void afterMain(){
#if defined(PICK)
if(uIsPickRender){gl_FragColor=vec4(vPickColor.rgb,1.0);return;}
#endif
#if defined(LOG_DEPTH)
writeLogDepth(v_depthFromNearPlusOne);
#endif
}`,r=this.getDefines()+i+r,r=r.replace("void main","void originMain"),r+"void main() {originMain(); afterMain();}"}},{key:"getDefines",value:function(){var r="",i=this.options.defines;if(i)for(var s=0;s<i.length;s++)r+="#define "+i[s]+`
`;return r}},{key:"use",value:function(r,i){this.gl=r,r.useProgram(this.program),this.map&&this.map.type==="cesium"&&this.setUniforms({currentFrustumX:this.map.map.scene.camera.frustum.near,oneOverLog2FarDepthFromNearPlusOne:this.map.map.scene.context.uniformState.oneOverLog2FarDepthFromNearPlusOne,farDepthFromNearPlusOne:this.map.map.scene.context.uniformState.farDepthFromNearPlusOne}),this.uniforms.MAPV_resolution&&this.setUniforms({MAPV_resolution:[r.canvas.width,r.canvas.height]})}},{key:"setUniform",value:function(r,i){var s=this.gl,f=this.uniforms[r];if(f)switch(this.parameter.uniformsType[r]){case s.FLOAT:s.uniform1f(f,i);break;case s.FLOAT_VEC2:s.uniform2f(f,i[0],i[1]);break;case s.FLOAT_VEC3:s.uniform3f(f,i[0],i[1],i[2]);break;case s.FLOAT_VEC4:s.uniform4f(f,i[0],i[1],i[2],i[3]);break;case s.SAMPLER_2D:case s.SAMPLER_CUBE:s.activeTexture(s["TEXTURE"+this.textureIndex]),s.uniform1i(f,this.textureIndex),s.bindTexture(s.TEXTURE_2D,i),this.textureIndex++;break;case s.INT:case s.BOOL:s.uniform1i(f,i);break;case s.INT_VEC2:case s.BOOL_VEC2:s.uniform2i(f,i[0],i[1]);break;case s.INT_VEC3:case s.BOOL_VEC3:s.uniform3i(f,i[0],i[1],i[2]);break;case s.INT_VEC4:case s.BOOL_VEC4:s.uniform4i(f,i[0],i[1],i[2],i[3]);break;case s.FLOAT_MAT2:s.uniformMatrix2fv(f,!1,i);break;case s.FLOAT_MAT3:s.uniformMatrix3fv(f,!1,i);break;case s.FLOAT_MAT4:s.uniformMatrix4fv(f,!1,i);break;default:console.error("Unrecognized uniform type: "+r)}else console.warn("Unrecognized uniform type: "+r)}},{key:"setUniforms",value:function(r){this.textureIndex=0;for(var i in r)this.setUniform(i,r[i])}}]),t}(),th=function(t,r,i,s){var f=i?i.call(s,t,r):void 0;if(f!==void 0)return!!f;if(t===r)return!0;if((typeof t=="undefined"?"undefined":Zs(t))!=="object"||!t||(typeof r=="undefined"?"undefined":Zs(r))!=="object"||!r)return!1;var c=Pi(t),g=Pi(r);if(c.length!==g.length)return!1;g=Object.prototype.hasOwnProperty.bind(r);for(var p=0;p<c.length;p++){if(f=c[p],!g(f))return!1;var A=t[f],S=r[f];if(f=i?i.call(s,A,S,f):void 0,f===!1||f===void 0&&A!==S)return!1}return!0},zC=function(){function t(r){Ri(this,t),this.options=r,this.gl=r.gl,this.savedState=[],this.currentState=this.getDefaultState()}return tn(t,[{key:"setDefaultState",value:function(){this.setState()}},{key:"getDefaultState",value:function(){var r=this.gl;return{blend:!1,blendEquation:r.FUNC_ADD,blendFunc:[r.ONE,r.ZERO],depthMask:!0,depthTest:!0,depthFunc:r.LEQUAL,polygonOffset:[0,0],cullFace:!1,stencilTest:!1}}},{key:"getRealState",value:function(){var r=this.gl;return{blend:r.getParameter(r.BLEND),blendEquation:r.getParameter(r.BLEND_EQUATION),depthMask:r.getParameter(r.DEPTH_WRITEMASK),depthTest:r.getParameter(r.DEPTH_TEST),depthFunc:r.getParameter(r.DEPTH_FUNC),polygonOffset:[r.getParameter(r.POLYGON_OFFSET_FACTOR),r.getParameter(r.POLYGON_OFFSET_UNITS)],cullFace:r.getParameter(r.CULL_FACE),stencilTest:r.getParameter(r.STENCIL_TEST)}}},{key:"getCurrentState",value:function(){return this.currentState}},{key:"save",value:function(){this.savedState.push(this.getCurrentState())}},{key:"restore",value:function(){var r=this.savedState.pop();this.setState(r,{force:!0})}},{key:"setState",value:function(r){var i=1<arguments.length&&arguments[1]!==void 0?arguments[1]:{};r=ut(this.getDefaultState(),r),this.setBlend(r,i),this.setDepth(r,i),this.setCullFace(r,i),this.setPolygonOffset(r,i),this.setStencil(r,i),this.currentState=r}},{key:"setBlend",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!th(r.blend,f.blend))&&(r.blend?s.enable(s.BLEND):s.disable(s.BLEND)),!i&&th(r.blendEquation,f.blendEquation)||s.blendEquation(r.blendEquation),(i||!th(r.blendFunc,f.blendFunc))&&(r.blendFunc.length===2?s.blendFunc(r.blendFunc[0],r.blendFunc[1]):r.blendFunc.length===4&&s.blendFuncSeparate(r.blendFunc[0],r.blendFunc[1],r.blendFunc[2],r.blendFunc[3]))}},{key:"setDepth",value:function(r,i){var s=this.gl,f=this.getCurrentState();((i=i.force)||!th(r.depthTest,f.depthTest))&&(r.depthTest?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST)),(i||!th(r.depthMask,f.depthMask))&&(r.depthMask?s.depthMask(!0):s.depthMask(!1)),!i&&th(r.depthFunc,f.depthFunc)||s.depthFunc(r.depthFunc)}},{key:"setPolygonOffset",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!th(r.polygonOffset,f.polygonOffset))&&(r.polygonOffset[0]!==0&&r.polygonOffset[1]!==0?s.enable(s.POLYGON_OFFSET_FILL):s.disable(s.POLYGON_OFFSET_FILL),s.polygonOffset(r.polygonOffset[0],r.polygonOffset[1]))}},{key:"setCullFace",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!th(r.cullFace,f.cullFace))&&(r.cullFace?(s.enable(s.CULL_FACE),s.cullFace(s.BACK)):s.disable(s.CULL_FACE))}},{key:"setStencil",value:function(r,i){var s=this.gl,f=this.getCurrentState();(i.force||!th(r.stencilTest,f.stencilTest))&&(r.stencilTest?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST))}}]),t}(),qm=function(){function t(r){Ri(this,t),this.options=r,this.gl=r.gl,this.buffer=this.gl.createBuffer(),r.data&&this.updateData(r.data)}return tn(t,[{key:"updateData",value:function(r){var i=this.options,s=this.gl;this.bind(),s.bufferData(s[i.target],r,s[i.usage])}},{key:"bind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],this.buffer)}},{key:"unBind",value:function(r){r=r||this.gl,r.bindBuffer(r[this.options.target],null)}},{key:"destroy",value:function(){this.buffer=null}}]),t}(),UC={BYTE:1,UNSIGNED_BYTE:1,SHORT:2,UNSIGNED_SHORT:2,FLOAT:4},sy=function(){function t(r){for(Ri(this,t),this.options=r,this.attributes=r.attributes,this.gl=r.gl,this.program=r.program,r=this.stride=0;r<this.attributes.length;r++)this.stride+=UC[this.attributes[r].type]*this.attributes[r].size}return tn(t,[{key:"setVertexAttribPointers",value:function(){for(var r=this.gl,i=this.program,s=0;s<this.attributes.length;s++){var f=this.attributes[s],c=i.attributes[f.name];c!==void 0&&(f.buffer.bind(r),r.vertexAttribPointer(c,f.size,r[f.type],f.normalize||!1,f.stride!==void 0?f.stride:this.stride,f.offset),r.enableVertexAttribArray(c))}}},{key:"bind",value:function(){this.setVertexAttribPointers()}},{key:"destroy",value:function(){}}]),t}(),ms=function t(r,i,s){Ri(this,t),i=i||r.canvas.width,s=s||r.canvas.height;var f=r.createFramebuffer(),c=r.createTexture();r.bindTexture(r.TEXTURE_2D,c),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,i,s,0,r.RGBA,r.UNSIGNED_BYTE,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,r.LINEAR),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,r.CLAMP_TO_EDGE),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,r.CLAMP_TO_EDGE),f.texture=c;var g=r.createRenderbuffer();r.bindRenderbuffer(r.RENDERBUFFER,g),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,i,s),f.depthBuffer=g,r.bindFramebuffer(r.FRAMEBUFFER,f),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,c,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,g),i=r.checkFramebufferStatus(r.FRAMEBUFFER),r.FRAMEBUFFER_COMPLETE===i&&(r.bindFramebuffer(r.FRAMEBUFFER,null),r.bindTexture(r.TEXTURE_2D,null),r.bindRenderbuffer(r.RENDERBUFFER,null),this.framebuffer=f)},Nd=function(){function t(r){Ri(this,t),this.options={},ut(this.options,r),this.vertex=[-1,1,0,-1,-1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0],this.sampleCoord=[0,1,0,0,1,1,1,1,0,0,1,0]}return tn(t,[{key:"getOptions",value:function(){return this.options}},{key:"onResize",value:function(r){}},{key:"render",value:function(r){var i=r.gl;r=r.texture;var s=this.programSample;i.useProgram(s.program);var f=i.createBuffer();i.bindBuffer(i.ARRAY_BUFFER,f);var c=[-1,-1,0,-1,1,0,1,1,0,1,1,0,-1,-1,0,1,-1,0];i.bufferData(i.ARRAY_BUFFER,new Float32Array(c),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aPos),i.vertexAttribPointer(s.attributes.aPos,3,i.FLOAT,!1,0,0),f=i.createBuffer(),i.bindBuffer(i.ARRAY_BUFFER,f),i.bufferData(i.ARRAY_BUFFER,new Float32Array([0,0,0,1,1,1,1,1,0,0,1,0]),i.STATIC_DRAW),i.enableVertexAttribArray(s.attributes.aTextureCoord),i.vertexAttribPointer(s.attributes.aTextureCoord,2,i.FLOAT,!1,0,0),i.activeTexture(i.TEXTURE0),i.bindTexture(i.TEXTURE_2D,r),i.uniform1i(s.uniforms.uSampler,0),i.drawArrays(i.TRIANGLES,0,c.length/3)}}]),t}();(function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(void){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision highp float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;vec4 fxaa_2_0(sampler2D tex,vec2 fragCoord,vec2 resolution,vec2 v_rgbNW,vec2 v_rgbNE,vec2 v_rgbSW,vec2 v_rgbSE,vec2 v_rgbM){vec4 color;mediump vec2 inverseVP=vec2(1.0/resolution.x,1.0/resolution.y);vec3 rgbNW=texture2D(tex,v_rgbNW).xyz;vec3 rgbNE=texture2D(tex,v_rgbNE).xyz;vec3 rgbSW=texture2D(tex,v_rgbSW).xyz;vec3 rgbSE=texture2D(tex,v_rgbSE).xyz;vec4 texColor=texture2D(tex,v_rgbM);vec3 rgbM=texColor.xyz;vec3 luma=vec3(0.299,0.587,0.114);float lumaNW=dot(rgbNW,luma);float lumaNE=dot(rgbNE,luma);float lumaSW=dot(rgbSW,luma);float lumaSE=dot(rgbSE,luma);float lumaM=dot(rgbM,luma);float lumaMin=min(lumaM,min(min(lumaNW,lumaNE),min(lumaSW,lumaSE)));float lumaMax=max(lumaM,max(max(lumaNW,lumaNE),max(lumaSW,lumaSE)));mediump vec2 dir;dir.x=-((lumaNW+lumaNE)-(lumaSW+lumaSE));dir.y=((lumaNW+lumaSW)-(lumaNE+lumaSE));float dirReduce=max((lumaNW+lumaNE+lumaSW+lumaSE)*(0.25*1.0/8.0),1.0/128.0);float rcpDirMin=1.0/(min(abs(dir.x),abs(dir.y))+dirReduce);dir=min(vec2(8.0,8.0),max(vec2(-8.0,-8.0),dir*rcpDirMin))*inverseVP;vec3 rgbA=0.5*(texture2D(tex,fragCoord*inverseVP+dir*(1.0/3.0-0.5)).xyz+texture2D(tex,fragCoord*inverseVP+dir*(2.0/3.0-0.5)).xyz);vec3 rgbB=rgbA*0.5+0.25*(texture2D(tex,fragCoord*inverseVP+dir*-0.5).xyz+texture2D(tex,fragCoord*inverseVP+dir*0.5).xyz);float lumaB=dot(rgbB,luma);if((lumaB<lumaMin)||(lumaB>lumaMax)){color=vec4(rgbA,texColor.a);}else{color=vec4(rgbB,texColor.a);}return color;}void texcoords_3_1(vec2 fragCoord,vec2 resolution,out vec2 v_rgbNW,out vec2 v_rgbNE,out vec2 v_rgbSW,out vec2 v_rgbSE,out vec2 v_rgbM){vec2 inverseVP=1.0/resolution.xy;v_rgbNW=(fragCoord+vec2(-1.0,-1.0))*inverseVP;v_rgbNE=(fragCoord+vec2(1.0,-1.0))*inverseVP;v_rgbSW=(fragCoord+vec2(-1.0,1.0))*inverseVP;v_rgbSE=(fragCoord+vec2(1.0,1.0))*inverseVP;v_rgbM=vec2(fragCoord*inverseVP);}vec4 apply_1_2(sampler2D tex,vec2 fragCoord,vec2 resolution){mediump vec2 v_rgbNW;mediump vec2 v_rgbNE;mediump vec2 v_rgbSW;mediump vec2 v_rgbSE;mediump vec2 v_rgbM;texcoords_3_1(fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);return fxaa_2_0(tex,fragCoord,resolution,v_rgbNW,v_rgbNE,v_rgbSW,v_rgbSE,v_rgbM);}void main(void){vec2 fragCoord=vTextureCoord*canvasSize;gl_FragColor=apply_1_2(uSampler,fragCoord,canvasSize);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r})(Nd),function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){if(this.program1||(this.program1=new Ca(i,{vertexShader:"attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];void SMAAEdgeDetectionVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);vOffset[2]=texcoord.xyxy+resolution.xyxy*vec4(-2.0,0.0,0.0,2.0);}void main(){vUv=uv;SMAAEdgeDetectionVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:`precision highp float;
#define SMAA_THRESHOLD 0.1
uniform sampler2D tDiffuse;varying vec2 vUv;varying vec4 vOffset[3];vec4 SMAAColorEdgeDetectionPS(vec2 texcoord,vec4 offset[3],sampler2D colorTex){vec2 threshold=vec2(SMAA_THRESHOLD,SMAA_THRESHOLD);vec4 delta;vec3 C=texture2D(colorTex,texcoord).rgb;vec3 Cleft=texture2D(colorTex,offset[0].xy).rgb;vec3 t=abs(C-Cleft);delta.x=max(max(t.r,t.g),t.b);vec3 Ctop=texture2D(colorTex,offset[0].zw).rgb;t=abs(C-Ctop);delta.y=max(max(t.r,t.g),t.b);vec2 edges=step(threshold,delta.xy);if(dot(edges,vec2(1.0,1.0))==0.0)discard;vec3 Cright=texture2D(colorTex,offset[1].xy).rgb;t=abs(C-Cright);delta.z=max(max(t.r,t.g),t.b);vec3 Cbottom=texture2D(colorTex,offset[1].zw).rgb;t=abs(C-Cbottom);delta.w=max(max(t.r,t.g),t.b);float maxDelta=max(max(max(delta.x,delta.y),delta.z),delta.w);vec3 Cleftleft=texture2D(colorTex,offset[2].xy).rgb;t=abs(C-Cleftleft);delta.z=max(max(t.r,t.g),t.b);vec3 Ctoptop=texture2D(colorTex,offset[2].zw).rgb;t=abs(C-Ctoptop);delta.w=max(max(t.r,t.g),t.b);maxDelta=max(max(maxDelta,delta.z),delta.w);edges.xy*=step(0.5*maxDelta,delta.xy);return vec4(edges,0.0,0.0);}void main(){gl_FragColor=SMAAColorEdgeDetectionPS(vUv,vOffset,tDiffuse);}`})),this.program2||(this.program2=new Ca(i,{vertexShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
attribute vec3 position;attribute vec2 uv;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;void SMAABlendingWeightCalculationVS(vec2 texcoord){vPixcoord=texcoord/resolution;vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-0.25,0.125,1.25,0.125);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(-0.125,0.25,-0.125,-1.25);vOffset[2]=vec4(vOffset[0].xz,vOffset[1].yw)+vec4(-2.0,2.0,-2.0,2.0)*resolution.xxyy*float(SMAA_MAX_SEARCH_STEPS);}void main(){vUv=uv;SMAABlendingWeightCalculationVS(vUv);gl_Position=vec4(position,1.0);}`,fragmentShader:`precision highp float;
#define SMAA_MAX_SEARCH_STEPS 8
#define SMAA_AREATEX_MAX_DISTANCE 16
#define SMAA_AREATEX_PIXEL_SIZE ( 1.0 / vec2( 160.0, 560.0 ) )
#define SMAA_AREATEX_SUBTEX_SIZE ( 1.0 / 7.0 )
#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;uniform sampler2D tArea;uniform sampler2D tSearch;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[3];varying vec2 vPixcoord;vec2 round(vec2 x){return sign(x)*floor(abs(x)+0.5);}float SMAASearchLength(sampler2D searchTex,vec2 e,float bias,float scale){e.r=bias+e.r*scale;return 255.0*texture2D(searchTex,e,0.0).r;}float SMAASearchXLeft(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){/***@PSEUDO_GATHER4*This texcoord has been offset by(-0.25,-0.125)in the vertex shader to*sample between edge,thus fetching four edges in a row.*Sampling with different offsets in each direction allows to disambiguate*which edges are active from the four fetched ones.*/vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(2.0,0.0)*resolution;if(!(texcoord.x>end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x+=0.25*resolution.x;texcoord.x+=resolution.x;texcoord.x+=2.0*resolution.x;texcoord.x-=resolution.x*SMAASearchLength(searchTex,e,0.0,0.5);return texcoord.x;}float SMAASearchXRight(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(0.0,1.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(2.0,0.0)*resolution;if(!(texcoord.x<end&&e.g>0.8281&&e.r==0.0))break;}texcoord.x-=0.25*resolution.x;texcoord.x-=resolution.x;texcoord.x-=2.0*resolution.x;texcoord.x+=resolution.x*SMAASearchLength(searchTex,e,0.5,0.5);return texcoord.x;}float SMAASearchYUp(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord+=vec2(0.0,2.0)*resolution;if(!(texcoord.y>end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y-=0.25*resolution.y;texcoord.y-=resolution.y;texcoord.y-=2.0*resolution.y;texcoord.y+=resolution.y*SMAASearchLength(searchTex,e.gr,0.0,0.5);return texcoord.y;}float SMAASearchYDown(sampler2D edgesTex,sampler2D searchTex,vec2 texcoord,float end){vec2 e=vec2(1.0,0.0);for(int i=0;i<SMAA_MAX_SEARCH_STEPS;i++){e=texture2D(edgesTex,texcoord,0.0).rg;texcoord-=vec2(0.0,2.0)*resolution;if(!(texcoord.y<end&&e.r>0.8281&&e.g==0.0))break;}texcoord.y+=0.25*resolution.y;texcoord.y+=resolution.y;texcoord.y+=2.0*resolution.y;texcoord.y-=resolution.y*SMAASearchLength(searchTex,e.gr,0.5,0.5);return texcoord.y;}vec2 SMAAArea(sampler2D areaTex,vec2 dist,float e1,float e2,float offset){vec2 texcoord=float(SMAA_AREATEX_MAX_DISTANCE)*round(4.0*vec2(e1,e2))+dist;texcoord=SMAA_AREATEX_PIXEL_SIZE*texcoord+(0.5*SMAA_AREATEX_PIXEL_SIZE);texcoord.y+=SMAA_AREATEX_SUBTEX_SIZE*offset;return texture2D(areaTex,texcoord,0.0).rg;}vec4 SMAABlendingWeightCalculationPS(vec2 texcoord,vec2 pixcoord,vec4 offset[3],sampler2D edgesTex,sampler2D areaTex,sampler2D searchTex,ivec4 subsampleIndices){vec4 weights=vec4(0.0,0.0,0.0,0.0);vec2 e=texture2D(edgesTex,texcoord).rg;if(e.g>0.0){vec2 d;vec2 coords;coords.x=SMAASearchXLeft(edgesTex,searchTex,offset[0].xy,offset[2].x);coords.y=offset[1].y;d.x=coords.x;float e1=texture2D(edgesTex,coords,0.0).r;coords.x=SMAASearchXRight(edgesTex,searchTex,offset[0].zw,offset[2].y);d.y=coords.x;d=d/resolution.x-pixcoord.x;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(1,0)).r;weights.rg=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.y));}if(e.r>0.0){vec2 d;vec2 coords;coords.y=SMAASearchYUp(edgesTex,searchTex,offset[1].xy,offset[2].z);coords.x=offset[0].x;d.x=coords.y;float e1=texture2D(edgesTex,coords,0.0).g;coords.y=SMAASearchYDown(edgesTex,searchTex,offset[1].zw,offset[2].w);d.y=coords.y;d=d/resolution.y-pixcoord.y;vec2 sqrt_d=sqrt(abs(d));coords.y-=1.0*resolution.y;float e2=SMAASampleLevelZeroOffset(edgesTex,coords,ivec2(0,1)).g;weights.ba=SMAAArea(areaTex,sqrt_d,e1,e2,float(subsampleIndices.x));}return weights;}void main(){gl_FragColor=SMAABlendingWeightCalculationPS(vUv,vPixcoord,vOffset,tDiffuse,tArea,tSearch,ivec4(0.0));}`})),this.program3||(this.program3=new Ca(i,{vertexShader:"precision highp float;uniform vec2 resolution;attribute vec3 position;attribute vec2 uv;varying vec2 vUv;varying vec4 vOffset[2];void SMAANeighborhoodBlendingVS(vec2 texcoord){vOffset[0]=texcoord.xyxy+resolution.xyxy*vec4(-1.0,0.0,0.0,1.0);vOffset[1]=texcoord.xyxy+resolution.xyxy*vec4(1.0,0.0,0.0,-1.0);}void main(){vUv=uv;SMAANeighborhoodBlendingVS(vUv);gl_Position=vec4(position,1.0);}",fragmentShader:"precision highp float;uniform sampler2D tDiffuse;uniform sampler2D tColor;uniform vec2 resolution;varying vec2 vUv;varying vec4 vOffset[2];vec4 SMAANeighborhoodBlendingPS(vec2 texcoord,vec4 offset[2],sampler2D colorTex,sampler2D blendTex){vec4 a;a.xz=texture2D(blendTex,texcoord).xz;a.y=texture2D(blendTex,offset[1].zw).g;a.w=texture2D(blendTex,offset[1].xy).a;if(dot(a,vec4(1.0,1.0,1.0,1.0))<1e-5){return texture2D(colorTex,texcoord,0.0);}else{vec2 offset;offset.x=a.a>a.b ? a.a :-a.b;offset.y=a.g>a.r ?-a.g : a.r;if(abs(offset.x)>abs(offset.y)){offset.y=0.0;}else{offset.x=0.0;}vec4 C=texture2D(colorTex,texcoord,0.0);texcoord+=sign(offset)*resolution;vec4 Cop=texture2D(colorTex,texcoord,0.0);float s=abs(offset.x)>abs(offset.y)? abs(offset.x): abs(offset.y);C.xyz=pow(C.xyz,vec3(2.2));Cop.xyz=pow(Cop.xyz,vec3(2.2));vec4 mixed=mix(C,Cop,s);mixed.xyz=pow(mixed.xyz,vec3(1.0/2.2));return mixed;}}void main(){gl_FragColor=SMAANeighborhoodBlendingPS(vUv,vOffset,tColor,tDiffuse);}"})),!this.vertexBuffer||!this.sampleBuffer){this.vertexBuffer=new qm({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new qm({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord));var s=[{stride:12,name:"position",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"uv",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}];this.vertexArray1=new sy({gl:i,program:this.program1,attributes:s}),this.vertexArray2=new sy({gl:i,program:this.program2,attributes:s}),this.vertexArray3=new sy({gl:i,program:this.program3,attributes:s})}return{program1:this.program1,program2:this.program2,program3:this.program3}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new ms(i),this.bloomBuffer=new ms(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new ms(i)),this.bloomBuffer||(this.bloomBuffer=new ms(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo,this.getOptions(),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var c=this.getProgram(s),g=c.program1,p=c.program2;c=c.program3;var A=this.getExtraFbo(s),S=A.collectBrightBuffer;A=A.bloomBuffer;var N=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,N),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(g.attributes.position),s.vertexAttribPointer(g.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.position),s.vertexAttribPointer(p.attributes.position,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.position),s.vertexAttribPointer(c.attributes.position,3,s.FLOAT,!1,0,0),N=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,N),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(g.attributes.uv),s.vertexAttribPointer(g.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.uv),s.vertexAttribPointer(p.attributes.uv,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(c.attributes.uv),s.vertexAttribPointer(c.attributes.uv,2,s.FLOAT,!1,0,0),s.useProgram(g.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(g.uniforms.tDiffuse,2),s.uniform2fv(g.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,A),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(p.uniforms.uSampler,2),s.uniform2fv(p.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(c.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE2),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(c.uniforms.tDiffuse,2),s.activeTexture(s.TEXTURE3),s.bindTexture(s.TEXTURE_2D,A.texture),s.uniform1i(c.uniforms.tColor,3),s.uniform2fv(c.uniforms.resolution,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}},{key:"getAreaTexture",value:function(){return"data:image/png;base64,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"}},{key:"getSearchTexture",value:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAIAAADiVupLAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAFZJREFUeNrs00EKgAAIRNEZ739mTQoiwmhRi4L/FiKiu9ERISkzbXdTVV3H4WhfOG6ehl1rNR7qDSF8hwkVcJXt+3A//I0Nv0GoCBUAAAAAAMA/LAIMAB+Dcg2OE2zsAAAAAElFTkSuQmCC"}}]),r}(Nd),function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;varying vec2 vTextureCoord;void main(){float fStep=1.0/512.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;gl_FragColor=blurSample;}"}),this.vertexBuffer=new qm({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.sampleBuffer=new qm({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}),this.vertexBuffer.updateData(new Float32Array(this.vertex)),this.sampleBuffer.updateData(new Float32Array(this.sampleCoord)),this.vertexArray=new sy({gl:i,program:this.programSample,attributes:[{stride:12,name:"aPos",buffer:this.vertexBuffer,size:3,type:"FLOAT",offset:0},{stride:8,name:"aTextureCoord",buffer:this.sampleBuffer,size:2,type:"FLOAT",offset:0}]})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture,s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var f=this.getProgram(s);f.use(s),this.vertexArray.bind(),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Nd),function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-(1.0-threshold)/5.0));float brightness=dot(color.rgb,vec3(0.2126,0.7152,0.0722));if(brightness>threshold){color=lightColor;}else{color=vec4(0.0);}gl_FragColor=color;}"})),this.programBloom||(this.programBloom=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord);vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new ms(i),this.bloomBuffer=new ms(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new ms(i)),this.bloomBuffer||(this.bloomBuffer=new ms(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions();s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var g=this.getProgram(s),p=g.programBright,A=g.programBloom;g=g.programResult;var S=this.getExtraFbo(s),N=S.collectBrightBuffer;S=S.bloomBuffer;var w=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,w),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(g.attributes.aPos),s.vertexAttribPointer(g.attributes.aPos,3,s.FLOAT,!1,0,0),w=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,w),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(g.attributes.aTextureCoord),s.vertexAttribPointer(g.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.uSampler,1),s.uniform1f(p.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,S),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!0),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,S.texture),s.uniform1i(A.uniforms.uSampler,1),s.uniform1i(A.uniforms.isVertical,!1),s.uniform1f(A.uniforms.blurSize,c.blurSize||2),s.uniform1f(A.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(A.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(g.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(g.uniforms.originalTexture,1),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(g.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Nd),function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){return this.programBright||(this.programBright=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform float threshold;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(uSampler,vTextureCoord);vec4 lightColor=max(vec4(0.0),(color-threshold));gl_FragColor=lightColor;}"})),this.programBloom||(this.programBloom=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform bool isVertical;uniform vec2 canvasSize;uniform float blurSize;uniform float devicePixelRatio;varying vec2 vTextureCoord;void main(){float weight[10];weight[0]=0.2270270270;weight[1]=0.1945945946;weight[2]=0.1216216216;weight[3]=0.1135135135;weight[4]=0.0972972973;weight[5]=0.0608108108;weight[6]=0.0540540541;weight[7]=0.0270270270;weight[8]=0.0162162162;weight[9]=0.0081081081;vec2 offset=vec2(blurSize/canvasSize.x,blurSize/canvasSize.y)*devicePixelRatio;vec4 result=texture2D(uSampler,vTextureCoord)*weight[0];if(isVertical){for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(0.0,offset.y*float(i)))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(0.0,offset.y*float(i)))*weight[i];}}else{for(int i=1;i<10;++i){result+=texture2D(uSampler,vTextureCoord+vec2(offset.x*float(i),0.0))*weight[i];result+=texture2D(uSampler,vTextureCoord-vec2(offset.x*float(i),0.0))*weight[i];}}gl_FragColor=result;}"})),this.programResult||(this.programResult=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D originalTexture;uniform sampler2D bloomTexture;uniform float toneScale;varying vec2 vTextureCoord;void main(){vec4 color=texture2D(originalTexture,vTextureCoord)*toneScale;vec4 bloomColor=texture2D(bloomTexture,vTextureCoord);color+=bloomColor;gl_FragColor=color;}"})),{programBright:this.programBright,programBloom:this.programBloom,programResult:this.programResult}}},{key:"onResize",value:function(i){this.collectBrightBuffer=new ms(i),this.bloomBuffer=new ms(i)}},{key:"getExtraFbo",value:function(i){return this.collectBrightBuffer||(this.collectBrightBuffer=new ms(i)),this.bloomBuffer||(this.bloomBuffer=new ms(i)),{collectBrightBuffer:this.collectBrightBuffer.framebuffer,bloomBuffer:this.bloomBuffer.framebuffer}}},{key:"render",value:function(i){var s=i.gl,f=i.texture;i=i.fbo;var c=this.getOptions(),g="clarity"in c?c.clarity:1;g=Math.max(0,g),g=Math.min(1,g),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var p=this.getProgram(s),A=p.programBright,S=p.programBloom;p=p.programResult;var N=this.getExtraFbo(s),w=N.collectBrightBuffer;N=N.bloomBuffer;var I=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aPos),s.vertexAttribPointer(A.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aPos),s.vertexAttribPointer(S.attributes.aPos,3,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aPos),s.vertexAttribPointer(p.attributes.aPos,3,s.FLOAT,!1,0,0),I=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,I),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(A.attributes.aTextureCoord),s.vertexAttribPointer(A.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(S.attributes.aTextureCoord),s.vertexAttribPointer(S.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.enableVertexAttribArray(p.attributes.aTextureCoord),s.vertexAttribPointer(p.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.useProgram(A.program),s.bindFramebuffer(s.FRAMEBUFFER,w),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(A.uniforms.uSampler,1),s.uniform1f(A.uniforms.threshold,c.threshold||0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,N),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,w.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!0),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(S.program),s.bindFramebuffer(s.FRAMEBUFFER,w),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,N.texture),s.uniform1i(S.uniforms.uSampler,1),s.uniform1i(S.uniforms.isVertical,!1),s.uniform1f(S.uniforms.blurSize,c.blurSize||2),s.uniform1f(S.uniforms.devicePixelRatio,window.devicePixelRatio),s.uniform2fv(S.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.useProgram(p.program),s.bindFramebuffer(s.FRAMEBUFFER,i),s.clearColor(0,0,0,0),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,f),s.uniform1i(p.uniforms.originalTexture,1),s.uniform1f(p.uniforms.toneScale,g),s.activeTexture(s.TEXTURE0),s.bindTexture(s.TEXTURE_2D,w.texture),s.uniform1i(p.uniforms.bloomTexture,0),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3),s.bindBuffer(s.ARRAY_BUFFER,null),s.useProgram(null)}}]),r}(Nd),function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"getProgram",value:function(i){return this.programSample||(this.programSample=new Ca(i,{vertexShader:"attribute vec3 aPos;attribute vec2 aTextureCoord;varying vec2 vTextureCoord;void main(){vTextureCoord=aTextureCoord;gl_Position=vec4(aPos,1.0);}",fragmentShader:"precision mediump float;uniform sampler2D uSampler;uniform vec2 canvasSize;varying vec2 vTextureCoord;void main(){float fStep=1.0/312.0;vec4 sample11=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample12=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t+1.0*fStep));vec4 sample13=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t+1.0*fStep));vec4 sample21=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t));vec4 sample22=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t));vec4 sample23=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t));vec4 sample31=texture2D(uSampler,vec2(vTextureCoord.s-1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 sample32=texture2D(uSampler,vec2(vTextureCoord.s,vTextureCoord.t-1.0*fStep));vec4 sample33=texture2D(uSampler,vec2(vTextureCoord.s+1.0*fStep,vTextureCoord.t-1.0*fStep));vec4 blurSample=(sample11+sample12+sample13+sample21+2.0*sample22+sample23+sample31+sample32+sample33)/10.0;float desX=abs((gl_FragCoord.x-canvasSize.x/2.0)/(canvasSize.x/2.0));float desY=abs((gl_FragCoord.y-canvasSize.y/2.0)/(canvasSize.y/2.0));float factor=max(desX,desY);gl_FragColor=(sample22*(1.0-factor)+blurSample*factor);}"})),this.programSample}},{key:"render",value:function(i){var s=i.gl;i=i.texture;var f=this.getProgram(s);s.useProgram(f.program);var c=s.createBuffer();s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.vertex),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aPos),s.vertexAttribPointer(f.attributes.aPos,3,s.FLOAT,!1,0,0),c=s.createBuffer(),s.bindBuffer(s.ARRAY_BUFFER,c),s.bufferData(s.ARRAY_BUFFER,new Float32Array(this.sampleCoord),s.STATIC_DRAW),s.enableVertexAttribArray(f.attributes.aTextureCoord),s.vertexAttribPointer(f.attributes.aTextureCoord,2,s.FLOAT,!1,0,0),s.activeTexture(s.TEXTURE1),s.bindTexture(s.TEXTURE_2D,i),s.uniform1i(f.uniforms.uSampler,1),s.uniform2fv(f.uniforms.canvasSize,[s.canvas.width,s.canvas.height]),s.drawArrays(s.TRIANGLES,0,this.vertex.length/3)}}]),r}(Nd);var HC=function(){function t(r){Ri(this,t),this.gl=r,this.effects=[],this.initFbo()}return tn(t,[{key:"addEffect",value:function(r){this.effects.push(r)}},{key:"removeEffect",value:function(r){}},{key:"setEffects",value:function(r){this.effects=r}},{key:"onResize",value:function(){this.initFbo();var r=this.gl,i=this.effects;if(i&&1<i.length)for(var s=1;s<i.length;s++){var f=i[s];f.onResize&&f.onResize(r)}}},{key:"initFbo",value:function(){var r=this.gl;r&&(this.fbo=[new ms(r),new ms(r)])}},{key:"destroy",value:function(){this.effects=[],this.fbo=[],this.gl=null}},{key:"render",value:function(){var r=this.gl,i=this.effects;if(i&&0<i.length)for(var s={},f=0;f<i.length;f++){var c=this.fbo[f%2].framebuffer;f===i.length-1&&(c=null),r.bindFramebuffer(r.FRAMEBUFFER,c);var g=[0,0,0,0];r.clearColor(g[0],g[1],g[2],g[3]),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT),i[f].render({isPickRender:!1,gl:r,texture:s.texture,fbo:c}),s=c}}}]),t}(),Km=function(){function t(r,i){Ri(this,t),this.map=r,this.options=i||{},this.eventMap={}}return tn(t,[{key:"onResize",value:function(r){}},{key:"onUpdate",value:function(r){throw"\u672A\u5B9E\u73B0onUpdate\u65B9\u6CD5"}},{key:"getContainer",value:function(){throw"\u672A\u5B9E\u73B0getContainer\u65B9\u6CD5"}},{key:"getSize",value:function(){throw"\u672A\u5B9E\u73B0getSize\u65B9\u6CD5"}},{key:"getTilt",value:function(){throw"\u672A\u5B9E\u73B0getTilt\u65B9\u6CD5"}},{key:"getHeading",value:function(){throw"\u672A\u5B9E\u73B0getHeading\u65B9\u6CD5"}},{key:"getZoomUnits",value:function(){throw"\u672A\u5B9E\u73B0getZoomUnits\u65B9\u6CD5"}},{key:"getCenter",value:function(){throw"\u672A\u5B9E\u73B0getCenter\u65B9\u6CD5"}},{key:"getMapType",value:function(){throw"\u672A\u5B9E\u73B0getMapType\u65B9\u6CD5"}},{key:"lnglatToMercator",value:function(r,i){return this.options.coordinateSystem==="gcj02"?(i=i*Math.PI/180,i=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),[parseFloat((r*Math.PI/180*6378137).toFixed(2)),parseFloat(i.toFixed(2))]):(r=ba.convertLL2MC({lng:r,lat:i}),[r.lng,r.lat])}}]),t}(),kC=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.eventMap={},i}return Yn(r,t),tn(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("click",i),this.eventMap.click=i}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"onUpdate",value:function(i){this.map.addEventListener("update",i),this.map.addEventListener("onearthstatuschange",i),this.eventMap.update=i,this.eventMap.onearthstatuschange=i}},{key:"extendCallback",value:function(i){return function(s){i(ut(s,{x:s.x,y:s.y}))}}},{key:"unbind",value:function(i){var s=this;this.eventMap[i]?(this.map.removeEventListener(i,this.eventMap[i]),delete this.eventMap[i]):(Pi(this.eventMap).forEach(function(f){s.map.removeEventListener(f,s.eventMap[f])}),this.eventMap={})}},{key:"getContainer",value:function(){return this.map.getContainer()}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return this.map.getTilt()}},{key:"getHeading",value:function(){return this.map.getHeading()}},{key:"getZoomUnits",value:function(){return this.map.getZoomUnits()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getCenter",value:function(){var i=this.map.getCenter();return-180<=i.lng&&180>=i.lng&&(i=this.map.lnglatToMercator(i.lng,i.lat),i={lng:i[0],lat:i[1]}),i}},{key:"getMapType",value:function(){return this.map.getMapType()}},{key:"lnglatToMercator",value:function(i,s){return this.map.lnglatToMercator(i,s)}},{key:"mercatorToLnglat",value:function(i,s){return this.map.mercatorToLnglat(i,s)}},{key:"pixelToPointIn",value:function(i){return i=this.map.pixelToPointIn(i),this.mercatorToLnglat(i.lng,i.lat)}}]),r}(Km),GC=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.div=document.createElement("div"),i.div.style.position="absolute",i.div.style.userSelect="none",i.map.getPanes().mapPane.appendChild(i.div),i.eventMap={},i}return Yn(r,t),tn(r,[{key:"onResize",value:function(i){this.map.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onMousemove",value:function(i){i=this.extendCallback(i),this.map.addEventListener("mousemove",i),this.eventMap.mousemove=i}},{key:"onClick",value:function(i){i=this.extendCallback(i),PC?(this.map.addEventListener("touchend",i),this.eventMap.touchend=i):(this.map.addEventListener("click",i),this.eventMap.click=i)}},{key:"onDblClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("dblclick",i),this.eventMap.dblclick=i}},{key:"onRightClick",value:function(i){i=this.extendCallback(i),this.map.addEventListener("rightclick",i),this.eventMap.rightclick=i}},{key:"changeCanvas",value:function(){var i=this.map,s=i.getSize(),f=i.getCenter();i=i.pointToOverlayPixel(f),this.div.style.left=i.x-s.width/2+"px",this.div.style.top=i.y-s.height/2+"px"}},{key:"onUpdate",value:function(i){var s=this,f=function(){s.changeCanvas(),i()};this.map.addEventListener("moveend",f),this.map.addEventListener("moving",f),this.map.addEventListener("zoomend",f),this.eventMap.moveend=f,this.eventMap.moving=f,this.eventMap.zoomend=f}},{key:"extendCallback",value:function(i){return function(s){i(ut(s,{x:s.pixel.x,y:s.pixel.y}))}}},{key:"unbind",value:function(){var i=this;Pi(this.eventMap).forEach(function(s){i.map.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.div}},{key:"getSize",value:function(){return this.map.getSize()}},{key:"getBounds",value:function(){return this.map.getBounds()}},{key:"getTilt",value:function(){return 0}},{key:"getHeading",value:function(){return 0}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"getZoomUnits",value:function(){var i=this.getZoom();return this.map.getMapType().getZoomUnits?this.map.getMapType().getZoomUnits(i):Math.pow(2,18-i)}},{key:"getCenter",value:function(){var i=this.map.getMapType().getProjection().lngLatToPoint(this.map.getCenter());return{lng:i.x,lat:i.y}}},{key:"lnglatToMercator",value:function(i,s){return i=this.map.getMapType().getProjection().lngLatToPoint({lng:i,lat:s}),[i.x,i.y]}},{key:"mercatorToLnglat",value:function(i,s){return i=this.map.getMapType().getProjection().pointToLngLat({lng:i,lat:s}),[i.lng,i.lat]}}]),r}(Km),bC=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.eventMap={},i}return Yn(r,t),tn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Pi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container.getElementsByClassName("cesium-widget")[0]}},{key:"getSize",value:function(){var i=this.map;return{width:i.canvas.clientWidth,height:i.canvas.clientHeight}}},{key:"getTilt",value:function(){return 180*this.map.camera.pitch/Math.PI+90}},{key:"getHeading",value:function(){return 360-180*this.map.camera.heading/Math.PI}},{key:"getZoomUnits",value:function(){var i=this.map;return 6.8*i.scene.globe.ellipsoid.cartesianToCartographic(i.camera.position).height/6500}},{key:"getZoom",value:function(){return 10}},{key:"getCenter",value:function(){var i=this.map;return i=i.camera.pickEllipsoid(new Cesium.Cartesian2(i.canvas.clientWidth/2,i.canvas.clientHeight/2)),i=Cesium.Ellipsoid.WGS84.cartesianToCartographic(i),i=this.getMercator([180*i.longitude/Math.PI,180*i.latitude/Math.PI]),{lng:i[0],lat:i[1]}}},{key:"getMercator",value:function(i){var s=[];return s[0]=i[0]*Math.PI/180*6378137,i=i[1]*Math.PI/180,s[1]=31890685e-1*Math.log((1+Math.sin(i))/(1-Math.sin(i))),s}}]),r}(Km),VC=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.eventMap={},i}return Yn(r,t),tn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Pi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getZoom",value:function(){return this.map.zoom}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Km),WC=function(t){function r(i,s){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i,s)),i.eventMap={},i}return Yn(r,t),tn(r,[{key:"onResize",value:function(i){window.addEventListener("resize",i),this.eventMap.resize=i}},{key:"onUpdate",value:function(i){}},{key:"unbind",value:function(){var i=this;Pi(this.eventMap).forEach(function(s){window.removeEventListener(s,i.eventMap[s])}),this.eventMap={}}},{key:"getContainer",value:function(){return this.map.container}},{key:"getSize",value:function(){return{width:this.map.container.clientWidth,height:this.map.container.clientHeight}}},{key:"getTilt",value:function(){return this.map.tilt}},{key:"getHeading",value:function(){return this.map.heading}},{key:"getZoomUnits",value:function(){return this.map.zoomUnits}},{key:"getCenter",value:function(){return this.map.center}}]),r}(Km),jC=function(){function t(r,i){var s=this;Ri(this,t),i=i||{},i.mapType==="bmap"?this.map=new GC(r,i):i.mapType==="blank"?this.map=new VC(r,i):i.mapType==="cesium"?this.map=new bC(r,i):i.mapType==="three"?this.map=new WC(r,i):(i.mapType="bmapgl",this.map=new kC(r,i)),this.map.type=i.mapType,this._dpr=window.devicePixelRatio,i.mapType==="bmapgl"&&(this._dpr=this.map.map.config.ratio),this.options=i||{},this.renderArr=[],(r=i.canvas)||(r=document.createElement("canvas")),this.canvas=r,this.gl=i.gl?i.gl:eo(r,i),["OES_texture_float","OES_element_index_uint","WEBGL_color_buffer_float","EXT_float_blend"].forEach(function(f){s.gl.getExtension(f)}),this.changeSize(),this.projectionMatrix=Co.create(Float64Array),this.orthoMatrix=Co.create(Float64Array),this.matrix=Co.create(Float64Array),this.viewMatrix=Co.create(Float64Array),this.pointToPixelMatrix=Co.create(Float64Array),this.pixelToViewMatrix=Co.create(Float64Array),this.fovy=35,this.fps=Math.min(i.fps,60)||60,this.renderTime=new Date().valueOf(),this._animation=this.animation.bind(this),this._update=this.update.bind(this),this.onInitialize(this.options.onInitialize),this.options.onRender&&this.renderArr.push(this.options.onRender),this.stateManager=new zC({gl:this.gl}),this.pickFBO=new ms(this.gl),this.transferOptions={},this.bind()}return tn(t,[{key:"bind",value:function(){var r=this,i=this.map;i.onResize(function(){r.changeSize(),r.render()}),i.onUpdate(this._update),i.onClick&&i.onClick(function(s){r.onClick&&r.onClick(s)}),i.onDblClick&&i.onDblClick(function(s){r.onDblClick&&r.onDblClick(s)}),i.onRightClick&&i.onRightClick(function(s){r.onRightClick&&r.onRightClick(s)}),i.onMousemove&&i.onMousemove(function(s){r.onMousemove&&r.onMousemove(s)}),this.options.canvas||i.getContainer().appendChild(this.canvas)}},{key:"unbind",value:function(){var r=this.map;r.unbind&&r.unbind()}},{key:"setOptions",value:function(r){this.options=r}},{key:"onInitialize",value:function(r){r&&(this.transferOptions=r.bind(this)(this.gl)||{})}},{key:"bindFramebuffer",value:function(r){var i=this.gl;r?i.bindFramebuffer(i.FRAMEBUFFER,r.framebuffer):i.bindFramebuffer(i.FRAMEBUFFER,null)}},{key:"saveFramebuffer",value:function(){var r=this.gl;this.preFramebuffer=r.getParameter(r.FRAMEBUFFER_BINDING)}},{key:"restoreFramebuffer",value:function(){var r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,this.preFramebuffer)}},{key:"onRender",value:function(r){this.renderArr.push(r)}},{key:"changeSize",value:function(){var r=this.canvas,i=this.options;if(r){var s=r.style,f=this.map.getSize(),c=this._dpr;r.width=f.width*c,r.height=f.height*c,s.cssText="position: absolute;left:0;top:0;width:"+f.width+"px;height:"+f.height+"px;z-index:2;",i.mapType!=="cesium"||i.canvas||(s.pointerEvents="none"),this.gl.viewport(0,0,r.width,r.height)}}},{key:"update",value:function(){this.options.autoUpdate===!1||this.isAnimation&&60<=this.fps||this.render()}},{key:"pixelToPointIn",value:function(r){return this.map.pixelToPointIn(r)}},{key:"render",value:function(){if(this.map&&this.gl){var r=this.options,i=this.projectionMatrix,s=this.viewMatrix;if(r.mapType==="three")s=this.map.map.camera,i=s.projectionMatrix.elements,s=s.matrixWorldInverse.elements;else if(r.mapType==="cesium"){s=this.map.map;var f=s.camera.frustum.projectionMatrix;i=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]]),f=s.camera.viewMatrix,s=new Float32Array([f[0],f[1],f[2],f[3],f[4],f[5],f[6],f[7],f[8],f[9],f[10],f[11],f[12],f[13],f[14],f[15]])}else this.map.map.mapType==="B_EARTH_MAP"?(i=this.map.map.getEarth().scene._camera.getProjectionMatrix(),s=this.map.map.getEarth().scene._camera.getModelViewMatrix()):(this.updateProjectionMatrix(),this.updateModelViewMatrix());for(f=Co.multiply(this.matrix,i,s),ut(this.transferOptions,{gl:this.gl,matrix:f,pointToPixelMatrix:this.pointToPixelMatrix,pixelToViewMatrix:this.pixelToViewMatrix,projectionMatrix:i,orthoMatrix:this.orthoMatrix,viewMatrix:s,stateManager:this.stateManager}),r.mapType!=="three"&&r.mapType!=="cesium"&&r.autoUpdate!==!1&&this.clear(),r=0;r<this.renderArr.length;r++)this.renderArr[r]&&this.renderArr[r].bind(this)(this.transferOptions)}}},{key:"clear",value:function(r){var i=this.gl,s=this.options.clearColor||[0,0,0,0];i.clearColor(s[0],s[1],s[2],s[3]),r&&(r instanceof Array||(r=to(r).unitArray()),i.clearColor(r[0],r[1],r[2],r[3])),i.clear(i.COLOR_BUFFER_BIT|i.DEPTH_BUFFER_BIT)}},{key:"updateProjectionMatrix",value:function(){var r=this.options.cameraNear||1,i=this.options.cameraFar||4e3;Co.perspective(this.projectionMatrix,this.fovy*Math.PI/180,this.gl.canvas.width/this.gl.canvas.height,r,i);var s=this.map.getSize();Co.ortho(this.orthoMatrix,-s.width/2,s.width/2,-s.height/2,s.height/2,r,i)}},{key:"updateModelViewMatrix",value:function(){var r=this.map,i=this.viewMatrix,s=this.pointToPixelMatrix,f=this.pixelToViewMatrix;Co.identity(i),Co.identity(s),Co.identity(f);var c=r.getSize();Co.translate(f,f,[0,0,Math.round(-c.height/(2*Math.tan(this.fovy*Math.PI/180/2)))]),Co.rotate(f,f,r.getTilt()*Math.PI/180,[-1,0,0]),Co.rotate(f,f,r.getHeading()*Math.PI/180,[0,0,-1]),c=r.getCenter();var g=this.options.pointOffset||[0,0];r=r.getZoomUnits(),Co.translate(s,s,[(g[0]-c.lng)/r,(g[1]-c.lat)/r,0]),r=1/r,Co.scale(s,s,[r,r,r]),Co.multiply(i,f,s)}},{key:"destroy",value:function(){this.stopAnimation(),this.unbind();var r=this.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this.canvas.remove(),this.gl=this.canvas=null}},{key:"animation",value:function(){if(this.isAnimation){if(60<=this.fps)this.render();else{var r=new Date().valueOf(),i=Math.floor(1e3/this.fps),s=r-this.renderTime;s>i&&(this.render(),this.renderTime=r-s%i)}window.requestAnimationFrame(this._animation)}}},{key:"startAnimation",value:function(){this.isAnimation||(this.isAnimation=!0,window.requestAnimationFrame(this._animation))}},{key:"stopAnimation",value:function(){this.isAnimation=!1}}]),t}(),XC=function(){function t(r){Ri(this,t),this.layers=[],this.options=r,this.webglLayer=r.webglLayer}return tn(t,[{key:"addLayer",value:function(r){for(var i=!1,s=0;s<this.layers.length;s++)if(this.layers[s]===r){i=!0;break}i||(r.map=this.webglLayer.map,r.layerType==="threeLayer"?(r.setWebglLayer(this.webglLayer),i=r.getThreeLayer(),this.addLayer(i),r.initialize&&r.initialize(i)):(r.setWebglLayer(this.webglLayer),r.commonInitialize&&r.commonInitialize(this.webglLayer.gl),r.initialize&&r.initialize(this.webglLayer.gl),r.onOptionsChanged(r.getOptions(),{}),r.onDataChanged(r.getData()),r.onChanged(r.getOptions(),r.getData())),this.putInLayer(r)),this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"putInLayer",value:function(r){r.options.renderOrder===void 0&&(r.options.renderOrder=this.layers.length),this.layers.push(r),this.layers=this.layers.sort(function(i,s){return i.options.renderOrder-s.options.renderOrder})}},{key:"removeLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&this.layers.splice(i,1);this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"showLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.show();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"hideLayer",value:function(r){for(var i=0;i<this.layers.length;i++)this.layers[i]===r&&r.hide();this.options.autoUpdate&&(this.isRequestAnimation()?this.webglLayer.startAnimation():this.webglLayer.stopAnimation()),this.webglLayer.render()}},{key:"removeAllLayers",value:function(){this.layers=[],this.webglLayer.stopAnimation(),this.webglLayer.render()}},{key:"destroyAllLayers",value:function(){for(var r=0;r<this.layers.length;r++){var i=this.layers[r];i.destroy&&i.destroy()}}},{key:"getAllLayers",value:function(){return this.layers}},{key:"getAllThreeLayers",value:function(){for(var r=[],i=0;i<this.layers.length;i++){var s=this.layers[i];s.layerType==="ThreeLayer"&&r.push(s)}return r}},{key:"isRequestAnimation",value:function(){for(var r=!1,i=0;i<this.layers.length;i++)if(this.layers[i].isRequestAnimation()){r=!0;break}return r}},{key:"beforeRender",value:function(r){r.gl&&this.webglLayer.stateManager.setDefaultState()}},{key:"afterRender",value:function(r){(r=r.gl)&&(r.bindBuffer(r.ARRAY_BUFFER,null),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),r.useProgram(null))}},{key:"renderGLLayers",value:function(r){this.webglLayer.stateManager.save();for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||(this.beforeRender(r),s.render(r),this.afterRender(r))}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayer",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"renderThreeLayers",value:function(r){this.webglLayer.stateManager.save(),this.webglLayer.stateManager.setState({blendFunc:[r.gl.SRC_ALPHA,r.gl.ONE],depthMask:!1,depthTest:!0,depthFunc:r.gl.LESS,cullFace:!1});for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType==="threeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<c[0]||f>=c[1])||s.render(r)}}this.webglLayer.stateManager.restore()}},{key:"onClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onClick||!s.pick||(f=s.pick(r.x,r.y,"onClick"),s.options.onClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onDblClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onDblClick||!s.pick||(f=s.pick(r.x,r.y,"onDblClick"),s.options.onDblClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onRightClick",value:function(r){for(var i=0;i<this.layers.length;i++){var s=this.layers[i];if(s._visible===!0&&s.layerType!=="threeLayer"&&s.layerType!=="ThreeLayer"){var f=s.map.getZoom(),c=s.getOptions().zoomThreshold;c&&(f<=c[0]||f>=c[1])||!s.options.enablePicked||!s.options.onRightClick||!s.pick||(f=s.pick(r.x,r.y,"onRightClick"),s.options.onRightClick(f,r),s.options.autoSelect&&this.webglLayer.render())}}}},{key:"onMousemove",value:function(r){for(var i=!1,s=0;s<this.layers.length;s++){var f=this.layers[s];if(f._visible===!0&&f.layerType!=="threeLayer"&&f.layerType!=="ThreeLayer"){var c=f.map.getZoom(),g=f.getOptions().zoomThreshold;(!g||!(c<=g[0]||c>=g[1]))&&f.options.enablePicked&&f.pick&&(f.options.onMousemove||f.options.autoSelect)&&(c=f.pick(r.x,r.y,"onMousemove"),this.webglLayer.map.map.platform.style.cursor=c.dataIndex===-1?"default":"pointer",f.options.onMousemove&&f.options.onMousemove(c,r),f.options.autoSelect&&(i=!0))}}i&&(this.webglLayer.isAnimation||this.webglLayer.render())}},{key:"destroy",value:function(){this.destroyAllLayers(),this.removeAllLayers()}}]),t}();(function(){function t(r){var i=this;Ri(this,t),this.options={autoUpdate:!0},this._visible=!0,ut(this.options,r);var s=r.pointOffset;this.webglLayer=r.webglLayer||new jC(r.map,this.options),this.layerManager=new XC({autoUpdate:this.options.autoUpdate,webglLayer:this.webglLayer}),this.effectManager=new HC(this.webglLayer.gl),this.webglRender={render:function(){}},this.options.effects&&this.effectManager.setEffects([this.webglRender].concat(this.options.effects)),this.webglLayer.onRender(function(f){i._render(f)}),this.webglLayer.onClick=function(f){i._visible&&i.layerManager.onClick(f)},this.webglLayer.onDblClick=function(f){i._visible&&i.layerManager.onDblClick(f)},this.webglLayer.onRightClick=function(f){i._visible&&i.layerManager.onRightClick(f)},this.webglLayer.onMousemove=function(f){i._visible&&i.layerManager.onMousemove(f)},s||this.webglLayer.options.mapType==="cesium"||(s=this.webglLayer.map.getCenter(),this.webglLayer.options.pointOffset=[s.lng,s.lat]),this.webglLayer.map.onResize(function(){i.effectManager.onResize()}),(this.postProcessing=r.postProcessing)&&(this.postProcessing.setWebglLayer(this.webglLayer),r=this.postProcessing.getThreeLayer(),this.addLayer(r),this.postProcessing.initialize(r),r.postProcessing=this.postProcessing)}return tn(t,[{key:"renderCanvas",value:function(r){var i=this;this.postProcessing?this.postProcessing.addRender(function(){i.layerManager.renderGLLayers(r)}):this.layerManager.renderGLLayers(r),this.layerManager.renderThreeLayers(r),this.layerManager.renderThreeLayer(r)}},{key:"render",value:function(){this.webglLayer&&this.webglLayer.render()}},{key:"_render",value:function(r){var i=this;if(this._visible){var s=this.options.effects;s&&0<s.length?(this.webglRender.render=function(){i.renderCanvas(r)},this.effectManager.render()):(this.webglLayer.saveFramebuffer(),this.renderCanvas(r),this.webglLayer.restoreFramebuffer())}}},{key:"onRender",value:function(r){this.webglLayer.onRender(r)}},{key:"destroy",value:function(){this.stopAnimation(),this.layerManager.destroy(),this.effectManager.destroy(),this.webglLayer.destroy()}},{key:"isRequestAnimation",value:function(){return this.layerManager.isRequestAnimation()}},{key:"startAnimation",value:function(){this.webglLayer.startAnimation()}},{key:"stopAnimation",value:function(){this.webglLayer.stopAnimation()}},{key:"show",value:function(){this._visible!==!0&&(this._visible=!0,this.webglLayer.render(),this.isRequestAnimation()&&this.startAnimation())}},{key:"hide",value:function(){this._visible!==!1&&(this._visible=!1,this.stopAnimation(),this.webglLayer.clear())}},{key:"showLayer",value:function(r){this.layerManager.showLayer(r)}},{key:"hideLayer",value:function(r){this.layerManager.hideLayer(r)}},{key:"add",value:function(r){this.addLayer(r)}},{key:"remove",value:function(r){this.removeLayer(r)}},{key:"addLayer",value:function(r){this.layerManager.addLayer(r)}},{key:"removeLayer",value:function(r){this.layerManager.removeLayer(r)}},{key:"removeAllLayers",value:function(){this.layerManager.removeAllLayers()}},{key:"getAllLayers",value:function(){return this.layerManager.getAllLayers()}},{key:"getAllThreeLayers",value:function(){return this.layerManager.getAllThreeLayers()}}]),t})();var gw=function(){function t(r){Ri(this,t),this._visible=!0,this.options=this.getCommonDefaultOptions(),this.options=ut(this.options,this.getDefaultOptions()),this.autoUpdate=!1,this.options=ut(this.options,r),this.options.data&&(this.data=this.options.data,delete this.options.data)}return tn(t,[{key:"getCommonDefaultOptions",value:function(){return{}}},{key:"getDefaultOptions",value:function(){return{}}},{key:"initialize",value:function(r){}},{key:"destroy",value:function(){this.onDestroy&&this.onDestroy()}},{key:"show",value:function(){this._visible=!0}},{key:"hide",value:function(){this._visible=!1}},{key:"render",value:function(){}},{key:"clear",value:function(){this.setData([])}},{key:"setData",value:function(r,i){i=i||{},this.data=r,this.onDataChanged&&this.onDataChanged(this.getData()),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getData",value:function(){return this.data||[]}},{key:"setOptions",value:function(r,i){r=r||{},i=i||{};var s=ut({},this.getOptions());ut(this.options,r),this.onOptionsChanged&&this.onOptionsChanged(this.getOptions(),s),this.onChanged&&this.onChanged(this.getOptions(),this.getData(),i),r.data?(this.setData(r.data,i),delete r.data):i.autoRender!==!1&&this.webglLayer&&this.webglLayer.render()}},{key:"getOptions",value:function(){return this.options||{}}},{key:"onOptionsChanged",value:function(r,i){}},{key:"onDataChanged",value:function(r){}},{key:"onChanged",value:function(r,i){}},{key:"onDestroy",value:function(){}},{key:"lnglatToMercator",value:function(r,i){}},{key:"setWebglLayer",value:function(r){this.webglLayer=r}},{key:"getWebglLayer",value:function(){return this.webglLayer}},{key:"isRequestAnimation",value:function(){return this.autoUpdate}}]),t}(),YC=Nn("iterator"),ZC=vi.isIterable=function(t){return t=Object(t),t[YC]!==void 0||"@@iterator"in t||Pn.hasOwnProperty(Hh(t))},Qm=It(function(t){t.exports={default:ZC,__esModule:!0}});zt(Qm);var JC=vi.getIterator=function(t){var r=dm(t);if(typeof r!="function")throw TypeError(t+" is not iterable!");return co(r.call(t))},$m=It(function(t){t.exports={default:JC,__esModule:!0}});zt($m);var qC=It(function(t,r){r.__esModule=!0;var i=Qm&&Qm.__esModule?Qm:{default:Qm},s=$m&&$m.__esModule?$m:{default:$m};r.default=function(){return function(f,c){if(Array.isArray(f))return f;if((0,i.default)(Object(f))){var g=[],p=!0,A=!1,S=void 0;try{for(var N=(0,s.default)(f),w;!(p=(w=N.next()).done)&&(g.push(w.value),!c||g.length!==c);p=!0);}catch(I){A=!0,S=I}finally{try{!p&&N.return&&N.return()}finally{if(A)throw S}}return g}throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()}),i2=zt(qC),KC=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.pickedColor=[-1,-1,-1],i}return Yn(r,t),tn(r,[{key:"getCommonDefaultOptions",value:function(){return{pickWidth:1,pickHeight:1,blend:"default",zIndex:0,zoomThreshold:[0,30],repeat:!1,enablePicked:!1,autoSelect:!1,selectedIndex:-1,selectedColor:"rgba(20, 20, 200, 1.0)"}}},{key:"commonInitialize",value:function(i){var s=this.getOptions();this.gl=i,s.enablePicked&&(this.pickBuffer=new qm({gl:i,target:"ARRAY_BUFFER",usage:"STATIC_DRAW"}))}},{key:"getCommonAttributes",value:function(){var i=[];return this.getOptions().enablePicked&&i.push({name:"aPickColor",buffer:this.pickBuffer,size:3,type:"FLOAT",stride:12,offset:0}),i}},{key:"getProperty",value:function(i,s,f){return Object.prototype.toString.call(s)==="[object Function]"?s(f):(s=f[i]||s,"properties"in f&&i in f.properties&&(s=f.properties[i]),s)}},{key:"normizedColor",value:function(i){var s=i;return i instanceof Array||(s=to(i).unitArray()),s[3]===void 0&&(s[3]=1),s}},{key:"normizedPoint",value:function(i){var s=this.getPointOffset();if(!i||i[0]===void 0||i[1]===void 0)return[s[0],s[1],0];var f=Number(i[0]),c=Number(i[1]);-180<=f&&180>=f&&-90<=c&&90>=c&&(c=this.webglLayer.map.lnglatToMercator(f,c),f=c[0],c=c[1]);var g=Number(i[2])||0;return this.webglLayer&&this.webglLayer.options.mapType==="cesium"&&window.Cesium?(f=this.convertLngLat([f,c]),g=window.Cesium.Cartesian3.fromDegrees(f[0],f[1],g),f=g.x,c=g.y,g=g.z):this.webglLayer&&this.webglLayer.options.mapType==="bmapgl"&&this.webglLayer.map.map.mapType==="B_EARTH_MAP"&&(f=this.convertLngLat([f,c]),g=this.webglLayer.map.map.getEarth().scene.fromLatLngToXYZ({lng:f[0],lat:f[1]}),f=g.x,c=g.y,g=g.z),3<i.length?[f-s[0],c-s[1],g].concat(uw(i.slice(3))):[f-s[0],c-s[1],g]}},{key:"convertLngLat",value:function(i){return[i[0]/2003750834e-2*180,180/Math.PI*(2*Math.atan(Math.exp(i[1]/2003750834e-2*180*Math.PI/180))-Math.PI/2)]}},{key:"getPointOffset",value:function(){var i=[0,0],s=this.getOptions();return this.webglLayer&&this.webglLayer.options.pointOffset?i=this.webglLayer.options.pointOffset:s.pointOffset&&(i=s.pointOffset),i}},{key:"indexToRgb",value:function(i){i++;var s=Math.floor(i/65536);i-=65536*s;var f=Math.floor(i/256);return[i-256*f,f,s]}},{key:"rgbToIndex",value:function(i){for(var s=i.length/4,f=Math.floor(s/2),c=function(N){return i[N]+256*i[N+1]+65536*i[N+2]-1},g=0;;g++){var p=f+g,A=f-g;if(p===A){if(p=c(4*p),-1<p)return p}else{if(p<s){var S=c(4*p);if(-1<S)return S}if(0<=A&&(S=c(4*A),-1<S))return S;if(p>=s&&0>A)break}}return-1}},{key:"getCommonUniforms",value:function(i){i=i.isPickRender;var s=this.getOptions(),f={};if(s.enablePicked){var c=0<=s.selectedIndex?s.selectedIndex:-1;c=s.autoSelect?this.pickedColor:this.indexToRgb(c),f=ut(f,{uSelectedColor:this.normizedColor(s.selectedColor),uEnablePicked:s.enablePicked,uPickedColor:c.map(function(g){return g/255}),uIsPickRender:!!i})}return f}},{key:"pick",value:function(i,s,f){var c=this.getOptions(),g=this.gl,p=this.webglLayer._dpr;this.webglLayer.saveFramebuffer(),this.webglLayer.bindFramebuffer(this.webglLayer.pickFBO),this.webglLayer.clear(),this.render({gl:g,isPickRender:!0,matrix:this.webglLayer.matrix,projectionMatrix:this.webglLayer.projectionMatrix,viewMatrix:this.webglLayer.viewMatrix,orthoMatrix:this.webglLayer.orthoMatrix});var A=new Uint8Array(4*c.pickWidth*c.pickHeight);return g.readPixels(i*p-Math.floor(c.pickWidth/2),g.canvas.height-s*p-Math.floor(c.pickHeight/2),c.pickWidth,c.pickHeight,g.RGBA,g.UNSIGNED_BYTE,A),i=this.rgbToIndex(A),this.pickAfter&&(i=this.pickAfter(A,i+1)),this.setPickedIndex&&this.setPickedIndex(i,f),f=this.getData(),this.pickedColor=[A[0],A[1],A[2]],this.webglLayer.restoreFramebuffer(),{dataIndex:i,dataItem:f[i]}}},{key:"setGLState",value:function(i){this.webglLayer.stateManager.setState(i,this.options)}},{key:"addMultipleCoords",value:function(i,s,f){if(!this.options.repeat||!this.webglLayer||this.webglLayer.options.mapType!=="bmapgl"||this.webglLayer.map.map.mapType==="B_EARTH_MAP")return[i];var c=this.webglLayer.map.map;s=s||c.getZoom();var g=f?c.worldSize(s):4007545274461451e-8;if(s=function(L){return[[L[0]-g,L[1],L[2]||0],[L[0]+g,L[1],L[2]||0]]},i instanceof Array&&!(i[0]instanceof Array))return s=s(i),s=i2(s,2),[i,s[0],s[1]];if(i instanceof Array&&i[0]instanceof Array&&!(i[0][0]instanceof Array)){f=[],c=[];for(var p=0;p<i.length;p++){var A=s(i[p]);A=i2(A,2);var S=A[1];f.push(A[0]),c.push(S)}return[i,f,c]}for(f=[],c=[],p=0;p<i.length;p++){A=[],S=[];for(var N=0;N<i[p].length;N++){var w=s(i[p][N]);w=i2(w,2);var I=w[1];A.push(w[0]),S.push(I)}f.push(A),c.push(S)}return[i,f,c]}}]),r}(gw),mw=It(function(t,r){(function(i,s){s(r)})($r,function(i){function s(){}function f(e,o){this.x=e||0,this.y=o||0}function c(){this.elements=[1,0,0,0,1,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function g(e,o,h,m,_,T,R,z,k,b){Object.defineProperty(this,"id",{value:V3++}),this.uuid=di.generateUUID(),this.name="",this.image=e!==void 0?e:g.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=o!==void 0?o:g.DEFAULT_MAPPING,this.wrapS=h!==void 0?h:1001,this.wrapT=m!==void 0?m:1001,this.magFilter=_!==void 0?_:1006,this.minFilter=T!==void 0?T:1008,this.anisotropy=k!==void 0?k:1,this.format=R!==void 0?R:1023,this.internalFormat=null,this.type=z!==void 0?z:1009,this.offset=new f(0,0),this.repeat=new f(1,1),this.center=new f(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new c,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=b!==void 0?b:3e3,this.version=0,this.onUpdate=null}function p(e,o,h,m){this.x=e||0,this.y=o||0,this.z=h||0,this.w=m!==void 0?m:1}function A(e,o,h){this.width=e,this.height=o,this.scissor=new p(0,0,e,o),this.scissorTest=!1,this.viewport=new p(0,0,e,o),h=h||{},this.texture=new g(void 0,h.mapping,h.wrapS,h.wrapT,h.magFilter,h.minFilter,h.format,h.type,h.anisotropy,h.encoding),this.texture.image={},this.texture.image.width=e,this.texture.image.height=o,this.texture.generateMipmaps=h.generateMipmaps!==void 0?h.generateMipmaps:!1,this.texture.minFilter=h.minFilter!==void 0?h.minFilter:1006,this.depthBuffer=h.depthBuffer!==void 0?h.depthBuffer:!0,this.stencilBuffer=h.stencilBuffer!==void 0?h.stencilBuffer:!0,this.depthTexture=h.depthTexture!==void 0?h.depthTexture:null}function S(e,o,h){A.call(this,e,o,h),this.samples=4}function N(e,o,h,m){this._x=e||0,this._y=o||0,this._z=h||0,this._w=m!==void 0?m:1}function w(e,o,h){this.x=e||0,this.y=o||0,this.z=h||0}function I(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],0<arguments.length&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function L(e,o,h,m){this._x=e||0,this._y=o||0,this._z=h||0,this._order=m||L.DefaultOrder}function P(){this.mask=1}function F(){Object.defineProperty(this,"id",{value:X3++}),this.uuid=di.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=F.DefaultUp.clone();var e=new w,o=new L,h=new N,m=new w(1,1,1);o._onChange(function(){h.setFromEuler(o,!1)}),h._onChange(function(){o.setFromQuaternion(h,void 0,!1)}),Gr(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:o},quaternion:{configurable:!0,enumerable:!0,value:h},scale:{configurable:!0,enumerable:!0,value:m},modelViewMatrix:{value:new I},normalMatrix:{value:new c}}),this.matrix=new I,this.matrixWorld=new I,this.matrixAutoUpdate=F.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new P,this.visible=!0,this.receiveShadow=this.castShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function W(){F.call(this),this.type="Scene",this.overrideMaterial=this.fog=this.environment=this.background=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function X(e,o){this.min=e!==void 0?e:new w(1/0,1/0,1/0),this.max=o!==void 0?o:new w(-1/0,-1/0,-1/0)}function Z(e,o,h,m,_){var T,R=0;for(T=e.length-3;R<=T;R+=3){rp.fromArray(e,R);var z=_.x*Math.abs(rp.x)+_.y*Math.abs(rp.y)+_.z*Math.abs(rp.z),k=o.dot(rp),b=h.dot(rp),q=m.dot(rp);if(Math.max(-Math.max(k,b,q),Math.min(k,b,q))>z)return!1}return!0}function tt(e,o){this.center=e!==void 0?e:new w,this.radius=o!==void 0?o:-1}function st(e,o){this.origin=e!==void 0?e:new w,this.direction=o!==void 0?o:new w(0,0,-1)}function xt(e,o){this.normal=e!==void 0?e:new w(1,0,0),this.constant=o!==void 0?o:0}function At(e,o,h){this.a=e!==void 0?e:new w,this.b=o!==void 0?o:new w,this.c=h!==void 0?h:new w}function yt(e,o,h){return o===void 0&&h===void 0?this.set(e):this.setRGB(e,o,h)}function Ut(e,o,h){return 0>h&&(h+=1),1<h&&--h,h<1/6?e+6*(o-e)*h:.5>h?o:h<2/3?e+6*(o-e)*(2/3-h):e}function kt(e){return .04045>e?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ne(e){return .0031308>e?12.92*e:1.055*Math.pow(e,.41666)-.055}function Wt(e,o,h,m,_,T){this.a=e,this.b=o,this.c=h,this.normal=m&&m.isVector3?m:new w,this.vertexNormals=Array.isArray(m)?m:[],this.color=_&&_.isColor?_:new yt,this.vertexColors=Array.isArray(_)?_:[],this.materialIndex=T!==void 0?T:0}function re(){Object.defineProperty(this,"id",{value:tT++}),this.uuid=di.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=this.flatShading=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null,this.depthFunc=3,this.depthWrite=this.depthTest=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilZPass=this.stencilZFail=this.stencilFail=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipShadows=this.clipIntersection=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetUnits=this.polygonOffsetFactor=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.toneMapped=this.visible=!0,this.userData={},this.version=0}function be(e){re.call(this),this.type="MeshBasicMaterial",this.color=new yt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphTargets=this.skinning=!1,this.setValues(e)}function ce(e,o,h){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=o,this.count=e!==void 0?e.length/o:0,this.normalized=h===!0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function tr(e,o,h){ce.call(this,new Int8Array(e),o,h)}function yr(e,o,h){ce.call(this,new Uint8Array(e),o,h)}function sr(e,o,h){ce.call(this,new Uint8ClampedArray(e),o,h)}function ni(e,o,h){ce.call(this,new Int16Array(e),o,h)}function pr(e,o,h){ce.call(this,new Uint16Array(e),o,h)}function dt(e,o,h){ce.call(this,new Int32Array(e),o,h)}function gt(e,o,h){ce.call(this,new Uint32Array(e),o,h)}function mt(e,o,h){ce.call(this,new Float32Array(e),o,h)}function Tt(e,o,h){ce.call(this,new Float64Array(e),o,h)}function et(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function ht(e){if(e.length===0)return-1/0;for(var o=e[0],h=1,m=e.length;h<m;++h)e[h]>o&&(o=e[h]);return o}function ct(){Object.defineProperty(this,"id",{value:eT+=2}),this.uuid=di.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingSphere=this.boundingBox=null,this.drawRange={start:0,count:1/0},this.userData={}}function St(e,o){F.call(this),this.type="Mesh",this.geometry=e!==void 0?e:new ct,this.material=o!==void 0?o:new be,this.updateMorphTargets()}function Gt(e,o,h,m,_,T,R,z){return(o.side===1?m.intersectTriangle(R,T,_,!0,z):m.intersectTriangle(_,T,R,o.side!==2,z))===null?null:(ax.copy(z),ax.applyMatrix4(e.matrixWorld),o=h.ray.origin.distanceTo(ax),o<h.near||o>h.far?null:{distance:o,point:ax.clone(),object:e})}function Qt(e,o,h,m,_,T,R,z,k,b,q,J){if(_c.fromBufferAttribute(_,b),wc.fromBufferAttribute(_,q),Mc.fromBufferAttribute(_,J),_=e.morphTargetInfluences,o.morphTargets&&T&&_){nx.set(0,0,0),ox.set(0,0,0),sx.set(0,0,0);for(var Q=0,K=T.length;Q<K;Q++){var rt=_[Q],lt=T[Q];rt!==0&&(e_.fromBufferAttribute(lt,b),r_.fromBufferAttribute(lt,q),i_.fromBufferAttribute(lt,J),R?(nx.addScaledVector(e_,rt),ox.addScaledVector(r_,rt),sx.addScaledVector(i_,rt)):(nx.addScaledVector(e_.sub(_c),rt),ox.addScaledVector(r_.sub(wc),rt),sx.addScaledVector(i_.sub(Mc),rt)))}_c.add(nx),wc.add(ox),Mc.add(sx)}return e.isSkinnedMesh&&(e.boneTransform(b,_c),e.boneTransform(q,wc),e.boneTransform(J,Mc)),(e=Gt(e,o,h,m,_c,wc,Mc,Vv))&&(z&&(Ag.fromBufferAttribute(z,b),_g.fromBufferAttribute(z,q),wg.fromBufferAttribute(z,J),e.uv=At.getUV(Vv,_c,wc,Mc,Ag,_g,wg,new f)),k&&(Ag.fromBufferAttribute(k,b),_g.fromBufferAttribute(k,q),wg.fromBufferAttribute(k,J),e.uv2=At.getUV(Vv,_c,wc,Mc,Ag,_g,wg,new f)),z=new Wt(b,q,J),At.getNormal(_c,wc,Mc,z.normal),e.face=z),e}function ft(){Object.defineProperty(this,"id",{value:rT+=2}),this.uuid=di.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function ve(e){var o={},h;for(h in e){o[h]={};for(var m in e[h]){var _=e[h][m];_&&(_.isColor||_.isMatrix3||_.isMatrix4||_.isVector2||_.isVector3||_.isVector4||_.isTexture)?o[h][m]=_.clone():Array.isArray(_)?o[h][m]=_.slice():o[h][m]=_}}return o}function xe(e){for(var o={},h=0;h<e.length;h++){var m=ve(e[h]),_;for(_ in m)o[_]=m[_]}return o}function me(e){re.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,this.fragmentShader=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,e!==void 0&&(e.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function le(){F.call(this),this.type="Camera",this.matrixWorldInverse=new I,this.projectionMatrix=new I,this.projectionMatrixInverse=new I}function Ce(e,o,h,m){le.call(this),this.type="PerspectiveCamera",this.fov=e!==void 0?e:50,this.zoom=1,this.near=h!==void 0?h:.1,this.far=m!==void 0?m:2e3,this.focus=10,this.aspect=o!==void 0?o:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function xr(e,o,h){if(F.call(this),this.type="CubeCamera",h.isWebGLCubeRenderTarget!==!0)console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");else{this.renderTarget=h;var m=new Ce(90,1,e,o);m.layers=this.layers,m.up.set(0,-1,0),m.lookAt(new w(1,0,0)),this.add(m);var _=new Ce(90,1,e,o);_.layers=this.layers,_.up.set(0,-1,0),_.lookAt(new w(-1,0,0)),this.add(_);var T=new Ce(90,1,e,o);T.layers=this.layers,T.up.set(0,0,1),T.lookAt(new w(0,1,0)),this.add(T);var R=new Ce(90,1,e,o);R.layers=this.layers,R.up.set(0,0,-1),R.lookAt(new w(0,-1,0)),this.add(R);var z=new Ce(90,1,e,o);z.layers=this.layers,z.up.set(0,-1,0),z.lookAt(new w(0,0,1)),this.add(z);var k=new Ce(90,1,e,o);k.layers=this.layers,k.up.set(0,-1,0),k.lookAt(new w(0,0,-1)),this.add(k),this.update=function(b,q){this.parent===null&&this.updateMatrixWorld();var J=b.xr.enabled,Q=b.getRenderTarget();b.xr.enabled=!1;var K=h.texture.generateMipmaps;h.texture.generateMipmaps=!1,b.setRenderTarget(h,0),b.render(q,m),b.setRenderTarget(h,1),b.render(q,_),b.setRenderTarget(h,2),b.render(q,T),b.setRenderTarget(h,3),b.render(q,R),b.setRenderTarget(h,4),b.render(q,z),h.texture.generateMipmaps=K,b.setRenderTarget(h,5),b.render(q,k),b.setRenderTarget(Q),b.xr.enabled=J},this.clear=function(b,q,J,Q){for(var K=b.getRenderTarget(),rt=0;6>rt;rt++)b.setRenderTarget(h,rt),b.clear(q,J,Q);b.setRenderTarget(K)}}}function Br(e,o,h){Jh(o)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),o=h),A.call(this,e,e,o)}function Ae(e,o,h,m,_,T,R,z,k,b,q,J){g.call(this,null,T,R,z,k,b,m,_,q,J),this.image={data:e||null,width:o||1,height:h||1},this.magFilter=k!==void 0?k:1003,this.minFilter=b!==void 0?b:1003,this.flipY=this.generateMipmaps=!1,this.unpackAlignment=1,this.needsUpdate=!0}function ar(e,o,h,m,_,T){this.planes=[e!==void 0?e:new xt,o!==void 0?o:new xt,h!==void 0?h:new xt,m!==void 0?m:new xt,_!==void 0?_:new xt,T!==void 0?T:new xt]}function Wr(){function e(_,T){h!==!1&&(m(_,T),o.requestAnimationFrame(e))}var o=null,h=!1,m=null;return{start:function(){h!==!0&&m!==null&&(o.requestAnimationFrame(e),h=!0)},stop:function(){h=!1},setAnimationLoop:function(_){m=_},setContext:function(_){o=_}}}function Ze(e,o){function h(T,R){var z=T.array,k=T.usage,b=e.createBuffer();return e.bindBuffer(R,b),e.bufferData(R,z,k),T.onUploadCallback(),R=5126,z instanceof Float32Array?R=5126:z instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):z instanceof Uint16Array?R=5123:z instanceof Int16Array?R=5122:z instanceof Uint32Array?R=5125:z instanceof Int32Array?R=5124:z instanceof Int8Array?R=5120:z instanceof Uint8Array&&(R=5121),{buffer:b,type:R,bytesPerElement:z.BYTES_PER_ELEMENT,version:T.version}}var m=o.isWebGL2,_=new Zi;return{get:function(T){return T.isInterleavedBufferAttribute&&(T=T.data),_.get(T)},remove:function(T){T.isInterleavedBufferAttribute&&(T=T.data);var R=_.get(T);R&&(e.deleteBuffer(R.buffer),_.delete(T))},update:function(T,R){T.isInterleavedBufferAttribute&&(T=T.data);var z=_.get(T);if(z===void 0)_.set(T,h(T,R));else if(z.version<T.version){var k=T.array,b=T.updateRange;e.bindBuffer(R,z.buffer),b.count===-1?e.bufferSubData(R,0,k):(m?e.bufferSubData(R,b.offset*k.BYTES_PER_ELEMENT,k,b.offset,b.count):e.bufferSubData(R,b.offset*k.BYTES_PER_ELEMENT,k.subarray(b.offset,b.offset+b.count)),b.count=-1),z.version=T.version}}}}function Sn(e,o,h,m){ft.call(this),this.type="PlaneGeometry",this.parameters={width:e,height:o,widthSegments:h,heightSegments:m},this.fromBufferGeometry(new Ai(e,o,h,m)),this.mergeVertices()}function Ai(e,o,h,m){ct.call(this),this.type="PlaneBufferGeometry",this.parameters={width:e,height:o,widthSegments:h,heightSegments:m},e=e||1,o=o||1;var _=e/2,T=o/2;h=Math.floor(h)||1,m=Math.floor(m)||1;var R=h+1,z=m+1,k=e/h,b=o/m,q=[],J=[],Q=[],K=[];for(e=0;e<z;e++){var rt=e*b-T;for(o=0;o<R;o++)J.push(o*k-_,-rt,0),Q.push(0,0,1),K.push(o/h),K.push(1-e/m)}for(e=0;e<m;e++)for(o=0;o<h;o++)_=o+R*(e+1),T=o+1+R*(e+1),z=o+1+R*e,q.push(o+R*e,_,z),q.push(_,T,z);this.setIndex(q),this.setAttribute("position",new mt(J,3)),this.setAttribute("normal",new mt(Q,3)),this.setAttribute("uv",new mt(K,2))}function Fo(e,o,h,m){function _(Q,K){o.buffers.color.setClear(Q.r,Q.g,Q.b,K,m)}var T=new yt(0),R=0,z,k,b=null,q=0,J=null;return{getClearColor:function(){return T},setClearColor:function(Q,K){T.set(Q),R=K!==void 0?K:1,_(T,R)},getClearAlpha:function(){return R},setClearAlpha:function(Q){R=Q,_(T,R)},render:function(Q,K,rt,lt){K=K.background,rt=e.xr,(rt=rt.getSession&&rt.getSession())&&rt.environmentBlendMode==="additive"&&(K=null),K===null?_(T,R):K&&K.isColor&&(_(K,1),lt=!0),(e.autoClear||lt)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),K&&(K.isCubeTexture||K.isWebGLCubeRenderTarget||K.mapping===306)?(k===void 0&&(k=new St(new Wv(1,1,1),new me({type:"BackgroundCubeMaterial",uniforms:ve(hl.cube.uniforms),vertexShader:hl.cube.vertexShader,fragmentShader:hl.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),k.geometry.deleteAttribute("normal"),k.geometry.deleteAttribute("uv"),k.onBeforeRender=function(Bt,Zt,bt){this.matrixWorld.copyPosition(bt.matrixWorld)},Object.defineProperty(k.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),h.update(k)),lt=K.isWebGLCubeRenderTarget?K.texture:K,k.material.uniforms.envMap.value=lt,k.material.uniforms.flipEnvMap.value=lt.isCubeTexture?-1:1,(b!==K||q!==lt.version||J!==e.toneMapping)&&(k.material.needsUpdate=!0,b=K,q=lt.version,J=e.toneMapping),Q.unshift(k,k.geometry,k.material,0,0,null)):K&&K.isTexture&&(z===void 0&&(z=new St(new Ai(2,2),new me({type:"BackgroundMaterial",uniforms:ve(hl.background.uniforms),vertexShader:hl.background.vertexShader,fragmentShader:hl.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),Object.defineProperty(z.material,"map",{get:function(){return this.uniforms.t2D.value}}),h.update(z)),z.material.uniforms.t2D.value=K,K.matrixAutoUpdate===!0&&K.updateMatrix(),z.material.uniforms.uvTransform.value.copy(K.matrix),(b!==K||q!==K.version||J!==e.toneMapping)&&(z.material.needsUpdate=!0,b=K,q=K.version,J=e.toneMapping),Q.unshift(z,z.geometry,z.material,0,0,null))}}}function Ta(e,o,h,m){var _=m.isWebGL2,T;this.setMode=function(R){T=R},this.render=function(R,z){e.drawArrays(T,R,z),h.update(z,T)},this.renderInstances=function(R,z,k,b){if(b!==0){if(_){R=e;var q="drawArraysInstanced"}else if(R=o.get("ANGLE_instanced_arrays"),q="drawArraysInstancedANGLE",R===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}R[q](T,z,k,b),h.update(k,T,b)}}}function eh(e,o,h){function m(ae){if(ae==="highp"){if(0<e.getShaderPrecisionFormat(35633,36338).precision&&0<e.getShaderPrecisionFormat(35632,36338).precision)return"highp";ae="mediump"}return ae==="mediump"&&0<e.getShaderPrecisionFormat(35633,36337).precision&&0<e.getShaderPrecisionFormat(35632,36337).precision?"mediump":"lowp"}var _,T=typeof WebGL2RenderingContext!="undefined"&&e instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&e instanceof WebGL2ComputeRenderingContext,R=h.precision!==void 0?h.precision:"highp",z=m(R);z!==R&&(console.warn("THREE.WebGLRenderer:",R,"not supported, using",z,"instead."),R=z),h=h.logarithmicDepthBuffer===!0,z=e.getParameter(34930);var k=e.getParameter(35660),b=e.getParameter(3379),q=e.getParameter(34076),J=e.getParameter(34921),Q=e.getParameter(36347),K=e.getParameter(36348),rt=e.getParameter(36349),lt=0<k,Bt=T||!!o.get("OES_texture_float"),Zt=lt&&Bt,bt=T?e.getParameter(36183):0;return{isWebGL2:T,getMaxAnisotropy:function(){if(_!==void 0)return _;var ae=o.get("EXT_texture_filter_anisotropic");return _=ae!==null?e.getParameter(ae.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:m,precision:R,logarithmicDepthBuffer:h,maxTextures:z,maxVertexTextures:k,maxTextureSize:b,maxCubemapSize:q,maxAttributes:J,maxVertexUniforms:Q,maxVaryings:K,maxFragmentUniforms:rt,vertexTextures:lt,floatFragmentTextures:Bt,floatVertexTextures:Zt,maxSamples:bt}}function Ns(){function e(){b.value!==m&&(b.value=m,b.needsUpdate=0<_),h.numPlanes=_,h.numIntersection=0}function o(q,J,Q,K){var rt=q!==null?q.length:0,lt=null;if(rt!==0){if(lt=b.value,K!==!0||lt===null)for(K=Q+4*rt,J=J.matrixWorldInverse,k.getNormalMatrix(J),(lt===null||lt.length<K)&&(lt=new Float32Array(K)),K=0;K!==rt;++K,Q+=4)z.copy(q[K]).applyMatrix4(J,k),z.normal.toArray(lt,Q),lt[Q+3]=z.constant;b.value=lt,b.needsUpdate=!0}return h.numPlanes=rt,h.numIntersection=0,lt}var h=this,m=null,_=0,T=!1,R=!1,z=new xt,k=new c,b={value:null,needsUpdate:!1};this.uniform=b,this.numIntersection=this.numPlanes=0,this.init=function(q,J,Q){var K=q.length!==0||J||_!==0||T;return T=J,m=o(q,Q,0),_=q.length,K},this.beginShadows=function(){R=!0,o(null)},this.endShadows=function(){R=!1,e()},this.setState=function(q,J,Q,K,rt,lt){if(!T||q===null||q.length===0||R&&!Q)R?o(null):e();else{Q=R?0:_;var Bt=4*Q,Zt=rt.clippingState||null;for(b.value=Zt,Zt=o(q,K,Bt,lt),q=0;q!==Bt;++q)Zt[q]=m[q];rt.clippingState=Zt,this.numIntersection=J?this.numPlanes:0,this.numPlanes+=Q}}}function el(e){var o={};return{get:function(h){if(o[h]!==void 0)return o[h];switch(h){case"WEBGL_depth_texture":var m=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":m=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":m=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":m=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:m=e.getExtension(h)}return m===null&&console.warn("THREE.WebGLRenderer: "+h+" extension not supported."),o[h]=m}}}function rl(e,o,h){function m(z){var k=z.target;z=T.get(k),z.index!==null&&o.remove(z.index);for(var b in z.attributes)o.remove(z.attributes[b]);k.removeEventListener("dispose",m),T.delete(k),(b=R.get(z))&&(o.remove(b),R.delete(z)),h.memory.geometries--}function _(z){var k=[],b=z.index,q=z.attributes.position;if(b!==null){var J=b.array;b=b.version,q=0;for(var Q=J.length;q<Q;q+=3){var K=J[q+0],rt=J[q+1],lt=J[q+2];k.push(K,rt,rt,lt,lt,K)}}else for(J=q.array,b=q.version,q=0,Q=J.length/3-1;q<Q;q+=3)K=q+0,rt=q+1,lt=q+2,k.push(K,rt,rt,lt,lt,K);k=new(65535<ht(k)?gt:pr)(k,1),k.version=b,o.update(k,34963),(J=R.get(z))&&o.remove(J),R.set(z,k)}var T=new Zi,R=new Zi;return{get:function(z,k){var b=T.get(k);return b||(k.addEventListener("dispose",m),k.isBufferGeometry?b=k:k.isGeometry&&(k._bufferGeometry===void 0&&(k._bufferGeometry=new ct().setFromObject(z)),b=k._bufferGeometry),T.set(k,b),h.memory.geometries++,b)},update:function(z){var k=z.index,b=z.attributes;k!==null&&o.update(k,34963);for(var q in b)o.update(b[q],34962);z=z.morphAttributes;for(q in z){k=z[q],b=0;for(var J=k.length;b<J;b++)o.update(k[b],34962)}},getWireframeAttribute:function(z){var k=R.get(z);if(k){var b=z.index;b!==null&&k.version<b.version&&_(z)}else _(z);return R.get(z)}}}function vs(e,o,h,m){var _=m.isWebGL2,T,R,z;this.setMode=function(k){T=k},this.setIndex=function(k){R=k.type,z=k.bytesPerElement},this.render=function(k,b){e.drawElements(T,b,R,k*z),h.update(b,T)},this.renderInstances=function(k,b,q,J){if(J!==0){if(_){k=e;var Q="drawElementsInstanced"}else if(k=o.get("ANGLE_instanced_arrays"),Q="drawElementsInstancedANGLE",k===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}k[Q](T,q,R,b*z,J),h.update(q,T,J)}}}function iu(e){var o={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:o,programs:null,autoReset:!0,reset:function(){o.frame++,o.calls=0,o.triangles=0,o.points=0,o.lines=0},update:function(h,m,_){switch(_=_||1,o.calls++,m){case 4:o.triangles+=h/3*_;break;case 1:o.lines+=h/2*_;break;case 3:o.lines+=_*(h-1);break;case 2:o.lines+=_*h;break;case 0:o.points+=_*h;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",m)}}}}function To(e,o){return Math.abs(o[1])-Math.abs(e[1])}function hy(e){var o={},h=new Float32Array(8);return{update:function(m,_,T,R){var z=m.morphTargetInfluences,k=z===void 0?0:z.length;if(m=o[_.id],m===void 0){m=[];for(var b=0;b<k;b++)m[b]=[b,0];o[_.id]=m}var q=T.morphTargets&&_.morphAttributes.position;for(T=T.morphNormals&&_.morphAttributes.normal,b=0;b<k;b++){var J=m[b];J[1]!==0&&(q&&_.deleteAttribute("morphTarget"+b),T&&_.deleteAttribute("morphNormal"+b))}for(b=0;b<k;b++)J=m[b],J[0]=b,J[1]=z[b];for(m.sort(To),b=z=0;8>b;b++){if((J=m[b])&&(k=J[0],J=J[1])){q&&_.setAttribute("morphTarget"+b,q[k]),T&&_.setAttribute("morphNormal"+b,T[k]),h[b]=J,z+=J;continue}h[b]=0}_=_.morphTargetsRelative?1:1-z,R.getUniforms().setValue(e,"morphTargetBaseInfluence",_),R.getUniforms().setValue(e,"morphTargetInfluences",h)}}}function cy(e,o,h,m){var _=new Zi;return{update:function(T){var R=m.render.frame,z=T.geometry,k=o.get(T,z);return _.get(k)!==R&&(z.isGeometry&&k.updateFromObject(T),o.update(k),_.set(k,R)),T.isInstancedMesh&&h.update(T.instanceMatrix,34962),k},dispose:function(){_=new Zi}}}function Sa(e,o,h,m,_,T,R,z,k,b){e=e!==void 0?e:[],g.call(this,e,o!==void 0?o:301,h,m,_,T,R!==void 0?R:1022,z,k,b),this.flipY=!1}function es(e,o,h,m){g.call(this,null),this.image={data:e||null,width:o||1,height:h||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function ys(e,o,h,m){g.call(this,null),this.image={data:e||null,width:o||1,height:h||1,depth:m||1},this.minFilter=this.magFilter=1003,this.wrapR=1001,this.flipY=this.generateMipmaps=!1,this.needsUpdate=!0}function rh(e,o,h){var m=e[0];if(0>=m||0<m)return e;var _=o*h,T=mM[_];if(T===void 0&&(T=new Float32Array(_),mM[_]=T),o!==0)for(m.toArray(T,0),m=1,_=0;m!==o;++m)_+=h,e[m].toArray(T,_);return T}function zs(e,o){if(e.length!==o.length)return!1;for(var h=0,m=e.length;h<m;h++)if(e[h]!==o[h])return!1;return!0}function Bo(e,o){for(var h=0,m=o.length;h<m;h++)e[h]=o[h]}function Hf(e,o){var h=vM[o];h===void 0&&(h=new Int32Array(o),vM[o]=h);for(var m=0;m!==o;++m)h[m]=e.allocateTextureUnit();return h}function Mt(e,o){var h=this.cache;h[0]!==o&&(e.uniform1f(this.addr,o),h[0]=o)}function we(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y)&&(e.uniform2f(this.addr,o.x,o.y),h[0]=o.x,h[1]=o.y):zs(h,o)||(e.uniform2fv(this.addr,o),Bo(h,o))}function qt(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z)&&(e.uniform3f(this.addr,o.x,o.y,o.z),h[0]=o.x,h[1]=o.y,h[2]=o.z):o.r!==void 0?(h[0]!==o.r||h[1]!==o.g||h[2]!==o.b)&&(e.uniform3f(this.addr,o.r,o.g,o.b),h[0]=o.r,h[1]=o.g,h[2]=o.b):zs(h,o)||(e.uniform3fv(this.addr,o),Bo(h,o))}function Pe(e,o){var h=this.cache;o.x!==void 0?(h[0]!==o.x||h[1]!==o.y||h[2]!==o.z||h[3]!==o.w)&&(e.uniform4f(this.addr,o.x,o.y,o.z,o.w),h[0]=o.x,h[1]=o.y,h[2]=o.z,h[3]=o.w):zs(h,o)||(e.uniform4fv(this.addr,o),Bo(h,o))}function qe(e,o){var h=this.cache,m=o.elements;m===void 0?zs(h,o)||(e.uniformMatrix2fv(this.addr,!1,o),Bo(h,o)):zs(h,m)||(AM.set(m),e.uniformMatrix2fv(this.addr,!1,AM),Bo(h,m))}function ai(e,o){var h=this.cache,m=o.elements;m===void 0?zs(h,o)||(e.uniformMatrix3fv(this.addr,!1,o),Bo(h,o)):zs(h,m)||(xM.set(m),e.uniformMatrix3fv(this.addr,!1,xM),Bo(h,m))}function hr(e,o){var h=this.cache,m=o.elements;m===void 0?zs(h,o)||(e.uniformMatrix4fv(this.addr,!1,o),Bo(h,o)):zs(h,m)||(yM.set(m),e.uniformMatrix4fv(this.addr,!1,yM),Bo(h,m))}function Hr(e,o,h){var m=this.cache,_=h.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),h.safeSetTexture2D(o||dM,_)}function oi(e,o,h){var m=this.cache,_=h.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),h.setTexture2DArray(o||iT,_)}function Li(e,o,h){var m=this.cache,_=h.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),h.setTexture3D(o||nT,_)}function wi(e,o,h){var m=this.cache,_=h.allocateTextureUnit();m[0]!==_&&(e.uniform1i(this.addr,_),m[0]=_),h.safeSetTextureCube(o||gM,_)}function Ia(e,o){var h=this.cache;h[0]!==o&&(e.uniform1i(this.addr,o),h[0]=o)}function an(e,o){var h=this.cache;zs(h,o)||(e.uniform2iv(this.addr,o),Bo(h,o))}function Gn(e,o){var h=this.cache;zs(h,o)||(e.uniform3iv(this.addr,o),Bo(h,o))}function nu(e,o){var h=this.cache;zs(h,o)||(e.uniform4iv(this.addr,o),Bo(h,o))}function fy(e,o){var h=this.cache;h[0]!==o&&(e.uniform1ui(this.addr,o),h[0]=o)}function ta(e){switch(e){case 5126:return Mt;case 35664:return we;case 35665:return qt;case 35666:return Pe;case 35674:return qe;case 35675:return ai;case 35676:return hr;case 5124:case 35670:return Ia;case 35667:case 35671:return an;case 35668:case 35672:return Gn;case 35669:case 35673:return nu;case 5125:return fy;case 35678:case 36198:case 36298:case 36306:case 35682:return Hr;case 35679:case 36299:case 36307:return Li;case 35680:case 36300:case 36308:case 36293:return wi;case 36289:case 36303:case 36311:case 36292:return oi}}function Ud(e,o){e.uniform1fv(this.addr,o)}function ih(e,o){e.uniform1iv(this.addr,o)}function uc(e,o){e.uniform2iv(this.addr,o)}function a2(e,o){e.uniform3iv(this.addr,o)}function nh(e,o){e.uniform4iv(this.addr,o)}function s3(e,o){o=rh(o,this.size,2),e.uniform2fv(this.addr,o)}function a3(e,o){o=rh(o,this.size,3),e.uniform3fv(this.addr,o)}function u3(e,o){o=rh(o,this.size,4),e.uniform4fv(this.addr,o)}function l3(e,o){o=rh(o,this.size,4),e.uniformMatrix2fv(this.addr,!1,o)}function h3(e,o){o=rh(o,this.size,9),e.uniformMatrix3fv(this.addr,!1,o)}function c3(e,o){o=rh(o,this.size,16),e.uniformMatrix4fv(this.addr,!1,o)}function f3(e,o,h){var m=o.length,_=Hf(h,m);for(e.uniform1iv(this.addr,_),e=0;e!==m;++e)h.safeSetTexture2D(o[e]||dM,_[e])}function p3(e,o,h){var m=o.length,_=Hf(h,m);for(e.uniform1iv(this.addr,_),e=0;e!==m;++e)h.safeSetTextureCube(o[e]||gM,_[e])}function d3(e){switch(e){case 5126:return Ud;case 35664:return s3;case 35665:return a3;case 35666:return u3;case 35674:return l3;case 35675:return h3;case 35676:return c3;case 5124:case 35670:return ih;case 35667:case 35671:return uc;case 35668:case 35672:return a2;case 35669:case 35673:return nh;case 35678:case 36198:case 36298:case 36306:case 35682:return f3;case 35680:case 36300:case 36308:case 36293:return p3}}function g3(e,o,h){this.id=e,this.addr=h,this.cache=[],this.setValue=ta(o.type)}function _w(e,o,h){this.id=e,this.addr=h,this.cache=[],this.size=o.size,this.setValue=d3(o.type)}function ww(e){this.id=e,this.seq=[],this.map={}}function lc(e,o){this.seq=[],this.map={};for(var h=e.getProgramParameter(o,35718),m=0;m<h;++m){var _=e.getActiveUniform(o,m),T=e.getUniformLocation(o,_.name),R=this,z=_.name,k=z.length;for(s_.lastIndex=0;;){var b=s_.exec(z),q=s_.lastIndex,J=b[1],Q=b[3];if(b[2]==="]"&&(J|=0),Q===void 0||Q==="["&&q+2===k){z=R,_=Q===void 0?new g3(J,_,T):new _w(J,_,T),z.seq.push(_),z.map[_.id]=_;break}else Q=R.map[J],Q===void 0&&(Q=new ww(J),J=R,R=Q,J.seq.push(R),J.map[R.id]=R),R=Q}}}function Mw(e,o,h){return o=e.createShader(o),e.shaderSource(o,h),e.compileShader(o),o}function Cw(e){switch(e){case 3e3:return["Linear","( value )"];case 3001:return["sRGB","( value )"];case 3002:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case 3007:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:throw Error("unsupported encoding: "+e)}}function Tw(e,o,h){var m=e.getShaderParameter(o,35713),_=e.getShaderInfoLog(o).trim();if(m&&_==="")return"";for(e=e.getShaderSource(o).split(`
`),o=0;o<e.length;o++)e[o]=o+1+": "+e[o];return e=e.join(`
`),"THREE.WebGLShader: gl.getShaderInfoLog() "+h+`
`+_+e}function rv(e,o){return o=Cw(o),"vec4 "+e+"( vec4 value ) { return "+o[0]+"ToLinear"+o[1]+"; }"}function m3(e,o){return o=Cw(o),"vec4 "+e+"( vec4 value ) { return LinearTo"+o[0]+o[1]+"; }"}function v3(e,o){switch(o){case 1:o="Linear";break;case 2:o="Reinhard";break;case 3:o="Uncharted2";break;case 4:o="OptimizedCineon";break;case 5:o="ACESFilmic";break;default:throw Error("unsupported toneMapping: "+o)}return"vec3 "+e+"( vec3 color ) { return "+o+"ToneMapping( color ); }"}function y3(e){var o=[],h;for(h in e){var m=e[h];m!==!1&&o.push("#define "+h+" "+m)}return o.join(`
`)}function iv(e){return e!==""}function Sw(e,o){return e.replace(/NUM_DIR_LIGHTS/g,o.numDirLights).replace(/NUM_SPOT_LIGHTS/g,o.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,o.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,o.numPointLights).replace(/NUM_HEMI_LIGHTS/g,o.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,o.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,o.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,o.numPointLightShadows)}function Iw(e,o){return e.replace(/NUM_CLIPPING_PLANES/g,o.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,o.numClippingPlanes-o.numClipIntersection)}function u2(e,o){if(e=Si[o],e===void 0)throw Error("Can not resolve #include <"+o+">");return e.replace(a_,u2)}function Ew(e,o,h,m){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),l2(e,o,h,m)}function l2(e,o,h,m){for(e="",o=parseInt(o);o<parseInt(h);o++)e+=m.replace(/\[ i \]/g,"[ "+o+" ]").replace(/UNROLLED_LOOP_INDEX/g,o);return e}function Lw(e){var o="precision "+e.precision+` float;
precision `+e.precision+" int;";return e.precision==="highp"?o+=`
#define HIGH_PRECISION`:e.precision==="mediump"?o+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(o+=`
#define LOW_PRECISION`),o}function x3(e){var o="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===1?o="SHADOWMAP_TYPE_PCF":e.shadowMapType===2?o="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===3&&(o="SHADOWMAP_TYPE_VSM"),o}function A3(e){var o="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:o="ENVMAP_TYPE_CUBE";break;case 306:case 307:o="ENVMAP_TYPE_CUBE_UV";break;case 303:case 304:o="ENVMAP_TYPE_EQUIREC";break;case 305:o="ENVMAP_TYPE_SPHERE"}return o}function _3(e){var o="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:case 304:o="ENVMAP_MODE_REFRACTION"}return o}function w3(e){var o="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:o="ENVMAP_BLENDING_MULTIPLY";break;case 1:o="ENVMAP_BLENDING_MIX";break;case 2:o="ENVMAP_BLENDING_ADD"}return o}function M3(e,o,h){var m=e.getContext(),_=h.defines,T=h.vertexShader,R=h.fragmentShader,z=x3(h),k=A3(h),b=_3(h),q=w3(h),J=0<e.gammaFactor?e.gammaFactor:1,Q=h.isWebGL2?"":[h.extensionDerivatives||h.envMapCubeUV||h.bumpMap||h.tangentSpaceNormalMap||h.clearcoatNormalMap||h.flatShading||h.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(iv).join(`
`),K=y3(_),rt=m.createProgram();h.isRawShaderMaterial?(_=[K].filter(iv).join(`
`),0<_.length&&(_+=`
`),z=[Q,K].filter(iv).join(`
`),0<z.length&&(z+=`
`)):(_=[Lw(h),"#define SHADER_NAME "+h.shaderName,K,h.instancing?"#define USE_INSTANCING":"",h.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+J,"#define MAX_BONES "+h.maxBones,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp2?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+b:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.normalMap&&h.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",h.clearcoatMap?"#define USE_CLEARCOATMAP":"",h.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",h.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",h.displacementMap&&h.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.vertexTangents?"#define USE_TANGENT":"",h.vertexColors?"#define USE_COLOR":"",h.vertexUvs?"#define USE_UV":"",h.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",h.flatShading?"#define FLAT_SHADED":"",h.skinning?"#define USE_SKINNING":"",h.useVertexTexture?"#define BONE_TEXTURE":"",h.morphTargets?"#define USE_MORPHTARGETS":"",h.morphNormals&&h.flatShading===!1?"#define USE_MORPHNORMALS":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+z:"",h.sizeAttenuation?"#define USE_SIZEATTENUATION":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&h.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING"," attribute mat4 instanceMatrix;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#ifdef USE_COLOR","	attribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(iv).join(`
`),z=[Q,Lw(h),"#define SHADER_NAME "+h.shaderName,K,h.alphaTest?"#define ALPHATEST "+h.alphaTest+(h.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+J,h.useFog&&h.fog?"#define USE_FOG":"",h.useFog&&h.fogExp2?"#define FOG_EXP2":"",h.map?"#define USE_MAP":"",h.matcap?"#define USE_MATCAP":"",h.envMap?"#define USE_ENVMAP":"",h.envMap?"#define "+k:"",h.envMap?"#define "+b:"",h.envMap?"#define "+q:"",h.lightMap?"#define USE_LIGHTMAP":"",h.aoMap?"#define USE_AOMAP":"",h.emissiveMap?"#define USE_EMISSIVEMAP":"",h.bumpMap?"#define USE_BUMPMAP":"",h.normalMap?"#define USE_NORMALMAP":"",h.normalMap&&h.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",h.normalMap&&h.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",h.clearcoatMap?"#define USE_CLEARCOATMAP":"",h.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",h.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",h.specularMap?"#define USE_SPECULARMAP":"",h.roughnessMap?"#define USE_ROUGHNESSMAP":"",h.metalnessMap?"#define USE_METALNESSMAP":"",h.alphaMap?"#define USE_ALPHAMAP":"",h.sheen?"#define USE_SHEEN":"",h.vertexTangents?"#define USE_TANGENT":"",h.vertexColors?"#define USE_COLOR":"",h.vertexUvs?"#define USE_UV":"",h.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",h.gradientMap?"#define USE_GRADIENTMAP":"",h.flatShading?"#define FLAT_SHADED":"",h.doubleSided?"#define DOUBLE_SIDED":"",h.flipSided?"#define FLIP_SIDED":"",h.shadowMapEnabled?"#define USE_SHADOWMAP":"",h.shadowMapEnabled?"#define "+z:"",h.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",h.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",h.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",h.logarithmicDepthBuffer&&h.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(h.extensionShaderTextureLOD||h.envMap)&&h.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",h.toneMapping!==0?"#define TONE_MAPPING":"",h.toneMapping!==0?Si.tonemapping_pars_fragment:"",h.toneMapping!==0?v3("toneMapping",h.toneMapping):"",h.dithering?"#define DITHERING":"",h.outputEncoding||h.mapEncoding||h.matcapEncoding||h.envMapEncoding||h.emissiveMapEncoding||h.lightMapEncoding?Si.encodings_pars_fragment:"",h.mapEncoding?rv("mapTexelToLinear",h.mapEncoding):"",h.matcapEncoding?rv("matcapTexelToLinear",h.matcapEncoding):"",h.envMapEncoding?rv("envMapTexelToLinear",h.envMapEncoding):"",h.emissiveMapEncoding?rv("emissiveMapTexelToLinear",h.emissiveMapEncoding):"",h.lightMapEncoding?rv("lightMapTexelToLinear",h.lightMapEncoding):"",h.outputEncoding?m3("linearToOutputTexel",h.outputEncoding):"",h.depthPacking?"#define DEPTH_PACKING "+h.depthPacking:"",`
`].filter(iv).join(`
`)),T=T.replace(a_,u2),T=Sw(T,h),T=Iw(T,h),R=R.replace(a_,u2),R=Sw(R,h),R=Iw(R,h),T=T.replace(wM,l2).replace(_M,Ew),R=R.replace(wM,l2).replace(_M,Ew),h.isWebGL2&&!h.isRawShaderMaterial&&(k=!1,b=/^\s*#version\s+300\s+es\s*\n/,h.isShaderMaterial&&T.match(b)!==null&&R.match(b)!==null&&(k=!0,T=T.replace(b,""),R=R.replace(b,"")),_=`#version 300 es

#define attribute in
#define varying out
#define texture2D texture
`+_,z=[`#version 300 es

#define varying in`,k?"":"out highp vec4 pc_fragColor;",k?"":"#define gl_FragColor pc_fragColor",`#define gl_FragDepthEXT gl_FragDepth
#define texture2D texture
#define textureCube texture
#define texture2DProj textureProj
#define texture2DLodEXT textureLod
#define texture2DProjLodEXT textureProjLod
#define textureCubeLodEXT textureLod
#define texture2DGradEXT textureGrad
#define texture2DProjGradEXT textureProjGrad
#define textureCubeGradEXT textureGrad`].join(`
`)+`
`+z),R=z+R,T=Mw(m,35633,_+T),R=Mw(m,35632,R),m.attachShader(rt,T),m.attachShader(rt,R),h.index0AttributeName!==void 0?m.bindAttribLocation(rt,0,h.index0AttributeName):h.morphTargets===!0&&m.bindAttribLocation(rt,0,"position"),m.linkProgram(rt),e.debug.checkShaderErrors&&(e=m.getProgramInfoLog(rt).trim(),k=m.getShaderInfoLog(T).trim(),b=m.getShaderInfoLog(R).trim(),J=q=!0,m.getProgramParameter(rt,35714)===!1?(q=!1,Q=Tw(m,T,"vertex"),K=Tw(m,R,"fragment"),console.error("THREE.WebGLProgram: shader error: ",m.getError(),"35715",m.getProgramParameter(rt,35715),"gl.getProgramInfoLog",e,Q,K)):e!==""?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",e):(k===""||b==="")&&(J=!1),J&&(this.diagnostics={runnable:q,programLog:e,vertexShader:{log:k,prefix:_},fragmentShader:{log:b,prefix:z}})),m.deleteShader(T),m.deleteShader(R);var lt;this.getUniforms=function(){return lt===void 0&&(lt=new lc(m,rt)),lt};var Bt;return this.getAttributes=function(){if(Bt===void 0){for(var Zt={},bt=m.getProgramParameter(rt,35721),ae=0;ae<bt;ae++){var Kt=m.getActiveAttrib(rt,ae).name;Zt[Kt]=m.getAttribLocation(rt,Kt)}Bt=Zt}return Bt},this.destroy=function(){m.deleteProgram(rt),this.program=void 0},this.name=h.shaderName,this.id=oT++,this.cacheKey=o,this.usedTimes=1,this.program=rt,this.vertexShader=T,this.fragmentShader=R,this}function C3(e,o,h){function m(K){if(K)K.isTexture?rt=K.encoding:K.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),rt=K.texture.encoding);else var rt=3e3;return rt}var _=[],T=h.isWebGL2,R=h.logarithmicDepthBuffer,z=h.floatVertexTextures,k=h.precision,b=h.maxVertexUniforms,q=h.vertexTextures,J={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},Q="precision isWebGL2 supportsVertexTextures outputEncoding instancing map mapEncoding matcap matcapEncoding envMap envMapMode envMapEncoding envMapCubeUV lightMap lightMapEncoding aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap tangentSpaceNormalMap clearcoatMap clearcoatRoughnessMap clearcoatNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors vertexTangents vertexUvs uvsVertexOnly fog useFog fogExp2 flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights numDirLightShadows numPointLightShadows numSpotLightShadows shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering sheen".split(" ");this.getParameters=function(K,rt,lt,Bt,Zt,bt,ae){var Kt=Bt.fog;Bt=K.isMeshStandardMaterial?Bt.environment:null,Bt=K.envMap||Bt;var fe=J[K.type];if(ae.isSkinnedMesh){var Xt=ae.skeleton.bones;if(z)Xt=1024;else{var Me=Math.min(Math.floor((b-20)/4),Xt.length);Me<Xt.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+Xt.length+" bones. This GPU supports "+Me+"."),Xt=0):Xt=Me}}else Xt=0;K.precision!==null&&(k=h.getMaxPrecision(K.precision),k!==K.precision&&console.warn("THREE.WebGLProgram.getParameters:",K.precision,"not supported, using",k,"instead.")),fe?(Me=hl[fe],Me={name:K.type,uniforms:pM.clone(Me.uniforms),vertexShader:Me.vertexShader,fragmentShader:Me.fragmentShader}):Me={name:K.type,uniforms:K.uniforms,vertexShader:K.vertexShader,fragmentShader:K.fragmentShader},K.onBeforeCompile(Me,e);var Ne=e.getRenderTarget();return{isWebGL2:T,shaderID:fe,shaderName:Me.name,uniforms:Me.uniforms,vertexShader:Me.vertexShader,fragmentShader:Me.fragmentShader,defines:K.defines,isRawShaderMaterial:K.isRawShaderMaterial,isShaderMaterial:K.isShaderMaterial,precision:k,instancing:ae.isInstancedMesh===!0,supportsVertexTextures:q,outputEncoding:Ne!==null?m(Ne.texture):e.outputEncoding,map:!!K.map,mapEncoding:m(K.map),matcap:!!K.matcap,matcapEncoding:m(K.matcap),envMap:!!Bt,envMapMode:Bt&&Bt.mapping,envMapEncoding:m(Bt),envMapCubeUV:!!Bt&&(Bt.mapping===306||Bt.mapping===307),lightMap:!!K.lightMap,lightMapEncoding:m(K.lightMap),aoMap:!!K.aoMap,emissiveMap:!!K.emissiveMap,emissiveMapEncoding:m(K.emissiveMap),bumpMap:!!K.bumpMap,normalMap:!!K.normalMap,objectSpaceNormalMap:K.normalMapType===1,tangentSpaceNormalMap:K.normalMapType===0,clearcoatMap:!!K.clearcoatMap,clearcoatRoughnessMap:!!K.clearcoatRoughnessMap,clearcoatNormalMap:!!K.clearcoatNormalMap,displacementMap:!!K.displacementMap,roughnessMap:!!K.roughnessMap,metalnessMap:!!K.metalnessMap,specularMap:!!K.specularMap,alphaMap:!!K.alphaMap,gradientMap:!!K.gradientMap,sheen:!!K.sheen,combine:K.combine,vertexTangents:K.normalMap&&K.vertexTangents,vertexColors:K.vertexColors,vertexUvs:!!K.map||!!K.bumpMap||!!K.normalMap||!!K.specularMap||!!K.alphaMap||!!K.emissiveMap||!!K.roughnessMap||!!K.metalnessMap||!!K.clearcoatMap||!!K.clearcoatRoughnessMap||!!K.clearcoatNormalMap||!!K.displacementMap,uvsVertexOnly:!(K.map||K.bumpMap||K.normalMap||K.specularMap||K.alphaMap||K.emissiveMap||K.roughnessMap||K.metalnessMap||K.clearcoatNormalMap)&&!!K.displacementMap,fog:!!Kt,useFog:K.fog,fogExp2:Kt&&Kt.isFogExp2,flatShading:K.flatShading,sizeAttenuation:K.sizeAttenuation,logarithmicDepthBuffer:R,skinning:K.skinning&&0<Xt,maxBones:Xt,useVertexTexture:z,morphTargets:K.morphTargets,morphNormals:K.morphNormals,maxMorphTargets:e.maxMorphTargets,maxMorphNormals:e.maxMorphNormals,numDirLights:rt.directional.length,numPointLights:rt.point.length,numSpotLights:rt.spot.length,numRectAreaLights:rt.rectArea.length,numHemiLights:rt.hemi.length,numDirLightShadows:rt.directionalShadowMap.length,numPointLightShadows:rt.pointShadowMap.length,numSpotLightShadows:rt.spotShadowMap.length,numClippingPlanes:Zt,numClipIntersection:bt,dithering:K.dithering,shadowMapEnabled:e.shadowMap.enabled&&0<lt.length,shadowMapType:e.shadowMap.type,toneMapping:K.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:K.premultipliedAlpha,alphaTest:K.alphaTest,doubleSided:K.side===2,flipSided:K.side===1,depthPacking:K.depthPacking!==void 0?K.depthPacking:!1,index0AttributeName:K.index0AttributeName,extensionDerivatives:K.extensions&&K.extensions.derivatives,extensionFragDepth:K.extensions&&K.extensions.fragDepth,extensionDrawBuffers:K.extensions&&K.extensions.drawBuffers,extensionShaderTextureLOD:K.extensions&&K.extensions.shaderTextureLOD,rendererExtensionFragDepth:T||o.get("EXT_frag_depth")!==null,rendererExtensionDrawBuffers:T||o.get("WEBGL_draw_buffers")!==null,rendererExtensionShaderTextureLod:T||o.get("EXT_shader_texture_lod")!==null,onBeforeCompile:K.onBeforeCompile}},this.getProgramCacheKey=function(K){var rt=[];if(K.shaderID?rt.push(K.shaderID):(rt.push(K.fragmentShader),rt.push(K.vertexShader)),K.defines!==void 0)for(var lt in K.defines)rt.push(lt),rt.push(K.defines[lt]);if(K.isRawShaderMaterial===void 0){for(lt=0;lt<Q.length;lt++)rt.push(K[Q[lt]]);rt.push(e.outputEncoding),rt.push(e.gammaFactor)}return rt.push(K.onBeforeCompile.toString()),rt.join()},this.acquireProgram=function(K,rt){for(var lt,Bt=0,Zt=_.length;Bt<Zt;Bt++){var bt=_[Bt];if(bt.cacheKey===rt){lt=bt,++lt.usedTimes;break}}return lt===void 0&&(lt=new M3(e,rt,K),_.push(lt)),lt},this.releaseProgram=function(K){if(--K.usedTimes===0){var rt=_.indexOf(K);_[rt]=_[_.length-1],_.pop(),K.destroy()}},this.programs=_}function T3(){var e=new Zi;return{get:function(o){var h=e.get(o);return h===void 0&&(h={},e.set(o,h)),h},remove:function(o){e.delete(o)},update:function(o,h,m){e.get(o)[h]=m},dispose:function(){e=new Zi}}}function S3(e,o){return e.groupOrder!==o.groupOrder?e.groupOrder-o.groupOrder:e.renderOrder!==o.renderOrder?e.renderOrder-o.renderOrder:e.program!==o.program?e.program.id-o.program.id:e.material.id!==o.material.id?e.material.id-o.material.id:e.z!==o.z?e.z-o.z:e.id-o.id}function I3(e,o){return e.groupOrder!==o.groupOrder?e.groupOrder-o.groupOrder:e.renderOrder!==o.renderOrder?e.renderOrder-o.renderOrder:e.z!==o.z?o.z-e.z:e.id-o.id}function Rw(){function e(R,z,k,b,q,J){var Q=o[h];return Q===void 0?(Q={id:R.id,object:R,geometry:z,material:k,program:k.program||T,groupOrder:b,renderOrder:R.renderOrder,z:q,group:J},o[h]=Q):(Q.id=R.id,Q.object=R,Q.geometry=z,Q.material=k,Q.program=k.program||T,Q.groupOrder=b,Q.renderOrder=R.renderOrder,Q.z=q,Q.group=J),h++,Q}var o=[],h=0,m=[],_=[],T={id:-1};return{opaque:m,transparent:_,init:function(){h=0,m.length=0,_.length=0},push:function(R,z,k,b,q,J){R=e(R,z,k,b,q,J),(k.transparent===!0?_:m).push(R)},unshift:function(R,z,k,b,q,J){R=e(R,z,k,b,q,J),(k.transparent===!0?_:m).unshift(R)},finish:function(){for(var R=h,z=o.length;R<z;R++){var k=o[R];if(k.id===null)break;k.id=null,k.object=null,k.geometry=null,k.material=null,k.program=null,k.group=null}},sort:function(R,z){1<m.length&&m.sort(R||S3),1<_.length&&_.sort(z||I3)}}}function E3(){function e(h){h=h.target,h.removeEventListener("dispose",e),o.delete(h)}var o=new Zi;return{get:function(h,m){var _=o.get(h);if(_===void 0){var T=new Rw;o.set(h,new Zi),o.get(h).set(m,T),h.addEventListener("dispose",e)}else T=_.get(m),T===void 0&&(T=new Rw,_.set(m,T));return T},dispose:function(){o=new Zi}}}function L3(){var e={};return{get:function(o){if(e[o.id]!==void 0)return e[o.id];switch(o.type){case"DirectionalLight":var h={direction:new w,color:new yt};break;case"SpotLight":h={position:new w,direction:new w,color:new yt,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":h={position:new w,color:new yt,distance:0,decay:0};break;case"HemisphereLight":h={direction:new w,skyColor:new yt,groundColor:new yt};break;case"RectAreaLight":h={color:new yt,position:new w,halfWidth:new w,halfHeight:new w}}return e[o.id]=h}}}function R3(){var e={};return{get:function(o){if(e[o.id]!==void 0)return e[o.id];switch(o.type){case"DirectionalLight":var h={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"SpotLight":h={shadowBias:0,shadowRadius:1,shadowMapSize:new f};break;case"PointLight":h={shadowBias:0,shadowRadius:1,shadowMapSize:new f,shadowCameraNear:1,shadowCameraFar:1e3}}return e[o.id]=h}}}function P3(e,o){return(o.castShadow?1:0)-(e.castShadow?1:0)}function D3(){for(var e=new L3,o=R3(),h={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},m=0;9>m;m++)h.probe.push(new w);var _=new w,T=new I,R=new I;return{setup:function(z,k,b){for(var q=0,J=0,Q=0,K=0;9>K;K++)h.probe[K].set(0,0,0);var rt=k=0,lt=0,Bt=0,Zt=0,bt=0,ae=0,Kt=0;b=b.matrixWorldInverse,z.sort(P3),K=0;for(var fe=z.length;K<fe;K++){var Xt=z[K],Me=Xt.color,Ne=Xt.intensity,pe=Xt.distance,ke=Xt.shadow&&Xt.shadow.map?Xt.shadow.map.texture:null;if(Xt.isAmbientLight)q+=Me.r*Ne,J+=Me.g*Ne,Q+=Me.b*Ne;else if(Xt.isLightProbe)for(ke=0;9>ke;ke++)h.probe[ke].addScaledVector(Xt.sh.coefficients[ke],Ne);else if(Xt.isDirectionalLight){var Fe=e.get(Xt);Fe.color.copy(Xt.color).multiplyScalar(Xt.intensity),Fe.direction.setFromMatrixPosition(Xt.matrixWorld),_.setFromMatrixPosition(Xt.target.matrixWorld),Fe.direction.sub(_),Fe.direction.transformDirection(b),Xt.castShadow&&(Ne=Xt.shadow,Me=o.get(Xt),Me.shadowBias=Ne.bias,Me.shadowRadius=Ne.radius,Me.shadowMapSize=Ne.mapSize,h.directionalShadow[k]=Me,h.directionalShadowMap[k]=ke,h.directionalShadowMatrix[k]=Xt.shadow.matrix,bt++),h.directional[k]=Fe,k++}else Xt.isSpotLight?(Fe=e.get(Xt),Fe.position.setFromMatrixPosition(Xt.matrixWorld),Fe.position.applyMatrix4(b),Fe.color.copy(Me).multiplyScalar(Ne),Fe.distance=pe,Fe.direction.setFromMatrixPosition(Xt.matrixWorld),_.setFromMatrixPosition(Xt.target.matrixWorld),Fe.direction.sub(_),Fe.direction.transformDirection(b),Fe.coneCos=Math.cos(Xt.angle),Fe.penumbraCos=Math.cos(Xt.angle*(1-Xt.penumbra)),Fe.decay=Xt.decay,Xt.castShadow&&(Ne=Xt.shadow,Me=o.get(Xt),Me.shadowBias=Ne.bias,Me.shadowRadius=Ne.radius,Me.shadowMapSize=Ne.mapSize,h.spotShadow[lt]=Me,h.spotShadowMap[lt]=ke,h.spotShadowMatrix[lt]=Xt.shadow.matrix,Kt++),h.spot[lt]=Fe,lt++):Xt.isRectAreaLight?(Fe=e.get(Xt),Fe.color.copy(Me).multiplyScalar(Ne),Fe.position.setFromMatrixPosition(Xt.matrixWorld),Fe.position.applyMatrix4(b),R.identity(),T.copy(Xt.matrixWorld),T.premultiply(b),R.extractRotation(T),Fe.halfWidth.set(.5*Xt.width,0,0),Fe.halfHeight.set(0,.5*Xt.height,0),Fe.halfWidth.applyMatrix4(R),Fe.halfHeight.applyMatrix4(R),h.rectArea[Bt]=Fe,Bt++):Xt.isPointLight?(Fe=e.get(Xt),Fe.position.setFromMatrixPosition(Xt.matrixWorld),Fe.position.applyMatrix4(b),Fe.color.copy(Xt.color).multiplyScalar(Xt.intensity),Fe.distance=Xt.distance,Fe.decay=Xt.decay,Xt.castShadow&&(Ne=Xt.shadow,Me=o.get(Xt),Me.shadowBias=Ne.bias,Me.shadowRadius=Ne.radius,Me.shadowMapSize=Ne.mapSize,Me.shadowCameraNear=Ne.camera.near,Me.shadowCameraFar=Ne.camera.far,h.pointShadow[rt]=Me,h.pointShadowMap[rt]=ke,h.pointShadowMatrix[rt]=Xt.shadow.matrix,ae++),h.point[rt]=Fe,rt++):Xt.isHemisphereLight&&(Fe=e.get(Xt),Fe.direction.setFromMatrixPosition(Xt.matrixWorld),Fe.direction.transformDirection(b),Fe.direction.normalize(),Fe.skyColor.copy(Xt.color).multiplyScalar(Ne),Fe.groundColor.copy(Xt.groundColor).multiplyScalar(Ne),h.hemi[Zt]=Fe,Zt++)}h.ambient[0]=q,h.ambient[1]=J,h.ambient[2]=Q,z=h.hash,(z.directionalLength!==k||z.pointLength!==rt||z.spotLength!==lt||z.rectAreaLength!==Bt||z.hemiLength!==Zt||z.numDirectionalShadows!==bt||z.numPointShadows!==ae||z.numSpotShadows!==Kt)&&(h.directional.length=k,h.spot.length=lt,h.rectArea.length=Bt,h.point.length=rt,h.hemi.length=Zt,h.directionalShadow.length=bt,h.directionalShadowMap.length=bt,h.pointShadow.length=ae,h.pointShadowMap.length=ae,h.spotShadow.length=Kt,h.spotShadowMap.length=Kt,h.directionalShadowMatrix.length=bt,h.pointShadowMatrix.length=ae,h.spotShadowMatrix.length=Kt,z.directionalLength=k,z.pointLength=rt,z.spotLength=lt,z.rectAreaLength=Bt,z.hemiLength=Zt,z.numDirectionalShadows=bt,z.numPointShadows=ae,z.numSpotShadows=Kt,h.version=sT++)},state:h}}function Pw(){var e=new D3,o=[],h=[];return{init:function(){o.length=0,h.length=0},state:{lightsArray:o,shadowsArray:h,lights:e},setupLights:function(m){e.setup(o,h,m)},pushLight:function(m){o.push(m)},pushShadow:function(m){h.push(m)}}}function O3(){function e(h){h=h.target,h.removeEventListener("dispose",e),o.delete(h)}var o=new Zi;return{get:function(h,m){if(o.has(h)===!1){var _=new Pw;o.set(h,new Zi),o.get(h).set(m,_),h.addEventListener("dispose",e)}else o.get(h).has(m)===!1?(_=new Pw,o.get(h).set(m,_)):_=o.get(h).get(m);return _},dispose:function(){o=new Zi}}}function hc(e){re.call(this),this.type="MeshDepthMaterial",this.depthPacking=3200,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(e)}function cc(e){re.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new w,this.nearDistance=1,this.farDistance=1e3,this.morphTargets=this.skinning=!1,this.displacementMap=this.alphaMap=this.map=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(e)}function Dw(e,o,h){function m(Kt,fe,Xt){Xt=Kt<<0|fe<<1|Xt<<2;var Me=J[Xt];return Me===void 0&&(Me=new hc({depthPacking:3201,morphTargets:Kt,skinning:fe}),J[Xt]=Me),Me}function _(Kt,fe,Xt){Xt=Kt<<0|fe<<1|Xt<<2;var Me=Q[Xt];return Me===void 0&&(Me=new cc({morphTargets:Kt,skinning:fe}),Q[Xt]=Me),Me}function T(Kt,fe,Xt,Me,Ne,pe,ke){var Fe=m,Ar=Kt.customDepthMaterial;return Me.isPointLight===!0&&(Fe=_,Ar=Kt.customDistanceMaterial),Ar===void 0?(Ar=!1,Xt.morphTargets===!0&&(Ar=fe.morphAttributes&&fe.morphAttributes.position&&0<fe.morphAttributes.position.length),fe=!1,Kt.isSkinnedMesh===!0&&(Xt.skinning===!0?fe=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",Kt)),Kt=Fe(Ar,fe,Kt.isInstancedMesh===!0)):Kt=Ar,e.localClippingEnabled&&Xt.clipShadows===!0&&Xt.clippingPlanes.length!==0&&(Ar=Kt.uuid,Fe=Xt.uuid,fe=K[Ar],fe===void 0&&(fe={},K[Ar]=fe),Ar=fe[Fe],Ar===void 0&&(Ar=Kt.clone(),fe[Fe]=Ar),Kt=Ar),Kt.visible=Xt.visible,Kt.wireframe=Xt.wireframe,Kt.side=ke===3?Xt.shadowSide!==null?Xt.shadowSide:Xt.side:Xt.shadowSide!==null?Xt.shadowSide:rt[Xt.side],Kt.clipShadows=Xt.clipShadows,Kt.clippingPlanes=Xt.clippingPlanes,Kt.clipIntersection=Xt.clipIntersection,Kt.wireframeLinewidth=Xt.wireframeLinewidth,Kt.linewidth=Xt.linewidth,Me.isPointLight===!0&&Kt.isMeshDistanceMaterial===!0&&(Kt.referencePosition.setFromMatrixPosition(Me.matrixWorld),Kt.nearDistance=Ne,Kt.farDistance=pe),Kt}function R(Kt,fe,Xt,Me,Ne){if(Kt.visible!==!1){if(Kt.layers.test(fe.layers)&&(Kt.isMesh||Kt.isLine||Kt.isPoints)&&(Kt.castShadow||Kt.receiveShadow&&Ne===3)&&(!Kt.frustumCulled||z.intersectsObject(Kt))){Kt.modelViewMatrix.multiplyMatrices(Xt.matrixWorldInverse,Kt.matrixWorld);var pe=o.update(Kt),ke=Kt.material;if(Array.isArray(ke))for(var Fe=pe.groups,Ar=0,kr=Fe.length;Ar<kr;Ar++){var ir=Fe[Ar],zr=ke[ir.materialIndex];zr&&zr.visible&&(zr=T(Kt,pe,zr,Me,Xt.near,Xt.far,Ne),e.renderBufferDirect(Xt,null,pe,zr,Kt,ir))}else ke.visible&&(zr=T(Kt,pe,ke,Me,Xt.near,Xt.far,Ne),e.renderBufferDirect(Xt,null,pe,zr,Kt,null))}for(Kt=Kt.children,pe=0,ke=Kt.length;pe<ke;pe++)R(Kt[pe],fe,Xt,Me,Ne)}}var z=new ar,k=new f,b=new f,q=new p,J=[],Q=[],K={},rt={0:1,1:0,2:2},lt=new me({defines:{SAMPLE_RATE:.25,HALF_SAMPLE_RATE:.125},uniforms:{shadow_pass:{value:null},resolution:{value:new f},radius:{value:4}},vertexShader:`void main() {
	gl_Position = vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
  float mean = 0.0;
  float squared_mean = 0.0;
	float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy  ) / resolution ) );
  for ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {
    #ifdef HORIZONAL_PASS
      vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );
      mean += distribution.x;
      squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
    #else
      float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0,  i )  * radius ) / resolution ) );
      mean += depth;
      squared_mean += depth * depth;
    #endif
  }
  mean = mean * HALF_SAMPLE_RATE;
  squared_mean = squared_mean * HALF_SAMPLE_RATE;
  float std_dev = sqrt( squared_mean - mean * mean );
  gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`}),Bt=lt.clone();Bt.defines.HORIZONAL_PASS=1;var Zt=new ct;Zt.setAttribute("position",new ce(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var bt=new St(Zt,lt),ae=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(Kt,fe,Xt){if(ae.enabled!==!1&&(ae.autoUpdate!==!1||ae.needsUpdate!==!1)&&Kt.length!==0){var Me=e.getRenderTarget(),Ne=e.getActiveCubeFace(),pe=e.getActiveMipmapLevel(),ke=e.state;ke.setBlending(0),ke.buffers.color.setClear(1,1,1,1),ke.buffers.depth.setTest(!0),ke.setScissorTest(!1);for(var Fe=0,Ar=Kt.length;Fe<Ar;Fe++){var kr=Kt[Fe],ir=kr.shadow;if(ir===void 0)console.warn("THREE.WebGLShadowMap:",kr,"has no shadow.");else{k.copy(ir.mapSize);var zr=ir.getFrameExtents();k.multiply(zr),b.copy(ir.mapSize),(k.x>h||k.y>h)&&(k.x>h&&(b.x=Math.floor(h/zr.x),k.x=b.x*zr.x,ir.mapSize.x=b.x),k.y>h&&(b.y=Math.floor(h/zr.y),k.y=b.y*zr.y,ir.mapSize.y=b.y)),ir.map!==null||ir.isPointLightShadow||this.type!==3||(zr={minFilter:1006,magFilter:1006,format:1023},ir.map=new A(k.x,k.y,zr),ir.map.texture.name=kr.name+".shadowMap",ir.mapPass=new A(k.x,k.y,zr),ir.camera.updateProjectionMatrix()),ir.map===null&&(zr={minFilter:1003,magFilter:1003,format:1023},ir.map=new A(k.x,k.y,zr),ir.map.texture.name=kr.name+".shadowMap",ir.camera.updateProjectionMatrix()),e.setRenderTarget(ir.map),e.clear(),zr=ir.getViewportCount();for(var ui=0;ui<zr;ui++){var Kr=ir.getViewport(ui);q.set(b.x*Kr.x,b.y*Kr.y,b.x*Kr.z,b.y*Kr.w),ke.viewport(q),ir.updateMatrices(kr,ui),z=ir.getFrustum(),R(fe,Xt,ir.camera,kr,this.type)}ir.isPointLightShadow||this.type!==3||(kr=ir,ir=Xt,zr=o.update(bt),lt.uniforms.shadow_pass.value=kr.map.texture,lt.uniforms.resolution.value=kr.mapSize,lt.uniforms.radius.value=kr.radius,e.setRenderTarget(kr.mapPass),e.clear(),e.renderBufferDirect(ir,null,zr,lt,bt,null),Bt.uniforms.shadow_pass.value=kr.mapPass.texture,Bt.uniforms.resolution.value=kr.mapSize,Bt.uniforms.radius.value=kr.radius,e.setRenderTarget(kr.map),e.clear(),e.renderBufferDirect(ir,null,zr,Bt,bt,null))}}ae.needsUpdate=!1,e.setRenderTarget(Me,Ne,pe)}}}function F3(e,o,h){function m(Ht,Ye,vr){var br=new Uint8Array(4),wr=e.createTexture();for(e.bindTexture(Ht,wr),e.texParameteri(Ht,10241,9728),e.texParameteri(Ht,10240,9728),Ht=0;Ht<vr;Ht++)e.texImage2D(Ye+Ht,0,6408,1,1,0,6408,5121,br);return wr}function _(Ht,Ye){Bt[Ht]=1,Zt[Ht]===0&&(e.enableVertexAttribArray(Ht),Zt[Ht]=1),bt[Ht]!==Ye&&((Q?e:o.get("ANGLE_instanced_arrays"))[Q?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Ht,Ye),bt[Ht]=Ye)}function T(Ht){ae[Ht]!==!0&&(e.enable(Ht),ae[Ht]=!0)}function R(Ht){ae[Ht]!==!1&&(e.disable(Ht),ae[Ht]=!1)}function z(Ht,Ye,vr,br,wr,ur,lr,ti){if(Ht===0)fe&&(R(3042),fe=!1);else if(fe||(T(3042),fe=!0),Ht!==5){if(Ht!==Xt||ti!==kr){if((Me!==100||ke!==100)&&(e.blendEquation(32774),ke=Me=100),ti)switch(Ht){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ht)}else switch(Ht){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",Ht)}Ar=Fe=pe=Ne=null,Xt=Ht,kr=ti}}else wr=wr||Ye,ur=ur||vr,lr=lr||br,(Ye!==Me||wr!==ke)&&(e.blendEquationSeparate(cr[Ye],cr[wr]),Me=Ye,ke=wr),(vr!==Ne||br!==pe||ur!==Fe||lr!==Ar)&&(e.blendFuncSeparate(Le[vr],Le[br],Le[ur],Le[lr]),Ne=vr,pe=br,Fe=ur,Ar=lr),Xt=Ht,kr=null}function k(Ht){ir!==Ht&&(Ht?e.frontFace(2304):e.frontFace(2305),ir=Ht)}function b(Ht){Ht!==0?(T(2884),Ht!==zr&&(Ht===1?e.cullFace(1029):Ht===2?e.cullFace(1028):e.cullFace(1032))):R(2884),zr=Ht}function q(Ht,Ye,vr){Ht?(T(32823),(Kr!==Ye||Mi!==vr)&&(e.polygonOffset(Ye,vr),Kr=Ye,Mi=vr)):R(32823)}function J(Ht){Ht===void 0&&(Ht=33984+fi-1),en!==Ht&&(e.activeTexture(Ht),en=Ht)}var Q=h.isWebGL2,K=new function(){var Ht=!1,Ye=new p,vr=null,br=new p(0,0,0,0);return{setMask:function(wr){vr===wr||Ht||(e.colorMask(wr,wr,wr,wr),vr=wr)},setLocked:function(wr){Ht=wr},setClear:function(wr,ur,lr,ti,Mn){Mn===!0&&(wr*=ti,ur*=ti,lr*=ti),Ye.set(wr,ur,lr,ti),br.equals(Ye)===!1&&(e.clearColor(wr,ur,lr,ti),br.copy(Ye))},reset:function(){Ht=!1,vr=null,br.set(-1,0,0,0)}}},rt=new function(){var Ht=!1,Ye=null,vr=null,br=null;return{setTest:function(wr){wr?T(2929):R(2929)},setMask:function(wr){Ye===wr||Ht||(e.depthMask(wr),Ye=wr)},setFunc:function(wr){if(vr!==wr){if(wr)switch(wr){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517);break;default:e.depthFunc(515)}else e.depthFunc(515);vr=wr}},setLocked:function(wr){Ht=wr},setClear:function(wr){br!==wr&&(e.clearDepth(wr),br=wr)},reset:function(){Ht=!1,br=vr=Ye=null}}},lt=new function(){var Ht=!1,Ye=null,vr=null,br=null,wr=null,ur=null,lr=null,ti=null,Mn=null;return{setTest:function(ri){Ht||(ri?T(2960):R(2960))},setMask:function(ri){Ye===ri||Ht||(e.stencilMask(ri),Ye=ri)},setFunc:function(ri,De,ei){(vr!==ri||br!==De||wr!==ei)&&(e.stencilFunc(ri,De,ei),vr=ri,br=De,wr=ei)},setOp:function(ri,De,ei){(ur!==ri||lr!==De||ti!==ei)&&(e.stencilOp(ri,De,ei),ur=ri,lr=De,ti=ei)},setLocked:function(ri){Ht=ri},setClear:function(ri){Mn!==ri&&(e.clearStencil(ri),Mn=ri)},reset:function(){Ht=!1,Mn=ti=lr=ur=wr=br=vr=Ye=null}}};h=e.getParameter(34921);var Bt=new Uint8Array(h),Zt=new Uint8Array(h),bt=new Uint8Array(h),ae={},Kt=null,fe=null,Xt=null,Me=null,Ne=null,pe=null,ke=null,Fe=null,Ar=null,kr=!1,ir=null,zr=null,ui=null,Kr=null,Mi=null,fi=e.getParameter(35661),Hi=!1;h=0,h=e.getParameter(7938),h.indexOf("WebGL")!==-1?(h=parseFloat(/^WebGL ([0-9])/.exec(h)[1]),Hi=1<=h):h.indexOf("OpenGL ES")!==-1&&(h=parseFloat(/^OpenGL ES ([0-9])/.exec(h)[1]),Hi=2<=h);var en=null,wt={},Nt=new p,ye=new p,Ve={};Ve[3553]=m(3553,3553,1),Ve[34067]=m(34067,34069,6),K.setClear(0,0,0,1),rt.setClear(1),lt.setClear(0),T(2929),rt.setFunc(3),k(!1),b(1),T(2884),z(0);var cr={100:32774,101:32778,102:32779};Q?(cr[103]=32775,cr[104]=32776):(h=o.get("EXT_blend_minmax"),h!==null&&(cr[103]=h.MIN_EXT,cr[104]=h.MAX_EXT));var Le={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};return{buffers:{color:K,depth:rt,stencil:lt},initAttributes:function(){for(var Ht=0,Ye=Bt.length;Ht<Ye;Ht++)Bt[Ht]=0},enableAttribute:function(Ht){_(Ht,0)},enableAttributeAndDivisor:_,disableUnusedAttributes:function(){for(var Ht=0,Ye=Zt.length;Ht!==Ye;++Ht)Zt[Ht]!==Bt[Ht]&&(e.disableVertexAttribArray(Ht),Zt[Ht]=0)},vertexAttribPointer:function(Ht,Ye,vr,br,wr,ur){Q!==!0||vr!==5124&&vr!==5125?e.vertexAttribPointer(Ht,Ye,vr,br,wr,ur):e.vertexAttribIPointer(Ht,Ye,vr,br,wr,ur)},enable:T,disable:R,useProgram:function(Ht){return Kt!==Ht?(e.useProgram(Ht),Kt=Ht,!0):!1},setBlending:z,setMaterial:function(Ht,Ye){Ht.side===2?R(2884):T(2884);var vr=Ht.side===1;Ye&&(vr=!vr),k(vr),Ht.blending===1&&Ht.transparent===!1?z(0):z(Ht.blending,Ht.blendEquation,Ht.blendSrc,Ht.blendDst,Ht.blendEquationAlpha,Ht.blendSrcAlpha,Ht.blendDstAlpha,Ht.premultipliedAlpha),rt.setFunc(Ht.depthFunc),rt.setTest(Ht.depthTest),rt.setMask(Ht.depthWrite),K.setMask(Ht.colorWrite),Ye=Ht.stencilWrite,lt.setTest(Ye),Ye&&(lt.setMask(Ht.stencilWriteMask),lt.setFunc(Ht.stencilFunc,Ht.stencilRef,Ht.stencilFuncMask),lt.setOp(Ht.stencilFail,Ht.stencilZFail,Ht.stencilZPass)),q(Ht.polygonOffset,Ht.polygonOffsetFactor,Ht.polygonOffsetUnits)},setFlipSided:k,setCullFace:b,setLineWidth:function(Ht){Ht!==ui&&(Hi&&e.lineWidth(Ht),ui=Ht)},setPolygonOffset:q,setScissorTest:function(Ht){Ht?T(3089):R(3089)},activeTexture:J,bindTexture:function(Ht,Ye){en===null&&J();var vr=wt[en];vr===void 0&&(vr={type:void 0,texture:void 0},wt[en]=vr),(vr.type!==Ht||vr.texture!==Ye)&&(e.bindTexture(Ht,Ye||Ve[Ht]),vr.type=Ht,vr.texture=Ye)},unbindTexture:function(){var Ht=wt[en];Ht!==void 0&&Ht.type!==void 0&&(e.bindTexture(Ht.type,null),Ht.type=void 0,Ht.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(Ht){console.error("THREE.WebGLState:",Ht)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(Ht){console.error("THREE.WebGLState:",Ht)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(Ht){console.error("THREE.WebGLState:",Ht)}},scissor:function(Ht){Nt.equals(Ht)===!1&&(e.scissor(Ht.x,Ht.y,Ht.z,Ht.w),Nt.copy(Ht))},viewport:function(Ht){ye.equals(Ht)===!1&&(e.viewport(Ht.x,Ht.y,Ht.z,Ht.w),ye.copy(Ht))},reset:function(){for(var Ht=0;Ht<Zt.length;Ht++)Zt[Ht]===1&&(e.disableVertexAttribArray(Ht),Zt[Ht]=0);ae={},en=null,wt={},zr=ir=Xt=Kt=null,K.reset(),rt.reset(),lt.reset()}}}function B3(e,o,h,m,_,T,R){function z(wt,Nt){return ui?new OffscreenCanvas(wt,Nt):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function k(wt,Nt,ye,Ve){var cr=1;if((wt.width>Ve||wt.height>Ve)&&(cr=Ve/Math.max(wt.width,wt.height)),1>cr||Nt===!0){if(typeof HTMLImageElement!="undefined"&&wt instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&wt instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&wt instanceof ImageBitmap)return Ve=Nt?di.floorPowerOfTwo:Math.floor,Nt=Ve(cr*wt.width),cr=Ve(cr*wt.height),zr===void 0&&(zr=z(Nt,cr)),ye=ye?z(Nt,cr):zr,ye.width=Nt,ye.height=cr,ye.getContext("2d").drawImage(wt,0,0,Nt,cr),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+wt.width+"x"+wt.height+") to ("+Nt+"x"+cr+")."),ye;"data"in wt&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+wt.width+"x"+wt.height+").")}return wt}function b(wt){return di.isPowerOfTwo(wt.width)&&di.isPowerOfTwo(wt.height)}function q(wt,Nt){return wt.generateMipmaps&&Nt&&wt.minFilter!==1003&&wt.minFilter!==1006}function J(wt,Nt,ye,Ve){e.generateMipmap(wt),m.get(Nt).__maxMipLevel=Math.log(Math.max(ye,Ve))*Math.LOG2E}function Q(wt,Nt,ye){if(pe===!1)return Nt;if(wt!==null){if(e[wt]!==void 0)return e[wt];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+wt+"'")}return wt=Nt,Nt===6403&&(ye===5126&&(wt=33326),ye===5131&&(wt=33325),ye===5121&&(wt=33321)),Nt===6407&&(ye===5126&&(wt=34837),ye===5131&&(wt=34843),ye===5121&&(wt=32849)),Nt===6408&&(ye===5126&&(wt=34836),ye===5131&&(wt=34842),ye===5121&&(wt=32856)),wt!==33325&&wt!==33326&&wt!==34842&&wt!==34836||o.get("EXT_color_buffer_float"),wt}function K(wt){return wt===1003||wt===1004||wt===1005?9728:9729}function rt(wt){wt=wt.target,wt.removeEventListener("dispose",rt);var Nt=m.get(wt);Nt.__webglInit!==void 0&&(e.deleteTexture(Nt.__webglTexture),m.remove(wt)),wt.isVideoTexture&&ir.delete(wt),R.memory.textures--}function lt(wt){wt=wt.target,wt.removeEventListener("dispose",lt);var Nt=m.get(wt),ye=m.get(wt.texture);if(wt){if(ye.__webglTexture!==void 0&&e.deleteTexture(ye.__webglTexture),wt.depthTexture&&wt.depthTexture.dispose(),wt.isWebGLCubeRenderTarget)for(ye=0;6>ye;ye++)e.deleteFramebuffer(Nt.__webglFramebuffer[ye]),Nt.__webglDepthbuffer&&e.deleteRenderbuffer(Nt.__webglDepthbuffer[ye]);else e.deleteFramebuffer(Nt.__webglFramebuffer),Nt.__webglDepthbuffer&&e.deleteRenderbuffer(Nt.__webglDepthbuffer),Nt.__webglMultisampledFramebuffer&&e.deleteFramebuffer(Nt.__webglMultisampledFramebuffer),Nt.__webglColorRenderbuffer&&e.deleteRenderbuffer(Nt.__webglColorRenderbuffer),Nt.__webglDepthRenderbuffer&&e.deleteRenderbuffer(Nt.__webglDepthRenderbuffer);m.remove(wt.texture),m.remove(wt)}R.memory.textures--}function Bt(wt,Nt){var ye=m.get(wt);if(wt.isVideoTexture){var Ve=R.render.frame;ir.get(wt)!==Ve&&(ir.set(wt,Ve),wt.update())}if(0<wt.version&&ye.__version!==wt.version)if(Ve=wt.image,Ve===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(Ve.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{fe(ye,wt,Nt);return}h.activeTexture(33984+Nt),h.bindTexture(3553,ye.__webglTexture)}function Zt(wt,Nt){if(wt.image.length===6){var ye=m.get(wt);if(0<wt.version&&ye.__version!==wt.version){Kt(ye,wt),h.activeTexture(33984+Nt),h.bindTexture(34067,ye.__webglTexture),e.pixelStorei(37440,wt.flipY);var Ve=wt&&(wt.isCompressedTexture||wt.image[0].isCompressedTexture);Nt=wt.image[0]&&wt.image[0].isDataTexture;for(var cr=[],Le=0;6>Le;Le++)cr[Le]=Ve||Nt?Nt?wt.image[Le].image:wt.image[Le]:k(wt.image[Le],!1,!0,Fe);var Ht=cr[0],Ye=b(Ht)||pe,vr=T.convert(wt.format),br=T.convert(wt.type),wr=Q(wt.internalFormat,vr,br);if(ae(34067,wt,Ye),Ve){for(Le=0;6>Le;Le++){var ur=cr[Le].mipmaps;for(Ve=0;Ve<ur.length;Ve++){var lr=ur[Ve];wt.format!==1023&&wt.format!==1022?vr!==null?h.compressedTexImage2D(34069+Le,Ve,wr,lr.width,lr.height,0,lr.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):h.texImage2D(34069+Le,Ve,wr,lr.width,lr.height,0,vr,br,lr.data)}}ye.__maxMipLevel=ur.length-1}else{for(ur=wt.mipmaps,Le=0;6>Le;Le++)if(Nt)for(h.texImage2D(34069+Le,0,wr,cr[Le].width,cr[Le].height,0,vr,br,cr[Le].data),Ve=0;Ve<ur.length;Ve++)lr=ur[Ve],lr=lr.image[Le].image,h.texImage2D(34069+Le,Ve+1,wr,lr.width,lr.height,0,vr,br,lr.data);else for(h.texImage2D(34069+Le,0,wr,vr,br,cr[Le]),Ve=0;Ve<ur.length;Ve++)lr=ur[Ve],h.texImage2D(34069+Le,Ve+1,wr,vr,br,lr.image[Le]);ye.__maxMipLevel=ur.length}q(wt,Ye)&&J(34067,wt,Ht.width,Ht.height),ye.__version=wt.version,wt.onUpdate&&wt.onUpdate(wt)}else h.activeTexture(33984+Nt),h.bindTexture(34067,ye.__webglTexture)}}function bt(wt,Nt){h.activeTexture(33984+Nt),h.bindTexture(34067,m.get(wt).__webglTexture)}function ae(wt,Nt,ye){ye?(e.texParameteri(wt,10242,Mi[Nt.wrapS]),e.texParameteri(wt,10243,Mi[Nt.wrapT]),wt!==32879&&wt!==35866||e.texParameteri(wt,32882,Mi[Nt.wrapR]),e.texParameteri(wt,10240,fi[Nt.magFilter]),e.texParameteri(wt,10241,fi[Nt.minFilter])):(e.texParameteri(wt,10242,33071),e.texParameteri(wt,10243,33071),wt!==32879&&wt!==35866||e.texParameteri(wt,32882,33071),Nt.wrapS===1001&&Nt.wrapT===1001||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(wt,10240,K(Nt.magFilter)),e.texParameteri(wt,10241,K(Nt.minFilter)),Nt.minFilter!==1003&&Nt.minFilter!==1006&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!(ye=o.get("EXT_texture_filter_anisotropic"))||Nt.type===1015&&o.get("OES_texture_float_linear")===null||Nt.type===1016&&(pe||o.get("OES_texture_half_float_linear"))===null||!(1<Nt.anisotropy||m.get(Nt).__currentAnisotropy)||(e.texParameterf(wt,ye.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Nt.anisotropy,_.getMaxAnisotropy())),m.get(Nt).__currentAnisotropy=Nt.anisotropy)}function Kt(wt,Nt){wt.__webglInit===void 0&&(wt.__webglInit=!0,Nt.addEventListener("dispose",rt),wt.__webglTexture=e.createTexture(),R.memory.textures++)}function fe(wt,Nt,ye){var Ve=3553;Nt.isDataTexture2DArray&&(Ve=35866),Nt.isDataTexture3D&&(Ve=32879),Kt(wt,Nt),h.activeTexture(33984+ye),h.bindTexture(Ve,wt.__webglTexture),e.pixelStorei(37440,Nt.flipY),e.pixelStorei(37441,Nt.premultiplyAlpha),e.pixelStorei(3317,Nt.unpackAlignment),ye=pe?!1:Nt.wrapS!==1001||Nt.wrapT!==1001||Nt.minFilter!==1003&&Nt.minFilter!==1006,ye=ye&&b(Nt.image)===!1,ye=k(Nt.image,ye,!1,Ar);var cr=b(ye)||pe,Le=T.convert(Nt.format),Ht=T.convert(Nt.type),Ye=Q(Nt.internalFormat,Le,Ht);ae(Ve,Nt,cr);var vr=Nt.mipmaps;if(Nt.isDepthTexture)Ye=6402,pe?Ye=Nt.type===1015?36012:Nt.type===1014?33190:Nt.type===1020?35056:33189:Nt.type===1015&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Nt.format===1026&&Ye===6402&&Nt.type!==1012&&Nt.type!==1014&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Nt.type=1012,Ht=T.convert(Nt.type)),Nt.format===1027&&Ye===6402&&(Ye=34041,Nt.type!==1020&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Nt.type=1020,Ht=T.convert(Nt.type))),h.texImage2D(3553,0,Ye,ye.width,ye.height,0,Le,Ht,null);else if(Nt.isDataTexture)if(0<vr.length&&cr){for(var br=0,wr=vr.length;br<wr;br++){var ur=vr[br];h.texImage2D(3553,br,Ye,ur.width,ur.height,0,Le,Ht,ur.data)}Nt.generateMipmaps=!1,wt.__maxMipLevel=vr.length-1}else h.texImage2D(3553,0,Ye,ye.width,ye.height,0,Le,Ht,ye.data),wt.__maxMipLevel=0;else if(Nt.isCompressedTexture){for(br=0,wr=vr.length;br<wr;br++)ur=vr[br],Nt.format!==1023&&Nt.format!==1022?Le!==null?h.compressedTexImage2D(3553,br,Ye,ur.width,ur.height,0,ur.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):h.texImage2D(3553,br,Ye,ur.width,ur.height,0,Le,Ht,ur.data);wt.__maxMipLevel=vr.length-1}else if(Nt.isDataTexture2DArray)h.texImage3D(35866,0,Ye,ye.width,ye.height,ye.depth,0,Le,Ht,ye.data),wt.__maxMipLevel=0;else if(Nt.isDataTexture3D)h.texImage3D(32879,0,Ye,ye.width,ye.height,ye.depth,0,Le,Ht,ye.data),wt.__maxMipLevel=0;else if(0<vr.length&&cr){for(br=0,wr=vr.length;br<wr;br++)ur=vr[br],h.texImage2D(3553,br,Ye,Le,Ht,ur);Nt.generateMipmaps=!1,wt.__maxMipLevel=vr.length-1}else h.texImage2D(3553,0,Ye,Le,Ht,ye),wt.__maxMipLevel=0;q(Nt,cr)&&J(Ve,Nt,ye.width,ye.height),wt.__version=Nt.version,Nt.onUpdate&&Nt.onUpdate(Nt)}function Xt(wt,Nt,ye,Ve){var cr=T.convert(Nt.texture.format),Le=T.convert(Nt.texture.type),Ht=Q(Nt.texture.internalFormat,cr,Le);h.texImage2D(Ve,0,Ht,Nt.width,Nt.height,0,cr,Le,null),e.bindFramebuffer(36160,wt),e.framebufferTexture2D(36160,ye,Ve,m.get(Nt.texture).__webglTexture,0),e.bindFramebuffer(36160,null)}function Me(wt,Nt,ye){if(e.bindRenderbuffer(36161,wt),Nt.depthBuffer&&!Nt.stencilBuffer){var Ve=33189;ye?((ye=Nt.depthTexture)&&ye.isDepthTexture&&(ye.type===1015?Ve=36012:ye.type===1014&&(Ve=33190)),ye=Ne(Nt),e.renderbufferStorageMultisample(36161,ye,Ve,Nt.width,Nt.height)):e.renderbufferStorage(36161,Ve,Nt.width,Nt.height),e.framebufferRenderbuffer(36160,36096,36161,wt)}else Nt.depthBuffer&&Nt.stencilBuffer?(ye?(ye=Ne(Nt),e.renderbufferStorageMultisample(36161,ye,35056,Nt.width,Nt.height)):e.renderbufferStorage(36161,34041,Nt.width,Nt.height),e.framebufferRenderbuffer(36160,33306,36161,wt)):(wt=T.convert(Nt.texture.format),Ve=T.convert(Nt.texture.type),Ve=Q(Nt.texture.internalFormat,wt,Ve),ye?(ye=Ne(Nt),e.renderbufferStorageMultisample(36161,ye,Ve,Nt.width,Nt.height)):e.renderbufferStorage(36161,Ve,Nt.width,Nt.height));e.bindRenderbuffer(36161,null)}function Ne(wt){return pe&&wt.isWebGLMultisampleRenderTarget?Math.min(kr,wt.samples):0}var pe=_.isWebGL2,ke=_.maxTextures,Fe=_.maxCubemapSize,Ar=_.maxTextureSize,kr=_.maxSamples,ir=new Zi,zr,ui=!1;try{ui=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch(wt){}var Kr=0,Mi={1e3:10497,1001:33071,1002:33648},fi={1003:9728,1004:9984,1005:9986,1006:9729,1007:9985,1008:9987},Hi=!1,en=!1;this.allocateTextureUnit=function(){var wt=Kr;return wt>=ke&&console.warn("THREE.WebGLTextures: Trying to use "+wt+" texture units while this GPU supports only "+ke),Kr+=1,wt},this.resetTextureUnits=function(){Kr=0},this.setTexture2D=Bt,this.setTexture2DArray=function(wt,Nt){var ye=m.get(wt);0<wt.version&&ye.__version!==wt.version?fe(ye,wt,Nt):(h.activeTexture(33984+Nt),h.bindTexture(35866,ye.__webglTexture))},this.setTexture3D=function(wt,Nt){var ye=m.get(wt);0<wt.version&&ye.__version!==wt.version?fe(ye,wt,Nt):(h.activeTexture(33984+Nt),h.bindTexture(32879,ye.__webglTexture))},this.setTextureCube=Zt,this.setTextureCubeDynamic=bt,this.setupRenderTarget=function(wt){var Nt=m.get(wt),ye=m.get(wt.texture);wt.addEventListener("dispose",lt),ye.__webglTexture=e.createTexture(),R.memory.textures++;var Ve=wt.isWebGLCubeRenderTarget===!0,cr=wt.isWebGLMultisampleRenderTarget===!0,Le=b(wt)||pe;if(!pe||wt.texture.format!==1022||wt.texture.type!==1015&&wt.texture.type!==1016||(wt.texture.format=1023,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),Ve)for(Nt.__webglFramebuffer=[],cr=0;6>cr;cr++)Nt.__webglFramebuffer[cr]=e.createFramebuffer();else if(Nt.__webglFramebuffer=e.createFramebuffer(),cr)if(pe){Nt.__webglMultisampledFramebuffer=e.createFramebuffer(),Nt.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,Nt.__webglColorRenderbuffer),cr=T.convert(wt.texture.format);var Ht=T.convert(wt.texture.type);cr=Q(wt.texture.internalFormat,cr,Ht),Ht=Ne(wt),e.renderbufferStorageMultisample(36161,Ht,cr,wt.width,wt.height),e.bindFramebuffer(36160,Nt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,Nt.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),wt.depthBuffer&&(Nt.__webglDepthRenderbuffer=e.createRenderbuffer(),Me(Nt.__webglDepthRenderbuffer,wt,!0)),e.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(Ve){for(h.bindTexture(34067,ye.__webglTexture),ae(34067,wt.texture,Le),cr=0;6>cr;cr++)Xt(Nt.__webglFramebuffer[cr],wt,36064,34069+cr);q(wt.texture,Le)&&J(34067,wt.texture,wt.width,wt.height),h.bindTexture(34067,null)}else h.bindTexture(3553,ye.__webglTexture),ae(3553,wt.texture,Le),Xt(Nt.__webglFramebuffer,wt,36064,3553),q(wt.texture,Le)&&J(3553,wt.texture,wt.width,wt.height),h.bindTexture(3553,null);if(wt.depthBuffer){if(Nt=m.get(wt),ye=wt.isWebGLCubeRenderTarget===!0,wt.depthTexture){if(ye)throw Error("target.depthTexture not supported in Cube render targets");if(wt&&wt.isWebGLCubeRenderTarget)throw Error("Depth Texture with cube render targets is not supported");if(e.bindFramebuffer(36160,Nt.__webglFramebuffer),!wt.depthTexture||!wt.depthTexture.isDepthTexture)throw Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");if(m.get(wt.depthTexture).__webglTexture&&wt.depthTexture.image.width===wt.width&&wt.depthTexture.image.height===wt.height||(wt.depthTexture.image.width=wt.width,wt.depthTexture.image.height=wt.height,wt.depthTexture.needsUpdate=!0),Bt(wt.depthTexture,0),Nt=m.get(wt.depthTexture).__webglTexture,wt.depthTexture.format===1026)e.framebufferTexture2D(36160,36096,3553,Nt,0);else if(wt.depthTexture.format===1027)e.framebufferTexture2D(36160,33306,3553,Nt,0);else throw Error("Unknown depthTexture format")}else if(ye)for(Nt.__webglDepthbuffer=[],ye=0;6>ye;ye++)e.bindFramebuffer(36160,Nt.__webglFramebuffer[ye]),Nt.__webglDepthbuffer[ye]=e.createRenderbuffer(),Me(Nt.__webglDepthbuffer[ye],wt,!1);else e.bindFramebuffer(36160,Nt.__webglFramebuffer),Nt.__webglDepthbuffer=e.createRenderbuffer(),Me(Nt.__webglDepthbuffer,wt,!1);e.bindFramebuffer(36160,null)}},this.updateRenderTargetMipmap=function(wt){var Nt=wt.texture,ye=b(wt)||pe;if(q(Nt,ye)){ye=wt.isWebGLCubeRenderTarget?34067:3553;var Ve=m.get(Nt).__webglTexture;h.bindTexture(ye,Ve),J(ye,Nt,wt.width,wt.height),h.bindTexture(ye,null)}},this.updateMultisampleRenderTarget=function(wt){if(wt.isWebGLMultisampleRenderTarget)if(pe){var Nt=m.get(wt);e.bindFramebuffer(36008,Nt.__webglMultisampledFramebuffer),e.bindFramebuffer(36009,Nt.__webglFramebuffer);var ye=wt.width,Ve=wt.height,cr=16384;wt.depthBuffer&&(cr|=256),wt.stencilBuffer&&(cr|=1024),e.blitFramebuffer(0,0,ye,Ve,0,0,ye,Ve,cr,9728),e.bindFramebuffer(36160,Nt.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(wt,Nt){wt&&wt.isWebGLRenderTarget&&(Hi===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),Hi=!0),wt=wt.texture),Bt(wt,Nt)},this.safeSetTextureCube=function(wt,Nt){wt&&wt.isWebGLCubeRenderTarget&&(en===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),en=!0),wt=wt.texture),wt&&wt.isCubeTexture||Array.isArray(wt.image)&&wt.image.length===6?Zt(wt,Nt):bt(wt,Nt)}}function Ow(e,o,h){var m=h.isWebGL2;return{convert:function(_){if(_===1009)return 5121;if(_===1017)return 32819;if(_===1018)return 32820;if(_===1019)return 33635;if(_===1010)return 5120;if(_===1011)return 5122;if(_===1012)return 5123;if(_===1013)return 5124;if(_===1014)return 5125;if(_===1015)return 5126;if(_===1016){if(m)return 5131;var T=o.get("OES_texture_half_float");return T!==null?T.HALF_FLOAT_OES:null}if(_===1021)return 6406;if(_===1022)return 6407;if(_===1023)return 6408;if(_===1024)return 6409;if(_===1025)return 6410;if(_===1026)return 6402;if(_===1027)return 34041;if(_===1028)return 6403;if(_===1029)return 36244;if(_===1030)return 33319;if(_===1031)return 33320;if(_===1032)return 36248;if(_===1033)return 36249;if(_===33776||_===33777||_===33778||_===33779)if(T=o.get("WEBGL_compressed_texture_s3tc"),T!==null){if(_===33776)return T.COMPRESSED_RGB_S3TC_DXT1_EXT;if(_===33777)return T.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(_===33778)return T.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(_===33779)return T.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(_===35840||_===35841||_===35842||_===35843)if(T=o.get("WEBGL_compressed_texture_pvrtc"),T!==null){if(_===35840)return T.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(_===35841)return T.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(_===35842)return T.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(_===35843)return T.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(_===36196)return T=o.get("WEBGL_compressed_texture_etc1"),T!==null?T.COMPRESSED_RGB_ETC1_WEBGL:null;if((_===37492||_===37496)&&(T=o.get("WEBGL_compressed_texture_etc"),T!==null)){if(_===37492)return T.COMPRESSED_RGB8_ETC2;if(_===37496)return T.COMPRESSED_RGBA8_ETC2_EAC}if(_===37808||_===37809||_===37810||_===37811||_===37812||_===37813||_===37814||_===37815||_===37816||_===37817||_===37818||_===37819||_===37820||_===37821||_===37840||_===37841||_===37842||_===37843||_===37844||_===37845||_===37846||_===37847||_===37848||_===37849||_===37850||_===37851||_===37852||_===37853)return T=o.get("WEBGL_compressed_texture_astc"),T!==null?_:null;if(_===36492)return T=o.get("EXT_texture_compression_bptc"),T!==null?_:null;if(_===1020)return m?34042:(T=o.get("WEBGL_depth_texture"),T!==null?T.UNSIGNED_INT_24_8_WEBGL:null)}}}function py(e){Ce.call(this),this.cameras=e||[]}function Hd(){F.call(this),this.type="Group"}function dy(){this._grip=this._targetRay=null}function Fw(e,o){function h(pe){var ke=rt.get(pe.inputSource);ke&&ke.dispatchEvent({type:pe.type})}function m(){rt.forEach(function(pe,ke){pe.disconnect(ke)}),rt.clear(),e.setFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),Ne.stop(),z.isPresenting=!1,z.dispatchEvent({type:"sessionend"})}function _(pe){q=pe,Ne.setContext(k),Ne.start(),z.isPresenting=!0,z.dispatchEvent({type:"sessionstart"})}function T(pe){for(var ke=k.inputSources,Fe=0;Fe<K.length;Fe++)rt.set(ke[Fe],K[Fe]);for(Fe=0;Fe<pe.removed.length;Fe++){ke=pe.removed[Fe];var Ar=rt.get(ke);Ar&&(Ar.dispatchEvent({type:"disconnected",data:ke}),rt.delete(ke))}for(Fe=0;Fe<pe.added.length;Fe++)ke=pe.added[Fe],(Ar=rt.get(ke))&&Ar.dispatchEvent({type:"connected",data:ke})}function R(pe,ke){ke===null?pe.matrixWorld.copy(pe.matrix):pe.matrixWorld.multiplyMatrices(ke.matrixWorld,pe.matrix),pe.matrixWorldInverse.getInverse(pe.matrixWorld)}var z=this,k=null,b=1,q=null,J="local-floor",Q=null,K=[],rt=new Pm,lt=new Ce;lt.layers.enable(1),lt.viewport=new p;var Bt=new Ce;Bt.layers.enable(2),Bt.viewport=new p;var Zt=[lt,Bt],bt=new py;bt.layers.enable(1),bt.layers.enable(2);var ae=null,Kt=null;this.isPresenting=this.enabled=!1,this.getController=function(pe){var ke=K[pe];return ke===void 0&&(ke=new dy,K[pe]=ke),ke.getTargetRaySpace()},this.getControllerGrip=function(pe){var ke=K[pe];return ke===void 0&&(ke=new dy,K[pe]=ke),ke.getGripSpace()},this.setFramebufferScaleFactor=function(pe){b=pe,z.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(pe){J=pe,z.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return q},this.getSession=function(){return k},this.setSession=function(pe){k=pe,k!==null&&(k.addEventListener("select",h),k.addEventListener("selectstart",h),k.addEventListener("selectend",h),k.addEventListener("squeeze",h),k.addEventListener("squeezestart",h),k.addEventListener("squeezeend",h),k.addEventListener("end",m),pe=o.getContextAttributes(),pe.xrCompatible!==!0&&o.makeXRCompatible(),pe=new XRWebGLLayer(k,o,{antialias:pe.antialias,alpha:pe.alpha,depth:pe.depth,stencil:pe.stencil,framebufferScaleFactor:b}),k.updateRenderState({baseLayer:pe}),k.requestReferenceSpace(J).then(_),k.addEventListener("inputsourceschange",T))};var fe=new w,Xt=new w;this.getCamera=function(pe){bt.near=Bt.near=lt.near=pe.near,bt.far=Bt.far=lt.far=pe.far,(ae!==bt.near||Kt!==bt.far)&&(k.updateRenderState({depthNear:bt.near,depthFar:bt.far}),ae=bt.near,Kt=bt.far);var ke=pe.parent,Fe=bt.cameras;R(bt,ke);for(var Ar=0;Ar<Fe.length;Ar++)R(Fe[Ar],ke);for(pe.matrixWorld.copy(bt.matrixWorld),pe=pe.children,Ar=0,ke=pe.length;Ar<ke;Ar++)pe[Ar].updateMatrixWorld(!0);if(Fe.length===2){fe.setFromMatrixPosition(lt.matrixWorld),Xt.setFromMatrixPosition(Bt.matrixWorld),Fe=fe.distanceTo(Xt);var kr=lt.projectionMatrix.elements,ir=Bt.projectionMatrix.elements,zr=kr[14]/(kr[10]-1);Ar=kr[14]/(kr[10]+1),pe=(kr[9]+1)/kr[5],ke=(kr[9]-1)/kr[5];var ui=(kr[8]-1)/kr[0],Kr=(ir[8]+1)/ir[0];ir=zr*ui,kr=zr*Kr,Kr=Fe/(-ui+Kr),ui=Kr*-ui,lt.matrixWorld.decompose(bt.position,bt.quaternion,bt.scale),bt.translateX(ui),bt.translateZ(Kr),bt.matrixWorld.compose(bt.position,bt.quaternion,bt.scale),bt.matrixWorldInverse.getInverse(bt.matrixWorld),zr+=Kr,Kr=Ar+Kr,bt.projectionMatrix.makePerspective(ir-ui,kr+(Fe-ui),pe*Ar/Kr*zr,ke*Ar/Kr*zr,zr,Kr)}else bt.projectionMatrix.copy(lt.projectionMatrix);return bt};var Me=null,Ne=new Wr;Ne.setAnimationLoop(function(pe,ke){if(Q=ke.getViewerPose(q),Q!==null){var Fe=Q.views,Ar=k.renderState.baseLayer;e.setFramebuffer(Ar.framebuffer);var kr=!1;Fe.length!==bt.cameras.length&&(bt.cameras.length=0,kr=!0);for(var ir=0;ir<Fe.length;ir++){var zr=Fe[ir],ui=Ar.getViewport(zr),Kr=Zt[ir];Kr.matrix.fromArray(zr.transform.matrix),Kr.projectionMatrix.fromArray(zr.projectionMatrix),Kr.viewport.set(ui.x,ui.y,ui.width,ui.height),ir===0&&bt.matrix.copy(Kr.matrix),kr===!0&&bt.cameras.push(Kr)}}for(Fe=k.inputSources,ir=0;ir<K.length;ir++)K[ir].update(Fe[ir],ke,q);Me&&Me(pe,ke)}),this.setAnimationLoop=function(pe){Me=pe},this.dispose=function(){}}function N3(e){function o(m,_,T){if(m.opacity.value=_.opacity,_.color&&m.diffuse.value.copy(_.color),_.emissive&&m.emissive.value.copy(_.emissive).multiplyScalar(_.emissiveIntensity),_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.specularMap&&(m.specularMap.value=_.specularMap),(T=_.envMap||T)&&(m.envMap.value=T,m.flipEnvMap.value=T.isCubeTexture?-1:1,m.reflectivity.value=_.reflectivity,m.refractionRatio.value=_.refractionRatio,m.maxMipLevel.value=e.get(T).__maxMipLevel),_.lightMap&&(m.lightMap.value=_.lightMap,m.lightMapIntensity.value=_.lightMapIntensity),_.aoMap&&(m.aoMap.value=_.aoMap,m.aoMapIntensity.value=_.aoMapIntensity),_.map)var R=_.map;else _.specularMap?R=_.specularMap:_.displacementMap?R=_.displacementMap:_.normalMap?R=_.normalMap:_.bumpMap?R=_.bumpMap:_.roughnessMap?R=_.roughnessMap:_.metalnessMap?R=_.metalnessMap:_.alphaMap?R=_.alphaMap:_.emissiveMap&&(R=_.emissiveMap);if(R!==void 0&&(R.isWebGLRenderTarget&&(R=R.texture),R.matrixAutoUpdate===!0&&R.updateMatrix(),m.uvTransform.value.copy(R.matrix)),_.aoMap)var z=_.aoMap;else _.lightMap&&(z=_.lightMap);z!==void 0&&(z.isWebGLRenderTarget&&(z=z.texture),z.matrixAutoUpdate===!0&&z.updateMatrix(),m.uv2Transform.value.copy(z.matrix))}function h(m,_,T){m.roughness.value=_.roughness,m.metalness.value=_.metalness,_.roughnessMap&&(m.roughnessMap.value=_.roughnessMap),_.metalnessMap&&(m.metalnessMap.value=_.metalnessMap),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias),(_.envMap||T)&&(m.envMapIntensity.value=_.envMapIntensity)}return{refreshFogUniforms:function(m,_){m.fogColor.value.copy(_.color),_.isFog?(m.fogNear.value=_.near,m.fogFar.value=_.far):_.isFogExp2&&(m.fogDensity.value=_.density)},refreshMaterialUniforms:function(m,_,T,R,z){if(_.isMeshBasicMaterial)o(m,_);else if(_.isMeshLambertMaterial)o(m,_),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap);else if(_.isMeshToonMaterial)o(m,_),m.specular.value.copy(_.specular),m.shininess.value=Math.max(_.shininess,1e-4),_.gradientMap&&(m.gradientMap.value=_.gradientMap),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshPhongMaterial)o(m,_),m.specular.value.copy(_.specular),m.shininess.value=Math.max(_.shininess,1e-4),_.emissiveMap&&(m.emissiveMap.value=_.emissiveMap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshStandardMaterial)o(m,_,T),_.isMeshPhysicalMaterial?(h(m,_,T),m.reflectivity.value=_.reflectivity,m.clearcoat.value=_.clearcoat,m.clearcoatRoughness.value=_.clearcoatRoughness,_.sheen&&m.sheen.value.copy(_.sheen),_.clearcoatMap&&(m.clearcoatMap.value=_.clearcoatMap),_.clearcoatRoughnessMap&&(m.clearcoatRoughnessMap.value=_.clearcoatRoughnessMap),_.clearcoatNormalMap&&(m.clearcoatNormalScale.value.copy(_.clearcoatNormalScale),m.clearcoatNormalMap.value=_.clearcoatNormalMap,_.side===1&&m.clearcoatNormalScale.value.negate()),m.transparency.value=_.transparency):h(m,_,T);else if(_.isMeshMatcapMaterial)o(m,_),_.matcap&&(m.matcap.value=_.matcap),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshDepthMaterial)o(m,_),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isMeshDistanceMaterial)o(m,_),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias),m.referencePosition.value.copy(_.referencePosition),m.nearDistance.value=_.nearDistance,m.farDistance.value=_.farDistance;else if(_.isMeshNormalMaterial)o(m,_),_.bumpMap&&(m.bumpMap.value=_.bumpMap,m.bumpScale.value=_.bumpScale,_.side===1&&(m.bumpScale.value*=-1)),_.normalMap&&(m.normalMap.value=_.normalMap,m.normalScale.value.copy(_.normalScale),_.side===1&&m.normalScale.value.negate()),_.displacementMap&&(m.displacementMap.value=_.displacementMap,m.displacementScale.value=_.displacementScale,m.displacementBias.value=_.displacementBias);else if(_.isLineBasicMaterial)m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,_.isLineDashedMaterial&&(m.dashSize.value=_.dashSize,m.totalSize.value=_.dashSize+_.gapSize,m.scale.value=_.scale);else if(_.isPointsMaterial){if(m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.size.value=_.size*R,m.scale.value=.5*z,_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.map)var k=_.map;else _.alphaMap&&(k=_.alphaMap);k!==void 0&&(k.matrixAutoUpdate===!0&&k.updateMatrix(),m.uvTransform.value.copy(k.matrix))}else if(_.isSpriteMaterial){if(m.diffuse.value.copy(_.color),m.opacity.value=_.opacity,m.rotation.value=_.rotation,_.map&&(m.map.value=_.map),_.alphaMap&&(m.alphaMap.value=_.alphaMap),_.map)var b=_.map;else _.alphaMap&&(b=_.alphaMap);b!==void 0&&(b.matrixAutoUpdate===!0&&b.updateMatrix(),m.uvTransform.value.copy(b.matrix))}else _.isShadowMaterial?(m.color.value.copy(_.color),m.opacity.value=_.opacity):_.isShaderMaterial&&(_.uniformsNeedUpdate=!1)}}}function h2(e){var o;function h(){ei=new el(De),gi=new eh(De,ei,e),gi.isWebGL2===!1&&(ei.get("WEBGL_depth_texture"),ei.get("OES_texture_float"),ei.get("OES_texture_half_float"),ei.get("OES_texture_half_float_linear"),ei.get("OES_standard_derivatives"),ei.get("OES_element_index_uint"),ei.get("ANGLE_instanced_arrays")),ei.get("OES_texture_float_linear"),vh=new Ow(De,ei,gi),Vr=new F3(De,ei,gi),Vr.scissor(wt.copy(vr).multiplyScalar(cr).floor()),Vr.viewport(en.copy(Ye).multiplyScalar(cr).floor()),ns=new iu(De),no=new T3,gu=new B3(De,ei,Vr,no,gi,vh,ns),Lg=new Ze(De,gi),w_=new rl(De,Lg,ns),Rg=new cy(De,w_,Lg,ns),$M=new hy(De),Pg=new C3(pe,ei,gi),M_=new N3(no),Lx=new E3,Dg=new O3,Tc=new Fo(pe,Vr,Rg,ae),tC=new Ta(De,ei,ns,gi),eC=new vs(De,ei,ns,gi),ns.programs=Pg.programs,pe.capabilities=gi,pe.extensions=ei,pe.properties=no,pe.renderLists=Lx,pe.state=Vr,pe.info=ns}function m(Ct){Ct.preventDefault(),ke=!0}function _(){ke=!1,h()}function T(Ct){Ct=Ct.target,Ct.removeEventListener("dispose",T),R(Ct),no.remove(Ct)}function R(Ct){var Te=no.get(Ct).program;Ct.program=void 0,Te!==void 0&&Pg.releaseProgram(Te)}function z(Ct,Te){Ct.render(function(te){pe.renderBufferImmediate(te,Te)})}function k(Ct,Te,te,Oe){if(Ct.visible!==!1){if(Ct.layers.test(Te.layers)){if(Ct.isGroup)te=Ct.renderOrder;else if(Ct.isLOD)Ct.autoUpdate===!0&&Ct.update(Te);else if(Ct.isLight)Ne.pushLight(Ct),Ct.castShadow&&Ne.pushShadow(Ct);else if(Ct.isSprite){if(!Ct.frustumCulled||wr.intersectsSprite(Ct)){Oe&&ri.setFromMatrixPosition(Ct.matrixWorld).applyMatrix4(Mn);var rr=Rg.update(Ct),mi=Ct.material;mi.visible&&Me.push(Ct,rr,mi,te,ri.z,null)}}else if(Ct.isImmediateRenderObject)Oe&&ri.setFromMatrixPosition(Ct.matrixWorld).applyMatrix4(Mn),Me.push(Ct,null,Ct.material,te,ri.z,null);else if((Ct.isMesh||Ct.isLine||Ct.isPoints)&&(Ct.isSkinnedMesh&&Ct.skeleton.frame!==ns.render.frame&&(Ct.skeleton.update(),Ct.skeleton.frame=ns.render.frame),!Ct.frustumCulled||wr.intersectsObject(Ct)))if(Oe&&ri.setFromMatrixPosition(Ct.matrixWorld).applyMatrix4(Mn),rr=Rg.update(Ct),mi=Ct.material,Array.isArray(mi))for(var mr=rr.groups,Xr=0,pi=mr.length;Xr<pi;Xr++){var Fi=mr[Xr],Ei=mi[Fi.materialIndex];Ei&&Ei.visible&&Me.push(Ct,rr,Ei,te,ri.z,Fi)}else mi.visible&&Me.push(Ct,rr,mi,te,ri.z,null)}for(Ct=Ct.children,Xr=0,pi=Ct.length;Xr<pi;Xr++)k(Ct[Xr],Te,te,Oe)}}function b(Ct,Te,te,Oe){for(var rr=0,mi=Ct.length;rr<mi;rr++){var mr=Ct[rr],Xr=mr.object,pi=mr.geometry,Fi=Oe===void 0?mr.material:Oe;if(mr=mr.group,te.isArrayCamera){Hi=te;for(var Ei=te.cameras,pl=0,Cn=Ei.length;pl<Cn;pl++){var oo=Ei[pl];Xr.layers.test(oo.layers)&&(Vr.viewport(en.copy(oo.viewport)),Ne.setupLights(oo),q(Xr,Te,oo,pi,Fi,mr))}}else Hi=null,q(Xr,Te,te,pi,Fi,mr)}}function q(Ct,Te,te,Oe,rr,mi){if(Ct.onBeforeRender(pe,Te,te,Oe,rr,mi),Ne=Dg.get(Te,Hi||te),Ct.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,Ct.matrixWorld),Ct.normalMatrix.getNormalMatrix(Ct.modelViewMatrix),Ct.isImmediateRenderObject){var mr=Q(te,Te,rr,Ct);Vr.setMaterial(rr),Kr=o=null,Mi=!1,z(Ct,mr)}else pe.renderBufferDirect(te,Te,Oe,rr,Ct,mi);Ct.onAfterRender(pe,Te,te,Oe,rr,mi),Ne=Dg.get(Te,Hi||te)}function J(Ct,Te,te){var Oe=no.get(Ct),rr=Ne.state.lights,mi=rr.state.version;te=Pg.getParameters(Ct,rr.state,Ne.state.shadowsArray,Te,ur.numPlanes,ur.numIntersection,te);var mr=Pg.getProgramCacheKey(te),Xr=Oe.program,pi=!0;if(Xr===void 0)Ct.addEventListener("dispose",T);else if(Xr.cacheKey!==mr)R(Ct);else{if(Oe.lightsStateVersion!==mi)Oe.lightsStateVersion=mi;else if(te.shaderID!==void 0)return;pi=!1}if(pi&&(Xr=Pg.acquireProgram(te,mr),Oe.program=Xr,Oe.uniforms=te.uniforms,Oe.outputEncoding=te.outputEncoding,Ct.program=Xr),te=Xr.getAttributes(),Ct.morphTargets)for(mr=Ct.numSupportedMorphTargets=0;mr<pe.maxMorphTargets;mr++)0<=te["morphTarget"+mr]&&Ct.numSupportedMorphTargets++;if(Ct.morphNormals)for(mr=Ct.numSupportedMorphNormals=0;mr<pe.maxMorphNormals;mr++)0<=te["morphNormal"+mr]&&Ct.numSupportedMorphNormals++;te=Oe.uniforms,(!Ct.isShaderMaterial&&!Ct.isRawShaderMaterial||Ct.clipping===!0)&&(Oe.numClippingPlanes=ur.numPlanes,Oe.numIntersection=ur.numIntersection,te.clippingPlanes=ur.uniform),Oe.environment=Ct.isMeshStandardMaterial?Te.environment:null,Oe.fog=Te.fog,Oe.needsLights=Ct.isMeshLambertMaterial||Ct.isMeshToonMaterial||Ct.isMeshPhongMaterial||Ct.isMeshStandardMaterial||Ct.isShadowMaterial||Ct.isShaderMaterial&&Ct.lights===!0,Oe.lightsStateVersion=mi,Oe.needsLights&&(te.ambientLightColor.value=rr.state.ambient,te.lightProbe.value=rr.state.probe,te.directionalLights.value=rr.state.directional,te.directionalLightShadows.value=rr.state.directionalShadow,te.spotLights.value=rr.state.spot,te.spotLightShadows.value=rr.state.spotShadow,te.rectAreaLights.value=rr.state.rectArea,te.pointLights.value=rr.state.point,te.pointLightShadows.value=rr.state.pointShadow,te.hemisphereLights.value=rr.state.hemi,te.directionalShadowMap.value=rr.state.directionalShadowMap,te.directionalShadowMatrix.value=rr.state.directionalShadowMatrix,te.spotShadowMap.value=rr.state.spotShadowMap,te.spotShadowMatrix.value=rr.state.spotShadowMatrix,te.pointShadowMap.value=rr.state.pointShadowMap,te.pointShadowMatrix.value=rr.state.pointShadowMatrix),Ct=Oe.program.getUniforms(),Ct=lc.seqWithValue(Ct.seq,te),Oe.uniformsList=Ct}function Q(Ct,Te,te,Oe){gu.resetTextureUnits();var rr=Te.fog,mi=te.isMeshStandardMaterial?Te.environment:null,mr=ir===null?pe.outputEncoding:ir.texture.encoding,Xr=no.get(te),pi=Ne.state.lights;lr&&(ti||Ct!==fi)&&ur.setState(te.clippingPlanes,te.clipIntersection,te.clipShadows,Ct,Xr,Ct===fi&&te.id===ui),te.version===Xr.__version?Xr.program===void 0||te.fog&&Xr.fog!==rr||Xr.environment!==mi||Xr.needsLights&&Xr.lightsStateVersion!==pi.state.version?J(te,Te,Oe):Xr.numClippingPlanes===void 0||Xr.numClippingPlanes===ur.numPlanes&&Xr.numIntersection===ur.numIntersection?Xr.outputEncoding!==mr&&J(te,Te,Oe):J(te,Te,Oe):(J(te,Te,Oe),Xr.__version=te.version);var Fi=!1,Ei=!1,pl=!1;if(Te=Xr.program,mr=Te.getUniforms(),pi=Xr.uniforms,Vr.useProgram(Te.program)&&(pl=Ei=Fi=!0),te.id!==ui&&(ui=te.id,Ei=!0),(Fi||fi!==Ct)&&(mr.setValue(De,"projectionMatrix",Ct.projectionMatrix),gi.logarithmicDepthBuffer&&mr.setValue(De,"logDepthBufFC",2/(Math.log(Ct.far+1)/Math.LN2)),fi!==Ct&&(fi=Ct,pl=Ei=!0),(te.isShaderMaterial||te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshStandardMaterial||te.envMap)&&(Fi=mr.map.cameraPosition,Fi!==void 0&&Fi.setValue(De,ri.setFromMatrixPosition(Ct.matrixWorld))),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial)&&mr.setValue(De,"isOrthographic",Ct.isOrthographicCamera===!0),(te.isMeshPhongMaterial||te.isMeshToonMaterial||te.isMeshLambertMaterial||te.isMeshBasicMaterial||te.isMeshStandardMaterial||te.isShaderMaterial||te.skinning)&&mr.setValue(De,"viewMatrix",Ct.matrixWorldInverse)),te.skinning&&(mr.setOptional(De,Oe,"bindMatrix"),mr.setOptional(De,Oe,"bindMatrixInverse"),Ct=Oe.skeleton))if(Fi=Ct.bones,gi.floatVertexTextures){if(Ct.boneTexture===void 0){Fi=Math.sqrt(4*Fi.length),Fi=di.ceilPowerOfTwo(Fi),Fi=Math.max(Fi,4);var Cn=new Float32Array(Fi*Fi*4);Cn.set(Ct.boneMatrices);var oo=new Ae(Cn,Fi,Fi,1023,1015);Ct.boneMatrices=Cn,Ct.boneTexture=oo,Ct.boneTextureSize=Fi}mr.setValue(De,"boneTexture",Ct.boneTexture,gu),mr.setValue(De,"boneTextureSize",Ct.boneTextureSize)}else mr.setOptional(De,Ct,"boneMatrices");return(Ei||Xr.receiveShadow!==Oe.receiveShadow)&&(Xr.receiveShadow=Oe.receiveShadow,mr.setValue(De,"receiveShadow",Oe.receiveShadow)),Ei&&(mr.setValue(De,"toneMappingExposure",pe.toneMappingExposure),mr.setValue(De,"toneMappingWhitePoint",pe.toneMappingWhitePoint),Xr.needsLights&&(Ei=pl,pi.ambientLightColor.needsUpdate=Ei,pi.lightProbe.needsUpdate=Ei,pi.directionalLights.needsUpdate=Ei,pi.directionalLightShadows.needsUpdate=Ei,pi.pointLights.needsUpdate=Ei,pi.pointLightShadows.needsUpdate=Ei,pi.spotLights.needsUpdate=Ei,pi.spotLightShadows.needsUpdate=Ei,pi.rectAreaLights.needsUpdate=Ei,pi.hemisphereLights.needsUpdate=Ei),rr&&te.fog&&M_.refreshFogUniforms(pi,rr),M_.refreshMaterialUniforms(pi,te,mi,cr,Ve),pi.ltc_1!==void 0&&(pi.ltc_1.value=dr.LTC_1),pi.ltc_2!==void 0&&(pi.ltc_2.value=dr.LTC_2),lc.upload(De,Xr.uniformsList,pi,gu)),te.isShaderMaterial&&te.uniformsNeedUpdate===!0&&(lc.upload(De,Xr.uniformsList,pi,gu),te.uniformsNeedUpdate=!1),te.isSpriteMaterial&&mr.setValue(De,"center",Oe.center),mr.setValue(De,"modelViewMatrix",Oe.modelViewMatrix),mr.setValue(De,"normalMatrix",Oe.normalMatrix),mr.setValue(De,"modelMatrix",Oe.matrixWorld),Te}e=e||{};var K=e.canvas!==void 0?e.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),rt=e.context!==void 0?e.context:null,lt=e.alpha!==void 0?e.alpha:!1,Bt=e.depth!==void 0?e.depth:!0,Zt=e.stencil!==void 0?e.stencil:!0,bt=e.antialias!==void 0?e.antialias:!1,ae=e.premultipliedAlpha!==void 0?e.premultipliedAlpha:!0,Kt=e.preserveDrawingBuffer!==void 0?e.preserveDrawingBuffer:!1,fe=e.powerPreference!==void 0?e.powerPreference:"default",Xt=e.failIfMajorPerformanceCaveat!==void 0?e.failIfMajorPerformanceCaveat:!1,Me=null,Ne=null;this.domElement=K,this.debug={checkShaderErrors:!0},this.sortObjects=this.autoClearStencil=this.autoClearDepth=this.autoClearColor=this.autoClear=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=3e3,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingWhitePoint=this.toneMappingExposure=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var pe=this,ke=!1,Fe=null,Ar=0,kr=0,ir=null,zr=null,ui=-1,Kr=o=null,Mi=!1,fi=null,Hi=null,en=new p,wt=new p,Nt=null,ye=K.width,Ve=K.height,cr=1,Le=null,Ht=null,Ye=new p(0,0,ye,Ve),vr=new p(0,0,ye,Ve),br=!1,wr=new ar,ur=new Ns,lr=!1,ti=!1,Mn=new I,ri=new w;try{lt={alpha:lt,depth:Bt,stencil:Zt,antialias:bt,premultipliedAlpha:ae,preserveDrawingBuffer:Kt,powerPreference:fe,failIfMajorPerformanceCaveat:Xt},K.addEventListener("webglcontextlost",m,!1),K.addEventListener("webglcontextrestored",_,!1);var De=rt||K.getContext("webgl",lt)||K.getContext("experimental-webgl",lt);if(De===null)throw K.getContext("webgl")!==null?Error("Error creating WebGL context with your selected attributes."):Error("Error creating WebGL context.");De.getShaderPrecisionFormat===void 0&&(De.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(Ct){throw console.error("THREE.WebGLRenderer: "+Ct.message),Ct}var ei,gi,Vr,ns,no,gu,Lg,w_,Rg,Pg,M_,Lx,Dg,Tc,$M,tC,eC,vh;h();var Sc=new Fw(pe,De);this.xr=Sc;var rC=new Dw(pe,Rg,gi.maxTextureSize);this.shadowMap=rC,this.getContext=function(){return De},this.getContextAttributes=function(){return De.getContextAttributes()},this.forceContextLoss=function(){var Ct=ei.get("WEBGL_lose_context");Ct&&Ct.loseContext()},this.forceContextRestore=function(){var Ct=ei.get("WEBGL_lose_context");Ct&&Ct.restoreContext()},this.getPixelRatio=function(){return cr},this.setPixelRatio=function(Ct){Ct!==void 0&&(cr=Ct,this.setSize(ye,Ve,!1))},this.getSize=function(Ct){return Ct===void 0&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),Ct=new f),Ct.set(ye,Ve)},this.setSize=function(Ct,Te,te){Sc.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ye=Ct,Ve=Te,K.width=Math.floor(Ct*cr),K.height=Math.floor(Te*cr),te!==!1&&(K.style.width=Ct+"px",K.style.height=Te+"px"),this.setViewport(0,0,Ct,Te))},this.getDrawingBufferSize=function(Ct){return Ct===void 0&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),Ct=new f),Ct.set(ye*cr,Ve*cr).floor()},this.setDrawingBufferSize=function(Ct,Te,te){ye=Ct,Ve=Te,cr=te,K.width=Math.floor(Ct*te),K.height=Math.floor(Te*te),this.setViewport(0,0,Ct,Te)},this.getCurrentViewport=function(Ct){return Ct===void 0&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),Ct=new p),Ct.copy(en)},this.getViewport=function(Ct){return Ct.copy(Ye)},this.setViewport=function(Ct,Te,te,Oe){Ct.isVector4?Ye.set(Ct.x,Ct.y,Ct.z,Ct.w):Ye.set(Ct,Te,te,Oe),Vr.viewport(en.copy(Ye).multiplyScalar(cr).floor())},this.getScissor=function(Ct){return Ct.copy(vr)},this.setScissor=function(Ct,Te,te,Oe){Ct.isVector4?vr.set(Ct.x,Ct.y,Ct.z,Ct.w):vr.set(Ct,Te,te,Oe),Vr.scissor(wt.copy(vr).multiplyScalar(cr).floor())},this.getScissorTest=function(){return br},this.setScissorTest=function(Ct){Vr.setScissorTest(br=Ct)},this.setOpaqueSort=function(Ct){Le=Ct},this.setTransparentSort=function(Ct){Ht=Ct},this.getClearColor=function(){return Tc.getClearColor()},this.setClearColor=function(){Tc.setClearColor.apply(Tc,arguments)},this.getClearAlpha=function(){return Tc.getClearAlpha()},this.setClearAlpha=function(){Tc.setClearAlpha.apply(Tc,arguments)},this.clear=function(Ct,Te,te){var Oe=0;(Ct===void 0||Ct)&&(Oe|=16384),(Te===void 0||Te)&&(Oe|=256),(te===void 0||te)&&(Oe|=1024),De.clear(Oe)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){K.removeEventListener("webglcontextlost",m,!1),K.removeEventListener("webglcontextrestored",_,!1),Lx.dispose(),Dg.dispose(),no.dispose(),Rg.dispose(),Sc.dispose(),Rx.stop()},this.renderBufferImmediate=function(Ct,Te){Vr.initAttributes();var te=no.get(Ct);Ct.hasPositions&&!te.position&&(te.position=De.createBuffer()),Ct.hasNormals&&!te.normal&&(te.normal=De.createBuffer()),Ct.hasUvs&&!te.uv&&(te.uv=De.createBuffer()),Ct.hasColors&&!te.color&&(te.color=De.createBuffer()),Te=Te.getAttributes(),Ct.hasPositions&&(De.bindBuffer(34962,te.position),De.bufferData(34962,Ct.positionArray,35048),Vr.enableAttribute(Te.position),De.vertexAttribPointer(Te.position,3,5126,!1,0,0)),Ct.hasNormals&&(De.bindBuffer(34962,te.normal),De.bufferData(34962,Ct.normalArray,35048),Vr.enableAttribute(Te.normal),De.vertexAttribPointer(Te.normal,3,5126,!1,0,0)),Ct.hasUvs&&(De.bindBuffer(34962,te.uv),De.bufferData(34962,Ct.uvArray,35048),Vr.enableAttribute(Te.uv),De.vertexAttribPointer(Te.uv,2,5126,!1,0,0)),Ct.hasColors&&(De.bindBuffer(34962,te.color),De.bufferData(34962,Ct.colorArray,35048),Vr.enableAttribute(Te.color),De.vertexAttribPointer(Te.color,3,5126,!1,0,0)),Vr.disableUnusedAttributes(),De.drawArrays(4,0,Ct.count),Ct.count=0};var MT=new W;this.renderBufferDirect=function(Ct,Te,te,Oe,rr,mi){Te===null&&(Te=MT);var mr=rr.isMesh&&0>rr.matrixWorld.determinant(),Xr=Q(Ct,Te,Oe,rr);Vr.setMaterial(Oe,mr);var pi=!1;if((o!==te.id||Kr!==Xr.id||Mi!==(Oe.wireframe===!0))&&(o=te.id,Kr=Xr.id,Mi=Oe.wireframe===!0,pi=!0),(Oe.morphTargets||Oe.morphNormals)&&($M.update(rr,te,Oe,Xr),pi=!0),rr.isInstancedMesh===!0&&(pi=!0),Ct=te.index,Te=te.attributes.position,Ct===null){if(Te===void 0||Te.count===0)return}else if(Ct.count===0)return;var Fi=1;if(Oe.wireframe===!0&&(Ct=w_.getWireframeAttribute(te),Fi=2),mr=tC,Ct!==null){var Ei=Lg.get(Ct);mr=eC,mr.setIndex(Ei)}if(pi){if(gi.isWebGL2!==!1||!rr.isInstancedMesh&&!te.isInstancedBufferGeometry||ei.get("ANGLE_instanced_arrays")!==null){Vr.initAttributes(),pi=te.attributes,Xr=Xr.getAttributes();var pl=Oe.defaultAttributeValues;for(fp in Xr){var Cn=Xr[fp];if(0<=Cn){var oo=pi[fp];if(oo!==void 0){var yh=oo.normalized,iC=oo.itemSize,mu=Lg.get(oo);if(mu!==void 0){var Px=mu.buffer,cp=mu.type;if(mu=mu.bytesPerElement,oo.isInterleavedBufferAttribute){var Og=oo.data,CT=Og.stride;oo=oo.offset,Og&&Og.isInstancedInterleavedBuffer?(Vr.enableAttributeAndDivisor(Cn,Og.meshPerAttribute),te._maxInstanceCount===void 0&&(te._maxInstanceCount=Og.meshPerAttribute*Og.count)):Vr.enableAttribute(Cn),De.bindBuffer(34962,Px),Vr.vertexAttribPointer(Cn,iC,cp,yh,CT*mu,oo*mu)}else oo.isInstancedBufferAttribute?(Vr.enableAttributeAndDivisor(Cn,oo.meshPerAttribute),te._maxInstanceCount===void 0&&(te._maxInstanceCount=oo.meshPerAttribute*oo.count)):Vr.enableAttribute(Cn),De.bindBuffer(34962,Px),Vr.vertexAttribPointer(Cn,iC,cp,yh,0,0)}}else if(fp==="instanceMatrix")mu=Lg.get(rr.instanceMatrix),mu!==void 0&&(Px=mu.buffer,cp=mu.type,Vr.enableAttributeAndDivisor(Cn+0,1),Vr.enableAttributeAndDivisor(Cn+1,1),Vr.enableAttributeAndDivisor(Cn+2,1),Vr.enableAttributeAndDivisor(Cn+3,1),De.bindBuffer(34962,Px),De.vertexAttribPointer(Cn+0,4,cp,!1,64,0),De.vertexAttribPointer(Cn+1,4,cp,!1,64,16),De.vertexAttribPointer(Cn+2,4,cp,!1,64,32),De.vertexAttribPointer(Cn+3,4,cp,!1,64,48));else if(pl!==void 0&&(yh=pl[fp],yh!==void 0))switch(yh.length){case 2:De.vertexAttrib2fv(Cn,yh);break;case 3:De.vertexAttrib3fv(Cn,yh);break;case 4:De.vertexAttrib4fv(Cn,yh);break;default:De.vertexAttrib1fv(Cn,yh)}}}Vr.disableUnusedAttributes()}Ct!==null&&De.bindBuffer(34963,Ei.buffer)}var fp=te.drawRange.start*Fi;pi=mi!==null?mi.start*Fi:0,Ei=Math.max(fp,pi),mi=Math.max(0,Math.min(Ct!==null?Ct.count:Te.count,fp+te.drawRange.count*Fi,pi+(mi!==null?mi.count*Fi:1/0))-1-Ei+1),mi!==0&&(rr.isMesh?Oe.wireframe===!0?(Vr.setLineWidth(Oe.wireframeLinewidth*(ir===null?cr:1)),mr.setMode(1)):mr.setMode(4):rr.isLine?(Oe=Oe.linewidth,Oe===void 0&&(Oe=1),Vr.setLineWidth(Oe*(ir===null?cr:1)),rr.isLineSegments?mr.setMode(1):rr.isLineLoop?mr.setMode(2):mr.setMode(3)):rr.isPoints?mr.setMode(0):rr.isSprite&&mr.setMode(4),rr.isInstancedMesh?mr.renderInstances(te,Ei,mi,rr.count):te.isInstancedBufferGeometry?mr.renderInstances(te,Ei,mi,Math.min(te.instanceCount,te._maxInstanceCount)):mr.render(Ei,mi))},this.compile=function(Ct,Te){Ne=Dg.get(Ct,Te),Ne.init(),Ct.traverse(function(Oe){Oe.isLight&&(Ne.pushLight(Oe),Oe.castShadow&&Ne.pushShadow(Oe))}),Ne.setupLights(Te);var te={};Ct.traverse(function(Oe){var rr=Oe.material;if(rr)if(Array.isArray(rr))for(var mi=0;mi<rr.length;mi++){var mr=rr[mi];!(mr.uuid in te)&&(J(mr,Ct,Oe),te[mr.uuid]=!0)}else!(rr.uuid in te)&&(J(rr,Ct,Oe),te[rr.uuid]=!0)})};var C_=null,Rx=new Wr;Rx.setAnimationLoop(function(Ct){Sc.isPresenting||C_&&C_(Ct)}),typeof window!="undefined"&&Rx.setContext(window),this.setAnimationLoop=function(Ct){C_=Ct,Sc.setAnimationLoop(Ct),Rx.start()},this.render=function(Ct,Te,te,Oe){if(te!==void 0){console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead.");var rr=te}if(Oe!==void 0){console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead.");var mi=Oe}Te&&Te.isCamera?ke||(Kr=o=null,Mi=!1,ui=-1,fi=null,Ct.autoUpdate===!0&&Ct.updateMatrixWorld(),Te.parent===null&&Te.updateMatrixWorld(),Sc.enabled&&Sc.isPresenting&&(Te=Sc.getCamera(Te)),Ct.onBeforeRender(pe,Ct,Te,rr||ir),Ne=Dg.get(Ct,Te),Ne.init(),Mn.multiplyMatrices(Te.projectionMatrix,Te.matrixWorldInverse),wr.setFromProjectionMatrix(Mn),ti=this.localClippingEnabled,lr=ur.init(this.clippingPlanes,ti,Te),Me=Lx.get(Ct,Te),Me.init(),k(Ct,Te,0,pe.sortObjects),Me.finish(),pe.sortObjects===!0&&Me.sort(Le,Ht),lr&&ur.beginShadows(),rC.render(Ne.state.shadowsArray,Ct,Te),Ne.setupLights(Te),lr&&ur.endShadows(),this.info.autoReset&&this.info.reset(),rr!==void 0&&this.setRenderTarget(rr),Tc.render(Me,Ct,Te,mi),te=Me.opaque,Oe=Me.transparent,Ct.overrideMaterial?(rr=Ct.overrideMaterial,te.length&&b(te,Ct,Te,rr),Oe.length&&b(Oe,Ct,Te,rr)):(te.length&&b(te,Ct,Te),Oe.length&&b(Oe,Ct,Te)),Ct.onAfterRender(pe,Ct,Te),ir!==null&&(gu.updateRenderTargetMipmap(ir),gu.updateMultisampleRenderTarget(ir)),Vr.buffers.depth.setTest(!0),Vr.buffers.depth.setMask(!0),Vr.buffers.color.setMask(!0),Vr.setPolygonOffset(!1),Ne=Me=null):console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.setFramebuffer=function(Ct){Fe!==Ct&&ir===null&&De.bindFramebuffer(36160,Ct),Fe=Ct},this.getActiveCubeFace=function(){return Ar},this.getActiveMipmapLevel=function(){return kr},this.getRenderTarget=function(){return ir},this.setRenderTarget=function(Ct,Te,te){ir=Ct,Ar=Te,kr=te,Ct&&no.get(Ct).__webglFramebuffer===void 0&&gu.setupRenderTarget(Ct);var Oe=Fe,rr=!1;Ct?(Oe=no.get(Ct).__webglFramebuffer,Ct.isWebGLCubeRenderTarget?(Oe=Oe[Te||0],rr=!0):Oe=Ct.isWebGLMultisampleRenderTarget?no.get(Ct).__webglMultisampledFramebuffer:Oe,en.copy(Ct.viewport),wt.copy(Ct.scissor),Nt=Ct.scissorTest):(en.copy(Ye).multiplyScalar(cr).floor(),wt.copy(vr).multiplyScalar(cr).floor(),Nt=br),zr!==Oe&&(De.bindFramebuffer(36160,Oe),zr=Oe),Vr.viewport(en),Vr.scissor(wt),Vr.setScissorTest(Nt),rr&&(Ct=no.get(Ct.texture),De.framebufferTexture2D(36160,36064,34069+(Te||0),Ct.__webglTexture,te||0))},this.readRenderTargetPixels=function(Ct,Te,te,Oe,rr,mi,mr){if(Ct&&Ct.isWebGLRenderTarget){var Xr=no.get(Ct).__webglFramebuffer;if(Ct.isWebGLCubeRenderTarget&&mr!==void 0&&(Xr=Xr[mr]),Xr){mr=!1,Xr!==zr&&(De.bindFramebuffer(36160,Xr),mr=!0);try{var pi=Ct.texture,Fi=pi.format,Ei=pi.type;Fi!==1023&&vh.convert(Fi)!==De.getParameter(35739)?console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format."):Ei===1009||vh.convert(Ei)===De.getParameter(35738)||Ei===1015&&(gi.isWebGL2||ei.get("OES_texture_float")||ei.get("WEBGL_color_buffer_float"))||Ei===1016&&(gi.isWebGL2?ei.get("EXT_color_buffer_float"):ei.get("EXT_color_buffer_half_float"))?De.checkFramebufferStatus(36160)===36053?0<=Te&&Te<=Ct.width-Oe&&0<=te&&te<=Ct.height-rr&&De.readPixels(Te,te,Oe,rr,vh.convert(Fi),vh.convert(Ei),mi):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete."):console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.")}finally{mr&&De.bindFramebuffer(36160,zr)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(Ct,Te,te){te===void 0&&(te=0);var Oe=Math.pow(2,-te),rr=Math.floor(Te.image.width*Oe);Oe=Math.floor(Te.image.height*Oe);var mi=vh.convert(Te.format);gu.setTexture2D(Te,0),De.copyTexImage2D(3553,te,mi,Ct.x,Ct.y,rr,Oe,0),Vr.unbindTexture()},this.copyTextureToTexture=function(Ct,Te,te,Oe){Oe===void 0&&(Oe=0);var rr=Te.image.width,mi=Te.image.height,mr=vh.convert(te.format),Xr=vh.convert(te.type);gu.setTexture2D(te,0),Te.isDataTexture?De.texSubImage2D(3553,Oe,Ct.x,Ct.y,rr,mi,mr,Xr,Te.image.data):Te.isCompressedTexture?De.compressedTexSubImage2D(3553,Oe,Ct.x,Ct.y,Te.mipmaps[0].width,Te.mipmaps[0].height,mr,Te.mipmaps[0].data):De.texSubImage2D(3553,Oe,Ct.x,Ct.y,mr,Xr,Te.image),Oe===0&&te.generateMipmaps&&De.generateMipmap(3553),Vr.unbindTexture()},this.initTexture=function(Ct){gu.setTexture2D(Ct,0),Vr.unbindTexture()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}function gy(e,o){this.name="",this.color=new yt(e),this.density=o!==void 0?o:25e-5}function my(e,o,h){this.name="",this.color=new yt(e),this.near=o!==void 0?o:1,this.far=h!==void 0?h:1e3}function oh(e,o){this.array=e,this.stride=o,this.count=e!==void 0?e.length/o:0,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0}function nv(e,o,h,m){this.name="",this.data=e,this.itemSize=o,this.offset=h,this.normalized=m===!0}function fc(e){re.call(this),this.type="SpriteMaterial",this.color=new yt(16777215),this.alphaMap=this.map=null,this.rotation=0,this.transparent=this.sizeAttenuation=!0,this.setValues(e)}function ov(e){if(F.call(this),this.type="Sprite",Cg===void 0){Cg=new ct;var o=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]);o=new oh(o,5),Cg.setIndex([0,1,2,0,2,3]),Cg.setAttribute("position",new nv(o,3,0,!1)),Cg.setAttribute("uv",new nv(o,2,3,!1))}this.geometry=Cg,this.material=e!==void 0?e:new fc,this.center=new f(.5,.5)}function vy(e,o,h,m,_,T){Ig.subVectors(e,h).addScalar(.5).multiply(m),_!==void 0?(Xv.x=T*Ig.x-_*Ig.y,Xv.y=_*Ig.x+T*Ig.y):Xv.copy(Ig),e.copy(o),e.x+=Xv.x,e.y+=Xv.y,e.applyMatrix4(MM)}function sv(){F.call(this),this._currentLevel=0,this.type="LOD",Gr(this,{levels:{enumerable:!0,value:[]}}),this.autoUpdate=!0}function yy(e,o){e&&e.isGeometry&&console.error("THREE.SkinnedMesh no longer supports THREE.Geometry. Use THREE.BufferGeometry instead."),St.call(this,e,o),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new I,this.bindMatrixInverse=new I}function xy(e,o){if(e=e||[],this.bones=e.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),this.frame=-1,o===void 0)this.calculateInverses();else if(this.bones.length===o.length)this.boneInverses=o.slice(0);else for(console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[],e=0,o=this.bones.length;e<o;e++)this.boneInverses.push(new I)}function c2(){F.call(this),this.type="Bone"}function Ay(e,o,h){St.call(this,e,o),this.instanceMatrix=new ce(new Float32Array(16*h),16),this.count=h,this.frustumCulled=!1}function In(e){re.call(this),this.type="LineBasicMaterial",this.color=new yt(16777215),this.linewidth=1,this.linejoin=this.linecap="round",this.morphTargets=!1,this.setValues(e)}function ea(e,o,h){h===1&&console.error("THREE.Line: parameter THREE.LinePieces no longer supported. Use THREE.LineSegments instead."),F.call(this),this.type="Line",this.geometry=e!==void 0?e:new ct,this.material=o!==void 0?o:new In,this.updateMorphTargets()}function On(e,o){ea.call(this,e,o),this.type="LineSegments"}function _y(e,o){ea.call(this,e,o),this.type="LineLoop"}function ou(e){re.call(this),this.type="PointsMaterial",this.color=new yt(16777215),this.alphaMap=this.map=null,this.size=1,this.sizeAttenuation=!0,this.morphTargets=!1,this.setValues(e)}function kd(e,o){F.call(this),this.type="Points",this.geometry=e!==void 0?e:new ct,this.material=o!==void 0?o:new ou,this.updateMorphTargets()}function f2(e,o,h,m,_,T,R){var z=l_.distanceSqToPoint(e);z<h&&(h=new w,l_.closestPointToPoint(e,h),h.applyMatrix4(m),e=_.ray.origin.distanceTo(h),e<_.near||e>_.far||T.push({distance:e,distanceToRay:Math.sqrt(z),point:h,index:o,face:null,object:R}))}function p2(e,o,h,m,_,T,R,z,k){g.call(this,e,o,h,m,_,T,R,z,k),this.format=R!==void 0?R:1022,this.minFilter=T!==void 0?T:1006,this.magFilter=_!==void 0?_:1006,this.generateMipmaps=!1}function Gd(e,o,h,m,_,T,R,z,k,b,q,J){g.call(this,null,T,R,z,k,b,m,_,q,J),this.image={width:o,height:h},this.mipmaps=e,this.generateMipmaps=this.flipY=!1}function av(e,o,h,m,_,T,R,z,k){g.call(this,e,o,h,m,_,T,R,z,k),this.needsUpdate=!0}function uv(e,o,h,m,_,T,R,z,k,b){if(b=b!==void 0?b:1026,b!==1026&&b!==1027)throw Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");h===void 0&&b===1026&&(h=1012),h===void 0&&b===1027&&(h=1020),g.call(this,null,m,_,T,R,z,b,h,k),this.image={width:e,height:o},this.magFilter=R!==void 0?R:1003,this.minFilter=z!==void 0?z:1003,this.generateMipmaps=this.flipY=!1}function bd(e){ct.call(this),this.type="WireframeGeometry";var o=[],h,m,_,T=[0,0],R={},z=["a","b","c"];if(e&&e.isGeometry){var k=e.faces,b=0;for(m=k.length;b<m;b++){var q=k[b];for(h=0;3>h;h++){var J=q[z[h]],Q=q[z[(h+1)%3]];T[0]=Math.min(J,Q),T[1]=Math.max(J,Q),J=T[0]+","+T[1],R[J]===void 0&&(R[J]={index1:T[0],index2:T[1]})}}for(J in R)b=R[J],z=e.vertices[b.index1],o.push(z.x,z.y,z.z),z=e.vertices[b.index2],o.push(z.x,z.y,z.z)}else if(e&&e.isBufferGeometry)if(z=new w,e.index!==null){k=e.attributes.position,q=e.index;var K=e.groups;for(K.length===0&&(K=[{start:0,count:q.count,materialIndex:0}]),e=0,_=K.length;e<_;++e)for(b=K[e],h=b.start,m=b.count,b=h,m=h+m;b<m;b+=3)for(h=0;3>h;h++)J=q.getX(b+h),Q=q.getX(b+(h+1)%3),T[0]=Math.min(J,Q),T[1]=Math.max(J,Q),J=T[0]+","+T[1],R[J]===void 0&&(R[J]={index1:T[0],index2:T[1]});for(J in R)b=R[J],z.fromBufferAttribute(k,b.index1),o.push(z.x,z.y,z.z),z.fromBufferAttribute(k,b.index2),o.push(z.x,z.y,z.z)}else for(k=e.attributes.position,b=0,m=k.count/3;b<m;b++)for(h=0;3>h;h++)R=3*b+h,z.fromBufferAttribute(k,R),o.push(z.x,z.y,z.z),R=3*b+(h+1)%3,z.fromBufferAttribute(k,R),o.push(z.x,z.y,z.z);this.setAttribute("position",new mt(o,3))}function lv(e,o,h){ft.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:o,stacks:h},this.fromBufferGeometry(new Vd(e,o,h)),this.mergeVertices()}function Vd(e,o,h){ct.call(this),this.type="ParametricBufferGeometry",this.parameters={func:e,slices:o,stacks:h};var m=[],_=[],T=[],R=[],z=new w,k=new w,b=new w,q=new w,J=new w,Q,K;3>e.length&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");var rt=o+1;for(Q=0;Q<=h;Q++){var lt=Q/h;for(K=0;K<=o;K++){var Bt=K/o;e(Bt,lt,k),_.push(k.x,k.y,k.z),0<=Bt-1e-5?(e(Bt-1e-5,lt,b),q.subVectors(k,b)):(e(Bt+1e-5,lt,b),q.subVectors(b,k)),0<=lt-1e-5?(e(Bt,lt-1e-5,b),J.subVectors(k,b)):(e(Bt,lt+1e-5,b),J.subVectors(b,k)),z.crossVectors(q,J).normalize(),T.push(z.x,z.y,z.z),R.push(Bt,lt)}}for(Q=0;Q<h;Q++)for(K=0;K<o;K++)e=Q*rt+K+1,z=(Q+1)*rt+K+1,k=(Q+1)*rt+K,m.push(Q*rt+K,e,k),m.push(e,z,k);this.setIndex(m),this.setAttribute("position",new mt(_,3)),this.setAttribute("normal",new mt(T,3)),this.setAttribute("uv",new mt(R,2))}function hv(e,o,h,m){ft.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:e,indices:o,radius:h,detail:m},this.fromBufferGeometry(new Us(e,o,h,m)),this.mergeVertices()}function Us(e,o,h,m){function _(b){z.push(b.x,b.y,b.z)}function T(b,q){b*=3,q.x=e[b+0],q.y=e[b+1],q.z=e[b+2]}function R(b,q,J,Q){0>Q&&b.x===1&&(k[q]=b.x-1),J.x===0&&J.z===0&&(k[q]=Q/2/Math.PI+.5)}ct.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:e,indices:o,radius:h,detail:m},h=h||1,m=m||0;var z=[],k=[];(function(b){for(var q=new w,J=new w,Q=new w,K=0;K<o.length;K+=3){T(o[K+0],q),T(o[K+1],J),T(o[K+2],Q);var rt,lt,Bt=q,Zt=J,bt=Q,ae=Math.pow(2,b),Kt=[];for(lt=0;lt<=ae;lt++){Kt[lt]=[];var fe=Bt.clone().lerp(bt,lt/ae),Xt=Zt.clone().lerp(bt,lt/ae),Me=ae-lt;for(rt=0;rt<=Me;rt++)Kt[lt][rt]=rt===0&&lt===ae?fe:fe.clone().lerp(Xt,rt/Me)}for(lt=0;lt<ae;lt++)for(rt=0;rt<2*(ae-lt)-1;rt++)Bt=Math.floor(rt/2),rt%2===0?(_(Kt[lt][Bt+1]),_(Kt[lt+1][Bt]),_(Kt[lt][Bt])):(_(Kt[lt][Bt+1]),_(Kt[lt+1][Bt+1]),_(Kt[lt+1][Bt]))}})(m),function(b){for(var q=new w,J=0;J<z.length;J+=3)q.x=z[J+0],q.y=z[J+1],q.z=z[J+2],q.normalize().multiplyScalar(b),z[J+0]=q.x,z[J+1]=q.y,z[J+2]=q.z}(h),function(){for(var b=new w,q=0;q<z.length;q+=3)b.x=z[q+0],b.y=z[q+1],b.z=z[q+2],k.push(Math.atan2(b.z,-b.x)/2/Math.PI+.5,1-(Math.atan2(-b.y,Math.sqrt(b.x*b.x+b.z*b.z))/Math.PI+.5));b=new w,q=new w;for(var J=new w,Q=new w,K=new f,rt=new f,lt=new f,Bt=0,Zt=0;Bt<z.length;Bt+=9,Zt+=6){b.set(z[Bt+0],z[Bt+1],z[Bt+2]),q.set(z[Bt+3],z[Bt+4],z[Bt+5]),J.set(z[Bt+6],z[Bt+7],z[Bt+8]),K.set(k[Zt+0],k[Zt+1]),rt.set(k[Zt+2],k[Zt+3]),lt.set(k[Zt+4],k[Zt+5]),Q.copy(b).add(q).add(J).divideScalar(3);var bt=Math.atan2(Q.z,-Q.x);R(K,Zt+0,b,bt),R(rt,Zt+2,q,bt),R(lt,Zt+4,J,bt)}for(b=0;b<k.length;b+=6)q=k[b+0],J=k[b+2],Q=k[b+4],K=Math.min(q,J,Q),.9<Math.max(q,J,Q)&&.1>K&&(.2>q&&(k[b+0]+=1),.2>J&&(k[b+2]+=1),.2>Q&&(k[b+4]+=1))}(),this.setAttribute("position",new mt(z,3)),this.setAttribute("normal",new mt(z.slice(),3)),this.setAttribute("uv",new mt(k,2)),m===0?this.computeVertexNormals():this.normalizeNormals()}function cv(e,o){ft.call(this),this.type="TetrahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new Wd(e,o)),this.mergeVertices()}function Wd(e,o){Us.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],e,o),this.type="TetrahedronBufferGeometry",this.parameters={radius:e,detail:o}}function fv(e,o){ft.call(this),this.type="OctahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new kf(e,o)),this.mergeVertices()}function kf(e,o){Us.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],e,o),this.type="OctahedronBufferGeometry",this.parameters={radius:e,detail:o}}function pv(e,o){ft.call(this),this.type="IcosahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new jd(e,o)),this.mergeVertices()}function jd(e,o){var h=(1+Math.sqrt(5))/2;Us.call(this,[-1,h,0,1,h,0,-1,-h,0,1,-h,0,0,-1,h,0,1,h,0,-1,-h,0,1,-h,h,0,-1,h,0,1,-h,0,-1,-h,0,1],[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],e,o),this.type="IcosahedronBufferGeometry",this.parameters={radius:e,detail:o}}function dv(e,o){ft.call(this),this.type="DodecahedronGeometry",this.parameters={radius:e,detail:o},this.fromBufferGeometry(new Xd(e,o)),this.mergeVertices()}function Xd(e,o){var h=(1+Math.sqrt(5))/2,m=1/h;Us.call(this,[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-m,-h,0,-m,h,0,m,-h,0,m,h,-m,-h,0,-m,h,0,m,-h,0,m,h,0,-h,0,-m,h,0,-m,-h,0,m,h,0,m],[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],e,o),this.type="DodecahedronBufferGeometry",this.parameters={radius:e,detail:o}}function gv(e,o,h,m,_,T){ft.call(this),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:o,radius:h,radialSegments:m,closed:_},T!==void 0&&console.warn("THREE.TubeGeometry: taper has been removed."),e=new Gf(e,o,h,m,_),this.tangents=e.tangents,this.normals=e.normals,this.binormals=e.binormals,this.fromBufferGeometry(e),this.mergeVertices()}function Gf(e,o,h,m,_){function T(Zt){q=e.getPointAt(Zt/o,q);var bt=R.normals[Zt];for(Zt=R.binormals[Zt],Q=0;Q<=m;Q++){var ae=Q/m*Math.PI*2,Kt=Math.sin(ae);ae=-Math.cos(ae),k.x=ae*bt.x+Kt*Zt.x,k.y=ae*bt.y+Kt*Zt.y,k.z=ae*bt.z+Kt*Zt.z,k.normalize(),rt.push(k.x,k.y,k.z),z.x=q.x+h*k.x,z.y=q.y+h*k.y,z.z=q.z+h*k.z,K.push(z.x,z.y,z.z)}}ct.call(this),this.type="TubeBufferGeometry",this.parameters={path:e,tubularSegments:o,radius:h,radialSegments:m,closed:_},o=o||64,h=h||1,m=m||8,_=_||!1;var R=e.computeFrenetFrames(o,_);this.tangents=R.tangents,this.normals=R.normals,this.binormals=R.binormals;var z=new w,k=new w,b=new f,q=new w,J,Q,K=[],rt=[],lt=[],Bt=[];for(J=0;J<o;J++)T(J);for(T(_===!1?o:0),J=0;J<=o;J++)for(Q=0;Q<=m;Q++)b.x=J/o,b.y=Q/m,lt.push(b.x,b.y);(function(){for(Q=1;Q<=o;Q++)for(J=1;J<=m;J++){var Zt=(m+1)*Q+(J-1),bt=(m+1)*Q+J,ae=(m+1)*(Q-1)+J;Bt.push((m+1)*(Q-1)+(J-1),Zt,ae),Bt.push(Zt,bt,ae)}})(),this.setIndex(Bt),this.setAttribute("position",new mt(K,3)),this.setAttribute("normal",new mt(rt,3)),this.setAttribute("uv",new mt(lt,2))}function mv(e,o,h,m,_,T,R){ft.call(this),this.type="TorusKnotGeometry",this.parameters={radius:e,tube:o,tubularSegments:h,radialSegments:m,p:_,q:T},R!==void 0&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Yd(e,o,h,m,_,T)),this.mergeVertices()}function Yd(e,o,h,m,_,T){function R(Xt,Me,Ne,pe,ke){var Fe=Math.sin(Xt);Me=Ne/Me*Xt,Ne=Math.cos(Me),ke.x=pe*(2+Ne)*.5*Math.cos(Xt),ke.y=pe*(2+Ne)*Fe*.5,ke.z=pe*Math.sin(Me)*.5}ct.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:e,tube:o,tubularSegments:h,radialSegments:m,p:_,q:T},e=e||1,o=o||.4,h=Math.floor(h)||64,m=Math.floor(m)||8,_=_||2,T=T||3;var z=[],k=[],b=[],q=[],J,Q=new w,K=new w,rt=new w,lt=new w,Bt=new w,Zt=new w,bt=new w;for(J=0;J<=h;++J){var ae=J/h*_*Math.PI*2;for(R(ae,_,T,e,rt),R(ae+.01,_,T,e,lt),Zt.subVectors(lt,rt),bt.addVectors(lt,rt),Bt.crossVectors(Zt,bt),bt.crossVectors(Bt,Zt),Bt.normalize(),bt.normalize(),ae=0;ae<=m;++ae){var Kt=ae/m*Math.PI*2,fe=-o*Math.cos(Kt);Kt=o*Math.sin(Kt),Q.x=rt.x+(fe*bt.x+Kt*Bt.x),Q.y=rt.y+(fe*bt.y+Kt*Bt.y),Q.z=rt.z+(fe*bt.z+Kt*Bt.z),k.push(Q.x,Q.y,Q.z),K.subVectors(Q,rt).normalize(),b.push(K.x,K.y,K.z),q.push(J/h),q.push(ae/m)}}for(ae=1;ae<=h;ae++)for(J=1;J<=m;J++)e=(m+1)*ae+(J-1),o=(m+1)*ae+J,_=(m+1)*(ae-1)+J,z.push((m+1)*(ae-1)+(J-1),e,_),z.push(e,o,_);this.setIndex(z),this.setAttribute("position",new mt(k,3)),this.setAttribute("normal",new mt(b,3)),this.setAttribute("uv",new mt(q,2))}function vv(e,o,h,m,_){ft.call(this),this.type="TorusGeometry",this.parameters={radius:e,tube:o,radialSegments:h,tubularSegments:m,arc:_},this.fromBufferGeometry(new Zd(e,o,h,m,_)),this.mergeVertices()}function Zd(e,o,h,m,_){ct.call(this),this.type="TorusBufferGeometry",this.parameters={radius:e,tube:o,radialSegments:h,tubularSegments:m,arc:_},e=e||1,o=o||.4,h=Math.floor(h)||8,m=Math.floor(m)||6,_=_||2*Math.PI;var T=[],R=[],z=[],k=[],b=new w,q=new w,J=new w,Q,K;for(Q=0;Q<=h;Q++)for(K=0;K<=m;K++){var rt=K/m*_,lt=Q/h*Math.PI*2;q.x=(e+o*Math.cos(lt))*Math.cos(rt),q.y=(e+o*Math.cos(lt))*Math.sin(rt),q.z=o*Math.sin(lt),R.push(q.x,q.y,q.z),b.x=e*Math.cos(rt),b.y=e*Math.sin(rt),J.subVectors(q,b).normalize(),z.push(J.x,J.y,J.z),k.push(K/m),k.push(Q/h)}for(Q=1;Q<=h;Q++)for(K=1;K<=m;K++)e=(m+1)*(Q-1)+K-1,o=(m+1)*(Q-1)+K,_=(m+1)*Q+K,T.push((m+1)*Q+K-1,e,_),T.push(e,o,_);this.setIndex(T),this.setAttribute("position",new mt(R,3)),this.setAttribute("normal",new mt(z,3)),this.setAttribute("uv",new mt(k,2))}function Bw(e,o,h,m,_){for(var T,R=0,z=o,k=h-m;z<h;z+=m)R+=(e[k]-e[z])*(e[z+1]+e[k+1]),k=z;if(_===0<R)for(_=o;_<h;_+=m)T=Uw(_,e[_],e[_+1],T);else for(_=h-m;_>=o;_-=m)T=Uw(_,e[_],e[_+1],T);return T&&wy(T,T.next)&&(Av(T),T=T.next),T}function pc(e,o){if(!e)return e;o||(o=e);do{var h=!1;if(e.steiner||!wy(e,e.next)&&Fn(e.prev,e,e.next)!==0)e=e.next;else{if(Av(e),e=o=e.prev,e===e.next)break;h=!0}}while(h||e!==o);return o}function yv(e,o,h,m,_,T,R){if(e){if(!R&&T){var z=e,k=z;do k.z===null&&(k.z=d2(k.x,k.y,m,_,T)),k.prevZ=k.prev,k=k.nextZ=k.next;while(k!==z);k.prevZ.nextZ=null,k.prevZ=null,z=k;var b,q,J,Q,K=1;do{k=z;var rt=z=null;for(q=0;k;){q++;var lt=k;for(b=J=0;b<K&&(J++,lt=lt.nextZ,lt);b++);for(Q=K;0<J||0<Q&&lt;)J!==0&&(Q===0||!lt||k.z<=lt.z)?(b=k,k=k.nextZ,J--):(b=lt,lt=lt.nextZ,Q--),rt?rt.nextZ=b:z=b,b.prevZ=rt,rt=b;k=lt}rt.nextZ=null,K*=2}while(1<q)}for(z=e;e.prev!==e.next;){if(k=e.prev,lt=e.next,T)rt=z3(e,m,_,T);else t:if(rt=e,q=rt.prev,J=rt,K=rt.next,0<=Fn(q,J,K))rt=!1;else{for(b=rt.next.next;b!==rt.prev;){if(Jd(q.x,q.y,J.x,J.y,K.x,K.y,b.x,b.y)&&0<=Fn(b.prev,b,b.next)){rt=!1;break t}b=b.next}rt=!0}if(rt)o.push(k.i/h),o.push(e.i/h),o.push(lt.i/h),Av(e),z=e=lt.next;else if(e=lt,e===z){if(!R)yv(pc(e),o,h,m,_,T,1);else if(R===1){e=pc(e),R=o,z=h,k=e;do lt=k.prev,rt=k.next.next,!wy(lt,rt)&&Nw(lt,k,k.next,rt)&&xv(lt,rt)&&xv(rt,lt)&&(R.push(lt.i/z),R.push(k.i/z),R.push(rt.i/z),Av(k),Av(k.next),k=e=rt),k=k.next;while(k!==e);e=pc(k),yv(e,o,h,m,_,T,2)}else if(R===2)t:{R=e;do{for(z=R.next.next;z!==R.prev;){if(k=R.i!==z.i){if(k=R,lt=z,rt=k.next.i!==lt.i&&k.prev.i!==lt.i){e:{rt=k;do{if(rt.i!==k.i&&rt.next.i!==k.i&&rt.i!==lt.i&&rt.next.i!==lt.i&&Nw(rt,rt.next,k,lt)){rt=!0;break e}rt=rt.next}while(rt!==k);rt=!1}rt=!rt}if(rt){if(rt=xv(k,lt)&&xv(lt,k)){rt=k,q=!1,J=(k.x+lt.x)/2,K=(k.y+lt.y)/2;do rt.y>K!=rt.next.y>K&&rt.next.y!==rt.y&&J<(rt.next.x-rt.x)*(K-rt.y)/(rt.next.y-rt.y)+rt.x&&(q=!q),rt=rt.next;while(rt!==k);rt=q}rt=rt&&(Fn(k.prev,k,lt.prev)||Fn(k,lt.prev,lt))||wy(k,lt)&&0<Fn(k.prev,k,k.next)&&0<Fn(lt.prev,lt,lt.next)}k=rt}if(k){e=zw(R,z),R=pc(R,R.next),e=pc(e,e.next),yv(R,o,h,m,_,T),yv(e,o,h,m,_,T);break t}z=z.next}R=R.next}while(R!==e)}break}}}}function z3(e,o,h,m){var _=e.prev,T=e.next;if(0<=Fn(_,e,T))return!1;var R=_.x>e.x?_.x>T.x?_.x:T.x:e.x>T.x?e.x:T.x,z=_.y>e.y?_.y>T.y?_.y:T.y:e.y>T.y?e.y:T.y,k=d2(_.x<e.x?_.x<T.x?_.x:T.x:e.x<T.x?e.x:T.x,_.y<e.y?_.y<T.y?_.y:T.y:e.y<T.y?e.y:T.y,o,h,m);for(o=d2(R,z,o,h,m),h=e.prevZ,m=e.nextZ;h&&h.z>=k&&m&&m.z<=o;){if(h!==e.prev&&h!==e.next&&Jd(_.x,_.y,e.x,e.y,T.x,T.y,h.x,h.y)&&0<=Fn(h.prev,h,h.next)||(h=h.prevZ,m!==e.prev&&m!==e.next&&Jd(_.x,_.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=Fn(m.prev,m,m.next)))return!1;m=m.nextZ}for(;h&&h.z>=k;){if(h!==e.prev&&h!==e.next&&Jd(_.x,_.y,e.x,e.y,T.x,T.y,h.x,h.y)&&0<=Fn(h.prev,h,h.next))return!1;h=h.prevZ}for(;m&&m.z<=o;){if(m!==e.prev&&m!==e.next&&Jd(_.x,_.y,e.x,e.y,T.x,T.y,m.x,m.y)&&0<=Fn(m.prev,m,m.next))return!1;m=m.nextZ}return!0}function U3(e,o){return e.x-o.x}function H3(e,o){var h=o,m=e.x,_=e.y,T=-1/0;do{if(_<=h.y&&_>=h.next.y&&h.next.y!==h.y){var R=h.x+(_-h.y)*(h.next.x-h.x)/(h.next.y-h.y);if(R<=m&&R>T){if(T=R,R===m){if(_===h.y)return h;if(_===h.next.y)return h.next}var z=h.x<h.next.x?h:h.next}}h=h.next}while(h!==o);if(!z)return null;if(m===T)return z;o=z,R=z.x;var k=z.y,b=1/0;h=z;do{if(m>=h.x&&h.x>=R&&m!==h.x&&Jd(_<k?m:T,_,R,k,_<k?T:m,_,h.x,h.y)){var q=Math.abs(_-h.y)/(m-h.x),J;if((J=xv(h,e))&&!(J=q<b)&&(J=q===b)&&!(J=h.x>z.x)&&(J=h.x===z.x)){J=z;var Q=h;J=0>Fn(J.prev,J,Q.prev)&&0>Fn(Q.next,J,J.next)}J&&(z=h,b=q)}h=h.next}while(h!==o);return z}function d2(e,o,h,m,_){return e=32767*(e-h)*_,o=32767*(o-m)*_,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,o=(o|o<<8)&16711935,o=(o|o<<4)&252645135,o=(o|o<<2)&858993459,(e|e<<1)&1431655765|((o|o<<1)&1431655765)<<1}function k3(e){var o=e,h=e;do(o.x<h.x||o.x===h.x&&o.y<h.y)&&(h=o),o=o.next;while(o!==e);return h}function Jd(e,o,h,m,_,T,R,z){return 0<=(_-R)*(o-z)-(e-R)*(T-z)&&0<=(e-R)*(m-z)-(h-R)*(o-z)&&0<=(h-R)*(T-z)-(_-R)*(m-z)}function Fn(e,o,h){return(o.y-e.y)*(h.x-o.x)-(o.x-e.x)*(h.y-o.y)}function wy(e,o){return e.x===o.x&&e.y===o.y}function Nw(e,o,h,m){var _=Cy(Fn(e,o,h)),T=Cy(Fn(e,o,m)),R=Cy(Fn(h,m,e)),z=Cy(Fn(h,m,o));return!!(_!==T&&R!==z||_===0&&My(e,h,o)||T===0&&My(e,m,o)||R===0&&My(h,e,m)||z===0&&My(h,o,m))}function My(e,o,h){return o.x<=Math.max(e.x,h.x)&&o.x>=Math.min(e.x,h.x)&&o.y<=Math.max(e.y,h.y)&&o.y>=Math.min(e.y,h.y)}function Cy(e){return 0<e?1:0>e?-1:0}function xv(e,o){return 0>Fn(e.prev,e,e.next)?0<=Fn(e,o,e.next)&&0<=Fn(e,e.prev,o):0>Fn(e,o,e.prev)||0>Fn(e,e.next,o)}function zw(e,o){var h=new g2(e.i,e.x,e.y),m=new g2(o.i,o.x,o.y),_=e.next,T=o.prev;return e.next=o,o.prev=e,h.next=_,_.prev=h,m.next=h,h.prev=m,T.next=m,m.prev=T,m}function Uw(e,o,h,m){return e=new g2(e,o,h),m?(e.next=m.next,e.prev=m,m.next.prev=e,m.next=e):(e.prev=e,e.next=e),e}function Av(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function g2(e,o,h){this.i=e,this.x=o,this.y=h,this.nextZ=this.prevZ=this.z=this.next=this.prev=null,this.steiner=!1}function Hw(e){var o=e.length;2<o&&e[o-1].equals(e[0])&&e.pop()}function kw(e,o){for(var h=0;h<o.length;h++)e.push(o[h].x),e.push(o[h].y)}function bf(e,o){ft.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:e,options:o},this.fromBufferGeometry(new il(e,o)),this.mergeVertices()}function il(e,o){function h(k){function b(lr,ti,Mn){return ti||console.error("THREE.ExtrudeGeometry: vec does not exist"),ti.clone().multiplyScalar(Mn).add(lr)}function q(lr,ti,Mn){var ri=lr.x-ti.x,De=lr.y-ti.y,ei=Mn.x-lr.x,gi=Mn.y-lr.y,Vr=ri*ri+De*De;if(Math.abs(ri*gi-De*ei)>hn){var ns=Math.sqrt(Vr),no=Math.sqrt(ei*ei+gi*gi);if(Vr=ti.x-De/ns,ti=ti.y+ri/ns,gi=((Mn.x-gi/no-Vr)*gi-(Mn.y+ei/no-ti)*ei)/(ri*gi-De*ei),ei=Vr+ri*gi-lr.x,ri=ti+De*gi-lr.y,De=ei*ei+ri*ri,2>=De)return new f(ei,ri);De=Math.sqrt(De/2)}else lr=!1,ri>hn?ei>hn&&(lr=!0):ri<-hn?ei<-hn&&(lr=!0):Zu(De)===Zu(gi)&&(lr=!0),lr?(ei=-De,De=Math.sqrt(Vr)):(ei=ri,ri=De,De=Math.sqrt(Vr/2));return new f(ei/De,ri/De)}function J(lr,ti){for(Le=lr.length;0<=--Le;){var Mn=Le,ri=Le-1;0>ri&&(ri=lr.length-1);var De,ei=bt+2*Ne;for(De=0;De<ei;De++){var gi=ye*De,Vr=ye*(De+1),ns=ti+ri+gi,no=ti+ri+Vr;Vr=ti+Mn+Vr,rt(ti+Mn+gi),rt(ns),rt(Vr),rt(ns),rt(no),rt(Vr),gi=_.length/3,gi=ke.generateSideWallUV(m,_,gi-6,gi-3,gi-2,gi-1),lt(gi[0]),lt(gi[1]),lt(gi[3]),lt(gi[1]),lt(gi[2]),lt(gi[3])}}}function Q(lr,ti,Mn){Bt.push(lr),Bt.push(ti),Bt.push(Mn)}function K(lr,ti,Mn){rt(lr),rt(ti),rt(Mn),lr=_.length/3,lr=ke.generateTopUV(m,_,lr-3,lr-2,lr-1),lt(lr[0]),lt(lr[1]),lt(lr[2])}function rt(lr){_.push(Bt[3*lr]),_.push(Bt[3*lr+1]),_.push(Bt[3*lr+2])}function lt(lr){T.push(lr.x),T.push(lr.y)}var Bt=[],Zt=o.curveSegments!==void 0?o.curveSegments:12,bt=o.steps!==void 0?o.steps:1,ae=o.depth!==void 0?o.depth:100,Kt=o.bevelEnabled!==void 0?o.bevelEnabled:!0,fe=o.bevelThickness!==void 0?o.bevelThickness:6,Xt=o.bevelSize!==void 0?o.bevelSize:fe-2,Me=o.bevelOffset!==void 0?o.bevelOffset:0,Ne=o.bevelSegments!==void 0?o.bevelSegments:3,pe=o.extrudePath,ke=o.UVGenerator!==void 0?o.UVGenerator:lT;o.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),ae=o.amount);var Fe=!1;if(pe){var Ar=pe.getSpacedPoints(bt);Fe=!0,Kt=!1;var kr=pe.computeFrenetFrames(bt,!1),ir=new w,zr=new w,ui=new w}Kt||(Me=Xt=fe=Ne=0);var Kr;Zt=k.extractPoints(Zt),k=Zt.shape;var Mi=Zt.holes;if(!mh.isClockWise(k)){k=k.reverse();var fi=0;for(Kr=Mi.length;fi<Kr;fi++){var Hi=Mi[fi];mh.isClockWise(Hi)&&(Mi[fi]=Hi.reverse())}}var en=mh.triangulateShape(k,Mi),wt=k;for(fi=0,Kr=Mi.length;fi<Kr;fi++)Hi=Mi[fi],k=k.concat(Hi);var Nt,ye=k.length,Ve,cr=en.length;Zt=[];var Le=0,Ht=wt.length,Ye=Ht-1;for(Nt=Le+1;Le<Ht;Le++,Ye++,Nt++)Ye===Ht&&(Ye=0),Nt===Ht&&(Nt=0),Zt[Le]=q(wt[Le],wt[Ye],wt[Nt]);pe=[];var vr=Zt.concat();for(fi=0,Kr=Mi.length;fi<Kr;fi++){Hi=Mi[fi];var br=[];for(Le=0,Ht=Hi.length,Ye=Ht-1,Nt=Le+1;Le<Ht;Le++,Ye++,Nt++)Ye===Ht&&(Ye=0),Nt===Ht&&(Nt=0),br[Le]=q(Hi[Le],Hi[Ye],Hi[Nt]);pe.push(br),vr=vr.concat(br)}for(Ye=0;Ye<Ne;Ye++){Ht=Ye/Ne;var wr=fe*Math.cos(Ht*Math.PI/2);for(Nt=Xt*Math.sin(Ht*Math.PI/2)+Me,Le=0,Ht=wt.length;Le<Ht;Le++){var ur=b(wt[Le],Zt[Le],Nt);Q(ur.x,ur.y,-wr)}for(fi=0,Kr=Mi.length;fi<Kr;fi++)for(Hi=Mi[fi],br=pe[fi],Le=0,Ht=Hi.length;Le<Ht;Le++)ur=b(Hi[Le],br[Le],Nt),Q(ur.x,ur.y,-wr)}for(Nt=Xt+Me,Le=0;Le<ye;Le++)ur=Kt?b(k[Le],vr[Le],Nt):k[Le],Fe?(zr.copy(kr.normals[0]).multiplyScalar(ur.x),ir.copy(kr.binormals[0]).multiplyScalar(ur.y),ui.copy(Ar[0]).add(zr).add(ir),Q(ui.x,ui.y,ui.z)):Q(ur.x,ur.y,0);for(Ht=1;Ht<=bt;Ht++)for(Le=0;Le<ye;Le++)ur=Kt?b(k[Le],vr[Le],Nt):k[Le],Fe?(zr.copy(kr.normals[Ht]).multiplyScalar(ur.x),ir.copy(kr.binormals[Ht]).multiplyScalar(ur.y),ui.copy(Ar[Ht]).add(zr).add(ir),Q(ui.x,ui.y,ui.z)):Q(ur.x,ur.y,ae/bt*Ht);for(Ye=Ne-1;0<=Ye;Ye--){for(Ht=Ye/Ne,wr=fe*Math.cos(Ht*Math.PI/2),Nt=Xt*Math.sin(Ht*Math.PI/2)+Me,Le=0,Ht=wt.length;Le<Ht;Le++)ur=b(wt[Le],Zt[Le],Nt),Q(ur.x,ur.y,ae+wr);for(fi=0,Kr=Mi.length;fi<Kr;fi++)for(Hi=Mi[fi],br=pe[fi],Le=0,Ht=Hi.length;Le<Ht;Le++)ur=b(Hi[Le],br[Le],Nt),Fe?Q(ur.x,ur.y+Ar[bt-1].y,Ar[bt-1].x+wr):Q(ur.x,ur.y,ae+wr)}(function(){var lr=_.length/3;if(Kt){var ti=0*ye;for(Le=0;Le<cr;Le++)Ve=en[Le],K(Ve[2]+ti,Ve[1]+ti,Ve[0]+ti);for(ti=ye*(bt+2*Ne),Le=0;Le<cr;Le++)Ve=en[Le],K(Ve[0]+ti,Ve[1]+ti,Ve[2]+ti)}else{for(Le=0;Le<cr;Le++)Ve=en[Le],K(Ve[2],Ve[1],Ve[0]);for(Le=0;Le<cr;Le++)Ve=en[Le],K(Ve[0]+ye*bt,Ve[1]+ye*bt,Ve[2]+ye*bt)}m.addGroup(lr,_.length/3-lr,0)})(),function(){var lr=_.length/3,ti=0;for(J(wt,ti),ti+=wt.length,fi=0,Kr=Mi.length;fi<Kr;fi++)Hi=Mi[fi],J(Hi,ti),ti+=Hi.length;m.addGroup(lr,_.length/3-lr,1)}()}ct.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:e,options:o},e=Array.isArray(e)?e:[e];for(var m=this,_=[],T=[],R=0,z=e.length;R<z;R++)h(e[R]);this.setAttribute("position",new mt(_,3)),this.setAttribute("uv",new mt(T,2)),this.computeVertexNormals()}function Gw(e,o,h){if(h.shapes=[],Array.isArray(e))for(var m=0,_=e.length;m<_;m++)h.shapes.push(e[m].uuid);else h.shapes.push(e.uuid);return o.extrudePath!==void 0&&(h.options.extrudePath=o.extrudePath.toJSON()),h}function _v(e,o){ft.call(this),this.type="TextGeometry",this.parameters={text:e,parameters:o},this.fromBufferGeometry(new qd(e,o)),this.mergeVertices()}function qd(e,o){o=o||{};var h=o.font;if(!h||!h.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new ft;e=h.generateShapes(e,o.size),o.depth=o.height!==void 0?o.height:50,o.bevelThickness===void 0&&(o.bevelThickness=10),o.bevelSize===void 0&&(o.bevelSize=8),o.bevelEnabled===void 0&&(o.bevelEnabled=!1),il.call(this,e,o),this.type="TextBufferGeometry"}function wv(e,o,h,m,_,T,R){ft.call(this),this.type="SphereGeometry",this.parameters={radius:e,widthSegments:o,heightSegments:h,phiStart:m,phiLength:_,thetaStart:T,thetaLength:R},this.fromBufferGeometry(new Vf(e,o,h,m,_,T,R)),this.mergeVertices()}function Vf(e,o,h,m,_,T,R){ct.call(this),this.type="SphereBufferGeometry",this.parameters={radius:e,widthSegments:o,heightSegments:h,phiStart:m,phiLength:_,thetaStart:T,thetaLength:R},e=e||1,o=Math.max(3,Math.floor(o)||8),h=Math.max(2,Math.floor(h)||6),m=m!==void 0?m:0,_=_!==void 0?_:2*Math.PI,T=T!==void 0?T:0,R=R!==void 0?R:Math.PI;var z=Math.min(T+R,Math.PI),k,b,q=0,J=[],Q=new w,K=new w,rt=[],lt=[],Bt=[],Zt=[];for(b=0;b<=h;b++){var bt=[],ae=b/h,Kt=0;for(b==0&&T==0?Kt=.5/o:b==h&&z==Math.PI&&(Kt=-.5/o),k=0;k<=o;k++){var fe=k/o;Q.x=-e*Math.cos(m+fe*_)*Math.sin(T+ae*R),Q.y=e*Math.cos(T+ae*R),Q.z=e*Math.sin(m+fe*_)*Math.sin(T+ae*R),lt.push(Q.x,Q.y,Q.z),K.copy(Q).normalize(),Bt.push(K.x,K.y,K.z),Zt.push(fe+Kt,1-ae),bt.push(q++)}J.push(bt)}for(b=0;b<h;b++)for(k=0;k<o;k++)e=J[b][k+1],m=J[b][k],_=J[b+1][k],R=J[b+1][k+1],(b!==0||0<T)&&rt.push(e,m,R),(b!==h-1||z<Math.PI)&&rt.push(m,_,R);this.setIndex(rt),this.setAttribute("position",new mt(lt,3)),this.setAttribute("normal",new mt(Bt,3)),this.setAttribute("uv",new mt(Zt,2))}function Mv(e,o,h,m,_,T){ft.call(this),this.type="RingGeometry",this.parameters={innerRadius:e,outerRadius:o,thetaSegments:h,phiSegments:m,thetaStart:_,thetaLength:T},this.fromBufferGeometry(new Kd(e,o,h,m,_,T)),this.mergeVertices()}function Kd(e,o,h,m,_,T){ct.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:e,outerRadius:o,thetaSegments:h,phiSegments:m,thetaStart:_,thetaLength:T},e=e||.5,o=o||1,_=_!==void 0?_:0,T=T!==void 0?T:2*Math.PI,h=h!==void 0?Math.max(3,h):8,m=m!==void 0?Math.max(1,m):1;var R=[],z=[],k=[],b=[],q=e,J=(o-e)/m,Q=new w,K=new f,rt,lt;for(rt=0;rt<=m;rt++){for(lt=0;lt<=h;lt++)e=_+lt/h*T,Q.x=q*Math.cos(e),Q.y=q*Math.sin(e),z.push(Q.x,Q.y,Q.z),k.push(0,0,1),K.x=(Q.x/o+1)/2,K.y=(Q.y/o+1)/2,b.push(K.x,K.y);q+=J}for(rt=0;rt<m;rt++)for(o=rt*(h+1),lt=0;lt<h;lt++)e=lt+o,_=e+h+1,T=e+h+2,q=e+1,R.push(e,_,q),R.push(_,T,q);this.setIndex(R),this.setAttribute("position",new mt(z,3)),this.setAttribute("normal",new mt(k,3)),this.setAttribute("uv",new mt(b,2))}function Cv(e,o,h,m){ft.call(this),this.type="LatheGeometry",this.parameters={points:e,segments:o,phiStart:h,phiLength:m},this.fromBufferGeometry(new Qd(e,o,h,m)),this.mergeVertices()}function Qd(e,o,h,m){ct.call(this),this.type="LatheBufferGeometry",this.parameters={points:e,segments:o,phiStart:h,phiLength:m},o=Math.floor(o)||12,h=h||0,m=m||2*Math.PI,m=di.clamp(m,0,2*Math.PI);var _=[],T=[],R=[],z=1/o,k=new w,b=new f,q;for(q=0;q<=o;q++){var J=h+q*z*m,Q=Math.sin(J),K=Math.cos(J);for(J=0;J<=e.length-1;J++)k.x=e[J].x*Q,k.y=e[J].y,k.z=e[J].x*K,T.push(k.x,k.y,k.z),b.x=q/o,b.y=J/(e.length-1),R.push(b.x,b.y)}for(q=0;q<o;q++)for(J=0;J<e.length-1;J++)h=J+q*e.length,z=h+e.length,k=h+e.length+1,b=h+1,_.push(h,z,b),_.push(z,k,b);if(this.setIndex(_),this.setAttribute("position",new mt(T,3)),this.setAttribute("uv",new mt(R,2)),this.computeVertexNormals(),m===2*Math.PI)for(m=this.attributes.normal.array,_=new w,T=new w,R=new w,h=o*e.length*3,J=q=0;q<e.length;q++,J+=3)_.x=m[J+0],_.y=m[J+1],_.z=m[J+2],T.x=m[h+J+0],T.y=m[h+J+1],T.z=m[h+J+2],R.addVectors(_,T).normalize(),m[J+0]=m[h+J+0]=R.x,m[J+1]=m[h+J+1]=R.y,m[J+2]=m[h+J+2]=R.z}function Wf(e,o){ft.call(this),this.type="ShapeGeometry",(typeof o=="undefined"?"undefined":Zs(o))==="object"&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),o=o.curveSegments),this.parameters={shapes:e,curveSegments:o},this.fromBufferGeometry(new jf(e,o)),this.mergeVertices()}function jf(e,o){function h(q){var J,Q=_.length/3;q=q.extractPoints(o);var K=q.shape,rt=q.holes;for(mh.isClockWise(K)===!1&&(K=K.reverse()),q=0,J=rt.length;q<J;q++){var lt=rt[q];mh.isClockWise(lt)===!0&&(rt[q]=lt.reverse())}var Bt=mh.triangulateShape(K,rt);for(q=0,J=rt.length;q<J;q++)lt=rt[q],K=K.concat(lt);for(q=0,J=K.length;q<J;q++)lt=K[q],_.push(lt.x,lt.y,0),T.push(0,0,1),R.push(lt.x,lt.y);for(q=0,J=Bt.length;q<J;q++)K=Bt[q],m.push(K[0]+Q,K[1]+Q,K[2]+Q),k+=3}ct.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:e,curveSegments:o},o=o||12;var m=[],_=[],T=[],R=[],z=0,k=0;if(Array.isArray(e)===!1)h(e);else for(var b=0;b<e.length;b++)h(e[b]),this.addGroup(z,k,b),z+=k,k=0;this.setIndex(m),this.setAttribute("position",new mt(_,3)),this.setAttribute("normal",new mt(T,3)),this.setAttribute("uv",new mt(R,2))}function bw(e,o){if(o.shapes=[],Array.isArray(e))for(var h=0,m=e.length;h<m;h++)o.shapes.push(e[h].uuid);else o.shapes.push(e.uuid);return o}function $d(e,o){ct.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:o};var h=[];o=Math.cos(di.DEG2RAD*(o!==void 0?o:1));var m=[0,0],_={},T=["a","b","c"];if(e.isBufferGeometry){var R=new ft;R.fromBufferGeometry(e)}else R=e.clone();R.mergeVertices(),R.computeFaceNormals(),e=R.vertices,R=R.faces;for(var z=0,k=R.length;z<k;z++)for(var b=R[z],q=0;3>q;q++){var J=b[T[q]],Q=b[T[(q+1)%3]];m[0]=Math.min(J,Q),m[1]=Math.max(J,Q),J=m[0]+","+m[1],_[J]===void 0?_[J]={index1:m[0],index2:m[1],face1:z,face2:void 0}:_[J].face2=z}for(J in _)m=_[J],(m.face2===void 0||R[m.face1].normal.dot(R[m.face2].normal)<=o)&&(T=e[m.index1],h.push(T.x,T.y,T.z),T=e[m.index2],h.push(T.x,T.y,T.z));this.setAttribute("position",new mt(h,3))}function Xf(e,o,h,m,_,T,R,z){ft.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:e,radiusBottom:o,height:h,radialSegments:m,heightSegments:_,openEnded:T,thetaStart:R,thetaLength:z},this.fromBufferGeometry(new sh(e,o,h,m,_,T,R,z)),this.mergeVertices()}function sh(e,o,h,m,_,T,R,z){function k(bt){var ae,Kt=new f,fe=new w,Xt=0,Me=bt===!0?e:o,Ne=bt===!0?1:-1,pe=rt;for(ae=1;ae<=m;ae++)J.push(0,Bt*Ne,0),Q.push(0,Ne,0),K.push(.5,.5),rt++;var ke=rt;for(ae=0;ae<=m;ae++){var Fe=ae/m*z+R,Ar=Math.cos(Fe);Fe=Math.sin(Fe),fe.x=Me*Fe,fe.y=Bt*Ne,fe.z=Me*Ar,J.push(fe.x,fe.y,fe.z),Q.push(0,Ne,0),Kt.x=.5*Ar+.5,Kt.y=.5*Fe*Ne+.5,K.push(Kt.x,Kt.y),rt++}for(ae=0;ae<m;ae++)Kt=pe+ae,fe=ke+ae,bt===!0?q.push(fe,fe+1,Kt):q.push(fe+1,fe,Kt),Xt+=3;b.addGroup(Zt,Xt,bt===!0?1:2),Zt+=Xt}ct.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:e,radiusBottom:o,height:h,radialSegments:m,heightSegments:_,openEnded:T,thetaStart:R,thetaLength:z};var b=this;e=e!==void 0?e:1,o=o!==void 0?o:1,h=h||1,m=Math.floor(m)||8,_=Math.floor(_)||1,T=T!==void 0?T:!1,R=R!==void 0?R:0,z=z!==void 0?z:2*Math.PI;var q=[],J=[],Q=[],K=[],rt=0,lt=[],Bt=h/2,Zt=0;(function(){var bt,ae,Kt=new w,fe=new w,Xt=0,Me=(o-e)/h;for(ae=0;ae<=_;ae++){var Ne=[],pe=ae/_,ke=pe*(o-e)+e;for(bt=0;bt<=m;bt++){var Fe=bt/m,Ar=Fe*z+R,kr=Math.sin(Ar);Ar=Math.cos(Ar),fe.x=ke*kr,fe.y=-pe*h+Bt,fe.z=ke*Ar,J.push(fe.x,fe.y,fe.z),Kt.set(kr,Me,Ar).normalize(),Q.push(Kt.x,Kt.y,Kt.z),K.push(Fe,1-pe),Ne.push(rt++)}lt.push(Ne)}for(bt=0;bt<m;bt++)for(ae=0;ae<_;ae++)Kt=lt[ae+1][bt],fe=lt[ae+1][bt+1],Me=lt[ae][bt+1],q.push(lt[ae][bt],Kt,Me),q.push(Kt,fe,Me),Xt+=6;b.addGroup(Zt,Xt,0),Zt+=Xt})(),T===!1&&(0<e&&k(!0),0<o&&k(!1)),this.setIndex(q),this.setAttribute("position",new mt(J,3)),this.setAttribute("normal",new mt(Q,3)),this.setAttribute("uv",new mt(K,2))}function Tv(e,o,h,m,_,T,R){Xf.call(this,0,e,o,h,m,_,T,R),this.type="ConeGeometry",this.parameters={radius:e,height:o,radialSegments:h,heightSegments:m,openEnded:_,thetaStart:T,thetaLength:R}}function Sv(e,o,h,m,_,T,R){sh.call(this,0,e,o,h,m,_,T,R),this.type="ConeBufferGeometry",this.parameters={radius:e,height:o,radialSegments:h,heightSegments:m,openEnded:_,thetaStart:T,thetaLength:R}}function Iv(e,o,h,m){ft.call(this),this.type="CircleGeometry",this.parameters={radius:e,segments:o,thetaStart:h,thetaLength:m},this.fromBufferGeometry(new tg(e,o,h,m)),this.mergeVertices()}function tg(e,o,h,m){ct.call(this),this.type="CircleBufferGeometry",this.parameters={radius:e,segments:o,thetaStart:h,thetaLength:m},e=e||1,o=o!==void 0?Math.max(3,o):8,h=h!==void 0?h:0,m=m!==void 0?m:2*Math.PI;var _=[],T=[],R=[],z=[],k,b=new w,q=new f;T.push(0,0,0),R.push(0,0,1),z.push(.5,.5);var J=0;for(k=3;J<=o;J++,k+=3){var Q=h+J/o*m;b.x=e*Math.cos(Q),b.y=e*Math.sin(Q),T.push(b.x,b.y,b.z),R.push(0,0,1),q.x=(T[k]/e+1)/2,q.y=(T[k+1]/e+1)/2,z.push(q.x,q.y)}for(k=1;k<=o;k++)_.push(k,k+1,0);this.setIndex(_),this.setAttribute("position",new mt(T,3)),this.setAttribute("normal",new mt(R,3)),this.setAttribute("uv",new mt(z,2))}function Yf(e){re.call(this),this.type="ShadowMaterial",this.color=new yt(0),this.transparent=!0,this.setValues(e)}function ah(e){me.call(this,e),this.type="RawShaderMaterial"}function nl(e){re.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new yt(16777215),this.roughness=1,this.metalness=0,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.metalnessMap=this.roughnessMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.vertexTangents=this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Zf(e){nl.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new f(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,this.sheen=null,this.transparency=0,this.setValues(e)}function dc(e){re.call(this),this.type="MeshPhongMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.envMap=this.alphaMap=this.specularMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Jf(e){re.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new yt(16777215),this.specular=new yt(1118481),this.shininess=30,this.lightMap=this.gradientMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.bumpMap=this.emissiveMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=this.specularMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function qf(e){re.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.morphNormals=this.morphTargets=this.skinning=this.fog=!1,this.setValues(e)}function Kf(e){re.call(this),this.type="MeshLambertMaterial",this.color=new yt(16777215),this.lightMap=this.map=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new yt(0),this.emissiveIntensity=1,this.envMap=this.alphaMap=this.specularMap=this.emissiveMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinejoin=this.wireframeLinecap="round",this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function Qf(e){re.call(this),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new yt(16777215),this.bumpMap=this.map=this.matcap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new f(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.morphNormals=this.morphTargets=this.skinning=!1,this.setValues(e)}function $f(e){In.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(e)}function ra(e,o,h,m){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=m!==void 0?m:new o.constructor(h),this.sampleValues=o,this.valueSize=h}function Ty(e,o,h,m){ra.call(this,e,o,h,m),this._offsetNext=this._weightNext=this._offsetPrev=this._weightPrev=-0}function Ev(e,o,h,m){ra.call(this,e,o,h,m)}function Sy(e,o,h,m){ra.call(this,e,o,h,m)}function No(e,o,h,m){if(e===void 0)throw Error("THREE.KeyframeTrack: track name is undefined");if(o===void 0||o.length===0)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=En.convertArray(o,this.TimeBufferType),this.values=En.convertArray(h,this.ValueBufferType),this.setInterpolation(m||this.DefaultInterpolation)}function Iy(e,o,h){No.call(this,e,o,h)}function Ey(e,o,h,m){No.call(this,e,o,h,m)}function eg(e,o,h,m){No.call(this,e,o,h,m)}function Ly(e,o,h,m){ra.call(this,e,o,h,m)}function Lv(e,o,h,m){No.call(this,e,o,h,m)}function Ry(e,o,h,m){No.call(this,e,o,h,m)}function rg(e,o,h,m){No.call(this,e,o,h,m)}function Ea(e,o,h,m){this.name=e,this.tracks=h,this.duration=o!==void 0?o:-1,this.blendMode=m!==void 0?m:2500,this.uuid=di.generateUUID(),0>this.duration&&this.resetDuration()}function G3(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return eg;case"vector":case"vector2":case"vector3":case"vector4":return rg;case"color":return Ey;case"quaternion":return Lv;case"bool":case"boolean":return Iy;case"string":return Ry}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}function b3(e){if(e.type===void 0)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");var o=G3(e.type);if(e.times===void 0){var h=[],m=[];En.flattenJSON(e.keys,h,m,"value"),e.times=h,e.values=m}return o.parse!==void 0?o.parse(e):new o(e.name,e.times,e.values,e.interpolation)}function m2(e,o,h){var m=this,_=!1,T=0,R=0,z=void 0,k=[];this.onStart=void 0,this.onLoad=e,this.onProgress=o,this.onError=h,this.itemStart=function(b){R++,_===!1&&m.onStart!==void 0&&m.onStart(b,T,R),_=!0},this.itemEnd=function(b){T++,m.onProgress!==void 0&&m.onProgress(b,T,R),T===R&&(_=!1,m.onLoad!==void 0)&&m.onLoad()},this.itemError=function(b){m.onError!==void 0&&m.onError(b)},this.resolveURL=function(b){return z?z(b):b},this.setURLModifier=function(b){return z=b,this},this.addHandler=function(b,q){return k.push(b,q),this},this.removeHandler=function(b){return b=k.indexOf(b),b!==-1&&k.splice(b,2),this},this.getHandler=function(b){for(var q=0,J=k.length;q<J;q+=2){var Q=k[q],K=k[q+1];if(Q.global&&(Q.lastIndex=0),Q.test(b))return K}return null}}function Ki(e){this.manager=e!==void 0?e:FM,this.crossOrigin="anonymous",this.resourcePath=this.path="",this.requestHeader={}}function La(e){Ki.call(this,e)}function v2(e){Ki.call(this,e)}function y2(e){Ki.call(this,e)}function Py(e){Ki.call(this,e)}function ig(e){Ki.call(this,e)}function Dy(e){Ki.call(this,e)}function Oy(e){Ki.call(this,e)}function jr(){this.type="Curve",this.arcLengthDivisions=200}function ia(e,o,h,m,_,T,R,z){jr.call(this),this.type="EllipseCurve",this.aX=e||0,this.aY=o||0,this.xRadius=h||1,this.yRadius=m||1,this.aStartAngle=_||0,this.aEndAngle=T||2*Math.PI,this.aClockwise=R||!1,this.aRotation=z||0}function ng(e,o,h,m,_,T){ia.call(this,e,o,h,h,m,_,T),this.type="ArcCurve"}function x2(){var e=0,o=0,h=0,m=0;return{initCatmullRom:function(_,T,R,z,k){_=k*(R-_),z=k*(z-T),e=T,o=_,h=-3*T+3*R-2*_-z,m=2*T-2*R+_+z},initNonuniformCatmullRom:function(_,T,R,z,k,b,q){_=((T-_)/k-(R-_)/(k+b)+(R-T)/b)*b,z=((R-T)/b-(z-T)/(b+q)+(z-R)/q)*b,e=T,o=_,h=-3*T+3*R-2*_-z,m=2*T-2*R+_+z},calc:function(_){var T=_*_;return e+o*_+h*T+m*T*_}}}function rs(e,o,h,m){jr.call(this),this.type="CatmullRomCurve3",this.points=e||[],this.closed=o||!1,this.curveType=h||"centripetal",this.tension=m||.5}function Vw(e,o,h,m,_){o=.5*(m-o),_=.5*(_-h);var T=e*e;return(2*h-2*m+o+_)*e*T+(-3*h+3*m-2*o-_)*T+o*e+h}function Rv(e,o,h,m){var _=1-e;return _*_*o+2*(1-e)*e*h+e*e*m}function Pv(e,o,h,m,_){var T=1-e,R=1-e;return T*T*T*o+3*R*R*e*h+3*(1-e)*e*e*m+e*e*e*_}function su(e,o,h,m){jr.call(this),this.type="CubicBezierCurve",this.v0=e||new f,this.v1=o||new f,this.v2=h||new f,this.v3=m||new f}function ol(e,o,h,m){jr.call(this),this.type="CubicBezierCurve3",this.v0=e||new w,this.v1=o||new w,this.v2=h||new w,this.v3=m||new w}function Hs(e,o){jr.call(this),this.type="LineCurve",this.v1=e||new f,this.v2=o||new f}function au(e,o){jr.call(this),this.type="LineCurve3",this.v1=e||new w,this.v2=o||new w}function uu(e,o,h){jr.call(this),this.type="QuadraticBezierCurve",this.v0=e||new f,this.v1=o||new f,this.v2=h||new f}function sl(e,o,h){jr.call(this),this.type="QuadraticBezierCurve3",this.v0=e||new w,this.v1=o||new w,this.v2=h||new w}function lu(e){jr.call(this),this.type="SplineCurve",this.points=e||[]}function uh(){jr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function hu(e){uh.call(this),this.type="Path",this.currentPoint=new f,e&&this.setFromPoints(e)}function gc(e){hu.call(this,e),this.uuid=di.generateUUID(),this.type="Shape",this.holes=[]}function cn(e,o){F.call(this),this.type="Light",this.color=new yt(e),this.intensity=o!==void 0?o:1,this.receiveShadow=void 0}function Fy(e,o,h){cn.call(this,e,h),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(F.DefaultUp),this.updateMatrix(),this.groundColor=new yt(o)}function al(e){this.camera=e,this.bias=0,this.radius=1,this.mapSize=new f(512,512),this.mapPass=this.map=null,this.matrix=new I,this._frustum=new ar,this._frameExtents=new f(1,1),this._viewportCount=1,this._viewports=[new p(0,0,1,1)]}function By(){al.call(this,new Ce(50,1,.5,500))}function Ny(e,o,h,m,_,T){cn.call(this,e,o),this.type="SpotLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(R){this.intensity=R/Math.PI}}),this.distance=h!==void 0?h:0,this.angle=m!==void 0?m:Math.PI/3,this.penumbra=_!==void 0?_:0,this.decay=T!==void 0?T:1,this.shadow=new By}function A2(){al.call(this,new Ce(90,1,.5,500)),this._frameExtents=new f(4,2),this._viewportCount=6,this._viewports=[new p(2,1,1,1),new p(0,1,1,1),new p(3,1,1,1),new p(1,1,1,1),new p(3,0,1,1),new p(1,0,1,1)],this._cubeDirections=[new w(1,0,0),new w(-1,0,0),new w(0,0,1),new w(0,0,-1),new w(0,1,0),new w(0,-1,0)],this._cubeUps=[new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,1,0),new w(0,0,1),new w(0,0,-1)]}function zy(e,o,h,m){cn.call(this,e,o),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(_){this.intensity=_/(4*Math.PI)}}),this.distance=h!==void 0?h:0,this.decay=m!==void 0?m:1,this.shadow=new A2}function og(e,o,h,m,_,T){le.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e!==void 0?e:-1,this.right=o!==void 0?o:1,this.top=h!==void 0?h:1,this.bottom=m!==void 0?m:-1,this.near=_!==void 0?_:.1,this.far=T!==void 0?T:2e3,this.updateProjectionMatrix()}function Uy(){al.call(this,new og(-5,5,5,-5,.5,500))}function Hy(e,o){cn.call(this,e,o),this.type="DirectionalLight",this.position.copy(F.DefaultUp),this.updateMatrix(),this.target=new F,this.shadow=new Uy}function ky(e,o){cn.call(this,e,o),this.type="AmbientLight",this.castShadow=void 0}function Gy(e,o,h,m){cn.call(this,e,o),this.type="RectAreaLight",this.width=h!==void 0?h:10,this.height=m!==void 0?m:10}function by(){this.coefficients=[];for(var e=0;9>e;e++)this.coefficients.push(new w)}function Ra(e,o){cn.call(this,void 0,o),this.type="LightProbe",this.sh=e!==void 0?e:new by}function Vy(e){Ki.call(this,e),this.textures={}}function Dv(){ct.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Wy(e,o,h,m){typeof h=="number"&&(m=h,h=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),ce.call(this,e,o,h),this.meshPerAttribute=m||1}function jy(e){Ki.call(this,e)}function Xy(e){Ki.call(this,e)}function _2(e){typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Ki.call(this,e),this.options=void 0}function w2(){this.type="ShapePath",this.color=new yt,this.subPaths=[],this.currentPath=null}function M2(e){this.type="Font",this.data=e}function C2(e){Ki.call(this,e)}function Yy(e){Ki.call(this,e)}function T2(e,o,h){Ra.call(this,void 0,h),e=new yt().set(e),h=new yt().set(o),o=new w(e.r,e.g,e.b),e=new w(h.r,h.g,h.b),h=Math.sqrt(Math.PI);var m=h*Math.sqrt(.75);this.sh.coefficients[0].copy(o).add(e).multiplyScalar(h),this.sh.coefficients[1].copy(o).sub(e).multiplyScalar(m)}function S2(e,o){Ra.call(this,void 0,o),e=new yt().set(e),this.sh.coefficients[0].set(e.r,e.g,e.b).multiplyScalar(2*Math.sqrt(Math.PI))}function Ww(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ce,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ce,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}function I2(e){this.autoStart=e!==void 0?e:!0,this.elapsedTime=this.oldTime=this.startTime=0,this.running=!1}function E2(){F.call(this),this.type="AudioListener",this.context=m_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new I2}function sg(e){F.call(this),this.type="Audio",this.listener=e,this.context=e.context,this.gain=this.context.createGain(),this.gain.connect(e.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.offset=this.loopEnd=this.loopStart=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this._progress=this._startedAt=0,this.filters=[]}function L2(e){sg.call(this,e),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}function R2(e,o){this.analyser=e.context.createAnalyser(),this.analyser.fftSize=o!==void 0?o:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),e.getOutput().connect(this.analyser)}function P2(e,o,h){switch(this.binding=e,this.valueSize=h,o){case"quaternion":e=this._slerp,o=this._slerpAdditive;var m=this._setAdditiveIdentityQuaternion;this.buffer=new Float64Array(6*h),this._workIndex=5;break;case"string":case"bool":o=e=this._select,m=this._setAdditiveIdentityOther,this.buffer=Array(5*h);break;default:e=this._lerp,o=this._lerpAdditive,m=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*h)}this._mixBufferRegion=e,this._mixBufferRegionAdditive=o,this._setIdentity=m,this._origIndex=3,this._addIndex=4,this.referenceCount=this.useCount=this.cumulativeWeightAdditive=this.cumulativeWeight=0}function jw(e,o,h){h=h||is.parseTrackName(o),this._targetGroup=e,this._bindings=e.subscribe_(o,h)}function is(e,o,h){this.path=o,this.parsedPath=h||is.parseTrackName(o),this.node=is.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}function Xw(){this.uuid=di.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var e={};this._indicesByUUID=e;for(var o=0,h=arguments.length;o!==h;++o)e[arguments[o].uuid]=o;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var m=this;this.stats={objects:{get total(){return m._objects.length},get inUse(){return this.total-m.nCachedObjects_}},get bindingsPerObject(){return m._bindings.length}}}function Yw(e,o,h,m){this._mixer=e,this._clip=o,this._localRoot=h||null,this.blendMode=m||o.blendMode,e=o.tracks,o=e.length,h=Array(o),m={endingStart:2400,endingEnd:2400};for(var _=0;_!==o;++_){var T=e[_].createInterpolant(null);h[_]=T,T.settings=m}this._interpolantSettings=m,this._interpolants=h,this._propertyBindings=Array(o),this._weightInterpolant=this._timeScaleInterpolant=this._byClipCacheIndex=this._cacheIndex=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this._effectiveWeight=this.weight=this._effectiveTimeScale=this.timeScale=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtEnd=this.zeroSlopeAtStart=!0}function D2(e){this._root=e,this._initMemoryManager(),this.time=this._accuIndex=0,this.timeScale=1}function Zy(e,o){typeof e=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),e=o),this.value=e}function O2(e,o,h){oh.call(this,e,o),this.meshPerAttribute=h||1}function F2(e,o,h,m){this.ray=new st(e,o),this.near=h||0,this.far=m||1/0,this.camera=null,this.layers=new P,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Gr(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Zw(e,o){return e.distance-o.distance}function B2(e,o,h,m){if(e.layers.test(o.layers)&&e.raycast(o,h),m===!0){e=e.children,m=0;for(var _=e.length;m<_;m++)B2(e[m],o,h,!0)}}function Jw(e,o,h){return this.radius=e!==void 0?e:1,this.phi=o!==void 0?o:0,this.theta=h!==void 0?h:0,this}function qw(e,o,h){return this.radius=e!==void 0?e:1,this.theta=o!==void 0?o:0,this.y=h!==void 0?h:0,this}function N2(e,o){this.min=e!==void 0?e:new f(1/0,1/0),this.max=o!==void 0?o:new f(-1/0,-1/0)}function z2(e,o){this.start=e!==void 0?e:new w,this.end=o!==void 0?o:new w}function Ov(e){F.call(this),this.material=e,this.render=function(){},this.hasUvs=this.hasColors=this.hasNormals=this.hasPositions=!1,this.uvArray=this.colorArray=this.normalArray=this.positionArray=null,this.count=0}function ag(e,o){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=o,e=new ct,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(var h=0,m=1;32>h;h++,m++){var _=h/32*Math.PI*2,T=m/32*Math.PI*2;o.push(Math.cos(_),Math.sin(_),1,Math.cos(T),Math.sin(T),1)}e.setAttribute("position",new mt(o,3)),o=new In({fog:!1,toneMapped:!1}),this.cone=new On(e,o),this.add(this.cone),this.update()}function Kw(e){var o=[];e&&e.isBone&&o.push(e);for(var h=0;h<e.children.length;h++)o.push.apply(o,Kw(e.children[h]));return o}function tp(e){for(var o=Kw(e),h=new ct,m=[],_=[],T=new yt(0,0,1),R=new yt(0,1,0),z=0;z<o.length;z++){var k=o[z];k.parent&&k.parent.isBone&&(m.push(0,0,0),m.push(0,0,0),_.push(T.r,T.g,T.b),_.push(R.r,R.g,R.b))}h.setAttribute("position",new mt(m,3)),h.setAttribute("color",new mt(_,3)),m=new In({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0}),On.call(this,h,m),this.type="SkeletonHelper",this.root=e,this.bones=o,this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1}function ug(e,o,h){this.light=e,this.light.updateMatrixWorld(),this.color=h,e=new Vf(o,4,2),o=new be({wireframe:!0,fog:!1,toneMapped:!1}),St.call(this,e,o),this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function lg(e,o,h){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=h,e=new kf(o),e.rotateY(.5*Math.PI),this.material=new be({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0),o=e.getAttribute("position"),o=new Float32Array(3*o.count),e.setAttribute("color",new ce(o,3)),this.add(new St(e,this.material)),this.update()}function Jy(e,o,h,m){e=e||10,o=o||10,h=new yt(h!==void 0?h:4473924),m=new yt(m!==void 0?m:8947848);var _=o/2,T=e/o,R=e/2;e=[];for(var z=[],k=0,b=0,q=-R;k<=o;k++,q+=T){e.push(-R,0,q,R,0,q),e.push(q,0,-R,q,0,R);var J=k===_?h:m;J.toArray(z,b),b+=3,J.toArray(z,b),b+=3,J.toArray(z,b),b+=3,J.toArray(z,b),b+=3}o=new ct,o.setAttribute("position",new mt(e,3)),o.setAttribute("color",new mt(z,3)),h=new In({vertexColors:!0,toneMapped:!1}),On.call(this,o,h),this.type="GridHelper"}function qy(e,o,h,m,_,T){e=e||10,o=o||16,h=h||8,m=m||64,_=new yt(_!==void 0?_:4473924),T=new yt(T!==void 0?T:8947848);var R=[],z=[],k;for(k=0;k<=o;k++){var b=k/o*2*Math.PI,q=Math.sin(b)*e;b=Math.cos(b)*e,R.push(0,0,0),R.push(q,0,b);var J=k&1?_:T;z.push(J.r,J.g,J.b),z.push(J.r,J.g,J.b)}for(k=0;k<=h;k++){J=k&1?_:T;var Q=e-e/h*k;for(o=0;o<m;o++)b=o/m*2*Math.PI,q=Math.sin(b)*Q,b=Math.cos(b)*Q,R.push(q,0,b),z.push(J.r,J.g,J.b),b=(o+1)/m*2*Math.PI,q=Math.sin(b)*Q,b=Math.cos(b)*Q,R.push(q,0,b),z.push(J.r,J.g,J.b)}e=new ct,e.setAttribute("position",new mt(R,3)),e.setAttribute("color",new mt(z,3)),R=new In({vertexColors:!0,toneMapped:!1}),On.call(this,e,R),this.type="PolarGridHelper"}function hg(e,o,h){F.call(this),this.light=e,this.light.updateMatrixWorld(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.color=h,o===void 0&&(o=1),e=new ct,e.setAttribute("position",new mt([-o,o,0,o,o,0,o,-o,0,-o,-o,0,-o,o,0],3)),o=new In({fog:!1,toneMapped:!1}),this.lightPlane=new ea(e,o),this.add(this.lightPlane),e=new ct,e.setAttribute("position",new mt([0,0,0,0,0,1],3)),this.targetLine=new ea(e,o),this.add(this.targetLine),this.update()}function Fv(e){function o(K,rt,lt){h(K,lt),h(rt,lt)}function h(K,rt){T.push(0,0,0),R.push(rt.r,rt.g,rt.b),z[K]===void 0&&(z[K]=[]),z[K].push(T.length/3-1)}var m=new ct,_=new In({color:16777215,vertexColors:!0,toneMapped:!1}),T=[],R=[],z={},k=new yt(16755200),b=new yt(16711680),q=new yt(43775),J=new yt(16777215),Q=new yt(3355443);o("n1","n2",k),o("n2","n4",k),o("n4","n3",k),o("n3","n1",k),o("f1","f2",k),o("f2","f4",k),o("f4","f3",k),o("f3","f1",k),o("n1","f1",k),o("n2","f2",k),o("n3","f3",k),o("n4","f4",k),o("p","n1",b),o("p","n2",b),o("p","n3",b),o("p","n4",b),o("u1","u2",q),o("u2","u3",q),o("u3","u1",q),o("c","t",J),o("p","c",Q),o("cn1","cn2",Q),o("cn3","cn4",Q),o("cf1","cf2",Q),o("cf3","cf4",Q),m.setAttribute("position",new mt(T,3)),m.setAttribute("color",new mt(R,3)),On.call(this,m,_),this.type="CameraHelper",this.camera=e,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=e.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=z,this.update()}function Jn(e,o,h,m,_,T,R){if(Tx.set(_,T,R).unproject(m),e=o[e],e!==void 0)for(h=h.getAttribute("position"),o=0,m=e.length;o<m;o++)h.setXYZ(e[o],Tx.x,Tx.y,Tx.z)}function lh(e,o){this.object=e,o===void 0&&(o=16776960),e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var h=new Float32Array(24),m=new ct;m.setIndex(new ce(e,1)),m.setAttribute("position",new ce(h,3)),On.call(this,m,new In({color:o,toneMapped:!1})),this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}function Bv(e,o){this.type="Box3Helper",this.box=e,o=o||16776960,e=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]);var h=new ct;h.setIndex(new ce(e,1)),h.setAttribute("position",new mt([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),On.call(this,h,new In({color:o,toneMapped:!1})),this.type="Box3Helper",this.geometry.computeBoundingSphere()}function Nv(e,o,h){this.plane=e,this.size=o===void 0?1:o,e=h!==void 0?h:16776960,o=new ct,o.setAttribute("position",new mt([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),o.computeBoundingSphere(),ea.call(this,o,new In({color:e,toneMapped:!1})),this.type="PlaneHelper",o=new ct,o.setAttribute("position",new mt([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),o.computeBoundingSphere(),this.add(new St(o,new be({color:e,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}function hh(e,o,h,m,_,T){F.call(this),this.type="ArrowHelper",e===void 0&&(e=new w(0,0,1)),o===void 0&&(o=new w(0,0,0)),h===void 0&&(h=1),m===void 0&&(m=16776960),_===void 0&&(_=.2*h),T===void 0&&(T=.2*_),Ix===void 0&&(Ix=new ct,Ix.setAttribute("position",new mt([0,0,0,0,1,0],3)),y_=new sh(0,.5,1,5,1),y_.translate(0,-.5,0)),this.position.copy(o),this.line=new ea(Ix,new In({color:m,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new St(y_,new be({color:m,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(e),this.setLength(h,_,T)}function zv(e){e=e||1;var o=[0,0,0,e,0,0,0,0,0,0,e,0,0,0,0,0,0,e];e=new ct,e.setAttribute("position",new mt(o,3)),e.setAttribute("color",new mt([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3)),o=new In({vertexColors:!0,toneMapped:!1}),On.call(this,e,o),this.type="AxesHelper"}function U2(e){this._renderer=e,this._pingPongRenderTarget=null,e=new Float32Array(20);var o=new w(0,1,0);e=new ah({defines:{n:20},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:e},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o},inputEncoding:{value:fl[3e3]},outputEncoding:{value:fl[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform int samples;
uniform float weights[n];
uniform bool latitudinal;
uniform float dTheta;
uniform float mipInt;
uniform vec3 poleAxis;

`+G2()+`

#define ENVMAP_TYPE_CUBE_UV
#include <cube_uv_reflection_fragment>

vec3 getSample(float theta, vec3 axis) {
	float cosTheta = cos(theta);
	// Rodrigues' axis-angle rotation
	vec3 sampleDirection = vOutputDirection * cosTheta
		+ cross(axis, vOutputDirection) * sin(theta)
		+ axis * dot(axis, vOutputDirection) * (1.0 - cosTheta);
	return bilinearCubeUV(envMap, sampleDirection, mipInt);
}

void main() {
	vec3 axis = latitudinal ? poleAxis : cross(poleAxis, vOutputDirection);
	if (all(equal(axis, vec3(0.0))))
		axis = vec3(vOutputDirection.z, 0.0, - vOutputDirection.x);
	axis = normalize(axis);
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb += weights[0] * getSample(0.0, axis);
	for (int i = 1; i < n; i++) {
		if (i >= samples)
			break;
		float theta = dTheta * float(i);
		gl_FragColor.rgb += weights[i] * getSample(-1.0 * theta, axis);
		gl_FragColor.rgb += weights[i] * getSample(theta, axis);
	}
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="SphericalGaussianBlur",this._blurMaterial=e,this._cubemapShader=this._equirectShader=null,this._compileMaterial(this._blurMaterial)}function Qw(e){return e=new A(3*cl,3*cl,e),e.texture.mapping=306,e.texture.name="PMREM.cubeUv",e.scissorTest=!0,e}function H2(e,o,h,m,_){e.viewport.set(o,h,m,_),e.scissor.set(o,h,m,_)}function $w(){var e=new f(1,1);return e=new ah({uniforms:{envMap:{value:null},texelSize:{value:e},inputEncoding:{value:fl[3e3]},outputEncoding:{value:fl[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform sampler2D envMap;
uniform vec2 texelSize;

`+G2()+`

#include <common>

void main() {
	gl_FragColor = vec4(0.0);
	vec3 outputDirection = normalize(vOutputDirection);
	vec2 uv = equirectUv( outputDirection );
	vec2 f = fract(uv / texelSize - 0.5);
	uv -= f * texelSize;
	vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x += texelSize.x;
	vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.y += texelSize.y;
	vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	uv.x -= texelSize.x;
	vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
	vec3 tm = mix(tl, tr, f.x);
	vec3 bm = mix(bl, br, f.x);
	gl_FragColor.rgb = mix(tm, bm, f.y);
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1}),e.type="EquirectangularToCubeUV",e}function tM(){var e=new ah({uniforms:{envMap:{value:null},inputEncoding:{value:fl[3e3]},outputEncoding:{value:fl[3e3]}},vertexShader:k2(),fragmentShader:`
precision mediump float;
precision mediump int;
varying vec3 vOutputDirection;
uniform samplerCube envMap;

`+G2()+`

void main() {
	gl_FragColor = vec4(0.0);
	gl_FragColor.rgb = envMapTexelToLinear(textureCube(envMap, vec3( - vOutputDirection.x, vOutputDirection.yz ))).rgb;
	gl_FragColor = linearToOutputTexel(gl_FragColor);
}
		`,blending:0,depthTest:!1,depthWrite:!1});return e.type="CubemapToCubeUV",e}function k2(){return`
precision mediump float;
precision mediump int;
attribute vec3 position;
attribute vec2 uv;
attribute float faceIndex;
varying vec3 vOutputDirection;

// RH coordinate system; PMREM face-indexing convention
vec3 getDirection(vec2 uv, float face) {
	uv = 2.0 * uv - 1.0;
	vec3 direction = vec3(uv, 1.0);
	if (face == 0.0) {
		direction = direction.zyx; // ( 1, v, u ) pos x
	} else if (face == 1.0) {
		direction = direction.xzy;
		direction.xz *= -1.0; // ( -u, 1, -v ) pos y
	} else if (face == 2.0) {
		direction.x *= -1.0; // ( -u, v, 1 ) pos z
	} else if (face == 3.0) {
		direction = direction.zyx;
		direction.xz *= -1.0; // ( -1, v, -u ) neg x
	} else if (face == 4.0) {
		direction = direction.xzy;
		direction.xy *= -1.0; // ( -u, -1, v ) neg y
	} else if (face == 5.0) {
		direction.z *= -1.0; // ( u, v, -1 ) neg z
	}
	return direction;
}

void main() {
	vOutputDirection = getDirection(uv, faceIndex);
	gl_Position = vec4( position, 1.0 );
}
	`}function G2(){return`
uniform int inputEncoding;
uniform int outputEncoding;

#include <encodings_pars_fragment>

vec4 inputTexelToLinear(vec4 value){
	if(inputEncoding == 0){
		return value;
	}else if(inputEncoding == 1){
		return sRGBToLinear(value);
	}else if(inputEncoding == 2){
		return RGBEToLinear(value);
	}else if(inputEncoding == 3){
		return RGBMToLinear(value, 7.0);
	}else if(inputEncoding == 4){
		return RGBMToLinear(value, 16.0);
	}else if(inputEncoding == 5){
		return RGBDToLinear(value, 256.0);
	}else{
		return GammaToLinear(value, 2.2);
	}
}

vec4 linearToOutputTexel(vec4 value){
	if(outputEncoding == 0){
		return value;
	}else if(outputEncoding == 1){
		return LinearTosRGB(value);
	}else if(outputEncoding == 2){
		return LinearToRGBE(value);
	}else if(outputEncoding == 3){
		return LinearToRGBM(value, 7.0);
	}else if(outputEncoding == 4){
		return LinearToRGBM(value, 16.0);
	}else if(outputEncoding == 5){
		return LinearToRGBD(value, 256.0);
	}else{
		return LinearToGamma(value, 2.2);
	}
}

vec4 envMapTexelToLinear(vec4 color) {
	return inputTexelToLinear(color);
}
	`}function eM(e){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),rs.call(this,e),this.type="catmullrom",this.closed=!0}function rM(e){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),rs.call(this,e),this.type="catmullrom"}function b2(e){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),rs.call(this,e),this.type="catmullrom"}hn===void 0&&(Number.EPSILON=Math.pow(2,-52)),Jh===void 0&&(Number.isInteger=function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}),Zu===void 0&&(Math.sign=function(e){return 0>e?-1:0<e?1:+e}),!("name"in Function.prototype)&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),ut===void 0&&(Object.assign=function(e){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var o=Object(e),h=1;h<arguments.length;h++){var m=arguments[h];if(m!=null)for(var _ in m)Object.prototype.hasOwnProperty.call(m,_)&&(o[_]=m[_])}return o}),ut(s.prototype,{addEventListener:function(e,o){this._listeners===void 0&&(this._listeners={});var h=this._listeners;h[e]===void 0&&(h[e]=[]),h[e].indexOf(o)===-1&&h[e].push(o)},hasEventListener:function(e,o){if(this._listeners===void 0)return!1;var h=this._listeners;return h[e]!==void 0&&h[e].indexOf(o)!==-1},removeEventListener:function(e,o){this._listeners!==void 0&&(e=this._listeners[e],e!==void 0&&(o=e.indexOf(o),o!==-1&&e.splice(o,1)))},dispatchEvent:function(e){if(this._listeners!==void 0){var o=this._listeners[e.type];if(o!==void 0){e.target=this,o=o.slice(0);for(var h=0,m=o.length;h<m;h++)o[h].call(this,e)}}}});for(var zo=[],Uv=0;256>Uv;Uv++)zo[Uv]=(16>Uv?"0":"")+Uv.toString(16);var di={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,o=4294967295*Math.random()|0,h=4294967295*Math.random()|0,m=4294967295*Math.random()|0;return(zo[e&255]+zo[e>>8&255]+zo[e>>16&255]+zo[e>>24&255]+"-"+zo[o&255]+zo[o>>8&255]+"-"+zo[o>>16&15|64]+zo[o>>24&255]+"-"+zo[h&63|128]+zo[h>>8&255]+"-"+zo[h>>16&255]+zo[h>>24&255]+zo[m&255]+zo[m>>8&255]+zo[m>>16&255]+zo[m>>24&255]).toUpperCase()},clamp:function(e,o,h){return Math.max(o,Math.min(h,e))},euclideanModulo:function(e,o){return(e%o+o)%o},mapLinear:function(e,o,h,m,_){return m+(e-o)*(_-m)/(h-o)},lerp:function(e,o,h){return(1-h)*e+h*o},smoothstep:function(e,o,h){return e<=o?0:e>=h?1:(e=(e-o)/(h-o),e*e*(3-2*e))},smootherstep:function(e,o,h){return e<=o?0:e>=h?1:(e=(e-o)/(h-o),e*e*e*(e*(6*e-15)+10))},randInt:function(e,o){return e+Math.floor(Math.random()*(o-e+1))},randFloat:function(e,o){return e+Math.random()*(o-e)},randFloatSpread:function(e){return e*(.5-Math.random())},degToRad:function(e){return e*di.DEG2RAD},radToDeg:function(e){return e*di.RAD2DEG},isPowerOfTwo:function(e){return(e&e-1)===0&&e!==0},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(e,o,h,m,_){var T=Math.cos,R=Math.sin,z=T(h/2);h=R(h/2);var k=T((o+m)/2),b=R((o+m)/2),q=T((o-m)/2),J=R((o-m)/2);switch(T=T((m-o)/2),o=R((m-o)/2),_){case"XYX":e.set(z*b,h*q,h*J,z*k);break;case"YZY":e.set(h*J,z*b,h*q,z*k);break;case"ZXZ":e.set(h*q,h*J,z*b,z*k);break;case"XZX":e.set(z*b,h*o,h*T,z*k);break;case"YXY":e.set(h*T,z*b,h*o,z*k);break;case"ZYZ":e.set(h*o,h*T,z*b,z*k);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+_)}}};Gr(f.prototype,{width:{get:function(){return this.x},set:function(e){this.x=e}},height:{get:function(){return this.y},set:function(e){this.y=e}}}),ut(f.prototype,{isVector2:!0,set:function(e,o){return this.x=e,this.y=o,this},setScalar:function(e){return this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(e){return this.x=e.x,this.y=e.y,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this)},addScalar:function(e){return this.x+=e,this.y+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this)},subScalar:function(e){return this.x-=e,this.y-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this},multiply:function(e){return this.x*=e.x,this.y*=e.y,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this},divide:function(e){return this.x/=e.x,this.y/=e.y,this},divideScalar:function(e){return this.multiplyScalar(1/e)},applyMatrix3:function(e){var o=this.x,h=this.y;return e=e.elements,this.x=e[0]*o+e[3]*h+e[6],this.y=e[1]*o+e[4]*h+e[7],this},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(e){return this.x*e.x+this.y*e.y},cross:function(e){return this.x*e.y-this.y*e.x},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){return Math.atan2(-this.y,-this.x)+Math.PI},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var o=this.x-e.x;return e=this.y-e.y,o*o+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this},equals:function(e){return e.x===this.x&&e.y===this.y},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this},rotateAround:function(e,o){var h=Math.cos(o);o=Math.sin(o);var m=this.x-e.x,_=this.y-e.y;return this.x=m*h-_*o+e.x,this.y=m*o+_*h+e.y,this},random:function(){return this.x=Math.random(),this.y=Math.random(),this}}),ut(c.prototype,{isMatrix3:!0,set:function(e,o,h,m,_,T,R,z,k){var b=this.elements;return b[0]=e,b[1]=m,b[2]=R,b[3]=o,b[4]=_,b[5]=z,b[6]=h,b[7]=T,b[8]=k,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return new this.constructor().fromArray(this.elements)},copy:function(e){var o=this.elements;return e=e.elements,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],this},extractBasis:function(e,o,h){return e.setFromMatrix3Column(this,0),o.setFromMatrix3Column(this,1),h.setFromMatrix3Column(this,2),this},setFromMatrix4:function(e){return e=e.elements,this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},multiply:function(e){return this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,o){var h=e.elements,m=o.elements;o=this.elements,e=h[0];var _=h[3],T=h[6],R=h[1],z=h[4],k=h[7],b=h[2],q=h[5];h=h[8];var J=m[0],Q=m[3],K=m[6],rt=m[1],lt=m[4],Bt=m[7],Zt=m[2],bt=m[5];return m=m[8],o[0]=e*J+_*rt+T*Zt,o[3]=e*Q+_*lt+T*bt,o[6]=e*K+_*Bt+T*m,o[1]=R*J+z*rt+k*Zt,o[4]=R*Q+z*lt+k*bt,o[7]=R*K+z*Bt+k*m,o[2]=b*J+q*rt+h*Zt,o[5]=b*Q+q*lt+h*bt,o[8]=b*K+q*Bt+h*m,this},multiplyScalar:function(e){var o=this.elements;return o[0]*=e,o[3]*=e,o[6]*=e,o[1]*=e,o[4]*=e,o[7]*=e,o[2]*=e,o[5]*=e,o[8]*=e,this},determinant:function(){var e=this.elements,o=e[0],h=e[1],m=e[2],_=e[3],T=e[4],R=e[5],z=e[6],k=e[7];return e=e[8],o*T*e-o*R*k-h*_*e+h*R*z+m*_*k-m*T*z},getInverse:function(e,o){o!==void 0&&console.warn("THREE.Matrix3: .getInverse() can no longer be configured to throw on degenerate.");var h=e.elements;e=this.elements,o=h[0];var m=h[1],_=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7];h=h[8];var q=h*R-z*b,J=z*k-h*T,Q=b*T-R*k,K=o*q+m*J+_*Q;return K===0?this.set(0,0,0,0,0,0,0,0,0):(K=1/K,e[0]=q*K,e[1]=(_*b-h*m)*K,e[2]=(z*m-_*R)*K,e[3]=J*K,e[4]=(h*o-_*k)*K,e[5]=(_*T-z*o)*K,e[6]=Q*K,e[7]=(m*k-b*o)*K,e[8]=(R*o-m*T)*K,this)},transpose:function(){var e=this.elements,o=e[1];return e[1]=e[3],e[3]=o,o=e[2],e[2]=e[6],e[6]=o,o=e[5],e[5]=e[7],e[7]=o,this},getNormalMatrix:function(e){return this.setFromMatrix4(e).getInverse(this).transpose()},transposeIntoArray:function(e){var o=this.elements;return e[0]=o[0],e[1]=o[3],e[2]=o[6],e[3]=o[1],e[4]=o[4],e[5]=o[7],e[6]=o[2],e[7]=o[5],e[8]=o[8],this},setUvTransform:function(e,o,h,m,_,T,R){var z=Math.cos(_);_=Math.sin(_),this.set(h*z,h*_,-h*(z*T+_*R)+T+e,-m*_,m*z,-m*(-_*T+z*R)+R+o,0,0,1)},scale:function(e,o){var h=this.elements;return h[0]*=e,h[3]*=e,h[6]*=e,h[1]*=o,h[4]*=o,h[7]*=o,this},rotate:function(e){var o=Math.cos(e);e=Math.sin(e);var h=this.elements,m=h[0],_=h[3],T=h[6],R=h[1],z=h[4],k=h[7];return h[0]=o*m+e*R,h[3]=o*_+e*z,h[6]=o*T+e*k,h[1]=-e*m+o*R,h[4]=-e*_+o*z,h[7]=-e*T+o*k,this},translate:function(e,o){var h=this.elements;return h[0]+=e*h[2],h[3]+=e*h[5],h[6]+=e*h[8],h[1]+=o*h[2],h[4]+=o*h[5],h[7]+=o*h[8],this},equals:function(e){var o=this.elements;e=e.elements;for(var h=0;9>h;h++)if(o[h]!==e[h])return!1;return!0},fromArray:function(e,o){o===void 0&&(o=0);for(var h=0;9>h;h++)this.elements[h]=e[h+o];return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);var h=this.elements;return e[o]=h[0],e[o+1]=h[1],e[o+2]=h[2],e[o+3]=h[3],e[o+4]=h[4],e[o+5]=h[5],e[o+6]=h[6],e[o+7]=h[7],e[o+8]=h[8],e}});var cg,mc={getDataURL:function(e){if(typeof HTMLCanvasElement=="undefined")return e.src;if(!(e instanceof HTMLCanvasElement)){cg===void 0&&(cg=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),cg.width=e.width,cg.height=e.height;var o=cg.getContext("2d");e instanceof ImageData?o.putImageData(e,0,0):o.drawImage(e,0,0,e.width,e.height),e=cg}return 2048<e.width||2048<e.height?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}},V3=0;g.DEFAULT_IMAGE=void 0,g.DEFAULT_MAPPING=300,g.prototype=ut(at(s.prototype),{constructor:g,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.name=e.name,this.image=e.image,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.encoding=e.encoding,this},toJSON:function(e){var o=e===void 0||typeof e=="string";if(!o&&e.textures[this.uuid]!==void 0)return e.textures[this.uuid];var h={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){var m=this.image;if(m.uuid===void 0&&(m.uuid=di.generateUUID()),!o&&e.images[m.uuid]===void 0){if(Array.isArray(m))for(var _=[],T=0,R=m.length;T<R;T++)_.push(mc.getDataURL(m[T]));else _=mc.getDataURL(m);e.images[m.uuid]={uuid:m.uuid,url:_}}h.image=m.uuid}return o||(e.textures[this.uuid]=h),h},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(e){if(this.mapping!==300)return e;if(e.applyMatrix3(this.matrix),0>e.x||1<e.x)switch(this.wrapS){case 1e3:e.x-=Math.floor(e.x);break;case 1001:e.x=0>e.x?0:1;break;case 1002:e.x=Math.abs(Math.floor(e.x)%2)===1?Math.ceil(e.x)-e.x:e.x-Math.floor(e.x)}if(0>e.y||1<e.y)switch(this.wrapT){case 1e3:e.y-=Math.floor(e.y);break;case 1001:e.y=0>e.y?0:1;break;case 1002:e.y=Math.abs(Math.floor(e.y)%2)===1?Math.ceil(e.y)-e.y:e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}}),Object.defineProperty(g.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),Gr(p.prototype,{width:{get:function(){return this.z},set:function(e){this.z=e}},height:{get:function(){return this.w},set:function(e){this.w=e}}}),ut(p.prototype,{isVector4:!0,set:function(e,o,h,m){return this.x=e,this.y=o,this.z=h,this.w=m,this},setScalar:function(e){return this.w=this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setW:function(e){return this.w=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;case 3:this.w=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w!==void 0?e.w:1,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this.z=e.z+o.z,this.w=e.w+o.w,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this.z+=e.z*o,this.w+=e.w*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this.z=e.z-o.z,this.w=e.w-o.w,this},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this},applyMatrix4:function(e){var o=this.x,h=this.y,m=this.z,_=this.w;return e=e.elements,this.x=e[0]*o+e[4]*h+e[8]*m+e[12]*_,this.y=e[1]*o+e[5]*h+e[9]*m+e[13]*_,this.z=e[2]*o+e[6]*h+e[10]*m+e[14]*_,this.w=e[3]*o+e[7]*h+e[11]*m+e[15]*_,this},divideScalar:function(e){return this.multiplyScalar(1/e)},setAxisAngleFromQuaternion:function(e){this.w=2*Math.acos(e.w);var o=Math.sqrt(1-e.w*e.w);return 1e-4>o?(this.x=1,this.z=this.y=0):(this.x=e.x/o,this.y=e.y/o,this.z=e.z/o),this},setAxisAngleFromRotationMatrix:function(e){e=e.elements;var o=e[0],h=e[4],m=e[8],_=e[1],T=e[5],R=e[9],z=e[2],k=e[6],b=e[10];return .01>Math.abs(h-_)&&.01>Math.abs(m-z)&&.01>Math.abs(R-k)?.1>Math.abs(h+_)&&.1>Math.abs(m+z)&&.1>Math.abs(R+k)&&.1>Math.abs(o+T+b-3)?(this.set(1,0,0,0),this):(e=Math.PI,o=(o+1)/2,T=(T+1)/2,b=(b+1)/2,h=(h+_)/4,m=(m+z)/4,R=(R+k)/4,o>T&&o>b?.01>o?(k=0,h=z=.707106781):(k=Math.sqrt(o),z=h/k,h=m/k):T>b?.01>T?(k=.707106781,z=0,h=.707106781):(z=Math.sqrt(T),k=h/z,h=R/z):.01>b?(z=k=.707106781,h=0):(h=Math.sqrt(b),k=m/h,z=R/h),this.set(k,z,h,e),this):(e=Math.sqrt((k-R)*(k-R)+(m-z)*(m-z)+(_-h)*(_-h)),.001>Math.abs(e)&&(e=1),this.x=(k-R)/e,this.y=(m-z)/e,this.z=(_-h)/e,this.w=Math.acos((o+T+b-1)/2),this)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this.z=Math.max(e.z,Math.min(o.z,this.z)),this.w=Math.max(e.w,Math.min(o.w,this.w)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this.z=Math.max(e,Math.min(o,this.z)),this.w=Math.max(e,Math.min(o,this.w)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this.w=0>this.w?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this.z+=(e.z-this.z)*o,this.w+=(e.w-this.w)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this.z=e.z+(o.z-e.z)*h,this.w=e.w+(o.w-e.w)*h,this},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this.z=e[o+2],this.w=e[o+3],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e[o+2]=this.z,e[o+3]=this.w,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this.z=e.getZ(o),this.w=e.getW(o),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}),A.prototype=ut(at(s.prototype),{constructor:A,isWebGLRenderTarget:!0,setSize:function(e,o){(this.width!==e||this.height!==o)&&(this.width=e,this.height=o,this.texture.image.width=e,this.texture.image.height=o,this.dispose()),this.viewport.set(0,0,e,o),this.scissor.set(0,0,e,o)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.width=e.width,this.height=e.height,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,this.depthTexture=e.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),S.prototype=ut(at(A.prototype),{constructor:S,isWebGLMultisampleRenderTarget:!0,copy:function(e){return A.prototype.copy.call(this,e),this.samples=e.samples,this}}),ut(N,{slerp:function(e,o,h,m){return h.copy(e).slerp(o,m)},slerpFlat:function(e,o,h,m,_,T,R){var z=h[m+0],k=h[m+1],b=h[m+2];h=h[m+3],m=_[T+0];var q=_[T+1],J=_[T+2];if(_=_[T+3],h!==_||z!==m||k!==q||b!==J){T=1-R;var Q=z*m+k*q+b*J+h*_,K=0<=Q?1:-1,rt=1-Q*Q;rt>hn&&(rt=Math.sqrt(rt),Q=Math.atan2(rt,Q*K),T=Math.sin(T*Q)/rt,R=Math.sin(R*Q)/rt),K*=R,z=z*T+m*K,k=k*T+q*K,b=b*T+J*K,h=h*T+_*K,T===1-R&&(R=1/Math.sqrt(z*z+k*k+b*b+h*h),z*=R,k*=R,b*=R,h*=R)}e[o]=z,e[o+1]=k,e[o+2]=b,e[o+3]=h},multiplyQuaternionsFlat:function(e,o,h,m,_,T){var R=h[m],z=h[m+1],k=h[m+2];h=h[m+3],m=_[T];var b=_[T+1],q=_[T+2];return _=_[T+3],e[o]=R*_+h*m+z*q-k*b,e[o+1]=z*_+h*b+k*m-R*q,e[o+2]=k*_+h*q+R*b-z*m,e[o+3]=h*_-R*m-z*b-k*q,e}}),Gr(N.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},w:{get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}}}),ut(N.prototype,{isQuaternion:!0,set:function(e,o,h,m){return this._x=e,this._y=o,this._z=h,this._w=m,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this},setFromEuler:function(e,o){if(!e||!e.isEuler)throw Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var h=e._x,m=e._y,_=e._z;e=e.order;var T=Math.cos,R=Math.sin,z=T(h/2),k=T(m/2);switch(T=T(_/2),h=R(h/2),m=R(m/2),_=R(_/2),e){case"XYZ":this._x=h*k*T+z*m*_,this._y=z*m*T-h*k*_,this._z=z*k*_+h*m*T,this._w=z*k*T-h*m*_;break;case"YXZ":this._x=h*k*T+z*m*_,this._y=z*m*T-h*k*_,this._z=z*k*_-h*m*T,this._w=z*k*T+h*m*_;break;case"ZXY":this._x=h*k*T-z*m*_,this._y=z*m*T+h*k*_,this._z=z*k*_+h*m*T,this._w=z*k*T-h*m*_;break;case"ZYX":this._x=h*k*T-z*m*_,this._y=z*m*T+h*k*_,this._z=z*k*_-h*m*T,this._w=z*k*T+h*m*_;break;case"YZX":this._x=h*k*T+z*m*_,this._y=z*m*T+h*k*_,this._z=z*k*_-h*m*T,this._w=z*k*T-h*m*_;break;case"XZY":this._x=h*k*T-z*m*_,this._y=z*m*T-h*k*_,this._z=z*k*_+h*m*T,this._w=z*k*T+h*m*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+e)}return o!==!1&&this._onChangeCallback(),this},setFromAxisAngle:function(e,o){o/=2;var h=Math.sin(o);return this._x=e.x*h,this._y=e.y*h,this._z=e.z*h,this._w=Math.cos(o),this._onChangeCallback(),this},setFromRotationMatrix:function(e){var o=e.elements,h=o[0];e=o[4];var m=o[8],_=o[1],T=o[5],R=o[9],z=o[2],k=o[6];o=o[10];var b=h+T+o;return 0<b?(h=.5/Math.sqrt(b+1),this._w=.25/h,this._x=(k-R)*h,this._y=(m-z)*h,this._z=(_-e)*h):h>T&&h>o?(h=2*Math.sqrt(1+h-T-o),this._w=(k-R)/h,this._x=.25*h,this._y=(e+_)/h,this._z=(m+z)/h):T>o?(h=2*Math.sqrt(1+T-h-o),this._w=(m-z)/h,this._x=(e+_)/h,this._y=.25*h,this._z=(R+k)/h):(h=2*Math.sqrt(1+o-h-T),this._w=(_-e)/h,this._x=(m+z)/h,this._y=(R+k)/h,this._z=.25*h),this._onChangeCallback(),this},setFromUnitVectors:function(e,o){var h=e.dot(o)+1;return 1e-6>h?(h=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*o.z-e.z*o.y,this._y=e.z*o.x-e.x*o.z,this._z=e.x*o.y-e.y*o.x),this._w=h,this.normalize()},angleTo:function(e){return 2*Math.acos(Math.abs(di.clamp(this.dot(e),-1,1)))},rotateTowards:function(e,o){var h=this.angleTo(e);return h===0?this:(this.slerp(e,Math.min(1,o/h)),this)},inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this},dot:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var e=this.length();return e===0?(this._z=this._y=this._x=0,this._w=1):(e=1/e,this._x*=e,this._y*=e,this._z*=e,this._w*=e),this._onChangeCallback(),this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(e,o)):this.multiplyQuaternions(this,e)},premultiply:function(e){return this.multiplyQuaternions(e,this)},multiplyQuaternions:function(e,o){var h=e._x,m=e._y,_=e._z;e=e._w;var T=o._x,R=o._y,z=o._z;return o=o._w,this._x=h*o+e*T+m*z-_*R,this._y=m*o+e*R+_*T-h*z,this._z=_*o+e*z+h*R-m*T,this._w=e*o-h*T-m*R-_*z,this._onChangeCallback(),this},slerp:function(e,o){if(o===0)return this;if(o===1)return this.copy(e);var h=this._x,m=this._y,_=this._z,T=this._w,R=T*e._w+h*e._x+m*e._y+_*e._z;if(0>R?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,R=-R):this.copy(e),1<=R)return this._w=T,this._x=h,this._y=m,this._z=_,this;if(e=1-R*R,e<=hn)return R=1-o,this._w=R*T+o*this._w,this._x=R*h+o*this._x,this._y=R*m+o*this._y,this._z=R*_+o*this._z,this.normalize(),this._onChangeCallback(),this;e=Math.sqrt(e);var z=Math.atan2(e,R);return R=Math.sin((1-o)*z)/e,o=Math.sin(o*z)/e,this._w=T*R+this._w*o,this._x=h*R+this._x*o,this._y=m*R+this._y*o,this._z=_*R+this._z*o,this._onChangeCallback(),this},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w},fromArray:function(e,o){return o===void 0&&(o=0),this._x=e[o],this._y=e[o+1],this._z=e[o+2],this._w=e[o+3],this._onChangeCallback(),this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this._x,e[o+1]=this._y,e[o+2]=this._z,e[o+3]=this._w,e},fromBufferAttribute:function(e,o){return this._x=e.getX(o),this._y=e.getY(o),this._z=e.getZ(o),this._w=e.getW(o),this},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}});var V2=new w,iM=new N;ut(w.prototype,{isVector3:!0,set:function(e,o,h){return this.x=e,this.y=o,this.z=h,this},setScalar:function(e){return this.z=this.y=this.x=e,this},setX:function(e){return this.x=e,this},setY:function(e){return this.y=e,this},setZ:function(e){return this.z=e,this},setComponent:function(e,o){switch(e){case 0:this.x=o;break;case 1:this.y=o;break;case 2:this.z=o;break;default:throw Error("index is out of range: "+e)}return this},getComponent:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this},add:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,o)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)},addScalar:function(e){return this.x+=e,this.y+=e,this.z+=e,this},addVectors:function(e,o){return this.x=e.x+o.x,this.y=e.y+o.y,this.z=e.z+o.z,this},addScaledVector:function(e,o){return this.x+=e.x*o,this.y+=e.y*o,this.z+=e.z*o,this},sub:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,o)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)},subScalar:function(e){return this.x-=e,this.y-=e,this.z-=e,this},subVectors:function(e,o){return this.x=e.x-o.x,this.y=e.y-o.y,this.z=e.z-o.z,this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,o)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)},multiplyScalar:function(e){return this.x*=e,this.y*=e,this.z*=e,this},multiplyVectors:function(e,o){return this.x=e.x*o.x,this.y=e.y*o.y,this.z=e.z*o.z,this},applyEuler:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(iM.setFromEuler(e))},applyAxisAngle:function(e,o){return this.applyQuaternion(iM.setFromAxisAngle(e,o))},applyMatrix3:function(e){var o=this.x,h=this.y,m=this.z;return e=e.elements,this.x=e[0]*o+e[3]*h+e[6]*m,this.y=e[1]*o+e[4]*h+e[7]*m,this.z=e[2]*o+e[5]*h+e[8]*m,this},applyNormalMatrix:function(e){return this.applyMatrix3(e).normalize()},applyMatrix4:function(e){var o=this.x,h=this.y,m=this.z;e=e.elements;var _=1/(e[3]*o+e[7]*h+e[11]*m+e[15]);return this.x=(e[0]*o+e[4]*h+e[8]*m+e[12])*_,this.y=(e[1]*o+e[5]*h+e[9]*m+e[13])*_,this.z=(e[2]*o+e[6]*h+e[10]*m+e[14])*_,this},applyQuaternion:function(e){var o=this.x,h=this.y,m=this.z,_=e.x,T=e.y,R=e.z;e=e.w;var z=e*o+T*m-R*h,k=e*h+R*o-_*m,b=e*m+_*h-T*o;return o=-_*o-T*h-R*m,this.x=z*e+o*-_+k*-R-b*-T,this.y=k*e+o*-T+b*-_-z*-R,this.z=b*e+o*-R+z*-T-k*-_,this},project:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)},unproject:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)},transformDirection:function(e){var o=this.x,h=this.y,m=this.z;return e=e.elements,this.x=e[0]*o+e[4]*h+e[8]*m,this.y=e[1]*o+e[5]*h+e[9]*m,this.z=e[2]*o+e[6]*h+e[10]*m,this.normalize()},divide:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this},divideScalar:function(e){return this.multiplyScalar(1/e)},min:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this},max:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this},clamp:function(e,o){return this.x=Math.max(e.x,Math.min(o.x,this.x)),this.y=Math.max(e.y,Math.min(o.y,this.y)),this.z=Math.max(e.z,Math.min(o.z,this.z)),this},clampScalar:function(e,o){return this.x=Math.max(e,Math.min(o,this.x)),this.y=Math.max(e,Math.min(o,this.y)),this.z=Math.max(e,Math.min(o,this.z)),this},clampLength:function(e,o){var h=this.length();return this.divideScalar(h||1).multiplyScalar(Math.max(e,Math.min(o,h)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=0>this.x?Math.ceil(this.x):Math.floor(this.x),this.y=0>this.y?Math.ceil(this.y):Math.floor(this.y),this.z=0>this.z?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(e){return this.x*e.x+this.y*e.y+this.z*e.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(e){return this.normalize().multiplyScalar(e)},lerp:function(e,o){return this.x+=(e.x-this.x)*o,this.y+=(e.y-this.y)*o,this.z+=(e.z-this.z)*o,this},lerpVectors:function(e,o,h){return this.x=e.x+(o.x-e.x)*h,this.y=e.y+(o.y-e.y)*h,this.z=e.z+(o.z-e.z)*h,this},cross:function(e,o){return o!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,o)):this.crossVectors(this,e)},crossVectors:function(e,o){var h=e.x,m=e.y;e=e.z;var _=o.x,T=o.y;return o=o.z,this.x=m*o-e*T,this.y=e*_-h*o,this.z=h*T-m*_,this},projectOnVector:function(e){var o=e.lengthSq();return o===0?this.set(0,0,0):(o=e.dot(this)/o,this.copy(e).multiplyScalar(o))},projectOnPlane:function(e){return V2.copy(this).projectOnVector(e),this.sub(V2)},reflect:function(e){return this.sub(V2.copy(e).multiplyScalar(2*this.dot(e)))},angleTo:function(e){var o=Math.sqrt(this.lengthSq()*e.lengthSq());return o===0?Math.PI/2:(e=this.dot(e)/o,Math.acos(di.clamp(e,-1,1)))},distanceTo:function(e){return Math.sqrt(this.distanceToSquared(e))},distanceToSquared:function(e){var o=this.x-e.x,h=this.y-e.y;return e=this.z-e.z,o*o+h*h+e*e},manhattanDistanceTo:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)},setFromSpherical:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)},setFromSphericalCoords:function(e,o,h){var m=Math.sin(o)*e;return this.x=m*Math.sin(h),this.y=Math.cos(o)*e,this.z=m*Math.cos(h),this},setFromCylindrical:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)},setFromCylindricalCoords:function(e,o,h){return this.x=e*Math.sin(o),this.y=h,this.z=e*Math.cos(o),this},setFromMatrixPosition:function(e){return e=e.elements,this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(e){var o=this.setFromMatrixColumn(e,0).length(),h=this.setFromMatrixColumn(e,1).length();return e=this.setFromMatrixColumn(e,2).length(),this.x=o,this.y=h,this.z=e,this},setFromMatrixColumn:function(e,o){return this.fromArray(e.elements,4*o)},setFromMatrix3Column:function(e,o){return this.fromArray(e.elements,3*o)},equals:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z},fromArray:function(e,o){return o===void 0&&(o=0),this.x=e[o],this.y=e[o+1],this.z=e[o+2],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.x,e[o+1]=this.y,e[o+2]=this.z,e},fromBufferAttribute:function(e,o,h){return h!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(o),this.y=e.getY(o),this.z=e.getZ(o),this},random:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}});var fg=new w,cu=new I,W3=new w(0,0,0),j3=new w(1,1,1),vc=new w,Ky=new w,na=new w;ut(I.prototype,{isMatrix4:!0,set:function(e,o,h,m,_,T,R,z,k,b,q,J,Q,K,rt,lt){var Bt=this.elements;return Bt[0]=e,Bt[4]=o,Bt[8]=h,Bt[12]=m,Bt[1]=_,Bt[5]=T,Bt[9]=R,Bt[13]=z,Bt[2]=k,Bt[6]=b,Bt[10]=q,Bt[14]=J,Bt[3]=Q,Bt[7]=K,Bt[11]=rt,Bt[15]=lt,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return new I().fromArray(this.elements)},copy:function(e){var o=this.elements;return e=e.elements,o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],this},copyPosition:function(e){var o=this.elements;return e=e.elements,o[12]=e[12],o[13]=e[13],o[14]=e[14],this},extractBasis:function(e,o,h){return e.setFromMatrixColumn(this,0),o.setFromMatrixColumn(this,1),h.setFromMatrixColumn(this,2),this},makeBasis:function(e,o,h){return this.set(e.x,o.x,h.x,0,e.y,o.y,h.y,0,e.z,o.z,h.z,0,0,0,0,1),this},extractRotation:function(e){var o=this.elements,h=e.elements,m=1/fg.setFromMatrixColumn(e,0).length(),_=1/fg.setFromMatrixColumn(e,1).length();return e=1/fg.setFromMatrixColumn(e,2).length(),o[0]=h[0]*m,o[1]=h[1]*m,o[2]=h[2]*m,o[3]=0,o[4]=h[4]*_,o[5]=h[5]*_,o[6]=h[6]*_,o[7]=0,o[8]=h[8]*e,o[9]=h[9]*e,o[10]=h[10]*e,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},makeRotationFromEuler:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var o=this.elements,h=e.x,m=e.y,_=e.z,T=Math.cos(h);h=Math.sin(h);var R=Math.cos(m);m=Math.sin(m);var z=Math.cos(_);if(_=Math.sin(_),e.order==="XYZ"){e=T*z;var k=T*_,b=h*z,q=h*_;o[0]=R*z,o[4]=-R*_,o[8]=m,o[1]=k+b*m,o[5]=e-q*m,o[9]=-h*R,o[2]=q-e*m,o[6]=b+k*m,o[10]=T*R}else e.order==="YXZ"?(e=R*z,k=R*_,b=m*z,q=m*_,o[0]=e+q*h,o[4]=b*h-k,o[8]=T*m,o[1]=T*_,o[5]=T*z,o[9]=-h,o[2]=k*h-b,o[6]=q+e*h,o[10]=T*R):e.order==="ZXY"?(e=R*z,k=R*_,b=m*z,q=m*_,o[0]=e-q*h,o[4]=-T*_,o[8]=b+k*h,o[1]=k+b*h,o[5]=T*z,o[9]=q-e*h,o[2]=-T*m,o[6]=h,o[10]=T*R):e.order==="ZYX"?(e=T*z,k=T*_,b=h*z,q=h*_,o[0]=R*z,o[4]=b*m-k,o[8]=e*m+q,o[1]=R*_,o[5]=q*m+e,o[9]=k*m-b,o[2]=-m,o[6]=h*R,o[10]=T*R):e.order==="YZX"?(e=T*R,k=T*m,b=h*R,q=h*m,o[0]=R*z,o[4]=q-e*_,o[8]=b*_+k,o[1]=_,o[5]=T*z,o[9]=-h*z,o[2]=-m*z,o[6]=k*_+b,o[10]=e-q*_):e.order==="XZY"&&(e=T*R,k=T*m,b=h*R,q=h*m,o[0]=R*z,o[4]=-_,o[8]=m*z,o[1]=e*_+q,o[5]=T*z,o[9]=k*_-b,o[2]=b*_-k,o[6]=h*z,o[10]=q*_+e);return o[3]=0,o[7]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,this},makeRotationFromQuaternion:function(e){return this.compose(W3,e,j3)},lookAt:function(e,o,h){var m=this.elements;return na.subVectors(e,o),na.lengthSq()===0&&(na.z=1),na.normalize(),vc.crossVectors(h,na),vc.lengthSq()===0&&(Math.abs(h.z)===1?na.x+=1e-4:na.z+=1e-4,na.normalize(),vc.crossVectors(h,na)),vc.normalize(),Ky.crossVectors(na,vc),m[0]=vc.x,m[4]=Ky.x,m[8]=na.x,m[1]=vc.y,m[5]=Ky.y,m[9]=na.y,m[2]=vc.z,m[6]=Ky.z,m[10]=na.z,this},multiply:function(e,o){return o!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,o)):this.multiplyMatrices(this,e)},premultiply:function(e){return this.multiplyMatrices(e,this)},multiplyMatrices:function(e,o){var h=e.elements,m=o.elements;o=this.elements,e=h[0];var _=h[4],T=h[8],R=h[12],z=h[1],k=h[5],b=h[9],q=h[13],J=h[2],Q=h[6],K=h[10],rt=h[14],lt=h[3],Bt=h[7],Zt=h[11];h=h[15];var bt=m[0],ae=m[4],Kt=m[8],fe=m[12],Xt=m[1],Me=m[5],Ne=m[9],pe=m[13],ke=m[2],Fe=m[6],Ar=m[10],kr=m[14],ir=m[3],zr=m[7],ui=m[11];return m=m[15],o[0]=e*bt+_*Xt+T*ke+R*ir,o[4]=e*ae+_*Me+T*Fe+R*zr,o[8]=e*Kt+_*Ne+T*Ar+R*ui,o[12]=e*fe+_*pe+T*kr+R*m,o[1]=z*bt+k*Xt+b*ke+q*ir,o[5]=z*ae+k*Me+b*Fe+q*zr,o[9]=z*Kt+k*Ne+b*Ar+q*ui,o[13]=z*fe+k*pe+b*kr+q*m,o[2]=J*bt+Q*Xt+K*ke+rt*ir,o[6]=J*ae+Q*Me+K*Fe+rt*zr,o[10]=J*Kt+Q*Ne+K*Ar+rt*ui,o[14]=J*fe+Q*pe+K*kr+rt*m,o[3]=lt*bt+Bt*Xt+Zt*ke+h*ir,o[7]=lt*ae+Bt*Me+Zt*Fe+h*zr,o[11]=lt*Kt+Bt*Ne+Zt*Ar+h*ui,o[15]=lt*fe+Bt*pe+Zt*kr+h*m,this},multiplyScalar:function(e){var o=this.elements;return o[0]*=e,o[4]*=e,o[8]*=e,o[12]*=e,o[1]*=e,o[5]*=e,o[9]*=e,o[13]*=e,o[2]*=e,o[6]*=e,o[10]*=e,o[14]*=e,o[3]*=e,o[7]*=e,o[11]*=e,o[15]*=e,this},determinant:function(){var e=this.elements,o=e[0],h=e[4],m=e[8],_=e[12],T=e[1],R=e[5],z=e[9],k=e[13],b=e[2],q=e[6],J=e[10],Q=e[14];return e[3]*(+_*z*q-m*k*q-_*R*J+h*k*J+m*R*Q-h*z*Q)+e[7]*(+o*z*Q-o*k*J+_*T*J-m*T*Q+m*k*b-_*z*b)+e[11]*(+o*k*q-o*R*Q-_*T*q+h*T*Q+_*R*b-h*k*b)+e[15]*(-m*R*b-o*z*q+o*R*J+m*T*q-h*T*J+h*z*b)},transpose:function(){var e=this.elements,o=e[1];return e[1]=e[4],e[4]=o,o=e[2],e[2]=e[8],e[8]=o,o=e[6],e[6]=e[9],e[9]=o,o=e[3],e[3]=e[12],e[12]=o,o=e[7],e[7]=e[13],e[13]=o,o=e[11],e[11]=e[14],e[14]=o,this},setPosition:function(e,o,h){var m=this.elements;return e.isVector3?(m[12]=e.x,m[13]=e.y,m[14]=e.z):(m[12]=e,m[13]=o,m[14]=h),this},getInverse:function(e,o){o!==void 0&&console.warn("THREE.Matrix4: .getInverse() can no longer be configured to throw on degenerate."),o=this.elements;var h=e.elements;e=h[0];var m=h[1],_=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7],q=h[8],J=h[9],Q=h[10],K=h[11],rt=h[12],lt=h[13],Bt=h[14];h=h[15];var Zt=J*Bt*b-lt*Q*b+lt*k*K-z*Bt*K-J*k*h+z*Q*h,bt=rt*Q*b-q*Bt*b-rt*k*K+R*Bt*K+q*k*h-R*Q*h,ae=q*lt*b-rt*J*b+rt*z*K-R*lt*K-q*z*h+R*J*h,Kt=rt*J*k-q*lt*k-rt*z*Q+R*lt*Q+q*z*Bt-R*J*Bt,fe=e*Zt+m*bt+_*ae+T*Kt;return fe===0?this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0):(fe=1/fe,o[0]=Zt*fe,o[1]=(lt*Q*T-J*Bt*T-lt*_*K+m*Bt*K+J*_*h-m*Q*h)*fe,o[2]=(z*Bt*T-lt*k*T+lt*_*b-m*Bt*b-z*_*h+m*k*h)*fe,o[3]=(J*k*T-z*Q*T-J*_*b+m*Q*b+z*_*K-m*k*K)*fe,o[4]=bt*fe,o[5]=(q*Bt*T-rt*Q*T+rt*_*K-e*Bt*K-q*_*h+e*Q*h)*fe,o[6]=(rt*k*T-R*Bt*T-rt*_*b+e*Bt*b+R*_*h-e*k*h)*fe,o[7]=(R*Q*T-q*k*T+q*_*b-e*Q*b-R*_*K+e*k*K)*fe,o[8]=ae*fe,o[9]=(rt*J*T-q*lt*T-rt*m*K+e*lt*K+q*m*h-e*J*h)*fe,o[10]=(R*lt*T-rt*z*T+rt*m*b-e*lt*b-R*m*h+e*z*h)*fe,o[11]=(q*z*T-R*J*T-q*m*b+e*J*b+R*m*K-e*z*K)*fe,o[12]=Kt*fe,o[13]=(q*lt*_-rt*J*_+rt*m*Q-e*lt*Q-q*m*Bt+e*J*Bt)*fe,o[14]=(rt*z*_-R*lt*_-rt*m*k+e*lt*k+R*m*Bt-e*z*Bt)*fe,o[15]=(R*J*_-q*z*_+q*m*k-e*J*k-R*m*Q+e*z*Q)*fe,this)},scale:function(e){var o=this.elements,h=e.x,m=e.y;return e=e.z,o[0]*=h,o[4]*=m,o[8]*=e,o[1]*=h,o[5]*=m,o[9]*=e,o[2]*=h,o[6]*=m,o[10]*=e,o[3]*=h,o[7]*=m,o[11]*=e,this},getMaxScaleOnAxis:function(){var e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))},makeTranslation:function(e,o,h){return this.set(1,0,0,e,0,1,0,o,0,0,1,h,0,0,0,1),this},makeRotationX:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(1,0,0,0,0,o,-e,0,0,e,o,0,0,0,0,1),this},makeRotationY:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(o,0,e,0,0,1,0,0,-e,0,o,0,0,0,0,1),this},makeRotationZ:function(e){var o=Math.cos(e);return e=Math.sin(e),this.set(o,-e,0,0,e,o,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(e,o){var h=Math.cos(o);o=Math.sin(o);var m=1-h,_=e.x,T=e.y;e=e.z;var R=m*_,z=m*T;return this.set(R*_+h,R*T-o*e,R*e+o*T,0,R*T+o*e,z*T+h,z*e-o*_,0,R*e-o*T,z*e+o*_,m*e*e+h,0,0,0,0,1),this},makeScale:function(e,o,h){return this.set(e,0,0,0,0,o,0,0,0,0,h,0,0,0,0,1),this},makeShear:function(e,o,h){return this.set(1,o,h,0,e,1,h,0,e,o,1,0,0,0,0,1),this},compose:function(e,o,h){var m=this.elements,_=o._x,T=o._y,R=o._z,z=o._w,k=_+_,b=T+T,q=R+R;o=_*k;var J=_*b;_*=q;var Q=T*b;T*=q,R*=q,k*=z,b*=z,z*=q,q=h.x;var K=h.y;return h=h.z,m[0]=(1-(Q+R))*q,m[1]=(J+z)*q,m[2]=(_-b)*q,m[3]=0,m[4]=(J-z)*K,m[5]=(1-(o+R))*K,m[6]=(T+k)*K,m[7]=0,m[8]=(_+b)*h,m[9]=(T-k)*h,m[10]=(1-(o+Q))*h,m[11]=0,m[12]=e.x,m[13]=e.y,m[14]=e.z,m[15]=1,this},decompose:function(e,o,h){var m=this.elements,_=fg.set(m[0],m[1],m[2]).length(),T=fg.set(m[4],m[5],m[6]).length(),R=fg.set(m[8],m[9],m[10]).length();0>this.determinant()&&(_=-_),e.x=m[12],e.y=m[13],e.z=m[14],cu.copy(this),e=1/_,m=1/T;var z=1/R;return cu.elements[0]*=e,cu.elements[1]*=e,cu.elements[2]*=e,cu.elements[4]*=m,cu.elements[5]*=m,cu.elements[6]*=m,cu.elements[8]*=z,cu.elements[9]*=z,cu.elements[10]*=z,o.setFromRotationMatrix(cu),h.x=_,h.y=T,h.z=R,this},makePerspective:function(e,o,h,m,_,T){T===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var R=this.elements;return R[0]=2*_/(o-e),R[4]=0,R[8]=(o+e)/(o-e),R[12]=0,R[1]=0,R[5]=2*_/(h-m),R[9]=(h+m)/(h-m),R[13]=0,R[2]=0,R[6]=0,R[10]=-(T+_)/(T-_),R[14]=-2*T*_/(T-_),R[3]=0,R[7]=0,R[11]=-1,R[15]=0,this},makeOrthographic:function(e,o,h,m,_,T){var R=this.elements,z=1/(o-e),k=1/(h-m),b=1/(T-_);return R[0]=2*z,R[4]=0,R[8]=0,R[12]=-((o+e)*z),R[1]=0,R[5]=2*k,R[9]=0,R[13]=-((h+m)*k),R[2]=0,R[6]=0,R[10]=-2*b,R[14]=-((T+_)*b),R[3]=0,R[7]=0,R[11]=0,R[15]=1,this},equals:function(e){var o=this.elements;e=e.elements;for(var h=0;16>h;h++)if(o[h]!==e[h])return!1;return!0},fromArray:function(e,o){o===void 0&&(o=0);for(var h=0;16>h;h++)this.elements[h]=e[h+o];return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);var h=this.elements;return e[o]=h[0],e[o+1]=h[1],e[o+2]=h[2],e[o+3]=h[3],e[o+4]=h[4],e[o+5]=h[5],e[o+6]=h[6],e[o+7]=h[7],e[o+8]=h[8],e[o+9]=h[9],e[o+10]=h[10],e[o+11]=h[11],e[o+12]=h[12],e[o+13]=h[13],e[o+14]=h[14],e[o+15]=h[15],e}});var nM=new I,oM=new N;L.RotationOrders="XYZ YZX ZXY XZY YXZ ZYX".split(" "),L.DefaultOrder="XYZ",Gr(L.prototype,{x:{get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},y:{get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},z:{get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},order:{get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}}}),ut(L.prototype,{isEuler:!0,set:function(e,o,h,m){return this._x=e,this._y=o,this._z=h,this._order=m||this._order,this._onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this},setFromRotationMatrix:function(e,o,h){var m=di.clamp,_=e.elements;e=_[0];var T=_[4],R=_[8],z=_[1],k=_[5],b=_[9],q=_[2],J=_[6];switch(_=_[10],o=o||this._order,o){case"XYZ":this._y=Math.asin(m(R,-1,1)),.9999999>Math.abs(R)?(this._x=Math.atan2(-b,_),this._z=Math.atan2(-T,e)):(this._x=Math.atan2(J,k),this._z=0);break;case"YXZ":this._x=Math.asin(-m(b,-1,1)),.9999999>Math.abs(b)?(this._y=Math.atan2(R,_),this._z=Math.atan2(z,k)):(this._y=Math.atan2(-q,e),this._z=0);break;case"ZXY":this._x=Math.asin(m(J,-1,1)),.9999999>Math.abs(J)?(this._y=Math.atan2(-q,_),this._z=Math.atan2(-T,k)):(this._y=0,this._z=Math.atan2(z,e));break;case"ZYX":this._y=Math.asin(-m(q,-1,1)),.9999999>Math.abs(q)?(this._x=Math.atan2(J,_),this._z=Math.atan2(z,e)):(this._x=0,this._z=Math.atan2(-T,k));break;case"YZX":this._z=Math.asin(m(z,-1,1)),.9999999>Math.abs(z)?(this._x=Math.atan2(-b,k),this._y=Math.atan2(-q,e)):(this._x=0,this._y=Math.atan2(R,_));break;case"XZY":this._z=Math.asin(-m(T,-1,1)),.9999999>Math.abs(T)?(this._x=Math.atan2(J,k),this._y=Math.atan2(R,e)):(this._x=Math.atan2(-b,_),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+o)}return this._order=o,h!==!1&&this._onChangeCallback(),this},setFromQuaternion:function(e,o,h){return nM.makeRotationFromQuaternion(e),this.setFromRotationMatrix(nM,o,h)},setFromVector3:function(e,o){return this.set(e.x,e.y,e.z,o||this._order)},reorder:function(e){return oM.setFromEuler(this),this.setFromQuaternion(oM,e)},equals:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order},fromArray:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],e[3]!==void 0&&(this._order=e[3]),this._onChangeCallback(),this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this._x,e[o+1]=this._y,e[o+2]=this._z,e[o+3]=this._order,e},toVector3:function(e){return e?e.set(this._x,this._y,this._z):new w(this._x,this._y,this._z)},_onChange:function(e){return this._onChangeCallback=e,this},_onChangeCallback:function(){}}),ut(P.prototype,{set:function(e){this.mask=1<<e|0},enable:function(e){this.mask=this.mask|1<<e|0},enableAll:function(){this.mask=-1},toggle:function(e){this.mask^=1<<e|0},disable:function(e){this.mask&=~(1<<e|0)},disableAll:function(){this.mask=0},test:function(e){return(this.mask&e.mask)!==0}});var X3=0,sM=new w,pg=new N,ch=new I,Qy=new w,Hv=new w,Y3=new w,Z3=new N,aM=new w(1,0,0),uM=new w(0,1,0),lM=new w(0,0,1),J3={type:"added"},q3={type:"removed"};F.DefaultUp=new w(0,1,0),F.DefaultMatrixAutoUpdate=!0,F.prototype=ut(at(s.prototype),{constructor:F,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(e){return this.quaternion.premultiply(e),this},setRotationFromAxisAngle:function(e,o){this.quaternion.setFromAxisAngle(e,o)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(e){this.quaternion.copy(e)},rotateOnAxis:function(e,o){return pg.setFromAxisAngle(e,o),this.quaternion.multiply(pg),this},rotateOnWorldAxis:function(e,o){return pg.setFromAxisAngle(e,o),this.quaternion.premultiply(pg),this},rotateX:function(e){return this.rotateOnAxis(aM,e)},rotateY:function(e){return this.rotateOnAxis(uM,e)},rotateZ:function(e){return this.rotateOnAxis(lM,e)},translateOnAxis:function(e,o){return sM.copy(e).applyQuaternion(this.quaternion),this.position.add(sM.multiplyScalar(o)),this},translateX:function(e){return this.translateOnAxis(aM,e)},translateY:function(e){return this.translateOnAxis(uM,e)},translateZ:function(e){return this.translateOnAxis(lM,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(ch.getInverse(this.matrixWorld))},lookAt:function(e,o,h){e.isVector3?Qy.copy(e):Qy.set(e,o,h),e=this.parent,this.updateWorldMatrix(!0,!1),Hv.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ch.lookAt(Hv,Qy,this.up):ch.lookAt(Qy,Hv,this.up),this.quaternion.setFromRotationMatrix(ch),e&&(ch.extractRotation(e.matrixWorld),pg.setFromRotationMatrix(ch),this.quaternion.premultiply(pg.inverse()))},add:function(e){if(1<arguments.length){for(var o=0;o<arguments.length;o++)this.add(arguments[o]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(e.parent!==null&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(J3)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)},remove:function(e){if(1<arguments.length){for(var o=0;o<arguments.length;o++)this.remove(arguments[o]);return this}return o=this.children.indexOf(e),o!==-1&&(e.parent=null,this.children.splice(o,1),e.dispatchEvent(q3)),this},attach:function(e){return this.updateWorldMatrix(!0,!1),ch.getInverse(this.matrixWorld),e.parent!==null&&(e.parent.updateWorldMatrix(!0,!1),ch.multiply(e.parent.matrixWorld)),e.applyMatrix4(ch),e.updateWorldMatrix(!1,!1),this.add(e),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,o){if(this[e]===o)return this;for(var h=0,m=this.children.length;h<m;h++){var _=this.children[h].getObjectByProperty(e,o);if(_!==void 0)return _}},getWorldPosition:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new w),this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new N),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hv,e,Y3),e},getWorldScale:function(e){return e===void 0&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new w),this.updateMatrixWorld(!0),this.matrixWorld.decompose(Hv,Z3,e),e},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new w),this.updateMatrixWorld(!0);var o=this.matrixWorld.elements;return e.set(o[8],o[9],o[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].traverse(e)},traverseVisible:function(e){if(this.visible!==!1){e(this);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].traverseVisible(e)}},traverseAncestors:function(e){var o=this.parent;o!==null&&(e(o),o.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var o=this.children,h=0,m=o.length;h<m;h++)o[h].updateMatrixWorld(e)},updateWorldMatrix:function(e,o){var h=this.parent;if(e===!0&&h!==null&&h.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),o===!0)for(e=this.children,o=0,h=e.length;o<h;o++)e[o].updateWorldMatrix(!1,!0)},toJSON:function(e){function o(q,J){return q[J.uuid]===void 0&&(q[J.uuid]=J.toJSON(e)),J.uuid}function h(q){var J=[],Q;for(Q in q){var K=q[Q];delete K.metadata,J.push(K)}return J}var m=e===void 0||typeof e=="string",_={};m&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{}},_.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var T={};if(T.uuid=this.uuid,T.type=this.type,this.name!==""&&(T.name=this.name),this.castShadow===!0&&(T.castShadow=!0),this.receiveShadow===!0&&(T.receiveShadow=!0),this.visible===!1&&(T.visible=!1),this.frustumCulled===!1&&(T.frustumCulled=!1),this.renderOrder!==0&&(T.renderOrder=this.renderOrder),Oo(this.userData)!=="{}"&&(T.userData=this.userData),T.layers=this.layers.mask,T.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(T.matrixAutoUpdate=!1),this.isInstancedMesh&&(T.type="InstancedMesh",T.count=this.count,T.instanceMatrix=this.instanceMatrix.toJSON()),this.isMesh||this.isLine||this.isPoints){T.geometry=o(e.geometries,this.geometry);var R=this.geometry.parameters;if(R!==void 0&&R.shapes!==void 0)if(R=R.shapes,Array.isArray(R))for(var z=0,k=R.length;z<k;z++)o(e.shapes,R[z]);else o(e.shapes,R)}if(this.material!==void 0)if(Array.isArray(this.material)){for(R=[],z=0,k=this.material.length;z<k;z++)R.push(o(e.materials,this.material[z]));T.material=R}else T.material=o(e.materials,this.material);if(0<this.children.length)for(T.children=[],z=0;z<this.children.length;z++)T.children.push(this.children[z].toJSON(e).object);if(m){m=h(e.geometries),z=h(e.materials),k=h(e.textures);var b=h(e.images);R=h(e.shapes),0<m.length&&(_.geometries=m),0<z.length&&(_.materials=z),0<k.length&&(_.textures=k),0<b.length&&(_.images=b),0<R.length&&(_.shapes=R)}return _.object=T,_},clone:function(e){return new this.constructor().copy(this,e)},copy:function(e,o){if(o===void 0&&(o=!0),this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.userData=JSON.parse(Oo(e.userData)),o===!0)for(o=0;o<e.children.length;o++)this.add(e.children[o].clone());return this}}),W.prototype=ut(at(F.prototype),{constructor:W,isScene:!0,copy:function(e,o){return F.prototype.copy.call(this,e,o),e.background!==null&&(this.background=e.background.clone()),e.environment!==null&&(this.environment=e.environment.clone()),e.fog!==null&&(this.fog=e.fog.clone()),e.overrideMaterial!==null&&(this.overrideMaterial=e.overrideMaterial.clone()),this.autoUpdate=e.autoUpdate,this.matrixAutoUpdate=e.matrixAutoUpdate,this},toJSON:function(e){var o=F.prototype.toJSON.call(this,e);return this.background!==null&&(o.object.background=this.background.toJSON(e)),this.environment!==null&&(o.object.environment=this.environment.toJSON(e)),this.fog!==null&&(o.object.fog=this.fog.toJSON()),o},dispose:function(){this.dispatchEvent({type:"dispose"})}});var fh=[new w,new w,new w,new w,new w,new w,new w,new w],kv=new w,W2=new X,dg=new w,gg=new w,mg=new w,yc=new w,xc=new w,ep=new w,Gv=new w,$y=new w,tx=new w,rp=new w;ut(X.prototype,{isBox3:!0,set:function(e,o){return this.min.copy(e),this.max.copy(o),this},setFromArray:function(e){for(var o=1/0,h=1/0,m=1/0,_=-1/0,T=-1/0,R=-1/0,z=0,k=e.length;z<k;z+=3){var b=e[z],q=e[z+1],J=e[z+2];b<o&&(o=b),q<h&&(h=q),J<m&&(m=J),b>_&&(_=b),q>T&&(T=q),J>R&&(R=J)}return this.min.set(o,h,m),this.max.set(_,T,R),this},setFromBufferAttribute:function(e){for(var o=1/0,h=1/0,m=1/0,_=-1/0,T=-1/0,R=-1/0,z=0,k=e.count;z<k;z++){var b=e.getX(z),q=e.getY(z),J=e.getZ(z);b<o&&(o=b),q<h&&(h=q),J<m&&(m=J),b>_&&(_=b),q>T&&(T=q),J>R&&(R=J)}return this.min.set(o,h,m),this.max.set(_,T,R),this},setFromPoints:function(e){this.makeEmpty();for(var o=0,h=e.length;o<h;o++)this.expandByPoint(e[o]);return this},setFromCenterAndSize:function(e,o){return o=kv.copy(o).multiplyScalar(.5),this.min.copy(e).sub(o),this.max.copy(e).add(o),this},setFromObject:function(e){return this.makeEmpty(),this.expandByObject(e)},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new w),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new w),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},expandByObject:function(e){e.updateWorldMatrix(!1,!1);var o=e.geometry;o!==void 0&&(o.boundingBox===null&&o.computeBoundingBox(),W2.copy(o.boundingBox),W2.applyMatrix4(e.matrixWorld),this.union(W2)),e=e.children,o=0;for(var h=e.length;o<h;o++)this.expandByObject(e[o]);return this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z},getParameter:function(e,o){return o===void 0&&(console.warn("THREE.Box3: .getParameter() target is now required"),o=new w),o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)},intersectsSphere:function(e){return this.clampPoint(e.center,kv),kv.distanceToSquared(e.center)<=e.radius*e.radius},intersectsPlane:function(e){if(0<e.normal.x)var o=e.normal.x*this.min.x,h=e.normal.x*this.max.x;else o=e.normal.x*this.max.x,h=e.normal.x*this.min.x;return 0<e.normal.y?(o+=e.normal.y*this.min.y,h+=e.normal.y*this.max.y):(o+=e.normal.y*this.max.y,h+=e.normal.y*this.min.y),0<e.normal.z?(o+=e.normal.z*this.min.z,h+=e.normal.z*this.max.z):(o+=e.normal.z*this.max.z,h+=e.normal.z*this.min.z),o<=-e.constant&&h>=-e.constant},intersectsTriangle:function(e){return this.isEmpty()||(this.getCenter(Gv),$y.subVectors(this.max,Gv),dg.subVectors(e.a,Gv),gg.subVectors(e.b,Gv),mg.subVectors(e.c,Gv),yc.subVectors(gg,dg),xc.subVectors(mg,gg),ep.subVectors(dg,mg),e=[0,-yc.z,yc.y,0,-xc.z,xc.y,0,-ep.z,ep.y,yc.z,0,-yc.x,xc.z,0,-xc.x,ep.z,0,-ep.x,-yc.y,yc.x,0,-xc.y,xc.x,0,-ep.y,ep.x,0],!Z(e,dg,gg,mg,$y))||(e=[1,0,0,0,1,0,0,0,1],!Z(e,dg,gg,mg,$y))?!1:(tx.crossVectors(yc,xc),e=[tx.x,tx.y,tx.z],Z(e,dg,gg,mg,$y))},clampPoint:function(e,o){return o===void 0&&(console.warn("THREE.Box3: .clampPoint() target is now required"),o=new w),o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return kv.copy(e).clamp(this.min,this.max).sub(e).length()},getBoundingSphere:function(e){return e===void 0&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(kv).length(),e},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},applyMatrix4:function(e){return this.isEmpty()?this:(fh[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),fh[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),fh[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),fh[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),fh[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),fh[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),fh[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),fh[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(fh),this)},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var K3=new X;ut(tt.prototype,{set:function(e,o){return this.center.copy(e),this.radius=o,this},setFromPoints:function(e,o){var h=this.center;o!==void 0?h.copy(o):K3.setFromPoints(e).getCenter(h);for(var m=o=0,_=e.length;m<_;m++)o=Math.max(o,h.distanceToSquared(e[m]));return this.radius=Math.sqrt(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.center.copy(e.center),this.radius=e.radius,this},isEmpty:function(){return 0>this.radius},makeEmpty:function(){return this.center.set(0,0,0),this.radius=-1,this},containsPoint:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(e){return e.distanceTo(this.center)-this.radius},intersectsSphere:function(e){var o=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=o*o},intersectsBox:function(e){return e.intersectsSphere(this)},intersectsPlane:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius},clampPoint:function(e,o){var h=this.center.distanceToSquared(e);return o===void 0&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),o=new w),o.copy(e),h>this.radius*this.radius&&(o.sub(this.center).normalize(),o.multiplyScalar(this.radius).add(this.center)),o},getBoundingBox:function(e){return e===void 0&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new X),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)},applyMatrix4:function(e){return this.center.applyMatrix4(e),this.radius*=e.getMaxScaleOnAxis(),this},translate:function(e){return this.center.add(e),this},equals:function(e){return e.center.equals(this.center)&&e.radius===this.radius}});var ph=new w,j2=new w,ex=new w,Ac=new w,X2=new w,rx=new w,Y2=new w;ut(st.prototype,{set:function(e,o){return this.origin.copy(e),this.direction.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this},at:function(e,o){return o===void 0&&(console.warn("THREE.Ray: .at() target is now required"),o=new w),o.copy(this.direction).multiplyScalar(e).add(this.origin)},lookAt:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this},recast:function(e){return this.origin.copy(this.at(e,ph)),this},closestPointToPoint:function(e,o){return o===void 0&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),o=new w),o.subVectors(e,this.origin),e=o.dot(this.direction),0>e?o.copy(this.origin):o.copy(this.direction).multiplyScalar(e).add(this.origin)},distanceToPoint:function(e){return Math.sqrt(this.distanceSqToPoint(e))},distanceSqToPoint:function(e){var o=ph.subVectors(e,this.origin).dot(this.direction);return 0>o?this.origin.distanceToSquared(e):(ph.copy(this.direction).multiplyScalar(o).add(this.origin),ph.distanceToSquared(e))},distanceSqToSegment:function(e,o,h,m){j2.copy(e).add(o).multiplyScalar(.5),ex.copy(o).sub(e).normalize(),Ac.copy(this.origin).sub(j2);var _=.5*e.distanceTo(o),T=-this.direction.dot(ex),R=Ac.dot(this.direction),z=-Ac.dot(ex),k=Ac.lengthSq(),b=Math.abs(1-T*T);if(0<b){e=T*z-R,o=T*R-z;var q=_*b;0<=e?o>=-q?o<=q?(_=1/b,e*=_,o*=_,T=e*(e+T*o+2*R)+o*(T*e+o+2*z)+k):(o=_,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k):(o=-_,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k):o<=-q?(e=Math.max(0,-(-T*_+R)),o=0<e?-_:Math.min(Math.max(-_,-z),_),T=-e*e+o*(o+2*z)+k):o<=q?(e=0,o=Math.min(Math.max(-_,-z),_),T=o*(o+2*z)+k):(e=Math.max(0,-(T*_+R)),o=0<e?_:Math.min(Math.max(-_,-z),_),T=-e*e+o*(o+2*z)+k)}else o=0<T?-_:_,e=Math.max(0,-(T*o+R)),T=-e*e+o*(o+2*z)+k;return h&&h.copy(this.direction).multiplyScalar(e).add(this.origin),m&&m.copy(ex).multiplyScalar(o).add(j2),T},intersectSphere:function(e,o){ph.subVectors(e.center,this.origin);var h=ph.dot(this.direction),m=ph.dot(ph)-h*h;return e=e.radius*e.radius,m>e?null:(e=Math.sqrt(e-m),m=h-e,h+=e,0>m&&0>h?null:0>m?this.at(h,o):this.at(m,o))},intersectsSphere:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius},distanceToPlane:function(e){var o=e.normal.dot(this.direction);return o===0?e.distanceToPoint(this.origin)===0?0:null:(e=-(this.origin.dot(e.normal)+e.constant)/o,0<=e?e:null)},intersectPlane:function(e,o){return e=this.distanceToPlane(e),e===null?null:this.at(e,o)},intersectsPlane:function(e){var o=e.distanceToPoint(this.origin);return o===0||0>e.normal.dot(this.direction)*o},intersectBox:function(e,o){var h=1/this.direction.x,m=1/this.direction.y,_=1/this.direction.z,T=this.origin;if(0<=h){var R=(e.min.x-T.x)*h;h*=e.max.x-T.x}else R=(e.max.x-T.x)*h,h*=e.min.x-T.x;if(0<=m){var z=(e.min.y-T.y)*m;m*=e.max.y-T.y}else z=(e.max.y-T.y)*m,m*=e.min.y-T.y;return R>m||z>h||((z>R||R!==R)&&(R=z),(m<h||h!==h)&&(h=m),0<=_?(z=(e.min.z-T.z)*_,e=(e.max.z-T.z)*_):(z=(e.max.z-T.z)*_,e=(e.min.z-T.z)*_),R>e||z>h)?null:((z>R||R!==R)&&(R=z),(e<h||h!==h)&&(h=e),0>h?null:this.at(0<=R?R:h,o))},intersectsBox:function(e){return this.intersectBox(e,ph)!==null},intersectTriangle:function(e,o,h,m,_){if(X2.subVectors(o,e),rx.subVectors(h,e),Y2.crossVectors(X2,rx),o=this.direction.dot(Y2),0<o){if(m)return null;m=1}else if(0>o)m=-1,o=-o;else return null;return Ac.subVectors(this.origin,e),e=m*this.direction.dot(rx.crossVectors(Ac,rx)),0>e||(h=m*this.direction.dot(X2.cross(Ac)),0>h||e+h>o)?null:(e=-m*Ac.dot(Y2),0>e?null:this.at(e/o,_))},applyMatrix4:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this},equals:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}});var Z2=new w,Q3=new w,$3=new c;ut(xt.prototype,{isPlane:!0,set:function(e,o){return this.normal.copy(e),this.constant=o,this},setComponents:function(e,o,h,m){return this.normal.set(e,o,h),this.constant=m,this},setFromNormalAndCoplanarPoint:function(e,o){return this.normal.copy(e),this.constant=-o.dot(this.normal),this},setFromCoplanarPoints:function(e,o,h){return o=Z2.subVectors(h,o).cross(Q3.subVectors(e,o)).normalize(),this.setFromNormalAndCoplanarPoint(o,e),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this},normalize:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(e){return this.normal.dot(e)+this.constant},distanceToSphere:function(e){return this.distanceToPoint(e.center)-e.radius},projectPoint:function(e,o){return o===void 0&&(console.warn("THREE.Plane: .projectPoint() target is now required"),o=new w),o.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)},intersectLine:function(e,o){o===void 0&&(console.warn("THREE.Plane: .intersectLine() target is now required"),o=new w);var h=e.delta(Z2),m=this.normal.dot(h);if(m===0){if(this.distanceToPoint(e.start)===0)return o.copy(e.start)}else if(m=-(e.start.dot(this.normal)+this.constant)/m,!(0>m||1<m))return o.copy(h).multiplyScalar(m).add(e.start)},intersectsLine:function(e){var o=this.distanceToPoint(e.start);return e=this.distanceToPoint(e.end),0>o&&0<e||0>e&&0<o},intersectsBox:function(e){return e.intersectsPlane(this)},intersectsSphere:function(e){return e.intersectsPlane(this)},coplanarPoint:function(e){return e===void 0&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new w),e.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(e,o){return o=o||$3.getNormalMatrix(e),e=this.coplanarPoint(Z2).applyMatrix4(e),o=this.normal.applyMatrix3(o).normalize(),this.constant=-e.dot(o),this},translate:function(e){return this.constant-=e.dot(this.normal),this},equals:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}});var fu=new w,dh=new w,J2=new w,gh=new w,vg=new w,yg=new w,hM=new w,q2=new w,K2=new w,Q2=new w;ut(At,{getNormal:function(e,o,h,m){return m===void 0&&(console.warn("THREE.Triangle: .getNormal() target is now required"),m=new w),m.subVectors(h,o),fu.subVectors(e,o),m.cross(fu),e=m.lengthSq(),0<e?m.multiplyScalar(1/Math.sqrt(e)):m.set(0,0,0)},getBarycoord:function(e,o,h,m,_){fu.subVectors(m,o),dh.subVectors(h,o),J2.subVectors(e,o),e=fu.dot(fu),o=fu.dot(dh),h=fu.dot(J2);var T=dh.dot(dh);m=dh.dot(J2);var R=e*T-o*o;return _===void 0&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),_=new w),R===0?_.set(-2,-1,-1):(R=1/R,T=(T*h-o*m)*R,e=(e*m-o*h)*R,_.set(1-T-e,e,T))},containsPoint:function(e,o,h,m){return At.getBarycoord(e,o,h,m,gh),0<=gh.x&&0<=gh.y&&1>=gh.x+gh.y},getUV:function(e,o,h,m,_,T,R,z){return this.getBarycoord(e,o,h,m,gh),z.set(0,0),z.addScaledVector(_,gh.x),z.addScaledVector(T,gh.y),z.addScaledVector(R,gh.z),z},isFrontFacing:function(e,o,h,m){return fu.subVectors(h,o),dh.subVectors(e,o),0>fu.cross(dh).dot(m)}}),ut(At.prototype,{set:function(e,o,h){return this.a.copy(e),this.b.copy(o),this.c.copy(h),this},setFromPointsAndIndices:function(e,o,h,m){return this.a.copy(e[o]),this.b.copy(e[h]),this.c.copy(e[m]),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this},getArea:function(){return fu.subVectors(this.c,this.b),dh.subVectors(this.a,this.b),.5*fu.cross(dh).length()},getMidpoint:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new w),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(e){return At.getNormal(this.a,this.b,this.c,e)},getPlane:function(e){return e===void 0&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new xt),e.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(e,o){return At.getBarycoord(e,this.a,this.b,this.c,o)},getUV:function(e,o,h,m,_){return At.getUV(e,this.a,this.b,this.c,o,h,m,_)},containsPoint:function(e){return At.containsPoint(e,this.a,this.b,this.c)},isFrontFacing:function(e){return At.isFrontFacing(this.a,this.b,this.c,e)},intersectsBox:function(e){return e.intersectsTriangle(this)},closestPointToPoint:function(e,o){o===void 0&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new w);var h=this.a,m=this.b,_=this.c;vg.subVectors(m,h),yg.subVectors(_,h),q2.subVectors(e,h);var T=vg.dot(q2),R=yg.dot(q2);if(0>=T&&0>=R)return o.copy(h);K2.subVectors(e,m);var z=vg.dot(K2),k=yg.dot(K2);if(0<=z&&k<=z)return o.copy(m);var b=T*k-z*R;if(0>=b&&0<=T&&0>=z)return m=T/(T-z),o.copy(h).addScaledVector(vg,m);Q2.subVectors(e,_),e=vg.dot(Q2);var q=yg.dot(Q2);return 0<=q&&e<=q?o.copy(_):(T=e*R-T*q,0>=T&&0<=R&&0>=q?(b=R/(R-q),o.copy(h).addScaledVector(yg,b)):(R=z*q-e*k,0>=R&&0<=k-z&&0<=e-q?(hM.subVectors(_,m),b=(k-z)/(k-z+(e-q)),o.copy(m).addScaledVector(hM,b)):(_=1/(R+T+b),m=T*_,b*=_,o.copy(h).addScaledVector(vg,m).addScaledVector(yg,b))))},equals:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}});var cM={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},pu={h:0,s:0,l:0},ix={h:0,s:0,l:0};ut(yt.prototype,{isColor:!0,r:1,g:1,b:1,set:function(e){return e&&e.isColor?this.copy(e):typeof e=="number"?this.setHex(e):typeof e=="string"&&this.setStyle(e),this},setScalar:function(e){return this.b=this.g=this.r=e,this},setHex:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(e&255)/255,this},setRGB:function(e,o,h){return this.r=e,this.g=o,this.b=h,this},setHSL:function(e,o,h){return e=di.euclideanModulo(e,1),o=di.clamp(o,0,1),h=di.clamp(h,0,1),o===0?this.r=this.g=this.b=h:(o=.5>=h?h*(1+o):h+o-h*o,h=2*h-o,this.r=Ut(h,o,e+1/3),this.g=Ut(h,o,e),this.b=Ut(h,o,e-1/3)),this},setStyle:function(e){function o(R){R!==void 0&&1>parseFloat(R)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}var h;if(h=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(e)){var m=h[2];switch(h[1]){case"rgb":case"rgba":if(h=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(255,parseInt(h[1],10))/255,this.g=Math.min(255,parseInt(h[2],10))/255,this.b=Math.min(255,parseInt(h[3],10))/255,o(h[5]),this;if(h=/^(\d+)%\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m))return this.r=Math.min(100,parseInt(h[1],10))/100,this.g=Math.min(100,parseInt(h[2],10))/100,this.b=Math.min(100,parseInt(h[3],10))/100,o(h[5]),this;break;case"hsl":case"hsla":if(h=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)%\s*,\s*(\d+)%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(m)){m=parseFloat(h[1])/360;var _=parseInt(h[2],10)/100,T=parseInt(h[3],10)/100;return o(h[5]),this.setHSL(m,_,T)}}}else if(h=/^#([A-Fa-f0-9]+)$/.exec(e)){if(h=h[1],m=h.length,m===3)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(m===6)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}return e&&0<e.length?this.setColorName(e):this},setColorName:function(e){var o=cM[e];return o!==void 0?this.setHex(o):console.warn("THREE.Color: Unknown color "+e),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this},copyGammaToLinear:function(e,o){return o===void 0&&(o=2),this.r=Math.pow(e.r,o),this.g=Math.pow(e.g,o),this.b=Math.pow(e.b,o),this},copyLinearToGamma:function(e,o){return o===void 0&&(o=2),o=0<o?1/o:1,this.r=Math.pow(e.r,o),this.g=Math.pow(e.g,o),this.b=Math.pow(e.b,o),this},convertGammaToLinear:function(e){return this.copyGammaToLinear(this,e),this},convertLinearToGamma:function(e){return this.copyLinearToGamma(this,e),this},copySRGBToLinear:function(e){return this.r=kt(e.r),this.g=kt(e.g),this.b=kt(e.b),this},copyLinearToSRGB:function(e){return this.r=ne(e.r),this.g=ne(e.g),this.b=ne(e.b),this},convertSRGBToLinear:function(){return this.copySRGBToLinear(this),this},convertLinearToSRGB:function(){return this.copyLinearToSRGB(this),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(e){e===void 0&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var o=this.r,h=this.g,m=this.b,_=Math.max(o,h,m),T=Math.min(o,h,m),R,z=(T+_)/2;if(T===_)T=R=0;else{var k=_-T;switch(T=.5>=z?k/(_+T):k/(2-_-T),_){case o:R=(h-m)/k+(h<m?6:0);break;case h:R=(m-o)/k+2;break;case m:R=(o-h)/k+4}R/=6}return e.h=R,e.s=T,e.l=z,e},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(e,o,h){return this.getHSL(pu),pu.h+=e,pu.s+=o,pu.l+=h,this.setHSL(pu.h,pu.s,pu.l),this},add:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this},addColors:function(e,o){return this.r=e.r+o.r,this.g=e.g+o.g,this.b=e.b+o.b,this},addScalar:function(e){return this.r+=e,this.g+=e,this.b+=e,this},sub:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this},multiply:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this},multiplyScalar:function(e){return this.r*=e,this.g*=e,this.b*=e,this},lerp:function(e,o){return this.r+=(e.r-this.r)*o,this.g+=(e.g-this.g)*o,this.b+=(e.b-this.b)*o,this},lerpHSL:function(e,o){this.getHSL(pu),e.getHSL(ix),e=di.lerp(pu.h,ix.h,o);var h=di.lerp(pu.s,ix.s,o);return o=di.lerp(pu.l,ix.l,o),this.setHSL(e,h,o),this},equals:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b},fromArray:function(e,o){return o===void 0&&(o=0),this.r=e[o],this.g=e[o+1],this.b=e[o+2],this},toArray:function(e,o){return e===void 0&&(e=[]),o===void 0&&(o=0),e[o]=this.r,e[o+1]=this.g,e[o+2]=this.b,e},toJSON:function(){return this.getHex()}}),yt.NAMES=cM,ut(Wt.prototype,{clone:function(){return new this.constructor().copy(this)},copy:function(e){this.a=e.a,this.b=e.b,this.c=e.c,this.normal.copy(e.normal),this.color.copy(e.color),this.materialIndex=e.materialIndex;for(var o=0,h=e.vertexNormals.length;o<h;o++)this.vertexNormals[o]=e.vertexNormals[o].clone();for(o=0,h=e.vertexColors.length;o<h;o++)this.vertexColors[o]=e.vertexColors[o].clone();return this}});var tT=0;re.prototype=ut(at(s.prototype),{constructor:re,isMaterial:!0,onBeforeCompile:function(){},setValues:function(e){if(e!==void 0)for(var o in e){var h=e[o];if(h===void 0)console.warn("THREE.Material: '"+o+"' parameter is undefined.");else if(o==="shading")console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=h===1;else{var m=this[o];m===void 0?console.warn("THREE."+this.type+": '"+o+"' is not a property of this material."):m&&m.isColor?m.set(h):m&&m.isVector3&&h&&h.isVector3?m.copy(h):this[o]=h}}},toJSON:function(e){function o(_){var T=[],R;for(R in _){var z=_[R];delete z.metadata,T.push(z)}return T}var h=e===void 0||typeof e=="string";h&&(e={textures:{},images:{}});var m={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};return m.uuid=this.uuid,m.type=this.type,this.name!==""&&(m.name=this.name),this.color&&this.color.isColor&&(m.color=this.color.getHex()),this.roughness!==void 0&&(m.roughness=this.roughness),this.metalness!==void 0&&(m.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(m.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(m.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(m.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(m.specular=this.specular.getHex()),this.shininess!==void 0&&(m.shininess=this.shininess),this.clearcoat!==void 0&&(m.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(m.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(m.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(m.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,m.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(m.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(m.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(m.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(m.lightMap=this.lightMap.toJSON(e).uuid),this.aoMap&&this.aoMap.isTexture&&(m.aoMap=this.aoMap.toJSON(e).uuid,m.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(m.bumpMap=this.bumpMap.toJSON(e).uuid,m.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(m.normalMap=this.normalMap.toJSON(e).uuid,m.normalMapType=this.normalMapType,m.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(m.displacementMap=this.displacementMap.toJSON(e).uuid,m.displacementScale=this.displacementScale,m.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(m.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(m.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(m.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(m.specularMap=this.specularMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(m.envMap=this.envMap.toJSON(e).uuid,m.reflectivity=this.reflectivity,m.refractionRatio=this.refractionRatio,this.combine!==void 0&&(m.combine=this.combine),this.envMapIntensity!==void 0&&(m.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(m.gradientMap=this.gradientMap.toJSON(e).uuid),this.size!==void 0&&(m.size=this.size),this.sizeAttenuation!==void 0&&(m.sizeAttenuation=this.sizeAttenuation),this.blending!==1&&(m.blending=this.blending),this.flatShading===!0&&(m.flatShading=this.flatShading),this.side!==0&&(m.side=this.side),this.vertexColors&&(m.vertexColors=!0),1>this.opacity&&(m.opacity=this.opacity),this.transparent===!0&&(m.transparent=this.transparent),m.depthFunc=this.depthFunc,m.depthTest=this.depthTest,m.depthWrite=this.depthWrite,m.stencilWrite=this.stencilWrite,m.stencilWriteMask=this.stencilWriteMask,m.stencilFunc=this.stencilFunc,m.stencilRef=this.stencilRef,m.stencilFuncMask=this.stencilFuncMask,m.stencilFail=this.stencilFail,m.stencilZFail=this.stencilZFail,m.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(m.rotation=this.rotation),this.polygonOffset===!0&&(m.polygonOffset=!0),this.polygonOffsetFactor!==0&&(m.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(m.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(m.linewidth=this.linewidth),this.dashSize!==void 0&&(m.dashSize=this.dashSize),this.gapSize!==void 0&&(m.gapSize=this.gapSize),this.scale!==void 0&&(m.scale=this.scale),this.dithering===!0&&(m.dithering=!0),0<this.alphaTest&&(m.alphaTest=this.alphaTest),this.premultipliedAlpha===!0&&(m.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(m.wireframe=this.wireframe),1<this.wireframeLinewidth&&(m.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(m.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(m.wireframeLinejoin=this.wireframeLinejoin),this.morphTargets===!0&&(m.morphTargets=!0),this.morphNormals===!0&&(m.morphNormals=!0),this.skinning===!0&&(m.skinning=!0),this.visible===!1&&(m.visible=!1),this.toneMapped===!1&&(m.toneMapped=!1),Oo(this.userData)!=="{}"&&(m.userData=this.userData),h&&(h=o(e.textures),e=o(e.images),0<h.length&&(m.textures=h),0<e.length&&(m.images=e)),m},clone:function(){return new this.constructor().copy(this)},copy:function(e){this.name=e.name,this.fog=e.fog,this.blending=e.blending,this.side=e.side,this.flatShading=e.flatShading,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var o=e.clippingPlanes,h=null;if(o!==null){var m=o.length;h=Array(m);for(var _=0;_!==m;++_)h[_]=o[_].clone()}return this.clippingPlanes=h,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.premultipliedAlpha=e.premultipliedAlpha,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(Oo(e.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(re.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),be.prototype=at(re.prototype),be.prototype.constructor=be,be.prototype.isMeshBasicMaterial=!0,be.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this};var on=new w;Object.defineProperty(ce.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),ut(ce.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this},copyAt:function(e,o,h){e*=this.itemSize,h*=o.itemSize;for(var m=0,_=this.itemSize;m<_;m++)this.array[e+m]=o.array[h+m];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var o=this.array,h=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",m),T=new yt),o[h++]=T.r,o[h++]=T.g,o[h++]=T.b}return this},copyVector2sArray:function(e){for(var o=this.array,h=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",m),T=new f),o[h++]=T.x,o[h++]=T.y}return this},copyVector3sArray:function(e){for(var o=this.array,h=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",m),T=new w),o[h++]=T.x,o[h++]=T.y,o[h++]=T.z}return this},copyVector4sArray:function(e){for(var o=this.array,h=0,m=0,_=e.length;m<_;m++){var T=e[m];T===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",m),T=new p),o[h++]=T.x,o[h++]=T.y,o[h++]=T.z,o[h++]=T.w}return this},applyMatrix3:function(e){for(var o=0,h=this.count;o<h;o++)on.x=this.getX(o),on.y=this.getY(o),on.z=this.getZ(o),on.applyMatrix3(e),this.setXYZ(o,on.x,on.y,on.z);return this},applyMatrix4:function(e){for(var o=0,h=this.count;o<h;o++)on.x=this.getX(o),on.y=this.getY(o),on.z=this.getZ(o),on.applyMatrix4(e),this.setXYZ(o,on.x,on.y,on.z);return this},applyNormalMatrix:function(e){for(var o=0,h=this.count;o<h;o++)on.x=this.getX(o),on.y=this.getY(o),on.z=this.getZ(o),on.applyNormalMatrix(e),this.setXYZ(o,on.x,on.y,on.z);return this},transformDirection:function(e){for(var o=0,h=this.count;o<h;o++)on.x=this.getX(o),on.y=this.getY(o),on.z=this.getZ(o),on.transformDirection(e),this.setXYZ(o,on.x,on.y,on.z);return this},set:function(e,o){return o===void 0&&(o=0),this.array.set(e,o),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,o){return this.array[e*this.itemSize]=o,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,o){return this.array[e*this.itemSize+1]=o,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,o){return this.array[e*this.itemSize+2]=o,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,o){return this.array[e*this.itemSize+3]=o,this},setXY:function(e,o,h){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this},setXYZ:function(e,o,h,m){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this.array[e+2]=m,this},setXYZW:function(e,o,h,m,_){return e*=this.itemSize,this.array[e+0]=o,this.array[e+1]=h,this.array[e+2]=m,this.array[e+3]=_,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){return{itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized}}}),tr.prototype=at(ce.prototype),tr.prototype.constructor=tr,yr.prototype=at(ce.prototype),yr.prototype.constructor=yr,sr.prototype=at(ce.prototype),sr.prototype.constructor=sr,ni.prototype=at(ce.prototype),ni.prototype.constructor=ni,pr.prototype=at(ce.prototype),pr.prototype.constructor=pr,dt.prototype=at(ce.prototype),dt.prototype.constructor=dt,gt.prototype=at(ce.prototype),gt.prototype.constructor=gt,mt.prototype=at(ce.prototype),mt.prototype.constructor=mt,Tt.prototype=at(ce.prototype),Tt.prototype.constructor=Tt,ut(et.prototype,{computeGroups:function(e){var o=[],h=void 0;e=e.faces;for(var m=0;m<e.length;m++){var _=e[m];if(_.materialIndex!==h){h=_.materialIndex,T!==void 0&&(T.count=3*m-T.start,o.push(T));var T={start:3*m,materialIndex:h}}}T!==void 0&&(T.count=3*m-T.start,o.push(T)),this.groups=o},fromGeometry:function(e){var o=e.faces,h=e.vertices,m=e.faceVertexUvs,_=m[0]&&0<m[0].length,T=m[1]&&0<m[1].length,R=e.morphTargets,z=R.length;if(0<z){for(var k=[],b=0;b<z;b++)k[b]={name:R[b].name,data:[]};this.morphTargets.position=k}var q=e.morphNormals,J=q.length;if(0<J){var Q=[];for(b=0;b<J;b++)Q[b]={name:q[b].name,data:[]};this.morphTargets.normal=Q}var K=e.skinIndices,rt=e.skinWeights,lt=K.length===h.length,Bt=rt.length===h.length;for(0<h.length&&o.length===0&&console.error("THREE.DirectGeometry: Faceless geometries are not supported."),b=0;b<o.length;b++){var Zt=o[b];this.vertices.push(h[Zt.a],h[Zt.b],h[Zt.c]);var bt=Zt.vertexNormals;for(bt.length===3?this.normals.push(bt[0],bt[1],bt[2]):(bt=Zt.normal,this.normals.push(bt,bt,bt)),bt=Zt.vertexColors,bt.length===3?this.colors.push(bt[0],bt[1],bt[2]):(bt=Zt.color,this.colors.push(bt,bt,bt)),_===!0&&(bt=m[0][b],bt!==void 0?this.uvs.push(bt[0],bt[1],bt[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",b),this.uvs.push(new f,new f,new f))),T===!0&&(bt=m[1][b],bt!==void 0?this.uvs2.push(bt[0],bt[1],bt[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",b),this.uvs2.push(new f,new f,new f))),bt=0;bt<z;bt++){var ae=R[bt].vertices;k[bt].data.push(ae[Zt.a],ae[Zt.b],ae[Zt.c])}for(bt=0;bt<J;bt++)ae=q[bt].vertexNormals[b],Q[bt].data.push(ae.a,ae.b,ae.c);lt&&this.skinIndices.push(K[Zt.a],K[Zt.b],K[Zt.c]),Bt&&this.skinWeights.push(rt[Zt.a],rt[Zt.b],rt[Zt.c])}return this.computeGroups(e),this.verticesNeedUpdate=e.verticesNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this}});var eT=1,ul=new I,$2=new F,xg=new w,oa=new X,bv=new X,io=new w;ct.prototype=ut(at(s.prototype),{constructor:ct,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){Array.isArray(e)?this.index=new(65535<ht(e)?gt:pr)(e,1):this.index=e},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,o){return this.attributes[e]=o,this},deleteAttribute:function(e){return delete this.attributes[e],this},addGroup:function(e,o,h){this.groups.push({start:e,count:o,materialIndex:h!==void 0?h:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,o){this.drawRange.start=e,this.drawRange.count=o},applyMatrix4:function(e){var o=this.attributes.position;if(o!==void 0&&(o.applyMatrix4(e),o.needsUpdate=!0),o=this.attributes.normal,o!==void 0){var h=new c().getNormalMatrix(e);o.applyNormalMatrix(h),o.needsUpdate=!0}return o=this.attributes.tangent,o!==void 0&&(o.transformDirection(e),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this},rotateX:function(e){return ul.makeRotationX(e),this.applyMatrix4(ul),this},rotateY:function(e){return ul.makeRotationY(e),this.applyMatrix4(ul),this},rotateZ:function(e){return ul.makeRotationZ(e),this.applyMatrix4(ul),this},translate:function(e,o,h){return ul.makeTranslation(e,o,h),this.applyMatrix4(ul),this},scale:function(e,o,h){return ul.makeScale(e,o,h),this.applyMatrix4(ul),this},lookAt:function(e){return $2.lookAt(e),$2.updateMatrix(),this.applyMatrix4($2.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(xg).negate(),this.translate(xg.x,xg.y,xg.z),this},setFromObject:function(e){var o=e.geometry;if(e.isPoints||e.isLine){e=new mt(3*o.vertices.length,3);var h=new mt(3*o.colors.length,3);this.setAttribute("position",e.copyVector3sArray(o.vertices)),this.setAttribute("color",h.copyColorsArray(o.colors)),o.lineDistances&&o.lineDistances.length===o.vertices.length&&(e=new mt(o.lineDistances.length,1),this.setAttribute("lineDistance",e.copyArray(o.lineDistances))),o.boundingSphere!==null&&(this.boundingSphere=o.boundingSphere.clone()),o.boundingBox!==null&&(this.boundingBox=o.boundingBox.clone())}else e.isMesh&&o&&o.isGeometry&&this.fromGeometry(o);return this},setFromPoints:function(e){for(var o=[],h=0,m=e.length;h<m;h++){var _=e[h];o.push(_.x,_.y,_.z||0)}return this.setAttribute("position",new mt(o,3)),this},updateFromObject:function(e){var o=e.geometry;if(e.isMesh){var h=o.__directGeometry;if(o.elementsNeedUpdate===!0&&(h=void 0,o.elementsNeedUpdate=!1),h===void 0)return this.fromGeometry(o);h.verticesNeedUpdate=o.verticesNeedUpdate,h.normalsNeedUpdate=o.normalsNeedUpdate,h.colorsNeedUpdate=o.colorsNeedUpdate,h.uvsNeedUpdate=o.uvsNeedUpdate,h.groupsNeedUpdate=o.groupsNeedUpdate,o.verticesNeedUpdate=!1,o.normalsNeedUpdate=!1,o.colorsNeedUpdate=!1,o.uvsNeedUpdate=!1,o.groupsNeedUpdate=!1,o=h}return o.verticesNeedUpdate===!0&&(h=this.attributes.position,h!==void 0&&(h.copyVector3sArray(o.vertices),h.needsUpdate=!0),o.verticesNeedUpdate=!1),o.normalsNeedUpdate===!0&&(h=this.attributes.normal,h!==void 0&&(h.copyVector3sArray(o.normals),h.needsUpdate=!0),o.normalsNeedUpdate=!1),o.colorsNeedUpdate===!0&&(h=this.attributes.color,h!==void 0&&(h.copyColorsArray(o.colors),h.needsUpdate=!0),o.colorsNeedUpdate=!1),o.uvsNeedUpdate&&(h=this.attributes.uv,h!==void 0&&(h.copyVector2sArray(o.uvs),h.needsUpdate=!0),o.uvsNeedUpdate=!1),o.lineDistancesNeedUpdate&&(h=this.attributes.lineDistance,h!==void 0&&(h.copyArray(o.lineDistances),h.needsUpdate=!0),o.lineDistancesNeedUpdate=!1),o.groupsNeedUpdate&&(o.computeGroups(e.geometry),this.groups=o.groups,o.groupsNeedUpdate=!1),this},fromGeometry:function(e){return e.__directGeometry=new et().fromGeometry(e),this.fromDirectGeometry(e.__directGeometry)},fromDirectGeometry:function(e){var o=new Float32Array(3*e.vertices.length);this.setAttribute("position",new ce(o,3).copyVector3sArray(e.vertices)),0<e.normals.length&&(o=new Float32Array(3*e.normals.length),this.setAttribute("normal",new ce(o,3).copyVector3sArray(e.normals))),0<e.colors.length&&(o=new Float32Array(3*e.colors.length),this.setAttribute("color",new ce(o,3).copyColorsArray(e.colors))),0<e.uvs.length&&(o=new Float32Array(2*e.uvs.length),this.setAttribute("uv",new ce(o,2).copyVector2sArray(e.uvs))),0<e.uvs2.length&&(o=new Float32Array(2*e.uvs2.length),this.setAttribute("uv2",new ce(o,2).copyVector2sArray(e.uvs2))),this.groups=e.groups;for(var h in e.morphTargets){o=[];for(var m=e.morphTargets[h],_=0,T=m.length;_<T;_++){var R=m[_],z=new mt(3*R.data.length,3);z.name=R.name,o.push(z.copyVector3sArray(R.data))}this.morphAttributes[h]=o}return 0<e.skinIndices.length&&(h=new mt(4*e.skinIndices.length,4),this.setAttribute("skinIndex",h.copyVector4sArray(e.skinIndices))),0<e.skinWeights.length&&(h=new mt(4*e.skinWeights.length,4),this.setAttribute("skinWeight",h.copyVector4sArray(e.skinWeights))),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),this},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new X);var e=this.attributes.position,o=this.morphAttributes.position;if(e!==void 0){if(this.boundingBox.setFromBufferAttribute(e),o){e=0;for(var h=o.length;e<h;e++)oa.setFromBufferAttribute(o[e]),this.morphTargetsRelative?(io.addVectors(this.boundingBox.min,oa.min),this.boundingBox.expandByPoint(io),io.addVectors(this.boundingBox.max,oa.max),this.boundingBox.expandByPoint(io)):(this.boundingBox.expandByPoint(oa.min),this.boundingBox.expandByPoint(oa.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new tt);var e=this.attributes.position,o=this.morphAttributes.position;if(e){var h=this.boundingSphere.center;if(oa.setFromBufferAttribute(e),o)for(var m=0,_=o.length;m<_;m++){var T=o[m];bv.setFromBufferAttribute(T),this.morphTargetsRelative?(io.addVectors(oa.min,bv.min),oa.expandByPoint(io),io.addVectors(oa.max,bv.max),oa.expandByPoint(io)):(oa.expandByPoint(bv.min),oa.expandByPoint(bv.max))}oa.getCenter(h);var R=0;for(m=0,_=e.count;m<_;m++)io.fromBufferAttribute(e,m),R=Math.max(R,h.distanceToSquared(io));if(o)for(m=0,_=o.length;m<_;m++){T=o[m];for(var z=this.morphTargetsRelative,k=0,b=T.count;k<b;k++)io.fromBufferAttribute(T,k),z&&(xg.fromBufferAttribute(e,k),io.add(xg)),R=Math.max(R,h.distanceToSquared(io))}this.boundingSphere.radius=Math.sqrt(R),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeVertexNormals:function(){var e=this.index,o=this.attributes;if(o.position){var h=o.position.array;if(o.normal===void 0)this.setAttribute("normal",new ce(new Float32Array(h.length),3));else for(var m=o.normal.array,_=0,T=m.length;_<T;_++)m[_]=0;m=o.normal.array;var R=new w,z=new w,k=new w,b=new w,q=new w;if(e){var J=e.array;for(_=0,T=e.count;_<T;_+=3){e=3*J[_+0];var Q=3*J[_+1],K=3*J[_+2];R.fromArray(h,e),z.fromArray(h,Q),k.fromArray(h,K),b.subVectors(k,z),q.subVectors(R,z),b.cross(q),m[e]+=b.x,m[e+1]+=b.y,m[e+2]+=b.z,m[Q]+=b.x,m[Q+1]+=b.y,m[Q+2]+=b.z,m[K]+=b.x,m[K+1]+=b.y,m[K+2]+=b.z}}else for(_=0,T=h.length;_<T;_+=9)R.fromArray(h,_),z.fromArray(h,_+3),k.fromArray(h,_+6),b.subVectors(k,z),q.subVectors(R,z),b.cross(q),m[_]=b.x,m[_+1]=b.y,m[_+2]=b.z,m[_+3]=b.x,m[_+4]=b.y,m[_+5]=b.z,m[_+6]=b.x,m[_+7]=b.y,m[_+8]=b.z;this.normalizeNormals(),o.normal.needsUpdate=!0}},merge:function(e,o){if(e&&e.isBufferGeometry){o===void 0&&(o=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var h=this.attributes,m;for(m in h)if(e.attributes[m]!==void 0){var _=h[m].array,T=e.attributes[m],R=T.array,z=T.itemSize*o;T=Math.min(R.length,_.length-z);for(var k=0;k<T;k++,z++)_[z]=R[k]}return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,o=0,h=e.count;o<h;o++)io.x=e.getX(o),io.y=e.getY(o),io.z=e.getZ(o),io.normalize(),e.setXYZ(o,io.x,io.y,io.z)},toNonIndexed:function(){function e(q,J){var Q=q.array,K=q.itemSize;q=q.normalized;for(var rt=new Q.constructor(J.length*K),lt,Bt=0,Zt=0,bt=J.length;Zt<bt;Zt++){lt=J[Zt]*K;for(var ae=0;ae<K;ae++)rt[Bt++]=Q[lt++]}return new ce(rt,K,q)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var o=new ct,h=this.index.array,m=this.attributes,_;for(_ in m){var T=m[_];T=e(T,h),o.setAttribute(_,T)}var R=this.morphAttributes;for(_ in R){var z=[],k=R[_];m=0;for(var b=k.length;m<b;m++)T=k[m],T=e(T,h),z.push(T);o.morphAttributes[_]=z}for(o.morphTargetsRelative=this.morphTargetsRelative,h=this.groups,m=0,_=h.length;m<_;m++)T=h[m],o.addGroup(T.start,T.count,T.materialIndex);return o},toJSON:function(){var e={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,this.name!==""&&(e.name=this.name),0<Pi(this.userData).length&&(e.userData=this.userData),this.parameters!==void 0){var o=this.parameters;for(b in o)o[b]!==void 0&&(e[b]=o[b]);return e}e.data={attributes:{}},o=this.index,o!==null&&(e.data.index={type:o.array.constructor.name,array:Array.prototype.slice.call(o.array)});var h=this.attributes;for(b in h){o=h[b];var m=o.toJSON();o.name!==""&&(m.name=o.name),e.data.attributes[b]=m}h={};var _=!1;for(b in this.morphAttributes){for(var T=this.morphAttributes[b],R=[],z=0,k=T.length;z<k;z++)o=T[z],m=o.toJSON(),o.name!==""&&(m.name=o.name),R.push(m);0<R.length&&(h[b]=R,_=!0)}_&&(e.data.morphAttributes=h,e.data.morphTargetsRelative=this.morphTargetsRelative);var b=this.groups;return 0<b.length&&(e.data.groups=JSON.parse(Oo(b))),b=this.boundingSphere,b!==null&&(e.data.boundingSphere={center:b.center.toArray(),radius:b.radius}),e},clone:function(){return new ct().copy(this)},copy:function(e){var o;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var h=e.index;h!==null&&this.setIndex(h.clone()),h=e.attributes;for(R in h)this.setAttribute(R,h[R].clone());var m=e.morphAttributes;for(R in m){var _=[],T=m[R];for(h=0,o=T.length;h<o;h++)_.push(T[h].clone());this.morphAttributes[R]=_}this.morphTargetsRelative=e.morphTargetsRelative;var R=e.groups;for(h=0,o=R.length;h<o;h++)m=R[h],this.addGroup(m.start,m.count,m.materialIndex);return R=e.boundingBox,R!==null&&(this.boundingBox=R.clone()),R=e.boundingSphere,R!==null&&(this.boundingSphere=R.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var fM=new I,ip=new st,t_=new tt,_c=new w,wc=new w,Mc=new w,e_=new w,r_=new w,i_=new w,nx=new w,ox=new w,sx=new w,Ag=new f,_g=new f,wg=new f,Vv=new w,ax=new w;St.prototype=ut(at(F.prototype),{constructor:St,isMesh:!0,copy:function(e){return F.prototype.copy.call(this,e),e.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),e.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=ut({},e.morphTargetDictionary)),this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=Pi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")},raycast:function(e,o){var h=this.geometry,m=this.material,_=this.matrixWorld;if(m!==void 0&&(h.boundingSphere===null&&h.computeBoundingSphere(),t_.copy(h.boundingSphere),t_.applyMatrix4(_),e.ray.intersectsSphere(t_)!==!1&&(fM.getInverse(_),ip.copy(e.ray).applyMatrix4(fM),h.boundingBox===null||ip.intersectsBox(h.boundingBox)!==!1))){if(h.isBufferGeometry){var T=h.index;_=h.attributes.position;var R=h.morphAttributes.position,z=h.morphTargetsRelative,k=h.attributes.uv,b=h.attributes.uv2,q=h.groups,J=h.drawRange,Q,K;if(T!==null)if(Array.isArray(m)){var rt=0;for(Q=q.length;rt<Q;rt++){var lt=q[rt],Bt=m[lt.materialIndex],Zt=Math.max(lt.start,J.start);for(K=h=Math.min(lt.start+lt.count,J.start+J.count);Zt<K;Zt+=3){h=T.getX(Zt);var bt=T.getX(Zt+1),ae=T.getX(Zt+2);(h=Qt(this,Bt,e,ip,_,R,z,k,b,h,bt,ae))&&(h.faceIndex=Math.floor(Zt/3),h.face.materialIndex=lt.materialIndex,o.push(h))}}}else for(Zt=Math.max(0,J.start),h=Math.min(T.count,J.start+J.count),rt=Zt,Q=h;rt<Q;rt+=3)h=T.getX(rt),bt=T.getX(rt+1),ae=T.getX(rt+2),(h=Qt(this,m,e,ip,_,R,z,k,b,h,bt,ae))&&(h.faceIndex=Math.floor(rt/3),o.push(h));else if(_!==void 0)if(Array.isArray(m))for(rt=0,Q=q.length;rt<Q;rt++)for(lt=q[rt],Bt=m[lt.materialIndex],Zt=Math.max(lt.start,J.start),K=h=Math.min(lt.start+lt.count,J.start+J.count);Zt<K;Zt+=3)h=Zt,bt=Zt+1,ae=Zt+2,(h=Qt(this,Bt,e,ip,_,R,z,k,b,h,bt,ae))&&(h.faceIndex=Math.floor(Zt/3),h.face.materialIndex=lt.materialIndex,o.push(h));else for(Zt=Math.max(0,J.start),h=Math.min(_.count,J.start+J.count),rt=Zt,Q=h;rt<Q;rt+=3)h=rt,bt=rt+1,ae=rt+2,(h=Qt(this,m,e,ip,_,R,z,k,b,h,bt,ae))&&(h.faceIndex=Math.floor(rt/3),o.push(h))}else if(h.isGeometry)for(_=Array.isArray(m),R=h.vertices,z=h.faces,h=h.faceVertexUvs[0],0<h.length&&(T=h),J=0,rt=z.length;J<rt;J++)Q=z[J],h=_?m[Q.materialIndex]:m,h!==void 0&&(k=R[Q.a],b=R[Q.b],q=R[Q.c],h=Gt(this,h,e,ip,k,b,q,Vv))&&(T&&T[J]&&(lt=T[J],Ag.copy(lt[0]),_g.copy(lt[1]),wg.copy(lt[2]),h.uv=At.getUV(Vv,k,b,q,Ag,_g,wg,new f)),h.face=Q,h.faceIndex=J,o.push(h))}},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var rT=0,ll=new I,n_=new F,ux=new w;ft.prototype=ut(at(s.prototype),{constructor:ft,isGeometry:!0,applyMatrix4:function(e){for(var o=new c().getNormalMatrix(e),h=0,m=this.vertices.length;h<m;h++)this.vertices[h].applyMatrix4(e);for(h=0,m=this.faces.length;h<m;h++){e=this.faces[h],e.normal.applyMatrix3(o).normalize();for(var _=0,T=e.vertexNormals.length;_<T;_++)e.vertexNormals[_].applyMatrix3(o).normalize()}return this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this.normalsNeedUpdate=this.verticesNeedUpdate=!0,this},rotateX:function(e){return ll.makeRotationX(e),this.applyMatrix4(ll),this},rotateY:function(e){return ll.makeRotationY(e),this.applyMatrix4(ll),this},rotateZ:function(e){return ll.makeRotationZ(e),this.applyMatrix4(ll),this},translate:function(e,o,h){return ll.makeTranslation(e,o,h),this.applyMatrix4(ll),this},scale:function(e,o,h){return ll.makeScale(e,o,h),this.applyMatrix4(ll),this},lookAt:function(e){return n_.lookAt(e),n_.updateMatrix(),this.applyMatrix4(n_.matrix),this},fromBufferGeometry:function(e){function o(K,rt,lt,Bt){var Zt=z===void 0?[]:[h.colors[K].clone(),h.colors[rt].clone(),h.colors[lt].clone()],bt=R===void 0?[]:[new w().fromArray(R,3*K),new w().fromArray(R,3*rt),new w().fromArray(R,3*lt)];Bt=new Wt(K,rt,lt,bt,Zt,Bt),h.faces.push(Bt),k!==void 0&&h.faceVertexUvs[0].push([new f().fromArray(k,2*K),new f().fromArray(k,2*rt),new f().fromArray(k,2*lt)]),b!==void 0&&h.faceVertexUvs[1].push([new f().fromArray(b,2*K),new f().fromArray(b,2*rt),new f().fromArray(b,2*lt)])}var h=this,m=e.index!==null?e.index.array:void 0,_=e.attributes;if(_.position===void 0)return console.error("THREE.Geometry.fromBufferGeometry(): Position attribute required for conversion."),this;var T=_.position.array,R=_.normal!==void 0?_.normal.array:void 0,z=_.color!==void 0?_.color.array:void 0,k=_.uv!==void 0?_.uv.array:void 0,b=_.uv2!==void 0?_.uv2.array:void 0;for(b!==void 0&&(this.faceVertexUvs[1]=[]),_=0;_<T.length;_+=3)h.vertices.push(new w().fromArray(T,_)),z!==void 0&&h.colors.push(new yt().fromArray(z,_));var q=e.groups;if(0<q.length)for(_=0;_<q.length;_++){T=q[_];var J=T.start,Q=J;for(J+=T.count;Q<J;Q+=3)m!==void 0?o(m[Q],m[Q+1],m[Q+2],T.materialIndex):o(Q,Q+1,Q+2,T.materialIndex)}else if(m!==void 0)for(_=0;_<m.length;_+=3)o(m[_],m[_+1],m[_+2]);else for(_=0;_<T.length/3;_+=3)o(_,_+1,_+2);return this.computeFaceNormals(),e.boundingBox!==null&&(this.boundingBox=e.boundingBox.clone()),e.boundingSphere!==null&&(this.boundingSphere=e.boundingSphere.clone()),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(ux).negate(),this.translate(ux.x,ux.y,ux.z),this},normalize:function(){this.computeBoundingSphere();var e=this.boundingSphere.center,o=this.boundingSphere.radius;o=o===0?1:1/o;var h=new I;return h.set(o,0,0,-o*e.x,0,o,0,-o*e.y,0,0,o,-o*e.z,0,0,0,1),this.applyMatrix4(h),this},computeFaceNormals:function(){for(var e=new w,o=new w,h=0,m=this.faces.length;h<m;h++){var _=this.faces[h],T=this.vertices[_.a],R=this.vertices[_.b];e.subVectors(this.vertices[_.c],R),o.subVectors(T,R),e.cross(o),e.normalize(),_.normal.copy(e)}},computeVertexNormals:function(e){e===void 0&&(e=!0);var o,h=Array(this.vertices.length),m=0;for(o=this.vertices.length;m<o;m++)h[m]=new w;if(e){var _=new w,T=new w;for(e=0,m=this.faces.length;e<m;e++){o=this.faces[e];var R=this.vertices[o.a],z=this.vertices[o.b],k=this.vertices[o.c];_.subVectors(k,z),T.subVectors(R,z),_.cross(T),h[o.a].add(_),h[o.b].add(_),h[o.c].add(_)}}else for(this.computeFaceNormals(),e=0,m=this.faces.length;e<m;e++)o=this.faces[e],h[o.a].add(o.normal),h[o.b].add(o.normal),h[o.c].add(o.normal);for(m=0,o=this.vertices.length;m<o;m++)h[m].normalize();for(e=0,m=this.faces.length;e<m;e++)o=this.faces[e],R=o.vertexNormals,R.length===3?(R[0].copy(h[o.a]),R[1].copy(h[o.b]),R[2].copy(h[o.c])):(R[0]=h[o.a].clone(),R[1]=h[o.b].clone(),R[2]=h[o.c].clone());0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var e;this.computeFaceNormals();var o=0;for(e=this.faces.length;o<e;o++){var h=this.faces[o],m=h.vertexNormals;m.length===3?(m[0].copy(h.normal),m[1].copy(h.normal),m[2].copy(h.normal)):(m[0]=h.normal.clone(),m[1]=h.normal.clone(),m[2]=h.normal.clone())}0<this.faces.length&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var e,o,h=0;for(o=this.faces.length;h<o;h++){var m=this.faces[h];m.__originalFaceNormal?m.__originalFaceNormal.copy(m.normal):m.__originalFaceNormal=m.normal.clone(),m.__originalVertexNormals||(m.__originalVertexNormals=[]);var _=0;for(e=m.vertexNormals.length;_<e;_++)m.__originalVertexNormals[_]?m.__originalVertexNormals[_].copy(m.vertexNormals[_]):m.__originalVertexNormals[_]=m.vertexNormals[_].clone()}var T=new ft;for(T.faces=this.faces,_=0,e=this.morphTargets.length;_<e;_++){if(!this.morphNormals[_]){this.morphNormals[_]={},this.morphNormals[_].faceNormals=[],this.morphNormals[_].vertexNormals=[],m=this.morphNormals[_].faceNormals;var R=this.morphNormals[_].vertexNormals;for(h=0,o=this.faces.length;h<o;h++){var z=new w,k={a:new w,b:new w,c:new w};m.push(z),R.push(k)}}for(R=this.morphNormals[_],T.vertices=this.morphTargets[_].vertices,T.computeFaceNormals(),T.computeVertexNormals(),h=0,o=this.faces.length;h<o;h++)m=this.faces[h],z=R.faceNormals[h],k=R.vertexNormals[h],z.copy(m.normal),k.a.copy(m.vertexNormals[0]),k.b.copy(m.vertexNormals[1]),k.c.copy(m.vertexNormals[2])}for(h=0,o=this.faces.length;h<o;h++)m=this.faces[h],m.normal=m.__originalFaceNormal,m.vertexNormals=m.__originalVertexNormals},computeBoundingBox:function(){this.boundingBox===null&&(this.boundingBox=new X),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){this.boundingSphere===null&&(this.boundingSphere=new tt),this.boundingSphere.setFromPoints(this.vertices)},merge:function(e,o,h){if(e&&e.isGeometry){var m,_=this.vertices.length,T=this.vertices,R=e.vertices,z=this.faces,k=e.faces,b=this.colors,q=e.colors;h===void 0&&(h=0),o!==void 0&&(m=new c().getNormalMatrix(o));for(var J=0,Q=R.length;J<Q;J++){var K=R[J].clone();o!==void 0&&K.applyMatrix4(o),T.push(K)}for(J=0,Q=q.length;J<Q;J++)b.push(q[J].clone());for(J=0,Q=k.length;J<Q;J++){R=k[J];var rt=R.vertexNormals;for(q=R.vertexColors,b=new Wt(R.a+_,R.b+_,R.c+_),b.normal.copy(R.normal),m!==void 0&&b.normal.applyMatrix3(m).normalize(),o=0,T=rt.length;o<T;o++)K=rt[o].clone(),m!==void 0&&K.applyMatrix3(m).normalize(),b.vertexNormals.push(K);for(b.color.copy(R.color),o=0,T=q.length;o<T;o++)K=q[o],b.vertexColors.push(K.clone());b.materialIndex=R.materialIndex+h,z.push(b)}for(J=0,Q=e.faceVertexUvs.length;J<Q;J++)for(h=e.faceVertexUvs[J],this.faceVertexUvs[J]===void 0&&(this.faceVertexUvs[J]=[]),o=0,T=h.length;o<T;o++){for(m=h[o],_=[],z=0,k=m.length;z<k;z++)_.push(m[z].clone());this.faceVertexUvs[J].push(_)}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",e)},mergeMesh:function(e){e&&e.isMesh?(e.matrixAutoUpdate&&e.updateMatrix(),this.merge(e.geometry,e.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",e)},mergeVertices:function(){var e={},o=[],h=[],m=Math.pow(10,4),_,T=0;for(_=this.vertices.length;T<_;T++){var R=this.vertices[T];R=Math.round(R.x*m)+"_"+Math.round(R.y*m)+"_"+Math.round(R.z*m),e[R]===void 0?(e[R]=T,o.push(this.vertices[T]),h[T]=o.length-1):h[T]=h[e[R]]}for(e=[],T=0,_=this.faces.length;T<_;T++)for(m=this.faces[T],m.a=h[m.a],m.b=h[m.b],m.c=h[m.c],m=[m.a,m.b,m.c],R=0;3>R;R++)if(m[R]===m[(R+1)%3]){e.push(T);break}for(T=e.length-1;0<=T;T--)for(m=e[T],this.faces.splice(m,1),h=0,_=this.faceVertexUvs.length;h<_;h++)this.faceVertexUvs[h].splice(m,1);return T=this.vertices.length-o.length,this.vertices=o,T},setFromPoints:function(e){this.vertices=[];for(var o=0,h=e.length;o<h;o++){var m=e[o];this.vertices.push(new w(m.x,m.y,m.z||0))}return this},sortFacesByMaterialIndex:function(){for(var e=this.faces,o=e.length,h=0;h<o;h++)e[h]._id=h;e.sort(function(k,b){return k.materialIndex-b.materialIndex});var m=this.faceVertexUvs[0],_=this.faceVertexUvs[1],T,R;for(m&&m.length===o&&(T=[]),_&&_.length===o&&(R=[]),h=0;h<o;h++){var z=e[h]._id;T&&T.push(m[z]),R&&R.push(_[z])}T&&(this.faceVertexUvs[0]=T),R&&(this.faceVertexUvs[1]=R)},toJSON:function(){function e(fe,Xt,Me){return Me?fe|1<<Xt:fe&~(1<<Xt)}function o(fe){var Xt=fe.x.toString()+fe.y.toString()+fe.z.toString();return b[Xt]!==void 0||(b[Xt]=k.length/3,k.push(fe.x,fe.y,fe.z)),b[Xt]}function h(fe){var Xt=fe.r.toString()+fe.g.toString()+fe.b.toString();return J[Xt]!==void 0||(J[Xt]=q.length,q.push(fe.getHex())),J[Xt]}function m(fe){var Xt=fe.x.toString()+fe.y.toString();return K[Xt]!==void 0||(K[Xt]=Q.length/2,Q.push(fe.x,fe.y)),K[Xt]}var _={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(_.uuid=this.uuid,_.type=this.type,this.name!==""&&(_.name=this.name),this.parameters!==void 0){var T=this.parameters,R;for(R in T)T[R]!==void 0&&(_[R]=T[R]);return _}for(T=[],R=0;R<this.vertices.length;R++){var z=this.vertices[R];T.push(z.x,z.y,z.z)}z=[];var k=[],b={},q=[],J={},Q=[],K={};for(R=0;R<this.faces.length;R++){var rt=this.faces[R],lt=this.faceVertexUvs[0][R]!==void 0,Bt=0<rt.normal.length(),Zt=0<rt.vertexNormals.length,bt=rt.color.r!==1||rt.color.g!==1||rt.color.b!==1,ae=0<rt.vertexColors.length,Kt=0;Kt=e(Kt,0,0),Kt=e(Kt,1,!0),Kt=e(Kt,2,!1),Kt=e(Kt,3,lt),Kt=e(Kt,4,Bt),Kt=e(Kt,5,Zt),Kt=e(Kt,6,bt),Kt=e(Kt,7,ae),z.push(Kt),z.push(rt.a,rt.b,rt.c),z.push(rt.materialIndex),lt&&(lt=this.faceVertexUvs[0][R],z.push(m(lt[0]),m(lt[1]),m(lt[2]))),Bt&&z.push(o(rt.normal)),Zt&&(Bt=rt.vertexNormals,z.push(o(Bt[0]),o(Bt[1]),o(Bt[2]))),bt&&z.push(h(rt.color)),ae&&(rt=rt.vertexColors,z.push(h(rt[0]),h(rt[1]),h(rt[2])))}return _.data={},_.data.vertices=T,_.data.normals=k,0<q.length&&(_.data.colors=q),0<Q.length&&(_.data.uvs=[Q]),_.data.faces=z,_},clone:function(){return new ft().copy(this)},copy:function(e){var o,h,m;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingSphere=this.boundingBox=null,this.name=e.name;var _=e.vertices,T=0;for(o=_.length;T<o;T++)this.vertices.push(_[T].clone());for(_=e.colors,T=0,o=_.length;T<o;T++)this.colors.push(_[T].clone());for(_=e.faces,T=0,o=_.length;T<o;T++)this.faces.push(_[T].clone());for(T=0,o=e.faceVertexUvs.length;T<o;T++){var R=e.faceVertexUvs[T];for(this.faceVertexUvs[T]===void 0&&(this.faceVertexUvs[T]=[]),_=0,h=R.length;_<h;_++){var z=R[_],k=[],b=0;for(m=z.length;b<m;b++)k.push(z[b].clone());this.faceVertexUvs[T].push(k)}}for(b=e.morphTargets,T=0,o=b.length;T<o;T++){if(m={},m.name=b[T].name,b[T].vertices!==void 0)for(m.vertices=[],_=0,h=b[T].vertices.length;_<h;_++)m.vertices.push(b[T].vertices[_].clone());if(b[T].normals!==void 0)for(m.normals=[],_=0,h=b[T].normals.length;_<h;_++)m.normals.push(b[T].normals[_].clone());this.morphTargets.push(m)}for(b=e.morphNormals,T=0,o=b.length;T<o;T++){if(m={},b[T].vertexNormals!==void 0)for(m.vertexNormals=[],_=0,h=b[T].vertexNormals.length;_<h;_++)R=b[T].vertexNormals[_],z={},z.a=R.a.clone(),z.b=R.b.clone(),z.c=R.c.clone(),m.vertexNormals.push(z);if(b[T].faceNormals!==void 0)for(m.faceNormals=[],_=0,h=b[T].faceNormals.length;_<h;_++)m.faceNormals.push(b[T].faceNormals[_].clone());this.morphNormals.push(m)}for(_=e.skinWeights,T=0,o=_.length;T<o;T++)this.skinWeights.push(_[T].clone());for(_=e.skinIndices,T=0,o=_.length;T<o;T++)this.skinIndices.push(_[T].clone());for(_=e.lineDistances,T=0,o=_.length;T<o;T++)this.lineDistances.push(_[T]);return T=e.boundingBox,T!==null&&(this.boundingBox=T.clone()),T=e.boundingSphere,T!==null&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=e.elementsNeedUpdate,this.verticesNeedUpdate=e.verticesNeedUpdate,this.uvsNeedUpdate=e.uvsNeedUpdate,this.normalsNeedUpdate=e.normalsNeedUpdate,this.colorsNeedUpdate=e.colorsNeedUpdate,this.lineDistancesNeedUpdate=e.lineDistancesNeedUpdate,this.groupsNeedUpdate=e.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var o_=function(e){function o(h,m,_,T,R,z){e.call(this),this.type="BoxGeometry",this.parameters={width:h,height:m,depth:_,widthSegments:T,heightSegments:R,depthSegments:z},this.fromBufferGeometry(new Wv(h,m,_,T,R,z)),this.mergeVertices()}return e&&(o.__proto__=e),o.prototype=at(e&&e.prototype),o.prototype.constructor=o}(ft),Wv=function(e){function o(h,m,_,T,R,z){function k(Bt,Zt,bt,ae,Kt,fe,Xt,Me,Ne,pe,ke){var Fe=fe/Ne,Ar=Xt/pe,kr=fe/2,ir=Xt/2,zr=Me/2;Xt=Ne+1;for(var ui=pe+1,Kr=fe=0,Mi=new w,fi=0;fi<ui;fi++)for(var Hi=fi*Ar-ir,en=0;en<Xt;en++)Mi[Bt]=(en*Fe-kr)*ae,Mi[Zt]=Hi*Kt,Mi[bt]=zr,J.push(Mi.x,Mi.y,Mi.z),Mi[Bt]=0,Mi[Zt]=0,Mi[bt]=0<Me?1:-1,Q.push(Mi.x,Mi.y,Mi.z),K.push(en/Ne),K.push(1-fi/pe),fe+=1;for(Bt=0;Bt<pe;Bt++)for(Zt=0;Zt<Ne;Zt++)bt=rt+Zt+Xt*(Bt+1),ae=rt+(Zt+1)+Xt*(Bt+1),Kt=rt+(Zt+1)+Xt*Bt,q.push(rt+Zt+Xt*Bt,bt,Kt),q.push(bt,ae,Kt),Kr+=6;b.addGroup(lt,Kr,ke),lt+=Kr,rt+=fe}e.call(this),this.type="BoxBufferGeometry",this.parameters={width:h,height:m,depth:_,widthSegments:T,heightSegments:R,depthSegments:z};var b=this;h=h||1,m=m||1,_=_||1,T=Math.floor(T)||1,R=Math.floor(R)||1,z=Math.floor(z)||1;var q=[],J=[],Q=[],K=[],rt=0,lt=0;k("z","y","x",-1,-1,_,m,h,z,R,0),k("z","y","x",1,-1,_,m,-h,z,R,1),k("x","z","y",1,1,h,_,m,T,z,2),k("x","z","y",1,-1,h,_,-m,T,z,3),k("x","y","z",1,-1,h,m,_,T,R,4),k("x","y","z",-1,-1,h,m,-_,T,R,5),this.setIndex(q),this.setAttribute("position",new mt(J,3)),this.setAttribute("normal",new mt(Q,3)),this.setAttribute("uv",new mt(K,2))}return e&&(o.__proto__=e),o.prototype=at(e&&e.prototype),o.prototype.constructor=o}(ct),pM={clone:ve,merge:xe};me.prototype=at(re.prototype),me.prototype.constructor=me,me.prototype.isShaderMaterial=!0,me.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=ve(e.uniforms),this.defines=ut({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.lights=e.lights,this.clipping=e.clipping,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.extensions=ut({},e.extensions),this},me.prototype.toJSON=function(e){var o=re.prototype.toJSON.call(this,e);o.uniforms={};for(var h in this.uniforms){var m=this.uniforms[h].value;o.uniforms[h]=m&&m.isTexture?{type:"t",value:m.toJSON(e).uuid}:m&&m.isColor?{type:"c",value:m.getHex()}:m&&m.isVector2?{type:"v2",value:m.toArray()}:m&&m.isVector3?{type:"v3",value:m.toArray()}:m&&m.isVector4?{type:"v4",value:m.toArray()}:m&&m.isMatrix3?{type:"m3",value:m.toArray()}:m&&m.isMatrix4?{type:"m4",value:m.toArray()}:{value:m}}0<Pi(this.defines).length&&(o.defines=this.defines),o.vertexShader=this.vertexShader,o.fragmentShader=this.fragmentShader,e={};for(var _ in this.extensions)this.extensions[_]===!0&&(e[_]=!0);return 0<Pi(e).length&&(o.extensions=e),o},le.prototype=ut(at(F.prototype),{constructor:le,isCamera:!0,copy:function(e,o){return F.prototype.copy.call(this,e,o),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this},getWorldDirection:function(e){e===void 0&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new w),this.updateMatrixWorld(!0);var o=this.matrixWorld.elements;return e.set(-o[8],-o[9],-o[10]).normalize()},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.getInverse(this.matrixWorld)},updateWorldMatrix:function(e,o){F.prototype.updateWorldMatrix.call(this,e,o),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return new this.constructor().copy(this)}}),Ce.prototype=ut(at(le.prototype),{constructor:Ce,isPerspectiveCamera:!0,copy:function(e,o){return le.prototype.copy.call(this,e,o),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=e.view===null?null:ut({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this},setFocalLength:function(e){e=.5*this.getFilmHeight()/e,this.fov=2*di.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*di.DEG2RAD*this.fov);return .5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*di.RAD2DEG*Math.atan(Math.tan(.5*di.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,o,h,m,_,T){this.aspect=e/o,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=m,this.view.width=_,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,o=e*Math.tan(.5*di.DEG2RAD*this.fov)/this.zoom,h=2*o,m=this.aspect*h,_=-.5*m,T=this.view;if(this.view!==null&&this.view.enabled){var R=T.fullWidth,z=T.fullHeight;_+=T.offsetX*m/R,o-=T.offsetY*h/z,m*=T.width/R,h*=T.height/z}T=this.filmOffset,T!==0&&(_+=e*T/this.getFilmWidth()),this.projectionMatrix.makePerspective(_,_+m,o,o-h,e,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,this.view!==null&&(e.object.view=ut({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),xr.prototype=at(F.prototype),xr.prototype.constructor=xr,Br.prototype=at(A.prototype),Br.prototype.constructor=Br,Br.prototype.isWebGLCubeRenderTarget=!0,Br.prototype.fromEquirectangularTexture=function(e,o){this.texture.type=o.type,this.texture.format=o.format,this.texture.encoding=o.encoding;var h=new W,m=new me({type:"CubemapFromEquirect",uniforms:ve({tEquirect:{value:null}}),vertexShader:`varying vec3 vWorldDirection;
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,fragmentShader:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
}`,side:1,blending:0});return m.uniforms.tEquirect.value=o,o=new St(new Wv(5,5,5),m),h.add(o),new xr(1,10,this).update(e,h),o.geometry.dispose(),o.material.dispose(),this},Ae.prototype=at(g.prototype),Ae.prototype.constructor=Ae,Ae.prototype.isDataTexture=!0;var Mg=new tt,lx=new w;ut(ar.prototype,{set:function(e,o,h,m,_,T){var R=this.planes;return R[0].copy(e),R[1].copy(o),R[2].copy(h),R[3].copy(m),R[4].copy(_),R[5].copy(T),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){for(var o=this.planes,h=0;6>h;h++)o[h].copy(e.planes[h]);return this},setFromProjectionMatrix:function(e){var o=this.planes,h=e.elements;e=h[0];var m=h[1],_=h[2],T=h[3],R=h[4],z=h[5],k=h[6],b=h[7],q=h[8],J=h[9],Q=h[10],K=h[11],rt=h[12],lt=h[13],Bt=h[14];return h=h[15],o[0].setComponents(T-e,b-R,K-q,h-rt).normalize(),o[1].setComponents(T+e,b+R,K+q,h+rt).normalize(),o[2].setComponents(T+m,b+z,K+J,h+lt).normalize(),o[3].setComponents(T-m,b-z,K-J,h-lt).normalize(),o[4].setComponents(T-_,b-k,K-Q,h-Bt).normalize(),o[5].setComponents(T+_,b+k,K+Q,h+Bt).normalize(),this},intersectsObject:function(e){var o=e.geometry;return o.boundingSphere===null&&o.computeBoundingSphere(),Mg.copy(o.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(Mg)},intersectsSprite:function(e){return Mg.center.set(0,0,0),Mg.radius=.7071067811865476,Mg.applyMatrix4(e.matrixWorld),this.intersectsSphere(Mg)},intersectsSphere:function(e){var o=this.planes,h=e.center;e=-e.radius;for(var m=0;6>m;m++)if(o[m].distanceToPoint(h)<e)return!1;return!0},intersectsBox:function(e){for(var o=this.planes,h=0;6>h;h++){var m=o[h];if(lx.x=0<m.normal.x?e.max.x:e.min.x,lx.y=0<m.normal.y?e.max.y:e.min.y,lx.z=0<m.normal.z?e.max.z:e.min.z,0>m.distanceToPoint(lx))return!1}return!0},containsPoint:function(e){for(var o=this.planes,h=0;6>h;h++)if(0>o[h].distanceToPoint(e))return!1;return!0}});var dr={common:{diffuse:{value:new yt(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new c},uv2Transform:{value:new c},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new f(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new yt(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new yt(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}},sprite:{diffuse:{value:new yt(15658734)},opacity:{value:1},center:{value:new f(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new c}}};Sn.prototype=at(ft.prototype),Sn.prototype.constructor=Sn,Ai.prototype=at(ct.prototype),Ai.prototype.constructor=Ai;var Si={alphamap_fragment:`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,alphamap_pars_fragment:`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,alphatest_fragment:`#ifdef ALPHATEST
	if ( diffuseColor.a < ALPHATEST ) discard;
#endif`,aomap_fragment:`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );
	#endif
#endif`,aomap_pars_fragment:`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bsdfs:`vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	return vec2( -1.04, 1.04 ) * a004 + r.zw;
}
float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
#if defined ( PHYSICALLY_CORRECT_LIGHTS )
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
#else
	if( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
		return pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );
	}
	return 1.0;
#endif
}
vec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {
	float fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );
	return ( 1.0 - specularColor ) * fresnel + specularColor;
}
vec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {
	float fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );
	vec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;
	return Fr * fresnel + F0;
}
float G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	float gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	return 1.0 / ( gl * gv );
}
float G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( incidentLight.direction + viewDir );
	float dotNL = saturate( dot( normal, incidentLight.direction ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( G * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE  = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS  = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
vec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	return specularColor * brdf.x + brdf.y;
}
void BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
	vec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );
	vec2 brdf = integrateSpecularBRDF( dotNV, roughness );
	vec3 FssEss = F * brdf.x + brdf.y;
	float Ess = brdf.x + brdf.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );
	float dotNH = saturate( dot( geometry.normal, halfDir ) );
	float dotLH = saturate( dot( incidentLight.direction, halfDir ) );
	vec3 F = F_Schlick( specularColor, dotLH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
float GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {
	return ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );
}
float BlinnExponentToGGXRoughness( const in float blinnExponent ) {
	return sqrt( 2.0 / ( blinnExponent + 2.0 ) );
}
#if defined( USE_SHEEN )
float D_Charlie(float roughness, float NoH) {
	float invAlpha  = 1.0 / roughness;
	float cos2h = NoH * NoH;
	float sin2h = max(1.0 - cos2h, 0.0078125);	return (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);
}
float V_Neubelt(float NoV, float NoL) {
	return saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));
}
vec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {
	vec3 N = geometry.normal;
	vec3 V = geometry.viewDir;
	vec3 H = normalize( V + L );
	float dotNH = saturate( dot( N, H ) );
	return specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );
}
#endif`,bumpmap_pars_fragment:`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 );
		fDet *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,clipping_planes_fragment:`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,clipping_planes_pars_fragment:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,clipping_planes_pars_vertex:`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,clipping_planes_vertex:`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,color_fragment:`#ifdef USE_COLOR
	diffuseColor.rgb *= vColor;
#endif`,color_pars_fragment:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_pars_vertex:`#ifdef USE_COLOR
	varying vec3 vColor;
#endif`,color_vertex:`#ifdef USE_COLOR
	vColor.xyz = color.xyz;
#endif`,common:`#define PI 3.14159265359
#define PI2 6.28318530718
#define PI_HALF 1.5707963267949
#define RECIPROCAL_PI 0.31830988618
#define RECIPROCAL_PI2 0.15915494
#define LOG2 1.442695
#define EPSILON 1e-6
#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement(a) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract(sin(sn) * c);
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
vec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	float distance = dot( planeNormal, point - pointOnPlane );
	return - distance * planeNormal + point;
}
float sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return sign( dot( point - pointOnPlane, planeNormal ) );
}
vec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {
	return lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
  return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,cube_uv_reflection_fragment:`#ifdef ENVMAP_TYPE_CUBE_UV
#define cubeUV_maxMipLevel 8.0
#define cubeUV_minMipLevel 4.0
#define cubeUV_maxTileSize 256.0
#define cubeUV_minTileSize 16.0
float getFace(vec3 direction) {
    vec3 absDirection = abs(direction);
    float face = -1.0;
    if (absDirection.x > absDirection.z) {
      if (absDirection.x > absDirection.y)
        face = direction.x > 0.0 ? 0.0 : 3.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    } else {
      if (absDirection.z > absDirection.y)
        face = direction.z > 0.0 ? 2.0 : 5.0;
      else
        face = direction.y > 0.0 ? 1.0 : 4.0;
    }
    return face;
}
vec2 getUV(vec3 direction, float face) {
    vec2 uv;
    if (face == 0.0) {
      uv = vec2(direction.z, direction.y) / abs(direction.x);    } else if (face == 1.0) {
      uv = vec2(-direction.x, -direction.z) / abs(direction.y);    } else if (face == 2.0) {
      uv = vec2(-direction.x, direction.y) / abs(direction.z);    } else if (face == 3.0) {
      uv = vec2(-direction.z, direction.y) / abs(direction.x);    } else if (face == 4.0) {
      uv = vec2(-direction.x, direction.z) / abs(direction.y);    } else {
      uv = vec2(direction.x, direction.y) / abs(direction.z);    }
    return 0.5 * (uv + 1.0);
}
vec3 bilinearCubeUV(sampler2D envMap, vec3 direction, float mipInt) {
  float face = getFace(direction);
  float filterInt = max(cubeUV_minMipLevel - mipInt, 0.0);
  mipInt = max(mipInt, cubeUV_minMipLevel);
  float faceSize = exp2(mipInt);
  float texelSize = 1.0 / (3.0 * cubeUV_maxTileSize);
  vec2 uv = getUV(direction, face) * (faceSize - 1.0);
  vec2 f = fract(uv);
  uv += 0.5 - f;
  if (face > 2.0) {
    uv.y += faceSize;
    face -= 3.0;
  }
  uv.x += face * faceSize;
  if(mipInt < cubeUV_maxMipLevel){
    uv.y += 2.0 * cubeUV_maxTileSize;
  }
  uv.y += filterInt * 2.0 * cubeUV_minTileSize;
  uv.x += 3.0 * max(0.0, cubeUV_maxTileSize - 2.0 * faceSize);
  uv *= texelSize;
  vec3 tl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x += texelSize;
  vec3 tr = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.y += texelSize;
  vec3 br = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  uv.x -= texelSize;
  vec3 bl = envMapTexelToLinear(texture2D(envMap, uv)).rgb;
  vec3 tm = mix(tl, tr, f.x);
  vec3 bm = mix(bl, br, f.x);
  return mix(tm, bm, f.y);
}
#define r0 1.0
#define v0 0.339
#define m0 -2.0
#define r1 0.8
#define v1 0.276
#define m1 -1.0
#define r4 0.4
#define v4 0.046
#define m4 2.0
#define r5 0.305
#define v5 0.016
#define m5 3.0
#define r6 0.21
#define v6 0.0038
#define m6 4.0
float roughnessToMip(float roughness) {
  float mip = 0.0;
  if (roughness >= r1) {
    mip = (r0 - roughness) * (m1 - m0) / (r0 - r1) + m0;
  } else if (roughness >= r4) {
    mip = (r1 - roughness) * (m4 - m1) / (r1 - r4) + m1;
  } else if (roughness >= r5) {
    mip = (r4 - roughness) * (m5 - m4) / (r4 - r5) + m4;
  } else if (roughness >= r6) {
    mip = (r5 - roughness) * (m6 - m5) / (r5 - r6) + m5;
  } else {
    mip = -2.0 * log2(1.16 * roughness);  }
  return mip;
}
vec4 textureCubeUV(sampler2D envMap, vec3 sampleDir, float roughness) {
  float mip = clamp(roughnessToMip(roughness), m0, cubeUV_maxMipLevel);
  float mipF = fract(mip);
  float mipInt = floor(mip);
  vec3 color0 = bilinearCubeUV(envMap, sampleDir, mipInt);
  if (mipF == 0.0) {
    return vec4(color0, 1.0);
  } else {
    vec3 color1 = bilinearCubeUV(envMap, sampleDir, mipInt + 1.0);
    return vec4(mix(color0, color1, mipF), 1.0);
  }
}
#endif`,defaultnormal_vertex:`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,displacementmap_pars_vertex:`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,displacementmap_vertex:`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,emissivemap_fragment:`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,emissivemap_pars_fragment:`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:`
vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 GammaToLinear( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );
}
vec4 LinearToGamma( in vec4 value, in float gammaFactor ) {
	return vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );
}
vec4 sRGBToLinear( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}
vec4 RGBEToLinear( in vec4 value ) {
	return vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );
}
vec4 LinearToRGBE( in vec4 value ) {
	float maxComponent = max( max( value.r, value.g ), value.b );
	float fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );
	return vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );
}
vec4 RGBMToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * value.a * maxRange, 1.0 );
}
vec4 LinearToRGBM( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float M = clamp( maxRGB / maxRange, 0.0, 1.0 );
	M = ceil( M * 255.0 ) / 255.0;
	return vec4( value.rgb / ( M * maxRange ), M );
}
vec4 RGBDToLinear( in vec4 value, in float maxRange ) {
	return vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );
}
vec4 LinearToRGBD( in vec4 value, in float maxRange ) {
	float maxRGB = max( value.r, max( value.g, value.b ) );
	float D = max( maxRange / maxRGB, 1.0 );
	D = clamp( floor( D ) / 255.0, 0.0, 1.0 );
	return vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );
}
const mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );
vec4 LinearToLogLuv( in vec4 value )  {
	vec3 Xp_Y_XYZp = cLogLuvM * value.rgb;
	Xp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );
	vec4 vResult;
	vResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;
	float Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;
	vResult.w = fract( Le );
	vResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;
	return vResult;
}
const mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );
vec4 LogLuvToLinear( in vec4 value ) {
	float Le = value.z * 255.0 + value.w;
	vec3 Xp_Y_XYZp;
	Xp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );
	Xp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;
	Xp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;
	vec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;
	return vec4( max( vRGB, 0.0 ), 1.0 );
}`,envmap_fragment:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		}  else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#elif defined( ENVMAP_TYPE_EQUIREC )
		reflectVec = normalize( reflectVec );
		vec2 sampleUV = equirectUv( reflectVec );
		vec4 envColor = texture2D( envMap, sampleUV );
	#elif defined( ENVMAP_TYPE_SPHERE )
		reflectVec = normalize( reflectVec );
		vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );
		vec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifndef ENVMAP_TYPE_CUBE_UV
		envColor = envMapTexelToLinear( envColor );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,envmap_common_pars_fragment:`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform int maxMipLevel;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,envmap_pars_fragment:`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,envmap_pars_vertex:`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,envmap_physical_pars_fragment:`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {
		vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );
			#else
				vec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
		#else
			vec4 envMapColor = vec4( 0.0 );
		#endif
		return PI * envMapColor.rgb * envMapIntensity;
	}
	float getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {
		float maxMIPLevelScalar = float( maxMIPLevel );
		float sigma = PI * roughness * roughness / ( 1.0 + roughness );
		float desiredMIPLevel = maxMIPLevelScalar + log2( sigma );
		return clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );
	}
	vec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {
		#ifdef ENVMAP_MODE_REFLECTION
		  vec3 reflectVec = reflect( -viewDir, normal );
		  reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
		#else
		  vec3 reflectVec = refract( -viewDir, normal, refractionRatio );
		#endif
		reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
		float specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );
		#ifdef ENVMAP_TYPE_CUBE
			vec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );
			#else
				vec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_CUBE_UV )
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
		#elif defined( ENVMAP_TYPE_EQUIREC )
			vec2 sampleUV = equirectUv( reflectVec );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#elif defined( ENVMAP_TYPE_SPHERE )
			vec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );
			#ifdef TEXTURE_LOD_EXT
				vec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#else
				vec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );
			#endif
			envMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;
		#endif
		return envMapColor.rgb * envMapIntensity;
	}
#endif`,envmap_vertex:`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) { 
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,fog_vertex:`#ifdef USE_FOG
	fogDepth = -mvPosition.z;
#endif`,fog_pars_vertex:`#ifdef USE_FOG
	varying float fogDepth;
#endif`,fog_fragment:`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, fogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,fog_pars_fragment:`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float fogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,gradientmap_pars_fragment:`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return texture2D( gradientMap, coord ).rgb;
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,lightmap_fragment:`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel= texture2D( lightMap, vUv2 );
	reflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
#endif`,lightmap_pars_fragment:`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,lights_lambert_vertex:`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = PI * directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( -dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );
		#endif
	}
	#pragma unroll_loop_end
#endif`,lights_pars_begin:`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {
	vec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	return irradiance;
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	void getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		directLight.color = directionalLight.color;
		directLight.direction = directionalLight.direction;
		directLight.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
		struct PointLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	void getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {
		vec3 lVector = pointLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		directLight.color = pointLight.color;
		directLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );
		directLight.visible = ( directLight.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	void getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {
		vec3 lVector = spotLight.position - geometry.position;
		directLight.direction = normalize( lVector );
		float lightDistance = length( lVector );
		float angleCos = dot( directLight.direction, spotLight.direction );
		if ( angleCos > spotLight.coneCos ) {
			float spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );
			directLight.color = spotLight.color;
			directLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );
			directLight.visible = true;
		} else {
			directLight.color = vec3( 0.0 );
			directLight.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {
		float dotNL = dot( geometry.normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			irradiance *= PI;
		#endif
		return irradiance;
	}
#endif`,lights_toon_fragment:`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_toon_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct ToonMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,lights_phong_fragment:`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,lights_phong_pars_fragment:`varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
struct BlinnPhongMaterial {
	vec3	diffuseColor;
	vec3	specularColor;
	float	specularShininess;
	float	specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,lights_physical_fragment:`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;
material.specularRoughness = min( material.specularRoughness, 1.0 );
#ifdef REFLECTIVITY
	material.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );
#endif
#ifdef CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheen;
#endif`,lights_physical_pars_fragment:`struct PhysicalMaterial {
	vec3	diffuseColor;
	float	specularRoughness;
	vec3	specularColor;
#ifdef CLEARCOAT
	float clearcoat;
	float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	vec3 sheenColor;
#endif
};
#define MAXIMUM_SPECULAR_COEFFICIENT 0.16
#define DEFAULT_SPECULAR_COEFFICIENT 0.04
float clearcoatDHRApprox( const in float roughness, const in float dotNL ) {
	return DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.specularRoughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		irradiance *= PI;
	#endif
	#ifdef CLEARCOAT
		float ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = ccDotNL * directLight.color;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			ccIrradiance *= PI;
		#endif
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
		reflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
	#else
		float clearcoatDHR = 0.0;
	#endif
	#ifdef USE_SHEEN
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(
			material.specularRoughness,
			directLight.direction,
			geometry,
			material.sheenColor
		);
	#else
		reflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);
	#endif
	reflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef CLEARCOAT
		float ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		reflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );
		float ccDotNL = ccDotNV;
		float clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );
	#else
		float clearcoatDHR = 0.0;
	#endif
	float clearcoatInv = 1.0 - clearcoatDHR;
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	BRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lights_fragment_begin:`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointDirectLightIrradiance( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotDirectLightIrradiance( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,lights_fragment_maps:`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );
	#ifdef CLEARCOAT
		clearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );
	#endif
#endif`,lights_fragment_end:`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,logdepthbuf_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,logdepthbuf_pars_fragment:`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,logdepthbuf_pars_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,logdepthbuf_vertex:`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,map_fragment:`#ifdef USE_MAP
	vec4 texelColor = texture2D( map, vUv );
	texelColor = mapTexelToLinear( texelColor );
	diffuseColor *= texelColor;
#endif`,map_pars_fragment:`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,map_particle_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	vec4 mapTexel = texture2D( map, uv );
	diffuseColor *= mapTexelToLinear( mapTexel );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,map_particle_pars_fragment:`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,metalnessmap_fragment:`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,metalnessmap_pars_fragment:`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,morphnormal_vertex:`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
	objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
	objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
	objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
#endif`,morphtarget_pars_vertex:`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifndef USE_MORPHNORMALS
	uniform float morphTargetInfluences[ 8 ];
	#else
	uniform float morphTargetInfluences[ 4 ];
	#endif
#endif`,morphtarget_vertex:`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	transformed += morphTarget0 * morphTargetInfluences[ 0 ];
	transformed += morphTarget1 * morphTargetInfluences[ 1 ];
	transformed += morphTarget2 * morphTargetInfluences[ 2 ];
	transformed += morphTarget3 * morphTargetInfluences[ 3 ];
	#ifndef USE_MORPHNORMALS
	transformed += morphTarget4 * morphTargetInfluences[ 4 ];
	transformed += morphTarget5 * morphTargetInfluences[ 5 ];
	transformed += morphTarget6 * morphTargetInfluences[ 6 ];
	transformed += morphTarget7 * morphTargetInfluences[ 7 ];
	#endif
#endif`,normal_fragment_begin:`#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
			bitangent = bitangent * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,normal_fragment_maps:`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( -vViewPosition, normal, mapN );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );
#endif`,normalmap_pars_fragment:`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		float scale = sign( st1.t * st0.s - st0.t * st1.s );
		vec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );
		vec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );
		vec3 N = normalize( surf_norm );
		mat3 tsn = mat3( S, T, N );
		mapN.xy *= ( float( gl_FrontFacing ) * 2.0 - 1.0 );
		return normalize( tsn * mapN );
	}
#endif`,clearcoat_normal_fragment_begin:`#ifdef CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,clearcoat_normal_fragment_maps:`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN );
	#endif
#endif`,clearcoat_pars_fragment:`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,packing:`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return (( near + viewZ ) * far ) / (( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,premultiplied_alpha_fragment:`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,project_vertex:`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,dithering_fragment:`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,dithering_pars_fragment:`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,roughnessmap_fragment:`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,roughnessmap_pars_fragment:`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,shadowmap_pars_fragment:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,shadowmap_pars_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,shadowmap_vertex:`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,shadowmask_pars_fragment:`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,skinbase_vertex:`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,skinning_pars_vertex:`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,skinning_vertex:`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,skinnormal_vertex:`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,specularmap_fragment:`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,specularmap_pars_fragment:`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,tonemapping_fragment:`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,tonemapping_pars_fragment:`#ifndef saturate
#define saturate(a) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
uniform float toneMappingWhitePoint;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )
vec3 Uncharted2ToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( ( color * ( 2.51 * color + 0.03 ) ) / ( color * ( 2.43 * color + 0.59 ) + 0.14 ) );
}`,uv_pars_fragment:`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,uv_pars_vertex:`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,uv_vertex:`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,uv2_pars_fragment:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,uv2_pars_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,uv2_vertex:`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,worldpos_vertex:`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	vec4 texColor = texture2D( tEquirect, sampleUV );
	gl_FragColor = mapTexelToLinear( texColor );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
	
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <skinbase_vertex>
	#ifdef USE_ENVMAP
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
		matcapColor = matcapTexelToLinear( matcapColor );
	#else
		vec4 matcapColor = vec4( 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#ifndef FLAT_SHADED
		vNormal = normalize( transformedNormal );
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define REFLECTIVITY
	#define CLEARCOAT
	#define TRANSPARENCY
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef TRANSPARENCY
	uniform float transparency;
#endif
#ifdef REFLECTIVITY
	uniform float reflectivity;
#endif
#ifdef CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheen;
#endif
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <lights_physical_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#ifdef TRANSPARENCY
		diffuseColor.a *= saturate( 1. - transparency + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );
	#endif
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,normal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <packing>
#include <uv_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,normal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,shadow_vert:`#include <fog_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <begin_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	gl_FragColor = vec4( outgoingLight, diffuseColor.a );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`},hl={basic:{uniforms:xe([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.fog]),vertexShader:Si.meshbasic_vert,fragmentShader:Si.meshbasic_frag},lambert:{uniforms:xe([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.fog,dr.lights,{emissive:{value:new yt(0)}}]),vertexShader:Si.meshlambert_vert,fragmentShader:Si.meshlambert_frag},phong:{uniforms:xe([dr.common,dr.specularmap,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.fog,dr.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:Si.meshphong_vert,fragmentShader:Si.meshphong_frag},standard:{uniforms:xe([dr.common,dr.envmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.roughnessmap,dr.metalnessmap,dr.fog,dr.lights,{emissive:{value:new yt(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Si.meshphysical_vert,fragmentShader:Si.meshphysical_frag},toon:{uniforms:xe([dr.common,dr.specularmap,dr.aomap,dr.lightmap,dr.emissivemap,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.gradientmap,dr.fog,dr.lights,{emissive:{value:new yt(0)},specular:{value:new yt(1118481)},shininess:{value:30}}]),vertexShader:Si.meshtoon_vert,fragmentShader:Si.meshtoon_frag},matcap:{uniforms:xe([dr.common,dr.bumpmap,dr.normalmap,dr.displacementmap,dr.fog,{matcap:{value:null}}]),vertexShader:Si.meshmatcap_vert,fragmentShader:Si.meshmatcap_frag},points:{uniforms:xe([dr.points,dr.fog]),vertexShader:Si.points_vert,fragmentShader:Si.points_frag},dashed:{uniforms:xe([dr.common,dr.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Si.linedashed_vert,fragmentShader:Si.linedashed_frag},depth:{uniforms:xe([dr.common,dr.displacementmap]),vertexShader:Si.depth_vert,fragmentShader:Si.depth_frag},normal:{uniforms:xe([dr.common,dr.bumpmap,dr.normalmap,dr.displacementmap,{opacity:{value:1}}]),vertexShader:Si.normal_vert,fragmentShader:Si.normal_frag},sprite:{uniforms:xe([dr.sprite,dr.fog]),vertexShader:Si.sprite_vert,fragmentShader:Si.sprite_frag},background:{uniforms:{uvTransform:{value:new c},t2D:{value:null}},vertexShader:Si.background_vert,fragmentShader:Si.background_frag},cube:{uniforms:xe([dr.envmap,{opacity:{value:1}}]),vertexShader:Si.cube_vert,fragmentShader:Si.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Si.equirect_vert,fragmentShader:Si.equirect_frag},distanceRGBA:{uniforms:xe([dr.common,dr.displacementmap,{referencePosition:{value:new w},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Si.distanceRGBA_vert,fragmentShader:Si.distanceRGBA_frag},shadow:{uniforms:xe([dr.lights,dr.fog,{color:{value:new yt(0)},opacity:{value:1}}]),vertexShader:Si.shadow_vert,fragmentShader:Si.shadow_frag}};hl.physical={uniforms:xe([hl.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new f(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new yt(0)},transparency:{value:0}}]),vertexShader:Si.meshphysical_vert,fragmentShader:Si.meshphysical_frag},Sa.prototype=at(g.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isCubeTexture=!0,Object.defineProperty(Sa.prototype,"images",{get:function(){return this.image},set:function(e){this.image=e}}),es.prototype=at(g.prototype),es.prototype.constructor=es,es.prototype.isDataTexture2DArray=!0,ys.prototype=at(g.prototype),ys.prototype.constructor=ys,ys.prototype.isDataTexture3D=!0;var dM=new g,iT=new es,nT=new ys,gM=new Sa,mM=[],vM=[],yM=new Float32Array(16),xM=new Float32Array(9),AM=new Float32Array(4);_w.prototype.updateCache=function(e){var o=this.cache;e instanceof Float32Array&&o.length!==e.length&&(this.cache=new Float32Array(e.length)),Bo(o,e)},ww.prototype.setValue=function(e,o,h){for(var m=this.seq,_=0,T=m.length;_!==T;++_){var R=m[_];R.setValue(e,o[R.id],h)}};var s_=/([\w\d_]+)(\])?(\[|\.)?/g;lc.prototype.setValue=function(e,o,h,m){o=this.map[o],o!==void 0&&o.setValue(e,h,m)},lc.prototype.setOptional=function(e,o,h){o=o[h],o!==void 0&&this.setValue(e,h,o)},lc.upload=function(e,o,h,m){for(var _=0,T=o.length;_!==T;++_){var R=o[_],z=h[R.id];z.needsUpdate!==!1&&R.setValue(e,z.value,m)}},lc.seqWithValue=function(e,o){for(var h=[],m=0,_=e.length;m!==_;++m){var T=e[m];T.id in o&&h.push(T)}return h};var oT=0,a_=/^[ \t]*#include +<([\w\d./]+)>/gm,_M=/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,wM=/#pragma unroll_loop_start[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}[\s]+?#pragma unroll_loop_end/g,sT=0;hc.prototype=at(re.prototype),hc.prototype.constructor=hc,hc.prototype.isMeshDepthMaterial=!0,hc.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.depthPacking=e.depthPacking,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this},cc.prototype=at(re.prototype),cc.prototype.constructor=cc,cc.prototype.isMeshDistanceMaterial=!0,cc.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.referencePosition.copy(e.referencePosition),this.nearDistance=e.nearDistance,this.farDistance=e.farDistance,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this},py.prototype=ut(at(Ce.prototype),{constructor:py,isArrayCamera:!0}),Hd.prototype=ut(at(F.prototype),{constructor:Hd,isGroup:!0}),ut(dy.prototype,{constructor:dy,getTargetRaySpace:function(){return this._targetRay===null&&(this._targetRay=new Hd,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return this._grip===null&&(this._grip=new Hd,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return this._targetRay!==null&&this._targetRay.dispatchEvent(e),this._grip!==null&&this._grip.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this},update:function(e,o,h){var m=null,_=null,T=this._targetRay,R=this._grip;return e&&(T!==null&&(m=o.getPose(e.targetRaySpace,h),m!==null&&(T.matrix.fromArray(m.transform.matrix),T.matrix.decompose(T.position,T.rotation,T.scale))),R!==null&&e.gripSpace&&(_=o.getPose(e.gripSpace,h),_!==null&&(R.matrix.fromArray(_.transform.matrix),R.matrix.decompose(R.position,R.rotation,R.scale)))),T!==null&&(T.visible=m!==null),R!==null&&(R.visible=_!==null),this}}),ut(Fw.prototype,s.prototype),ut(gy.prototype,{isFogExp2:!0,clone:function(){return new gy(this.color,this.density)},toJSON:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}),ut(my.prototype,{isFog:!0,clone:function(){return new my(this.color,this.near,this.far)},toJSON:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}),Object.defineProperty(oh.prototype,"needsUpdate",{set:function(e){e===!0&&this.version++}}),ut(oh.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this},copyAt:function(e,o,h){e*=this.stride,h*=o.stride;for(var m=0,_=this.stride;m<_;m++)this.array[e+m]=o.array[h+m];return this},set:function(e,o){return o===void 0&&(o=0),this.array.set(e,o),this},clone:function(){return new this.constructor().copy(this)},onUpload:function(e){return this.onUploadCallback=e,this}});var np=new w;Gr(nv.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),ut(nv.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var o=0,h=this.data.count;o<h;o++)np.x=this.getX(o),np.y=this.getY(o),np.z=this.getZ(o),np.applyMatrix4(e),this.setXYZ(o,np.x,np.y,np.z);return this},setX:function(e,o){return this.data.array[e*this.data.stride+this.offset]=o,this},setY:function(e,o){return this.data.array[e*this.data.stride+this.offset+1]=o,this},setZ:function(e,o){return this.data.array[e*this.data.stride+this.offset+2]=o,this},setW:function(e,o){return this.data.array[e*this.data.stride+this.offset+3]=o,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,o,h){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this},setXYZ:function(e,o,h,m){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this.data.array[e+2]=m,this},setXYZW:function(e,o,h,m,_){return e=e*this.data.stride+this.offset,this.data.array[e+0]=o,this.data.array[e+1]=h,this.data.array[e+2]=m,this.data.array[e+3]=_,this},clone:function(){for(var e=[],o=0;o<this.count;o++)for(var h=o*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[h+m]);return new ce(new this.array.constructor(e),this.itemSize,this.normalized)},toJSON:function(){for(var e=[],o=0;o<this.count;o++)for(var h=o*this.data.stride+this.offset,m=0;m<this.itemSize;m++)e.push(this.data.array[h+m]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}),fc.prototype=at(re.prototype),fc.prototype.constructor=fc,fc.prototype.isSpriteMaterial=!0,fc.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this};var Cg,jv=new w,Tg=new w,Sg=new w,Ig=new f,Xv=new f,MM=new I,hx=new w,Yv=new w,cx=new w,CM=new f,u_=new f,TM=new f;ov.prototype=ut(at(F.prototype),{constructor:ov,isSprite:!0,raycast:function(e,o){e.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Tg.setFromMatrixScale(this.matrixWorld),MM.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Sg.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&Tg.multiplyScalar(-Sg.z);var h=this.material.rotation;if(h!==0)var m=Math.cos(h),_=Math.sin(h);h=this.center,vy(hx.set(-.5,-.5,0),Sg,h,Tg,_,m),vy(Yv.set(.5,-.5,0),Sg,h,Tg,_,m),vy(cx.set(.5,.5,0),Sg,h,Tg,_,m),CM.set(0,0),u_.set(1,0),TM.set(1,1);var T=e.ray.intersectTriangle(hx,Yv,cx,!1,jv);T===null&&(vy(Yv.set(-.5,.5,0),Sg,h,Tg,_,m),u_.set(0,1),T=e.ray.intersectTriangle(hx,cx,Yv,!1,jv),T===null)||(_=e.ray.origin.distanceTo(jv),_<e.near||_>e.far||o.push({distance:_,point:jv.clone(),uv:At.getUV(jv,hx,Yv,cx,CM,u_,TM,new f),face:null,object:this}))},clone:function(){return new this.constructor(this.material).copy(this)},copy:function(e){return F.prototype.copy.call(this,e),e.center!==void 0&&this.center.copy(e.center),this}});var fx=new w,SM=new w;sv.prototype=ut(at(F.prototype),{constructor:sv,isLOD:!0,copy:function(e){F.prototype.copy.call(this,e,!1);for(var o=e.levels,h=0,m=o.length;h<m;h++){var _=o[h];this.addLevel(_.object.clone(),_.distance)}return this.autoUpdate=e.autoUpdate,this},addLevel:function(e,o){o===void 0&&(o=0),o=Math.abs(o);for(var h=this.levels,m=0;m<h.length&&!(o<h[m].distance);m++);return h.splice(m,0,{distance:o,object:e}),this.add(e),this},getCurrentLevel:function(){return this._currentLevel},getObjectForDistance:function(e){var o=this.levels;if(0<o.length){for(var h=1,m=o.length;h<m&&!(e<o[h].distance);h++);return o[h-1].object}return null},raycast:function(e,o){if(0<this.levels.length){fx.setFromMatrixPosition(this.matrixWorld);var h=e.ray.origin.distanceTo(fx);this.getObjectForDistance(h).raycast(e,o)}},update:function(e){var o=this.levels;if(1<o.length){fx.setFromMatrixPosition(e.matrixWorld),SM.setFromMatrixPosition(this.matrixWorld),e=fx.distanceTo(SM)/e.zoom,o[0].object.visible=!0;for(var h=1,m=o.length;h<m&&e>=o[h].distance;h++)o[h-1].object.visible=!1,o[h].object.visible=!0;for(this._currentLevel=h-1;h<m;h++)o[h].object.visible=!1}},toJSON:function(e){e=F.prototype.toJSON.call(this,e),this.autoUpdate===!1&&(e.object.autoUpdate=!1),e.object.levels=[];for(var o=this.levels,h=0,m=o.length;h<m;h++){var _=o[h];e.object.levels.push({object:_.object.uuid,distance:_.distance})}return e}}),yy.prototype=ut(at(St.prototype),{constructor:yy,isSkinnedMesh:!0,bind:function(e,o){this.skeleton=e,o===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),o=this.matrixWorld),this.bindMatrix.copy(o),this.bindMatrixInverse.getInverse(o)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new p,o=this.geometry.attributes.skinWeight,h=0,m=o.count;h<m;h++){e.x=o.getX(h),e.y=o.getY(h),e.z=o.getZ(h),e.w=o.getW(h);var _=1/e.manhattanLength();_!==1/0?e.multiplyScalar(_):e.set(1,0,0,0),o.setXYZW(h,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){St.prototype.updateMatrixWorld.call(this,e),this.bindMode==="attached"?this.bindMatrixInverse.getInverse(this.matrixWorld):this.bindMode==="detached"?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)},boneTransform:function(){var e=new w,o=new p,h=new p,m=new w,_=new I;return function(T,R){var z=this.skeleton,k=this.geometry;for(o.fromBufferAttribute(k.attributes.skinIndex,T),h.fromBufferAttribute(k.attributes.skinWeight,T),e.fromBufferAttribute(k.attributes.position,T).applyMatrix4(this.bindMatrix),R.set(0,0,0),T=0;4>T;T++)if(k=h.getComponent(T),k!==0){var b=o.getComponent(T);_.multiplyMatrices(z.bones[b].matrixWorld,z.boneInverses[b]),R.addScaledVector(m.copy(e).applyMatrix4(_),k)}return R.applyMatrix4(this.bindMatrixInverse)}}()});var IM=new I,aT=new I;ut(xy.prototype,{calculateInverses:function(){this.boneInverses=[];for(var e=0,o=this.bones.length;e<o;e++){var h=new I;this.bones[e]&&h.getInverse(this.bones[e].matrixWorld),this.boneInverses.push(h)}},pose:function(){var e,o,h=0;for(o=this.bones.length;h<o;h++)(e=this.bones[h])&&e.matrixWorld.getInverse(this.boneInverses[h]);for(h=0,o=this.bones.length;h<o;h++)(e=this.bones[h])&&(e.parent&&e.parent.isBone?(e.matrix.getInverse(e.parent.matrixWorld),e.matrix.multiply(e.matrixWorld)):e.matrix.copy(e.matrixWorld),e.matrix.decompose(e.position,e.quaternion,e.scale))},update:function(){for(var e=this.bones,o=this.boneInverses,h=this.boneMatrices,m=this.boneTexture,_=0,T=e.length;_<T;_++)IM.multiplyMatrices(e[_]?e[_].matrixWorld:aT,o[_]),IM.toArray(h,16*_);m!==void 0&&(m.needsUpdate=!0)},clone:function(){return new xy(this.bones,this.boneInverses)},getBoneByName:function(e){for(var o=0,h=this.bones.length;o<h;o++){var m=this.bones[o];if(m.name===e)return m}},dispose:function(){this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=void 0)}}),c2.prototype=ut(at(F.prototype),{constructor:c2,isBone:!0});var EM=new I,LM=new I,px=[],Zv=new St;Ay.prototype=ut(at(St.prototype),{constructor:Ay,isInstancedMesh:!0,getMatrixAt:function(e,o){o.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,o){var h=this.matrixWorld,m=this.count;if(Zv.geometry=this.geometry,Zv.material=this.material,Zv.material!==void 0)for(var _=0;_<m;_++){this.getMatrixAt(_,EM),LM.multiplyMatrices(h,EM),Zv.matrixWorld=LM,Zv.raycast(e,px);for(var T=0,R=px.length;T<R;T++){var z=px[T];z.instanceId=_,z.object=this,o.push(z)}px.length=0}},setMatrixAt:function(e,o){o.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){}}),In.prototype=at(re.prototype),In.prototype.constructor=In,In.prototype.isLineBasicMaterial=!0,In.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.morphTargets=e.morphTargets,this};var RM=new w,PM=new w,DM=new I,dx=new st,gx=new tt;ea.prototype=ut(at(F.prototype),{constructor:ea,isLine:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var o=e.attributes.position,h=[0],m=1,_=o.count;m<_;m++)RM.fromBufferAttribute(o,m-1),PM.fromBufferAttribute(o,m),h[m]=h[m-1],h[m]+=RM.distanceTo(PM);e.setAttribute("lineDistance",new mt(h,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(o=e.vertices,h=e.lineDistances,h[0]=0,m=1,_=o.length;m<_;m++)h[m]=h[m-1],h[m]+=o[m-1].distanceTo(o[m]);return this},raycast:function(e,o){var h=this.geometry,m=this.matrixWorld,_=e.params.Line.threshold;if(h.boundingSphere===null&&h.computeBoundingSphere(),gx.copy(h.boundingSphere),gx.applyMatrix4(m),gx.radius+=_,e.ray.intersectsSphere(gx)!==!1){DM.getInverse(m),dx.copy(e.ray).applyMatrix4(DM),m=_/((this.scale.x+this.scale.y+this.scale.z)/3),m*=m;var T=new w,R=new w;_=new w;var z=new w,k=this&&this.isLineSegments?2:1;if(h.isBufferGeometry){var b=h.index,q=h.attributes.position.array;if(b!==null){b=b.array,h=0;for(var J=b.length-1;h<J;h+=k){var Q=b[h+1];T.fromArray(q,3*b[h]),R.fromArray(q,3*Q),Q=dx.distanceSqToSegment(T,R,z,_),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:_.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}}else for(h=0,J=q.length/3-1;h<J;h+=k)T.fromArray(q,3*h),R.fromArray(q,3*h+3),Q=dx.distanceSqToSegment(T,R,z,_),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:_.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}else if(h.isGeometry)for(T=h.vertices,R=T.length,h=0;h<R-1;h+=k)Q=dx.distanceSqToSegment(T[h],T[h+1],z,_),Q>m||(z.applyMatrix4(this.matrixWorld),Q=e.ray.origin.distanceTo(z),Q<e.near||Q>e.far||o.push({distance:Q,point:_.clone().applyMatrix4(this.matrixWorld),index:h,face:null,faceIndex:null,object:this}))}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=Pi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var mx=new w,vx=new w;On.prototype=ut(at(ea.prototype),{constructor:On,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(e.index===null){for(var o=e.attributes.position,h=[],m=0,_=o.count;m<_;m+=2)mx.fromBufferAttribute(o,m),vx.fromBufferAttribute(o,m+1),h[m]=m===0?0:h[m-1],h[m+1]=h[m]+mx.distanceTo(vx);e.setAttribute("lineDistance",new mt(h,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(e.isGeometry)for(o=e.vertices,h=e.lineDistances,m=0,_=o.length;m<_;m+=2)mx.copy(o[m]),vx.copy(o[m+1]),h[m]=m===0?0:h[m-1],h[m+1]=h[m]+mx.distanceTo(vx);return this}}),_y.prototype=ut(at(ea.prototype),{constructor:_y,isLineLoop:!0}),ou.prototype=at(re.prototype),ou.prototype.constructor=ou,ou.prototype.isPointsMaterial=!0,ou.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.morphTargets=e.morphTargets,this};var OM=new I,l_=new st,yx=new tt,xx=new w;kd.prototype=ut(at(F.prototype),{constructor:kd,isPoints:!0,raycast:function(e,o){var h=this.geometry,m=this.matrixWorld,_=e.params.Points.threshold;if(h.boundingSphere===null&&h.computeBoundingSphere(),yx.copy(h.boundingSphere),yx.applyMatrix4(m),yx.radius+=_,e.ray.intersectsSphere(yx)!==!1)if(OM.getInverse(m),l_.copy(e.ray).applyMatrix4(OM),_/=(this.scale.x+this.scale.y+this.scale.z)/3,_*=_,h.isBufferGeometry){var T=h.index;if(h=h.attributes.position.array,T!==null){var R=T.array;T=0;for(var z=R.length;T<z;T++){var k=R[T];xx.fromArray(h,3*k),f2(xx,k,_,m,e,o,this)}}else for(T=0,R=h.length/3;T<R;T++)xx.fromArray(h,3*T),f2(xx,T,_,m,e,o,this)}else for(h=h.vertices,T=0,R=h.length;T<R;T++)f2(h[T],T,_,m,e,o,this)},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){e=e.morphAttributes;var o=Pi(e);if(0<o.length){var h=e[o[0]];if(h!==void 0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},e=0,o=h.length;e<o;e++){var m=h[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=e}}}else e=e.morphTargets,e!==void 0&&0<e.length&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),p2.prototype=ut(at(g.prototype),{constructor:p2,isVideoTexture:!0,update:function(){var e=this.image;e.readyState>=e.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Gd.prototype=at(g.prototype),Gd.prototype.constructor=Gd,Gd.prototype.isCompressedTexture=!0,av.prototype=at(g.prototype),av.prototype.constructor=av,av.prototype.isCanvasTexture=!0,uv.prototype=at(g.prototype),uv.prototype.constructor=uv,uv.prototype.isDepthTexture=!0,bd.prototype=at(ct.prototype),bd.prototype.constructor=bd,lv.prototype=at(ft.prototype),lv.prototype.constructor=lv,Vd.prototype=at(ct.prototype),Vd.prototype.constructor=Vd,hv.prototype=at(ft.prototype),hv.prototype.constructor=hv,Us.prototype=at(ct.prototype),Us.prototype.constructor=Us,cv.prototype=at(ft.prototype),cv.prototype.constructor=cv,Wd.prototype=at(Us.prototype),Wd.prototype.constructor=Wd,fv.prototype=at(ft.prototype),fv.prototype.constructor=fv,kf.prototype=at(Us.prototype),kf.prototype.constructor=kf,pv.prototype=at(ft.prototype),pv.prototype.constructor=pv,jd.prototype=at(Us.prototype),jd.prototype.constructor=jd,dv.prototype=at(ft.prototype),dv.prototype.constructor=dv,Xd.prototype=at(Us.prototype),Xd.prototype.constructor=Xd,gv.prototype=at(ft.prototype),gv.prototype.constructor=gv,Gf.prototype=at(ct.prototype),Gf.prototype.constructor=Gf,Gf.prototype.toJSON=function(){var e=ct.prototype.toJSON.call(this);return e.path=this.parameters.path.toJSON(),e},mv.prototype=at(ft.prototype),mv.prototype.constructor=mv,Yd.prototype=at(ct.prototype),Yd.prototype.constructor=Yd,vv.prototype=at(ft.prototype),vv.prototype.constructor=vv,Zd.prototype=at(ct.prototype),Zd.prototype.constructor=Zd;var uT={triangulate:function(e,o,h){h=h||2;var m=o&&o.length,_=m?o[0]*h:e.length,T=Bw(e,0,_,h,!0),R=[];if(!T||T.next===T.prev)return R;var z;if(m){var k=h;m=[];var b,q=0;for(b=o.length;q<b;q++){var J=o[q]*k,Q=q<b-1?o[q+1]*k:e.length;J=Bw(e,J,Q,k,!1),J===J.next&&(J.steiner=!0),m.push(k3(J))}for(m.sort(U3),q=0;q<m.length;q++)k=m[q],o=T,(o=H3(k,o))&&(k=zw(o,k),pc(o,o.next),pc(k,k.next)),T=pc(T,T.next)}if(e.length>80*h){var K=z=e[0],rt=m=e[1];for(k=h;k<_;k+=h)q=e[k],o=e[k+1],q<K&&(K=q),o<rt&&(rt=o),q>z&&(z=q),o>m&&(m=o);z=Math.max(z-K,m-rt),z=z!==0?1/z:0}return yv(T,R,h,K,rt,z),R}},mh={area:function(e){for(var o=e.length,h=0,m=o-1,_=0;_<o;m=_++)h+=e[m].x*e[_].y-e[_].x*e[m].y;return .5*h},isClockWise:function(e){return 0>mh.area(e)},triangulateShape:function(e,o){var h=[],m=[],_=[];Hw(e),kw(h,e);var T=e.length;for(o.forEach(Hw),e=0;e<o.length;e++)m.push(T),T+=o[e].length,kw(h,o[e]);for(o=uT.triangulate(h,m),e=0;e<o.length;e+=3)_.push(o.slice(e,e+3));return _}};bf.prototype=at(ft.prototype),bf.prototype.constructor=bf,bf.prototype.toJSON=function(){var e=ft.prototype.toJSON.call(this);return Gw(this.parameters.shapes,this.parameters.options,e)},il.prototype=at(ct.prototype),il.prototype.constructor=il,il.prototype.toJSON=function(){var e=ct.prototype.toJSON.call(this);return Gw(this.parameters.shapes,this.parameters.options,e)};var lT={generateTopUV:function(e,o,h,m,_){e=o[3*m],m=o[3*m+1];var T=o[3*_];return _=o[3*_+1],[new f(o[3*h],o[3*h+1]),new f(e,m),new f(T,_)]},generateSideWallUV:function(e,o,h,m,_,T){e=o[3*h];var R=o[3*h+1];h=o[3*h+2];var z=o[3*m],k=o[3*m+1];m=o[3*m+2];var b=o[3*_],q=o[3*_+1];_=o[3*_+2];var J=o[3*T],Q=o[3*T+1];return o=o[3*T+2],.01>Math.abs(R-k)?[new f(e,1-h),new f(z,1-m),new f(b,1-_),new f(J,1-o)]:[new f(R,1-h),new f(k,1-m),new f(q,1-_),new f(Q,1-o)]}};_v.prototype=at(ft.prototype),_v.prototype.constructor=_v,qd.prototype=at(il.prototype),qd.prototype.constructor=qd,wv.prototype=at(ft.prototype),wv.prototype.constructor=wv,Vf.prototype=at(ct.prototype),Vf.prototype.constructor=Vf,Mv.prototype=at(ft.prototype),Mv.prototype.constructor=Mv,Kd.prototype=at(ct.prototype),Kd.prototype.constructor=Kd,Cv.prototype=at(ft.prototype),Cv.prototype.constructor=Cv,Qd.prototype=at(ct.prototype),Qd.prototype.constructor=Qd,Wf.prototype=at(ft.prototype),Wf.prototype.constructor=Wf,Wf.prototype.toJSON=function(){var e=ft.prototype.toJSON.call(this);return bw(this.parameters.shapes,e)},jf.prototype=at(ct.prototype),jf.prototype.constructor=jf,jf.prototype.toJSON=function(){var e=ct.prototype.toJSON.call(this);return bw(this.parameters.shapes,e)},$d.prototype=at(ct.prototype),$d.prototype.constructor=$d,Xf.prototype=at(ft.prototype),Xf.prototype.constructor=Xf,sh.prototype=at(ct.prototype),sh.prototype.constructor=sh,Tv.prototype=at(Xf.prototype),Tv.prototype.constructor=Tv,Sv.prototype=at(sh.prototype),Sv.prototype.constructor=Sv,Iv.prototype=at(ft.prototype),Iv.prototype.constructor=Iv,tg.prototype=at(ct.prototype),tg.prototype.constructor=tg;var xs=Gu({__proto__:null,WireframeGeometry:bd,ParametricGeometry:lv,ParametricBufferGeometry:Vd,TetrahedronGeometry:cv,TetrahedronBufferGeometry:Wd,OctahedronGeometry:fv,OctahedronBufferGeometry:kf,IcosahedronGeometry:pv,IcosahedronBufferGeometry:jd,DodecahedronGeometry:dv,DodecahedronBufferGeometry:Xd,PolyhedronGeometry:hv,PolyhedronBufferGeometry:Us,TubeGeometry:gv,TubeBufferGeometry:Gf,TorusKnotGeometry:mv,TorusKnotBufferGeometry:Yd,TorusGeometry:vv,TorusBufferGeometry:Zd,TextGeometry:_v,TextBufferGeometry:qd,SphereGeometry:wv,SphereBufferGeometry:Vf,RingGeometry:Mv,RingBufferGeometry:Kd,PlaneGeometry:Sn,PlaneBufferGeometry:Ai,LatheGeometry:Cv,LatheBufferGeometry:Qd,ShapeGeometry:Wf,ShapeBufferGeometry:jf,ExtrudeGeometry:bf,ExtrudeBufferGeometry:il,EdgesGeometry:$d,ConeGeometry:Tv,ConeBufferGeometry:Sv,CylinderGeometry:Xf,CylinderBufferGeometry:sh,CircleGeometry:Iv,CircleBufferGeometry:tg,BoxGeometry:o_,BoxBufferGeometry:Wv});Yf.prototype=at(re.prototype),Yf.prototype.constructor=Yf,Yf.prototype.isShadowMaterial=!0,Yf.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this},ah.prototype=at(me.prototype),ah.prototype.constructor=ah,ah.prototype.isRawShaderMaterial=!0,nl.prototype=at(re.prototype),nl.prototype.constructor=nl,nl.prototype.isMeshStandardMaterial=!0,nl.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapIntensity=e.envMapIntensity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this.vertexTangents=e.vertexTangents,this},Zf.prototype=at(nl.prototype),Zf.prototype.constructor=Zf,Zf.prototype.isMeshPhysicalMaterial=!0,Zf.prototype.copy=function(e){return nl.prototype.copy.call(this,e),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.reflectivity=e.reflectivity,this.sheen=e.sheen?(this.sheen||new yt).copy(e.sheen):null,this.transparency=e.transparency,this},dc.prototype=at(re.prototype),dc.prototype.constructor=dc,dc.prototype.isMeshPhongMaterial=!0,dc.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Jf.prototype=at(re.prototype),Jf.prototype.constructor=Jf,Jf.prototype.isMeshToonMaterial=!0,Jf.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.specular.copy(e.specular),this.shininess=e.shininess,this.map=e.map,this.gradientMap=e.gradientMap,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},qf.prototype=at(re.prototype),qf.prototype.constructor=qf,qf.prototype.isMeshNormalMaterial=!0,qf.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Kf.prototype=at(re.prototype),Kf.prototype.constructor=Kf,Kf.prototype.isMeshLambertMaterial=!0,Kf.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},Qf.prototype=at(re.prototype),Qf.prototype.constructor=Qf,Qf.prototype.isMeshMatcapMaterial=!0,Qf.prototype.copy=function(e){return re.prototype.copy.call(this,e),this.defines={MATCAP:""},this.color.copy(e.color),this.matcap=e.matcap,this.map=e.map,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.alphaMap=e.alphaMap,this.skinning=e.skinning,this.morphTargets=e.morphTargets,this.morphNormals=e.morphNormals,this},$f.prototype=at(In.prototype),$f.prototype.constructor=$f,$f.prototype.isLineDashedMaterial=!0,$f.prototype.copy=function(e){return In.prototype.copy.call(this,e),this.scale=e.scale,this.dashSize=e.dashSize,this.gapSize=e.gapSize,this};var hT=Gu({__proto__:null,ShadowMaterial:Yf,SpriteMaterial:fc,RawShaderMaterial:ah,ShaderMaterial:me,PointsMaterial:ou,MeshPhysicalMaterial:Zf,MeshStandardMaterial:nl,MeshPhongMaterial:dc,MeshToonMaterial:Jf,MeshNormalMaterial:qf,MeshLambertMaterial:Kf,MeshDepthMaterial:hc,MeshDistanceMaterial:cc,MeshBasicMaterial:be,MeshMatcapMaterial:Qf,LineDashedMaterial:$f,LineBasicMaterial:In,Material:re}),En={arraySlice:function(e,o,h){return En.isTypedArray(e)?new e.constructor(e.subarray(o,h!==void 0?h:e.length)):e.slice(o,h)},convertArray:function(e,o,h){return!e||!h&&e.constructor===o?e:typeof o.BYTES_PER_ELEMENT=="number"?new o(e):Array.prototype.slice.call(e)},isTypedArray:function(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)},getKeyframeOrder:function(e){for(var o=e.length,h=Array(o),m=0;m!==o;++m)h[m]=m;return h.sort(function(_,T){return e[_]-e[T]}),h},sortedArray:function(e,o,h){for(var m=e.length,_=new e.constructor(m),T=0,R=0;R!==m;++T)for(var z=h[T]*o,k=0;k!==o;++k)_[R++]=e[z+k];return _},flattenJSON:function(e,o,h,m){for(var _=1,T=e[0];T!==void 0&&T[m]===void 0;)T=e[_++];if(T!==void 0){var R=T[m];if(R!==void 0)if(Array.isArray(R))do R=T[m],R!==void 0&&(o.push(T.time),h.push.apply(h,R)),T=e[_++];while(T!==void 0);else if(R.toArray!==void 0)do R=T[m],R!==void 0&&(o.push(T.time),R.toArray(h,h.length)),T=e[_++];while(T!==void 0);else do R=T[m],R!==void 0&&(o.push(T.time),h.push(R)),T=e[_++];while(T!==void 0)}},subclip:function(e,o,h,m,_){_=_||30,e=e.clone(),e.name=o;var T=[];for(o=0;o<e.tracks.length;++o){for(var R=e.tracks[o],z=R.getValueSize(),k=[],b=[],q=0;q<R.times.length;++q){var J=R.times[q]*_;if(!(J<h||J>=m))for(k.push(R.times[q]),J=0;J<z;++J)b.push(R.values[q*z+J])}k.length!==0&&(R.times=En.convertArray(k,R.times.constructor),R.values=En.convertArray(b,R.values.constructor),T.push(R))}for(e.tracks=T,h=1/0,o=0;o<e.tracks.length;++o)h>e.tracks[o].times[0]&&(h=e.tracks[o].times[0]);for(o=0;o<e.tracks.length;++o)e.tracks[o].shift(-1*h);return e.resetDuration(),e},makeClipAdditive:function(e,o,h,m){o===void 0&&(o=0),h===void 0&&(h=e),(m===void 0||0>=m)&&(m=30);var _=e.tracks.length;for(o/=m,m=0;m<_;++m){var T=h.tracks[m],R=T.ValueTypeName;if(R!=="bool"&&R!=="string"){var z=e.tracks.find(function(rt){return rt.name===T.name&&rt.ValueTypeName===R});if(z!==void 0){var k=T.getValueSize(),b=T.times.length-1;o<=T.times[0]?b=En.arraySlice(T.values,0,T.valueSize):o>=T.times[b]?b=En.arraySlice(T.values,b*k):(b=T.createInterpolant(),b.evaluate(o),b=b.resultBuffer),R==="quaternion"&&new N(b[0],b[1],b[2],b[3]).normalize().conjugate().toArray(b);for(var q=z.times.length,J=0;J<q;++J){var Q=J*k;if(R==="quaternion")N.multiplyQuaternionsFlat(z.values,Q,b,0,z.values,Q);else for(var K=0;K<k;++K)z.values[Q+K]-=b[K]}}}}return e.blendMode=2501,e}};ut(ra.prototype,{evaluate:function(e){var o=this.parameterPositions,h=this._cachedIndex,m=o[h],_=o[h-1];t:{e:{r:{i:if(!(e<m)){for(var T=h+2;;){if(m===void 0){if(e<_)break i;return this._cachedIndex=h=o.length,this.afterEnd_(h-1,e,_)}if(h===T)break;if(_=m,m=o[++h],e<m)break e}m=o.length;break r}if(e>=_)break t;for(T=o[1],e<T&&(h=2,_=T),T=h-2;;){if(_===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(h===T)break;if(m=_,_=o[--h-1],e>=_)break e}m=h,h=0}for(;h<m;)_=h+m>>>1,e<o[_]?m=_:h=_+1;if(m=o[h],_=o[h-1],_===void 0)return this._cachedIndex=0,this.beforeStart_(0,e,m);if(m===void 0)return this._cachedIndex=h=o.length,this.afterEnd_(h-1,_,e)}this._cachedIndex=h,this.intervalChanged_(h,_,m)}return this.interpolate_(h,_,e,m)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){var o=this.resultBuffer,h=this.sampleValues,m=this.valueSize;e*=m;for(var _=0;_!==m;++_)o[_]=h[e+_];return o},interpolate_:function(){throw Error("call to abstract method")},intervalChanged_:function(){}}),ut(ra.prototype,{beforeStart_:ra.prototype.copySampleValue_,afterEnd_:ra.prototype.copySampleValue_}),Ty.prototype=ut(at(ra.prototype),{constructor:Ty,DefaultSettings_:{endingStart:2400,endingEnd:2400},intervalChanged_:function(e,o,h){var m=this.parameterPositions,_=e-2,T=e+1,R=m[_],z=m[T];if(R===void 0)switch(this.getSettings_().endingStart){case 2401:_=e,R=2*o-h;break;case 2402:_=m.length-2,R=o+m[_]-m[_+1];break;default:_=e,R=h}if(z===void 0)switch(this.getSettings_().endingEnd){case 2401:T=e,z=2*h-o;break;case 2402:T=1,z=h+m[1]-m[0];break;default:T=e-1,z=o}e=.5*(h-o),m=this.valueSize,this._weightPrev=e/(o-R),this._weightNext=e/(z-h),this._offsetPrev=_*m,this._offsetNext=T*m},interpolate_:function(e,o,h,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var z=e-R,k=this._offsetPrev,b=this._offsetNext,q=this._weightPrev,J=this._weightNext,Q=(h-o)/(m-o);for(h=Q*Q,m=h*Q,o=-q*m+2*q*h-q*Q,q=(1+q)*m+(-1.5-2*q)*h+(-.5+q)*Q+1,Q=(-1-J)*m+(1.5+J)*h+.5*Q,J=J*m-J*h,h=0;h!==R;++h)_[h]=o*T[k+h]+q*T[z+h]+Q*T[e+h]+J*T[b+h];return _}}),Ev.prototype=ut(at(ra.prototype),{constructor:Ev,interpolate_:function(e,o,h,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;e*=R;var z=e-R;for(o=(h-o)/(m-o),h=1-o,m=0;m!==R;++m)_[m]=T[z+m]*h+T[e+m]*o;return _}}),Sy.prototype=ut(at(ra.prototype),{constructor:Sy,interpolate_:function(e){return this.copySampleValue_(e-1)}}),ut(No,{toJSON:function(e){var o=e.constructor;if(o.toJSON!==void 0)o=o.toJSON(e);else{o={name:e.name,times:En.convertArray(e.times,Array),values:En.convertArray(e.values,Array)};var h=e.getInterpolation();h!==e.DefaultInterpolation&&(o.interpolation=h)}return o.type=e.ValueTypeName,o}}),ut(No.prototype,{constructor:No,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:2301,InterpolantFactoryMethodDiscrete:function(e){return new Sy(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodLinear:function(e){return new Ev(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:function(e){return new Ty(this.times,this.values,this.getValueSize(),e)},setInterpolation:function(e){switch(e){case 2300:var o=this.InterpolantFactoryMethodDiscrete;break;case 2301:o=this.InterpolantFactoryMethodLinear;break;case 2302:o=this.InterpolantFactoryMethodSmooth}if(o===void 0){if(o="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name,this.createInterpolant===void 0)if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(o);return console.warn("THREE.KeyframeTrack:",o),this}return this.createInterpolant=o,this},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}},getValueSize:function(){return this.values.length/this.times.length},shift:function(e){if(e!==0)for(var o=this.times,h=0,m=o.length;h!==m;++h)o[h]+=e;return this},scale:function(e){if(e!==1)for(var o=this.times,h=0,m=o.length;h!==m;++h)o[h]*=e;return this},trim:function(e,o){for(var h=this.times,m=h.length,_=0,T=m-1;_!==m&&h[_]<e;)++_;for(;T!==-1&&h[T]>o;)--T;return++T,(_!==0||T!==m)&&(_>=T&&(T=Math.max(T,1),_=T-1),e=this.getValueSize(),this.times=En.arraySlice(h,_,T),this.values=En.arraySlice(this.values,_*e,T*e)),this},validate:function(){var e=!0,o=this.getValueSize();o-Math.floor(o)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var h=this.times;o=this.values;var m=h.length;m===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var _=null,T=0;T!==m;T++){var R=h[T];if(typeof R=="number"&&isNaN(R)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,T,R),e=!1;break}if(_!==null&&_>R){console.error("THREE.KeyframeTrack: Out of order keys.",this,T,R,_),e=!1;break}_=R}if(o!==void 0&&En.isTypedArray(o)){for(T=0,h=o.length;T!==h;++T)if(m=o[T],isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,T,m),e=!1;break}}return e},optimize:function(){for(var e=En.arraySlice(this.times),o=En.arraySlice(this.values),h=this.getValueSize(),m=this.getInterpolation()===2302,_=1,T=e.length-1,R=1;R<T;++R){var z=!1,k=e[R];if(k!==e[R+1]&&(R!==1||k!==k[0]))if(m)z=!0;else{var b=R*h,q=b-h,J=b+h;for(k=0;k!==h;++k){var Q=o[b+k];if(Q!==o[q+k]||Q!==o[J+k]){z=!0;break}}}if(z){if(R!==_)for(e[_]=e[R],z=R*h,b=_*h,k=0;k!==h;++k)o[b+k]=o[z+k];++_}}if(0<T){for(e[_]=e[T],z=T*h,b=_*h,k=0;k!==h;++k)o[b+k]=o[z+k];++_}return _!==e.length?(this.times=En.arraySlice(e,0,_),this.values=En.arraySlice(o,0,_*h)):(this.times=e,this.values=o),this},clone:function(){var e=En.arraySlice(this.times,0),o=En.arraySlice(this.values,0);return e=new this.constructor(this.name,e,o),e.createInterpolant=this.createInterpolant,e}}),Iy.prototype=ut(at(No.prototype),{constructor:Iy,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Ey.prototype=ut(at(No.prototype),{constructor:Ey,ValueTypeName:"color"}),eg.prototype=ut(at(No.prototype),{constructor:eg,ValueTypeName:"number"}),Ly.prototype=ut(at(ra.prototype),{constructor:Ly,interpolate_:function(e,o,h,m){var _=this.resultBuffer,T=this.sampleValues,R=this.valueSize;for(e*=R,o=(h-o)/(m-o),h=e+R;e!==h;e+=4)N.slerpFlat(_,0,T,e-R,T,e,o);return _}}),Lv.prototype=ut(at(No.prototype),{constructor:Lv,ValueTypeName:"quaternion",DefaultInterpolation:2301,InterpolantFactoryMethodLinear:function(e){return new Ly(this.times,this.values,this.getValueSize(),e)},InterpolantFactoryMethodSmooth:void 0}),Ry.prototype=ut(at(No.prototype),{constructor:Ry,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:2300,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),rg.prototype=ut(at(No.prototype),{constructor:rg,ValueTypeName:"vector"}),ut(Ea,{parse:function(e){for(var o=[],h=e.tracks,m=1/(e.fps||1),_=0,T=h.length;_!==T;++_)o.push(b3(h[_]).scale(m));return new Ea(e.name,e.duration,o,e.blendMode)},toJSON:function(e){var o=[],h=e.tracks;e={name:e.name,duration:e.duration,tracks:o,uuid:e.uuid,blendMode:e.blendMode};for(var m=0,_=h.length;m!==_;++m)o.push(No.toJSON(h[m]));return e},CreateFromMorphTargetSequence:function(e,o,h,m){for(var _=o.length,T=[],R=0;R<_;R++){var z=[],k=[];z.push((R+_-1)%_,R,(R+1)%_),k.push(0,1,0);var b=En.getKeyframeOrder(z);z=En.sortedArray(z,1,b),k=En.sortedArray(k,1,b),m||z[0]!==0||(z.push(_),k.push(k[0])),T.push(new eg(".morphTargetInfluences["+o[R].name+"]",z,k).scale(1/h))}return new Ea(e,-1,T)},findByName:function(e,o){var h=e;for(Array.isArray(e)||(h=e.geometry&&e.geometry.animations||e.animations),e=0;e<h.length;e++)if(h[e].name===o)return h[e];return null},CreateClipsFromMorphTargetSequences:function(e,o,h){for(var m={},_=/^([\w-]*?)([\d]+)$/,T=0,R=e.length;T<R;T++){var z=e[T],k=z.name.match(_);if(k&&1<k.length){var b=k[1];(k=m[b])||(m[b]=k=[]),k.push(z)}}e=[];for(b in m)e.push(Ea.CreateFromMorphTargetSequence(b,m[b],o,h));return e},parseAnimation:function(e,o){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;var h=function(Bt,Zt,bt,ae,Kt){if(bt.length!==0){var fe=[],Xt=[];En.flattenJSON(bt,fe,Xt,ae),fe.length!==0&&Kt.push(new Bt(Zt,fe,Xt))}},m=[],_=e.name||"default",T=e.length||-1,R=e.fps||30,z=e.blendMode;e=e.hierarchy||[];for(var k=0;k<e.length;k++){var b=e[k].keys;if(b&&b.length!==0)if(b[0].morphTargets){T={};for(var q=0;q<b.length;q++)if(b[q].morphTargets)for(var J=0;J<b[q].morphTargets.length;J++)T[b[q].morphTargets[J]]=-1;for(var Q in T){var K=[],rt=[];for(J=0;J!==b[q].morphTargets.length;++J){var lt=b[q];K.push(lt.time),rt.push(lt.morphTarget===Q?1:0)}m.push(new eg(".morphTargetInfluence["+Q+"]",K,rt))}T=T.length*(R||1)}else q=".bones["+o[k].name+"]",h(rg,q+".position",b,"pos",m),h(Lv,q+".quaternion",b,"rot",m),h(rg,q+".scale",b,"scl",m)}return m.length===0?null:new Ea(_,T,m,z)}}),ut(Ea.prototype,{resetDuration:function(){for(var e=0,o=0,h=this.tracks.length;o!==h;++o){var m=this.tracks[o];e=Math.max(e,m.times[m.times.length-1])}return this.duration=e,this},trim:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this},validate:function(){for(var e=!0,o=0;o<this.tracks.length;o++)e=e&&this.tracks[o].validate();return e},optimize:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this},clone:function(){for(var e=[],o=0;o<this.tracks.length;o++)e.push(this.tracks[o].clone());return new Ea(this.name,this.duration,e,this.blendMode)}});var op={enabled:!1,files:{},add:function(e,o){this.enabled!==!1&&(this.files[e]=o)},get:function(e){if(this.enabled!==!1)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}},FM=new m2;ut(Ki.prototype,{load:function(){},loadAsync:function(e,o){var h=this;return new xi(function(m,_){h.load(e,m,o,_)})},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setPath:function(e){return this.path=e,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var du={};La.prototype=ut(at(Ki.prototype),{constructor:La,load:function(e,o,h,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var _=this,T=op.get(e);if(T!==void 0)return _.manager.itemStart(e),setTimeout(function(){o&&o(T),_.manager.itemEnd(e)},0),T;if(du[e]!==void 0)du[e].push({onLoad:o,onProgress:h,onError:m});else{var R=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(R){h=R[1];var z=!!R[2];R=R[3],R=decodeURIComponent(R),z&&(R=atob(R));try{var k=(this.responseType||"").toLowerCase();switch(k){case"arraybuffer":case"blob":var b=new Uint8Array(R.length);for(z=0;z<R.length;z++)b[z]=R.charCodeAt(z);var q=k==="blob"?new Blob([b.buffer],{type:h}):b.buffer;break;case"document":q=new DOMParser().parseFromString(R,h);break;case"json":q=JSON.parse(R);break;default:q=R}setTimeout(function(){o&&o(q),_.manager.itemEnd(e)},0)}catch(Q){setTimeout(function(){m&&m(Q),_.manager.itemError(e),_.manager.itemEnd(e)},0)}}else{du[e]=[],du[e].push({onLoad:o,onProgress:h,onError:m});var J=new XMLHttpRequest;J.open("GET",e,!0),J.addEventListener("load",function(Q){var K=this.response,rt=du[e];if(delete du[e],this.status===200||this.status===0){this.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),op.add(e,K);for(var lt=0,Bt=rt.length;lt<Bt;lt++){var Zt=rt[lt];Zt.onLoad&&Zt.onLoad(K)}}else{for(lt=0,Bt=rt.length;lt<Bt;lt++)Zt=rt[lt],Zt.onError&&Zt.onError(Q);_.manager.itemError(e)}_.manager.itemEnd(e)},!1),J.addEventListener("progress",function(Q){for(var K=du[e],rt=0,lt=K.length;rt<lt;rt++){var Bt=K[rt];Bt.onProgress&&Bt.onProgress(Q)}},!1),J.addEventListener("error",function(Q){var K=du[e];delete du[e];for(var rt=0,lt=K.length;rt<lt;rt++){var Bt=K[rt];Bt.onError&&Bt.onError(Q)}_.manager.itemError(e),_.manager.itemEnd(e)},!1),J.addEventListener("abort",function(Q){var K=du[e];delete du[e];for(var rt=0,lt=K.length;rt<lt;rt++){var Bt=K[rt];Bt.onError&&Bt.onError(Q)}_.manager.itemError(e),_.manager.itemEnd(e)},!1),this.responseType!==void 0&&(J.responseType=this.responseType),this.withCredentials!==void 0&&(J.withCredentials=this.withCredentials),J.overrideMimeType&&J.overrideMimeType(this.mimeType!==void 0?this.mimeType:"text/plain");for(z in this.requestHeader)J.setRequestHeader(z,this.requestHeader[z]);J.send(null)}return _.manager.itemStart(e),J}},setResponseType:function(e){return this.responseType=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setMimeType:function(e){return this.mimeType=e,this}}),v2.prototype=ut(at(Ki.prototype),{constructor:v2,load:function(e,o,h,m){var _=this,T=new La(_.manager);T.setPath(_.path),T.load(e,function(R){try{o(_.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),_.manager.itemError(e)}},h,m)},parse:function(e){for(var o=[],h=0;h<e.length;h++){var m=Ea.parse(e[h]);o.push(m)}return o}}),y2.prototype=ut(at(Ki.prototype),{constructor:y2,load:function(e,o,h,m){function _(Q){k.load(e[Q],function(K){K=T.parse(K,!0),R[Q]={width:K.width,height:K.height,format:K.format,mipmaps:K.mipmaps},b+=1,b===6&&(K.mipmapCount===1&&(z.minFilter=1006),z.format=K.format,z.needsUpdate=!0,o&&o(z))},h,m)}var T=this,R=[],z=new Gd;z.image=R;var k=new La(this.manager);if(k.setPath(this.path),k.setResponseType("arraybuffer"),Array.isArray(e))for(var b=0,q=0,J=e.length;q<J;++q)_(q);else k.load(e,function(Q){if(Q=T.parse(Q,!0),Q.isCubemap)for(var K=Q.mipmaps.length/Q.mipmapCount,rt=0;rt<K;rt++){R[rt]={mipmaps:[]};for(var lt=0;lt<Q.mipmapCount;lt++)R[rt].mipmaps.push(Q.mipmaps[rt*Q.mipmapCount+lt]),R[rt].format=Q.format,R[rt].width=Q.width,R[rt].height=Q.height}else z.image.width=Q.width,z.image.height=Q.height,z.mipmaps=Q.mipmaps;Q.mipmapCount===1&&(z.minFilter=1006),z.format=Q.format,z.needsUpdate=!0,o&&o(z)},h,m);return z}}),Py.prototype=ut(at(Ki.prototype),{constructor:Py,load:function(e,o,h,m){var _=this,T=new Ae,R=new La(this.manager);return R.setResponseType("arraybuffer"),R.setPath(this.path),R.load(e,function(z){(z=_.parse(z))&&(z.image!==void 0?T.image=z.image:z.data!==void 0&&(T.image.width=z.width,T.image.height=z.height,T.image.data=z.data),T.wrapS=z.wrapS!==void 0?z.wrapS:1001,T.wrapT=z.wrapT!==void 0?z.wrapT:1001,T.magFilter=z.magFilter!==void 0?z.magFilter:1006,T.minFilter=z.minFilter!==void 0?z.minFilter:1006,T.anisotropy=z.anisotropy!==void 0?z.anisotropy:1,z.format!==void 0&&(T.format=z.format),z.type!==void 0&&(T.type=z.type),z.mipmaps!==void 0&&(T.mipmaps=z.mipmaps,T.minFilter=1008),z.mipmapCount===1&&(T.minFilter=1006),T.needsUpdate=!0,o&&o(T,z))},h,m),T}}),ig.prototype=ut(at(Ki.prototype),{constructor:ig,load:function(e,o,h,m){function _(){k.removeEventListener("load",_,!1),k.removeEventListener("error",T,!1),op.add(e,this),o&&o(this),R.manager.itemEnd(e)}function T(b){k.removeEventListener("load",_,!1),k.removeEventListener("error",T,!1),m&&m(b),R.manager.itemError(e),R.manager.itemEnd(e)}this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var R=this,z=op.get(e);if(z!==void 0)return R.manager.itemStart(e),setTimeout(function(){o&&o(z),R.manager.itemEnd(e)},0),z;var k=document.createElementNS("http://www.w3.org/1999/xhtml","img");return k.addEventListener("load",_,!1),k.addEventListener("error",T,!1),e.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(k.crossOrigin=this.crossOrigin),R.manager.itemStart(e),k.src=e,k}}),Dy.prototype=ut(at(Ki.prototype),{constructor:Dy,load:function(e,o,h,m){function _(k){R.load(e[k],function(b){T.images[k]=b,z++,z===6&&(T.needsUpdate=!0,o&&o(T))},void 0,m)}var T=new Sa,R=new ig(this.manager);R.setCrossOrigin(this.crossOrigin),R.setPath(this.path);var z=0;for(h=0;h<e.length;++h)_(h);return T}}),Oy.prototype=ut(at(Ki.prototype),{constructor:Oy,load:function(e,o,h,m){var _=new g,T=new ig(this.manager);return T.setCrossOrigin(this.crossOrigin),T.setPath(this.path),T.load(e,function(R){_.image=R,R=0<e.search(/\.jpe?g($|\?)/i)||e.search(/^data:image\/jpeg/)===0,_.format=R?1022:1023,_.needsUpdate=!0,o!==void 0&&o(_)},h,m),_}}),ut(jr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(e,o){return e=this.getUtoTmapping(e),this.getPoint(e,o)},getPoints:function(e){e===void 0&&(e=5);for(var o=[],h=0;h<=e;h++)o.push(this.getPoint(h/e));return o},getSpacedPoints:function(e){e===void 0&&(e=5);for(var o=[],h=0;h<=e;h++)o.push(this.getPointAt(h/e));return o},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(e===void 0&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var o=[],h=this.getPoint(0),m,_=0;for(o.push(0),m=1;m<=e;m++){var T=this.getPoint(m/e);_+=T.distanceTo(h),o.push(_),h=T}return this.cacheArcLengths=o},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(e,o){var h=this.getLengths(),m=h.length;o=o||e*h[m-1];for(var _=0,T=m-1,R;_<=T;)if(e=Math.floor(_+(T-_)/2),R=h[e]-o,0>R)_=e+1;else if(0<R)T=e-1;else{T=e;break}return e=T,h[e]===o?e/(m-1):(_=h[e],(e+(o-_)/(h[e+1]-_))/(m-1))},getTangent:function(e,o){var h=e-1e-4;return e+=1e-4,0>h&&(h=0),1<e&&(e=1),h=this.getPoint(h),e=this.getPoint(e),o=o||(h.isVector2?new f:new w),o.copy(e).sub(h).normalize(),o},getTangentAt:function(e,o){return e=this.getUtoTmapping(e),this.getTangent(e,o)},computeFrenetFrames:function(e,o){var h=new w,m=[],_=[],T=[],R=new w,z=new I,k;for(k=0;k<=e;k++){var b=k/e;m[k]=this.getTangentAt(b,new w),m[k].normalize()}_[0]=new w,T[0]=new w,k=Number.MAX_VALUE,b=Math.abs(m[0].x);var q=Math.abs(m[0].y),J=Math.abs(m[0].z);for(b<=k&&(k=b,h.set(1,0,0)),q<=k&&(k=q,h.set(0,1,0)),J<=k&&h.set(0,0,1),R.crossVectors(m[0],h).normalize(),_[0].crossVectors(m[0],R),T[0].crossVectors(m[0],_[0]),k=1;k<=e;k++)_[k]=_[k-1].clone(),T[k]=T[k-1].clone(),R.crossVectors(m[k-1],m[k]),R.length()>hn&&(R.normalize(),h=Math.acos(di.clamp(m[k-1].dot(m[k]),-1,1)),_[k].applyMatrix4(z.makeRotationAxis(R,h))),T[k].crossVectors(m[k],_[k]);if(o===!0)for(h=Math.acos(di.clamp(_[0].dot(_[e]),-1,1)),h/=e,0<m[0].dot(R.crossVectors(_[0],_[e]))&&(h=-h),k=1;k<=e;k++)_[k].applyMatrix4(z.makeRotationAxis(m[k],h*k)),T[k].crossVectors(m[k],_[k]);return{tangents:m,normals:_,binormals:T}},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this},toJSON:function(){var e={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}}),ia.prototype=at(jr.prototype),ia.prototype.constructor=ia,ia.prototype.isEllipseCurve=!0,ia.prototype.getPoint=function(e,o){o=o||new f;for(var h=2*Math.PI,m=this.aEndAngle-this.aStartAngle,_=Math.abs(m)<hn;0>m;)m+=h;for(;m>h;)m-=h;m<hn&&(m=_?0:h),this.aClockwise!==!0||_||(m=m===h?-h:m-h),h=this.aStartAngle+e*m,e=this.aX+this.xRadius*Math.cos(h);var T=this.aY+this.yRadius*Math.sin(h);return this.aRotation!==0&&(h=Math.cos(this.aRotation),m=Math.sin(this.aRotation),_=e-this.aX,T-=this.aY,e=_*h-T*m+this.aX,T=_*m+T*h+this.aY),o.set(e,T)},ia.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ia.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e},ia.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this},ng.prototype=at(ia.prototype),ng.prototype.constructor=ng,ng.prototype.isArcCurve=!0;var Ax=new w,h_=new x2,c_=new x2,f_=new x2;rs.prototype=at(jr.prototype),rs.prototype.constructor=rs,rs.prototype.isCatmullRomCurve3=!0,rs.prototype.getPoint=function(e,o){o=o||new w;var h=this.points,m=h.length;e*=m-(this.closed?0:1);var _=Math.floor(e);if(e-=_,this.closed?_+=0<_?0:(Math.floor(Math.abs(_)/m)+1)*m:e===0&&_===m-1&&(_=m-2,e=1),this.closed||0<_)var T=h[(_-1)%m];else Ax.subVectors(h[0],h[1]).add(h[0]),T=Ax;var R=h[_%m],z=h[(_+1)%m];if(this.closed||_+2<m?h=h[(_+2)%m]:(Ax.subVectors(h[m-1],h[m-2]).add(h[m-1]),h=Ax),this.curveType==="centripetal"||this.curveType==="chordal"){var k=this.curveType==="chordal"?.5:.25;m=Math.pow(T.distanceToSquared(R),k),_=Math.pow(R.distanceToSquared(z),k),k=Math.pow(z.distanceToSquared(h),k),1e-4>_&&(_=1),1e-4>m&&(m=_),1e-4>k&&(k=_),h_.initNonuniformCatmullRom(T.x,R.x,z.x,h.x,m,_,k),c_.initNonuniformCatmullRom(T.y,R.y,z.y,h.y,m,_,k),f_.initNonuniformCatmullRom(T.z,R.z,z.z,h.z,m,_,k)}else this.curveType==="catmullrom"&&(h_.initCatmullRom(T.x,R.x,z.x,h.x,this.tension),c_.initCatmullRom(T.y,R.y,z.y,h.y,this.tension),f_.initCatmullRom(T.z,R.z,z.z,h.z,this.tension));return o.set(h_.calc(e),c_.calc(e),f_.calc(e)),o},rs.prototype.copy=function(e){jr.prototype.copy.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++)this.points.push(e.points[o].clone());return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},rs.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);e.points=[];for(var o=0,h=this.points.length;o<h;o++)e.points.push(this.points[o].toArray());return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e},rs.prototype.fromJSON=function(e){jr.prototype.fromJSON.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++){var m=e.points[o];this.points.push(new w().fromArray(m))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this},su.prototype=at(jr.prototype),su.prototype.constructor=su,su.prototype.isCubicBezierCurve=!0,su.prototype.getPoint=function(e,o){o=o||new f;var h=this.v0,m=this.v1,_=this.v2,T=this.v3;return o.set(Pv(e,h.x,m.x,_.x,T.x),Pv(e,h.y,m.y,_.y,T.y)),o},su.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},su.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},su.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},ol.prototype=at(jr.prototype),ol.prototype.constructor=ol,ol.prototype.isCubicBezierCurve3=!0,ol.prototype.getPoint=function(e,o){o=o||new w;var h=this.v0,m=this.v1,_=this.v2,T=this.v3;return o.set(Pv(e,h.x,m.x,_.x,T.x),Pv(e,h.y,m.y,_.y,T.y),Pv(e,h.z,m.z,_.z,T.z)),o},ol.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this},ol.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e},ol.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this},Hs.prototype=at(jr.prototype),Hs.prototype.constructor=Hs,Hs.prototype.isLineCurve=!0,Hs.prototype.getPoint=function(e,o){return o=o||new f,e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o},Hs.prototype.getPointAt=function(e,o){return this.getPoint(e,o)},Hs.prototype.getTangent=function(e,o){return e=o||new f,e=e.copy(this.v2).sub(this.v1).normalize()},Hs.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},Hs.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},Hs.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},au.prototype=at(jr.prototype),au.prototype.constructor=au,au.prototype.isLineCurve3=!0,au.prototype.getPoint=function(e,o){return o=o||new w,e===1?o.copy(this.v2):(o.copy(this.v2).sub(this.v1),o.multiplyScalar(e).add(this.v1)),o},au.prototype.getPointAt=function(e,o){return this.getPoint(e,o)},au.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v1.copy(e.v1),this.v2.copy(e.v2),this},au.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},au.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},uu.prototype=at(jr.prototype),uu.prototype.constructor=uu,uu.prototype.isQuadraticBezierCurve=!0,uu.prototype.getPoint=function(e,o){o=o||new f;var h=this.v0,m=this.v1,_=this.v2;return o.set(Rv(e,h.x,m.x,_.x),Rv(e,h.y,m.y,_.y)),o},uu.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},uu.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},uu.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},sl.prototype=at(jr.prototype),sl.prototype.constructor=sl,sl.prototype.isQuadraticBezierCurve3=!0,sl.prototype.getPoint=function(e,o){o=o||new w;var h=this.v0,m=this.v1,_=this.v2;return o.set(Rv(e,h.x,m.x,_.x),Rv(e,h.y,m.y,_.y),Rv(e,h.z,m.z,_.z)),o},sl.prototype.copy=function(e){return jr.prototype.copy.call(this,e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this},sl.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e},sl.prototype.fromJSON=function(e){return jr.prototype.fromJSON.call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this},lu.prototype=at(jr.prototype),lu.prototype.constructor=lu,lu.prototype.isSplineCurve=!0,lu.prototype.getPoint=function(e,o){o=o||new f;var h=this.points,m=(h.length-1)*e;e=Math.floor(m),m-=e;var _=h[e===0?e:e-1],T=h[e],R=h[e>h.length-2?h.length-1:e+1];return h=h[e>h.length-3?h.length-1:e+2],o.set(Vw(m,_.x,T.x,R.x,h.x),Vw(m,_.y,T.y,R.y,h.y)),o},lu.prototype.copy=function(e){jr.prototype.copy.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++)this.points.push(e.points[o].clone());return this},lu.prototype.toJSON=function(){var e=jr.prototype.toJSON.call(this);e.points=[];for(var o=0,h=this.points.length;o<h;o++)e.points.push(this.points[o].toArray());return e},lu.prototype.fromJSON=function(e){jr.prototype.fromJSON.call(this,e),this.points=[];for(var o=0,h=e.points.length;o<h;o++){var m=e.points[o];this.points.push(new f().fromArray(m))}return this};var p_=Gu({__proto__:null,ArcCurve:ng,CatmullRomCurve3:rs,CubicBezierCurve:su,CubicBezierCurve3:ol,EllipseCurve:ia,LineCurve:Hs,LineCurve3:au,QuadraticBezierCurve:uu,QuadraticBezierCurve3:sl,SplineCurve:lu});uh.prototype=ut(at(jr.prototype),{constructor:uh,add:function(e){this.curves.push(e)},closePath:function(){var e=this.curves[0].getPoint(0),o=this.curves[this.curves.length-1].getPoint(1);e.equals(o)||this.curves.push(new Hs(o,e))},getPoint:function(e){var o=e*this.getLength(),h=this.getCurveLengths();for(e=0;e<h.length;){if(h[e]>=o)return o=h[e]-o,e=this.curves[e],h=e.getLength(),e.getPointAt(h===0?0:1-o/h);e++}return null},getLength:function(){var e=this.getCurveLengths();return e[e.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],o=0,h=0,m=this.curves.length;h<m;h++)o+=this.curves[h].getLength(),e.push(o);return this.cacheLengths=e},getSpacedPoints:function(e){e===void 0&&(e=40);for(var o=[],h=0;h<=e;h++)o.push(this.getPoint(h/e));return this.autoClose&&o.push(o[0]),o},getPoints:function(e){e=e||12;for(var o=[],h,m=0,_=this.curves;m<_.length;m++){var T=_[m];T=T.getPoints(T&&T.isEllipseCurve?2*e:T&&(T.isLineCurve||T.isLineCurve3)?1:T&&T.isSplineCurve?e*T.points.length:e);for(var R=0;R<T.length;R++){var z=T[R];h&&h.equals(z)||(o.push(z),h=z)}}return this.autoClose&&1<o.length&&!o[o.length-1].equals(o[0])&&o.push(o[0]),o},copy:function(e){jr.prototype.copy.call(this,e),this.curves=[];for(var o=0,h=e.curves.length;o<h;o++)this.curves.push(e.curves[o].clone());return this.autoClose=e.autoClose,this},toJSON:function(){var e=jr.prototype.toJSON.call(this);e.autoClose=this.autoClose,e.curves=[];for(var o=0,h=this.curves.length;o<h;o++)e.curves.push(this.curves[o].toJSON());return e},fromJSON:function(e){jr.prototype.fromJSON.call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var o=0,h=e.curves.length;o<h;o++){var m=e.curves[o];this.curves.push(new p_[m.type]().fromJSON(m))}return this}}),hu.prototype=ut(at(uh.prototype),{constructor:hu,setFromPoints:function(e){this.moveTo(e[0].x,e[0].y);for(var o=1,h=e.length;o<h;o++)this.lineTo(e[o].x,e[o].y);return this},moveTo:function(e,o){return this.currentPoint.set(e,o),this},lineTo:function(e,o){var h=new Hs(this.currentPoint.clone(),new f(e,o));return this.curves.push(h),this.currentPoint.set(e,o),this},quadraticCurveTo:function(e,o,h,m){return e=new uu(this.currentPoint.clone(),new f(e,o),new f(h,m)),this.curves.push(e),this.currentPoint.set(h,m),this},bezierCurveTo:function(e,o,h,m,_,T){return e=new su(this.currentPoint.clone(),new f(e,o),new f(h,m),new f(_,T)),this.curves.push(e),this.currentPoint.set(_,T),this},splineThru:function(e){var o=[this.currentPoint.clone()].concat(e);return o=new lu(o),this.curves.push(o),this.currentPoint.copy(e[e.length-1]),this},arc:function(e,o,h,m,_,T){return this.absarc(e+this.currentPoint.x,o+this.currentPoint.y,h,m,_,T),this},absarc:function(e,o,h,m,_,T){return this.absellipse(e,o,h,h,m,_,T),this},ellipse:function(e,o,h,m,_,T,R,z){return this.absellipse(e+this.currentPoint.x,o+this.currentPoint.y,h,m,_,T,R,z),this},absellipse:function(e,o,h,m,_,T,R,z){return e=new ia(e,o,h,m,_,T,R,z),0<this.curves.length&&(o=e.getPoint(0),o.equals(this.currentPoint)||this.lineTo(o.x,o.y)),this.curves.push(e),e=e.getPoint(1),this.currentPoint.copy(e),this},copy:function(e){return uh.prototype.copy.call(this,e),this.currentPoint.copy(e.currentPoint),this},toJSON:function(){var e=uh.prototype.toJSON.call(this);return e.currentPoint=this.currentPoint.toArray(),e},fromJSON:function(e){return uh.prototype.fromJSON.call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}),gc.prototype=ut(at(hu.prototype),{constructor:gc,getPointsHoles:function(e){for(var o=[],h=0,m=this.holes.length;h<m;h++)o[h]=this.holes[h].getPoints(e);return o},extractPoints:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}},copy:function(e){hu.prototype.copy.call(this,e),this.holes=[];for(var o=0,h=e.holes.length;o<h;o++)this.holes.push(e.holes[o].clone());return this},toJSON:function(){var e=hu.prototype.toJSON.call(this);e.uuid=this.uuid,e.holes=[];for(var o=0,h=this.holes.length;o<h;o++)e.holes.push(this.holes[o].toJSON());return e},fromJSON:function(e){hu.prototype.fromJSON.call(this,e),this.uuid=e.uuid,this.holes=[];for(var o=0,h=e.holes.length;o<h;o++){var m=e.holes[o];this.holes.push(new hu().fromJSON(m))}return this}}),cn.prototype=ut(at(F.prototype),{constructor:cn,isLight:!0,copy:function(e){return F.prototype.copy.call(this,e),this.color.copy(e.color),this.intensity=e.intensity,this},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.color=this.color.getHex(),e.object.intensity=this.intensity,this.groundColor!==void 0&&(e.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(e.object.distance=this.distance),this.angle!==void 0&&(e.object.angle=this.angle),this.decay!==void 0&&(e.object.decay=this.decay),this.penumbra!==void 0&&(e.object.penumbra=this.penumbra),this.shadow!==void 0&&(e.object.shadow=this.shadow.toJSON()),e}}),Fy.prototype=ut(at(cn.prototype),{constructor:Fy,isHemisphereLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.groundColor.copy(e.groundColor),this}}),ut(al.prototype,{_projScreenMatrix:new I,_lightPositionWorld:new w,_lookTarget:new w,getViewportCount:function(){return this._viewportCount},getFrustum:function(){return this._frustum},updateMatrices:function(e){var o=this.camera,h=this.matrix,m=this._projScreenMatrix,_=this._lookTarget,T=this._lightPositionWorld;T.setFromMatrixPosition(e.matrixWorld),o.position.copy(T),_.setFromMatrixPosition(e.target.matrixWorld),o.lookAt(_),o.updateMatrixWorld(),m.multiplyMatrices(o.projectionMatrix,o.matrixWorldInverse),this._frustum.setFromProjectionMatrix(m),h.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),h.multiply(o.projectionMatrix),h.multiply(o.matrixWorldInverse)},getViewport:function(e){return this._viewports[e]},getFrameExtents:function(){return this._frameExtents},copy:function(e){return this.camera=e.camera.clone(),this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e={};return this.bias!==0&&(e.bias=this.bias),this.radius!==1&&(e.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}}),By.prototype=ut(at(al.prototype),{constructor:By,isSpotLightShadow:!0,updateMatrices:function(e){var o=this.camera,h=2*di.RAD2DEG*e.angle,m=this.mapSize.width/this.mapSize.height,_=e.distance||o.far;(h!==o.fov||m!==o.aspect||_!==o.far)&&(o.fov=h,o.aspect=m,o.far=_,o.updateProjectionMatrix()),al.prototype.updateMatrices.call(this,e)}}),Ny.prototype=ut(at(cn.prototype),{constructor:Ny,isSpotLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),A2.prototype=ut(at(al.prototype),{constructor:A2,isPointLightShadow:!0,updateMatrices:function(e,o){o===void 0&&(o=0);var h=this.camera,m=this.matrix,_=this._lightPositionWorld,T=this._lookTarget,R=this._projScreenMatrix;_.setFromMatrixPosition(e.matrixWorld),h.position.copy(_),T.copy(h.position),T.add(this._cubeDirections[o]),h.up.copy(this._cubeUps[o]),h.lookAt(T),h.updateMatrixWorld(),m.makeTranslation(-_.x,-_.y,-_.z),R.multiplyMatrices(h.projectionMatrix,h.matrixWorldInverse),this._frustum.setFromProjectionMatrix(R)}}),zy.prototype=ut(at(cn.prototype),{constructor:zy,isPointLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}}),og.prototype=ut(at(le.prototype),{constructor:og,isOrthographicCamera:!0,copy:function(e,o){return le.prototype.copy.call(this,e,o),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=e.view===null?null:ut({},e.view),this},setViewOffset:function(e,o,h,m,_,T){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=o,this.view.offsetX=h,this.view.offsetY=m,this.view.width=_,this.view.height=T,this.updateProjectionMatrix()},clearViewOffset:function(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=(this.right-this.left)/(2*this.zoom),o=(this.top-this.bottom)/(2*this.zoom),h=(this.right+this.left)/2,m=(this.top+this.bottom)/2,_=h-e;h+=e,e=m+o,o=m-o,this.view!==null&&this.view.enabled&&(m=(this.right-this.left)/this.view.fullWidth/this.zoom,o=(this.top-this.bottom)/this.view.fullHeight/this.zoom,_+=m*this.view.offsetX,h=_+m*this.view.width,e-=o*this.view.offsetY,o=e-o*this.view.height),this.projectionMatrix.makeOrthographic(_,h,e,o,this.near,this.far),this.projectionMatrixInverse.getInverse(this.projectionMatrix)},toJSON:function(e){return e=F.prototype.toJSON.call(this,e),e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,this.view!==null&&(e.object.view=ut({},this.view)),e}}),Uy.prototype=ut(at(al.prototype),{constructor:Uy,isDirectionalLightShadow:!0,updateMatrices:function(e){al.prototype.updateMatrices.call(this,e)}}),Hy.prototype=ut(at(cn.prototype),{constructor:Hy,isDirectionalLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}}),ky.prototype=ut(at(cn.prototype),{constructor:ky,isAmbientLight:!0}),Gy.prototype=ut(at(cn.prototype),{constructor:Gy,isRectAreaLight:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.width=e.width,this.height=e.height,this},toJSON:function(e){return e=cn.prototype.toJSON.call(this,e),e.object.width=this.width,e.object.height=this.height,e}}),ut(by.prototype,{isSphericalHarmonics3:!0,set:function(e){for(var o=0;9>o;o++)this.coefficients[o].copy(e[o]);return this},zero:function(){for(var e=0;9>e;e++)this.coefficients[e].set(0,0,0);return this},getAt:function(e,o){var h=e.x,m=e.y;e=e.z;var _=this.coefficients;return o.copy(_[0]).multiplyScalar(.282095),o.addScaledVector(_[1],.488603*m),o.addScaledVector(_[2],.488603*e),o.addScaledVector(_[3],.488603*h),o.addScaledVector(_[4],1.092548*h*m),o.addScaledVector(_[5],1.092548*m*e),o.addScaledVector(_[6],.315392*(3*e*e-1)),o.addScaledVector(_[7],1.092548*h*e),o.addScaledVector(_[8],.546274*(h*h-m*m)),o},getIrradianceAt:function(e,o){var h=e.x,m=e.y;e=e.z;var _=this.coefficients;return o.copy(_[0]).multiplyScalar(.886227),o.addScaledVector(_[1],1.023328*m),o.addScaledVector(_[2],1.023328*e),o.addScaledVector(_[3],1.023328*h),o.addScaledVector(_[4],.858086*h*m),o.addScaledVector(_[5],.858086*m*e),o.addScaledVector(_[6],.743125*e*e-.247708),o.addScaledVector(_[7],.858086*h*e),o.addScaledVector(_[8],.429043*(h*h-m*m)),o},add:function(e){for(var o=0;9>o;o++)this.coefficients[o].add(e.coefficients[o]);return this},addScaledSH:function(e,o){for(var h=0;9>h;h++)this.coefficients[h].addScaledVector(e.coefficients[h],o);return this},scale:function(e){for(var o=0;9>o;o++)this.coefficients[o].multiplyScalar(e);return this},lerp:function(e,o){for(var h=0;9>h;h++)this.coefficients[h].lerp(e.coefficients[h],o);return this},equals:function(e){for(var o=0;9>o;o++)if(!this.coefficients[o].equals(e.coefficients[o]))return!1;return!0},copy:function(e){return this.set(e.coefficients)},clone:function(){return new this.constructor().copy(this)},fromArray:function(e,o){o===void 0&&(o=0);for(var h=this.coefficients,m=0;9>m;m++)h[m].fromArray(e,o+3*m);return this},toArray:function(e,o){e===void 0&&(e=[]),o===void 0&&(o=0);for(var h=this.coefficients,m=0;9>m;m++)h[m].toArray(e,o+3*m);return e}}),ut(by,{getBasisAt:function(e,o){var h=e.x,m=e.y;e=e.z,o[0]=.282095,o[1]=.488603*m,o[2]=.488603*e,o[3]=.488603*h,o[4]=1.092548*h*m,o[5]=1.092548*m*e,o[6]=.315392*(3*e*e-1),o[7]=1.092548*h*e,o[8]=.546274*(h*h-m*m)}}),Ra.prototype=ut(at(cn.prototype),{constructor:Ra,isLightProbe:!0,copy:function(e){return cn.prototype.copy.call(this,e),this.sh.copy(e.sh),this},fromJSON:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this},toJSON:function(e){return e=cn.prototype.toJSON.call(this,e),e.object.sh=this.sh.toArray(),e}}),Vy.prototype=ut(at(Ki.prototype),{constructor:Vy,load:function(e,o,h,m){var _=this,T=new La(_.manager);T.setPath(_.path),T.load(e,function(R){try{o(_.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),_.manager.itemError(e)}},h,m)},parse:function(e){function o(z){return h[z]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",z),h[z]}var h=this.textures,m=new hT[e.type];if(e.uuid!==void 0&&(m.uuid=e.uuid),e.name!==void 0&&(m.name=e.name),e.color!==void 0&&m.color.setHex(e.color),e.roughness!==void 0&&(m.roughness=e.roughness),e.metalness!==void 0&&(m.metalness=e.metalness),e.sheen!==void 0&&(m.sheen=new yt().setHex(e.sheen)),e.emissive!==void 0&&m.emissive.setHex(e.emissive),e.specular!==void 0&&m.specular.setHex(e.specular),e.shininess!==void 0&&(m.shininess=e.shininess),e.clearcoat!==void 0&&(m.clearcoat=e.clearcoat),e.clearcoatRoughness!==void 0&&(m.clearcoatRoughness=e.clearcoatRoughness),e.fog!==void 0&&(m.fog=e.fog),e.flatShading!==void 0&&(m.flatShading=e.flatShading),e.blending!==void 0&&(m.blending=e.blending),e.combine!==void 0&&(m.combine=e.combine),e.side!==void 0&&(m.side=e.side),e.opacity!==void 0&&(m.opacity=e.opacity),e.transparent!==void 0&&(m.transparent=e.transparent),e.alphaTest!==void 0&&(m.alphaTest=e.alphaTest),e.depthTest!==void 0&&(m.depthTest=e.depthTest),e.depthWrite!==void 0&&(m.depthWrite=e.depthWrite),e.colorWrite!==void 0&&(m.colorWrite=e.colorWrite),e.stencilWrite!==void 0&&(m.stencilWrite=e.stencilWrite),e.stencilWriteMask!==void 0&&(m.stencilWriteMask=e.stencilWriteMask),e.stencilFunc!==void 0&&(m.stencilFunc=e.stencilFunc),e.stencilRef!==void 0&&(m.stencilRef=e.stencilRef),e.stencilFuncMask!==void 0&&(m.stencilFuncMask=e.stencilFuncMask),e.stencilFail!==void 0&&(m.stencilFail=e.stencilFail),e.stencilZFail!==void 0&&(m.stencilZFail=e.stencilZFail),e.stencilZPass!==void 0&&(m.stencilZPass=e.stencilZPass),e.wireframe!==void 0&&(m.wireframe=e.wireframe),e.wireframeLinewidth!==void 0&&(m.wireframeLinewidth=e.wireframeLinewidth),e.wireframeLinecap!==void 0&&(m.wireframeLinecap=e.wireframeLinecap),e.wireframeLinejoin!==void 0&&(m.wireframeLinejoin=e.wireframeLinejoin),e.rotation!==void 0&&(m.rotation=e.rotation),e.linewidth!==1&&(m.linewidth=e.linewidth),e.dashSize!==void 0&&(m.dashSize=e.dashSize),e.gapSize!==void 0&&(m.gapSize=e.gapSize),e.scale!==void 0&&(m.scale=e.scale),e.polygonOffset!==void 0&&(m.polygonOffset=e.polygonOffset),e.polygonOffsetFactor!==void 0&&(m.polygonOffsetFactor=e.polygonOffsetFactor),e.polygonOffsetUnits!==void 0&&(m.polygonOffsetUnits=e.polygonOffsetUnits),e.skinning!==void 0&&(m.skinning=e.skinning),e.morphTargets!==void 0&&(m.morphTargets=e.morphTargets),e.morphNormals!==void 0&&(m.morphNormals=e.morphNormals),e.dithering!==void 0&&(m.dithering=e.dithering),e.vertexTangents!==void 0&&(m.vertexTangents=e.vertexTangents),e.visible!==void 0&&(m.visible=e.visible),e.toneMapped!==void 0&&(m.toneMapped=e.toneMapped),e.userData!==void 0&&(m.userData=e.userData),e.vertexColors!==void 0&&(m.vertexColors=typeof e.vertexColors=="number"?0<e.vertexColors:e.vertexColors),e.uniforms!==void 0)for(var _ in e.uniforms){var T=e.uniforms[_];switch(m.uniforms[_]={},T.type){case"t":m.uniforms[_].value=o(T.value);break;case"c":m.uniforms[_].value=new yt().setHex(T.value);break;case"v2":m.uniforms[_].value=new f().fromArray(T.value);break;case"v3":m.uniforms[_].value=new w().fromArray(T.value);break;case"v4":m.uniforms[_].value=new p().fromArray(T.value);break;case"m3":m.uniforms[_].value=new c().fromArray(T.value);case"m4":m.uniforms[_].value=new I().fromArray(T.value);break;default:m.uniforms[_].value=T.value}}if(e.defines!==void 0&&(m.defines=e.defines),e.vertexShader!==void 0&&(m.vertexShader=e.vertexShader),e.fragmentShader!==void 0&&(m.fragmentShader=e.fragmentShader),e.extensions!==void 0)for(var R in e.extensions)m.extensions[R]=e.extensions[R];return e.shading!==void 0&&(m.flatShading=e.shading===1),e.size!==void 0&&(m.size=e.size),e.sizeAttenuation!==void 0&&(m.sizeAttenuation=e.sizeAttenuation),e.map!==void 0&&(m.map=o(e.map)),e.matcap!==void 0&&(m.matcap=o(e.matcap)),e.alphaMap!==void 0&&(m.alphaMap=o(e.alphaMap)),e.bumpMap!==void 0&&(m.bumpMap=o(e.bumpMap)),e.bumpScale!==void 0&&(m.bumpScale=e.bumpScale),e.normalMap!==void 0&&(m.normalMap=o(e.normalMap)),e.normalMapType!==void 0&&(m.normalMapType=e.normalMapType),e.normalScale!==void 0&&(_=e.normalScale,Array.isArray(_)===!1&&(_=[_,_]),m.normalScale=new f().fromArray(_)),e.displacementMap!==void 0&&(m.displacementMap=o(e.displacementMap)),e.displacementScale!==void 0&&(m.displacementScale=e.displacementScale),e.displacementBias!==void 0&&(m.displacementBias=e.displacementBias),e.roughnessMap!==void 0&&(m.roughnessMap=o(e.roughnessMap)),e.metalnessMap!==void 0&&(m.metalnessMap=o(e.metalnessMap)),e.emissiveMap!==void 0&&(m.emissiveMap=o(e.emissiveMap)),e.emissiveIntensity!==void 0&&(m.emissiveIntensity=e.emissiveIntensity),e.specularMap!==void 0&&(m.specularMap=o(e.specularMap)),e.envMap!==void 0&&(m.envMap=o(e.envMap)),e.envMapIntensity!==void 0&&(m.envMapIntensity=e.envMapIntensity),e.reflectivity!==void 0&&(m.reflectivity=e.reflectivity),e.refractionRatio!==void 0&&(m.refractionRatio=e.refractionRatio),e.lightMap!==void 0&&(m.lightMap=o(e.lightMap)),e.lightMapIntensity!==void 0&&(m.lightMapIntensity=e.lightMapIntensity),e.aoMap!==void 0&&(m.aoMap=o(e.aoMap)),e.aoMapIntensity!==void 0&&(m.aoMapIntensity=e.aoMapIntensity),e.gradientMap!==void 0&&(m.gradientMap=o(e.gradientMap)),e.clearcoatMap!==void 0&&(m.clearcoatMap=o(e.clearcoatMap)),e.clearcoatRoughnessMap!==void 0&&(m.clearcoatRoughnessMap=o(e.clearcoatRoughnessMap)),e.clearcoatNormalMap!==void 0&&(m.clearcoatNormalMap=o(e.clearcoatNormalMap)),e.clearcoatNormalScale!==void 0&&(m.clearcoatNormalScale=new f().fromArray(e.clearcoatNormalScale)),m},setTextures:function(e){return this.textures=e,this}});var d_={decodeText:function(e){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(e);for(var o="",h=0,m=e.length;h<m;h++)o+=String.fromCharCode(e[h]);try{return decodeURIComponent(escape(o))}catch(_){return o}},extractUrlBase:function(e){var o=e.lastIndexOf("/");return o===-1?"./":e.substr(0,o+1)}};Dv.prototype=ut(at(ct.prototype),{constructor:Dv,isInstancedBufferGeometry:!0,copy:function(e){return ct.prototype.copy.call(this,e),this.instanceCount=e.instanceCount,this},clone:function(){return new this.constructor().copy(this)},toJSON:function(){var e=ct.prototype.toJSON.call(this);return e.instanceCount=this.instanceCount,e.isInstancedBufferGeometry=!0,e}}),Wy.prototype=ut(at(ce.prototype),{constructor:Wy,isInstancedBufferAttribute:!0,copy:function(e){return ce.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this},toJSON:function(){var e=ce.prototype.toJSON.call(this);return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}}),jy.prototype=ut(at(Ki.prototype),{constructor:jy,load:function(e,o,h,m){var _=this,T=new La(_.manager);T.setPath(_.path),T.load(e,function(R){try{o(_.parse(JSON.parse(R)))}catch(z){m?m(z):console.error(z),_.manager.itemError(e)}},h,m)},parse:function(e){var o=e.isInstancedBufferGeometry?new Dv:new ct,h=e.data.index;if(h!==void 0){var m=new g_[h.type](h.array);o.setIndex(new ce(m,1))}h=e.data.attributes;for(var _ in h){var T=h[_];m=new g_[T.type](T.array),m=new(T.isInstancedBufferAttribute?Wy:ce)(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),o.setAttribute(_,m)}var R=e.data.morphAttributes;if(R)for(_ in R){var z=R[_],k=[];h=0;for(var b=z.length;h<b;h++)T=z[h],m=new g_[T.type](T.array),m=new ce(m,T.itemSize,T.normalized),T.name!==void 0&&(m.name=T.name),k.push(m);o.morphAttributes[_]=k}if(e.data.morphTargetsRelative&&(o.morphTargetsRelative=!0),_=e.data.groups||e.data.drawcalls||e.data.offsets,_!==void 0)for(h=0,T=_.length;h!==T;++h)m=_[h],o.addGroup(m.start,m.count,m.materialIndex);return h=e.data.boundingSphere,h!==void 0&&(_=new w,h.center!==void 0&&_.fromArray(h.center),o.boundingSphere=new tt(_,h.radius)),e.name&&(o.name=e.name),e.userData&&(o.userData=e.userData),o}});var g_={Int8Array,Uint8Array,Uint8ClampedArray:typeof Uint8ClampedArray!="undefined"?Uint8ClampedArray:Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};Xy.prototype=ut(at(Ki.prototype),{constructor:Xy,load:function(e,o,h,m){var _=this,T=this.path===""?d_.extractUrlBase(e):this.path;this.resourcePath=this.resourcePath||T,T=new La(_.manager),T.setPath(this.path),T.load(e,function(R){var z=null;try{z=JSON.parse(R)}catch(k){m!==void 0&&m(k),console.error("THREE:ObjectLoader: Can't parse "+e+".",k.message);return}R=z.metadata,R===void 0||R.type===void 0||R.type.toLowerCase()==="geometry"?console.error("THREE.ObjectLoader: Can't load "+e):_.parse(z,o)},h,m)},parse:function(e,o){var h=this.parseShape(e.shapes);h=this.parseGeometries(e.geometries,h);var m=this.parseImages(e.images,function(){o!==void 0&&o(_)});m=this.parseTextures(e.textures,m),m=this.parseMaterials(e.materials,m);var _=this.parseObject(e.object,h,m);return e.animations&&(_.animations=this.parseAnimations(e.animations)),e.images!==void 0&&e.images.length!==0||o===void 0||o(_),_},parseShape:function(e){var o={};if(e!==void 0)for(var h=0,m=e.length;h<m;h++){var _=new gc().fromJSON(e[h]);o[_.uuid]=_}return o},parseGeometries:function(e,o){var h={};if(e!==void 0)for(var m=new jy,_=0,T=e.length;_<T;_++){var R=e[_];switch(R.type){case"PlaneGeometry":case"PlaneBufferGeometry":var z=new xs[R.type](R.width,R.height,R.widthSegments,R.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":z=new xs[R.type](R.width,R.height,R.depth,R.widthSegments,R.heightSegments,R.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":z=new xs[R.type](R.radius,R.segments,R.thetaStart,R.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":z=new xs[R.type](R.radiusTop,R.radiusBottom,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":z=new xs[R.type](R.radius,R.height,R.radialSegments,R.heightSegments,R.openEnded,R.thetaStart,R.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":z=new xs[R.type](R.radius,R.widthSegments,R.heightSegments,R.phiStart,R.phiLength,R.thetaStart,R.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":z=new xs[R.type](R.radius,R.detail);break;case"RingGeometry":case"RingBufferGeometry":z=new xs[R.type](R.innerRadius,R.outerRadius,R.thetaSegments,R.phiSegments,R.thetaStart,R.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":z=new xs[R.type](R.radius,R.tube,R.radialSegments,R.tubularSegments,R.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":z=new xs[R.type](R.radius,R.tube,R.tubularSegments,R.radialSegments,R.p,R.q);break;case"TubeGeometry":case"TubeBufferGeometry":z=new xs[R.type](new p_[R.path.type]().fromJSON(R.path),R.tubularSegments,R.radius,R.radialSegments,R.closed);break;case"LatheGeometry":case"LatheBufferGeometry":z=new xs[R.type](R.points,R.segments,R.phiStart,R.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":z=new xs[R.type](R.vertices,R.indices,R.radius,R.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":z=[];for(var k=0,b=R.shapes.length;k<b;k++){var q=o[R.shapes[k]];z.push(q)}z=new xs[R.type](z,R.curveSegments);break;case"ExtrudeGeometry":case"ExtrudeBufferGeometry":for(z=[],k=0,b=R.shapes.length;k<b;k++)q=o[R.shapes[k]],z.push(q);k=R.options.extrudePath,k!==void 0&&(R.options.extrudePath=new p_[k.type]().fromJSON(k)),z=new xs[R.type](z,R.options);break;case"BufferGeometry":case"InstancedBufferGeometry":z=m.parse(R);break;case"Geometry":console.error('THREE.ObjectLoader: Loading "Geometry" is not supported anymore.');break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+R.type+'"');continue}z.uuid=R.uuid,R.name!==void 0&&(z.name=R.name),z.isBufferGeometry===!0&&R.userData!==void 0&&(z.userData=R.userData),h[R.uuid]=z}return h},parseMaterials:function(e,o){var h={},m={};if(e!==void 0){var _=new Vy;_.setTextures(o),o=0;for(var T=e.length;o<T;o++){var R=e[o];if(R.type==="MultiMaterial"){for(var z=[],k=0;k<R.materials.length;k++){var b=R.materials[k];h[b.uuid]===void 0&&(h[b.uuid]=_.parse(b)),z.push(h[b.uuid])}m[R.uuid]=z}else h[R.uuid]===void 0&&(h[R.uuid]=_.parse(R)),m[R.uuid]=h[R.uuid]}}return m},parseAnimations:function(e){for(var o=[],h=0;h<e.length;h++){var m=e[h],_=Ea.parse(m);m.uuid!==void 0&&(_.uuid=m.uuid),o.push(_)}return o},parseImages:function(e,o){function h(Q){return m.manager.itemStart(Q),T.load(Q,function(){m.manager.itemEnd(Q)},void 0,function(){m.manager.itemError(Q),m.manager.itemEnd(Q)})}var m=this,_={};if(e!==void 0&&0<e.length){o=new m2(o);var T=new ig(o);T.setCrossOrigin(this.crossOrigin),o=0;for(var R=e.length;o<R;o++){var z=e[o],k=z.url;if(Array.isArray(k)){_[z.uuid]=[];for(var b=0,q=k.length;b<q;b++){var J=k[b];J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(J)?J:m.resourcePath+J,_[z.uuid].push(h(J))}}else J=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(z.url)?z.url:m.resourcePath+z.url,_[z.uuid]=h(J)}}return _},parseTextures:function(e,o){function h(k,b){return typeof k=="number"?k:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",k),b[k])}var m={};if(e!==void 0)for(var _=0,T=e.length;_<T;_++){var R=e[_];R.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',R.uuid),o[R.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",R.image);var z=Array.isArray(o[R.image])?new Sa(o[R.image]):new g(o[R.image]);z.needsUpdate=!0,z.uuid=R.uuid,R.name!==void 0&&(z.name=R.name),R.mapping!==void 0&&(z.mapping=h(R.mapping,cT)),R.offset!==void 0&&z.offset.fromArray(R.offset),R.repeat!==void 0&&z.repeat.fromArray(R.repeat),R.center!==void 0&&z.center.fromArray(R.center),R.rotation!==void 0&&(z.rotation=R.rotation),R.wrap!==void 0&&(z.wrapS=h(R.wrap[0],BM),z.wrapT=h(R.wrap[1],BM)),R.format!==void 0&&(z.format=R.format),R.type!==void 0&&(z.type=R.type),R.encoding!==void 0&&(z.encoding=R.encoding),R.minFilter!==void 0&&(z.minFilter=h(R.minFilter,NM)),R.magFilter!==void 0&&(z.magFilter=h(R.magFilter,NM)),R.anisotropy!==void 0&&(z.anisotropy=R.anisotropy),R.flipY!==void 0&&(z.flipY=R.flipY),R.premultiplyAlpha!==void 0&&(z.premultiplyAlpha=R.premultiplyAlpha),R.unpackAlignment!==void 0&&(z.unpackAlignment=R.unpackAlignment),m[R.uuid]=z}return m},parseObject:function(e,o,h){function m(b){return o[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",b),o[b]}function _(b){if(b!==void 0){if(Array.isArray(b)){for(var q=[],J=0,Q=b.length;J<Q;J++){var K=b[J];h[K]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",K),q.push(h[K])}return q}return h[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),h[b]}}switch(e.type){case"Scene":var T=new W;e.background!==void 0&&Jh(e.background)&&(T.background=new yt(e.background)),e.fog!==void 0&&(e.fog.type==="Fog"?T.fog=new my(e.fog.color,e.fog.near,e.fog.far):e.fog.type==="FogExp2"&&(T.fog=new gy(e.fog.color,e.fog.density)));break;case"PerspectiveCamera":T=new Ce(e.fov,e.aspect,e.near,e.far),e.focus!==void 0&&(T.focus=e.focus),e.zoom!==void 0&&(T.zoom=e.zoom),e.filmGauge!==void 0&&(T.filmGauge=e.filmGauge),e.filmOffset!==void 0&&(T.filmOffset=e.filmOffset),e.view!==void 0&&(T.view=ut({},e.view));break;case"OrthographicCamera":T=new og(e.left,e.right,e.top,e.bottom,e.near,e.far),e.zoom!==void 0&&(T.zoom=e.zoom),e.view!==void 0&&(T.view=ut({},e.view));break;case"AmbientLight":T=new ky(e.color,e.intensity);break;case"DirectionalLight":T=new Hy(e.color,e.intensity);break;case"PointLight":T=new zy(e.color,e.intensity,e.distance,e.decay);break;case"RectAreaLight":T=new Gy(e.color,e.intensity,e.width,e.height);break;case"SpotLight":T=new Ny(e.color,e.intensity,e.distance,e.angle,e.penumbra,e.decay);break;case"HemisphereLight":T=new Fy(e.color,e.groundColor,e.intensity);break;case"LightProbe":T=new Ra().fromJSON(e);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":T=m(e.geometry);var R=_(e.material);T=new St(T,R);break;case"InstancedMesh":T=m(e.geometry),R=_(e.material);var z=e.instanceMatrix;T=new Ay(T,R,e.count),T.instanceMatrix=new ce(new Float32Array(z.array),16);break;case"LOD":T=new sv;break;case"Line":T=new ea(m(e.geometry),_(e.material),e.mode);break;case"LineLoop":T=new _y(m(e.geometry),_(e.material));break;case"LineSegments":T=new On(m(e.geometry),_(e.material));break;case"PointCloud":case"Points":T=new kd(m(e.geometry),_(e.material));break;case"Sprite":T=new ov(_(e.material));break;case"Group":T=new Hd;break;default:T=new F}if(T.uuid=e.uuid,e.name!==void 0&&(T.name=e.name),e.matrix!==void 0?(T.matrix.fromArray(e.matrix),e.matrixAutoUpdate!==void 0&&(T.matrixAutoUpdate=e.matrixAutoUpdate),T.matrixAutoUpdate&&T.matrix.decompose(T.position,T.quaternion,T.scale)):(e.position!==void 0&&T.position.fromArray(e.position),e.rotation!==void 0&&T.rotation.fromArray(e.rotation),e.quaternion!==void 0&&T.quaternion.fromArray(e.quaternion),e.scale!==void 0&&T.scale.fromArray(e.scale)),e.castShadow!==void 0&&(T.castShadow=e.castShadow),e.receiveShadow!==void 0&&(T.receiveShadow=e.receiveShadow),e.shadow&&(e.shadow.bias!==void 0&&(T.shadow.bias=e.shadow.bias),e.shadow.radius!==void 0&&(T.shadow.radius=e.shadow.radius),e.shadow.mapSize!==void 0&&T.shadow.mapSize.fromArray(e.shadow.mapSize),e.shadow.camera!==void 0&&(T.shadow.camera=this.parseObject(e.shadow.camera))),e.visible!==void 0&&(T.visible=e.visible),e.frustumCulled!==void 0&&(T.frustumCulled=e.frustumCulled),e.renderOrder!==void 0&&(T.renderOrder=e.renderOrder),e.userData!==void 0&&(T.userData=e.userData),e.layers!==void 0&&(T.layers.mask=e.layers),e.children!==void 0)for(z=e.children,R=0;R<z.length;R++)T.add(this.parseObject(z[R],o,h));if(e.type==="LOD")for(e.autoUpdate!==void 0&&(T.autoUpdate=e.autoUpdate),e=e.levels,z=0;z<e.length;z++){R=e[z];var k=T.getObjectByProperty("uuid",R.object);k!==void 0&&T.addLevel(k,R.distance)}return T}});var cT={UVMapping:300,CubeReflectionMapping:301,CubeRefractionMapping:302,EquirectangularReflectionMapping:303,EquirectangularRefractionMapping:304,SphericalReflectionMapping:305,CubeUVReflectionMapping:306,CubeUVRefractionMapping:307},BM={RepeatWrapping:1e3,ClampToEdgeWrapping:1001,MirroredRepeatWrapping:1002},NM={NearestFilter:1003,NearestMipmapNearestFilter:1004,NearestMipmapLinearFilter:1005,LinearFilter:1006,LinearMipmapNearestFilter:1007,LinearMipmapLinearFilter:1008};_2.prototype=ut(at(Ki.prototype),{constructor:_2,setOptions:function(e){return this.options=e,this},load:function(e,o,h,m){e===void 0&&(e=""),this.path!==void 0&&(e=this.path+e),e=this.manager.resolveURL(e);var _=this,T=op.get(e);if(T!==void 0)return _.manager.itemStart(e),setTimeout(function(){o&&o(T),_.manager.itemEnd(e)},0),T;fetch(e).then(function(R){return R.blob()}).then(function(R){return _.options===void 0?createImageBitmap(R):createImageBitmap(R,_.options)}).then(function(R){op.add(e,R),o&&o(R),_.manager.itemEnd(e)}).catch(function(R){m&&m(R),_.manager.itemError(e),_.manager.itemEnd(e)}),_.manager.itemStart(e)}}),ut(w2.prototype,{moveTo:function(e,o){return this.currentPath=new hu,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,o),this},lineTo:function(e,o){return this.currentPath.lineTo(e,o),this},quadraticCurveTo:function(e,o,h,m){return this.currentPath.quadraticCurveTo(e,o,h,m),this},bezierCurveTo:function(e,o,h,m,_,T){return this.currentPath.bezierCurveTo(e,o,h,m,_,T),this},splineThru:function(e){return this.currentPath.splineThru(e),this},toShapes:function(e,o){function h(Bt){for(var Zt=[],bt=0,ae=Bt.length;bt<ae;bt++){var Kt=Bt[bt],fe=new gc;fe.curves=Kt.curves,Zt.push(fe)}return Zt}function m(Bt,Zt){for(var bt=Zt.length,ae=!1,Kt=bt-1,fe=0;fe<bt;Kt=fe++){var Xt=Zt[Kt],Me=Zt[fe],Ne=Me.x-Xt.x,pe=Me.y-Xt.y;if(Math.abs(pe)>hn){if(0>pe&&(Xt=Zt[fe],Ne=-Ne,Me=Zt[Kt],pe=-pe),!(Bt.y<Xt.y||Bt.y>Me.y))if(Bt.y===Xt.y){if(Bt.x===Xt.x)return!0}else{if(Kt=pe*(Bt.x-Xt.x)-Ne*(Bt.y-Xt.y),Kt===0)return!0;0>Kt||(ae=!ae)}}else if(Bt.y===Xt.y&&(Me.x<=Bt.x&&Bt.x<=Xt.x||Xt.x<=Bt.x&&Bt.x<=Me.x))return!0}return ae}var _=mh.isClockWise,T=this.subPaths;if(T.length===0)return[];if(o===!0)return h(T);if(o=[],T.length===1){var R=T[0],z=new gc;return z.curves=R.curves,o.push(z),o}var k=!_(T[0].getPoints());k=e?!k:k,z=[];var b=[],q=[],J=0;b[J]=void 0,q[J]=[];for(var Q=0,K=T.length;Q<K;Q++){R=T[Q];var rt=R.getPoints(),lt=_(rt);(lt=e?!lt:lt)?(!k&&b[J]&&J++,b[J]={s:new gc,p:rt},b[J].s.curves=R.curves,k&&J++,q[J]=[]):q[J].push({h:R,p:rt[0]})}if(!b[0])return h(T);if(1<b.length){for(Q=!1,e=[],_=0,T=b.length;_<T;_++)z[_]=[];for(_=0,T=b.length;_<T;_++)for(R=q[_],lt=0;lt<R.length;lt++){for(k=R[lt],J=!0,rt=0;rt<b.length;rt++)m(k.p,b[rt].p)&&(_!==rt&&e.push({froms:_,tos:rt,hole:lt}),J?(J=!1,z[rt].push(k)):Q=!0);J&&z[_].push(k)}0<e.length&&(Q||(q=z))}for(Q=0,_=b.length;Q<_;Q++)for(z=b[Q].s,o.push(z),e=q[Q],T=0,R=e.length;T<R;T++)z.holes.push(e[T].h);return o}}),ut(M2.prototype,{isFont:!0,generateShapes:function(e,o){o===void 0&&(o=100);var h=[],m=o;o=this.data;var _=ff?ff(e):String(e).split("");m/=o.resolution;var T=(o.boundingBox.yMax-o.boundingBox.yMin+o.underlineThickness)*m;e=[];for(var R=0,z=0,k=0;k<_.length;k++){var b=_[k];if(b===`
`)R=0,z-=T;else{var q=b;b=m;var J=R,Q=z,K=o,rt=K.glyphs[q]||K.glyphs["?"];if(rt){if(q=new w2,rt.o){K=rt._cachedOutline||(rt._cachedOutline=rt.o.split(" "));for(var lt=0,Bt=K.length;lt<Bt;)switch(K[lt++]){case"m":var Zt=K[lt++]*b+J,bt=K[lt++]*b+Q;q.moveTo(Zt,bt);break;case"l":Zt=K[lt++]*b+J,bt=K[lt++]*b+Q,q.lineTo(Zt,bt);break;case"q":var ae=K[lt++]*b+J,Kt=K[lt++]*b+Q,fe=K[lt++]*b+J,Xt=K[lt++]*b+Q;q.quadraticCurveTo(fe,Xt,ae,Kt);break;case"b":ae=K[lt++]*b+J,Kt=K[lt++]*b+Q,fe=K[lt++]*b+J,Xt=K[lt++]*b+Q,Zt=K[lt++]*b+J,bt=K[lt++]*b+Q,q.bezierCurveTo(fe,Xt,Zt,bt,ae,Kt)}}b={offsetX:rt.ha*b,path:q}}else console.error('THREE.Font: character "'+q+'" does not exists in font family '+K.familyName+"."),b=void 0;R+=b.offsetX,e.push(b.path)}}for(o=0,_=e.length;o<_;o++)Array.prototype.push.apply(h,e[o].toShapes());return h}}),C2.prototype=ut(at(Ki.prototype),{constructor:C2,load:function(e,o,h,m){var _=this,T=new La(this.manager);T.setPath(this.path),T.load(e,function(R){try{var z=JSON.parse(R)}catch(k){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),z=JSON.parse(R.substring(65,R.length-2))}R=_.parse(z),o&&o(R)},h,m)},parse:function(e){return new M2(e)}});var _x,m_={getContext:function(){return _x===void 0&&(_x=new(window.AudioContext||window.webkitAudioContext)),_x},setContext:function(e){_x=e}};Yy.prototype=ut(at(Ki.prototype),{constructor:Yy,load:function(e,o,h,m){var _=this,T=new La(_.manager);T.setResponseType("arraybuffer"),T.setPath(_.path),T.load(e,function(R){try{var z=R.slice(0);m_.getContext().decodeAudioData(z,function(k){o(k)})}catch(k){m?m(k):console.error(k),_.manager.itemError(e)}},h,m)}}),T2.prototype=ut(at(Ra.prototype),{constructor:T2,isHemisphereLightProbe:!0,copy:function(e){return Ra.prototype.copy.call(this,e),this},toJSON:function(e){return Ra.prototype.toJSON.call(this,e)}}),S2.prototype=ut(at(Ra.prototype),{constructor:S2,isAmbientLightProbe:!0,copy:function(e){return Ra.prototype.copy.call(this,e),this},toJSON:function(e){return Ra.prototype.toJSON.call(this,e)}});var zM=new I,UM=new I;ut(Ww.prototype,{update:function(e){var o=this._cache;if(o.focus!==e.focus||o.fov!==e.fov||o.aspect!==e.aspect*this.aspect||o.near!==e.near||o.far!==e.far||o.zoom!==e.zoom||o.eyeSep!==this.eyeSep){o.focus=e.focus,o.fov=e.fov,o.aspect=e.aspect*this.aspect,o.near=e.near,o.far=e.far,o.zoom=e.zoom,o.eyeSep=this.eyeSep;var h=e.projectionMatrix.clone(),m=o.eyeSep/2,_=m*o.near/o.focus,T=o.near*Math.tan(di.DEG2RAD*o.fov*.5)/o.zoom;UM.elements[12]=-m,zM.elements[12]=m,m=-T*o.aspect+_;var R=T*o.aspect+_;h.elements[0]=2*o.near/(R-m),h.elements[8]=(R+m)/(R-m),this.cameraL.projectionMatrix.copy(h),m=-T*o.aspect-_,R=T*o.aspect-_,h.elements[0]=2*o.near/(R-m),h.elements[8]=(R+m)/(R-m),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(e.matrixWorld).multiply(UM),this.cameraR.matrixWorld.copy(e.matrixWorld).multiply(zM)}}),ut(I2.prototype,{start:function(){this.oldTime=this.startTime=(typeof performance=="undefined"?Date:performance).now(),this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.autoStart=this.running=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var o=(typeof performance=="undefined"?Date:performance).now();e=(o-this.oldTime)/1e3,this.oldTime=o,this.elapsedTime+=e}return e}});var sp=new w,HM=new N,fT=new w,ap=new w;E2.prototype=ut(at(F.prototype),{constructor:E2,getInput:function(){return this.gain},removeFilter:function(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this},getFilter:function(){return this.filter},setFilter:function(e){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=e,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this},updateMatrixWorld:function(e){F.prototype.updateMatrixWorld.call(this,e),e=this.context.listener;var o=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(sp,HM,fT),ap.set(0,0,-1).applyQuaternion(HM),e.positionX){var h=this.context.currentTime+this.timeDelta;e.positionX.linearRampToValueAtTime(sp.x,h),e.positionY.linearRampToValueAtTime(sp.y,h),e.positionZ.linearRampToValueAtTime(sp.z,h),e.forwardX.linearRampToValueAtTime(ap.x,h),e.forwardY.linearRampToValueAtTime(ap.y,h),e.forwardZ.linearRampToValueAtTime(ap.z,h),e.upX.linearRampToValueAtTime(o.x,h),e.upY.linearRampToValueAtTime(o.y,h),e.upZ.linearRampToValueAtTime(o.z,h)}else e.setPosition(sp.x,sp.y,sp.z),e.setOrientation(ap.x,ap.y,ap.z,o.x,o.y,o.z)}}),sg.prototype=ut(at(F.prototype),{constructor:sg,getOutput:function(){return this.gain},setNodeSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this},setMediaElementSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this},setMediaStreamSource:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this},setBuffer:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(e){if(e===void 0&&(e=0),this.isPlaying===!0)console.warn("THREE.Audio: Audio is already playing.");else if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._startedAt=this.context.currentTime+e,e=this.context.createBufferSource(),e.buffer=this.buffer,e.loop=this.loop,e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.onended=this.onEnded.bind(this),e.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=e,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()},pause:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress%=this.duration||this.buffer.duration),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this},stop:function(){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this},connect:function(){if(0<this.filters.length){this.source.connect(this.filters[0]);for(var e=1,o=this.filters.length;e<o;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(0<this.filters.length){this.source.disconnect(this.filters[0]);for(var e=1,o=this.filters.length;e<o;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(e){return e||(e=[]),this.isPlaying===!0?(this.disconnect(),this.filters=e,this.connect()):this.filters=e,this},setDetune:function(e){if(this.detune=e,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this},getDetune:function(){return this.detune},getFilter:function(){return this.getFilters()[0]},setFilter:function(e){return this.setFilters(e?[e]:[])},setPlaybackRate:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.playbackRate=e,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(e){if(this.hasPlaybackControl===!1)console.warn("THREE.Audio: this Audio has no playback control.");else return this.loop=e,this.isPlaying===!0&&(this.source.loop=this.loop),this},setLoopStart:function(e){return this.loopStart=e,this},setLoopEnd:function(e){return this.loopEnd=e,this},getVolume:function(){return this.gain.gain.value},setVolume:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}});var up=new w,kM=new N,pT=new w,lp=new w;L2.prototype=ut(at(sg.prototype),{constructor:L2,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(e){return this.panner.refDistance=e,this},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(e){return this.panner.rolloffFactor=e,this},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(e){return this.panner.distanceModel=e,this},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(e){return this.panner.maxDistance=e,this},setDirectionalCone:function(e,o,h){return this.panner.coneInnerAngle=e,this.panner.coneOuterAngle=o,this.panner.coneOuterGain=h,this},updateMatrixWorld:function(e){if(F.prototype.updateMatrixWorld.call(this,e),this.hasPlaybackControl!==!0||this.isPlaying!==!1)if(this.matrixWorld.decompose(up,kM,pT),lp.set(0,0,1).applyQuaternion(kM),e=this.panner,e.positionX){var o=this.context.currentTime+this.listener.timeDelta;e.positionX.linearRampToValueAtTime(up.x,o),e.positionY.linearRampToValueAtTime(up.y,o),e.positionZ.linearRampToValueAtTime(up.z,o),e.orientationX.linearRampToValueAtTime(lp.x,o),e.orientationY.linearRampToValueAtTime(lp.y,o),e.orientationZ.linearRampToValueAtTime(lp.z,o)}else e.setPosition(up.x,up.y,up.z),e.setOrientation(lp.x,lp.y,lp.z)}}),ut(R2.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var e=0,o=this.getFrequencyData(),h=0;h<o.length;h++)e+=o[h];return e/o.length}}),ut(P2.prototype,{accumulate:function(e,o){var h=this.buffer,m=this.valueSize;e=e*m+m;var _=this.cumulativeWeight;if(_===0){for(_=0;_!==m;++_)h[e+_]=h[_];_=o}else _+=o,this._mixBufferRegion(h,e,0,o/_,m);this.cumulativeWeight=_},accumulateAdditive:function(e){var o=this.buffer,h=this.valueSize,m=h*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(o,m,0,e,h),this.cumulativeWeightAdditive+=e},apply:function(e){var o=this.valueSize,h=this.buffer;e=e*o+o;var m=this.cumulativeWeight,_=this.cumulativeWeightAdditive,T=this.binding;for(this.cumulativeWeightAdditive=this.cumulativeWeight=0,1>m&&this._mixBufferRegion(h,e,o*this._origIndex,1-m,o),0<_&&this._mixBufferRegionAdditive(h,e,this._addIndex*o,1,o),m=o,_=o+o;m!==_;++m)if(h[m]!==h[m+o]){T.setValue(h,e);break}},saveOriginalState:function(){var e=this.buffer,o=this.valueSize,h=o*this._origIndex;this.binding.getValue(e,h);for(var m=o;m!==h;++m)e[m]=e[h+m%o];this._setIdentity(),this.cumulativeWeightAdditive=this.cumulativeWeight=0},restoreOriginalState:function(){this.binding.setValue(this.buffer,3*this.valueSize)},_setAdditiveIdentityNumeric:function(){for(var e=this._addIndex*this.valueSize,o=e+this.valueSize;e<o;e++)this.buffer[e]=0},_setAdditiveIdentityQuaternion:function(){this._setAdditiveIdentityNumeric(),this.buffer[4*this._addIndex+3]=1},_setAdditiveIdentityOther:function(){for(var e=this._origIndex*this.valueSize,o=this._addIndex*this.valueSize,h=0;h<this.valueSize;h++)this.buffer[o+h]=this.buffer[e+h]},_select:function(e,o,h,m,_){if(.5<=m)for(m=0;m!==_;++m)e[o+m]=e[h+m]},_slerp:function(e,o,h,m){N.slerpFlat(e,o,e,o,e,h,m)},_slerpAdditive:function(e,o,h,m,_){_*=this._workIndex,N.multiplyQuaternionsFlat(e,_,e,o,e,h),N.slerpFlat(e,o,e,o,e,_,m)},_lerp:function(e,o,h,m,_){for(var T=1-m,R=0;R!==_;++R){var z=o+R;e[z]=e[z]*T+e[h+R]*m}},_lerpAdditive:function(e,o,h,m,_){for(var T=0;T!==_;++T){var R=o+T;e[R]+=e[h+T]*m}}});var dT=/[\[\]\.:\/]/g,gT="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",mT=/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]"),vT=/(WCOD+)?/.source.replace("WCOD",gT),yT=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]"),xT=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]"),AT=new RegExp("^"+mT+vT+yT+xT+"$"),_T=["material","materials","bones"];ut(jw.prototype,{getValue:function(e,o){this.bind();var h=this._bindings[this._targetGroup.nCachedObjects_];h!==void 0&&h.getValue(e,o)},setValue:function(e,o){for(var h=this._bindings,m=this._targetGroup.nCachedObjects_,_=h.length;m!==_;++m)h[m].setValue(e,o)},bind:function(){for(var e=this._bindings,o=this._targetGroup.nCachedObjects_,h=e.length;o!==h;++o)e[o].bind()},unbind:function(){for(var e=this._bindings,o=this._targetGroup.nCachedObjects_,h=e.length;o!==h;++o)e[o].unbind()}}),ut(is,{Composite:jw,create:function(e,o,h){return e&&e.isAnimationObjectGroup?new is.Composite(e,o,h):new is(e,o,h)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(dT,"")},parseTrackName:function(e){var o=AT.exec(e);if(!o)throw Error("PropertyBinding: Cannot parse trackName: "+e);o={nodeName:o[2],objectName:o[3],objectIndex:o[4],propertyName:o[5],propertyIndex:o[6]};var h=o.nodeName&&o.nodeName.lastIndexOf(".");if(h!==void 0&&h!==-1){var m=o.nodeName.substring(h+1);_T.indexOf(m)!==-1&&(o.nodeName=o.nodeName.substring(0,h),o.objectName=m)}if(o.propertyName===null||o.propertyName.length===0)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return o},findNode:function(e,o){if(!o||o===""||o==="."||o===-1||o===e.name||o===e.uuid)return e;if(e.skeleton){var h=e.skeleton.getBoneByName(o);if(h!==void 0)return h}return e.children&&(e=function m(_){for(var T=0;T<_.length;T++){var R=_[T];if(R.name===o||R.uuid===o||(R=m(R.children)))return R}return null}(e.children))?e:null}}),ut(is.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,o){e[o]=this.node[this.propertyName]},function(e,o){for(var h=this.resolvedProperty,m=0,_=h.length;m!==_;++m)e[o++]=h[m]},function(e,o){e[o]=this.resolvedProperty[this.propertyIndex]},function(e,o){this.resolvedProperty.toArray(e,o)}],SetterByBindingTypeAndVersioning:[[function(e,o){this.targetObject[this.propertyName]=e[o]},function(e,o){this.targetObject[this.propertyName]=e[o],this.targetObject.needsUpdate=!0},function(e,o){this.targetObject[this.propertyName]=e[o],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){for(var h=this.resolvedProperty,m=0,_=h.length;m!==_;++m)h[m]=e[o++]},function(e,o){for(var h=this.resolvedProperty,m=0,_=h.length;m!==_;++m)h[m]=e[o++];this.targetObject.needsUpdate=!0},function(e,o){for(var h=this.resolvedProperty,m=0,_=h.length;m!==_;++m)h[m]=e[o++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){this.resolvedProperty[this.propertyIndex]=e[o]},function(e,o){this.resolvedProperty[this.propertyIndex]=e[o],this.targetObject.needsUpdate=!0},function(e,o){this.resolvedProperty[this.propertyIndex]=e[o],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,o){this.resolvedProperty.fromArray(e,o)},function(e,o){this.resolvedProperty.fromArray(e,o),this.targetObject.needsUpdate=!0},function(e,o){this.resolvedProperty.fromArray(e,o),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,o){this.bind(),this.getValue(e,o)},setValue:function(e,o){this.bind(),this.setValue(e,o)},bind:function(){var e=this.node,o=this.parsedPath,h=o.objectName,m=o.propertyName,_=o.propertyIndex;if(e||(this.node=e=is.findNode(this.rootNode,o.nodeName)||this.rootNode),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(h){var T=o.objectIndex;switch(h){case"materials":if(!e.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!e.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}e=e.material.materials;break;case"bones":if(!e.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}for(e=e.skeleton.bones,h=0;h<e.length;h++)if(e[h].name===T){T=h;break}break;default:if(e[h]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}e=e[h]}if(T!==void 0){if(e[T]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);return}e=e[T]}}if(T=e[m],T===void 0)console.error("THREE.PropertyBinding: Trying to update property for track: "+o.nodeName+"."+m+" but it wasn't found.",e);else{if(o=this.Versioning.None,this.targetObject=e,e.needsUpdate!==void 0?o=this.Versioning.NeedsUpdate:e.matrixWorldNeedsUpdate!==void 0&&(o=this.Versioning.MatrixWorldNeedsUpdate),h=this.BindingType.Direct,_!==void 0){if(m==="morphTargetInfluences"){if(!e.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(e.geometry.isBufferGeometry){if(!e.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}e.morphTargetDictionary[_]!==void 0&&(_=e.morphTargetDictionary[_])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}h=this.BindingType.ArrayElement,this.resolvedProperty=T,this.propertyIndex=_}else T.fromArray!==void 0&&T.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=T):Array.isArray(T)?(h=this.BindingType.EntireArray,this.resolvedProperty=T):this.propertyName=m;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][o]}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),ut(is.prototype,{_getValue_unbound:is.prototype.getValue,_setValue_unbound:is.prototype.setValue}),ut(Xw.prototype,{isAnimationObjectGroup:!0,add:function(){for(var e=this._objects,o=e.length,h=this.nCachedObjects_,m=this._indicesByUUID,_=this._paths,T=this._parsedPaths,R=this._bindings,z=R.length,k=void 0,b=0,q=arguments.length;b!==q;++b){var J=arguments[b],Q=J.uuid,K=m[Q];if(K===void 0){K=o++,m[Q]=K,e.push(J),Q=0;for(var rt=z;Q!==rt;++Q)R[Q].push(new is(J,_[Q],T[Q]))}else if(K<h){k=e[K];var lt=--h;for(rt=e[lt],m[rt.uuid]=K,e[K]=rt,m[Q]=lt,e[lt]=J,Q=0,rt=z;Q!==rt;++Q){var Bt=R[Q],Zt=Bt[K];Bt[K]=Bt[lt],Zt===void 0&&(Zt=new is(J,_[Q],T[Q])),Bt[lt]=Zt}}else e[K]!==k&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=h},remove:function(){for(var e=this._objects,o=this.nCachedObjects_,h=this._indicesByUUID,m=this._bindings,_=m.length,T=0,R=arguments.length;T!==R;++T){var z=arguments[T],k=z.uuid,b=h[k];if(b!==void 0&&b>=o){var q=o++,J=e[q];for(h[J.uuid]=b,e[b]=J,h[k]=q,e[q]=z,z=0,k=_;z!==k;++z){J=m[z];var Q=J[b];J[b]=J[q],J[q]=Q}}}this.nCachedObjects_=o},uncache:function(){for(var e=this._objects,o=e.length,h=this.nCachedObjects_,m=this._indicesByUUID,_=this._bindings,T=_.length,R=0,z=arguments.length;R!==z;++R){var k=arguments[R].uuid,b=m[k];if(b!==void 0)if(delete m[k],b<h){k=--h;var q=e[k],J=--o,Q=e[J];for(m[q.uuid]=b,e[b]=q,m[Q.uuid]=k,e[k]=Q,e.pop(),q=0,Q=T;q!==Q;++q){var K=_[q],rt=K[J];K[b]=K[k],K[k]=rt,K.pop()}}else for(J=--o,Q=e[J],m[Q.uuid]=b,e[b]=Q,e.pop(),q=0,Q=T;q!==Q;++q)K=_[q],K[b]=K[J],K.pop()}this.nCachedObjects_=h},subscribe_:function(e,o){var h=this._bindingsIndicesByPath,m=h[e],_=this._bindings;if(m!==void 0)return _[m];var T=this._paths,R=this._parsedPaths,z=this._objects,k=this.nCachedObjects_,b=Array(z.length);for(m=_.length,h[e]=m,T.push(e),R.push(o),_.push(b),h=k,m=z.length;h!==m;++h)b[h]=new is(z[h],e,o);return b},unsubscribe_:function(e){var o=this._bindingsIndicesByPath,h=o[e];if(h!==void 0){var m=this._paths,_=this._parsedPaths,T=this._bindings,R=T.length-1,z=T[R];o[e[R]]=h,T[h]=z,T.pop(),_[h]=_[R],_.pop(),m[h]=m[R],m.pop()}}}),ut(Yw.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(e){return this._startTime=e,this},setLoop:function(e,o){return this.loop=e,this.repetitions=o,this},setEffectiveWeight:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(e){return this._scheduleFading(e,0,1)},fadeOut:function(e){return this._scheduleFading(e,1,0)},crossFadeFrom:function(e,o,h){if(e.fadeOut(o),this.fadeIn(o),h){h=this._clip.duration;var m=e._clip.duration,_=h/m;e.warp(1,m/h,o),this.warp(_,1,o)}return this},crossFadeTo:function(e,o,h){return e.crossFadeFrom(this,o,h)},stopFading:function(){var e=this._weightInterpolant;return e!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},setEffectiveTimeScale:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()},syncWith:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()},halt:function(e){return this.warp(this._effectiveTimeScale,0,e)},warp:function(e,o,h){var m=this._mixer,_=m.time,T=this._timeScaleInterpolant,R=this.timeScale;return T===null&&(this._timeScaleInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=_,m[1]=_+h,T[0]=e/R,T[1]=o/R,this},stopWarping:function(){var e=this._timeScaleInterpolant;return e!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(e,o,h,m){if(this.enabled){var _=this._startTime;if(_!==null){if(o=(e-_)*h,0>o||h===0)return;this._startTime=null,o*=h}if(o*=this._updateTimeScale(e),h=this._updateTime(o),e=this._updateWeight(e),0<e)switch(o=this._interpolants,_=this._propertyBindings,this.blendMode){case 2501:for(var T=0,R=o.length;T!==R;++T)o[T].evaluate(h),_[T].accumulateAdditive(e);break;default:for(T=0,R=o.length;T!==R;++T)o[T].evaluate(h),_[T].accumulate(m,e)}}else this._updateWeight(e)},_updateWeight:function(e){var o=0;if(this.enabled){o=this.weight;var h=this._weightInterpolant;if(h!==null){var m=h.evaluate(e)[0];o*=m,e>h.parameterPositions[1]&&(this.stopFading(),m===0&&(this.enabled=!1))}}return this._effectiveWeight=o},_updateTimeScale:function(e){var o=0;if(!this.paused){o=this.timeScale;var h=this._timeScaleInterpolant;if(h!==null){var m=h.evaluate(e)[0];o*=m,e>h.parameterPositions[1]&&(this.stopWarping(),o===0?this.paused=!0:this.timeScale=o)}}return this._effectiveTimeScale=o},_updateTime:function(e){var o=this.time+e,h=this._clip.duration,m=this.loop,_=this._loopCount,T=m===2202;if(e===0)return _===-1?o:T&&(_&1)===1?h-o:o;if(m===2200)t:{if(_===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1)),o>=h)o=h;else if(0>o)o=0;else{this.time=o;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:0>e?-1:1})}else{if(_===-1&&(0<=e?(_=0,this._setEndings(!0,this.repetitions===0,T)):this._setEndings(this.repetitions===0,!0,T)),o>=h||0>o){m=Math.floor(o/h),o-=h*m,_+=Math.abs(m);var R=this.repetitions-_;0>=R?(this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o=0<e?h:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:0<e?1:-1})):(R===1?(e=0>e,this._setEndings(e,!e,T)):this._setEndings(!1,!1,T),this._loopCount=_,this.time=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m}))}else this.time=o;if(T&&(_&1)===1)return h-o}return o},_setEndings:function(e,o,h){var m=this._interpolantSettings;h?(m.endingStart=2401,m.endingEnd=2401):(m.endingStart=e?this.zeroSlopeAtStart?2401:2400:2402,m.endingEnd=o?this.zeroSlopeAtEnd?2401:2400:2402)},_scheduleFading:function(e,o,h){var m=this._mixer,_=m.time,T=this._weightInterpolant;return T===null&&(this._weightInterpolant=T=m._lendControlInterpolant()),m=T.parameterPositions,T=T.sampleValues,m[0]=_,T[0]=o,m[1]=_+e,T[1]=h,this}}),D2.prototype=ut(at(s.prototype),{constructor:D2,_bindAction:function(e,o){var h=e._localRoot||this._root,m=e._clip.tracks,_=m.length,T=e._propertyBindings;e=e._interpolants;var R=h.uuid,z=this._bindingsByRootAndName,k=z[R];for(k===void 0&&(k={},z[R]=k),z=0;z!==_;++z){var b=m[z],q=b.name,J=k[q];if(J===void 0){if(J=T[z],J!==void 0){J._cacheIndex===null&&(++J.referenceCount,this._addInactiveBinding(J,R,q));continue}J=new P2(is.create(h,q,o&&o._propertyBindings[z].binding.parsedPath),b.ValueTypeName,b.getValueSize()),++J.referenceCount,this._addInactiveBinding(J,R,q)}T[z]=J,e[z].resultBuffer=J.buffer}},_activateAction:function(e){if(!this._isActiveAction(e)){if(e._cacheIndex===null){var o=(e._localRoot||this._root).uuid,h=e._clip.uuid,m=this._actionsByClip[h];this._bindAction(e,m&&m.knownActions[0]),this._addInactiveAction(e,h,o)}for(o=e._propertyBindings,h=0,m=o.length;h!==m;++h){var _=o[h];_.useCount++===0&&(this._lendBinding(_),_.saveOriginalState())}this._lendAction(e)}},_deactivateAction:function(e){if(this._isActiveAction(e)){for(var o=e._propertyBindings,h=0,m=o.length;h!==m;++h){var _=o[h];--_.useCount===0&&(_.restoreOriginalState(),this._takeBackBinding(_))}this._takeBackAction(e)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}},_isActiveAction:function(e){return e=e._cacheIndex,e!==null&&e<this._nActiveActions},_addInactiveAction:function(e,o,h){var m=this._actions,_=this._actionsByClip,T=_[o];T===void 0?(T={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,_[o]=T):(o=T.knownActions,e._byClipCacheIndex=o.length,o.push(e)),e._cacheIndex=m.length,m.push(e),T.actionByRoot[h]=e},_removeInactiveAction:function(e){var o=this._actions,h=o[o.length-1],m=e._cacheIndex;h._cacheIndex=m,o[m]=h,o.pop(),e._cacheIndex=null,o=e._clip.uuid,h=this._actionsByClip,m=h[o];var _=m.knownActions,T=_[_.length-1],R=e._byClipCacheIndex;T._byClipCacheIndex=R,_[R]=T,_.pop(),e._byClipCacheIndex=null,delete m.actionByRoot[(e._localRoot||this._root).uuid],_.length===0&&delete h[o],this._removeInactiveBindingsForAction(e)},_removeInactiveBindingsForAction:function(e){e=e._propertyBindings;for(var o=0,h=e.length;o!==h;++o){var m=e[o];--m.referenceCount===0&&this._removeInactiveBinding(m)}},_lendAction:function(e){var o=this._actions,h=e._cacheIndex,m=this._nActiveActions++,_=o[m];e._cacheIndex=m,o[m]=e,_._cacheIndex=h,o[h]=_},_takeBackAction:function(e){var o=this._actions,h=e._cacheIndex,m=--this._nActiveActions,_=o[m];e._cacheIndex=m,o[m]=e,_._cacheIndex=h,o[h]=_},_addInactiveBinding:function(e,o,h){var m=this._bindingsByRootAndName,_=m[o],T=this._bindings;_===void 0&&(_={},m[o]=_),_[h]=e,e._cacheIndex=T.length,T.push(e)},_removeInactiveBinding:function(e){var o=this._bindings,h=e.binding,m=h.rootNode.uuid;h=h.path;var _=this._bindingsByRootAndName,T=_[m],R=o[o.length-1];e=e._cacheIndex,R._cacheIndex=e,o[e]=R,o.pop(),delete T[h],Pi(T).length===0&&delete _[m]},_lendBinding:function(e){var o=this._bindings,h=e._cacheIndex,m=this._nActiveBindings++,_=o[m];e._cacheIndex=m,o[m]=e,_._cacheIndex=h,o[h]=_},_takeBackBinding:function(e){var o=this._bindings,h=e._cacheIndex,m=--this._nActiveBindings,_=o[m];e._cacheIndex=m,o[m]=e,_._cacheIndex=h,o[h]=_},_lendControlInterpolant:function(){var e=this._controlInterpolants,o=this._nActiveControlInterpolants++,h=e[o];return h===void 0&&(h=new Ev(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),h.__cacheIndex=o,e[o]=h),h},_takeBackControlInterpolant:function(e){var o=this._controlInterpolants,h=e.__cacheIndex,m=--this._nActiveControlInterpolants,_=o[m];e.__cacheIndex=m,o[m]=e,_.__cacheIndex=h,o[h]=_},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(e,o,h){var m=o||this._root,_=m.uuid;m=typeof e=="string"?Ea.findByName(m,e):e,e=m!==null?m.uuid:e;var T=this._actionsByClip[e],R=null;if(h===void 0&&(h=m!==null?m.blendMode:2500),T!==void 0){if(R=T.actionByRoot[_],R!==void 0&&R.blendMode===h)return R;R=T.knownActions[0],m===null&&(m=R._clip)}return m===null?null:(o=new Yw(this,m,o,h),this._bindAction(o,R),this._addInactiveAction(o,e,_),o)},existingAction:function(e,o){var h=o||this._root;return o=h.uuid,h=typeof e=="string"?Ea.findByName(h,e):e,e=this._actionsByClip[h?h.uuid:e],e!==void 0&&e.actionByRoot[o]||null},stopAllAction:function(){for(var e=this._actions,o=this._nActiveActions-1;0<=o;--o)e[o].stop();return this},update:function(e){e*=this.timeScale;for(var o=this._actions,h=this._nActiveActions,m=this.time+=e,_=Zu(e),T=this._accuIndex^=1,R=0;R!==h;++R)o[R]._update(m,e,_,T);for(e=this._bindings,o=this._nActiveBindings,R=0;R!==o;++R)e[R].apply(T);return this},setTime:function(e){for(var o=this.time=0;o<this._actions.length;o++)this._actions[o].time=0;return this.update(e)},getRoot:function(){return this._root},uncacheClip:function(e){var o=this._actions;e=e.uuid;var h=this._actionsByClip,m=h[e];if(m!==void 0){m=m.knownActions;for(var _=0,T=m.length;_!==T;++_){var R=m[_];this._deactivateAction(R);var z=R._cacheIndex,k=o[o.length-1];R._cacheIndex=null,R._byClipCacheIndex=null,k._cacheIndex=z,o[z]=k,o.pop(),this._removeInactiveBindingsForAction(R)}delete h[e]}},uncacheRoot:function(e){e=e.uuid;var o=this._actionsByClip;for(m in o){var h=o[m].actionByRoot[e];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}var m=this._bindingsByRootAndName[e];if(m!==void 0)for(var _ in m)e=m[_],e.restoreOriginalState(),this._removeInactiveBinding(e)},uncacheAction:function(e,o){e=this.existingAction(e,o),e!==null&&(this._deactivateAction(e),this._removeInactiveAction(e))}}),Zy.prototype.clone=function(){return new Zy(this.value.clone===void 0?this.value:this.value.clone())},O2.prototype=ut(at(oh.prototype),{constructor:O2,isInstancedInterleavedBuffer:!0,copy:function(e){return oh.prototype.copy.call(this,e),this.meshPerAttribute=e.meshPerAttribute,this}}),ut(F2.prototype,{set:function(e,o){this.ray.set(e,o)},setFromCamera:function(e,o){o&&o.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(o.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(o).sub(this.ray.origin).normalize(),this.camera=o):o&&o.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(o.near+o.far)/(o.near-o.far)).unproject(o),this.ray.direction.set(0,0,-1).transformDirection(o.matrixWorld),this.camera=o):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(e,o,h){return h=h||[],B2(e,this,h,o),h.sort(Zw),h},intersectObjects:function(e,o,h){if(h=h||[],Array.isArray(e)===!1)return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),h;for(var m=0,_=e.length;m<_;m++)B2(e[m],this,h,o);return h.sort(Zw),h}}),ut(Jw.prototype,{set:function(e,o,h){return this.radius=e,this.phi=o,this.theta=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,o,h){return this.radius=Math.sqrt(e*e+o*o+h*h),this.radius===0?this.phi=this.theta=0:(this.theta=Math.atan2(e,h),this.phi=Math.acos(di.clamp(o/this.radius,-1,1))),this}}),ut(qw.prototype,{set:function(e,o,h){return this.radius=e,this.theta=o,this.y=h,this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.radius=e.radius,this.theta=e.theta,this.y=e.y,this},setFromVector3:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)},setFromCartesianCoords:function(e,o,h){return this.radius=Math.sqrt(e*e+h*h),this.theta=Math.atan2(e,h),this.y=o,this}});var GM=new f;ut(N2.prototype,{set:function(e,o){return this.min.copy(e),this.max.copy(o),this},setFromPoints:function(e){this.makeEmpty();for(var o=0,h=e.length;o<h;o++)this.expandByPoint(e[o]);return this},setFromCenterAndSize:function(e,o){return o=GM.copy(o).multiplyScalar(.5),this.min.copy(e).sub(o),this.max.copy(e).add(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.min.copy(e.min),this.max.copy(e.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(e){return e===void 0&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(e){return e===void 0&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new f),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(e){return this.min.min(e),this.max.max(e),this},expandByVector:function(e){return this.min.sub(e),this.max.add(e),this},expandByScalar:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this},containsPoint:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)},containsBox:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y},getParameter:function(e,o){return o===void 0&&(console.warn("THREE.Box2: .getParameter() target is now required"),o=new f),o.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)},clampPoint:function(e,o){return o===void 0&&(console.warn("THREE.Box2: .clampPoint() target is now required"),o=new f),o.copy(e).clamp(this.min,this.max)},distanceToPoint:function(e){return GM.copy(e).clamp(this.min,this.max).sub(e).length()},intersect:function(e){return this.min.max(e.min),this.max.min(e.max),this},union:function(e){return this.min.min(e.min),this.max.max(e.max),this},translate:function(e){return this.min.add(e),this.max.add(e),this},equals:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}});var bM=new w,wx=new w;ut(z2.prototype,{set:function(e,o){return this.start.copy(e),this.end.copy(o),this},clone:function(){return new this.constructor().copy(this)},copy:function(e){return this.start.copy(e.start),this.end.copy(e.end),this},getCenter:function(e){return e===void 0&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new w),e.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(e){return e===void 0&&(console.warn("THREE.Line3: .delta() target is now required"),e=new w),e.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(e,o){return o===void 0&&(console.warn("THREE.Line3: .at() target is now required"),o=new w),this.delta(o).multiplyScalar(e).add(this.start)},closestPointToPointParameter:function(e,o){return bM.subVectors(e,this.start),wx.subVectors(this.end,this.start),e=wx.dot(wx),e=wx.dot(bM)/e,o&&(e=di.clamp(e,0,1)),e},closestPointToPoint:function(e,o,h){return e=this.closestPointToPointParameter(e,o),h===void 0&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),h=new w),this.delta(h).multiplyScalar(e).add(this.start)},applyMatrix4:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this},equals:function(e){return e.start.equals(this.start)&&e.end.equals(this.end)}}),Ov.prototype=at(F.prototype),Ov.prototype.constructor=Ov,Ov.prototype.isImmediateRenderObject=!0;var VM=new w;ag.prototype=at(F.prototype),ag.prototype.constructor=ag,ag.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},ag.prototype.update=function(){this.light.updateMatrixWorld();var e=this.light.distance?this.light.distance:1e3,o=e*Math.tan(this.light.angle);this.cone.scale.set(o,o,e),VM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(VM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)};var Cc=new w,Mx=new I,v_=new I;tp.prototype=at(On.prototype),tp.prototype.constructor=tp,tp.prototype.isSkeletonHelper=!0,tp.prototype.updateMatrixWorld=function(e){var o=this.bones,h=this.geometry,m=h.getAttribute("position");v_.getInverse(this.root.matrixWorld);for(var _=0,T=0;_<o.length;_++){var R=o[_];R.parent&&R.parent.isBone&&(Mx.multiplyMatrices(v_,R.matrixWorld),Cc.setFromMatrixPosition(Mx),m.setXYZ(T,Cc.x,Cc.y,Cc.z),Mx.multiplyMatrices(v_,R.parent.matrixWorld),Cc.setFromMatrixPosition(Mx),m.setXYZ(T+1,Cc.x,Cc.y,Cc.z),T+=2)}h.getAttribute("position").needsUpdate=!0,F.prototype.updateMatrixWorld.call(this,e)},ug.prototype=at(St.prototype),ug.prototype.constructor=ug,ug.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},ug.prototype.update=function(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)};var wT=new w,WM=new yt,jM=new yt;lg.prototype=at(F.prototype),lg.prototype.constructor=lg,lg.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},lg.prototype.update=function(){var e=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{var o=e.geometry.getAttribute("color");WM.copy(this.light.color),jM.copy(this.light.groundColor);for(var h=0,m=o.count;h<m;h++){var _=h<m/2?WM:jM;o.setXYZ(h,_.r,_.g,_.b)}o.needsUpdate=!0}e.lookAt(wT.setFromMatrixPosition(this.light.matrixWorld).negate())},Jy.prototype=ut(at(On.prototype),{constructor:Jy,copy:function(e){return On.prototype.copy.call(this,e),this.geometry.copy(e.geometry),this.material.copy(e.material),this},clone:function(){return new this.constructor().copy(this)}}),qy.prototype=at(On.prototype),qy.prototype.constructor=qy;var XM=new w,Cx=new w,YM=new w;hg.prototype=at(F.prototype),hg.prototype.constructor=hg,hg.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},hg.prototype.update=function(){XM.setFromMatrixPosition(this.light.matrixWorld),Cx.setFromMatrixPosition(this.light.target.matrixWorld),YM.subVectors(Cx,XM),this.lightPlane.lookAt(Cx),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(Cx),this.targetLine.scale.z=YM.length()};var Tx=new w,bn=new le;Fv.prototype=at(On.prototype),Fv.prototype.constructor=Fv,Fv.prototype.update=function(){var e=this.geometry,o=this.pointMap;bn.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Jn("c",o,e,bn,0,0,-1),Jn("t",o,e,bn,0,0,1),Jn("n1",o,e,bn,-1,-1,-1),Jn("n2",o,e,bn,1,-1,-1),Jn("n3",o,e,bn,-1,1,-1),Jn("n4",o,e,bn,1,1,-1),Jn("f1",o,e,bn,-1,-1,1),Jn("f2",o,e,bn,1,-1,1),Jn("f3",o,e,bn,-1,1,1),Jn("f4",o,e,bn,1,1,1),Jn("u1",o,e,bn,.7,1.1,-1),Jn("u2",o,e,bn,-.7,1.1,-1),Jn("u3",o,e,bn,0,2,-1),Jn("cf1",o,e,bn,-1,0,1),Jn("cf2",o,e,bn,1,0,1),Jn("cf3",o,e,bn,0,-1,1),Jn("cf4",o,e,bn,0,1,1),Jn("cn1",o,e,bn,-1,0,-1),Jn("cn2",o,e,bn,1,0,-1),Jn("cn3",o,e,bn,0,-1,-1),Jn("cn4",o,e,bn,0,1,-1),e.getAttribute("position").needsUpdate=!0};var Sx=new X;lh.prototype=at(On.prototype),lh.prototype.constructor=lh,lh.prototype.update=function(e){if(e!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&Sx.setFromObject(this.object),!Sx.isEmpty()){e=Sx.min;var o=Sx.max,h=this.geometry.attributes.position,m=h.array;m[0]=o.x,m[1]=o.y,m[2]=o.z,m[3]=e.x,m[4]=o.y,m[5]=o.z,m[6]=e.x,m[7]=e.y,m[8]=o.z,m[9]=o.x,m[10]=e.y,m[11]=o.z,m[12]=o.x,m[13]=o.y,m[14]=e.z,m[15]=e.x,m[16]=o.y,m[17]=e.z,m[18]=e.x,m[19]=e.y,m[20]=e.z,m[21]=o.x,m[22]=e.y,m[23]=e.z,h.needsUpdate=!0,this.geometry.computeBoundingSphere()}},lh.prototype.setFromObject=function(e){return this.object=e,this.update(),this},lh.prototype.copy=function(e){return On.prototype.copy.call(this,e),this.object=e.object,this},lh.prototype.clone=function(){return new this.constructor().copy(this)},Bv.prototype=at(On.prototype),Bv.prototype.constructor=Bv,Bv.prototype.updateMatrixWorld=function(e){var o=this.box;o.isEmpty()||(o.getCenter(this.position),o.getSize(this.scale),this.scale.multiplyScalar(.5),F.prototype.updateMatrixWorld.call(this,e))},Nv.prototype=at(ea.prototype),Nv.prototype.constructor=Nv,Nv.prototype.updateMatrixWorld=function(e){var o=-this.plane.constant;1e-8>Math.abs(o)&&(o=1e-8),this.scale.set(.5*this.size,.5*this.size,o),this.children[0].material.side=0>o?1:0,this.lookAt(this.plane.normal),F.prototype.updateMatrixWorld.call(this,e)};var ZM=new w,Ix,y_;hh.prototype=at(F.prototype),hh.prototype.constructor=hh,hh.prototype.setDirection=function(e){.99999<e.y?this.quaternion.set(0,0,0,1):-.99999>e.y?this.quaternion.set(1,0,0,0):(ZM.set(e.z,0,-e.x).normalize(),this.quaternion.setFromAxisAngle(ZM,Math.acos(e.y)))},hh.prototype.setLength=function(e,o,h){o===void 0&&(o=.2*e),h===void 0&&(h=.2*o),this.line.scale.set(1,Math.max(1e-4,e-o),1),this.line.updateMatrix(),this.cone.scale.set(h,o,h),this.cone.position.y=e,this.cone.updateMatrix()},hh.prototype.setColor=function(e){this.line.material.color.set(e),this.cone.material.color.set(e)},hh.prototype.copy=function(e){return F.prototype.copy.call(this,e,!1),this.line.copy(e.line),this.cone.copy(e.cone),this},hh.prototype.clone=function(){return new this.constructor().copy(this)},zv.prototype=at(On.prototype),zv.prototype.constructor=zv;var cl=Math.pow(2,8),JM=[.125,.215,.35,.446,.526,.582],qM=5+JM.length,fl={3e3:0,3001:1,3002:2,3004:3,3005:4,3006:5,3007:6},x_=new og,A_=function(){for(var e=[],o=[],h=[],m=8,_=0;_<qM;_++){var T=Math.pow(2,m);o.push(T);var R=1/T;4<_?R=JM[_-8+4-1]:_==0&&(R=0),h.push(R),R=1/(T-1),T=-R/2,R=1+R/2;var z=[T,T,R,T,R,R,T,T,R,R,T,R];T=new Float32Array(108),R=new Float32Array(72);for(var k=new Float32Array(36),b=0;6>b;b++){var q=b%3*2/3-1,J=2<b?0:-1;T.set([q,J,0,q+2/3,J,0,q+2/3,J+1,0,q,J,0,q+2/3,J+1,0,q,J+1,0],18*b),R.set(z,12*b),k.set([b,b,b,b,b,b],6*b)}z=new ct,z.setAttribute("position",new ce(T,3)),z.setAttribute("uv",new ce(R,2)),z.setAttribute("faceIndex",new ce(k,1)),e.push(z),4<m&&m--}return{_lodPlanes:e,_sizeLods:o,_sigmas:h}}(),Jv=A_._lodPlanes,KM=A_._sizeLods,Ex=A_._sigmas,__=null,hp=(1+Math.sqrt(5))/2,Eg=1/hp,QM=[new w(1,1,1),new w(-1,1,1),new w(1,1,-1),new w(-1,1,-1),new w(0,hp,Eg),new w(0,hp,-Eg),new w(Eg,0,hp),new w(-Eg,0,hp),new w(hp,Eg,0),new w(-hp,Eg,0)];U2.prototype={constructor:U2,fromScene:function(e,o,h,m){o===void 0&&(o=0),h===void 0&&(h=.1),m===void 0&&(m=100),__=this._renderer.getRenderTarget();var _=this._allocateTargets();return this._sceneToCubeUV(e,h,m,_),0<o&&this._blur(_,0,0,o),this._applyPMREM(_),this._cleanup(_),_},fromEquirectangular:function(e){return e.magFilter=1003,e.minFilter=1003,e.generateMipmaps=!1,this.fromCubemap(e)},fromCubemap:function(e){__=this._renderer.getRenderTarget();var o=this._allocateTargets(e);return this._textureToCubeUV(e,o),this._applyPMREM(o),this._cleanup(o),o},compileCubemapShader:function(){this._cubemapShader===null&&(this._cubemapShader=tM(),this._compileMaterial(this._cubemapShader))},compileEquirectangularShader:function(){this._equirectShader===null&&(this._equirectShader=$w(),this._compileMaterial(this._equirectShader))},dispose:function(){this._blurMaterial.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(var e=0;e<Jv.length;e++)Jv[e].dispose()},_cleanup:function(e){this._pingPongRenderTarget.dispose(),this._renderer.setRenderTarget(__),e.scissorTest=!1,e.setSize(e.width,e.height)},_allocateTargets:function(e){var o=e===void 0||e.type!==1009?!1:e.encoding===3e3||e.encoding===3001||e.encoding===3007;o={magFilter:1003,minFilter:1003,generateMipmaps:!1,type:1009,format:1023,encoding:o?e.encoding:3002,depthBuffer:!1,stencilBuffer:!1};var h=Qw(o);return h.depthBuffer=!e,this._pingPongRenderTarget=Qw(o),h},_compileMaterial:function(e){e=new St(Jv[0],e),this._renderer.compile(e,x_)},_sceneToCubeUV:function(e,o,h,m){o=new Ce(90,1,o,h),h=[1,-1,1,1,1,1];var _=[1,1,1,-1,-1,-1],T=this._renderer,R=T.outputEncoding,z=T.toneMapping,k=T.toneMappingExposure,b=T.getClearColor(),q=T.getClearAlpha();T.toneMapping=1,T.toneMappingExposure=1,T.outputEncoding=3e3;var J=e.background;if(J&&J.isColor){J.convertSRGBToLinear();var Q=Math.min(Math.max(Math.ceil(iA(Math.max(J.r,J.g,J.b))),-128),127);J=J.multiplyScalar(Math.pow(2,-Q)),T.setClearColor(J,(Q+128)/255),e.background=null}for(J=0;6>J;J++)Q=J%3,Q==0?(o.up.set(0,h[J],0),o.lookAt(_[J],0,0)):Q==1?(o.up.set(0,0,h[J]),o.lookAt(0,_[J],0)):(o.up.set(0,h[J],0),o.lookAt(0,0,_[J])),H2(m,Q*cl,2<J?cl:0,cl,cl),T.setRenderTarget(m),T.render(e,o);T.toneMapping=z,T.toneMappingExposure=k,T.outputEncoding=R,T.setClearColor(b,q)},_textureToCubeUV:function(e,o){var h=this._renderer;e.isCubeTexture?this._cubemapShader==null&&(this._cubemapShader=tM()):this._equirectShader==null&&(this._equirectShader=$w());var m=e.isCubeTexture?this._cubemapShader:this._equirectShader,_=new St(Jv[0],m);m=m.uniforms,m.envMap.value=e,e.isCubeTexture||m.texelSize.value.set(1/e.image.width,1/e.image.height),m.inputEncoding.value=fl[e.encoding],m.outputEncoding.value=fl[o.texture.encoding],H2(o,0,0,3*cl,2*cl),h.setRenderTarget(o),h.render(_,x_)},_applyPMREM:function(e){var o=this._renderer,h=o.autoClear;o.autoClear=!1;for(var m=1;m<qM;m++)this._blur(e,m-1,m,Math.sqrt(Ex[m]*Ex[m]-Ex[m-1]*Ex[m-1]),QM[(m-1)%QM.length]);o.autoClear=h},_blur:function(e,o,h,m,_){var T=this._pingPongRenderTarget;this._halfBlur(e,T,o,h,m,"latitudinal",_),this._halfBlur(T,e,h,h,m,"longitudinal",_)},_halfBlur:function(e,o,h,m,_,T,R){var z=this._renderer,k=this._blurMaterial;T!=="latitudinal"&&T!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");var b=new St(Jv[m],k);k=k.uniforms;var q=KM[h]-1;q=isFinite(_)?Math.PI/(2*q):2*Math.PI/39;var J=_/q,Q=isFinite(_)?1+Math.floor(3*J):20;20<Q&&console.warn("sigmaRadians, "+_+", is too large and will clip, as it requested "+Q+" samples when the maximum is set to 20"),_=[];for(var K=0,rt=0;20>rt;++rt){var lt=rt/J;lt=Math.exp(-lt*lt/2),_.push(lt),rt==0?K+=lt:rt<Q&&(K+=2*lt)}for(rt=0;rt<_.length;rt++)_[rt]/=K;k.envMap.value=e.texture,k.samples.value=Q,k.weights.value=_,k.latitudinal.value=T==="latitudinal",R&&(k.poleAxis.value=R),k.dTheta.value=q,k.mipInt.value=8-h,k.inputEncoding.value=fl[e.texture.encoding],k.outputEncoding.value=fl[e.texture.encoding],e=KM[m],lt=3*Math.max(0,cl-2*e),H2(o,lt,(m===0?0:2*cl)+2*e*(4<m?m-8+4:0),3*e,2*e),z.setRenderTarget(o),z.render(b,x_)}},jr.create=function(e,o){return e.prototype=at(jr.prototype),e.prototype.constructor=e,e.prototype.getPoint=o,e},ut(uh.prototype,{createPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getPoints(e),this.createGeometry(e)},createSpacedPointsGeometry:function(e){return console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead."),e=this.getSpacedPoints(e),this.createGeometry(e)},createGeometry:function(e){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var o=new ft,h=0,m=e.length;h<m;h++){var _=e[h];o.vertices.push(new w(_.x,_.y,_.z||0))}return o}}),ut(hu.prototype,{fromPoints:function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)}}),eM.prototype=at(rs.prototype),rM.prototype=at(rs.prototype),b2.prototype=at(rs.prototype),ut(b2.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Jy.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},tp.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},ut(Ki.prototype,{extractUrlBase:function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),d_.extractUrlBase(e)}}),Ki.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},ut(Xy.prototype,{setTexturePath:function(e){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(e)}}),ut(N2.prototype,{center:function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},size:function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)}}),ut(X.prototype,{center:function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionSphere:function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},size:function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)}}),ut(tt.prototype,{empty:function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()}}),ar.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},z2.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},ut(di,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),di.floorPowerOfTwo(e)},nextPowerOfTwo:function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),di.ceilPowerOfTwo(e)}}),ut(c.prototype,{flattenToArrayOffset:function(e,o){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,o)},multiplyVector3:function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),ut(I.prototype,{extractPosition:function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},flattenToArrayOffset:function(e,o){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,o)},getPosition:function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new w().setFromMatrixColumn(this,3)},setRotationFromQuaternion:function(e){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(e)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector4:function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},crossVector:function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBufferAttribute:function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(e,o,h,m,_,T){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,o,m,h,_,T)}}),xt.prototype.isIntersectionLine=function(e){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(e)},N.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},ut(st.prototype,{isIntersectionBox:function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},isIntersectionPlane:function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},isIntersectionSphere:function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)}}),ut(At.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(e,o){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,o)},midpoint:function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},normal:function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},plane:function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)}}),ut(At,{barycoordFromPoint:function(e,o,h,m,_){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),At.getBarycoord(e,o,h,m,_)},normal:function(e,o,h,m){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),At.getNormal(e,o,h,m)}}),ut(gc.prototype,{extractAllPoints:function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},extrude:function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new bf(this,e)},makeGeometry:function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Wf(this,e)}}),ut(f.prototype,{fromAttribute:function(e,o,h){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},distanceToManhattan:function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(w.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},getScaleFromMatrix:function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},getColumnFromMatrix:function(e,o){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(o,e)},applyProjection:function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},fromAttribute:function(e,o,h){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},distanceToManhattan:function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(p.prototype,{fromAttribute:function(e,o,h){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,o,h)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),ut(ft.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")},applyMatrix:function(e){return console.warn("THREE.Geometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),ut(F.prototype,{getChildByName:function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(e,o){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(o,e)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},applyMatrix:function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Gr(F.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ut(St.prototype,{setDrawMode:function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}),Gr(St.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Gr(sv.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(xy.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),yy.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(jr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),Ce.prototype.setLens=function(e,o){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),o!==void 0&&(this.filmGauge=o),this.setFocalLength(e)},Gr(cn.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Gr(ce.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===35048},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(35048)}}}),ut(ce.prototype,{setDynamic:function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},setArray:function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(ct.prototype,{addIndex:function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},addAttribute:function(e,o,h){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),o&&o.isBufferAttribute||o&&o.isInterleavedBufferAttribute?e==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(o),this):this.setAttribute(e,o):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new ce(o,h)))},addDrawCall:function(e,o,h){h!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,o)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},removeAttribute:function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},applyMatrix:function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)}}),Gr(ct.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Gr(Dv.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Gr(F2.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Gr(oh.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===35048},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),ut(oh.prototype,{setDynamic:function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(e===!0?35048:35044),this},setArray:function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")}}),ut(il.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Gr(Zy.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Gr(re.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new yt}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=e===1}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Gr(dc.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Gr(me.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),ut(h2.prototype,{clearTarget:function(e,o,h,m){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(o,h,m)},animate:function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},allocTextureUnit:function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},setTexture:function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},setTexture2D:function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},setTextureCube:function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},getActiveMipMapLevel:function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()}}),Gr(h2.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=e===!0?3001:3e3}}}),Gr(Dw.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Gr(A.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),Gr(sg.prototype,{load:{value:function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var o=this;return new Yy().load(e,function(h){o.setBuffer(h)}),this}},startTime:{set:function(){console.warn("THREE.Audio: .startTime is now .play( delay ).")}}}),R2.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},xr.prototype.updateCubeMap=function(e,o){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,o)},mc.crossOrigin=void 0,mc.loadTexture=function(e,o,h,m){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var _=new Oy;return _.setCrossOrigin(this.crossOrigin),e=_.load(e,h,void 0,m),o&&(e.mapping=o),e},mc.loadTextureCube=function(e,o,h,m){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var _=new Dy;return _.setCrossOrigin(this.crossOrigin),e=_.load(e,h,void 0,m),o&&(e.mapping=o),e},mc.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},mc.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"117"}})),i.ACESFilmicToneMapping=5,i.AddEquation=100,i.AddOperation=2,i.AdditiveAnimationBlendMode=2501,i.AdditiveBlending=2,i.AlphaFormat=1021,i.AlwaysDepth=1,i.AlwaysStencilFunc=519,i.AmbientLight=ky,i.AmbientLightProbe=S2,i.AnimationClip=Ea,i.AnimationLoader=v2,i.AnimationMixer=D2,i.AnimationObjectGroup=Xw,i.AnimationUtils=En,i.ArcCurve=ng,i.ArrayCamera=py,i.ArrowHelper=hh,i.Audio=sg,i.AudioAnalyser=R2,i.AudioContext=m_,i.AudioListener=E2,i.AudioLoader=Yy,i.AxesHelper=zv,i.AxisHelper=function(e){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new zv(e)},i.BackSide=1,i.BasicDepthPacking=3200,i.BasicShadowMap=0,i.BinaryTextureLoader=function(e){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new Py(e)},i.Bone=c2,i.BooleanKeyframeTrack=Iy,i.BoundingBoxHelper=function(e,o){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new lh(e,o)},i.Box2=N2,i.Box3=X,i.Box3Helper=Bv,i.BoxBufferGeometry=Wv,i.BoxGeometry=o_,i.BoxHelper=lh,i.BufferAttribute=ce,i.BufferGeometry=ct,i.BufferGeometryLoader=jy,i.ByteType=1010,i.Cache=op,i.Camera=le,i.CameraHelper=Fv,i.CanvasRenderer=function(){console.error("THREE.CanvasRenderer has been removed")},i.CanvasTexture=av,i.CatmullRomCurve3=rs,i.CineonToneMapping=4,i.CircleBufferGeometry=tg,i.CircleGeometry=Iv,i.ClampToEdgeWrapping=1001,i.Clock=I2,i.ClosedSplineCurve3=eM,i.Color=yt,i.ColorKeyframeTrack=Ey,i.CompressedTexture=Gd,i.CompressedTextureLoader=y2,i.ConeBufferGeometry=Sv,i.ConeGeometry=Tv,i.CubeCamera=xr,i.CubeGeometry=o_,i.CubeReflectionMapping=301,i.CubeRefractionMapping=302,i.CubeTexture=Sa,i.CubeTextureLoader=Dy,i.CubeUVReflectionMapping=306,i.CubeUVRefractionMapping=307,i.CubicBezierCurve=su,i.CubicBezierCurve3=ol,i.CubicInterpolant=Ty,i.CullFaceBack=1,i.CullFaceFront=2,i.CullFaceFrontBack=3,i.CullFaceNone=0,i.Curve=jr,i.CurvePath=uh,i.CustomBlending=5,i.CylinderBufferGeometry=sh,i.CylinderGeometry=Xf,i.Cylindrical=qw,i.DataTexture=Ae,i.DataTexture2DArray=es,i.DataTexture3D=ys,i.DataTextureLoader=Py,i.DecrementStencilOp=7683,i.DecrementWrapStencilOp=34056,i.DefaultLoadingManager=FM,i.DepthFormat=1026,i.DepthStencilFormat=1027,i.DepthTexture=uv,i.DirectionalLight=Hy,i.DirectionalLightHelper=hg,i.DirectionalLightShadow=Uy,i.DiscreteInterpolant=Sy,i.DodecahedronBufferGeometry=Xd,i.DodecahedronGeometry=dv,i.DoubleSide=2,i.DstAlphaFactor=206,i.DstColorFactor=208,i.DynamicBufferAttribute=function(e,o){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new ce(e,o).setUsage(35048)},i.DynamicCopyUsage=35050,i.DynamicDrawUsage=35048,i.DynamicReadUsage=35049,i.EdgesGeometry=$d,i.EdgesHelper=function(e,o){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new On(new $d(e.geometry),new In({color:o!==void 0?o:16777215}))},i.EllipseCurve=ia,i.EqualDepth=4,i.EqualStencilFunc=514,i.EquirectangularReflectionMapping=303,i.EquirectangularRefractionMapping=304,i.Euler=L,i.EventDispatcher=s,i.ExtrudeBufferGeometry=il,i.ExtrudeGeometry=bf,i.Face3=Wt,i.Face4=function(e,o,h,m,_,T,R){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new Wt(e,o,h,_,T,R)},i.FaceColors=1,i.FileLoader=La,i.FlatShading=1,i.Float32Attribute=function(e,o){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new mt(e,o)},i.Float32BufferAttribute=mt,i.Float64Attribute=function(e,o){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Tt(e,o)},i.Float64BufferAttribute=Tt,i.FloatType=1015,i.Fog=my,i.FogExp2=gy,i.Font=M2,i.FontLoader=C2,i.FrontFaceDirectionCCW=1,i.FrontFaceDirectionCW=0,i.FrontSide=0,i.Frustum=ar,i.GammaEncoding=3007,i.Geometry=ft,i.GeometryUtils={merge:function(e,o,h){if(console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),o.isMesh){o.matrixAutoUpdate&&o.updateMatrix();var m=o.matrix;o=o.geometry}e.merge(o,m,h)},center:function(e){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),e.center()}},i.GreaterDepth=6,i.GreaterEqualDepth=5,i.GreaterEqualStencilFunc=518,i.GreaterStencilFunc=516,i.GridHelper=Jy,i.Group=Hd,i.HalfFloatType=1016,i.HemisphereLight=Fy,i.HemisphereLightHelper=lg,i.HemisphereLightProbe=T2,i.IcosahedronBufferGeometry=jd,i.IcosahedronGeometry=pv,i.ImageBitmapLoader=_2,i.ImageLoader=ig,i.ImageUtils=mc,i.ImmediateRenderObject=Ov,i.IncrementStencilOp=7682,i.IncrementWrapStencilOp=34055,i.InstancedBufferAttribute=Wy,i.InstancedBufferGeometry=Dv,i.InstancedInterleavedBuffer=O2,i.InstancedMesh=Ay,i.Int16Attribute=function(e,o){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new ni(e,o)},i.Int16BufferAttribute=ni,i.Int32Attribute=function(e,o){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new dt(e,o)},i.Int32BufferAttribute=dt,i.Int8Attribute=function(e,o){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new tr(e,o)},i.Int8BufferAttribute=tr,i.IntType=1013,i.InterleavedBuffer=oh,i.InterleavedBufferAttribute=nv,i.Interpolant=ra,i.InterpolateDiscrete=2300,i.InterpolateLinear=2301,i.InterpolateSmooth=2302,i.InvertStencilOp=5386,i.JSONLoader=function(){console.error("THREE.JSONLoader has been removed.")},i.KeepStencilOp=7680,i.KeyframeTrack=No,i.LOD=sv,i.LatheBufferGeometry=Qd,i.LatheGeometry=Cv,i.Layers=P,i.LensFlare=function(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")},i.LessDepth=2,i.LessEqualDepth=3,i.LessEqualStencilFunc=515,i.LessStencilFunc=513,i.Light=cn,i.LightProbe=Ra,i.LightShadow=al,i.Line=ea,i.Line3=z2,i.LineBasicMaterial=In,i.LineCurve=Hs,i.LineCurve3=au,i.LineDashedMaterial=$f,i.LineLoop=_y,i.LinePieces=1,i.LineSegments=On,i.LineStrip=0,i.LinearEncoding=3e3,i.LinearFilter=1006,i.LinearInterpolant=Ev,i.LinearMipMapLinearFilter=1008,i.LinearMipMapNearestFilter=1007,i.LinearMipmapLinearFilter=1008,i.LinearMipmapNearestFilter=1007,i.LinearToneMapping=1,i.Loader=Ki,i.LoaderUtils=d_,i.LoadingManager=m2,i.LogLuvEncoding=3003,i.LoopOnce=2200,i.LoopPingPong=2202,i.LoopRepeat=2201,i.LuminanceAlphaFormat=1025,i.LuminanceFormat=1024,i.MOUSE={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},i.Material=re,i.MaterialLoader=Vy,i.Math=di,i.MathUtils=di,i.Matrix3=c,i.Matrix4=I,i.MaxEquation=104,i.Mesh=St,i.MeshBasicMaterial=be,i.MeshDepthMaterial=hc,i.MeshDistanceMaterial=cc,i.MeshFaceMaterial=function(e){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),e},i.MeshLambertMaterial=Kf,i.MeshMatcapMaterial=Qf,i.MeshNormalMaterial=qf,i.MeshPhongMaterial=dc,i.MeshPhysicalMaterial=Zf,i.MeshStandardMaterial=nl,i.MeshToonMaterial=Jf,i.MinEquation=103,i.MirroredRepeatWrapping=1002,i.MixOperation=1,i.MultiMaterial=function(e){return e===void 0&&(e=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),e.isMultiMaterial=!0,e.materials=e,e.clone=function(){return e.slice()},e},i.MultiplyBlending=4,i.MultiplyOperation=0,i.NearestFilter=1003,i.NearestMipMapLinearFilter=1005,i.NearestMipMapNearestFilter=1004,i.NearestMipmapLinearFilter=1005,i.NearestMipmapNearestFilter=1004,i.NeverDepth=0,i.NeverStencilFunc=512,i.NoBlending=0,i.NoColors=0,i.NoToneMapping=0,i.NormalAnimationBlendMode=2500,i.NormalBlending=1,i.NotEqualDepth=7,i.NotEqualStencilFunc=517,i.NumberKeyframeTrack=eg,i.Object3D=F,i.ObjectLoader=Xy,i.ObjectSpaceNormalMap=1,i.OctahedronBufferGeometry=kf,i.OctahedronGeometry=fv,i.OneFactor=201,i.OneMinusDstAlphaFactor=207,i.OneMinusDstColorFactor=209,i.OneMinusSrcAlphaFactor=205,i.OneMinusSrcColorFactor=203,i.OrthographicCamera=og,i.PCFShadowMap=1,i.PCFSoftShadowMap=2,i.PMREMGenerator=U2,i.ParametricBufferGeometry=Vd,i.ParametricGeometry=lv,i.Particle=function(e){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new ov(e)},i.ParticleBasicMaterial=function(e){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new ou(e)},i.ParticleSystem=function(e,o){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new kd(e,o)},i.ParticleSystemMaterial=function(e){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new ou(e)},i.Path=hu,i.PerspectiveCamera=Ce,i.Plane=xt,i.PlaneBufferGeometry=Ai,i.PlaneGeometry=Sn,i.PlaneHelper=Nv,i.PointCloud=function(e,o){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new kd(e,o)},i.PointCloudMaterial=function(e){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new ou(e)},i.PointLight=zy,i.PointLightHelper=ug,i.Points=kd,i.PointsMaterial=ou,i.PolarGridHelper=qy,i.PolyhedronBufferGeometry=Us,i.PolyhedronGeometry=hv,i.PositionalAudio=L2,i.PropertyBinding=is,i.PropertyMixer=P2,i.QuadraticBezierCurve=uu,i.QuadraticBezierCurve3=sl,i.Quaternion=N,i.QuaternionKeyframeTrack=Lv,i.QuaternionLinearInterpolant=Ly,i.REVISION="117",i.RGBADepthPacking=3201,i.RGBAFormat=1023,i.RGBAIntegerFormat=1033,i.RGBA_ASTC_10x10_Format=37819,i.RGBA_ASTC_10x5_Format=37816,i.RGBA_ASTC_10x6_Format=37817,i.RGBA_ASTC_10x8_Format=37818,i.RGBA_ASTC_12x10_Format=37820,i.RGBA_ASTC_12x12_Format=37821,i.RGBA_ASTC_4x4_Format=37808,i.RGBA_ASTC_5x4_Format=37809,i.RGBA_ASTC_5x5_Format=37810,i.RGBA_ASTC_6x5_Format=37811,i.RGBA_ASTC_6x6_Format=37812,i.RGBA_ASTC_8x5_Format=37813,i.RGBA_ASTC_8x6_Format=37814,i.RGBA_ASTC_8x8_Format=37815,i.RGBA_BPTC_Format=36492,i.RGBA_ETC2_EAC_Format=37496,i.RGBA_PVRTC_2BPPV1_Format=35843,i.RGBA_PVRTC_4BPPV1_Format=35842,i.RGBA_S3TC_DXT1_Format=33777,i.RGBA_S3TC_DXT3_Format=33778,i.RGBA_S3TC_DXT5_Format=33779,i.RGBDEncoding=3006,i.RGBEEncoding=3002,i.RGBEFormat=1023,i.RGBFormat=1022,i.RGBIntegerFormat=1032,i.RGBM16Encoding=3005,i.RGBM7Encoding=3004,i.RGB_ETC1_Format=36196,i.RGB_ETC2_Format=37492,i.RGB_PVRTC_2BPPV1_Format=35841,i.RGB_PVRTC_4BPPV1_Format=35840,i.RGB_S3TC_DXT1_Format=33776,i.RGFormat=1030,i.RGIntegerFormat=1031,i.RawShaderMaterial=ah,i.Ray=st,i.Raycaster=F2,i.RectAreaLight=Gy,i.RedFormat=1028,i.RedIntegerFormat=1029,i.ReinhardToneMapping=2,i.RepeatWrapping=1e3,i.ReplaceStencilOp=7681,i.ReverseSubtractEquation=102,i.RingBufferGeometry=Kd,i.RingGeometry=Mv,i.SRGB8_ALPHA8_ASTC_10x10_Format=37851,i.SRGB8_ALPHA8_ASTC_10x5_Format=37848,i.SRGB8_ALPHA8_ASTC_10x6_Format=37849,i.SRGB8_ALPHA8_ASTC_10x8_Format=37850,i.SRGB8_ALPHA8_ASTC_12x10_Format=37852,i.SRGB8_ALPHA8_ASTC_12x12_Format=37853,i.SRGB8_ALPHA8_ASTC_4x4_Format=37840,i.SRGB8_ALPHA8_ASTC_5x4_Format=37841,i.SRGB8_ALPHA8_ASTC_5x5_Format=37842,i.SRGB8_ALPHA8_ASTC_6x5_Format=37843,i.SRGB8_ALPHA8_ASTC_6x6_Format=37844,i.SRGB8_ALPHA8_ASTC_8x5_Format=37845,i.SRGB8_ALPHA8_ASTC_8x6_Format=37846,i.SRGB8_ALPHA8_ASTC_8x8_Format=37847,i.Scene=W,i.SceneUtils={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}},i.ShaderChunk=Si,i.ShaderLib=hl,i.ShaderMaterial=me,i.ShadowMaterial=Yf,i.Shape=gc,i.ShapeBufferGeometry=jf,i.ShapeGeometry=Wf,i.ShapePath=w2,i.ShapeUtils=mh,i.ShortType=1011,i.Skeleton=xy,i.SkeletonHelper=tp,i.SkinnedMesh=yy,i.SmoothShading=2,i.Sphere=tt,i.SphereBufferGeometry=Vf,i.SphereGeometry=wv,i.Spherical=Jw,i.SphericalHarmonics3=by,i.SphericalReflectionMapping=305,i.Spline=b2,i.SplineCurve=lu,i.SplineCurve3=rM,i.SpotLight=Ny,i.SpotLightHelper=ag,i.SpotLightShadow=By,i.Sprite=ov,i.SpriteMaterial=fc,i.SrcAlphaFactor=204,i.SrcAlphaSaturateFactor=210,i.SrcColorFactor=202,i.StaticCopyUsage=35046,i.StaticDrawUsage=35044,i.StaticReadUsage=35045,i.StereoCamera=Ww,i.StreamCopyUsage=35042,i.StreamDrawUsage=35040,i.StreamReadUsage=35041,i.StringKeyframeTrack=Ry,i.SubtractEquation=101,i.SubtractiveBlending=3,i.TOUCH={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},i.TangentSpaceNormalMap=0,i.TetrahedronBufferGeometry=Wd,i.TetrahedronGeometry=cv,i.TextBufferGeometry=qd,i.TextGeometry=_v,i.Texture=g,i.TextureLoader=Oy,i.TorusBufferGeometry=Zd,i.TorusGeometry=vv,i.TorusKnotBufferGeometry=Yd,i.TorusKnotGeometry=mv,i.Triangle=At,i.TriangleFanDrawMode=2,i.TriangleStripDrawMode=1,i.TrianglesDrawMode=0,i.TubeBufferGeometry=Gf,i.TubeGeometry=gv,i.UVMapping=300,i.Uint16Attribute=function(e,o){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new pr(e,o)},i.Uint16BufferAttribute=pr,i.Uint32Attribute=function(e,o){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new gt(e,o)},i.Uint32BufferAttribute=gt,i.Uint8Attribute=function(e,o){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new yr(e,o)},i.Uint8BufferAttribute=yr,i.Uint8ClampedAttribute=function(e,o){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new sr(e,o)},i.Uint8ClampedBufferAttribute=sr,i.Uncharted2ToneMapping=3,i.Uniform=Zy,i.UniformsLib=dr,i.UniformsUtils=pM,i.UnsignedByteType=1009,i.UnsignedInt248Type=1020,i.UnsignedIntType=1014,i.UnsignedShort4444Type=1017,i.UnsignedShort5551Type=1018,i.UnsignedShort565Type=1019,i.UnsignedShortType=1012,i.VSMShadowMap=3,i.Vector2=f,i.Vector3=w,i.Vector4=p,i.VectorKeyframeTrack=rg,i.Vertex=function(e,o,h){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new w(e,o,h)},i.VertexColors=2,i.VideoTexture=p2,i.WebGLCubeRenderTarget=Br,i.WebGLMultisampleRenderTarget=S,i.WebGLRenderTarget=A,i.WebGLRenderTargetCube=function(e,o,h){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new Br(e,h)},i.WebGLRenderer=h2,i.WebGLUtils=Ow,i.WireframeGeometry=bd,i.WireframeHelper=function(e,o){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new On(new bd(e.geometry),new In({color:o!==void 0?o:16777215}))},i.WrapAroundEnding=2402,i.XHRLoader=function(e){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new La(e)},i.ZeroCurvatureEnding=2400,i.ZeroFactor=200,i.ZeroSlopeEnding=2401,i.ZeroStencilOp=0,i.sRGBEncoding=3001,Object.defineProperty(i,"__esModule",{value:!0})})}),Ui=zt(mw),vw=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.layerType="ThreeLayer",i}return Yn(r,t),tn(r,[{key:"initialize",value:function(i){this.getOptions();var s=this.webglLayer.map.map;this.webglLayer.map.type==="three"?(this.camera=s.camera,this.scene=s.scene):(this.camera=new Ui.PerspectiveCamera,this.scene=new Ui.Scene),this.world=new Ui.Group,this.scene.add(this.world),this.webglLayer.map.type!=="three"&&(this.camera.matrixAutoUpdate=!1,this.world.matrixAutoUpdate=!1,this.renderer=new Ui.WebGLRenderer({alpha:!0,antialias:!0,canvas:i.canvas,context:i}),this.renderer.autoClear=!1,this.renderer.outputEncoding=Ui.sRGBEncoding)}},{key:"_add",value:function(i,s){var f=[0,0];if(this.getOptions().enabledPointOffset===!0&&(f=this.getPointOffset()),s){var c=new Ui.Group;return c.isGeoGroup=!0,c.object=i,c.point=s,c.add(i),c.position.x=s.lng-f[0],c.position.y=s.lat-f[1],c.position.z=i.position.z,this.world.add(c),c}return this.world.add(i),i}},{key:"add",value:function(i,s){return i=this._add(i,s),this.update(),i}},{key:"update",value:function(){this.webglLayer.render()}},{key:"getCamera",value:function(){return this.camera}},{key:"getScene",value:function(){return this.scene}},{key:"getRenderer",value:function(){return this.renderer}},{key:"getWorld",value:function(){return this.world}},{key:"updatePoint",value:function(i,s){for(var f=this.world.children,c=0;c<f.length;c++)if(f[c].isGeoGroup&&f[c].object===i){var g=f[c];g.position.x=s.lng,g.position.y=s.lat,g.position.z=i.position.z}}},{key:"remove",value:function(i){this.world.remove(i);for(var s=this.world.children,f=0;f<s.length;f++)s[f].children&&0<s[f].children.length&&s[f].children[0]===i&&this.world.remove(s[f]);this.update()}},{key:"updateCamera",value:function(){if(!this.getOptions().notUpdateSize){var i=this.world,s=this.map.getZoomUnits();i=i.children;for(var f=0;f<i.length;f++)i[f].point&&i[f].scale.set(s,s,s)}}},{key:"render",value:function(i){var s=this.getOptions();if(i){if(!this.webglLayer.map.map.camera){this.updateCamera();var f=this.getPointOffset(),c=new Ui.Matrix4().fromArray(i.viewMatrix);this.camera.projectionMatrix=new Ui.Matrix4().fromArray(i.projectionMatrix),this.camera.projectionMatrixInverse.getInverse(this.camera.projectionMatrix),s.enabledPointOffset===!0?this.world.matrix=c:(i=new Ui.Matrix4().makeTranslation(-f[0],-f[1],0),this.world.matrix=c.multiply(i)),this.renderer.state.reset(),this.postProcessing?this.postProcessing.render():this.renderer.render(this.scene,this.camera)}}else this.update()}}]),r}(KC),n2=function(t){function r(i){Ri(this,r);var s=_n(this,(r.__proto__||Xn(r)).call(this,i));return s.layerType="threeLayer",s.setOptions(i),s}return Yn(r,t),tn(r,[{key:"getCommonDefaultOptions",value:function(){return{zIndex:0,zoomThreshold:[0,30]}}},{key:"setWebglLayer",value:function(i){i.threeLayer||(i.threeLayer=new vw({enabledPointOffset:!0,webglLayer:i})),this.threeLayer=i.threeLayer}},{key:"getPointOffset",value:function(){return this.threeLayer.getPointOffset()}},{key:"getThreeLayer",value:function(){return this.threeLayer}}]),r}(gw),zd={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform float opacity;
uniform sampler2D tDiffuse;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	gl_FragColor = opacity * texel;
}`};ut(An.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),An.FullScreenQuad=function(){var t=new js(-1,1,1,-1,0,1),r=new Oa(2,2),i=function(s){this._mesh=new Wi(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),ut(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var ay=function(t,r){An.call(this),this.textureID=r!==void 0?r:"tDiffuse",t instanceof ki?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=Rf.clone(t.uniforms),this.material=new ki({defines:ut({},t.defines),uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.fsQuad=new An.FullScreenQuad(this.material)};ay.prototype=ut(at(An.prototype),{constructor:ay,render:function(t,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil)),this.fsQuad.render(t)}});var uy=function(t,r){An.call(this),this.scene=t,this.camera=r,this.clear=!0,this.inverse=this.needsSwap=!1};uy.prototype=ut(at(An.prototype),{constructor:uy,render:function(t,r,i){var s=t.getContext(),f=t.state;if(f.buffers.color.setMask(!1),f.buffers.depth.setMask(!1),f.buffers.color.setLocked(!0),f.buffers.depth.setLocked(!0),this.inverse)var c=0,g=1;else c=1,g=0;f.buffers.stencil.setTest(!0),f.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),f.buffers.stencil.setFunc(s.ALWAYS,c,4294967295),f.buffers.stencil.setClear(g),f.buffers.stencil.setLocked(!0),t.setRenderTarget(i),this.clear&&t.clear(),t.render(this.scene,this.camera),t.setRenderTarget(r),this.clear&&t.clear(),t.render(this.scene,this.camera),f.buffers.color.setLocked(!1),f.buffers.depth.setLocked(!1),f.buffers.stencil.setLocked(!1),f.buffers.stencil.setFunc(s.EQUAL,1,4294967295),f.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),f.buffers.stencil.setLocked(!0)}});var o2=function(){An.call(this),this.needsSwap=!1};o2.prototype=at(An.prototype),ut(o2.prototype,{render:function(t){t.state.buffers.stencil.setLocked(!1),t.state.buffers.stencil.setTest(!1)}});var yw=function(t,r){this.renderer=t,r===void 0?(r=t.getSize(new vt),this._pixelRatio=t.getPixelRatio(),this._width=r.width,this._height=r.height,r=new Ft(this._width*this._pixelRatio,this._height*this._pixelRatio,{minFilter:1006,magFilter:1006,format:1023,stencilBuffer:!1}),r.texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=r.width,this._height=r.height),this.renderTarget1=r,this.renderTarget2=r.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],zd===void 0&&console.error("THREE.EffectComposer relies on CopyShader"),ay===void 0&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new ay(zd),this.clock=new Ha};ut(yw.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},insertPass:function(t,r){this.passes.splice(r,0,t),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)},isLastEnabledPass:function(t){for(t+=1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(t){t===void 0&&(t=this.clock.getDelta());var r=this.renderer.getRenderTarget(),i=!1,s,f=this.passes.length;for(s=0;s<f;s++){var c=this.passes[s];if(c.enabled!==!1){if(c.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(s),c.render(this.renderer,this.writeBuffer,this.readBuffer,t,i),c.needsSwap){if(i){var g=this.renderer.getContext(),p=this.renderer.state.buffers.stencil;p.setFunc(g.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,t),p.setFunc(g.EQUAL,1,4294967295)}this.swapBuffers()}uy!==void 0&&(c instanceof uy?i=!0:c instanceof o2&&(i=!1))}}this.renderer.setRenderTarget(r)},reset:function(t){t===void 0&&(t=this.renderer.getSize(new vt),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,t=this.renderTarget1.clone(),t.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,r){this._width=t,this._height=r,t=this._width*this._pixelRatio,r=this._height*this._pixelRatio,this.renderTarget1.setSize(t,r),this.renderTarget2.setSize(t,r);for(var i=0;i<this.passes.length;i++)this.passes[i].setSize(t,r)},setPixelRatio:function(t){this._pixelRatio=t,this.setSize(this._width,this._height)}});var xw=function(){this.needsSwap=this.enabled=!0,this.renderToScreen=this.clear=!1};ut(xw.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),xw.FullScreenQuad=function(){var t=new js(-1,1,1,-1,0,1),r=new Oa(2,2),i=function(s){this._mesh=new Wi(r,s)};return Object.defineProperty(i.prototype,"material",{get:function(){return this._mesh.material},set:function(s){this._mesh.material=s}}),ut(i.prototype,{dispose:function(){this._mesh.geometry.dispose()},render:function(s){s.render(this._mesh,t)}}),i}();var tv=function(t,r,i,s,f){An.call(this),this.scene=t,this.camera=r,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=f!==void 0?f:0,this.clear=!0,this.needsSwap=this.clearDepth=!1};tv.prototype=ut(at(An.prototype),{constructor:tv,render:function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.overrideMaterial!==void 0){var s=this.scene.overrideMaterial;this.scene.overrideMaterial=this.overrideMaterial}if(this.clearColor){var f=t.getClearColor().getHex(),c=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.clearColor&&t.setClearColor(f,c),this.overrideMaterial!==void 0&&(this.scene.overrideMaterial=s),t.autoClear=r}});var ev={defines:{SMAA_THRESHOLD:"0.1"},uniforms:{tDiffuse:{value:null},resolution:{value:new vt(1/1024,1/512)}},vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
void SMAAEdgeDetectionVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0,  1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4(  1.0, 0.0, 0.0, -1.0 );
	vOffset[ 2 ] = texcoord.xyxy + resolution.xyxy * vec4( -2.0, 0.0, 0.0,  2.0 );
}
void main() {
	vUv = uv;
	SMAAEdgeDetectionVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
vec4 SMAAColorEdgeDetectionPS( vec2 texcoord, vec4 offset[3], sampler2D colorTex ) {
	vec2 threshold = vec2( SMAA_THRESHOLD, SMAA_THRESHOLD );
	vec4 delta;
	vec3 C = texture2D( colorTex, texcoord ).rgb;
	vec3 Cleft = texture2D( colorTex, offset[0].xy ).rgb;
	vec3 t = abs( C - Cleft );
	delta.x = max( max( t.r, t.g ), t.b );
	vec3 Ctop = texture2D( colorTex, offset[0].zw ).rgb;
	t = abs( C - Ctop );
	delta.y = max( max( t.r, t.g ), t.b );
	vec2 edges = step( threshold, delta.xy );
	if ( dot( edges, vec2( 1.0, 1.0 ) ) == 0.0 )
		discard;
	vec3 Cright = texture2D( colorTex, offset[1].xy ).rgb;
	t = abs( C - Cright );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Cbottom  = texture2D( colorTex, offset[1].zw ).rgb;
	t = abs( C - Cbottom );
	delta.w = max( max( t.r, t.g ), t.b );
	float maxDelta = max( max( max( delta.x, delta.y ), delta.z ), delta.w );
	vec3 Cleftleft  = texture2D( colorTex, offset[2].xy ).rgb;
	t = abs( C - Cleftleft );
	delta.z = max( max( t.r, t.g ), t.b );
	vec3 Ctoptop = texture2D( colorTex, offset[2].zw ).rgb;
	t = abs( C - Ctoptop );
	delta.w = max( max( t.r, t.g ), t.b );
	maxDelta = max( max( maxDelta, delta.z ), delta.w );
	edges.xy *= step( 0.5 * maxDelta, delta.xy );
	return vec4( edges, 0.0, 0.0 );
}
void main() {
	gl_FragColor = SMAAColorEdgeDetectionPS( vUv, vOffset, tDiffuse );
}`},QC={SMAA_MAX_SEARCH_STEPS:"8",SMAA_AREATEX_MAX_DISTANCE:"16",SMAA_AREATEX_PIXEL_SIZE:"( 1.0 / vec2( 160.0, 560.0 ) )",SMAA_AREATEX_SUBTEX_SIZE:"( 1.0 / 7.0 )"},$C={tDiffuse:{value:null},tArea:{value:null},tSearch:{value:null},resolution:{value:new vt(1/1024,1/512)}},t3={tDiffuse:{value:null},tColor:{value:null},resolution:{value:new vt(1/1024,1/512)}},s2=function(t,r){An.call(this),this.edgesRT=new Ft(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1022}),this.edgesRT.texture.name="SMAAPass.edges",this.weightsRT=new Ft(t,r,{depthBuffer:!1,stencilBuffer:!1,generateMipmaps:!1,minFilter:1006,format:1023}),this.weightsRT.texture.name="SMAAPass.weights";var i=this,s=new Image;s.src=this.getAreaTexture(),s.onload=function(){i.areaTexture.needsUpdate=!0},this.areaTexture=new Lt,this.areaTexture.name="SMAAPass.area",this.areaTexture.image=s,this.areaTexture.format=1022,this.areaTexture.minFilter=1006,this.areaTexture.generateMipmaps=!1,this.areaTexture.flipY=!1,s=new Image,s.src=this.getSearchTexture(),s.onload=function(){i.searchTexture.needsUpdate=!0},this.searchTexture=new Lt,this.searchTexture.name="SMAAPass.search",this.searchTexture.image=s,this.searchTexture.magFilter=1003,this.searchTexture.minFilter=1003,this.searchTexture.generateMipmaps=!1,this.searchTexture.flipY=!1,ev===void 0&&console.error("SMAAPass relies on SMAAShader"),this.uniformsEdges=Rf.clone(ev.uniforms),this.uniformsEdges.resolution.value.set(1/t,1/r),this.materialEdges=new ki({defines:ut({},ev.defines),uniforms:this.uniformsEdges,vertexShader:ev.vertexShader,fragmentShader:ev.fragmentShader}),this.uniformsWeights=Rf.clone($C),this.uniformsWeights.resolution.value.set(1/t,1/r),this.uniformsWeights.tDiffuse.value=this.edgesRT.texture,this.uniformsWeights.tArea.value=this.areaTexture,this.uniformsWeights.tSearch.value=this.searchTexture,this.materialWeights=new ki({defines:ut({},QC),uniforms:this.uniformsWeights,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 3 ];
varying vec2 vPixcoord;
void SMAABlendingWeightCalculationVS( vec2 texcoord ) {
	vPixcoord = texcoord / resolution;
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.25, 0.125, 1.25, 0.125 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( -0.125, 0.25, -0.125, -1.25 );
	vOffset[ 2 ] = vec4( vOffset[ 0 ].xz, vOffset[ 1 ].yw ) + vec4( -2.0, 2.0, -2.0, 2.0 ) * resolution.xxyy * float( SMAA_MAX_SEARCH_STEPS );
}
void main() {
	vUv = uv;
	SMAABlendingWeightCalculationVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`#define SMAASampleLevelZeroOffset( tex, coord, offset ) texture2D( tex, coord + float( offset ) * resolution, 0.0 )
uniform sampler2D tDiffuse;
uniform sampler2D tArea;
uniform sampler2D tSearch;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[3];
varying vec2 vPixcoord;
#if __VERSION__ == 100
vec2 round( vec2 x ) {
	return sign( x ) * floor( abs( x ) + 0.5 );
}
#endif
float SMAASearchLength( sampler2D searchTex, vec2 e, float bias, float scale ) {
	e.r = bias + e.r * scale;
	return 255.0 * texture2D( searchTex, e, 0.0 ).r;
}
float SMAASearchXLeft( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x > end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x += 0.25 * resolution.x;
	texcoord.x += resolution.x;
	texcoord.x += 2.0 * resolution.x;
	texcoord.x -= resolution.x * SMAASearchLength(searchTex, e, 0.0, 0.5);
	return texcoord.x;
}
float SMAASearchXRight( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 0.0, 1.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 2.0, 0.0 ) * resolution;
		if ( ! ( texcoord.x < end && e.g > 0.8281 && e.r == 0.0 ) ) break;
	}
	texcoord.x -= 0.25 * resolution.x;
	texcoord.x -= resolution.x;
	texcoord.x -= 2.0 * resolution.x;
	texcoord.x += resolution.x * SMAASearchLength( searchTex, e, 0.5, 0.5 );
	return texcoord.x;
}
float SMAASearchYUp( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord += vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y > end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y -= 0.25 * resolution.y;
	texcoord.y -= resolution.y;
	texcoord.y -= 2.0 * resolution.y;
	texcoord.y += resolution.y * SMAASearchLength( searchTex, e.gr, 0.0, 0.5 );
	return texcoord.y;
}
float SMAASearchYDown( sampler2D edgesTex, sampler2D searchTex, vec2 texcoord, float end ) {
	vec2 e = vec2( 1.0, 0.0 );
	for ( int i = 0; i < SMAA_MAX_SEARCH_STEPS; i ++ ) {
		e = texture2D( edgesTex, texcoord, 0.0 ).rg;
		texcoord -= vec2( 0.0, 2.0 ) * resolution;
		if ( ! ( texcoord.y < end && e.r > 0.8281 && e.g == 0.0 ) ) break;
	}
	texcoord.y += 0.25 * resolution.y;
	texcoord.y += resolution.y;
	texcoord.y += 2.0 * resolution.y;
	texcoord.y -= resolution.y * SMAASearchLength( searchTex, e.gr, 0.5, 0.5 );
	return texcoord.y;
}
vec2 SMAAArea( sampler2D areaTex, vec2 dist, float e1, float e2, float offset ) {
	vec2 texcoord = float( SMAA_AREATEX_MAX_DISTANCE ) * round( 4.0 * vec2( e1, e2 ) ) + dist;
	texcoord = SMAA_AREATEX_PIXEL_SIZE * texcoord + ( 0.5 * SMAA_AREATEX_PIXEL_SIZE );
	texcoord.y += SMAA_AREATEX_SUBTEX_SIZE * offset;
	return texture2D( areaTex, texcoord, 0.0 ).rg;
}
vec4 SMAABlendingWeightCalculationPS( vec2 texcoord, vec2 pixcoord, vec4 offset[ 3 ], sampler2D edgesTex, sampler2D areaTex, sampler2D searchTex, ivec4 subsampleIndices ) {
	vec4 weights = vec4( 0.0, 0.0, 0.0, 0.0 );
	vec2 e = texture2D( edgesTex, texcoord ).rg;
	if ( e.g > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.x = SMAASearchXLeft( edgesTex, searchTex, offset[ 0 ].xy, offset[ 2 ].x );
		coords.y = offset[ 1 ].y;
		d.x = coords.x;
		float e1 = texture2D( edgesTex, coords, 0.0 ).r;
		coords.x = SMAASearchXRight( edgesTex, searchTex, offset[ 0 ].zw, offset[ 2 ].y );
		d.y = coords.x;
		d = d / resolution.x - pixcoord.x;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 1, 0 ) ).r;
		weights.rg = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.y ) );
	}
	if ( e.r > 0.0 ) {
		vec2 d;
		vec2 coords;
		coords.y = SMAASearchYUp( edgesTex, searchTex, offset[ 1 ].xy, offset[ 2 ].z );
		coords.x = offset[ 0 ].x;
		d.x = coords.y;
		float e1 = texture2D( edgesTex, coords, 0.0 ).g;
		coords.y = SMAASearchYDown( edgesTex, searchTex, offset[ 1 ].zw, offset[ 2 ].w );
		d.y = coords.y;
		d = d / resolution.y - pixcoord.y;
		vec2 sqrt_d = sqrt( abs( d ) );
		coords.y -= 1.0 * resolution.y;
		float e2 = SMAASampleLevelZeroOffset( edgesTex, coords, ivec2( 0, 1 ) ).g;
		weights.ba = SMAAArea( areaTex, sqrt_d, e1, e2, float( subsampleIndices.x ) );
	}
	return weights;
}
void main() {
	gl_FragColor = SMAABlendingWeightCalculationPS( vUv, vPixcoord, vOffset, tDiffuse, tArea, tSearch, ivec4( 0.0 ) );
}`}),this.uniformsBlend=Rf.clone(t3),this.uniformsBlend.resolution.value.set(1/t,1/r),this.uniformsBlend.tDiffuse.value=this.weightsRT.texture,this.materialBlend=new ki({uniforms:this.uniformsBlend,vertexShader:`uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
void SMAANeighborhoodBlendingVS( vec2 texcoord ) {
	vOffset[ 0 ] = texcoord.xyxy + resolution.xyxy * vec4( -1.0, 0.0, 0.0, 1.0 );
	vOffset[ 1 ] = texcoord.xyxy + resolution.xyxy * vec4( 1.0, 0.0, 0.0, -1.0 );
}
void main() {
	vUv = uv;
	SMAANeighborhoodBlendingVS( vUv );
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform sampler2D tColor;
uniform vec2 resolution;
varying vec2 vUv;
varying vec4 vOffset[ 2 ];
vec4 SMAANeighborhoodBlendingPS( vec2 texcoord, vec4 offset[ 2 ], sampler2D colorTex, sampler2D blendTex ) {
	vec4 a;
	a.xz = texture2D( blendTex, texcoord ).xz;
	a.y = texture2D( blendTex, offset[ 1 ].zw ).g;
	a.w = texture2D( blendTex, offset[ 1 ].xy ).a;
	if ( dot(a, vec4( 1.0, 1.0, 1.0, 1.0 )) < 1e-5 ) {
		return texture2D( colorTex, texcoord, 0.0 );
	} else {
		vec2 offset;
		offset.x = a.a > a.b ? a.a : -a.b;
		offset.y = a.g > a.r ? -a.g : a.r;
		if ( abs( offset.x ) > abs( offset.y )) {
			offset.y = 0.0;
		} else {
			offset.x = 0.0;
		}
		vec4 C = texture2D( colorTex, texcoord, 0.0 );
		texcoord += sign( offset ) * resolution;
		vec4 Cop = texture2D( colorTex, texcoord, 0.0 );
		float s = abs( offset.x ) > abs( offset.y ) ? abs( offset.x ) : abs( offset.y );
		C.xyz = pow(C.xyz, vec3(2.2));
		Cop.xyz = pow(Cop.xyz, vec3(2.2));
		vec4 mixed = mix(C, Cop, s);
		mixed.xyz = pow(mixed.xyz, vec3(1.0 / 2.2));
		return mixed;
	}
}
void main() {
	gl_FragColor = SMAANeighborhoodBlendingPS( vUv, vOffset, tColor, tDiffuse );
}`}),this.needsSwap=!1,this.fsQuad=new An.FullScreenQuad(null)};s2.prototype=ut(at(An.prototype),{constructor:s2,render:function(t,r,i){this.uniformsEdges.tDiffuse.value=i.texture,this.fsQuad.material=this.materialEdges,t.setRenderTarget(this.edgesRT),this.clear&&t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialWeights,t.setRenderTarget(this.weightsRT),this.clear&&t.clear(),this.fsQuad.render(t),this.uniformsBlend.tColor.value=i.texture,this.fsQuad.material=this.materialBlend,this.renderToScreen?t.setRenderTarget(null):(t.setRenderTarget(r),this.clear&&t.clear()),this.fsQuad.render(t)},setSize:function(t,r){this.edgesRT.setSize(t,r),this.weightsRT.setSize(t,r),this.materialEdges.uniforms.resolution.value.set(1/t,1/r),this.materialWeights.uniforms.resolution.value.set(1/t,1/r),this.materialBlend.uniforms.resolution.value.set(1/t,1/r)},getAreaTexture:function(){return"data:image/png;base64,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"},getSearchTexture:function(){return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEIAAAAhCAAAAABIXyLAAAAAOElEQVRIx2NgGAWjYBSMglEwEICREYRgFBZBqDCSLA2MGPUIVQETE9iNUAqLR5gIeoQKRgwXjwAAGn4AtaFeYLEAAAAASUVORK5CYII="}});var ly={shaderID:"luminosityHighPass",uniforms:{tDiffuse:{value:null},luminosityThreshold:{value:1},smoothWidth:{value:1},defaultColor:{value:new Vt(0)},defaultOpacity:{value:0}},vertexShader:`varying vec2 vUv;
void main() {
	vUv = uv;
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,fragmentShader:`uniform sampler2D tDiffuse;
uniform vec3 defaultColor;
uniform float defaultOpacity;
uniform float luminosityThreshold;
uniform float smoothWidth;
varying vec2 vUv;
void main() {
	vec4 texel = texture2D( tDiffuse, vUv );
	vec3 luma = vec3( 0.299, 0.587, 0.114 );
	float v = dot( texel.xyz, luma );
	vec4 outputColor = vec4( defaultColor.rgb, defaultOpacity );
	float alpha = smoothstep( luminosityThreshold, luminosityThreshold + smoothWidth, v );
	gl_FragColor = mix( outputColor, texel, alpha );
}`},ac=function(t,r,i,s){An.call(this),this.strength=r!==void 0?r:1,this.radius=i,this.threshold=s,this.resolution=t!==void 0?new vt(t.x,t.y):new vt(256,256),this.clearColor=new Vt(0,0,0);var f={minFilter:1006,magFilter:1006,format:1023};this.renderTargetsHorizontal=[],this.renderTargetsVertical=[],this.nMips=5,t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),this.renderTargetBright=new Ft(t,i,f),this.renderTargetBright.texture.name="UnrealBloomPass.bright",this.renderTargetBright.texture.generateMipmaps=!1;for(var c=0;c<this.nMips;c++){var g=new Ft(t,i,f);g.texture.name="UnrealBloomPass.h"+c,g.texture.generateMipmaps=!1,this.renderTargetsHorizontal.push(g),g=new Ft(t,i,f),g.texture.name="UnrealBloomPass.v"+c,g.texture.generateMipmaps=!1,this.renderTargetsVertical.push(g),t=Math.round(t/2),i=Math.round(i/2)}for(ly===void 0&&console.error("UnrealBloomPass relies on LuminosityHighPassShader"),this.highPassUniforms=Rf.clone(ly.uniforms),this.highPassUniforms.luminosityThreshold.value=s,this.highPassUniforms.smoothWidth.value=.01,this.materialHighPassFilter=new ki({uniforms:this.highPassUniforms,vertexShader:ly.vertexShader,fragmentShader:ly.fragmentShader,defines:{}}),this.separableBlurMaterials=[],s=[3,5,7,9,11],t=Math.round(this.resolution.x/2),i=Math.round(this.resolution.y/2),c=0;c<this.nMips;c++)this.separableBlurMaterials.push(this.getSeperableBlurMaterial(s[c])),this.separableBlurMaterials[c].uniforms.texSize.value=new vt(t,i),t=Math.round(t/2),i=Math.round(i/2);this.compositeMaterial=this.getCompositeMaterial(this.nMips),this.compositeMaterial.uniforms.blurTexture1.value=this.renderTargetsVertical[0].texture,this.compositeMaterial.uniforms.blurTexture2.value=this.renderTargetsVertical[1].texture,this.compositeMaterial.uniforms.blurTexture3.value=this.renderTargetsVertical[2].texture,this.compositeMaterial.uniforms.blurTexture4.value=this.renderTargetsVertical[3].texture,this.compositeMaterial.uniforms.blurTexture5.value=this.renderTargetsVertical[4].texture,this.compositeMaterial.uniforms.bloomStrength.value=r,this.compositeMaterial.uniforms.bloomRadius.value=.1,this.compositeMaterial.needsUpdate=!0,this.compositeMaterial.uniforms.bloomFactors.value=[1,.8,.6,.4,.2],this.bloomTintColors=[new ot(1,1,1),new ot(1,1,1),new ot(1,1,1),new ot(1,1,1),new ot(1,1,1)],this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,zd===void 0&&console.error("UnrealBloomPass relies on CopyShader"),this.copyUniforms=Rf.clone(zd.uniforms),this.copyUniforms.opacity.value=1,this.materialCopy=new ki({uniforms:this.copyUniforms,vertexShader:zd.vertexShader,fragmentShader:zd.fragmentShader,blending:2,depthTest:!1,depthWrite:!1,transparent:!0}),this.enabled=!0,this.needsSwap=!1,this.oldClearColor=new Vt,this.oldClearAlpha=1,this.basic=new Rr,this.fsQuad=new An.FullScreenQuad(null)};ac.prototype=ut(at(An.prototype),{constructor:ac,dispose:function(){for(var t=0;t<this.renderTargetsHorizontal.length;t++)this.renderTargetsHorizontal[t].dispose();for(t=0;t<this.renderTargetsVertical.length;t++)this.renderTargetsVertical[t].dispose();this.renderTargetBright.dispose()},setSize:function(t,r){t=Math.round(t/2),r=Math.round(r/2),this.renderTargetBright.setSize(t,r);for(var i=0;i<this.nMips;i++)this.renderTargetsHorizontal[i].setSize(t,r),this.renderTargetsVertical[i].setSize(t,r),this.separableBlurMaterials[i].uniforms.texSize.value=new vt(t,r),t=Math.round(t/2),r=Math.round(r/2)},render:function(t,r,i,s,f){this.oldClearColor.copy(t.getClearColor()),this.oldClearAlpha=t.getClearAlpha(),r=t.autoClear,t.autoClear=!1,t.setClearColor(this.clearColor,0),f&&t.state.buffers.stencil.setTest(!1),this.renderToScreen&&(this.fsQuad.material=this.basic,this.basic.map=i.texture,t.setRenderTarget(null),t.clear(),this.fsQuad.render(t)),this.highPassUniforms.tDiffuse.value=i.texture,this.highPassUniforms.luminosityThreshold.value=this.threshold,this.fsQuad.material=this.materialHighPassFilter,t.setRenderTarget(this.renderTargetBright),t.clear(),this.fsQuad.render(t),s=this.renderTargetBright;for(var c=0;c<this.nMips;c++)this.fsQuad.material=this.separableBlurMaterials[c],this.separableBlurMaterials[c].uniforms.colorTexture.value=s.texture,this.separableBlurMaterials[c].uniforms.direction.value=ac.BlurDirectionX,t.setRenderTarget(this.renderTargetsHorizontal[c]),t.clear(),this.fsQuad.render(t),this.separableBlurMaterials[c].uniforms.colorTexture.value=this.renderTargetsHorizontal[c].texture,this.separableBlurMaterials[c].uniforms.direction.value=ac.BlurDirectionY,t.setRenderTarget(this.renderTargetsVertical[c]),t.clear(),this.fsQuad.render(t),s=this.renderTargetsVertical[c];this.fsQuad.material=this.compositeMaterial,this.compositeMaterial.uniforms.bloomStrength.value=this.strength,this.compositeMaterial.uniforms.bloomRadius.value=this.radius,this.compositeMaterial.uniforms.bloomTintColors.value=this.bloomTintColors,t.setRenderTarget(this.renderTargetsHorizontal[0]),t.clear(),this.fsQuad.render(t),this.fsQuad.material=this.materialCopy,this.copyUniforms.tDiffuse.value=this.renderTargetsHorizontal[0].texture,f&&t.state.buffers.stencil.setTest(!0),this.renderToScreen?t.setRenderTarget(null):t.setRenderTarget(i),this.fsQuad.render(t),t.setClearColor(this.oldClearColor,this.oldClearAlpha),t.autoClear=r},getSeperableBlurMaterial:function(t){return new ki({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new vt(.5,.5)},direction:{value:new vt(.5,.5)}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:`#include <common>				varying vec2 vUv;
				uniform sampler2D colorTexture;
				uniform vec2 texSize;				uniform vec2 direction;								float gaussianPdf(in float x, in float sigma) {					return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;				}				void main() {
					vec2 invSize = 1.0 / texSize;					float fSigma = float(SIGMA);					float weightSum = gaussianPdf(0.0, fSigma);					vec3 diffuseSum = texture2D( colorTexture, vUv).rgb * weightSum;					for( int i = 1; i < KERNEL_RADIUS; i ++ ) {						float x = float(i);						float w = gaussianPdf(x, fSigma);						vec2 uvOffset = direction * invSize * x;						vec3 sample1 = texture2D( colorTexture, vUv + uvOffset).rgb;						vec3 sample2 = texture2D( colorTexture, vUv - uvOffset).rgb;						diffuseSum += (sample1 + sample2) * w;						weightSum += 2.0 * w;					}					gl_FragColor = vec4(diffuseSum/weightSum, 1.0);
				}`})},getCompositeMaterial:function(t){return new ki({defines:{NUM_MIPS:t},uniforms:{blurTexture1:{value:null},blurTexture2:{value:null},blurTexture3:{value:null},blurTexture4:{value:null},blurTexture5:{value:null},dirtTexture:{value:null},bloomStrength:{value:1},bloomFactors:{value:null},bloomTintColors:{value:null},bloomRadius:{value:0}},vertexShader:`varying vec2 vUv;
				void main() {
					vUv = uv;
					gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
				}`,fragmentShader:"varying vec2 vUv;				uniform sampler2D blurTexture1;				uniform sampler2D blurTexture2;				uniform sampler2D blurTexture3;				uniform sampler2D blurTexture4;				uniform sampler2D blurTexture5;				uniform sampler2D dirtTexture;				uniform float bloomStrength;				uniform float bloomRadius;				uniform float bloomFactors[NUM_MIPS];				uniform vec3 bloomTintColors[NUM_MIPS];								float lerpBloomFactor(const in float factor) { 					float mirrorFactor = 1.2 - factor;					return mix(factor, mirrorFactor, bloomRadius);				}								void main() {					gl_FragColor = bloomStrength * ( lerpBloomFactor(bloomFactors[0]) * vec4(bloomTintColors[0], 1.0) * texture2D(blurTexture1, vUv) + 													 lerpBloomFactor(bloomFactors[1]) * vec4(bloomTintColors[1], 1.0) * texture2D(blurTexture2, vUv) + 													 lerpBloomFactor(bloomFactors[2]) * vec4(bloomTintColors[2], 1.0) * texture2D(blurTexture3, vUv) + 													 lerpBloomFactor(bloomFactors[3]) * vec4(bloomTintColors[3], 1.0) * texture2D(blurTexture4, vUv) + 													 lerpBloomFactor(bloomFactors[4]) * vec4(bloomTintColors[4], 1.0) * texture2D(blurTexture5, vUv) );				}"})}}),ac.BlurDirectionX=new vt(1,0),ac.BlurDirectionY=new vt(0,1);var e3=function(t){function r(i){return Ri(this,r),_n(this,(r.__proto__||Xn(r)).call(this,i))}return Yn(r,t),tn(r,[{key:"initialize",value:function(i){var s=i.camera,f=i.renderer;if(!this._initialize){if(this.scene=i.scene,this.camera=s,this.renderer=f,i=this.options.passes,this._initialize=!0,this.renderScene=new tv(this.scene,this.camera),s=new yw(this.renderer),s.addPass(this.renderScene),this.passes=[],i)for(var c=0;c<i.length;c++){var g=i[c],p=void 0;switch(g.name){case"unrealBloom":p=g.strength||1;var A=g.radius||0,S=g.threshold||.5;p=new ac(new oc.Vector2(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio()),p,A,S);break;case"SMAA":p=new s2(window.innerWidth*f.getPixelRatio(),window.innerHeight*f.getPixelRatio())}if(p){for(var N in g)p[N]=g[N];s.addPass(p)}}this.composer=s}}},{key:"addRender",value:function(i){this.renderScene&&this.renderScene.addRender(i)}},{key:"render",value:function(){this.composer.render(this.scene,this.camera)}}]),r}(n2);ac.prototype.getSeperableBlurMaterial=function(t){return new oc.ShaderMaterial({defines:{KERNEL_RADIUS:t,SIGMA:t},uniforms:{colorTexture:{value:null},texSize:{value:new oc.Vector2(.5,.5)},direction:{value:new oc.Vector2(.5,.5)}},vertexShader:`varying vec2 vUv;
            void main() {
                vUv = uv;
                gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
            }`,fragmentShader:`#include <common>            varying vec2 vUv;
            uniform sampler2D colorTexture;
            uniform vec2 texSize;            uniform vec2 direction;                        float gaussianPdf(in float x, in float sigma) {                return 0.39894 * exp( -0.5 * x * x/( sigma * sigma))/sigma;            }            void main() {
                vec2 invSize = 1.0 / texSize;                float fSigma = float(SIGMA);                float weightSum = gaussianPdf(0.0, fSigma);                vec4 diffuseSum = texture2D( colorTexture, vUv).rgba * weightSum;                for( int i = 1; i < KERNEL_RADIUS; i ++ ) {                    float x = float(i);                    float w = gaussianPdf(x, fSigma);                    vec2 uvOffset = direction * invSize * x;                    vec4 sample1 = texture2D( colorTexture, vUv + uvOffset).rgba;                    vec4 sample2 = texture2D( colorTexture, vUv - uvOffset).rgba;                    diffuseSum += (sample1 + sample2) * w;                    weightSum += 2.0 * w;                }                gl_FragColor = vec4(diffuseSum/weightSum);
            }`})},tv.prototype.addRender=function(t){this.renderCbk=t},tv.prototype.render=function(t,r,i){if(r=t.autoClear,t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial,this.clearColor){var s=t.getClearColor().getHex(),f=t.getClearAlpha();t.setClearColor(this.clearColor,this.clearAlpha)}this.clearDepth&&t.clearDepth(),t.setRenderTarget(this.renderToScreen?null:i),this.clear&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),t.render(this.scene,this.camera),this.renderCbk&&this.renderCbk(),this.clearColor&&t.setClearColor(s,f),this.scene.overrideMaterial=null,t.autoClear=r};var r3=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.time=0,i.autoUpdate=!0,i}return Yn(r,t),tn(r,[{key:"getDefaultOptions",value:function(){return{totalRadian:Math.PI,color:16711680,radius:50,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){this.time+=this.options.step/10,1<this.time&&(this.time=0);for(var i=this.shapeMarker.children,s=0;s<i.length;s++)i[s].material.uniforms.periodRatio.value=this.time}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.shapeMarker)}},{key:"addOverlay",value:function(){this.shapeMarker=new Ui.Group;for(var i=this.threeLayer,s=this.getData(),f=0;f<s.length;f++){var c=i.normizedPoint(s[f].geometry.coordinates);c=this.create3dCanvasRipple({originalData:s[f],normizedData:c}),this.shapeMarker.add(c)}i.add(this.shapeMarker)}},{key:"create3dCanvasRipple",value:function(i){var s=this.options,f=s.totalRadian,c=s.color;s=s.size;var g=i.originalData;i=i.normizedData,Object.prototype.toString.call(c)==="[object Function]"&&(c=c(g)),s=Object.prototype.toString.call(s)==="[object Function]"?s(g):Number(s),g={totalRadian:{type:"f",value:f},glowColor:{type:"c",value:new Ui.Color(c)},radius:{type:"f",value:s},periodRatio:{type:"f",value:0}},c=new Ui.Geometry;for(var p=f/(s/2),A=p;A<=f;A+=p){var S=s*Math.sin(A),N=s*Math.cos(A);c.vertices.push(new Ui.Vector3(0,0,A/f)),c.vertices.push(new Ui.Vector3(N,S,A/f))}for(f=0,s=c.vertices.length;f<s-2;++f)c.faces.push(new Ui.Face3(f,f+1,f+3));return f=new Ui.ShaderMaterial({uniforms:g,vertexShader:"varying vec4 vFragColor;varying vec4 vPosition;uniform float radius;uniform float totalRadian;uniform float periodRatio;uniform vec3 glowColor;void main(){float radian=radians(360.0*periodRatio);float s=sin(radian);float c=cos(radian);vec2 rotatedPostion=vec2(position.x*s+position.y*c,position.y*s-position.x*c);gl_Position=projectionMatrix*modelViewMatrix*vec4(rotatedPostion,0,1.0);vFragColor=vec4(glowColor,pow(position.z,1.3));}",fragmentShader:"varying vec4 vFragColor;void main(){gl_FragColor=vFragColor;}",blending:Ui.NormalBlending,transparent:!0,depthWrite:!1}),f=new Ui.Mesh(c,f),f.position.set(i[0],i[1],i[2]||0),f}}]),r}(n2),Aw=It(function(t,r){(function(){function i(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],this.counters=[],this.geometry=new c.BufferGeometry,this.widthCallback=null,this.matrixWorld=new c.Matrix4}function s(g,p,A,S,N){if(g=g.subarray||g.slice?g:g.buffer,A=A.subarray||A.slice?A:A.buffer,g=p?g.subarray?g.subarray(p,N&&p+N):g.slice(p,N&&p+N):g,A.set)A.set(g,S);else for(p=0;p<g.length;p++)A[p+S]=g[p];return A}function f(g){c.ShaderMaterial.call(this,{uniforms:ut({},c.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new c.Color(16777215)},opacity:{value:1},resolution:{value:new c.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},dashArray:{value:0},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new c.Vector2(1,1)}}),vertexShader:c.ShaderChunk.meshline_vert,fragmentShader:c.ShaderChunk.meshline_frag}),this.type="MeshLineMaterial",Gr(this,{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(p){this.uniforms.lineWidth.value=p}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(p){this.uniforms.map.value=p}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(p){this.uniforms.useMap.value=p}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(p){this.uniforms.alphaMap.value=p}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(p){this.uniforms.useAlphaMap.value=p}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(p){this.uniforms.color.value=p}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(p){this.uniforms.opacity.value=p}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(p){this.uniforms.resolution.value.copy(p)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(p){this.uniforms.sizeAttenuation.value=p}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(p){this.uniforms.near.value=p}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(p){this.uniforms.far.value=p}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(p){this.uniforms.dashArray.value=p,this.useDash=p!==0?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(p){this.uniforms.dashOffset.value=p}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(p){this.uniforms.dashRatio.value=p}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(p){this.uniforms.useDash.value=p}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(p){this.uniforms.visibility.value=p}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(p){this.uniforms.alphaTest.value=p}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(p){this.uniforms.repeat.value.copy(p)}}}),this.setValues(g)}var c=typeof ee!="undefined"&&mw||this.THREE;if(!c)throw Error("MeshLine requires three.js");i.prototype.setMatrixWorld=function(g){this.matrixWorld=g},i.prototype.setGeometry=function(g,p){if(this.widthCallback=p,this.positions=[],this.counters=[],g instanceof c.Geometry)for(var A=0;A<g.vertices.length;A++){var S=g.vertices[A];p=A/g.vertices.length,this.positions.push(S.x,S.y,S.z),this.positions.push(S.x,S.y,S.z),this.counters.push(p),this.counters.push(p)}if(g instanceof Float32Array||g instanceof Array)for(A=0;A<g.length;A+=3)p=A/g.length,this.positions.push(g[A],g[A+1],g[A+2]),this.positions.push(g[A],g[A+1],g[A+2]),this.counters.push(p),this.counters.push(p);this.process()},i.prototype.raycast=function(){var g=new c.Matrix4,p=new c.Ray,A=new c.Sphere;return function(S,N){var w=S.linePrecision;w*=w;var I=this.geometry;if(I.boundingSphere===null&&I.computeBoundingSphere(),A.copy(I.boundingSphere),A.applyMatrix4(this.matrixWorld),S.ray.intersectSphere(A)!==!1){g.getInverse(this.matrixWorld),p.copy(S.ray).applyMatrix4(g);var L=new c.Vector3,P=new c.Vector3,F=new c.Vector3,W=new c.Vector3,X=this instanceof c.LineSegments?2:1;if(I instanceof c.BufferGeometry){var Z=I.index,tt=I.attributes;if(Z!==null){I=Z.array,tt=tt.position.array,Z=0;for(var st=I.length-1;Z<st;Z+=X){var xt=I[Z+1];L.fromArray(tt,3*I[Z]),P.fromArray(tt,3*xt),xt=p.distanceSqToSegment(L,P,W,F),xt>w||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}}else for(tt=tt.position.array,Z=0,st=tt.length/3-1;Z<st;Z+=X)L.fromArray(tt,3*Z),P.fromArray(tt,3*Z+3),xt=p.distanceSqToSegment(L,P,W,F),xt>w||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}else if(I instanceof c.Geometry)for(L=I.vertices,P=L.length,Z=0;Z<P-1;Z+=X)xt=p.distanceSqToSegment(L[Z],L[Z+1],W,F),xt>w||(W.applyMatrix4(this.matrixWorld),xt=S.ray.origin.distanceTo(W),xt<S.near||xt>S.far||N.push({distance:xt,point:F.clone().applyMatrix4(this.matrixWorld),index:Z,face:null,faceIndex:null,object:this}))}}}(),i.prototype.compareV3=function(g,p){return g*=6,p*=6,this.positions[g]===this.positions[p]&&this.positions[g+1]===this.positions[p+1]&&this.positions[g+2]===this.positions[p+2]},i.prototype.copyV3=function(g){return g*=6,[this.positions[g],this.positions[g+1],this.positions[g+2]]},i.prototype.process=function(){var g=this.positions.length/6;this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[];for(var p=0;p<g;p++)this.side.push(1),this.side.push(-1);for(p=0;p<g;p++){var A=this.widthCallback?this.widthCallback(p/(g-1)):1;this.width.push(A),this.width.push(A)}for(p=0;p<g;p++)this.uvs.push(p/(g-1),0),this.uvs.push(p/(g-1),1);for(A=this.compareV3(0,g-1)?this.copyV3(g-2):this.copyV3(0),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]),p=0;p<g-1;p++)A=this.copyV3(p),this.previous.push(A[0],A[1],A[2]),this.previous.push(A[0],A[1],A[2]);for(p=1;p<g;p++)A=this.copyV3(p),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]);for(A=this.compareV3(g-1,0)?this.copyV3(1):this.copyV3(g-1),this.next.push(A[0],A[1],A[2]),this.next.push(A[0],A[1],A[2]),p=0;p<g-1;p++)A=2*p,this.indices_array.push(A,A+1,A+2),this.indices_array.push(A+2,A+1,A+3);this.attributes?(this.attributes.position.copyArray(new Float32Array(this.positions)),this.attributes.position.needsUpdate=!0,this.attributes.previous.copyArray(new Float32Array(this.previous)),this.attributes.previous.needsUpdate=!0,this.attributes.next.copyArray(new Float32Array(this.next)),this.attributes.next.needsUpdate=!0,this.attributes.side.copyArray(new Float32Array(this.side)),this.attributes.side.needsUpdate=!0,this.attributes.width.copyArray(new Float32Array(this.width)),this.attributes.width.needsUpdate=!0,this.attributes.uv.copyArray(new Float32Array(this.uvs)),this.attributes.uv.needsUpdate=!0,this.attributes.index.copyArray(new Uint16Array(this.indices_array)),this.attributes.index.needsUpdate=!0):this.attributes={position:new c.BufferAttribute(new Float32Array(this.positions),3),previous:new c.BufferAttribute(new Float32Array(this.previous),3),next:new c.BufferAttribute(new Float32Array(this.next),3),side:new c.BufferAttribute(new Float32Array(this.side),1),width:new c.BufferAttribute(new Float32Array(this.width),1),uv:new c.BufferAttribute(new Float32Array(this.uvs),2),index:new c.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new c.BufferAttribute(new Float32Array(this.counters),1)},this.geometry.setAttribute("position",this.attributes.position),this.geometry.setAttribute("previous",this.attributes.previous),this.geometry.setAttribute("next",this.attributes.next),this.geometry.setAttribute("side",this.attributes.side),this.geometry.setAttribute("width",this.attributes.width),this.geometry.setAttribute("uv",this.attributes.uv),this.geometry.setAttribute("counters",this.attributes.counters),this.geometry.setIndex(this.attributes.index)},i.prototype.advance=function(g){var p=this.attributes.position.array,A=this.attributes.next.array,S=p.length;s(p,0,this.attributes.previous.array,0,S),s(p,6,p,0,S-6),p[S-6]=g.x,p[S-5]=g.y,p[S-4]=g.z,p[S-3]=g.x,p[S-2]=g.y,p[S-1]=g.z,s(p,6,A,0,S-6),A[S-6]=g.x,A[S-5]=g.y,A[S-4]=g.z,A[S-3]=g.x,A[S-2]=g.y,A[S-1]=g.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},c.ShaderChunk.meshline_vert=["",c.ShaderChunk.logdepthbuf_pars_vertex,c.ShaderChunk.fog_pars_vertex,`\r
attribute vec3 previous;\r
attribute vec3 next;\r
attribute float side;\r
attribute float width;\r
attribute float counters;\r
\r
uniform vec2 resolution;\r
uniform float lineWidth;\r
uniform vec3 color;\r
uniform float opacity;\r
uniform float near;\r
uniform float far;\r
uniform float sizeAttenuation;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
vec2 fix( vec4 i, float aspect ) {\r
\r
    vec2 res = i.xy / i.w;\r
    res.x *= aspect;\r
	 vCounters = counters;\r
    return res;\r
\r
}\r
\r
void main() {\r
\r
    float aspect = resolution.x / resolution.y;\r
    float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\r
\r
    vColor = vec4( color, opacity );\r
    vUV = uv;\r
\r
    mat4 m = projectionMatrix * modelViewMatrix;\r
    vec4 finalPosition = m * vec4( position, 1.0 );\r
    vec4 prevPos = m * vec4( previous, 1.0 );\r
    vec4 nextPos = m * vec4( next, 1.0 );\r
\r
    vec2 currentP = fix( finalPosition, aspect );\r
    vec2 prevP = fix( prevPos, aspect );\r
    vec2 nextP = fix( nextPos, aspect );\r
\r
    float pixelWidth = finalPosition.w * pixelWidthRatio;\r
    float w = 1.8 * pixelWidth * lineWidth * width;\r
\r
    if( sizeAttenuation == 1. ) {\r
        w = 1.8 * lineWidth * width;\r
    }\r
\r
    vec2 dir;\r
    if( nextP == currentP ) dir = normalize( currentP - prevP );\r
    else if( prevP == currentP ) dir = normalize( nextP - currentP );\r
    else {\r
        vec2 dir1 = normalize( currentP - prevP );\r
        vec2 dir2 = normalize( nextP - currentP );\r
        dir = normalize( dir1 + dir2 );\r
\r
        vec2 perp = vec2( -dir1.y, dir1.x );\r
        vec2 miter = vec2( -dir.y, dir.x );\r
        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );\r
\r
    }\r
\r
    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;\r
    vec2 normal = vec2( -dir.y, dir.x );\r
    normal.x /= aspect;\r
    normal *= .5 * w;\r
\r
    vec4 offset = vec4( normal * side, 0.0, 1.0 );\r
    finalPosition.xy += offset.xy;\r
\r
    gl_Position = finalPosition;\r
`,c.ShaderChunk.logdepthbuf_vertex,c.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",c.ShaderChunk.fog_vertex,"}"].join(`\r
`),c.ShaderChunk.meshline_frag=["",c.ShaderChunk.fog_pars_fragment,c.ShaderChunk.logdepthbuf_pars_fragment,`\r
uniform sampler2D map;\r
uniform sampler2D alphaMap;\r
uniform float useMap;\r
uniform float useAlphaMap;\r
uniform float useDash;\r
uniform float dashArray;\r
uniform float dashOffset;\r
uniform float dashRatio;\r
uniform float visibility;\r
uniform float alphaTest;\r
uniform vec2 repeat;\r
\r
varying vec2 vUV;\r
varying vec4 vColor;\r
varying float vCounters;\r
\r
void main() {\r
`,c.ShaderChunk.logdepthbuf_fragment,`\r
    vec4 c = vColor;\r
    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );\r
    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;\r
    if( c.a < alphaTest ) discard;\r
    if( useDash == 1. ){\r
        c.a *= ceil(mod(vCounters + dashOffset, dashArray) - (dashArray * dashRatio));\r
    }\r
    gl_FragColor = c;\r
    gl_FragColor.a *= step(vCounters, visibility);\r
`,c.ShaderChunk.fog_fragment,"}"].join(`\r
`),f.prototype=at(c.ShaderMaterial.prototype),f.prototype.constructor=f,f.prototype.isMeshLineMaterial=!0,f.prototype.copy=function(g){return c.ShaderMaterial.prototype.copy.call(this,g),this.lineWidth=g.lineWidth,this.map=g.map,this.useMap=g.useMap,this.alphaMap=g.alphaMap,this.useAlphaMap=g.useAlphaMap,this.color.copy(g.color),this.opacity=g.opacity,this.resolution.copy(g.resolution),this.sizeAttenuation=g.sizeAttenuation,this.near=g.near,this.far=g.far,this.dashArray.copy(g.dashArray),this.dashOffset.copy(g.dashOffset),this.dashRatio.copy(g.dashRatio),this.useDash=g.useDash,this.visibility=g.visibility,this.alphaTest=g.alphaTest,this.repeat.copy(g.repeat),this},t.exports&&(r=t.exports={MeshLine:i,MeshLineMaterial:f}),r.MeshLine=i,r.MeshLineMaterial=f}).call($r)}),i3=Aw.MeshLine,n3=Aw.MeshLineMaterial,o3=function(t){function r(i){return Ri(this,r),i=_n(this,(r.__proto__||Xn(r)).call(this,i)),i.staticDashArray=2,i.time=0,i.autoUpdate=!0,i}return Yn(r,t),tn(r,[{key:"getDefaultOptions",value:function(){return{color:16777215,textureColor:16777215,textureWidth:10,textureLength:30,step:.1}}},{key:"initialize",value:function(i){this.threeLayer=i,this.addOverlay()}},{key:"onChanged",value:function(i,s){this.threeLayer&&(this.removeOverlay(),this.addOverlay())}},{key:"onDestroy",value:function(){this.removeOverlay()}},{key:"render",value:function(){var i=this.getOptions(),s=i.textureWidth,f=i.style;i=i.step/10,this.time+=i,2<this.time&&(this.time=0);for(var c=this.flyLine.children,g=0;g<c.length;g++){var p=c[g],A=p.hash;p.children[0].material.uniforms.lineWidth.value=s*(1+.2*Math.sin(5*this.time)),p.children[0].material.uniforms.dashOffset.value=f==="chaos"?p.children[0].material.uniforms.dashOffset.value-i:(this.staticDashArray+A)*(1-this.time/2)}}},{key:"removeOverlay",value:function(){this.threeLayer.remove(this.flyLine)}},{key:"addOverlay",value:function(){var i=this;this.flyLine=new Ui.Group;var s=this.threeLayer,f=new Ui.TextureLoader,c=this.getData();f.load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAABZCAQAAAD/AkAkAAAACXBIWXMAAAsTAAALEwEAmpwYAAADGWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjaY2BgnuDo4uTKJMDAUFBUUuQe5BgZERmlwH6egY2BmYGBgYGBITG5uMAxIMCHgYGBIS8/L5UBA3y7xsDIwMDAcFnX0cXJlYE0wJpcUFTCwMBwgIGBwSgltTiZgYHhCwMDQ3p5SUEJAwNjDAMDg0hSdkEJAwNjAQMDg0h2SJAzAwNjCwMDE09JakUJAwMDg3N+QWVRZnpGiYKhpaWlgmNKflKqQnBlcUlqbrGCZ15yflFBflFiSWoKAwMD1A4GBgYGXpf8EgX3xMw8BUNTVQYqg4jIKAX08EGIIUByaVEZhMXIwMDAIMCgxeDHUMmwiuEBozRjFOM8xqdMhkwNTJeYNZgbme+y2LDMY2VmzWa9yubEtoldhX0mhwBHJycrZzMXM1cbNzf3RB4pnqW8xryH+IL5nvFXCwgJrBZ0E3wk1CisKHxYJF2UV3SrWJw4p/hWiRRJYcmjUhXSutJPZObIhsoJyp2V71HwUeRVvKA0RTlKRUnltepWtUZ1Pw1Zjbea+7QmaqfqWOsK6b7SO6I/36DGMMrI0ljS+LfJPdPDZivM+y0qLBOtfKwtbFRtRexY7L7aP3e47XjB6ZjzXpetruvdVrov9VjkudBrgfdCn8W+y/xW+a8P2Bq4N+hY8PmQW6HPwr5EMEUKRilFG8e4xUbF5cW3JMxO3Jx0Nvl5KlOaXLpNRlRmVdas7D059/KY8tULfAqLi2YXHy55WyZR7lJRWDmv6mz131q9uvj6SQ3HGn83G7Skt85ru94h2Ond1d59uJehz76/bsK+if8nO05pnXpiOu+M4JmzZj2aozW3ZN6+BVwLwxYtXvxxqcOyCcsfrjRe1br65lrddU3rb2402NSx+cFWq21Tt3/Y6btr1R6Oven7jh9QP9h56PURv6Obj4ufqD355LT3mS3nZM+3X/h0Ke7yqasW15bdEL3ZeuvrnfS7N+/7PDjwyPTx6qeKz2a+EHzZ9Zr5Td3bn+9LP3z6VPD53de8b+9+5P/88Lv4z7d/Vf//AwAqvx2K829RWwAAOGtpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnBob3Rvc2hvcD0iaHR0cDovL25zLmFkb2JlLmNvbS9waG90b3Nob3AvMS4wLyIKICAgICAgICAgICAgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iCiAgICAgICAgICAgIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTktMDYtMjdUMTk6MzE6MTUrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOS0wOC0xOVQxNjo1Nzo1MCswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTktMDgtMTlUMTY6NTc6NTArMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjE8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDxwaG90b3Nob3A6SUNDUHJvZmlsZT5Eb3QgR2FpbiAxNSU8L3Bob3Rvc2hvcDpJQ0NQcm9maWxlPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjQ5MmI1NTQ1LWIwNmQtNGI0Yi1iMWExLTZiN2NiNzExNzA5MjwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOkRvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+eG1wLmRpZDo0OTJiNTU0NS1iMDZkLTRiNGItYjFhMS02YjdjYjcxMTcwOTI8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5jcmVhdGVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6NDkyYjU1NDUtYjA2ZC00YjRiLWIxYTEtNmI3Y2I3MTE3MDkyPC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE5LTA2LTI3VDE5OjMxOjE1KzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoTWFjaW50b3NoKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgIDwvcmRmOlNlcT4KICAgICAgICAgPC94bXBNTTpIaXN0b3J5PgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpYUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WFJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOllSZXNvbHV0aW9uPjcyMDAwMC8xMDAwMDwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPHRpZmY6UmVzb2x1dGlvblVuaXQ+MjwvdGlmZjpSZXNvbHV0aW9uVW5pdD4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT42NTUzNTwvZXhpZjpDb2xvclNwYWNlPgogICAgICAgICA8ZXhpZjpQaXhlbFhEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxYRGltZW5zaW9uPgogICAgICAgICA8ZXhpZjpQaXhlbFlEaW1lbnNpb24+ODk8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0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",function(g){for(var p=0;p<c.length;p++){var A=c[p].geometry.coordinates.map(function(S){return new(Function.prototype.bind.apply(Ui.Vector3,[null].concat(uw(s.normizedPoint(S)))))});A=i.createFlyLine({originalData:c[p],curveData:A,texture:g}),i.flyLine.add(A)}s.add(i.flyLine)})}},{key:"createFlyLine",value:function(i){var s=this.options,f=s.color,c=s.textureColor,g=s.textureWidth,p=i.originalData,A=i.curveData;i=i.texture;var S=Math.random();s=Math.min(1,1-s.textureLength/100),s=Math.max(0,s),Object.prototype.toString.call(f)==="[object Function]"&&(f=f(p)),Object.prototype.toString.call(c)==="[object Function]"&&(c=c(p)),p=new Ui.Geometry,p.vertices=A,p.verticesNeedUpdate=!0,f=new Ui.LineBasicMaterial({linewidth:1,color:new Ui.Color(f),blending:Ui.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0,opacity:.3,linecap:"round",linejoin:"round"}),f=new Ui.Line(p,f),f.renderDepth=!1,f.hash=S,p=new i3;for(var N=new Ui.Geometry,w=0;w<A.length;w++){var I=A[w];N.vertices.push(new Ui.Vector3(I.x,I.y,I.z))}return p.setGeometry(N,function(L){return 1-L}),c=new n3({map:i,useMap:!0,color:new Ui.Color(c),opacity:1,dashArray:this.staticDashArray+S,dashOffset:0,dashRatio:s,sizeAttenuation:!0,lineWidth:g,depthWrite:!1,depthTest:!0,alphaTest:!1,transparent:!0,blending:Ui.AdditiveBlending,side:Ui.DoubleSide}),c=new Ui.Mesh(p.geometry,c),f.add(c),f}}]),r}(n2);Pt.THREELoader=oc,Pt.PostProcessing=e3,Pt.FanLayer=r3,Pt.FlyLineLayer=o3,Pt.ThreeLayer=vw,Object.defineProperty(Pt,"__esModule",{value:!0})})},52366:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(27054)),ee=function(zt){ie.__extends(It,zt);function It(ue){return zt.call(this,ue)||this}return It.prototype.getControl=function(){return new BMapGL.CityListControl(this.getOptions())},It.prototype.render=function(){return null},It}(Pt.default);Yt.default=ee},27054:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(74445)),zt=Dt(9343),It=function(ue){ie.__extends(se,ue);function se(vt){var Ot=ue.call(this,vt)||this;return Ot.options=["anchor","offset"],Ot}return se.prototype.componentDidUpdate=function(vt){if(!this.map){this.initialize();return}var Ot=this.props,Lt=Ot.anchor,_t=Ot.offset,Ft=vt.anchor,$t=vt.offset,jt=!ee.default(Lt,Ft),ot=!ee.default(_t,$t);Lt&&jt&&this.control.setAnchor(Lt),_t&&ot&&this.control.setOffset(_t)},se.prototype.componentDidMount=function(){this.initialize()},se.prototype.componentWillUnmount=function(){this.destroy()},se.prototype.destroy=function(){this.control&&this.map&&(this.map.removeControl(this.control),this.control=null)},se.prototype.initialize=function(){var vt=this.map=this.getMap();vt&&(this.destroy(),this.control=this.getControl(),vt.addControl(this.control))},se.prototype.getControl=function(){throw new Error("Method getControl not implemented.")},se.contextType=zt.MapContext,se}(Pt.Component);Yt.default=It},84159:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(27054)),ee=function(zt){ie.__extends(It,zt);function It(ue){return zt.call(this,ue)||this}return It.prototype.getControl=function(){return new BMapGL.MapTypeControl(this.getOptions())},It.prototype.render=function(){return null},It}(Pt.default);Yt.default=ee},59813:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(27054)),ee=function(zt){ie.__extends(It,zt);function It(ue){return zt.call(this,ue)||this}return It.prototype.getControl=function(){return new BMapGL.NavigationControl3D(this.getOptions())},It.prototype.render=function(){return null},It}(Pt.default);Yt.default=ee},86635:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(27054)),ee=function(zt){ie.__extends(It,zt);function It(ue){return zt.call(this,ue)||this}return It.prototype.getControl=function(){return new BMapGL.ScaleControl(this.getOptions())},It.prototype.render=function(){return null},It}(Pt.default);Yt.default=ee},66873:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(27054)),ee=function(zt){ie.__extends(It,zt);function It(ue){return zt.call(this,ue)||this}return It.prototype.getControl=function(){return new BMapGL.ZoomControl(this.getOptions())},It.prototype.render=function(){return null},It}(Pt.default);Yt.default=ee},28444:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(66996),ee=ie.__importDefault(Dt(74445)),zt=Dt(26571),It="rgba(60, 50, 200, 0.9)",ue=function(se){ie.__extends(vt,se);function vt(Ot){var Lt=se.call(this,Ot)||this;return Lt._createLayer=!1,Lt}return vt.prototype.componentDidMount=function(){this.initialize()},vt.prototype.componentDidUpdate=function(Ot){ee.default(this.props,Ot)||this.initialize()},vt.prototype.componentWillUnmount=function(){this.destroy()},vt.prototype.destroy=function(){this._createLayer=!1,this.view.destroy(),this.view=void 0,this.linelayer=void 0,this.arrowlayer=void 0,this.flowlayer=void 0,this.pointlayer=void 0,this.textlayer=void 0,this.colorarrowlayers=[]},vt.prototype.initialize=function(){var Ot=this,Lt=this.map=this.getMap();if(Lt){this._createLayer||this.createLayers();var _t=[],Ft=[],$t=new Map;if(this.colorarrowlayers&&this.colorarrowlayers.length)for(var jt=0;jt<this.colorarrowlayers.length;jt++){var ot=this.colorarrowlayers[jt];this.view.removeLayer(ot)}if(this.colorarrowlayers=[],this.props.data){var Ie=[],Mr=new Pt.OdCurve;this.props.data.forEach(function(Lr){var Ee=Lr.from.point||Pt.utilCity.getCenterByCityName(Lr.from.city),Yr=Lr.to.point||Pt.utilCity.getCenterByCityName(Lr.to.city);Ee=new BMapGL.Point(Ee.lng,Ee.lat),Yr=new BMapGL.Point(Yr.lng,Yr.lat),Mr.setOptions({points:[Ee,Yr]});var li=Mr.getPoints();Ot.props.coordType==="bd09mc"?(Ie.push(BMapGL.Projection.convertMC2LL(Ee)),Ie.push(BMapGL.Projection.convertMC2LL(Yr))):(Ie.push(Ee),Ie.push(Yr)),_t.push({geometry:{type:"LineString",coordinates:li},color:Lr.color});var hi=$t.get(Lr.color)||[];hi.push({geometry:{type:"LineString",coordinates:li}}),$t.set(Lr.color,hi),Ot.props.showEndPoint!==!1&&Ft.push({geometry:{type:"Point",coordinates:[Yr.lng,Yr.lat]},color:Lr.color,properties:{text:Lr.to.name||Lr.to.city}}),Ot.props.showStartPoint!==!1&&Ft.push({geometry:{type:"Point",coordinates:[Ee.lng,Ee.lat]},color:Lr.color,properties:{text:Lr.from.name||Lr.from.city}}),Ie.length>0&&Ot.props.autoViewport===!0&&Lt.setViewport(Ie,Ot.props.viewportOptions||{})})}this.linelayer.setData(_t),this.props.lineOptions&&this.linelayer.setOptions(this.props.lineOptions),this.pointlayer.setData(Ft),this.props.pointOptions&&this.pointlayer.setOptions(this.props.pointOptions),this.textlayer.setData(Ft),this.props.textOptions&&this.textlayer.setOptions(this.props.textOptions),Array.from($t.keys()).forEach(function(Lr){if(Lr===void 0)Ot.arrowlayer.setData($t.get(void 0)),Ot.props.arrowOptions&&Ot.arrowlayer.setOptions(Ot.props.arrowOptions);else{var Ee=new Pt.LineLayer(ie.__assign(ie.__assign({blend:"lighter",width:10},Ot.props.arrowOptions),{style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:Lr}}));Ot.view.addLayer(Ee),Ee.setData($t.get(Lr)),Ot.colorarrowlayers.push(Ee)}}),this.props.enableAnimation&&(this.flowlayer.setData(_t),this.props.animationOptions&&this.flowlayer.setOptions(this.props.animationOptions))}},vt.prototype.createLayers=function(){this._createLayer=!0;var Ot=this.map,Lt=this.view=new Pt.View({map:Ot}),_t=this.linelayer=new Pt.LineLayer({blend:"lighter",color:It,width:4});Lt.addLayer(_t);var Ft=this.arrowlayer=new Pt.LineLayer({blend:"lighter",width:10,style:"arrow",color:"rgba(255, 255, 255, 0)",styleOptions:{color:It}});Lt.addLayer(Ft);var $t=this.pointlayer=new Pt.PointLayer({blend:"lighter",depthTest:!1,color:It,size:10});Lt.addLayer($t);var jt=this.textlayer=new Pt.TextLayer({offset:[0,15],depthTest:!1,color:"#333"});Lt.addLayer(jt);var ot=this.flowlayer=new Pt.LineLayer({blend:"lighter",color:function(){return"rgb(240, 200, 200)"},width:2,animation:!0,interval:.4,duration:1,trailLength:.8});Lt.addLayer(ot)},vt.prototype.render=function(){return null},vt.defaultProps={enableAnimation:!0,showStartPoint:!0,showEndPoint:!0},vt}(zt.Component);Yt.default=ue},96205:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importStar(Dt(66996)),ee=ie.__importStar(Dt(27599)),zt=Dt(26571),It=Dt(26505),ue=function(se){ie.__extends(vt,se);function vt(Ot){var Lt=se.call(this,Ot)||this;Lt._createLayer=!1;var _t=Lt;return Lt.props.getMethods&&Lt.props.getMethods({setViewport:Lt.setViewport.bind(_t)}),Lt}return vt.prototype.componentDidMount=function(){this.initialize()},vt.prototype.componentWillUnmount=function(){this.destroy()},vt.prototype.componentDidUpdate=function(Ot){var Lt=this.props,_t=Lt.type,Ft=Lt.data,$t=Lt.options,jt=Lt.autoViewport,ot=Ot.type,Ie=Ot.data,Mr=Ot.options,Lr=Ot.autoViewport;if(!this.map||!this.layer){this.initialize();return}if(_t!==ot){this.destroy(),this.initialize();return}JSON.stringify(Mr)!==JSON.stringify($t)&&this.layer.setOptions($t),JSON.stringify(Ie)!==JSON.stringify(Ft)&&this.layer.setData(Ft),jt&&(JSON.stringify(Ie)!==JSON.stringify(Ft)||jt!==Lr)&&this.setViewport()},vt.prototype.destroy=function(){this.layer&&this.view&&(this._createLayer=!1,this.view.removeLayer(this.layer),this.layer.destroy(),this.layer=null)},vt.prototype.initialize=function(){var Ot=this.map=this.getMap(),Lt=this.view=this.props.view||this.context.view;!Ot||!Lt||(this._createLayer||this.createLayers(),this.layer.setData(this.props.data),this.props.autoViewport&&this.setViewport())},vt.prototype.setViewport=function(){var Ot=this.props.coordType==="bd09mc",Lt=function(Ft){var $t=new BMapGL.Point(Ft[0],Ft[1]);return Ot?BMapGL.Projection.convertMC2LL($t):$t},_t=[];this.props.data.forEach(function(Ft){Ft.geometry.type==="Point"?_t.push(Lt(Ft.geometry.coordinates)):Ft.geometry.type==="LineString"?Ft.geometry.coordinates.forEach(function($t){_t.push(Lt($t))}):Ft.geometry.type==="Polygon"?Ft.geometry.coordinates[0].forEach(function($t){_t.push(Lt($t))}):Ft.geometry.type==="MultiPolygon"&&Ft.geometry.coordinates.forEach(function($t){$t[0].forEach(function(jt){_t.push(Lt(jt))})})}),_t.length>0&&this.map.setViewport(_t,this.props.viewportOptions||{})},vt.prototype.createLayers=function(){if(Pt[this.props.type]||ee[this.props.type]){this._createLayer=!0;var Ot=Pt[this.props.type]?Pt:ee;this.layer=new Ot[this.props.type](this.props.options),this.view.addLayer(this.layer)}else console.error("mapvgl doesn't have layer "+this.props.type+"!")},vt.prototype.render=function(){return null},vt.contextType=It.ViewContext,vt}(zt.Component);Yt.default=ue},26505:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.ViewContext=void 0;var ie=Dt(59312),Pt=Dt(66996),ee=ie.__importStar(Dt(67294)),zt=Dt(26571),It=Dt(9343);Yt.ViewContext=ee.default.createContext({view:void 0});var ue=function(se){ie.__extends(vt,se);function vt(Ot){return se.call(this,Ot)||this}return vt.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},vt.prototype.componentWillUnmount=function(){this.view&&(this.view.destroy(),this.view=null)},vt.prototype.componentDidUpdate=function(Ot){(!this.map||!this.view)&&this.initialize()},vt.prototype.initialize=function(){var Ot=this.map=this.getMap();if(!(!Ot||this.view)&&!this.view){var Lt=[],_t=this.props.effects,Ft=this.props.preserveDrawingBuffer;_t&&_t.length&&_t.forEach(function($t){$t==="bloom"?Lt.push(new Pt.BloomEffect):$t==="bright"?Lt.push(new Pt.BrightEffect):$t==="blur"&&Lt.push(new Pt.BlurEffect)}),this.view=new Pt.View({effects:Lt,preserveDrawingBuffer:Ft,map:Ot})}},vt.prototype.renderChildren=function(Ot){var Lt=this;if(!(!Ot||!this.map||!this.view))return ee.default.Children.map(Ot,function(_t){if(_t)return typeof _t.type=="string"?_t:ee.default.cloneElement(_t,{map:Lt.map,view:Lt.view})})},vt.prototype.render=function(){return ee.default.createElement(ee.Fragment,null,ee.default.createElement(Yt.ViewContext.Provider,{value:{map:this.map,view:this.view}},this.renderChildren(this.props.children)))},vt.contextType=It.MapContext,vt}(zt.Component);Yt.default=ue},90301:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(9343),ee=Dt(26571),zt=function(It){ie.__extends(ue,It);function ue(se){return It.call(this,se)||this}return ue.prototype.componentDidMount=function(){this.initialize()},ue.prototype.componentDidUpdate=function(se){this.initialize()},ue.prototype.componentWillUnmount=function(){this.destroy()},ue.prototype.destroy=function(){this.tilelayer&&(this.map.removeTileLayer(this.tilelayer),this.tilelayer=void 0)},ue.prototype.initialize=function(){var se=this.map=this.getMap();if(se){this.destroy();var vt="pl",Ot="20190102",Lt=this.tilelayer=new BMapGL.TileLayer({transparentPng:!0});Lt.zIndex=110,Lt.getTilesUrl=function(_t,Ft){if(!_t||Ft<0)return"";var $t=_t.x,jt=_t.y,ot="//mapsv0.bdimg.com/tile/?udt="+Ot+"&qt=tile&styles="+vt+"&x="+$t+"&y="+jt+"&z="+Ft;return ot},se.addTileLayer(this.tilelayer)}},ue.prototype.render=function(){return null},ue.contextType=Pt.MapContext,ue}(ee.Component);Yt.default=zt},81776:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(9343),ee=Dt(26571),zt=function(It){ie.__extends(ue,It);function ue(se){var vt=It.call(this,se)||this;return vt._showLayer=!1,vt}return ue.prototype.componentDidMount=function(){this.initialize()},ue.prototype.componentDidUpdate=function(se){this.initialize()},ue.prototype.componentWillUnmount=function(){this._showLayer&&(this.map.setTrafficOff(),this._showLayer=!1)},ue.prototype.initialize=function(){var se=this.map=this.getMap();se&&(this._showLayer||(se.setTrafficOn(),this._showLayer=!0))},ue.prototype.render=function(){return null},ue.contextType=Pt.MapContext,ue}(ee.Component);Yt.default=zt},37972:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=Dt(5939),zt=ie.__importStar(Dt(22665)),It=Dt(9343),ue=["drawend","addpoint","removepolyline"],se={},vt=function(Ot){ie.__extends(Lt,Ot);function Lt(_t){var Ft=Ot.call(this,_t)||this;return Ft.options=["tips","followText","unit","lineColor","lineStroke","opacity","lineStyle","cursor","secIcon","closeIcon"],Ft}return Lt.prototype.componentDidMount=function(){this.initialize()},Lt.prototype.componentWillUnmount=function(){this.destroy()},Lt.prototype.destroy=function(){this.distancetool&&(this.distancetool.close(),this.instance=this.distancetool=void 0)},Lt.prototype.initialize=function(){var _t=this,Ft=this.map=this.getMap();if(Ft){this.destroy();var $t=this.getOptions();if(window.BMapGLLib&&BMapGLLib.DistanceTool&&(this.instance=this.distancetool=new BMapGLLib.DistanceTool(Ft,$t),this.props.defaultOpen&&this.distancetool.open()),!window.BMapGLLib||!BMapGLLib.DistanceTool){var jt=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DistanceTool/src/DistanceTool.js";ee.requireScript(jt).then(function(){_t.instance=_t.distancetool=new BMapGLLib.DistanceTool(Ft,$t),zt.registerEvents(_t,_t.getInstance(_t),ue),zt.toggleMethods(_t,_t.getInstance(_t),se),_t.props.defaultOpen&&_t.distancetool.open()})}}},Lt.prototype.render=function(){return null},Lt.contextType=It.MapContext,Lt}(Pt.Component);vt.defaultProps={defaultOpen:!0},Yt.default=zt.default(vt,ue,se)},46716:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(67294)),ee=Dt(26571),zt=Dt(5939),It=ie.__importStar(Dt(22665)),ue=Dt(9343),se=["overlaycomplete","overlaycancel"],vt={enableCalculate:["enableCalculate","disableCalculate"],enableSorption:["enableSorption","disableSorption"],enableGpc:["enableGpc","disableGpc"]},Ot={strokeColor:"#5E87DB",fillColor:"#5E87DB",strokeWeight:2,strokeOpacity:1,fillOpacity:.2},Lt={borderRadius:"2px",background:"#FFFBCC",border:"1px solid #E1E1E1",color:"#703A04",fontSize:"12px",letterSpacing:"0",padding:"5px"},_t=function(Ft){ie.__extends($t,Ft);function $t(jt){var ot=Ft.call(this,jt)||this;return ot.el=Pt.default.createRef(),ot.options=["isOpen","drawingMode","enableDrawingTool","enableCalculate","enableSorption","enableGpc","enableLimit","sorptionDistance","limitOptions","drawingToolOptions","markerOptions","circleOptions","polylineOptions","polygonOptions","rectangleOptions","labelOptions"],ot}return $t.prototype.componentDidMount=function(){this.initialize()},$t.prototype.componentWillUnmount=function(){this.destroy()},$t.prototype.destroy=function(){this.drawingmanager&&(this.drawingmanager.close(),this.instance=this.drawingmanager=void 0)},$t.prototype.initialize=function(){var jt=this,ot=this.map=this.getMap();if(ot){this.destroy();for(var Ie=this.getOptions(),Mr=["circleOptions","polylineOptions","polygonOptions","rectangleOptions"],Lr=0;Lr<Mr.length;Lr++){var Ee=Mr[Lr];Ie[Ee]||(Ie[Ee]=Ot)}if(Ie.labelOptions||(Ie.labelOptions=Lt),Ie.drawingToolOptions.customContainer=this.el.current,window.BMapGLLib&&BMapGLLib.DrawingManager&&(this.instance=this.drawingmanager=new BMapGLLib.DrawingManager(ot,Ie)),!window.BMapGLLib||!BMapGLLib.DrawingManager){var Yr=this.props.cssUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.css",li=this.props.scriptUrl||"//mapopen.bj.bcebos.com/github/BMapGLLib/DrawingManager/src/DrawingManager.min.js";zt.requireCss(Yr).then(function(){}),zt.requireScript(li).then(function(){jt.instance=jt.drawingmanager=new BMapGLLib.DrawingManager(ot,Ie),It.registerEvents(jt,jt.getInstance(jt),se),It.toggleMethods(jt,jt.getInstance(jt),vt)})}}},$t.prototype.render=function(){return Pt.default.createElement("div",{className:"react-bmapgl-drawingmanager",ref:this.el,style:this.props.style})},$t.contextType=ue.MapContext,$t}(ee.Component);_t.defaultProps={isOpen:!1,enableDrawingTool:!0,enableCalculate:!1,enableSorption:!1,enableGpc:!1,enableLimit:!1,sorptionDistance:20,limitOptions:{area:5e7,distance:3e4},drawingToolOptions:{},style:{position:"absolute",left:0,top:0,width:360}},Yt.default=It.default(_t,se,vt)},9343:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.MapContext=void 0;var ie=Dt(59312),Pt=ie.__importDefault(Dt(67294)),ee=Dt(26571),zt=ie.__importDefault(Dt(22665)),It=ie.__importDefault(Dt(74445)),ue=ie.__importDefault(Dt(6162)),se=["click","dblclick","rightclick","rightdblclick","maptypechange","mousemove","mouseover","mouseout","movestart","moving","moveend","zoomstart","zoomend","addoverlay","addcontrol","removecontrol","removeoverlay","clearoverlays","dragstart","dragging","dragend","addtilelayer","removetilelayer","load","resize","hotspotclick","hotspotover","hotspotout","tilesloaded","touchstart","touchmove","touchend","longpress"],vt={enableScrollWheelZoom:["enableScrollWheelZoom","disableScrollWheelZoom"],enableDragging:["enableDragging","disableDragging"],enableDoubleClickZoom:["enableDoubleClickZoom","disableDoubleClickZoom"],enableKeyboard:["enableKeyboard","disableKeyboard"],enableInertialDragging:["enableInertialDragging","disableInertialDragging"],enableContinuousZoom:["enableContinuousZoom","disableContinuousZoom"],enablePinchToZoom:["enablePinchToZoom","disablePinchToZoom"],enableRotate:["enableRotate","disableRotate"],enableTilt:["enableTilt","disableTilt"],enableAutoResize:["enableAutoResize","disableAutoResize"]};Yt.MapContext=Pt.default.createContext({map:void 0});var Ot=function(_t){ie.__extends(Ft,_t);function Ft($t){var jt=_t.call(this,$t)||this;return jt.el=Pt.default.createRef(),jt.options=["minZoom","maxZoom","mapType","backgroundColor","displayOptions"],jt}return Ft.prototype.componentDidMount=function(){this.initialize(),this.forceUpdate()},Ft.prototype.componentDidUpdate=function($t){var jt=$t.center,ot=$t.zoom,Ie=this.props,Mr=Ie.center,Lr=Ie.zoom,Ee=!!Mr&&!It.default(jt,Mr),Yr=!!(Lr&&!It.default(ot,Lr)),li;if(ue.default(Mr))li=Mr;else{var hi=Mr,Bi=hi.lng,fn=hi.lat;li=new BMapGL.Point(Bi,fn)}Ee&&Yr?this.map.centerAndZoom(li,Lr):Ee?this.map.setCenter(li):Yr&&this.map.setZoom(Lr)},Ft.prototype.componentWillUnmount=function(){this.map&&this.map.destroy()},Ft.prototype.initialize=function(){if(!this.map){var $t=Object.assign({},this.props.defaultOptions,this.getOptions());$t.mapType&&($t.mapType=$t.mapType==="normal"?BMAP_NORMAL_MAP:$t.mapType,$t.mapType=$t.mapType==="earth"?BMAP_EARTH_MAP:$t.mapType),this.props.mapStyleV2&&($t.style=this.props.mapStyleV2);var jt=new BMapGL.Map(this.el.current,$t);if(this.map=jt,this.instance=jt,ue.default(this.props.center))jt.centerAndZoom(this.props.center,this.props.zoom);else{var ot=this.props.center,Ie=ot.lng,Mr=ot.lat,Lr=new BMapGL.Point(Ie,Mr);jt.centerAndZoom(Lr,this.props.zoom)}this.props.heading&&jt.setHeading(this.props.heading),this.props.tilt&&jt.setTilt(this.props.tilt)}},Ft.prototype.renderChildren=function($t,jt){var ot=this;if(!(!$t||!jt))return Pt.default.Children.map($t,function(Ie){return Ie?typeof Ie.type=="string"||!Ie.props?Ie:Pt.default.cloneElement(Ie,{map:jt},ot.renderChildren(Ie.props.children,jt)):null})},Ft.prototype.render=function(){return Pt.default.createElement("div",{style:this.props.style},Pt.default.createElement("div",{ref:this.el,className:this.props.className,style:{height:"100%"}},"\u52A0\u8F7D\u5730\u56FE\u4E2D..."),Pt.default.createElement(Yt.MapContext.Provider,{value:{map:this.map}},this.renderChildren(this.props.children,this.map)))},Ft}(ee.Component);Ot.defaultProps={center:{lng:116.404449,lat:39.914889},zoom:12,defaultOptions:{},style:{position:"relative",height:"360px"}},Yt.default=zt.default(Ot,se,vt);var Lt=Dt(27722);Object.defineProperty(Yt,"MapApiLoaderHOC",{enumerable:!0,get:function(){return Lt.default}})},27722:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importStar(Dt(67294)),ee=ie.__importDefault(Dt(12085));Yt.default=function(zt){return function(It){var ue;return ue=function(se){ie.__extends(vt,se);function vt(Ot){var Lt=se.call(this,Ot)||this;return Lt.state={loaded:Lt.isLoadReady()},Lt.loadJSAPI=Lt.loadJSAPI.bind(Lt),Lt.handleLoaded=Lt.handleLoaded.bind(Lt),Lt}return vt.prototype.isLoadReady=function(){return!!(window.BMapGL&&window.BMapGL.Map)},vt.prototype.componentDidMount=function(){if(!this.isLoadReady()){if(!zt.ak)throw new TypeError("MapApiLoaderHOC: ak is required");this.loadJSAPI()}},vt.prototype.componentWillUnmount=function(){this.apiTimer&&clearTimeout(this.apiTimer),this.loadedTimer&&clearTimeout(this.loadedTimer)},vt.prototype.loadJSAPI=function(){var Ot=this;if(this.isLoadReady()){this.handleLoaded();return}if(window.loadingMap)this.apiTimer=window.setTimeout(function(){Ot.loadJSAPI()},300);else if(!window.MapApiLoaderCallback){window.loadingMap=!0,window.MapApiLoaderCallback=function(){delete window.loadingMap,delete window.MapApiLoaderCallback};var Lt=zt.ak,_t=document.createElement("script");_t.type="text/javascript",_t.src="//api.map.baidu.com/api?type=webgl&v=1.0&ak="+Lt+"&callback=MapApiLoaderCallback",document.body.appendChild(_t),this.loadedTimer=window.setTimeout(function(){Ot.handleLoaded()},300)}},vt.prototype.handleLoaded=function(){var Ot=this;if(!this.isLoadReady()){this.loadedTimer=window.setTimeout(function(){Ot.handleLoaded()},300);return}this.setState({loaded:!0})},vt.prototype.render=function(){var Ot=this.state.loaded;return Ot?Pt.default.createElement(It,ie.__assign({},this.props)):Pt.default.createElement("div",null,"loading...")},vt}(Pt.Component),ue.displayName="MapApiLoaderHOC("+ee.default(It)+")",ue}}},96604:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(29116)),ee=ie.__importDefault(Dt(74445)),zt=function(It){ie.__extends(ue,It);function ue(se){var vt=It.call(this,se)||this;return vt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],vt}return ue.prototype.onDataUpdate=function(se){var vt=this.props,Ot=vt.center,Lt=vt.radius,_t=vt.autoViewport,Ft=se.center,$t=se.radius,jt=se.autoViewport,ot=Ot&&!ee.default(Ot,Ft),Ie=!!(Lt&&!ee.default(Lt,$t)),Mr=!ee.default(_t,jt);if(ot&&this.overlay.setCenter(this.parseCenter(Ot)),Ie&&this.overlay.setRadius(Lt),_t&&(ot||Ie||Mr)){var Lr=this.overlay.getBounds(),Ee=this.props.map.getViewport(Lr,this.props.viewportOptions||{});this.props.map.setViewport(Ee)}},ue.prototype.getOverlay=function(){var se=this.props,vt=se.center,Ot=se.radius;return new BMapGL.Circle(this.parseCenter(vt),Ot,this.getOptions())},ue.prototype.parseCenter=function(se){var vt=this.props.coordType==="bd09mc",Ot;return se instanceof Array?Ot=new BMapGL.Point(se[0],se[1]):se instanceof BMapGL.Point?Ot=se:Ot=new BMapGL.Point(se.lng,se.lat),vt&&(Ot=BMapGL.Projection.convertMC2LL(Ot)),Ot},ue.prototype.render=function(){return null},ue}(Pt.default);Yt.default=zt},72782:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(74445)),zt=ie.__importDefault(Dt(22172)),It=Dt(9343),ue=function(se){ie.__extends(vt,se);function vt(Ot){var Lt=se.call(this,Ot)||this;return Lt.options=["zIndex","offset","unit"],Lt}return vt.prototype.componentDidUpdate=function(Ot){ee.default(this.props,Ot)||this.initialize()},vt.prototype.componentDidMount=function(){this.initialize()},vt.prototype.componentWillUnmount=function(){this.destroy()},vt.prototype.destroy=function(){this.overlay&&this.map&&(this.overlay.destroy(),this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},vt.prototype.initialize=function(){var Ot=this.map=this.getMap();if(Ot){this.destroy();var Lt=this.getOptions();Lt.html=this.props.children;var _t=this.parsePosition(this.props.position);this.instance=this.overlay=new zt.default(_t,Lt),Ot.addOverlay(this.overlay),this.props.autoViewport&&Ot.setCenter(_t)}},vt.prototype.parsePosition=function(Ot){var Lt=this.props.coordType==="bd09mc",_t;return Ot instanceof Array?_t=new BMapGL.Point(Ot[0],Ot[1]):Ot instanceof BMapGL.Point?_t=Ot:_t=new BMapGL.Point(Ot.lng,Ot.lat),Lt&&(_t=BMapGL.Projection.convertMC2LL(_t)),_t},vt.prototype.render=function(){return null},vt.contextType=It.MapContext,vt}(Pt.Component);Yt.default=ue},22172:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(73935);function Pt(ee,zt){this._point=new BMapGL.Point(ee.lng,ee.lat),this._options=zt||{},this._html=zt.html||"";var It=new BMapGL.Overlay;for(var ue in It)ue!=="initialize"&&ue!=="draw"&&ue!=="destroy"&&(this.__proto__[ue]=It[ue])}Pt.prototype.initialize=function(ee){return this._map=ee,this._div=document.createElement("div"),this._div.style.position="absolute",this._div.style.zIndex=this._options.zIndex||BMapGL.Overlay.getZIndex(this._point.lat),ie.render(this._html,this._div),this._div.onmousedown=function(zt){return zt=zt||window.event,zt.preventDefault?zt.preventDefault():zt.returnValue=!1,!1},ee.getPanes().floatShadow.appendChild(this._div),this._div},Pt.prototype.destroy=function(){ie.unmountComponentAtNode(this._div)},Pt.prototype.draw=function(){var ee=this._map,zt=ee.pointToOverlayPixel(this._point),It={width:0,height:0};this._options&&this._options.offset&&(It=this._options.offset);var ue=It.width,se=It.height;this._options&&this._options.unit&&this._options.unit==="m"&&(ue/=ee.getZoomUnits(),se/=ee.getZoomUnits()),this._div.style.left=zt.x+ue+"px",this._div.style.top=zt.y+se+"px",this._div.style.transform="translate(-50%, -100%)"},Yt.default=Pt},29116:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(22665)),zt=ie.__importDefault(Dt(74445)),It=Dt(9343),ue=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove","lineupdate"],se={enableMassClear:["enableMassClear","disableMassClear"],enableEditing:["enableEditing","disableEditing"]},vt=function(Ot){ie.__extends(Lt,Ot);function Lt(_t){var Ft=Ot.call(this,_t)||this;return Ft.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing","enableClicking"],Ft}return Lt.prototype.componentDidUpdate=function(_t){var Ft=this.props,$t=Ft.strokeColor,jt=Ft.strokeWeight,ot=Ft.strokeOpacity,Ie=Ft.strokeStyle,Mr=Ft.fillColor,Lr=Ft.fillOpacity,Ee=_t.strokeColor,Yr=_t.strokeWeight,li=_t.strokeOpacity,hi=_t.strokeStyle,Bi=_t.fillColor,fn=_t.fillOpacity,_i=!zt.default($t,Ee),Ci=!zt.default(jt,Yr),Vt=!zt.default(ot,li),Re=!zt.default(Ie,hi),_e=!zt.default(Mr,Bi),ze=!zt.default(Lr,fn);(_i||Ci||Vt||Re||_e||ze)&&this.overlay.setOptions(this.getOptions()),this.onDataUpdate(_t)},Lt.prototype.componentDidMount=function(){this.initialize()},Lt.prototype.componentWillUnmount=function(){this.destroy()},Lt.prototype.destroy=function(){this.overlay&&(this.map.removeOverlay(this.overlay),this.instance=this.overlay=void 0)},Lt.prototype.initialize=function(){var _t=this.map=this.getMap();if(_t){this.destroy(),this.instance=this.overlay=this.getOverlay(),_t.addOverlay(this.overlay);var Ft;if(this.overlay instanceof BMapGL.Polyline||this.overlay instanceof BMapGL.Polygon){var $t=this.overlay.getPath();Ft=_t.getViewport($t,this.props.viewportOptions||{})}else if(this.overlay instanceof BMapGL.Circle){var jt=this.overlay.getBounds();Ft=_t.getViewport(jt,this.props.viewportOptions||{})}Ft&&this.props.autoViewport&&_t.setViewport(Ft)}},Lt.prototype.getOverlay=function(){throw new Error("Method getOverlay not implemented.")},Lt.prototype.onDataUpdate=function(_t){throw new Error("Method onDataUpdate not implemented.")},Lt.contextType=It.MapContext,Lt}(Pt.Component);Yt.default=ee.default(vt,ue,se)},97398:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(22665)),zt=Dt(73935),It=Dt(9343),ue=["close","open","maximize","restore","clickclose"],se={enableMaximize:["enableMaximize","disableMaximize"],enableAutoPan:["enableAutoPan","disableAutoPan"],enableCloseOnClick:["enableCloseOnClick","disableCloseOnClick"]},vt=function(Ot){ie.__extends(Lt,Ot);function Lt(_t){var Ft=Ot.call(this,_t)||this;return Ft.options=["width","height","maxWidth","offset","title","enableMassClear"],Ft}return Lt.prototype.componentDidUpdate=function(_t){this.initialize()},Lt.prototype.componentDidMount=function(){this.initialize()},Lt.prototype.componentWillUnmount=function(){this.destroy()},Lt.prototype.destroy=function(){this.content&&zt.unmountComponentAtNode(this.content),this.infoWindow&&(this.map.closeInfoWindow(),this.instance=this.infoWindow=void 0)},Lt.prototype.initialize=function(){var _t=this.map=this.getMap();if(_t){this.destroy();var Ft=this.getOptions(),$t=this.parsePosition(this.props.position);if(this.instance=this.infoWindow=new BMapGL.InfoWindow(this.props.text||"",Ft),_t.openInfoWindow(this.infoWindow,$t),this.props.children!==void 0){var jt=this.content=document.createElement("div");zt.render(this.props.children,jt),this.infoWindow.setContent(jt)}}},Lt.prototype.parsePosition=function(_t){var Ft=this.props.coordType==="bd09mc",$t;return _t instanceof Array?$t=new BMapGL.Point(_t[0],_t[1]):_t instanceof BMapGL.Point?$t=_t:$t=new BMapGL.Point(_t.lng,_t.lat),Ft&&($t=BMapGL.Projection.convertMC2LL($t)),$t},Lt.prototype.render=function(){return null},Lt.contextType=It.MapContext,Lt}(Pt.Component);vt.defaultProps={},Yt.default=ee.default(vt,ue,se)},20259:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(22665)),zt=ie.__importDefault(Dt(74445)),It=Dt(9343),ue=["click","dblclick","rightclick","mousedown","mouseup","mouseout","mouseover","mousemove","remove"],se={enableMassClear:["enableMassClear","disableMassClear"]},vt=function(Ot){ie.__extends(Lt,Ot);function Lt(_t){var Ft=Ot.call(this,_t)||this;return Ft.options=["position","offset","enableMassClear"],Ft}return Lt.prototype.componentDidUpdate=function(_t){var Ft=this.props,$t=Ft.position,jt=Ft.offset,ot=Ft.text,Ie=Ft.style,Mr=_t.position,Lr=_t.offset,Ee=_t.text,Yr=_t.style,li=$t&&!zt.default($t,Mr),hi=!!(jt&&!zt.default(jt,Lr)),Bi=!zt.default(ot,Ee),fn=!!(Ie&&!zt.default(Ie,Yr)),_i=this.parsePosition($t);li&&this.label.setPosition(_i),hi&&this.label.setOffset(jt),Bi&&this.label.setContent(ot),fn&&this.label.setStyle(Ie)},Lt.prototype.componentDidMount=function(){this.initialize()},Lt.prototype.componentWillUnmount=function(){this.destroy()},Lt.prototype.destroy=function(){this.label&&(this.map.removeOverlay(this.label),this.instance=this.label=void 0)},Lt.prototype.initialize=function(){var _t=this.map=this.getMap();if(_t){this.destroy();var Ft=this.getOptions(),$t=this.parsePosition(this.props.position);Ft.position=$t,this.instance=this.label=new BMapGL.Label(this.props.text||"",Ft),_t.addOverlay(this.label),this.props.style&&this.label.setStyle(this.props.style)}},Lt.prototype.parsePosition=function(_t){var Ft=this.props.coordType==="bd09mc",$t;return _t instanceof Array?$t=new BMapGL.Point(_t[0],_t[1]):_t instanceof BMapGL.Point?$t=_t:$t=new BMapGL.Point(_t.lng,_t.lat),Ft&&($t=BMapGL.Projection.convertMC2LL($t)),$t},Lt.prototype.render=function(){return null},Lt.contextType=It.MapContext,Lt}(Pt.Component);vt.defaultProps={style:{color:"red"}},Yt.default=ee.default(vt,ue,se)},14923:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(26571),ee=ie.__importDefault(Dt(22665)),zt=ie.__importDefault(Dt(74445)),It=Dt(9343);function ue(){for(var Lt="//mapopen.bj.bcebos.com/cms/react-bmap/markers_new2x_fbb9e99.png",_t={simple_red:new BMapGL.Icon(Lt,new BMapGL.Size(21,33),{imageOffset:new BMapGL.Size(227,189),imageSize:new BMapGL.Size(300,300)}),simple_blue:new BMapGL.Icon(Lt,new BMapGL.Size(21,33),{imageOffset:new BMapGL.Size(227,225),imageSize:new BMapGL.Size(300,300)}),loc_red:new BMapGL.Icon(Lt,new BMapGL.Size(23,35),{imageOffset:new BMapGL.Size(200,189),imageSize:new BMapGL.Size(300,300)}),loc_blue:new BMapGL.Icon(Lt,new BMapGL.Size(23,35),{imageOffset:new BMapGL.Size(200,225),imageSize:new BMapGL.Size(300,300)}),start:new BMapGL.Icon(Lt,new BMapGL.Size(25,40),{imageOffset:new BMapGL.Size(200,139),imageSize:new BMapGL.Size(300,300)}),end:new BMapGL.Icon(Lt,new BMapGL.Size(25,40),{imageOffset:new BMapGL.Size(225,139),imageSize:new BMapGL.Size(300,300)}),location:new BMapGL.Icon(Lt,new BMapGL.Size(14,20),{imageOffset:new BMapGL.Size(124,233),imageSize:new BMapGL.Size(300,300)})},Ft=1;Ft<=10;Ft++)_t["red"+Ft]=new BMapGL.Icon(Lt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(Ft-1),0),imageSize:new BMapGL.Size(600/2,600/2)});for(var Ft=1;Ft<=10;Ft++)_t["blue"+Ft]=new BMapGL.Icon(Lt,new BMapGL.Size(42/2,66/2),{imageOffset:new BMapGL.Size(42/2*(Ft-1),132/2),imageSize:new BMapGL.Size(600/2,600/2)});return _t}var se=["click","dblclick","mousedown","mouseup","mouseout","mouseover","remove","infowindowclose","infowindowopen","dragstart","dragging","dragend","rightclick"],vt={enableMassClear:["enableMassClear","disableMassClear"],enableDragging:["enableDragging","disableDragging"]},Ot=function(Lt){ie.__extends(_t,Lt);function _t(Ft){var $t=Lt.call(this,Ft)||this;return $t.options=["offset","icon","enableMassClear","enableDragging","enableClicking","raiseOnDrag","draggingCursor","rotation","title"],$t.defaultIcons=ue(),$t}return _t.prototype.componentDidUpdate=function(Ft){if(!this.map){this.initialize();return}var $t=this.props,jt=$t.position,ot=$t.icon,Ie=$t.autoViewport,Mr=$t.offset,Lr=$t.isTop,Ee=Ft.position,Yr=Ft.icon,li=Ft.autoViewport,hi=Ft.offset,Bi=Ft.isTop,fn=jt&&!zt.default(jt,Ee),_i=!!(ot&&!zt.default(ot,Yr)),Ci=!zt.default(Ie,li),Vt=!!(Mr&&!zt.default(Mr,hi)),Re=!zt.default(Lr,Bi),_e=this.parsePosition(jt);if(fn&&this.marker.setPosition(_e),_i){var ze=this.parseIcon(ot);this.marker.setIcon(ze)}Vt&&this.marker.setOffset(Mr),Re&&this.marker.setTop(!!Lr),Ie&&(fn||Ci)&&this.map.setCenter(_e)},_t.prototype.componentDidMount=function(){this.initialize()},_t.prototype.componentWillUnmount=function(){this.destroy()},_t.prototype.destroy=function(){this.marker&&this.map&&(this.map.removeOverlay(this.marker),this.instance=this.marker=void 0)},_t.prototype.initialize=function(){var Ft=this.map=this.getMap();if(Ft){this.destroy();var $t=this.parseIcon(this.props.icon),jt=this.parsePosition(this.props.position),ot=this.getOptions();ot.icon=$t,this.instance=this.marker=new BMapGL.Marker(jt,ot),this.props.isTop&&this.marker.setTop(!0),Ft.addOverlay(this.marker),this.props.autoViewport&&Ft.setCenter(jt)}},_t.prototype.parsePosition=function(Ft){var $t=this.props.coordType==="bd09mc",jt;return Ft instanceof Array?jt=new BMapGL.Point(Ft[0],Ft[1]):Ft instanceof BMapGL.Point?jt=Ft:jt=new BMapGL.Point(Ft.lng,Ft.lat),$t&&(jt=BMapGL.Projection.convertMC2LL(jt)),jt},_t.prototype.parseIcon=function(Ft){var $t;return Ft&&Ft instanceof BMapGL.Icon?$t=Ft:Ft&&this.defaultIcons[Ft]?$t=this.defaultIcons[Ft]:$t=this.defaultIcons.simple_red,$t},_t.prototype.render=function(){return null},_t.contextType=It.MapContext,_t}(Pt.Component);Ot.defaultProps={icon:"simple_red"},Yt.default=ee.default(Ot,se,vt)},65585:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(29116)),ee=ie.__importDefault(Dt(74445)),zt=function(It){ie.__extends(ue,It);function ue(se){var vt=It.call(this,se)||this;return vt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","fillColor","fillOpacity","enableMassClear","enableEditing"],vt}return ue.prototype.onDataUpdate=function(se){var vt=this.props,Ot=vt.path,Lt=vt.autoViewport,_t=se.path,Ft=se.autoViewport,$t=Ot&&!ee.default(Ot,_t),jt=!ee.default(Lt,Ft);if($t&&this.overlay.setPath(this.parsePath(Ot)),Lt&&($t||jt)){var ot=this.overlay.getPath(),Ie=this.props.map.getViewport(ot,this.props.viewportOptions||{});this.props.map.setViewport(Ie)}},ue.prototype.getOverlay=function(){var se=this.parsePath(this.props.path);return new BMapGL.Polygon(se,this.getOptions())},ue.prototype.parsePath=function(se){var vt=this.props.coordType==="bd09mc",Ot=se.map(function(Lt){var _t;return Lt instanceof Array?_t=new BMapGL.Point(Lt[0],Lt[1]):Lt instanceof BMapGL.Point?_t=Lt:_t=new BMapGL.Point(Lt.lng,Lt.lat),vt&&(_t=BMapGL.Projection.convertMC2LL(_t)),_t});return Ot},ue.prototype.render=function(){return null},ue}(Pt.default);Yt.default=zt},97619:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importDefault(Dt(29116)),ee=ie.__importDefault(Dt(74445)),zt=function(It){ie.__extends(ue,It);function ue(se){var vt=It.call(this,se)||this;return vt.options=["strokeColor","strokeWeight","strokeOpacity","strokeStyle","dashArray","enableMassClear","enableEditing"],vt}return ue.prototype.onDataUpdate=function(se){var vt=this.props,Ot=vt.path,Lt=vt.autoViewport,_t=se.path,Ft=se.autoViewport,$t=Ot&&!ee.default(Ot,_t),jt=!ee.default(Lt,Ft);if($t&&this.overlay.setPath(this.parsePath(Ot)),Lt&&($t||jt)){var ot=this.overlay.getPath(),Ie=this.props.map.getViewport(ot,this.props.viewportOptions||{});this.props.map.setViewport(Ie)}},ue.prototype.getOverlay=function(){var se=this.parsePath(this.props.path);return new BMapGL.Polyline(se,this.getOptions())},ue.prototype.parsePath=function(se){var vt=this.props.coordType==="bd09mc",Ot=se.map(function(Lt){var _t;return Lt instanceof Array?_t=new BMapGL.Point(Lt[0],Lt[1]):Lt instanceof BMapGL.Point?_t=Lt:_t=new BMapGL.Point(Lt.lng,Lt.lat),vt&&(_t=BMapGL.Projection.convertMC2LL(_t)),_t});return Ot},ue.prototype.render=function(){return null},ue}(Pt.default);Yt.default=zt},33872:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=ie.__importStar(Dt(67294)),ee=Dt(26571),zt=ie.__importDefault(Dt(22665)),It=["confirm","highlight"],ue={},se=function(vt){ie.__extends(Ot,vt);function Ot(Lt){var _t=vt.call(this,Lt)||this;return _t.el=Pt.default.createRef(),_t.options=["location","onSearchComplete","input","types"],_t}return Ot.prototype.componentDidMount=function(){this.initialize()},Ot.prototype.componentWillUnmount=function(){this.destroy()},Ot.prototype.destroy=function(){this.ac&&(this.ac.dispose(),this.instance=this.ac=void 0)},Ot.prototype.initialize=function(){this.destroy();var Lt=this.getOptions();Lt.input||(Lt.input=this.el.current),this.ac=this.instance=new BMapGL.Autocomplete(Lt)},Ot.prototype.render=function(){return Pt.default.createElement(Pt.Fragment,null,!this.props.input&&Pt.default.createElement("input",{className:"react-bmapgl-autocomplete",ref:this.el,style:this.props.style}))},Ot}(ee.Component);se.defaultProps={},Yt.default=zt.default(se,It,ue)},28938:function(){"use strict";window._hmt_private||(window._hmt=window._hmt||[],function(){var er=document.createElement("script");er.src="https://hm.baidu.com/hm.js?b97569d26a525941d8d163729d284198";var Yt=document.getElementsByTagName("script")[0];Yt.parentNode.insertBefore(er,Yt)}())},74362:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312),Pt=Dt(67294),ee=function(zt){ie.__extends(It,zt);function It(){var ue=zt!==null&&zt.apply(this,arguments)||this;return ue.options=[],ue}return It.prototype.getMap=function(){return this.props.map||this.context.map},It.prototype.getInstance=function(ue){return ue.instance},It.prototype.getOptions=function(ue){ue===void 0&&(ue=this.props);var se={};return this.options.map(function(vt){ue[vt]!==void 0&&(se[vt]=ue[vt])}),se},It}(Pt.PureComponent);Yt.default=ee},22665:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.toggleMethods=Yt.unregisterEvents=Yt.registerEvents=void 0;var ie=Dt(59312),Pt=ie.__importDefault(Dt(74445));function ee(Ot,Lt,_t){_t&&Lt&&Lt.addEventListener&&(Ot.registeredEvents={},_t.forEach(function(Ft){var $t="on"+Ft.substr(0,1).toUpperCase()+Ft.substr(1);Ot.props[$t]&&typeof Ot.props[$t]=="function"&&(Lt.addEventListener(Ft,Ot.props[$t]),Ot.registeredEvents[Ft]=Ot.props[$t])}))}Yt.registerEvents=ee;function zt(Ot,Lt){Ot.registeredEvents&&Lt&&Lt.removeEventListener&&(Object.keys(Ot.registeredEvents).forEach(function(_t){Lt.removeEventListener(_t,Ot.registeredEvents[_t])}),Ot.registeredEvents=null)}Yt.unregisterEvents=zt;function It(Ot,Lt,_t,Ft){_t&&Lt&&Object.keys(_t).forEach(function($t){(Ft===void 0&&Ot.props[$t]!==void 0||Ft!==void 0&&!Pt.default(Ot.props[$t],Ft[$t]))&&(Ot.props[$t]?Lt&&Lt[_t[$t][0]]():Lt&&Lt[_t[$t][1]]())})}Yt.toggleMethods=It;function ue(Ot,Lt){var _t=Ot.prototype.getInstance,Ft=Ot.prototype.componentDidMount,$t=Ot.prototype.componentDidUpdate;return _t&&Lt&&Object.keys(Lt).length>0&&(Ot.prototype.componentDidMount=function(){Ft&&Ft.call(this),It(this,_t(this),Lt)},Ot.prototype.componentDidUpdate=function(jt,ot){It(this,_t(this),Lt,jt),$t&&$t.call(this,jt,ot)}),Ot}function se(Ot,Lt){var _t=Ot.prototype.getInstance,Ft=Ot.prototype.componentDidUpdate,$t=Ot.prototype.componentDidMount,jt=Ot.prototype.componentWillUnmount;return Lt&&Lt.length>0&&(Ot.prototype.componentDidMount=function(){$t&&$t.call(this),ee(this,_t(this),Lt)},Ot.prototype.componentDidUpdate=function(ot,Ie){Pt.default(this.props,ot)||zt(this,_t(this)),Ft&&Ft.call(this,ot,Ie),Pt.default(this.props,ot)||ee(this,_t(this),Lt)},Ot.prototype.componentWillUnmount=function(){zt(this,_t(this)),jt&&jt.call(this)}),Ot}function vt(Ot,Lt,_t){var Ft=ue(Ot,_t);return Ft=se(Ft,Lt),Ft}Yt.default=vt},26571:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(22665);Object.defineProperty(Yt,"Wrapper",{enumerable:!0,get:function(){return ie.default}});var Pt=Dt(74362);Object.defineProperty(Yt,"Component",{enumerable:!0,get:function(){return Pt.default}})},49550:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312);Dt(28938);var Pt=Dt(9343);Object.defineProperty(Yt,"Map",{enumerable:!0,get:function(){return Pt.default}});var ee=Dt(27722);Object.defineProperty(Yt,"MapApiLoaderHOC",{enumerable:!0,get:function(){return ee.default}});var zt=Dt(84159);Object.defineProperty(Yt,"MapTypeControl",{enumerable:!0,get:function(){return zt.default}});var It=Dt(86635);Object.defineProperty(Yt,"ScaleControl",{enumerable:!0,get:function(){return It.default}});var ue=Dt(66873);Object.defineProperty(Yt,"ZoomControl",{enumerable:!0,get:function(){return ue.default}});var se=Dt(59813);Object.defineProperty(Yt,"NavigationControl",{enumerable:!0,get:function(){return se.default}});var vt=Dt(52366);Object.defineProperty(Yt,"CityListControl",{enumerable:!0,get:function(){return vt.default}});var Ot=Dt(14923);Object.defineProperty(Yt,"Marker",{enumerable:!0,get:function(){return Ot.default}});var Lt=Dt(97619);Object.defineProperty(Yt,"Polyline",{enumerable:!0,get:function(){return Lt.default}});var _t=Dt(65585);Object.defineProperty(Yt,"Polygon",{enumerable:!0,get:function(){return _t.default}});var Ft=Dt(96604);Object.defineProperty(Yt,"Circle",{enumerable:!0,get:function(){return Ft.default}});var $t=Dt(97398);Object.defineProperty(Yt,"InfoWindow",{enumerable:!0,get:function(){return $t.default}});var jt=Dt(20259);Object.defineProperty(Yt,"Label",{enumerable:!0,get:function(){return jt.default}});var ot=Dt(72782);Object.defineProperty(Yt,"CustomOverlay",{enumerable:!0,get:function(){return ot.default}});var Ie=Dt(26505);Object.defineProperty(Yt,"MapvglView",{enumerable:!0,get:function(){return Ie.default}});var Mr=Dt(96205);Object.defineProperty(Yt,"MapvglLayer",{enumerable:!0,get:function(){return Mr.default}});var Lr=Dt(81776);Object.defineProperty(Yt,"TrafficLayer",{enumerable:!0,get:function(){return Lr.default}});var Ee=Dt(90301);Object.defineProperty(Yt,"PanoramaLayer",{enumerable:!0,get:function(){return Ee.default}});var Yr=Dt(46716);Object.defineProperty(Yt,"DrawingManager",{enumerable:!0,get:function(){return Yr.default}});var li=Dt(37972);Object.defineProperty(Yt,"DistanceTool",{enumerable:!0,get:function(){return li.default}});var hi=Dt(33872);Object.defineProperty(Yt,"AutoComplete",{enumerable:!0,get:function(){return hi.default}});var Bi=Dt(28444);Object.defineProperty(Yt,"Arc",{enumerable:!0,get:function(){return Bi.default}}),Yt.mapvgl=ie.__importStar(Dt(66996)),ie.__exportStar(Dt(73321),Yt)},12085:function(er,Yt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});function Dt(ie){if(typeof ie=="string")return ie;if(ie)return ie.displayName||ie.name||"Component"}Yt.default=Dt},73321:function(er,Yt,Dt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});var ie=Dt(59312);ie.__exportStar(Dt(5939),Yt);var Pt=Dt(6162);Object.defineProperty(Yt,"isString",{enumerable:!0,get:function(){return Pt.default}});var ee=Dt(12085);Object.defineProperty(Yt,"getDisplayName",{enumerable:!0,get:function(){return ee.default}})},6162:function(er,Yt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0});function Dt(ie){return Object.prototype.toString.call(ie)==="[object String]"}Yt.default=Dt},5939:function(er,Yt){"use strict";Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.requireScript=Yt.requireCss=void 0;var Dt=document.head||document.getElementsByTagName("head")[0],ie={};function Pt(It){return new Promise(function(ue,se){if(It in ie){ue();return}var vt=document.createElement("link");vt.type="text/css",vt.rel="stylesheet",vt.href=It,vt.onerror=function(Ot){Dt.removeChild(vt),se(new URIError("The css "+It+" is no accessible."))},vt.onload=function(){ie[It]=!0,ue()},Dt.appendChild(vt)})}Yt.requireCss=Pt;function ee(It){return new Promise(function(ue,se){if(It in ie){ue();return}var vt=document.createElement("script");vt.type="text/javascript",vt.src=It,vt.onerror=function(Ot){Dt.removeChild(vt),se(new URIError("The Script "+It+" is no accessible."))},zt(vt)?vt.onload=function(){ie[It]=!0,ue()}:vt.onreadystatechange=function(){(vt.readyState=="loaded"||vt.readyState=="complete")&&(vt.onreadystatechange=null,ie[It]=!0,ue())},Dt.appendChild(vt)})}Yt.requireScript=ee;function zt(It){return It=It||document.createElement("script"),"onload"in It?!0:(It.setAttribute("onload",""),typeof It.onload=="function")}},74445:function(er){er.exports=function(Dt,ie,Pt,ee){var zt=Pt?Pt.call(ee,Dt,ie):void 0;if(zt!==void 0)return!!zt;if(Dt===ie)return!0;if(typeof Dt!="object"||!Dt||typeof ie!="object"||!ie)return!1;var It=Object.keys(Dt),ue=Object.keys(ie);if(It.length!==ue.length)return!1;for(var se=Object.prototype.hasOwnProperty.bind(ie),vt=0;vt<It.length;vt++){var Ot=It[vt];if(!se(Ot))return!1;var Lt=Dt[Ot],_t=ie[Ot];if(zt=Pt?Pt.call(ee,Lt,_t,Ot):void 0,zt===!1||zt===void 0&&Lt!==_t)return!1}return!0}},59312:function(er,Yt,Dt){"use strict";Dt.r(Yt),Dt.d(Yt,{__assign:function(){return ee},__asyncDelegator:function(){return Ee},__asyncGenerator:function(){return Lr},__asyncValues:function(){return Yr},__await:function(){return Mr},__awaiter:function(){return vt},__classPrivateFieldGet:function(){return _i},__classPrivateFieldSet:function(){return Ci},__createBinding:function(){return Lt},__decorate:function(){return It},__exportStar:function(){return _t},__extends:function(){return Pt},__generator:function(){return Ot},__importDefault:function(){return fn},__importStar:function(){return Bi},__makeTemplateObject:function(){return li},__metadata:function(){return se},__param:function(){return ue},__read:function(){return $t},__rest:function(){return zt},__spread:function(){return jt},__spreadArray:function(){return Ie},__spreadArrays:function(){return ot},__values:function(){return Ft}});var ie=function(Vt,Re){return ie=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_e,ze){_e.__proto__=ze}||function(_e,ze){for(var nr in ze)Object.prototype.hasOwnProperty.call(ze,nr)&&(_e[nr]=ze[nr])},ie(Vt,Re)};function Pt(Vt,Re){if(typeof Re!="function"&&Re!==null)throw new TypeError("Class extends value "+String(Re)+" is not a constructor or null");ie(Vt,Re);function _e(){this.constructor=Vt}Vt.prototype=Re===null?Object.create(Re):(_e.prototype=Re.prototype,new _e)}var ee=function(){return ee=Object.assign||function(Re){for(var _e,ze=1,nr=arguments.length;ze<nr;ze++){_e=arguments[ze];for(var de in _e)Object.prototype.hasOwnProperty.call(_e,de)&&(Re[de]=_e[de])}return Re},ee.apply(this,arguments)};function zt(Vt,Re){var _e={};for(var ze in Vt)Object.prototype.hasOwnProperty.call(Vt,ze)&&Re.indexOf(ze)<0&&(_e[ze]=Vt[ze]);if(Vt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var nr=0,ze=Object.getOwnPropertySymbols(Vt);nr<ze.length;nr++)Re.indexOf(ze[nr])<0&&Object.prototype.propertyIsEnumerable.call(Vt,ze[nr])&&(_e[ze[nr]]=Vt[ze[nr]]);return _e}function It(Vt,Re,_e,ze){var nr=arguments.length,de=nr<3?Re:ze===null?ze=Object.getOwnPropertyDescriptor(Re,_e):ze,Rr;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")de=Reflect.decorate(Vt,Re,_e,ze);else for(var He=Vt.length-1;He>=0;He--)(Rr=Vt[He])&&(de=(nr<3?Rr(de):nr>3?Rr(Re,_e,de):Rr(Re,_e))||de);return nr>3&&de&&Object.defineProperty(Re,_e,de),de}function ue(Vt,Re){return function(_e,ze){Re(_e,ze,Vt)}}function se(Vt,Re){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(Vt,Re)}function vt(Vt,Re,_e,ze){function nr(de){return de instanceof _e?de:new _e(function(Rr){Rr(de)})}return new(_e||(_e=Promise))(function(de,Rr){function He(Oi){try{Cr(ze.next(Oi))}catch(As){Rr(As)}}function Di(Oi){try{Cr(ze.throw(Oi))}catch(As){Rr(As)}}function Cr(Oi){Oi.done?de(Oi.value):nr(Oi.value).then(He,Di)}Cr((ze=ze.apply(Vt,Re||[])).next())})}function Ot(Vt,Re){var _e={label:0,sent:function(){if(de[0]&1)throw de[1];return de[1]},trys:[],ops:[]},ze,nr,de,Rr;return Rr={next:He(0),throw:He(1),return:He(2)},typeof Symbol=="function"&&(Rr[Symbol.iterator]=function(){return this}),Rr;function He(Cr){return function(Oi){return Di([Cr,Oi])}}function Di(Cr){if(ze)throw new TypeError("Generator is already executing.");for(;_e;)try{if(ze=1,nr&&(de=Cr[0]&2?nr.return:Cr[0]?nr.throw||((de=nr.return)&&de.call(nr),0):nr.next)&&!(de=de.call(nr,Cr[1])).done)return de;switch(nr=0,de&&(Cr=[Cr[0]&2,de.value]),Cr[0]){case 0:case 1:de=Cr;break;case 4:return _e.label++,{value:Cr[1],done:!1};case 5:_e.label++,nr=Cr[1],Cr=[0];continue;case 7:Cr=_e.ops.pop(),_e.trys.pop();continue;default:if(de=_e.trys,!(de=de.length>0&&de[de.length-1])&&(Cr[0]===6||Cr[0]===2)){_e=0;continue}if(Cr[0]===3&&(!de||Cr[1]>de[0]&&Cr[1]<de[3])){_e.label=Cr[1];break}if(Cr[0]===6&&_e.label<de[1]){_e.label=de[1],de=Cr;break}if(de&&_e.label<de[2]){_e.label=de[2],_e.ops.push(Cr);break}de[2]&&_e.ops.pop(),_e.trys.pop();continue}Cr=Re.call(Vt,_e)}catch(Oi){Cr=[6,Oi],nr=0}finally{ze=de=0}if(Cr[0]&5)throw Cr[1];return{value:Cr[0]?Cr[1]:void 0,done:!0}}}var Lt=Object.create?function(Vt,Re,_e,ze){ze===void 0&&(ze=_e),Object.defineProperty(Vt,ze,{enumerable:!0,get:function(){return Re[_e]}})}:function(Vt,Re,_e,ze){ze===void 0&&(ze=_e),Vt[ze]=Re[_e]};function _t(Vt,Re){for(var _e in Vt)_e!=="default"&&!Object.prototype.hasOwnProperty.call(Re,_e)&&Lt(Re,Vt,_e)}function Ft(Vt){var Re=typeof Symbol=="function"&&Symbol.iterator,_e=Re&&Vt[Re],ze=0;if(_e)return _e.call(Vt);if(Vt&&typeof Vt.length=="number")return{next:function(){return Vt&&ze>=Vt.length&&(Vt=void 0),{value:Vt&&Vt[ze++],done:!Vt}}};throw new TypeError(Re?"Object is not iterable.":"Symbol.iterator is not defined.")}function $t(Vt,Re){var _e=typeof Symbol=="function"&&Vt[Symbol.iterator];if(!_e)return Vt;var ze=_e.call(Vt),nr,de=[],Rr;try{for(;(Re===void 0||Re-- >0)&&!(nr=ze.next()).done;)de.push(nr.value)}catch(He){Rr={error:He}}finally{try{nr&&!nr.done&&(_e=ze.return)&&_e.call(ze)}finally{if(Rr)throw Rr.error}}return de}function jt(){for(var Vt=[],Re=0;Re<arguments.length;Re++)Vt=Vt.concat($t(arguments[Re]));return Vt}function ot(){for(var Vt=0,Re=0,_e=arguments.length;Re<_e;Re++)Vt+=arguments[Re].length;for(var ze=Array(Vt),nr=0,Re=0;Re<_e;Re++)for(var de=arguments[Re],Rr=0,He=de.length;Rr<He;Rr++,nr++)ze[nr]=de[Rr];return ze}function Ie(Vt,Re,_e){if(_e||arguments.length===2)for(var ze=0,nr=Re.length,de;ze<nr;ze++)(de||!(ze in Re))&&(de||(de=Array.prototype.slice.call(Re,0,ze)),de[ze]=Re[ze]);return Vt.concat(de||Re)}function Mr(Vt){return this instanceof Mr?(this.v=Vt,this):new Mr(Vt)}function Lr(Vt,Re,_e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ze=_e.apply(Vt,Re||[]),nr,de=[];return nr={},Rr("next"),Rr("throw"),Rr("return"),nr[Symbol.asyncIterator]=function(){return this},nr;function Rr(Vi){ze[Vi]&&(nr[Vi]=function(Ln){return new Promise(function(_s,Ge){de.push([Vi,Ln,_s,Ge])>1||He(Vi,Ln)})})}function He(Vi,Ln){try{Di(ze[Vi](Ln))}catch(_s){As(de[0][3],_s)}}function Di(Vi){Vi.value instanceof Mr?Promise.resolve(Vi.value.v).then(Cr,Oi):As(de[0][2],Vi)}function Cr(Vi){He("next",Vi)}function Oi(Vi){He("throw",Vi)}function As(Vi,Ln){Vi(Ln),de.shift(),de.length&&He(de[0][0],de[0][1])}}function Ee(Vt){var Re,_e;return Re={},ze("next"),ze("throw",function(nr){throw nr}),ze("return"),Re[Symbol.iterator]=function(){return this},Re;function ze(nr,de){Re[nr]=Vt[nr]?function(Rr){return(_e=!_e)?{value:Mr(Vt[nr](Rr)),done:nr==="return"}:de?de(Rr):Rr}:de}}function Yr(Vt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Re=Vt[Symbol.asyncIterator],_e;return Re?Re.call(Vt):(Vt=typeof Ft=="function"?Ft(Vt):Vt[Symbol.iterator](),_e={},ze("next"),ze("throw"),ze("return"),_e[Symbol.asyncIterator]=function(){return this},_e);function ze(de){_e[de]=Vt[de]&&function(Rr){return new Promise(function(He,Di){Rr=Vt[de](Rr),nr(He,Di,Rr.done,Rr.value)})}}function nr(de,Rr,He,Di){Promise.resolve(Di).then(function(Cr){de({value:Cr,done:He})},Rr)}}function li(Vt,Re){return Object.defineProperty?Object.defineProperty(Vt,"raw",{value:Re}):Vt.raw=Re,Vt}var hi=Object.create?function(Vt,Re){Object.defineProperty(Vt,"default",{enumerable:!0,value:Re})}:function(Vt,Re){Vt.default=Re};function Bi(Vt){if(Vt&&Vt.__esModule)return Vt;var Re={};if(Vt!=null)for(var _e in Vt)_e!=="default"&&Object.prototype.hasOwnProperty.call(Vt,_e)&&Lt(Re,Vt,_e);return hi(Re,Vt),Re}function fn(Vt){return Vt&&Vt.__esModule?Vt:{default:Vt}}function _i(Vt,Re,_e,ze){if(_e==="a"&&!ze)throw new TypeError("Private accessor was defined without a getter");if(typeof Re=="function"?Vt!==Re||!ze:!Re.has(Vt))throw new TypeError("Cannot read private member from an object whose class did not declare it");return _e==="m"?ze:_e==="a"?ze.call(Vt):ze?ze.value:Re.get(Vt)}function Ci(Vt,Re,_e,ze,nr){if(ze==="m")throw new TypeError("Private method is not writable");if(ze==="a"&&!nr)throw new TypeError("Private accessor was defined without a setter");if(typeof Re=="function"?Vt!==Re||!nr:!Re.has(Vt))throw new TypeError("Cannot write private member to an object whose class did not declare it");return ze==="a"?nr.call(Vt,_e):nr?nr.value=_e:Re.set(Vt,_e),_e}},98082:function(er,Yt,Dt){"use strict";var ie=Dt(67294),Pt=Dt(31808);Yt.Z=()=>{const[ee,zt]=ie.useState(!1);return ie.useEffect(()=>{zt((0,Pt.fk)())},[]),ee}},74443:function(er,Yt,Dt){"use strict";Dt.d(Yt,{Z:function(){return ue},c:function(){return ee}});var ie=Dt(67294),Pt=Dt(12641);const ee=["xxl","xl","lg","md","sm","xs"],zt=se=>({xs:`(max-width: ${se.screenXSMax}px)`,sm:`(min-width: ${se.screenSM}px)`,md:`(min-width: ${se.screenMD}px)`,lg:`(min-width: ${se.screenLG}px)`,xl:`(min-width: ${se.screenXL}px)`,xxl:`(min-width: ${se.screenXXL}px)`}),It=se=>{const vt=se,Ot=[].concat(ee).reverse();return Ot.forEach((Lt,_t)=>{const Ft=Lt.toUpperCase(),$t=`screen${Ft}Min`,jt=`screen${Ft}`;if(!(vt[$t]<=vt[jt]))throw new Error(`${$t}<=${jt} fails : !(${vt[$t]}<=${vt[jt]})`);if(_t<Ot.length-1){const ot=`screen${Ft}Max`;if(!(vt[jt]<=vt[ot]))throw new Error(`${jt}<=${ot} fails : !(${vt[jt]}<=${vt[ot]})`);const Mr=`screen${Ot[_t+1].toUpperCase()}Min`;if(!(vt[ot]<=vt[Mr]))throw new Error(`${ot}<=${Mr} fails : !(${vt[ot]}<=${vt[Mr]})`)}}),se};function ue(){const[,se]=(0,Pt.dQ)(),vt=zt(It(se));return ie.useMemo(()=>{const Ot=new Map;let Lt=-1,_t={};return{matchHandlers:{},dispatch(Ft){return _t=Ft,Ot.forEach($t=>$t(_t)),Ot.size>=1},subscribe(Ft){return Ot.size||this.register(),Lt+=1,Ot.set(Lt,Ft),Ft(_t),Lt},unsubscribe(Ft){Ot.delete(Ft),Ot.size||this.unregister()},unregister(){Object.keys(vt).forEach(Ft=>{const $t=vt[Ft],jt=this.matchHandlers[$t];jt==null||jt.mql.removeListener(jt==null?void 0:jt.listener)}),Ot.clear()},register(){Object.keys(vt).forEach(Ft=>{const $t=vt[Ft],jt=Ie=>{let{matches:Mr}=Ie;this.dispatch(Object.assign(Object.assign({},_t),{[Ft]:Mr}))},ot=window.matchMedia($t);ot.addListener(jt),this.matchHandlers[$t]={mql:ot,listener:jt},jt(ot)})},responsiveMap:vt}},[se])}},31808:function(er,Yt,Dt){"use strict";Dt.d(Yt,{fk:function(){return zt},jD:function(){return Pt}});var ie=Dt(98924);const Pt=()=>(0,ie.Z)()&&window.document.documentElement;let ee;const zt=()=>{if(!Pt())return!1;if(ee!==void 0)return ee;const It=document.createElement("div");return It.style.display="flex",It.style.flexDirection="column",It.style.rowGap="1px",It.appendChild(document.createElement("div")),It.appendChild(document.createElement("div")),document.body.appendChild(It),ee=It.scrollHeight===1,document.body.removeChild(It),ee}},15746:function(er,Yt,Dt){"use strict";var ie=Dt(21584);Yt.Z=ie.Z},99134:function(er,Yt,Dt){"use strict";var ie=Dt(67294);const Pt=(0,ie.createContext)({});Yt.Z=Pt},21584:function(er,Yt,Dt){"use strict";var ie=Dt(94184),Pt=Dt.n(ie),ee=Dt(67294),zt=Dt(53124),It=Dt(99134),ue=Dt(6999),se=function(_t,Ft){var $t={};for(var jt in _t)Object.prototype.hasOwnProperty.call(_t,jt)&&Ft.indexOf(jt)<0&&($t[jt]=_t[jt]);if(_t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var ot=0,jt=Object.getOwnPropertySymbols(_t);ot<jt.length;ot++)Ft.indexOf(jt[ot])<0&&Object.prototype.propertyIsEnumerable.call(_t,jt[ot])&&($t[jt[ot]]=_t[jt[ot]]);return $t};function vt(_t){return typeof _t=="number"?`${_t} ${_t} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(_t)?`0 0 ${_t}`:_t}const Ot=["xs","sm","md","lg","xl","xxl"],Lt=ee.forwardRef((_t,Ft)=>{const{getPrefixCls:$t,direction:jt}=ee.useContext(zt.E_),{gutter:ot,wrap:Ie,supportFlexGap:Mr}=ee.useContext(It.Z),{prefixCls:Lr,span:Ee,order:Yr,offset:li,push:hi,pull:Bi,className:fn,children:_i,flex:Ci,style:Vt}=_t,Re=se(_t,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),_e=$t("col",Lr),[ze,nr]=(0,ue.c)(_e);let de={};Ot.forEach(Di=>{let Cr={};const Oi=_t[Di];typeof Oi=="number"?Cr.span=Oi:typeof Oi=="object"&&(Cr=Oi||{}),delete Re[Di],de=Object.assign(Object.assign({},de),{[`${_e}-${Di}-${Cr.span}`]:Cr.span!==void 0,[`${_e}-${Di}-order-${Cr.order}`]:Cr.order||Cr.order===0,[`${_e}-${Di}-offset-${Cr.offset}`]:Cr.offset||Cr.offset===0,[`${_e}-${Di}-push-${Cr.push}`]:Cr.push||Cr.push===0,[`${_e}-${Di}-pull-${Cr.pull}`]:Cr.pull||Cr.pull===0,[`${_e}-${Di}-flex-${Cr.flex}`]:Cr.flex||Cr.flex==="auto",[`${_e}-rtl`]:jt==="rtl"})});const Rr=Pt()(_e,{[`${_e}-${Ee}`]:Ee!==void 0,[`${_e}-order-${Yr}`]:Yr,[`${_e}-offset-${li}`]:li,[`${_e}-push-${hi}`]:hi,[`${_e}-pull-${Bi}`]:Bi},fn,de,nr),He={};if(ot&&ot[0]>0){const Di=ot[0]/2;He.paddingLeft=Di,He.paddingRight=Di}if(ot&&ot[1]>0&&!Mr){const Di=ot[1]/2;He.paddingTop=Di,He.paddingBottom=Di}return Ci&&(He.flex=vt(Ci),Ie===!1&&!He.minWidth&&(He.minWidth=0)),ze(ee.createElement("div",Object.assign({},Re,{style:Object.assign(Object.assign({},He),Vt),className:Rr,ref:Ft}),_i))});Yt.Z=Lt},92820:function(er,Yt,Dt){"use strict";var ie=Dt(94184),Pt=Dt.n(ie),ee=Dt(67294),zt=Dt(53124),It=Dt(98082),ue=Dt(74443),se=Dt(99134),vt=Dt(6999),Ot=function(jt,ot){var Ie={};for(var Mr in jt)Object.prototype.hasOwnProperty.call(jt,Mr)&&ot.indexOf(Mr)<0&&(Ie[Mr]=jt[Mr]);if(jt!=null&&typeof Object.getOwnPropertySymbols=="function")for(var Lr=0,Mr=Object.getOwnPropertySymbols(jt);Lr<Mr.length;Lr++)ot.indexOf(Mr[Lr])<0&&Object.prototype.propertyIsEnumerable.call(jt,Mr[Lr])&&(Ie[Mr[Lr]]=jt[Mr[Lr]]);return Ie};const Lt=null,_t=null;function Ft(jt,ot){const[Ie,Mr]=ee.useState(typeof jt=="string"?jt:""),Lr=()=>{if(typeof jt=="string"&&Mr(jt),typeof jt=="object")for(let Ee=0;Ee<ue.c.length;Ee++){const Yr=ue.c[Ee];if(!ot[Yr])continue;const li=jt[Yr];if(li!==void 0){Mr(li);return}}};return ee.useEffect(()=>{Lr()},[JSON.stringify(jt),ot]),Ie}const $t=ee.forwardRef((jt,ot)=>{const{prefixCls:Ie,justify:Mr,align:Lr,className:Ee,style:Yr,children:li,gutter:hi=0,wrap:Bi}=jt,fn=Ot(jt,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:_i,direction:Ci}=ee.useContext(zt.E_),[Vt,Re]=ee.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[_e,ze]=ee.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),nr=Ft(Lr,_e),de=Ft(Mr,_e),Rr=(0,It.Z)(),He=ee.useRef(hi),Di=(0,ue.Z)();ee.useEffect(()=>{const So=Di.subscribe(ws=>{ze(ws);const Fr=He.current||0;(!Array.isArray(Fr)&&typeof Fr=="object"||Array.isArray(Fr)&&(typeof Fr[0]=="object"||typeof Fr[1]=="object"))&&Re(ws)});return()=>Di.unsubscribe(So)},[]);const Cr=()=>{const So=[void 0,void 0];return(Array.isArray(hi)?hi:[hi,void 0]).forEach((Fr,Pa)=>{if(typeof Fr=="object")for(let Bn=0;Bn<ue.c.length;Bn++){const ki=ue.c[Bn];if(Vt[ki]&&Fr[ki]!==void 0){So[Pa]=Fr[ki];break}}else So[Pa]=Fr}),So},Oi=_i("row",Ie),[As,Vi]=(0,vt.V)(Oi),Ln=Cr(),_s=Pt()(Oi,{[`${Oi}-no-wrap`]:Bi===!1,[`${Oi}-${de}`]:de,[`${Oi}-${nr}`]:nr,[`${Oi}-rtl`]:Ci==="rtl"},Ee,Vi),Ge={},sn=Ln[0]!=null&&Ln[0]>0?Ln[0]/-2:void 0,so=Ln[1]!=null&&Ln[1]>0?Ln[1]/-2:void 0;sn&&(Ge.marginLeft=sn,Ge.marginRight=sn),Rr?[,Ge.rowGap]=Ln:so&&(Ge.marginTop=so,Ge.marginBottom=so);const[xh,We]=Ln,Wi=ee.useMemo(()=>({gutter:[xh,We],wrap:Bi,supportFlexGap:Rr}),[xh,We,Bi,Rr]);return As(ee.createElement(se.Z.Provider,{value:Wi},ee.createElement("div",Object.assign({},fn,{className:_s,style:Object.assign(Object.assign({},Ge),Yr),ref:ot}),li)))});Yt.Z=$t},6999:function(er,Yt,Dt){"use strict";Dt.d(Yt,{V:function(){return vt},c:function(){return Ot}});var ie=Dt(67968),Pt=Dt(45503);const ee=Lt=>{const{componentCls:_t}=Lt;return{[_t]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},zt=Lt=>{const{componentCls:_t}=Lt;return{[_t]:{position:"relative",maxWidth:"100%",minHeight:1}}},It=(Lt,_t)=>{const{componentCls:Ft,gridColumns:$t}=Lt,jt={};for(let ot=$t;ot>=0;ot--)ot===0?(jt[`${Ft}${_t}-${ot}`]={display:"none"},jt[`${Ft}-push-${ot}`]={insetInlineStart:"auto"},jt[`${Ft}-pull-${ot}`]={insetInlineEnd:"auto"},jt[`${Ft}${_t}-push-${ot}`]={insetInlineStart:"auto"},jt[`${Ft}${_t}-pull-${ot}`]={insetInlineEnd:"auto"},jt[`${Ft}${_t}-offset-${ot}`]={marginInlineStart:0},jt[`${Ft}${_t}-order-${ot}`]={order:0}):(jt[`${Ft}${_t}-${ot}`]={display:"block",flex:`0 0 ${ot/$t*100}%`,maxWidth:`${ot/$t*100}%`},jt[`${Ft}${_t}-push-${ot}`]={insetInlineStart:`${ot/$t*100}%`},jt[`${Ft}${_t}-pull-${ot}`]={insetInlineEnd:`${ot/$t*100}%`},jt[`${Ft}${_t}-offset-${ot}`]={marginInlineStart:`${ot/$t*100}%`},jt[`${Ft}${_t}-order-${ot}`]={order:ot});return jt},ue=(Lt,_t)=>It(Lt,_t),se=(Lt,_t,Ft)=>({[`@media (min-width: ${_t}px)`]:Object.assign({},ue(Lt,Ft))}),vt=(0,ie.Z)("Grid",Lt=>[ee(Lt)]),Ot=(0,ie.Z)("Grid",Lt=>{const _t=(0,Pt.TS)(Lt,{gridColumns:24}),Ft={"-sm":_t.screenSMMin,"-md":_t.screenMDMin,"-lg":_t.screenLGMin,"-xl":_t.screenXLMin,"-xxl":_t.screenXXLMin};return[zt(_t),ue(_t,""),ue(_t,"-xs"),Object.keys(Ft).map($t=>se(_t,Ft[$t],$t)).reduce(($t,jt)=>Object.assign(Object.assign({},$t),jt),{})]})},71230:function(er,Yt,Dt){"use strict";var ie=Dt(92820);Yt.Z=ie.Z},37923:function(er){function Yt(Dt,ie){(ie==null||ie>Dt.length)&&(ie=Dt.length);for(var Pt=0,ee=new Array(ie);Pt<ie;Pt++)ee[Pt]=Dt[Pt];return ee}er.exports=Yt,er.exports.__esModule=!0,er.exports.default=er.exports},82187:function(er){function Yt(Dt){if(Array.isArray(Dt))return Dt}er.exports=Yt,er.exports.__esModule=!0,er.exports.default=er.exports},73964:function(er){function Yt(Dt,ie){var Pt=Dt==null?null:typeof Symbol!="undefined"&&Dt[Symbol.iterator]||Dt["@@iterator"];if(Pt!=null){var ee,zt,It,ue,se=[],vt=!0,Ot=!1;try{if(It=(Pt=Pt.call(Dt)).next,ie===0){if(Object(Pt)!==Pt)return;vt=!1}else for(;!(vt=(ee=It.call(Pt)).done)&&(se.push(ee.value),se.length!==ie);vt=!0);}catch(Lt){Ot=!0,zt=Lt}finally{try{if(!vt&&Pt.return!=null&&(ue=Pt.return(),Object(ue)!==ue))return}finally{if(Ot)throw zt}}return se}}er.exports=Yt,er.exports.__esModule=!0,er.exports.default=er.exports},69094:function(er){function Yt(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}er.exports=Yt,er.exports.__esModule=!0,er.exports.default=er.exports},5574:function(er,Yt,Dt){var ie=Dt(82187),Pt=Dt(73964),ee=Dt(96263),zt=Dt(69094);function It(ue,se){return ie(ue)||Pt(ue,se)||ee(ue,se)||zt()}er.exports=It,er.exports.__esModule=!0,er.exports.default=er.exports},96263:function(er,Yt,Dt){var ie=Dt(37923);function Pt(ee,zt){if(ee){if(typeof ee=="string")return ie(ee,zt);var It=Object.prototype.toString.call(ee).slice(8,-1);if(It==="Object"&&ee.constructor&&(It=ee.constructor.name),It==="Map"||It==="Set")return Array.from(ee);if(It==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(It))return ie(ee,zt)}}er.exports=Pt,er.exports.__esModule=!0,er.exports.default=er.exports}}]);
